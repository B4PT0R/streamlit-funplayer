var o5=Object.defineProperty;var l5=(r,e,t)=>e in r?o5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Ot=(r,e,t)=>l5(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();var Ap=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yu(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function s2(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var n=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(t,i,n.get?n:{enumerable:!0,get:function(){return r[i]}})}),t}var _A={exports:{}},Ny={},bA={exports:{}},nr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KM;function u5(){if(KM)return nr;KM=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.iterator;function x(Se){return Se===null||typeof Se!="object"?null:(Se=b&&Se[b]||Se["@@iterator"],typeof Se=="function"?Se:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B=Object.assign,P={};function N(Se,ct,xt){this.props=Se,this.context=ct,this.refs=P,this.updater=xt||C}N.prototype.isReactComponent={},N.prototype.setState=function(Se,ct){if(typeof Se!="object"&&typeof Se!="function"&&Se!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Se,ct,"setState")},N.prototype.forceUpdate=function(Se){this.updater.enqueueForceUpdate(this,Se,"forceUpdate")};function ae(){}ae.prototype=N.prototype;function X(Se,ct,xt){this.props=Se,this.context=ct,this.refs=P,this.updater=xt||C}var de=X.prototype=new ae;de.constructor=X,B(de,N.prototype),de.isPureReactComponent=!0;var ge=Array.isArray,ue=Object.prototype.hasOwnProperty,be={current:null},fe={key:!0,ref:!0,__self:!0,__source:!0};function ve(Se,ct,xt){var ii,Re={},lt=null,bt=null;if(ct!=null)for(ii in ct.ref!==void 0&&(bt=ct.ref),ct.key!==void 0&&(lt=""+ct.key),ct)ue.call(ct,ii)&&!fe.hasOwnProperty(ii)&&(Re[ii]=ct[ii]);var Je=arguments.length-2;if(Je===1)Re.children=xt;else if(1<Je){for(var Dt=Array(Je),Yt=0;Yt<Je;Yt++)Dt[Yt]=arguments[Yt+2];Re.children=Dt}if(Se&&Se.defaultProps)for(ii in Je=Se.defaultProps,Je)Re[ii]===void 0&&(Re[ii]=Je[ii]);return{$$typeof:r,type:Se,key:lt,ref:bt,props:Re,_owner:be.current}}function ie(Se,ct){return{$$typeof:r,type:Se.type,key:ct,ref:Se.ref,props:Se.props,_owner:Se._owner}}function re(Se){return typeof Se=="object"&&Se!==null&&Se.$$typeof===r}function Ne(Se){var ct={"=":"=0",":":"=2"};return"$"+Se.replace(/[=:]/g,function(xt){return ct[xt]})}var De=/\/+/g;function ke(Se,ct){return typeof Se=="object"&&Se!==null&&Se.key!=null?Ne(""+Se.key):ct.toString(36)}function ut(Se,ct,xt,ii,Re){var lt=typeof Se;(lt==="undefined"||lt==="boolean")&&(Se=null);var bt=!1;if(Se===null)bt=!0;else switch(lt){case"string":case"number":bt=!0;break;case"object":switch(Se.$$typeof){case r:case e:bt=!0}}if(bt)return bt=Se,Re=Re(bt),Se=ii===""?"."+ke(bt,0):ii,ge(Re)?(xt="",Se!=null&&(xt=Se.replace(De,"$&/")+"/"),ut(Re,ct,xt,"",function(Yt){return Yt})):Re!=null&&(re(Re)&&(Re=ie(Re,xt+(!Re.key||bt&&bt.key===Re.key?"":(""+Re.key).replace(De,"$&/")+"/")+Se)),ct.push(Re)),1;if(bt=0,ii=ii===""?".":ii+":",ge(Se))for(var Je=0;Je<Se.length;Je++){lt=Se[Je];var Dt=ii+ke(lt,Je);bt+=ut(lt,ct,xt,Dt,Re)}else if(Dt=x(Se),typeof Dt=="function")for(Se=Dt.call(Se),Je=0;!(lt=Se.next()).done;)lt=lt.value,Dt=ii+ke(lt,Je++),bt+=ut(lt,ct,xt,Dt,Re);else if(lt==="object")throw ct=String(Se),Error("Objects are not valid as a React child (found: "+(ct==="[object Object]"?"object with keys {"+Object.keys(Se).join(", ")+"}":ct)+"). If you meant to render a collection of children, use an array instead.");return bt}function _t(Se,ct,xt){if(Se==null)return Se;var ii=[],Re=0;return ut(Se,ii,"","",function(lt){return ct.call(xt,lt,Re++)}),ii}function vt(Se){if(Se._status===-1){var ct=Se._result;ct=ct(),ct.then(function(xt){(Se._status===0||Se._status===-1)&&(Se._status=1,Se._result=xt)},function(xt){(Se._status===0||Se._status===-1)&&(Se._status=2,Se._result=xt)}),Se._status===-1&&(Se._status=0,Se._result=ct)}if(Se._status===1)return Se._result.default;throw Se._result}var tt={current:null},je={transition:null},it={ReactCurrentDispatcher:tt,ReactCurrentBatchConfig:je,ReactCurrentOwner:be};function Xe(){throw Error("act(...) is not supported in production builds of React.")}return nr.Children={map:_t,forEach:function(Se,ct,xt){_t(Se,function(){ct.apply(this,arguments)},xt)},count:function(Se){var ct=0;return _t(Se,function(){ct++}),ct},toArray:function(Se){return _t(Se,function(ct){return ct})||[]},only:function(Se){if(!re(Se))throw Error("React.Children.only expected to receive a single React element child.");return Se}},nr.Component=N,nr.Fragment=t,nr.Profiler=n,nr.PureComponent=X,nr.StrictMode=i,nr.Suspense=h,nr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=it,nr.act=Xe,nr.cloneElement=function(Se,ct,xt){if(Se==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Se+".");var ii=B({},Se.props),Re=Se.key,lt=Se.ref,bt=Se._owner;if(ct!=null){if(ct.ref!==void 0&&(lt=ct.ref,bt=be.current),ct.key!==void 0&&(Re=""+ct.key),Se.type&&Se.type.defaultProps)var Je=Se.type.defaultProps;for(Dt in ct)ue.call(ct,Dt)&&!fe.hasOwnProperty(Dt)&&(ii[Dt]=ct[Dt]===void 0&&Je!==void 0?Je[Dt]:ct[Dt])}var Dt=arguments.length-2;if(Dt===1)ii.children=xt;else if(1<Dt){Je=Array(Dt);for(var Yt=0;Yt<Dt;Yt++)Je[Yt]=arguments[Yt+2];ii.children=Je}return{$$typeof:r,type:Se.type,key:Re,ref:lt,props:ii,_owner:bt}},nr.createContext=function(Se){return Se={$$typeof:a,_currentValue:Se,_currentValue2:Se,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Se.Provider={$$typeof:s,_context:Se},Se.Consumer=Se},nr.createElement=ve,nr.createFactory=function(Se){var ct=ve.bind(null,Se);return ct.type=Se,ct},nr.createRef=function(){return{current:null}},nr.forwardRef=function(Se){return{$$typeof:c,render:Se}},nr.isValidElement=re,nr.lazy=function(Se){return{$$typeof:v,_payload:{_status:-1,_result:Se},_init:vt}},nr.memo=function(Se,ct){return{$$typeof:m,type:Se,compare:ct===void 0?null:ct}},nr.startTransition=function(Se){var ct=je.transition;je.transition={};try{Se()}finally{je.transition=ct}},nr.unstable_act=Xe,nr.useCallback=function(Se,ct){return tt.current.useCallback(Se,ct)},nr.useContext=function(Se){return tt.current.useContext(Se)},nr.useDebugValue=function(){},nr.useDeferredValue=function(Se){return tt.current.useDeferredValue(Se)},nr.useEffect=function(Se,ct){return tt.current.useEffect(Se,ct)},nr.useId=function(){return tt.current.useId()},nr.useImperativeHandle=function(Se,ct,xt){return tt.current.useImperativeHandle(Se,ct,xt)},nr.useInsertionEffect=function(Se,ct){return tt.current.useInsertionEffect(Se,ct)},nr.useLayoutEffect=function(Se,ct){return tt.current.useLayoutEffect(Se,ct)},nr.useMemo=function(Se,ct){return tt.current.useMemo(Se,ct)},nr.useReducer=function(Se,ct,xt){return tt.current.useReducer(Se,ct,xt)},nr.useRef=function(Se){return tt.current.useRef(Se)},nr.useState=function(Se){return tt.current.useState(Se)},nr.useSyncExternalStore=function(Se,ct,xt){return tt.current.useSyncExternalStore(Se,ct,xt)},nr.useTransition=function(){return tt.current.useTransition()},nr.version="18.3.1",nr}var ZM;function a2(){return ZM||(ZM=1,bA.exports=u5()),bA.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JM;function c5(){if(JM)return Ny;JM=1;var r=a2(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,n=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(c,h,m){var v,b={},x=null,C=null;m!==void 0&&(x=""+m),h.key!==void 0&&(x=""+h.key),h.ref!==void 0&&(C=h.ref);for(v in h)i.call(h,v)&&!s.hasOwnProperty(v)&&(b[v]=h[v]);if(c&&c.defaultProps)for(v in h=c.defaultProps,h)b[v]===void 0&&(b[v]=h[v]);return{$$typeof:e,type:c,key:x,ref:C,props:b,_owner:n.current}}return Ny.Fragment=t,Ny.jsx=a,Ny.jsxs=a,Ny}var eD;function d5(){return eD||(eD=1,_A.exports=c5()),_A.exports}var Lt=d5(),Mf=a2();const s_=Yu(Mf);var j1={},TA={exports:{}},jl={},xA={exports:{}},SA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tD;function h5(){return tD||(tD=1,function(r){function e(je,it){var Xe=je.length;je.push(it);e:for(;0<Xe;){var Se=Xe-1>>>1,ct=je[Se];if(0<n(ct,it))je[Se]=it,je[Xe]=ct,Xe=Se;else break e}}function t(je){return je.length===0?null:je[0]}function i(je){if(je.length===0)return null;var it=je[0],Xe=je.pop();if(Xe!==it){je[0]=Xe;e:for(var Se=0,ct=je.length,xt=ct>>>1;Se<xt;){var ii=2*(Se+1)-1,Re=je[ii],lt=ii+1,bt=je[lt];if(0>n(Re,Xe))lt<ct&&0>n(bt,Re)?(je[Se]=bt,je[lt]=Xe,Se=lt):(je[Se]=Re,je[ii]=Xe,Se=ii);else if(lt<ct&&0>n(bt,Xe))je[Se]=bt,je[lt]=Xe,Se=lt;else break e}}return it}function n(je,it){var Xe=je.sortIndex-it.sortIndex;return Xe!==0?Xe:je.id-it.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var a=Date,c=a.now();r.unstable_now=function(){return a.now()-c}}var h=[],m=[],v=1,b=null,x=3,C=!1,B=!1,P=!1,N=typeof setTimeout=="function"?setTimeout:null,ae=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function de(je){for(var it=t(m);it!==null;){if(it.callback===null)i(m);else if(it.startTime<=je)i(m),it.sortIndex=it.expirationTime,e(h,it);else break;it=t(m)}}function ge(je){if(P=!1,de(je),!B)if(t(h)!==null)B=!0,vt(ue);else{var it=t(m);it!==null&&tt(ge,it.startTime-je)}}function ue(je,it){B=!1,P&&(P=!1,ae(ve),ve=-1),C=!0;var Xe=x;try{for(de(it),b=t(h);b!==null&&(!(b.expirationTime>it)||je&&!Ne());){var Se=b.callback;if(typeof Se=="function"){b.callback=null,x=b.priorityLevel;var ct=Se(b.expirationTime<=it);it=r.unstable_now(),typeof ct=="function"?b.callback=ct:b===t(h)&&i(h),de(it)}else i(h);b=t(h)}if(b!==null)var xt=!0;else{var ii=t(m);ii!==null&&tt(ge,ii.startTime-it),xt=!1}return xt}finally{b=null,x=Xe,C=!1}}var be=!1,fe=null,ve=-1,ie=5,re=-1;function Ne(){return!(r.unstable_now()-re<ie)}function De(){if(fe!==null){var je=r.unstable_now();re=je;var it=!0;try{it=fe(!0,je)}finally{it?ke():(be=!1,fe=null)}}else be=!1}var ke;if(typeof X=="function")ke=function(){X(De)};else if(typeof MessageChannel<"u"){var ut=new MessageChannel,_t=ut.port2;ut.port1.onmessage=De,ke=function(){_t.postMessage(null)}}else ke=function(){N(De,0)};function vt(je){fe=je,be||(be=!0,ke())}function tt(je,it){ve=N(function(){je(r.unstable_now())},it)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(je){je.callback=null},r.unstable_continueExecution=function(){B||C||(B=!0,vt(ue))},r.unstable_forceFrameRate=function(je){0>je||125<je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ie=0<je?Math.floor(1e3/je):5},r.unstable_getCurrentPriorityLevel=function(){return x},r.unstable_getFirstCallbackNode=function(){return t(h)},r.unstable_next=function(je){switch(x){case 1:case 2:case 3:var it=3;break;default:it=x}var Xe=x;x=it;try{return je()}finally{x=Xe}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(je,it){switch(je){case 1:case 2:case 3:case 4:case 5:break;default:je=3}var Xe=x;x=je;try{return it()}finally{x=Xe}},r.unstable_scheduleCallback=function(je,it,Xe){var Se=r.unstable_now();switch(typeof Xe=="object"&&Xe!==null?(Xe=Xe.delay,Xe=typeof Xe=="number"&&0<Xe?Se+Xe:Se):Xe=Se,je){case 1:var ct=-1;break;case 2:ct=250;break;case 5:ct=1073741823;break;case 4:ct=1e4;break;default:ct=5e3}return ct=Xe+ct,je={id:v++,callback:it,priorityLevel:je,startTime:Xe,expirationTime:ct,sortIndex:-1},Xe>Se?(je.sortIndex=Xe,e(m,je),t(h)===null&&je===t(m)&&(P?(ae(ve),ve=-1):P=!0,tt(ge,Xe-Se))):(je.sortIndex=ct,e(h,je),B||C||(B=!0,vt(ue))),je},r.unstable_shouldYield=Ne,r.unstable_wrapCallback=function(je){var it=x;return function(){var Xe=x;x=it;try{return je.apply(this,arguments)}finally{x=Xe}}}}(SA)),SA}var iD;function f5(){return iD||(iD=1,xA.exports=h5()),xA.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nD;function p5(){if(nD)return jl;nD=1;var r=a2(),e=f5();function t(d){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+d,_=1;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_]);return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,n={};function s(d,p){a(d,p),a(d+"Capture",p)}function a(d,p){for(n[d]=p,d=0;d<p.length;d++)i.add(p[d])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},b={};function x(d){return h.call(b,d)?!0:h.call(v,d)?!1:m.test(d)?b[d]=!0:(v[d]=!0,!1)}function C(d,p,_,A){if(_!==null&&_.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return A?!1:_!==null?!_.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function B(d,p,_,A){if(p===null||typeof p>"u"||C(d,p,_,A))return!0;if(A)return!1;if(_!==null)switch(_.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function P(d,p,_,A,O,$,ce){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=A,this.attributeNamespace=O,this.mustUseProperty=_,this.propertyName=d,this.type=p,this.sanitizeURL=$,this.removeEmptyString=ce}var N={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){N[d]=new P(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var p=d[0];N[p]=new P(p,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){N[d]=new P(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){N[d]=new P(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){N[d]=new P(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){N[d]=new P(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){N[d]=new P(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){N[d]=new P(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){N[d]=new P(d,5,!1,d.toLowerCase(),null,!1,!1)});var ae=/[\-:]([a-z])/g;function X(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var p=d.replace(ae,X);N[p]=new P(p,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var p=d.replace(ae,X);N[p]=new P(p,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var p=d.replace(ae,X);N[p]=new P(p,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){N[d]=new P(d,1,!1,d.toLowerCase(),null,!1,!1)}),N.xlinkHref=new P("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){N[d]=new P(d,1,!1,d.toLowerCase(),null,!0,!0)});function de(d,p,_,A){var O=N.hasOwnProperty(p)?N[p]:null;(O!==null?O.type!==0:A||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(B(p,_,O,A)&&(_=null),A||O===null?x(p)&&(_===null?d.removeAttribute(p):d.setAttribute(p,""+_)):O.mustUseProperty?d[O.propertyName]=_===null?O.type===3?!1:"":_:(p=O.attributeName,A=O.attributeNamespace,_===null?d.removeAttribute(p):(O=O.type,_=O===3||O===4&&_===!0?"":""+_,A?d.setAttributeNS(A,p,_):d.setAttribute(p,_))))}var ge=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ue=Symbol.for("react.element"),be=Symbol.for("react.portal"),fe=Symbol.for("react.fragment"),ve=Symbol.for("react.strict_mode"),ie=Symbol.for("react.profiler"),re=Symbol.for("react.provider"),Ne=Symbol.for("react.context"),De=Symbol.for("react.forward_ref"),ke=Symbol.for("react.suspense"),ut=Symbol.for("react.suspense_list"),_t=Symbol.for("react.memo"),vt=Symbol.for("react.lazy"),tt=Symbol.for("react.offscreen"),je=Symbol.iterator;function it(d){return d===null||typeof d!="object"?null:(d=je&&d[je]||d["@@iterator"],typeof d=="function"?d:null)}var Xe=Object.assign,Se;function ct(d){if(Se===void 0)try{throw Error()}catch(_){var p=_.stack.trim().match(/\n( *(at )?)/);Se=p&&p[1]||""}return`
`+Se+d}var xt=!1;function ii(d,p){if(!d||xt)return"";xt=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(Et){var A=Et}Reflect.construct(d,[],p)}else{try{p.call()}catch(Et){A=Et}d.call(p.prototype)}else{try{throw Error()}catch(Et){A=Et}d()}}catch(Et){if(Et&&A&&typeof Et.stack=="string"){for(var O=Et.stack.split(`
`),$=A.stack.split(`
`),ce=O.length-1,Fe=$.length-1;1<=ce&&0<=Fe&&O[ce]!==$[Fe];)Fe--;for(;1<=ce&&0<=Fe;ce--,Fe--)if(O[ce]!==$[Fe]){if(ce!==1||Fe!==1)do if(ce--,Fe--,0>Fe||O[ce]!==$[Fe]){var ze=`
`+O[ce].replace(" at new "," at ");return d.displayName&&ze.includes("<anonymous>")&&(ze=ze.replace("<anonymous>",d.displayName)),ze}while(1<=ce&&0<=Fe);break}}}finally{xt=!1,Error.prepareStackTrace=_}return(d=d?d.displayName||d.name:"")?ct(d):""}function Re(d){switch(d.tag){case 5:return ct(d.type);case 16:return ct("Lazy");case 13:return ct("Suspense");case 19:return ct("SuspenseList");case 0:case 2:case 15:return d=ii(d.type,!1),d;case 11:return d=ii(d.type.render,!1),d;case 1:return d=ii(d.type,!0),d;default:return""}}function lt(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case fe:return"Fragment";case be:return"Portal";case ie:return"Profiler";case ve:return"StrictMode";case ke:return"Suspense";case ut:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case Ne:return(d.displayName||"Context")+".Consumer";case re:return(d._context.displayName||"Context")+".Provider";case De:var p=d.render;return d=d.displayName,d||(d=p.displayName||p.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case _t:return p=d.displayName||null,p!==null?p:lt(d.type)||"Memo";case vt:p=d._payload,d=d._init;try{return lt(d(p))}catch{}}return null}function bt(d){var p=d.type;switch(d.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=p.render,d=d.displayName||d.name||"",p.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return lt(p);case 8:return p===ve?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function Je(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Dt(d){var p=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function Yt(d){var p=Dt(d)?"checked":"value",_=Object.getOwnPropertyDescriptor(d.constructor.prototype,p),A=""+d[p];if(!d.hasOwnProperty(p)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var O=_.get,$=_.set;return Object.defineProperty(d,p,{configurable:!0,get:function(){return O.call(this)},set:function(ce){A=""+ce,$.call(this,ce)}}),Object.defineProperty(d,p,{enumerable:_.enumerable}),{getValue:function(){return A},setValue:function(ce){A=""+ce},stopTracking:function(){d._valueTracker=null,delete d[p]}}}}function vi(d){d._valueTracker||(d._valueTracker=Yt(d))}function xi(d){if(!d)return!1;var p=d._valueTracker;if(!p)return!0;var _=p.getValue(),A="";return d&&(A=Dt(d)?d.checked?"true":"false":d.value),d=A,d!==_?(p.setValue(d),!0):!1}function Yi(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function Ki(d,p){var _=p.checked;return Xe({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:_??d._wrapperState.initialChecked})}function io(d,p){var _=p.defaultValue==null?"":p.defaultValue,A=p.checked!=null?p.checked:p.defaultChecked;_=Je(p.value!=null?p.value:_),d._wrapperState={initialChecked:A,initialValue:_,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function yr(d,p){p=p.checked,p!=null&&de(d,"checked",p,!1)}function bs(d,p){yr(d,p);var _=Je(p.value),A=p.type;if(_!=null)A==="number"?(_===0&&d.value===""||d.value!=_)&&(d.value=""+_):d.value!==""+_&&(d.value=""+_);else if(A==="submit"||A==="reset"){d.removeAttribute("value");return}p.hasOwnProperty("value")?sn(d,p.type,_):p.hasOwnProperty("defaultValue")&&sn(d,p.type,Je(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(d.defaultChecked=!!p.defaultChecked)}function cs(d,p,_){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var A=p.type;if(!(A!=="submit"&&A!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+d._wrapperState.initialValue,_||p===d.value||(d.value=p),d.defaultValue=p}_=d.name,_!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,_!==""&&(d.name=_)}function sn(d,p,_){(p!=="number"||Yi(d.ownerDocument)!==d)&&(_==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+_&&(d.defaultValue=""+_))}var dn=Array.isArray;function gn(d,p,_,A){if(d=d.options,p){p={};for(var O=0;O<_.length;O++)p["$"+_[O]]=!0;for(_=0;_<d.length;_++)O=p.hasOwnProperty("$"+d[_].value),d[_].selected!==O&&(d[_].selected=O),O&&A&&(d[_].defaultSelected=!0)}else{for(_=""+Je(_),p=null,O=0;O<d.length;O++){if(d[O].value===_){d[O].selected=!0,A&&(d[O].defaultSelected=!0);return}p!==null||d[O].disabled||(p=d[O])}p!==null&&(p.selected=!0)}}function Sr(d,p){if(p.dangerouslySetInnerHTML!=null)throw Error(t(91));return Xe({},p,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function fa(d,p){var _=p.value;if(_==null){if(_=p.children,p=p.defaultValue,_!=null){if(p!=null)throw Error(t(92));if(dn(_)){if(1<_.length)throw Error(t(93));_=_[0]}p=_}p==null&&(p=""),_=p}d._wrapperState={initialValue:Je(_)}}function Oa(d,p){var _=Je(p.value),A=Je(p.defaultValue);_!=null&&(_=""+_,_!==d.value&&(d.value=_),p.defaultValue==null&&d.defaultValue!==_&&(d.defaultValue=_)),A!=null&&(d.defaultValue=""+A)}function Js(d){var p=d.textContent;p===d._wrapperState.initialValue&&p!==""&&p!==null&&(d.value=p)}function Sa(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ds(d,p){return d==null||d==="http://www.w3.org/1999/xhtml"?Sa(p):d==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var js,Vo=function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,_,A,O){MSApp.execUnsafeLocalFunction(function(){return d(p,_,A,O)})}:d}(function(d,p){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=p;else{for(js=js||document.createElement("div"),js.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=js.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;p.firstChild;)d.appendChild(p.firstChild)}});function Aa(d,p){if(p){var _=d.firstChild;if(_&&_===d.lastChild&&_.nodeType===3){_.nodeValue=p;return}}d.textContent=p}var an={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ze=["Webkit","ms","Moz","O"];Object.keys(an).forEach(function(d){Ze.forEach(function(p){p=p+d.charAt(0).toUpperCase()+d.substring(1),an[p]=an[d]})});function St(d,p,_){return p==null||typeof p=="boolean"||p===""?"":_||typeof p!="number"||p===0||an.hasOwnProperty(d)&&an[d]?(""+p).trim():p+"px"}function Ft(d,p){d=d.style;for(var _ in p)if(p.hasOwnProperty(_)){var A=_.indexOf("--")===0,O=St(_,p[_],A);_==="float"&&(_="cssFloat"),A?d.setProperty(_,O):d[_]=O}}var di=Xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Oi(d,p){if(p){if(di[d]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(t(137,d));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(t(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(t(61))}if(p.style!=null&&typeof p.style!="object")throw Error(t(62))}}function Fn(d,p){if(d.indexOf("-")===-1)return typeof p.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ar=null;function Zi(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var pi=null,ne=null,oe=null;function xe(d){if(d=j(d)){if(typeof pi!="function")throw Error(t(280));var p=d.stateNode;p&&(p=ye(p),pi(d.stateNode,d.type,p))}}function Ye(d){ne?oe?oe.push(d):oe=[d]:ne=d}function jt(){if(ne){var d=ne,p=oe;if(oe=ne=null,xe(d),p)for(d=0;d<p.length;d++)xe(p[d])}}function bi(d,p){return d(p)}function Ui(){}var Qr=!1;function Kr(d,p,_){if(Qr)return d(p,_);Qr=!0;try{return bi(d,p,_)}finally{Qr=!1,(ne!==null||oe!==null)&&(Ui(),jt())}}function ur(d,p){var _=d.stateNode;if(_===null)return null;var A=ye(_);if(A===null)return null;_=A[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(d=d.type,A=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!A;break e;default:d=!1}if(d)return null;if(_&&typeof _!="function")throw Error(t(231,p,typeof _));return _}var wa=!1;if(c)try{var pa={};Object.defineProperty(pa,"passive",{get:function(){wa=!0}}),window.addEventListener("test",pa,pa),window.removeEventListener("test",pa,pa)}catch{wa=!1}function Ls(d,p,_,A,O,$,ce,Fe,ze){var Et=Array.prototype.slice.call(arguments,3);try{p.apply(_,Et)}catch(Jt){this.onError(Jt)}}var Ir=!1,Gn=null,ln=!1,Fa=null,Pr={onError:function(d){Ir=!0,Gn=d}};function ea(d,p,_,A,O,$,ce,Fe,ze){Ir=!1,Gn=null,Ls.apply(Pr,arguments)}function no(d,p,_,A,O,$,ce,Fe,ze){if(ea.apply(this,arguments),Ir){if(Ir){var Et=Gn;Ir=!1,Gn=null}else throw Error(t(198));ln||(ln=!0,Fa=Et)}}function nn(d){var p=d,_=d;if(d.alternate)for(;p.return;)p=p.return;else{d=p;do p=d,(p.flags&4098)!==0&&(_=p.return),d=p.return;while(d)}return p.tag===3?_:null}function Lr(d){if(d.tag===13){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function ta(d){if(nn(d)!==d)throw Error(t(188))}function cr(d){var p=d.alternate;if(!p){if(p=nn(d),p===null)throw Error(t(188));return p!==d?null:d}for(var _=d,A=p;;){var O=_.return;if(O===null)break;var $=O.alternate;if($===null){if(A=O.return,A!==null){_=A;continue}break}if(O.child===$.child){for($=O.child;$;){if($===_)return ta(O),d;if($===A)return ta(O),p;$=$.sibling}throw Error(t(188))}if(_.return!==A.return)_=O,A=$;else{for(var ce=!1,Fe=O.child;Fe;){if(Fe===_){ce=!0,_=O,A=$;break}if(Fe===A){ce=!0,A=O,_=$;break}Fe=Fe.sibling}if(!ce){for(Fe=$.child;Fe;){if(Fe===_){ce=!0,_=$,A=O;break}if(Fe===A){ce=!0,A=$,_=O;break}Fe=Fe.sibling}if(!ce)throw Error(t(189))}}if(_.alternate!==A)throw Error(t(190))}if(_.tag!==3)throw Error(t(188));return _.stateNode.current===_?d:p}function kf(d){return d=cr(d),d!==null?_l(d):null}function _l(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var p=_l(d);if(p!==null)return p;d=d.sibling}return null}var rr=e.unstable_scheduleCallback,zo=e.unstable_cancelCallback,xc=e.unstable_shouldYield,Of=e.unstable_requestPaint,Gr=e.unstable_now,nd=e.unstable_getCurrentPriorityLevel,rd=e.unstable_ImmediatePriority,su=e.unstable_UserBlockingPriority,bl=e.unstable_NormalPriority,Qu=e.unstable_LowPriority,Ah=e.unstable_IdlePriority,Sc=null,Rs=null;function Ho(d){if(Rs&&typeof Rs.onCommitFiberRoot=="function")try{Rs.onCommitFiberRoot(Sc,d,void 0,(d.current.flags&128)===128)}catch{}}var Gs=Math.clz32?Math.clz32:ou,ro=Math.log,au=Math.LN2;function ou(d){return d>>>=0,d===0?32:31-(ro(d)/au|0)|0}var so=64,Ba=4194304;function Ku(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function lu(d,p){var _=d.pendingLanes;if(_===0)return 0;var A=0,O=d.suspendedLanes,$=d.pingedLanes,ce=_&268435455;if(ce!==0){var Fe=ce&~O;Fe!==0?A=Ku(Fe):($&=ce,$!==0&&(A=Ku($)))}else ce=_&~O,ce!==0?A=Ku(ce):$!==0&&(A=Ku($));if(A===0)return 0;if(p!==0&&p!==A&&(p&O)===0&&(O=A&-A,$=p&-p,O>=$||O===16&&($&4194240)!==0))return p;if((A&4)!==0&&(A|=_&16),p=d.entangledLanes,p!==0)for(d=d.entanglements,p&=A;0<p;)_=31-Gs(p),O=1<<_,A|=d[_],p&=~O;return A}function Ff(d,p){switch(d){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jo(d,p){for(var _=d.suspendedLanes,A=d.pingedLanes,O=d.expirationTimes,$=d.pendingLanes;0<$;){var ce=31-Gs($),Fe=1<<ce,ze=O[ce];ze===-1?((Fe&_)===0||(Fe&A)!==0)&&(O[ce]=Ff(Fe,p)):ze<=p&&(d.expiredLanes|=Fe),$&=~Fe}}function uu(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function Bf(){var d=so;return so<<=1,(so&4194240)===0&&(so=64),d}function Tl(d){for(var p=[],_=0;31>_;_++)p.push(d);return p}function fo(d,p,_){d.pendingLanes|=p,p!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,p=31-Gs(p),d[p]=_}function Na(d,p){var _=d.pendingLanes&~p;d.pendingLanes=p,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=p,d.mutableReadLanes&=p,d.entangledLanes&=p,p=d.entanglements;var A=d.eventTimes;for(d=d.expirationTimes;0<_;){var O=31-Gs(_),$=1<<O;p[O]=0,A[O]=-1,d[O]=-1,_&=~$}}function wh(d,p){var _=d.entangledLanes|=p;for(d=d.entanglements;_;){var A=31-Gs(_),O=1<<A;O&p|d[A]&p&&(d[A]|=p),_&=~O}}var Jn=0;function cu(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var Ac,xl,wc,Eh,sd,Ch=!1,ad=[],Sl=null,ao=null,Ua=null,Al=new Map,Zu=new Map,wl=[],Mh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nf(d,p){switch(d){case"focusin":case"focusout":Sl=null;break;case"dragenter":case"dragleave":ao=null;break;case"mouseover":case"mouseout":Ua=null;break;case"pointerover":case"pointerout":Al.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zu.delete(p.pointerId)}}function Go(d,p,_,A,O,$){return d===null||d.nativeEvent!==$?(d={blockedOn:p,domEventName:_,eventSystemFlags:A,nativeEvent:$,targetContainers:[O]},p!==null&&(p=j(p),p!==null&&xl(p)),d):(d.eventSystemFlags|=A,p=d.targetContainers,O!==null&&p.indexOf(O)===-1&&p.push(O),d)}function od(d,p,_,A,O){switch(p){case"focusin":return Sl=Go(Sl,d,p,_,A,O),!0;case"dragenter":return ao=Go(ao,d,p,_,A,O),!0;case"mouseover":return Ua=Go(Ua,d,p,_,A,O),!0;case"pointerover":var $=O.pointerId;return Al.set($,Go(Al.get($)||null,d,p,_,A,O)),!0;case"gotpointercapture":return $=O.pointerId,Zu.set($,Go(Zu.get($)||null,d,p,_,A,O)),!0}return!1}function Dh(d){var p=L(d.target);if(p!==null){var _=nn(p);if(_!==null){if(p=_.tag,p===13){if(p=Lr(_),p!==null){d.blockedOn=p,sd(d.priority,function(){wc(_)});return}}else if(p===3&&_.stateNode.current.memoizedState.isDehydrated){d.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}d.blockedOn=null}function ld(d){if(d.blockedOn!==null)return!1;for(var p=d.targetContainers;0<p.length;){var _=cd(d.domEventName,d.eventSystemFlags,p[0],d.nativeEvent);if(_===null){_=d.nativeEvent;var A=new _.constructor(_.type,_);Ar=A,_.target.dispatchEvent(A),Ar=null}else return p=j(_),p!==null&&xl(p),d.blockedOn=_,!1;p.shift()}return!0}function El(d,p,_){ld(d)&&_.delete(p)}function $o(){Ch=!1,Sl!==null&&ld(Sl)&&(Sl=null),ao!==null&&ld(ao)&&(ao=null),Ua!==null&&ld(Ua)&&(Ua=null),Al.forEach(El),Zu.forEach(El)}function oo(d,p){d.blockedOn===p&&(d.blockedOn=null,Ch||(Ch=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,$o)))}function $s(d){function p(O){return oo(O,d)}if(0<ad.length){oo(ad[0],d);for(var _=1;_<ad.length;_++){var A=ad[_];A.blockedOn===d&&(A.blockedOn=null)}}for(Sl!==null&&oo(Sl,d),ao!==null&&oo(ao,d),Ua!==null&&oo(Ua,d),Al.forEach(p),Zu.forEach(p),_=0;_<wl.length;_++)A=wl[_],A.blockedOn===d&&(A.blockedOn=null);for(;0<wl.length&&(_=wl[0],_.blockedOn===null);)Dh(_),_.blockedOn===null&&wl.shift()}var Va=ge.ReactCurrentBatchConfig,Cl=!0;function ud(d,p,_,A){var O=Jn,$=Va.transition;Va.transition=null;try{Jn=1,Ph(d,p,_,A)}finally{Jn=O,Va.transition=$}}function Ih(d,p,_,A){var O=Jn,$=Va.transition;Va.transition=null;try{Jn=4,Ph(d,p,_,A)}finally{Jn=O,Va.transition=$}}function Ph(d,p,_,A){if(Cl){var O=cd(d,p,_,A);if(O===null)ic(d,p,A,Ml,_),Nf(d,A);else if(od(O,d,p,_,A))A.stopPropagation();else if(Nf(d,A),p&4&&-1<Mh.indexOf(d)){for(;O!==null;){var $=j(O);if($!==null&&Ac($),$=cd(d,p,_,A),$===null&&ic(d,p,A,Ml,_),$===O)break;O=$}O!==null&&A.stopPropagation()}else ic(d,p,A,null,_)}}var Ml=null;function cd(d,p,_,A){if(Ml=null,d=Zi(A),d=L(d),d!==null)if(p=nn(d),p===null)d=null;else if(_=p.tag,_===13){if(d=Lr(p),d!==null)return d;d=null}else if(_===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;d=null}else p!==d&&(d=null);return Ml=d,null}function du(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nd()){case rd:return 1;case su:return 4;case bl:case Qu:return 16;case Ah:return 536870912;default:return 16}default:return 16}}var Dl=null,po=null,hu=null;function Uf(){if(hu)return hu;var d,p=po,_=p.length,A,O="value"in Dl?Dl.value:Dl.textContent,$=O.length;for(d=0;d<_&&p[d]===O[d];d++);var ce=_-d;for(A=1;A<=ce&&p[_-A]===O[$-A];A++);return hu=O.slice(d,1<A?1-A:void 0)}function _r(d){var p=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&p===13&&(d=13)):d=p,d===10&&(d=13),32<=d||d===13?d:0}function dd(){return!0}function Vf(){return!1}function Ts(d){function p(_,A,O,$,ce){this._reactName=_,this._targetInst=O,this.type=A,this.nativeEvent=$,this.target=ce,this.currentTarget=null;for(var Fe in d)d.hasOwnProperty(Fe)&&(_=d[Fe],this[Fe]=_?_($):$[Fe]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?dd:Vf,this.isPropagationStopped=Vf,this}return Xe(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=dd)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=dd)},persist:function(){},isPersistent:dd}),p}var mo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wo=Ts(mo),go=Xe({},mo,{view:0,detail:0}),fu=Ts(go),xs,za,ks,$r=Xe({},go,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vo,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==ks&&(ks&&d.type==="mousemove"?(xs=d.screenX-ks.screenX,za=d.screenY-ks.screenY):za=xs=0,ks=d),xs)},movementY:function(d){return"movementY"in d?d.movementY:za}}),qo=Ts($r),Gi=Xe({},$r,{dataTransfer:0}),At=Ts(Gi),Os=Xe({},go,{relatedTarget:0}),Xo=Ts(Os),pu=Xe({},mo,{animationName:0,elapsedTime:0,pseudoElement:0}),hd=Ts(pu),dr=Xe({},mo,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),Ju=Ts(dr),Yn=Xe({},mo,{data:0}),ec=Ts(Yn),Wr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Be={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Lh(d){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(d):(d=fd[d])?!!p[d]:!1}function vo(){return Lh}var pd=Xe({},go,{key:function(d){if(d.key){var p=Wr[d.key]||d.key;if(p!=="Unidentified")return p}return d.type==="keypress"?(d=_r(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Be[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vo,charCode:function(d){return d.type==="keypress"?_r(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?_r(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Ea=Ts(pd),tc=Xe({},$r,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mu=Ts(tc),gu=Xe({},go,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vo}),vu=Ts(gu),yo=Xe({},mo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ca=Ts(yo),Il=Xe({},$r,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),yu=Ts(Il),Ec=[9,13,27,32],Pl=c&&"CompositionEvent"in window,Ll=null;c&&"documentMode"in document&&(Ll=document.documentMode);var _o=c&&"TextEvent"in window&&!Ll,zf=c&&(!Pl||Ll&&8<Ll&&11>=Ll),Rl=" ",Ws=!1;function er(d,p){switch(d){case"keyup":return Ec.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ha(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var br=!1;function Ma(d,p){switch(d){case"compositionend":return Ha(p);case"keypress":return p.which!==32?null:(Ws=!0,Rl);case"textInput":return d=p.data,d===Rl&&Ws?null:d;default:return null}}function md(d,p){if(br)return d==="compositionend"||!Pl&&er(d,p)?(d=Uf(),hu=po=Dl=null,br=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return zf&&p.locale!=="ko"?null:p.data;default:return null}}var gd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yo(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p==="input"?!!gd[d.type]:p==="textarea"}function fn(d,p,_,A){Ye(A),p=yd(p,"onChange"),0<p.length&&(_=new Wo("onChange","change",null,_,A),d.push({event:_,listeners:p}))}var bo=null,ia=null;function Vp(d){Ji(d,0)}function Cc(d){var p=Y(d);if(xi(p))return d}function kl(d,p){if(d==="change")return p}var To=!1;if(c){var le;if(c){var E="oninput"in document;if(!E){var F=document.createElement("div");F.setAttribute("oninput","return;"),E=typeof F.oninput=="function"}le=E}else le=!1;To=le&&(!document.documentMode||9<document.documentMode)}function R(){bo&&(bo.detachEvent("onpropertychange",V),ia=bo=null)}function V(d){if(d.propertyName==="value"&&Cc(ia)){var p=[];fn(p,ia,d,Zi(d)),Kr(Vp,p)}}function Q(d,p,_){d==="focusin"?(R(),bo=p,ia=_,bo.attachEvent("onpropertychange",V)):d==="focusout"&&R()}function ee(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return Cc(ia)}function _e(d,p){if(d==="click")return Cc(p)}function Ce(d,p){if(d==="input"||d==="change")return Cc(p)}function Ve(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var Oe=typeof Object.is=="function"?Object.is:Ve;function Qe(d,p){if(Oe(d,p))return!0;if(typeof d!="object"||d===null||typeof p!="object"||p===null)return!1;var _=Object.keys(d),A=Object.keys(p);if(_.length!==A.length)return!1;for(A=0;A<_.length;A++){var O=_[A];if(!h.call(p,O)||!Oe(d[O],p[O]))return!1}return!0}function kt(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function ui(d,p){var _=kt(d);d=0;for(var A;_;){if(_.nodeType===3){if(A=d+_.textContent.length,d<=p&&A>=p)return{node:_,offset:p-d};d=A}e:{for(;_;){if(_.nextSibling){_=_.nextSibling;break e}_=_.parentNode}_=void 0}_=kt(_)}}function yi(d,p){return d&&p?d===p?!0:d&&d.nodeType===3?!1:p&&p.nodeType===3?yi(d,p.parentNode):"contains"in d?d.contains(p):d.compareDocumentPosition?!!(d.compareDocumentPosition(p)&16):!1:!1}function si(){for(var d=window,p=Yi();p instanceof d.HTMLIFrameElement;){try{var _=typeof p.contentWindow.location.href=="string"}catch{_=!1}if(_)d=p.contentWindow;else break;p=Yi(d.document)}return p}function qi(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p&&(p==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||p==="textarea"||d.contentEditable==="true")}function qr(d){var p=si(),_=d.focusedElem,A=d.selectionRange;if(p!==_&&_&&_.ownerDocument&&yi(_.ownerDocument.documentElement,_)){if(A!==null&&qi(_)){if(p=A.start,d=A.end,d===void 0&&(d=p),"selectionStart"in _)_.selectionStart=p,_.selectionEnd=Math.min(d,_.value.length);else if(d=(p=_.ownerDocument||document)&&p.defaultView||window,d.getSelection){d=d.getSelection();var O=_.textContent.length,$=Math.min(A.start,O);A=A.end===void 0?$:Math.min(A.end,O),!d.extend&&$>A&&(O=A,A=$,$=O),O=ui(_,$);var ce=ui(_,A);O&&ce&&(d.rangeCount!==1||d.anchorNode!==O.node||d.anchorOffset!==O.offset||d.focusNode!==ce.node||d.focusOffset!==ce.offset)&&(p=p.createRange(),p.setStart(O.node,O.offset),d.removeAllRanges(),$>A?(d.addRange(p),d.extend(ce.node,ce.offset)):(p.setEnd(ce.node,ce.offset),d.addRange(p)))}}for(p=[],d=_;d=d.parentNode;)d.nodeType===1&&p.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<p.length;_++)d=p[_],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var Li=c&&"documentMode"in document&&11>=document.documentMode,Ss=null,Mc=null,_u=null,Da=!1;function Ia(d,p,_){var A=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;Da||Ss==null||Ss!==Yi(A)||(A=Ss,"selectionStart"in A&&qi(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),_u&&Qe(_u,A)||(_u=A,A=yd(Mc,"onSelect"),0<A.length&&(p=new Wo("onSelect","select",null,p,_),d.push({event:p,listeners:A}),p.target=Ss)))}function ma(d,p){var _={};return _[d.toLowerCase()]=p.toLowerCase(),_["Webkit"+d]="webkit"+p,_["Moz"+d]="moz"+p,_}var xo={animationend:ma("Animation","AnimationEnd"),animationiteration:ma("Animation","AnimationIteration"),animationstart:ma("Animation","AnimationStart"),transitionend:ma("Transition","TransitionEnd")},sr={},Ol={};c&&(Ol=document.createElement("div").style,"AnimationEvent"in window||(delete xo.animationend.animation,delete xo.animationiteration.animation,delete xo.animationstart.animation),"TransitionEvent"in window||delete xo.transitionend.transition);function Fs(d){if(sr[d])return sr[d];if(!xo[d])return d;var p=xo[d],_;for(_ in p)if(p.hasOwnProperty(_)&&_ in Ol)return sr[d]=p[_];return d}var zp=Fs("animationend"),Hf=Fs("animationiteration"),jf=Fs("animationstart"),Gf=Fs("transitionend"),ga=new Map,Hp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qs(d,p){ga.set(d,p),s(p,[d])}for(var vd=0;vd<Hp.length;vd++){var Rh=Hp[vd],jp=Rh.toLowerCase(),Gp=Rh[0].toUpperCase()+Rh.slice(1);qs(jp,"on"+Gp)}qs(zp,"onAnimationEnd"),qs(Hf,"onAnimationIteration"),qs(jf,"onAnimationStart"),qs("dblclick","onDoubleClick"),qs("focusin","onFocus"),qs("focusout","onBlur"),qs(Gf,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fi));function ig(d,p,_){var A=d.type||"unknown-event";d.currentTarget=_,no(A,p,void 0,d),d.currentTarget=null}function Ji(d,p){p=(p&4)!==0;for(var _=0;_<d.length;_++){var A=d[_],O=A.event;A=A.listeners;e:{var $=void 0;if(p)for(var ce=A.length-1;0<=ce;ce--){var Fe=A[ce],ze=Fe.instance,Et=Fe.currentTarget;if(Fe=Fe.listener,ze!==$&&O.isPropagationStopped())break e;ig(O,Fe,Et),$=ze}else for(ce=0;ce<A.length;ce++){if(Fe=A[ce],ze=Fe.instance,Et=Fe.currentTarget,Fe=Fe.listener,ze!==$&&O.isPropagationStopped())break e;ig(O,Fe,Et),$=ze}}}if(ln)throw d=Fa,ln=!1,Fa=null,d}function Un(d,p){var _=p[S];_===void 0&&(_=p[S]=new Set);var A=d+"__bubble";_.has(A)||(Dc(p,d,2,!1),_.add(A))}function wr(d,p,_){var A=0;p&&(A|=4),Dc(_,d,A,p)}var bu="_reactListening"+Math.random().toString(36).slice(2);function pn(d){if(!d[bu]){d[bu]=!0,i.forEach(function(_){_!=="selectionchange"&&(gv.has(_)||wr(_,!1,d),wr(_,!0,d))});var p=d.nodeType===9?d:d.ownerDocument;p===null||p[bu]||(p[bu]=!0,wr("selectionchange",!1,p))}}function Dc(d,p,_,A){switch(du(p)){case 1:var O=ud;break;case 4:O=Ih;break;default:O=Ph}_=O.bind(null,p,_,d),O=void 0,!wa||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(O=!0),A?O!==void 0?d.addEventListener(p,_,{capture:!0,passive:O}):d.addEventListener(p,_,!0):O!==void 0?d.addEventListener(p,_,{passive:O}):d.addEventListener(p,_,!1)}function ic(d,p,_,A,O){var $=A;if((p&1)===0&&(p&2)===0&&A!==null)e:for(;;){if(A===null)return;var ce=A.tag;if(ce===3||ce===4){var Fe=A.stateNode.containerInfo;if(Fe===O||Fe.nodeType===8&&Fe.parentNode===O)break;if(ce===4)for(ce=A.return;ce!==null;){var ze=ce.tag;if((ze===3||ze===4)&&(ze=ce.stateNode.containerInfo,ze===O||ze.nodeType===8&&ze.parentNode===O))return;ce=ce.return}for(;Fe!==null;){if(ce=L(Fe),ce===null)return;if(ze=ce.tag,ze===5||ze===6){A=$=ce;continue e}Fe=Fe.parentNode}}A=A.return}Kr(function(){var Et=$,Jt=Zi(_),ai=[];e:{var Qt=ga.get(d);if(Qt!==void 0){var wi=Wo,Pi=d;switch(d){case"keypress":if(_r(_)===0)break e;case"keydown":case"keyup":wi=Ea;break;case"focusin":Pi="focus",wi=Xo;break;case"focusout":Pi="blur",wi=Xo;break;case"beforeblur":case"afterblur":wi=Xo;break;case"click":if(_.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":wi=qo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":wi=At;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":wi=vu;break;case zp:case Hf:case jf:wi=hd;break;case Gf:wi=Ca;break;case"scroll":wi=fu;break;case"wheel":wi=yu;break;case"copy":case"cut":case"paste":wi=Ju;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":wi=mu}var Bi=(p&4)!==0,Es=!Bi&&d==="scroll",gt=Bi?Qt!==null?Qt+"Capture":null:Qt;Bi=[];for(var et=Et,yt;et!==null;){yt=et;var ci=yt.stateNode;if(yt.tag===5&&ci!==null&&(yt=ci,gt!==null&&(ci=ur(et,gt),ci!=null&&Bi.push(Ic(et,ci,yt)))),Es)break;et=et.return}0<Bi.length&&(Qt=new wi(Qt,Pi,null,_,Jt),ai.push({event:Qt,listeners:Bi}))}}if((p&7)===0){e:{if(Qt=d==="mouseover"||d==="pointerover",wi=d==="mouseout"||d==="pointerout",Qt&&_!==Ar&&(Pi=_.relatedTarget||_.fromElement)&&(L(Pi)||Pi[na]))break e;if((wi||Qt)&&(Qt=Jt.window===Jt?Jt:(Qt=Jt.ownerDocument)?Qt.defaultView||Qt.parentWindow:window,wi?(Pi=_.relatedTarget||_.toElement,wi=Et,Pi=Pi?L(Pi):null,Pi!==null&&(Es=nn(Pi),Pi!==Es||Pi.tag!==5&&Pi.tag!==6)&&(Pi=null)):(wi=null,Pi=Et),wi!==Pi)){if(Bi=qo,ci="onMouseLeave",gt="onMouseEnter",et="mouse",(d==="pointerout"||d==="pointerover")&&(Bi=mu,ci="onPointerLeave",gt="onPointerEnter",et="pointer"),Es=wi==null?Qt:Y(wi),yt=Pi==null?Qt:Y(Pi),Qt=new Bi(ci,et+"leave",wi,_,Jt),Qt.target=Es,Qt.relatedTarget=yt,ci=null,L(Jt)===Et&&(Bi=new Bi(gt,et+"enter",Pi,_,Jt),Bi.target=yt,Bi.relatedTarget=Es,ci=Bi),Es=ci,wi&&Pi)t:{for(Bi=wi,gt=Pi,et=0,yt=Bi;yt;yt=Fl(yt))et++;for(yt=0,ci=gt;ci;ci=Fl(ci))yt++;for(;0<et-yt;)Bi=Fl(Bi),et--;for(;0<yt-et;)gt=Fl(gt),yt--;for(;et--;){if(Bi===gt||gt!==null&&Bi===gt.alternate)break t;Bi=Fl(Bi),gt=Fl(gt)}Bi=null}else Bi=null;wi!==null&&$f(ai,Qt,wi,Bi,!1),Pi!==null&&Es!==null&&$f(ai,Es,Pi,Bi,!0)}}e:{if(Qt=Et?Y(Et):window,wi=Qt.nodeName&&Qt.nodeName.toLowerCase(),wi==="select"||wi==="input"&&Qt.type==="file")var Ni=kl;else if(Yo(Qt))if(To)Ni=Ce;else{Ni=ee;var $i=Q}else(wi=Qt.nodeName)&&wi.toLowerCase()==="input"&&(Qt.type==="checkbox"||Qt.type==="radio")&&(Ni=_e);if(Ni&&(Ni=Ni(d,Et))){fn(ai,Ni,_,Jt);break e}$i&&$i(d,Qt,Et),d==="focusout"&&($i=Qt._wrapperState)&&$i.controlled&&Qt.type==="number"&&sn(Qt,"number",Qt.value)}switch($i=Et?Y(Et):window,d){case"focusin":(Yo($i)||$i.contentEditable==="true")&&(Ss=$i,Mc=Et,_u=null);break;case"focusout":_u=Mc=Ss=null;break;case"mousedown":Da=!0;break;case"contextmenu":case"mouseup":case"dragend":Da=!1,Ia(ai,_,Jt);break;case"selectionchange":if(Li)break;case"keydown":case"keyup":Ia(ai,_,Jt)}var Wi;if(Pl)e:{switch(d){case"compositionstart":var un="onCompositionStart";break e;case"compositionend":un="onCompositionEnd";break e;case"compositionupdate":un="onCompositionUpdate";break e}un=void 0}else br?er(d,_)&&(un="onCompositionEnd"):d==="keydown"&&_.keyCode===229&&(un="onCompositionStart");un&&(zf&&_.locale!=="ko"&&(br||un!=="onCompositionStart"?un==="onCompositionEnd"&&br&&(Wi=Uf()):(Dl=Jt,po="value"in Dl?Dl.value:Dl.textContent,br=!0)),$i=yd(Et,un),0<$i.length&&(un=new ec(un,d,null,_,Jt),ai.push({event:un,listeners:$i}),Wi?un.data=Wi:(Wi=Ha(_),Wi!==null&&(un.data=Wi)))),(Wi=_o?Ma(d,_):md(d,_))&&(Et=yd(Et,"onBeforeInput"),0<Et.length&&(Jt=new ec("onBeforeInput","beforeinput",null,_,Jt),ai.push({event:Jt,listeners:Et}),Jt.data=Wi))}Ji(ai,p)})}function Ic(d,p,_){return{instance:d,listener:p,currentTarget:_}}function yd(d,p){for(var _=p+"Capture",A=[];d!==null;){var O=d,$=O.stateNode;O.tag===5&&$!==null&&(O=$,$=ur(d,_),$!=null&&A.unshift(Ic(d,$,O)),$=ur(d,p),$!=null&&A.push(Ic(d,$,O))),d=d.return}return A}function Fl(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function $f(d,p,_,A,O){for(var $=p._reactName,ce=[];_!==null&&_!==A;){var Fe=_,ze=Fe.alternate,Et=Fe.stateNode;if(ze!==null&&ze===A)break;Fe.tag===5&&Et!==null&&(Fe=Et,O?(ze=ur(_,$),ze!=null&&ce.unshift(Ic(_,ze,Fe))):O||(ze=ur(_,$),ze!=null&&ce.push(Ic(_,ze,Fe)))),_=_.return}ce.length!==0&&d.push({event:p,listeners:ce})}var kh=/\r\n?/g,_d=/\u0000|\uFFFD/g;function Xr(d){return(typeof d=="string"?d:""+d).replace(kh,`
`).replace(_d,"")}function bd(d,p,_){if(p=Xr(p),Xr(d)!==p&&_)throw Error(t(425))}function Td(){}var nc=null,tr=null;function Tu(d,p){return d==="textarea"||d==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var Rr=typeof setTimeout=="function"?setTimeout:void 0,So=typeof clearTimeout=="function"?clearTimeout:void 0,Pc=typeof Promise=="function"?Promise:void 0,ja=typeof queueMicrotask=="function"?queueMicrotask:typeof Pc<"u"?function(d){return Pc.resolve(null).then(d).catch(Oh)}:Rr;function Oh(d){setTimeout(function(){throw d})}function As(d,p){var _=p,A=0;do{var O=_.nextSibling;if(d.removeChild(_),O&&O.nodeType===8)if(_=O.data,_==="/$"){if(A===0){d.removeChild(O),$s(p);return}A--}else _!=="$"&&_!=="$?"&&_!=="$!"||A++;_=O}while(_);$s(p)}function $n(d){for(;d!=null;d=d.nextSibling){var p=d.nodeType;if(p===1||p===3)break;if(p===8){if(p=d.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return d}function $p(d){d=d.previousSibling;for(var p=0;d;){if(d.nodeType===8){var _=d.data;if(_==="$"||_==="$!"||_==="$?"){if(p===0)return d;p--}else _==="/$"&&p++}d=d.previousSibling}return null}var Qo=Math.random().toString(36).slice(2),Ao="__reactFiber$"+Qo,wo="__reactProps$"+Qo,na="__reactContainer$"+Qo,S="__reactEvents$"+Qo,D="__reactListeners$"+Qo,k="__reactHandles$"+Qo;function L(d){var p=d[Ao];if(p)return p;for(var _=d.parentNode;_;){if(p=_[na]||_[Ao]){if(_=p.alternate,p.child!==null||_!==null&&_.child!==null)for(d=$p(d);d!==null;){if(_=d[Ao])return _;d=$p(d)}return p}d=_,_=d.parentNode}return null}function j(d){return d=d[Ao]||d[na],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function Y(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(t(33))}function ye(d){return d[wo]||null}var Te=[],Me=-1;function Le(d){return{current:d}}function Ge(d){0>Me||(d.current=Te[Me],Te[Me]=null,Me--)}function pt(d,p){Me++,Te[Me]=d.current,d.current=p}var Gt={},Rt=Le(Gt),Mi=Le(!1),Xi=Gt;function Er(d,p){var _=d.type.contextTypes;if(!_)return Gt;var A=d.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===p)return A.__reactInternalMemoizedMaskedChildContext;var O={},$;for($ in _)O[$]=p[$];return A&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=p,d.__reactInternalMemoizedMaskedChildContext=O),O}function xn(d){return d=d.childContextTypes,d!=null}function Ko(){Ge(Mi),Ge(Rt)}function xd(d,p,_){if(Rt.current!==Gt)throw Error(t(168));pt(Rt,p),pt(Mi,_)}function Sd(d,p,_){var A=d.stateNode;if(p=p.childContextTypes,typeof A.getChildContext!="function")return _;A=A.getChildContext();for(var O in A)if(!(O in p))throw Error(t(108,bt(d)||"Unknown",O));return Xe({},_,A)}function rs(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||Gt,Xi=Rt.current,pt(Rt,d),pt(Mi,Mi.current),!0}function lo(d,p,_){var A=d.stateNode;if(!A)throw Error(t(169));_?(d=Sd(d,p,Xi),A.__reactInternalMemoizedMergedChildContext=d,Ge(Mi),Ge(Rt),pt(Rt,d)):Ge(Mi),pt(Mi,_)}var fr=null,ar=!1,Eo=!1;function ra(d){fr===null?fr=[d]:fr.push(d)}function Ad(d){ar=!0,ra(d)}function wd(){if(!Eo&&fr!==null){Eo=!0;var d=0,p=Jn;try{var _=fr;for(Jn=1;d<_.length;d++){var A=_[d];do A=A(!0);while(A!==null)}fr=null,ar=!1}catch(O){throw fr!==null&&(fr=fr.slice(d+1)),rr(rd,wd),O}finally{Jn=p,Eo=!1}}return null}var xu=[],Su=0,Fh=null,Bh=0,Zo=[],Bl=0,Nh=null,Lc=1,Rc="";function Uh(d,p){xu[Su++]=Bh,xu[Su++]=Fh,Fh=d,Bh=p}function sb(d,p,_){Zo[Bl++]=Lc,Zo[Bl++]=Rc,Zo[Bl++]=Nh,Nh=d;var A=Lc;d=Rc;var O=32-Gs(A)-1;A&=~(1<<O),_+=1;var $=32-Gs(p)+O;if(30<$){var ce=O-O%5;$=(A&(1<<ce)-1).toString(32),A>>=ce,O-=ce,Lc=1<<32-Gs(p)+O|_<<O|A,Rc=$+d}else Lc=1<<$|_<<O|A,Rc=d}function vv(d){d.return!==null&&(Uh(d,1),sb(d,1,0))}function yv(d){for(;d===Fh;)Fh=xu[--Su],xu[Su]=null,Bh=xu[--Su],xu[Su]=null;for(;d===Nh;)Nh=Zo[--Bl],Zo[Bl]=null,Rc=Zo[--Bl],Zo[Bl]=null,Lc=Zo[--Bl],Zo[Bl]=null}var Jo=null,el=null,ss=!1,Au=null;function ab(d,p){var _=nl(5,null,null,0);_.elementType="DELETED",_.stateNode=p,_.return=d,p=d.deletions,p===null?(d.deletions=[_],d.flags|=16):p.push(_)}function ob(d,p){switch(d.tag){case 5:var _=d.type;return p=p.nodeType!==1||_.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(d.stateNode=p,Jo=d,el=$n(p.firstChild),!0):!1;case 6:return p=d.pendingProps===""||p.nodeType!==3?null:p,p!==null?(d.stateNode=p,Jo=d,el=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(_=Nh!==null?{id:Lc,overflow:Rc}:null,d.memoizedState={dehydrated:p,treeContext:_,retryLane:1073741824},_=nl(18,null,null,0),_.stateNode=p,_.return=d,d.child=_,Jo=d,el=null,!0):!1;default:return!1}}function _v(d){return(d.mode&1)!==0&&(d.flags&128)===0}function bv(d){if(ss){var p=el;if(p){var _=p;if(!ob(d,p)){if(_v(d))throw Error(t(418));p=$n(_.nextSibling);var A=Jo;p&&ob(d,p)?ab(A,_):(d.flags=d.flags&-4097|2,ss=!1,Jo=d)}}else{if(_v(d))throw Error(t(418));d.flags=d.flags&-4097|2,ss=!1,Jo=d}}}function lb(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;Jo=d}function ng(d){if(d!==Jo)return!1;if(!ss)return lb(d),ss=!0,!1;var p;if((p=d.tag!==3)&&!(p=d.tag!==5)&&(p=d.type,p=p!=="head"&&p!=="body"&&!Tu(d.type,d.memoizedProps)),p&&(p=el)){if(_v(d))throw ub(),Error(t(418));for(;p;)ab(d,p),p=$n(p.nextSibling)}if(lb(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(t(317));e:{for(d=d.nextSibling,p=0;d;){if(d.nodeType===8){var _=d.data;if(_==="/$"){if(p===0){el=$n(d.nextSibling);break e}p--}else _!=="$"&&_!=="$!"&&_!=="$?"||p++}d=d.nextSibling}el=null}}else el=Jo?$n(d.stateNode.nextSibling):null;return!0}function ub(){for(var d=el;d;)d=$n(d.nextSibling)}function Wf(){el=Jo=null,ss=!1}function Tv(d){Au===null?Au=[d]:Au.push(d)}var IS=ge.ReactCurrentBatchConfig;function Wp(d,p,_){if(d=_.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(_._owner){if(_=_._owner,_){if(_.tag!==1)throw Error(t(309));var A=_.stateNode}if(!A)throw Error(t(147,d));var O=A,$=""+d;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===$?p.ref:(p=function(ce){var Fe=O.refs;ce===null?delete Fe[$]:Fe[$]=ce},p._stringRef=$,p)}if(typeof d!="string")throw Error(t(284));if(!_._owner)throw Error(t(290,d))}return d}function rg(d,p){throw d=Object.prototype.toString.call(p),Error(t(31,d==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":d))}function cb(d){var p=d._init;return p(d._payload)}function db(d){function p(gt,et){if(d){var yt=gt.deletions;yt===null?(gt.deletions=[et],gt.flags|=16):yt.push(et)}}function _(gt,et){if(!d)return null;for(;et!==null;)p(gt,et),et=et.sibling;return null}function A(gt,et){for(gt=new Map;et!==null;)et.key!==null?gt.set(et.key,et):gt.set(et.index,et),et=et.sibling;return gt}function O(gt,et){return gt=Io(gt,et),gt.index=0,gt.sibling=null,gt}function $(gt,et,yt){return gt.index=yt,d?(yt=gt.alternate,yt!==null?(yt=yt.index,yt<et?(gt.flags|=2,et):yt):(gt.flags|=2,et)):(gt.flags|=1048576,et)}function ce(gt){return d&&gt.alternate===null&&(gt.flags|=2),gt}function Fe(gt,et,yt,ci){return et===null||et.tag!==6?(et=Yh(yt,gt.mode,ci),et.return=gt,et):(et=O(et,yt),et.return=gt,et)}function ze(gt,et,yt,ci){var Ni=yt.type;return Ni===fe?Jt(gt,et,yt.props.children,ci,yt.key):et!==null&&(et.elementType===Ni||typeof Ni=="object"&&Ni!==null&&Ni.$$typeof===vt&&cb(Ni)===et.type)?(ci=O(et,yt.props),ci.ref=Wp(gt,et,yt),ci.return=gt,ci):(ci=lc(yt.type,yt.key,yt.props,null,gt.mode,ci),ci.ref=Wp(gt,et,yt),ci.return=gt,ci)}function Et(gt,et,yt,ci){return et===null||et.tag!==4||et.stateNode.containerInfo!==yt.containerInfo||et.stateNode.implementation!==yt.implementation?(et=Bd(yt,gt.mode,ci),et.return=gt,et):(et=O(et,yt.children||[]),et.return=gt,et)}function Jt(gt,et,yt,ci,Ni){return et===null||et.tag!==7?(et=rl(yt,gt.mode,ci,Ni),et.return=gt,et):(et=O(et,yt),et.return=gt,et)}function ai(gt,et,yt){if(typeof et=="string"&&et!==""||typeof et=="number")return et=Yh(""+et,gt.mode,yt),et.return=gt,et;if(typeof et=="object"&&et!==null){switch(et.$$typeof){case ue:return yt=lc(et.type,et.key,et.props,null,gt.mode,yt),yt.ref=Wp(gt,null,et),yt.return=gt,yt;case be:return et=Bd(et,gt.mode,yt),et.return=gt,et;case vt:var ci=et._init;return ai(gt,ci(et._payload),yt)}if(dn(et)||it(et))return et=rl(et,gt.mode,yt,null),et.return=gt,et;rg(gt,et)}return null}function Qt(gt,et,yt,ci){var Ni=et!==null?et.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number")return Ni!==null?null:Fe(gt,et,""+yt,ci);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case ue:return yt.key===Ni?ze(gt,et,yt,ci):null;case be:return yt.key===Ni?Et(gt,et,yt,ci):null;case vt:return Ni=yt._init,Qt(gt,et,Ni(yt._payload),ci)}if(dn(yt)||it(yt))return Ni!==null?null:Jt(gt,et,yt,ci,null);rg(gt,yt)}return null}function wi(gt,et,yt,ci,Ni){if(typeof ci=="string"&&ci!==""||typeof ci=="number")return gt=gt.get(yt)||null,Fe(et,gt,""+ci,Ni);if(typeof ci=="object"&&ci!==null){switch(ci.$$typeof){case ue:return gt=gt.get(ci.key===null?yt:ci.key)||null,ze(et,gt,ci,Ni);case be:return gt=gt.get(ci.key===null?yt:ci.key)||null,Et(et,gt,ci,Ni);case vt:var $i=ci._init;return wi(gt,et,yt,$i(ci._payload),Ni)}if(dn(ci)||it(ci))return gt=gt.get(yt)||null,Jt(et,gt,ci,Ni,null);rg(et,ci)}return null}function Pi(gt,et,yt,ci){for(var Ni=null,$i=null,Wi=et,un=et=0,la=null;Wi!==null&&un<yt.length;un++){Wi.index>un?(la=Wi,Wi=null):la=Wi.sibling;var hr=Qt(gt,Wi,yt[un],ci);if(hr===null){Wi===null&&(Wi=la);break}d&&Wi&&hr.alternate===null&&p(gt,Wi),et=$(hr,et,un),$i===null?Ni=hr:$i.sibling=hr,$i=hr,Wi=la}if(un===yt.length)return _(gt,Wi),ss&&Uh(gt,un),Ni;if(Wi===null){for(;un<yt.length;un++)Wi=ai(gt,yt[un],ci),Wi!==null&&(et=$(Wi,et,un),$i===null?Ni=Wi:$i.sibling=Wi,$i=Wi);return ss&&Uh(gt,un),Ni}for(Wi=A(gt,Wi);un<yt.length;un++)la=wi(Wi,gt,un,yt[un],ci),la!==null&&(d&&la.alternate!==null&&Wi.delete(la.key===null?un:la.key),et=$(la,et,un),$i===null?Ni=la:$i.sibling=la,$i=la);return d&&Wi.forEach(function(zl){return p(gt,zl)}),ss&&Uh(gt,un),Ni}function Bi(gt,et,yt,ci){var Ni=it(yt);if(typeof Ni!="function")throw Error(t(150));if(yt=Ni.call(yt),yt==null)throw Error(t(151));for(var $i=Ni=null,Wi=et,un=et=0,la=null,hr=yt.next();Wi!==null&&!hr.done;un++,hr=yt.next()){Wi.index>un?(la=Wi,Wi=null):la=Wi.sibling;var zl=Qt(gt,Wi,hr.value,ci);if(zl===null){Wi===null&&(Wi=la);break}d&&Wi&&zl.alternate===null&&p(gt,Wi),et=$(zl,et,un),$i===null?Ni=zl:$i.sibling=zl,$i=zl,Wi=la}if(hr.done)return _(gt,Wi),ss&&Uh(gt,un),Ni;if(Wi===null){for(;!hr.done;un++,hr=yt.next())hr=ai(gt,hr.value,ci),hr!==null&&(et=$(hr,et,un),$i===null?Ni=hr:$i.sibling=hr,$i=hr);return ss&&Uh(gt,un),Ni}for(Wi=A(gt,Wi);!hr.done;un++,hr=yt.next())hr=wi(Wi,gt,un,hr.value,ci),hr!==null&&(d&&hr.alternate!==null&&Wi.delete(hr.key===null?un:hr.key),et=$(hr,et,un),$i===null?Ni=hr:$i.sibling=hr,$i=hr);return d&&Wi.forEach(function(Mg){return p(gt,Mg)}),ss&&Uh(gt,un),Ni}function Es(gt,et,yt,ci){if(typeof yt=="object"&&yt!==null&&yt.type===fe&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case ue:e:{for(var Ni=yt.key,$i=et;$i!==null;){if($i.key===Ni){if(Ni=yt.type,Ni===fe){if($i.tag===7){_(gt,$i.sibling),et=O($i,yt.props.children),et.return=gt,gt=et;break e}}else if($i.elementType===Ni||typeof Ni=="object"&&Ni!==null&&Ni.$$typeof===vt&&cb(Ni)===$i.type){_(gt,$i.sibling),et=O($i,yt.props),et.ref=Wp(gt,$i,yt),et.return=gt,gt=et;break e}_(gt,$i);break}else p(gt,$i);$i=$i.sibling}yt.type===fe?(et=rl(yt.props.children,gt.mode,ci,yt.key),et.return=gt,gt=et):(ci=lc(yt.type,yt.key,yt.props,null,gt.mode,ci),ci.ref=Wp(gt,et,yt),ci.return=gt,gt=ci)}return ce(gt);case be:e:{for($i=yt.key;et!==null;){if(et.key===$i)if(et.tag===4&&et.stateNode.containerInfo===yt.containerInfo&&et.stateNode.implementation===yt.implementation){_(gt,et.sibling),et=O(et,yt.children||[]),et.return=gt,gt=et;break e}else{_(gt,et);break}else p(gt,et);et=et.sibling}et=Bd(yt,gt.mode,ci),et.return=gt,gt=et}return ce(gt);case vt:return $i=yt._init,Es(gt,et,$i(yt._payload),ci)}if(dn(yt))return Pi(gt,et,yt,ci);if(it(yt))return Bi(gt,et,yt,ci);rg(gt,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"?(yt=""+yt,et!==null&&et.tag===6?(_(gt,et.sibling),et=O(et,yt),et.return=gt,gt=et):(_(gt,et),et=Yh(yt,gt.mode,ci),et.return=gt,gt=et),ce(gt)):_(gt,et)}return Es}var qf=db(!0),hb=db(!1),sg=Le(null),ag=null,Xf=null,xv=null;function Sv(){xv=Xf=ag=null}function Av(d){var p=sg.current;Ge(sg),d._currentValue=p}function wv(d,p,_){for(;d!==null;){var A=d.alternate;if((d.childLanes&p)!==p?(d.childLanes|=p,A!==null&&(A.childLanes|=p)):A!==null&&(A.childLanes&p)!==p&&(A.childLanes|=p),d===_)break;d=d.return}}function Yf(d,p){ag=d,xv=Xf=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&p)!==0&&(hi=!0),d.firstContext=null)}function Nl(d){var p=d._currentValue;if(xv!==d)if(d={context:d,memoizedValue:p,next:null},Xf===null){if(ag===null)throw Error(t(308));Xf=d,ag.dependencies={lanes:0,firstContext:d}}else Xf=Xf.next=d;return p}var Vh=null;function Ev(d){Vh===null?Vh=[d]:Vh.push(d)}function fb(d,p,_,A){var O=p.interleaved;return O===null?(_.next=_,Ev(p)):(_.next=O.next,O.next=_),p.interleaved=_,kc(d,A)}function kc(d,p){d.lanes|=p;var _=d.alternate;for(_!==null&&(_.lanes|=p),_=d,d=d.return;d!==null;)d.childLanes|=p,_=d.alternate,_!==null&&(_.childLanes|=p),_=d,d=d.return;return _.tag===3?_.stateNode:null}var Ed=!1;function Cv(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pb(d,p){d=d.updateQueue,p.updateQueue===d&&(p.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function Oc(d,p){return{eventTime:d,lane:p,tag:0,payload:null,callback:null,next:null}}function Cd(d,p,_){var A=d.updateQueue;if(A===null)return null;if(A=A.shared,(or&2)!==0){var O=A.pending;return O===null?p.next=p:(p.next=O.next,O.next=p),A.pending=p,kc(d,_)}return O=A.interleaved,O===null?(p.next=p,Ev(A)):(p.next=O.next,O.next=p),A.interleaved=p,kc(d,_)}function og(d,p,_){if(p=p.updateQueue,p!==null&&(p=p.shared,(_&4194240)!==0)){var A=p.lanes;A&=d.pendingLanes,_|=A,p.lanes=_,wh(d,_)}}function mb(d,p){var _=d.updateQueue,A=d.alternate;if(A!==null&&(A=A.updateQueue,_===A)){var O=null,$=null;if(_=_.firstBaseUpdate,_!==null){do{var ce={eventTime:_.eventTime,lane:_.lane,tag:_.tag,payload:_.payload,callback:_.callback,next:null};$===null?O=$=ce:$=$.next=ce,_=_.next}while(_!==null);$===null?O=$=p:$=$.next=p}else O=$=p;_={baseState:A.baseState,firstBaseUpdate:O,lastBaseUpdate:$,shared:A.shared,effects:A.effects},d.updateQueue=_;return}d=_.lastBaseUpdate,d===null?_.firstBaseUpdate=p:d.next=p,_.lastBaseUpdate=p}function lg(d,p,_,A){var O=d.updateQueue;Ed=!1;var $=O.firstBaseUpdate,ce=O.lastBaseUpdate,Fe=O.shared.pending;if(Fe!==null){O.shared.pending=null;var ze=Fe,Et=ze.next;ze.next=null,ce===null?$=Et:ce.next=Et,ce=ze;var Jt=d.alternate;Jt!==null&&(Jt=Jt.updateQueue,Fe=Jt.lastBaseUpdate,Fe!==ce&&(Fe===null?Jt.firstBaseUpdate=Et:Fe.next=Et,Jt.lastBaseUpdate=ze))}if($!==null){var ai=O.baseState;ce=0,Jt=Et=ze=null,Fe=$;do{var Qt=Fe.lane,wi=Fe.eventTime;if((A&Qt)===Qt){Jt!==null&&(Jt=Jt.next={eventTime:wi,lane:0,tag:Fe.tag,payload:Fe.payload,callback:Fe.callback,next:null});e:{var Pi=d,Bi=Fe;switch(Qt=p,wi=_,Bi.tag){case 1:if(Pi=Bi.payload,typeof Pi=="function"){ai=Pi.call(wi,ai,Qt);break e}ai=Pi;break e;case 3:Pi.flags=Pi.flags&-65537|128;case 0:if(Pi=Bi.payload,Qt=typeof Pi=="function"?Pi.call(wi,ai,Qt):Pi,Qt==null)break e;ai=Xe({},ai,Qt);break e;case 2:Ed=!0}}Fe.callback!==null&&Fe.lane!==0&&(d.flags|=64,Qt=O.effects,Qt===null?O.effects=[Fe]:Qt.push(Fe))}else wi={eventTime:wi,lane:Qt,tag:Fe.tag,payload:Fe.payload,callback:Fe.callback,next:null},Jt===null?(Et=Jt=wi,ze=ai):Jt=Jt.next=wi,ce|=Qt;if(Fe=Fe.next,Fe===null){if(Fe=O.shared.pending,Fe===null)break;Qt=Fe,Fe=Qt.next,Qt.next=null,O.lastBaseUpdate=Qt,O.shared.pending=null}}while(!0);if(Jt===null&&(ze=ai),O.baseState=ze,O.firstBaseUpdate=Et,O.lastBaseUpdate=Jt,p=O.shared.interleaved,p!==null){O=p;do ce|=O.lane,O=O.next;while(O!==p)}else $===null&&(O.shared.lanes=0);Id|=ce,d.lanes=ce,d.memoizedState=ai}}function gb(d,p,_){if(d=p.effects,p.effects=null,d!==null)for(p=0;p<d.length;p++){var A=d[p],O=A.callback;if(O!==null){if(A.callback=null,A=_,typeof O!="function")throw Error(t(191,O));O.call(A)}}}var qp={},rc=Le(qp),Xp=Le(qp),Yp=Le(qp);function zh(d){if(d===qp)throw Error(t(174));return d}function Mv(d,p){switch(pt(Yp,p),pt(Xp,d),pt(rc,qp),d=p.nodeType,d){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:ds(null,"");break;default:d=d===8?p.parentNode:p,p=d.namespaceURI||null,d=d.tagName,p=ds(p,d)}Ge(rc),pt(rc,p)}function Qf(){Ge(rc),Ge(Xp),Ge(Yp)}function vb(d){zh(Yp.current);var p=zh(rc.current),_=ds(p,d.type);p!==_&&(pt(Xp,d),pt(rc,_))}function Dv(d){Xp.current===d&&(Ge(rc),Ge(Xp))}var hs=Le(0);function ug(d){for(var p=d;p!==null;){if(p.tag===13){var _=p.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||_.data==="$?"||_.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var Iv=[];function Pv(){for(var d=0;d<Iv.length;d++)Iv[d]._workInProgressVersionPrimary=null;Iv.length=0}var cg=ge.ReactCurrentDispatcher,Lv=ge.ReactCurrentBatchConfig,Hh=0,fs=null,sa=null,va=null,dg=!1,Qp=!1,Kp=0,PS=0;function Ga(){throw Error(t(321))}function Rv(d,p){if(p===null)return!1;for(var _=0;_<p.length&&_<d.length;_++)if(!Oe(d[_],p[_]))return!1;return!0}function kv(d,p,_,A,O,$){if(Hh=$,fs=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,cg.current=d===null||d.memoizedState===null?OS:FS,d=_(A,O),Qp){$=0;do{if(Qp=!1,Kp=0,25<=$)throw Error(t(301));$+=1,va=sa=null,p.updateQueue=null,cg.current=BS,d=_(A,O)}while(Qp)}if(cg.current=pg,p=sa!==null&&sa.next!==null,Hh=0,va=sa=fs=null,dg=!1,p)throw Error(t(300));return d}function Ov(){var d=Kp!==0;return Kp=0,d}function sc(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return va===null?fs.memoizedState=va=d:va=va.next=d,va}function Ul(){if(sa===null){var d=fs.alternate;d=d!==null?d.memoizedState:null}else d=sa.next;var p=va===null?fs.memoizedState:va.next;if(p!==null)va=p,sa=d;else{if(d===null)throw Error(t(310));sa=d,d={memoizedState:sa.memoizedState,baseState:sa.baseState,baseQueue:sa.baseQueue,queue:sa.queue,next:null},va===null?fs.memoizedState=va=d:va=va.next=d}return va}function Zp(d,p){return typeof p=="function"?p(d):p}function Fv(d){var p=Ul(),_=p.queue;if(_===null)throw Error(t(311));_.lastRenderedReducer=d;var A=sa,O=A.baseQueue,$=_.pending;if($!==null){if(O!==null){var ce=O.next;O.next=$.next,$.next=ce}A.baseQueue=O=$,_.pending=null}if(O!==null){$=O.next,A=A.baseState;var Fe=ce=null,ze=null,Et=$;do{var Jt=Et.lane;if((Hh&Jt)===Jt)ze!==null&&(ze=ze.next={lane:0,action:Et.action,hasEagerState:Et.hasEagerState,eagerState:Et.eagerState,next:null}),A=Et.hasEagerState?Et.eagerState:d(A,Et.action);else{var ai={lane:Jt,action:Et.action,hasEagerState:Et.hasEagerState,eagerState:Et.eagerState,next:null};ze===null?(Fe=ze=ai,ce=A):ze=ze.next=ai,fs.lanes|=Jt,Id|=Jt}Et=Et.next}while(Et!==null&&Et!==$);ze===null?ce=A:ze.next=Fe,Oe(A,p.memoizedState)||(hi=!0),p.memoizedState=A,p.baseState=ce,p.baseQueue=ze,_.lastRenderedState=A}if(d=_.interleaved,d!==null){O=d;do $=O.lane,fs.lanes|=$,Id|=$,O=O.next;while(O!==d)}else O===null&&(_.lanes=0);return[p.memoizedState,_.dispatch]}function Bv(d){var p=Ul(),_=p.queue;if(_===null)throw Error(t(311));_.lastRenderedReducer=d;var A=_.dispatch,O=_.pending,$=p.memoizedState;if(O!==null){_.pending=null;var ce=O=O.next;do $=d($,ce.action),ce=ce.next;while(ce!==O);Oe($,p.memoizedState)||(hi=!0),p.memoizedState=$,p.baseQueue===null&&(p.baseState=$),_.lastRenderedState=$}return[$,A]}function yb(){}function _b(d,p){var _=fs,A=Ul(),O=p(),$=!Oe(A.memoizedState,O);if($&&(A.memoizedState=O,hi=!0),A=A.queue,Nv(xb.bind(null,_,A,d),[d]),A.getSnapshot!==p||$||va!==null&&va.memoizedState.tag&1){if(_.flags|=2048,Jp(9,Tb.bind(null,_,A,O,p),void 0,null),aa===null)throw Error(t(349));(Hh&30)!==0||bb(_,p,O)}return O}function bb(d,p,_){d.flags|=16384,d={getSnapshot:p,value:_},p=fs.updateQueue,p===null?(p={lastEffect:null,stores:null},fs.updateQueue=p,p.stores=[d]):(_=p.stores,_===null?p.stores=[d]:_.push(d))}function Tb(d,p,_,A){p.value=_,p.getSnapshot=A,Sb(p)&&Ab(d)}function xb(d,p,_){return _(function(){Sb(p)&&Ab(d)})}function Sb(d){var p=d.getSnapshot;d=d.value;try{var _=p();return!Oe(d,_)}catch{return!0}}function Ab(d){var p=kc(d,1);p!==null&&Mu(p,d,1,-1)}function wb(d){var p=sc();return typeof d=="function"&&(d=d()),p.memoizedState=p.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zp,lastRenderedState:d},p.queue=d,d=d.dispatch=kS.bind(null,fs,d),[p.memoizedState,d]}function Jp(d,p,_,A){return d={tag:d,create:p,destroy:_,deps:A,next:null},p=fs.updateQueue,p===null?(p={lastEffect:null,stores:null},fs.updateQueue=p,p.lastEffect=d.next=d):(_=p.lastEffect,_===null?p.lastEffect=d.next=d:(A=_.next,_.next=d,d.next=A,p.lastEffect=d)),d}function Eb(){return Ul().memoizedState}function hg(d,p,_,A){var O=sc();fs.flags|=d,O.memoizedState=Jp(1|p,_,void 0,A===void 0?null:A)}function fg(d,p,_,A){var O=Ul();A=A===void 0?null:A;var $=void 0;if(sa!==null){var ce=sa.memoizedState;if($=ce.destroy,A!==null&&Rv(A,ce.deps)){O.memoizedState=Jp(p,_,$,A);return}}fs.flags|=d,O.memoizedState=Jp(1|p,_,$,A)}function Cb(d,p){return hg(8390656,8,d,p)}function Nv(d,p){return fg(2048,8,d,p)}function Mb(d,p){return fg(4,2,d,p)}function Db(d,p){return fg(4,4,d,p)}function Ib(d,p){if(typeof p=="function")return d=d(),p(d),function(){p(null)};if(p!=null)return d=d(),p.current=d,function(){p.current=null}}function Pb(d,p,_){return _=_!=null?_.concat([d]):null,fg(4,4,Ib.bind(null,p,d),_)}function Uv(){}function Lb(d,p){var _=Ul();p=p===void 0?null:p;var A=_.memoizedState;return A!==null&&p!==null&&Rv(p,A[1])?A[0]:(_.memoizedState=[d,p],d)}function Rb(d,p){var _=Ul();p=p===void 0?null:p;var A=_.memoizedState;return A!==null&&p!==null&&Rv(p,A[1])?A[0]:(d=d(),_.memoizedState=[d,p],d)}function kb(d,p,_){return(Hh&21)===0?(d.baseState&&(d.baseState=!1,hi=!0),d.memoizedState=_):(Oe(_,p)||(_=Bf(),fs.lanes|=_,Id|=_,d.baseState=!0),p)}function LS(d,p){var _=Jn;Jn=_!==0&&4>_?_:4,d(!0);var A=Lv.transition;Lv.transition={};try{d(!1),p()}finally{Jn=_,Lv.transition=A}}function Ob(){return Ul().memoizedState}function RS(d,p,_){var A=kd(d);if(_={lane:A,action:_,hasEagerState:!1,eagerState:null,next:null},Fb(d))Bb(p,_);else if(_=fb(d,p,_,A),_!==null){var O=qa();Mu(_,d,A,O),Nb(_,p,A)}}function kS(d,p,_){var A=kd(d),O={lane:A,action:_,hasEagerState:!1,eagerState:null,next:null};if(Fb(d))Bb(p,O);else{var $=d.alternate;if(d.lanes===0&&($===null||$.lanes===0)&&($=p.lastRenderedReducer,$!==null))try{var ce=p.lastRenderedState,Fe=$(ce,_);if(O.hasEagerState=!0,O.eagerState=Fe,Oe(Fe,ce)){var ze=p.interleaved;ze===null?(O.next=O,Ev(p)):(O.next=ze.next,ze.next=O),p.interleaved=O;return}}catch{}finally{}_=fb(d,p,O,A),_!==null&&(O=qa(),Mu(_,d,A,O),Nb(_,p,A))}}function Fb(d){var p=d.alternate;return d===fs||p!==null&&p===fs}function Bb(d,p){Qp=dg=!0;var _=d.pending;_===null?p.next=p:(p.next=_.next,_.next=p),d.pending=p}function Nb(d,p,_){if((_&4194240)!==0){var A=p.lanes;A&=d.pendingLanes,_|=A,p.lanes=_,wh(d,_)}}var pg={readContext:Nl,useCallback:Ga,useContext:Ga,useEffect:Ga,useImperativeHandle:Ga,useInsertionEffect:Ga,useLayoutEffect:Ga,useMemo:Ga,useReducer:Ga,useRef:Ga,useState:Ga,useDebugValue:Ga,useDeferredValue:Ga,useTransition:Ga,useMutableSource:Ga,useSyncExternalStore:Ga,useId:Ga,unstable_isNewReconciler:!1},OS={readContext:Nl,useCallback:function(d,p){return sc().memoizedState=[d,p===void 0?null:p],d},useContext:Nl,useEffect:Cb,useImperativeHandle:function(d,p,_){return _=_!=null?_.concat([d]):null,hg(4194308,4,Ib.bind(null,p,d),_)},useLayoutEffect:function(d,p){return hg(4194308,4,d,p)},useInsertionEffect:function(d,p){return hg(4,2,d,p)},useMemo:function(d,p){var _=sc();return p=p===void 0?null:p,d=d(),_.memoizedState=[d,p],d},useReducer:function(d,p,_){var A=sc();return p=_!==void 0?_(p):p,A.memoizedState=A.baseState=p,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:p},A.queue=d,d=d.dispatch=RS.bind(null,fs,d),[A.memoizedState,d]},useRef:function(d){var p=sc();return d={current:d},p.memoizedState=d},useState:wb,useDebugValue:Uv,useDeferredValue:function(d){return sc().memoizedState=d},useTransition:function(){var d=wb(!1),p=d[0];return d=LS.bind(null,d[1]),sc().memoizedState=d,[p,d]},useMutableSource:function(){},useSyncExternalStore:function(d,p,_){var A=fs,O=sc();if(ss){if(_===void 0)throw Error(t(407));_=_()}else{if(_=p(),aa===null)throw Error(t(349));(Hh&30)!==0||bb(A,p,_)}O.memoizedState=_;var $={value:_,getSnapshot:p};return O.queue=$,Cb(xb.bind(null,A,$,d),[d]),A.flags|=2048,Jp(9,Tb.bind(null,A,$,_,p),void 0,null),_},useId:function(){var d=sc(),p=aa.identifierPrefix;if(ss){var _=Rc,A=Lc;_=(A&~(1<<32-Gs(A)-1)).toString(32)+_,p=":"+p+"R"+_,_=Kp++,0<_&&(p+="H"+_.toString(32)),p+=":"}else _=PS++,p=":"+p+"r"+_.toString(32)+":";return d.memoizedState=p},unstable_isNewReconciler:!1},FS={readContext:Nl,useCallback:Lb,useContext:Nl,useEffect:Nv,useImperativeHandle:Pb,useInsertionEffect:Mb,useLayoutEffect:Db,useMemo:Rb,useReducer:Fv,useRef:Eb,useState:function(){return Fv(Zp)},useDebugValue:Uv,useDeferredValue:function(d){var p=Ul();return kb(p,sa.memoizedState,d)},useTransition:function(){var d=Fv(Zp)[0],p=Ul().memoizedState;return[d,p]},useMutableSource:yb,useSyncExternalStore:_b,useId:Ob,unstable_isNewReconciler:!1},BS={readContext:Nl,useCallback:Lb,useContext:Nl,useEffect:Nv,useImperativeHandle:Pb,useInsertionEffect:Mb,useLayoutEffect:Db,useMemo:Rb,useReducer:Bv,useRef:Eb,useState:function(){return Bv(Zp)},useDebugValue:Uv,useDeferredValue:function(d){var p=Ul();return sa===null?p.memoizedState=d:kb(p,sa.memoizedState,d)},useTransition:function(){var d=Bv(Zp)[0],p=Ul().memoizedState;return[d,p]},useMutableSource:yb,useSyncExternalStore:_b,useId:Ob,unstable_isNewReconciler:!1};function wu(d,p){if(d&&d.defaultProps){p=Xe({},p),d=d.defaultProps;for(var _ in d)p[_]===void 0&&(p[_]=d[_]);return p}return p}function Vv(d,p,_,A){p=d.memoizedState,_=_(A,p),_=_==null?p:Xe({},p,_),d.memoizedState=_,d.lanes===0&&(d.updateQueue.baseState=_)}var mg={isMounted:function(d){return(d=d._reactInternals)?nn(d)===d:!1},enqueueSetState:function(d,p,_){d=d._reactInternals;var A=qa(),O=kd(d),$=Oc(A,O);$.payload=p,_!=null&&($.callback=_),p=Cd(d,$,O),p!==null&&(Mu(p,d,O,A),og(p,d,O))},enqueueReplaceState:function(d,p,_){d=d._reactInternals;var A=qa(),O=kd(d),$=Oc(A,O);$.tag=1,$.payload=p,_!=null&&($.callback=_),p=Cd(d,$,O),p!==null&&(Mu(p,d,O,A),og(p,d,O))},enqueueForceUpdate:function(d,p){d=d._reactInternals;var _=qa(),A=kd(d),O=Oc(_,A);O.tag=2,p!=null&&(O.callback=p),p=Cd(d,O,A),p!==null&&(Mu(p,d,A,_),og(p,d,A))}};function Ub(d,p,_,A,O,$,ce){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(A,$,ce):p.prototype&&p.prototype.isPureReactComponent?!Qe(_,A)||!Qe(O,$):!0}function Vb(d,p,_){var A=!1,O=Gt,$=p.contextType;return typeof $=="object"&&$!==null?$=Nl($):(O=xn(p)?Xi:Rt.current,A=p.contextTypes,$=(A=A!=null)?Er(d,O):Gt),p=new p(_,$),d.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=mg,d.stateNode=p,p._reactInternals=d,A&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=O,d.__reactInternalMemoizedMaskedChildContext=$),p}function zb(d,p,_,A){d=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(_,A),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(_,A),p.state!==d&&mg.enqueueReplaceState(p,p.state,null)}function zv(d,p,_,A){var O=d.stateNode;O.props=_,O.state=d.memoizedState,O.refs={},Cv(d);var $=p.contextType;typeof $=="object"&&$!==null?O.context=Nl($):($=xn(p)?Xi:Rt.current,O.context=Er(d,$)),O.state=d.memoizedState,$=p.getDerivedStateFromProps,typeof $=="function"&&(Vv(d,p,$,_),O.state=d.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof O.getSnapshotBeforeUpdate=="function"||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(p=O.state,typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount(),p!==O.state&&mg.enqueueReplaceState(O,O.state,null),lg(d,_,O,A),O.state=d.memoizedState),typeof O.componentDidMount=="function"&&(d.flags|=4194308)}function Kf(d,p){try{var _="",A=p;do _+=Re(A),A=A.return;while(A);var O=_}catch($){O=`
Error generating stack: `+$.message+`
`+$.stack}return{value:d,source:p,stack:O,digest:null}}function Hv(d,p,_){return{value:d,source:null,stack:_??null,digest:p??null}}function jv(d,p){try{console.error(p.value)}catch(_){setTimeout(function(){throw _})}}var NS=typeof WeakMap=="function"?WeakMap:Map;function Hb(d,p,_){_=Oc(-1,_),_.tag=3,_.payload={element:null};var A=p.value;return _.callback=function(){rm||(rm=!0,Tg=A),jv(d,p)},_}function jb(d,p,_){_=Oc(-1,_),_.tag=3;var A=d.type.getDerivedStateFromError;if(typeof A=="function"){var O=p.value;_.payload=function(){return A(O)},_.callback=function(){jv(d,p)}}var $=d.stateNode;return $!==null&&typeof $.componentDidCatch=="function"&&(_.callback=function(){jv(d,p),typeof A!="function"&&(Ld===null?Ld=new Set([this]):Ld.add(this));var ce=p.stack;this.componentDidCatch(p.value,{componentStack:ce!==null?ce:""})}),_}function Gb(d,p,_){var A=d.pingCache;if(A===null){A=d.pingCache=new NS;var O=new Set;A.set(p,O)}else O=A.get(p),O===void 0&&(O=new Set,A.set(p,O));O.has(_)||(O.add(_),d=uy.bind(null,d,p,_),p.then(d,d))}function $b(d){do{var p;if((p=d.tag===13)&&(p=d.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return d;d=d.return}while(d!==null);return null}function Wb(d,p,_,A,O){return(d.mode&1)===0?(d===p?d.flags|=65536:(d.flags|=128,_.flags|=131072,_.flags&=-52805,_.tag===1&&(_.alternate===null?_.tag=17:(p=Oc(-1,1),p.tag=2,Cd(_,p,1))),_.lanes|=1),d):(d.flags|=65536,d.lanes=O,d)}var Qn=ge.ReactCurrentOwner,hi=!1;function as(d,p,_,A){p.child=d===null?hb(p,null,_,A):qf(p,d.child,_,A)}function qb(d,p,_,A,O){_=_.render;var $=p.ref;return Yf(p,O),A=kv(d,p,_,A,$,O),_=Ov(),d!==null&&!hi?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~O,ac(d,p,O)):(ss&&_&&vv(p),p.flags|=1,as(d,p,A,O),p.child)}function Xb(d,p,_,A,O){if(d===null){var $=_.type;return typeof $=="function"&&!Eg($)&&$.defaultProps===void 0&&_.compare===null&&_.defaultProps===void 0?(p.tag=15,p.type=$,Yb(d,p,$,A,O)):(d=lc(_.type,null,A,p,p.mode,O),d.ref=p.ref,d.return=p,p.child=d)}if($=d.child,(d.lanes&O)===0){var ce=$.memoizedProps;if(_=_.compare,_=_!==null?_:Qe,_(ce,A)&&d.ref===p.ref)return ac(d,p,O)}return p.flags|=1,d=Io($,A),d.ref=p.ref,d.return=p,p.child=d}function Yb(d,p,_,A,O){if(d!==null){var $=d.memoizedProps;if(Qe($,A)&&d.ref===p.ref)if(hi=!1,p.pendingProps=A=$,(d.lanes&O)!==0)(d.flags&131072)!==0&&(hi=!0);else return p.lanes=d.lanes,ac(d,p,O)}return Gv(d,p,_,A,O)}function Qb(d,p,_){var A=p.pendingProps,O=A.children,$=d!==null?d.memoizedState:null;if(A.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},pt(Jf,Co),Co|=_;else{if((_&1073741824)===0)return d=$!==null?$.baseLanes|_:_,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:d,cachePool:null,transitions:null},p.updateQueue=null,pt(Jf,Co),Co|=d,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},A=$!==null?$.baseLanes:_,pt(Jf,Co),Co|=A}else $!==null?(A=$.baseLanes|_,p.memoizedState=null):A=_,pt(Jf,Co),Co|=A;return as(d,p,O,_),p.child}function Kb(d,p){var _=p.ref;(d===null&&_!==null||d!==null&&d.ref!==_)&&(p.flags|=512,p.flags|=2097152)}function Gv(d,p,_,A,O){var $=xn(_)?Xi:Rt.current;return $=Er(p,$),Yf(p,O),_=kv(d,p,_,A,$,O),A=Ov(),d!==null&&!hi?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~O,ac(d,p,O)):(ss&&A&&vv(p),p.flags|=1,as(d,p,_,O),p.child)}function Zb(d,p,_,A,O){if(xn(_)){var $=!0;rs(p)}else $=!1;if(Yf(p,O),p.stateNode===null)tm(d,p),Vb(p,_,A),zv(p,_,A,O),A=!0;else if(d===null){var ce=p.stateNode,Fe=p.memoizedProps;ce.props=Fe;var ze=ce.context,Et=_.contextType;typeof Et=="object"&&Et!==null?Et=Nl(Et):(Et=xn(_)?Xi:Rt.current,Et=Er(p,Et));var Jt=_.getDerivedStateFromProps,ai=typeof Jt=="function"||typeof ce.getSnapshotBeforeUpdate=="function";ai||typeof ce.UNSAFE_componentWillReceiveProps!="function"&&typeof ce.componentWillReceiveProps!="function"||(Fe!==A||ze!==Et)&&zb(p,ce,A,Et),Ed=!1;var Qt=p.memoizedState;ce.state=Qt,lg(p,A,ce,O),ze=p.memoizedState,Fe!==A||Qt!==ze||Mi.current||Ed?(typeof Jt=="function"&&(Vv(p,_,Jt,A),ze=p.memoizedState),(Fe=Ed||Ub(p,_,Fe,A,Qt,ze,Et))?(ai||typeof ce.UNSAFE_componentWillMount!="function"&&typeof ce.componentWillMount!="function"||(typeof ce.componentWillMount=="function"&&ce.componentWillMount(),typeof ce.UNSAFE_componentWillMount=="function"&&ce.UNSAFE_componentWillMount()),typeof ce.componentDidMount=="function"&&(p.flags|=4194308)):(typeof ce.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=A,p.memoizedState=ze),ce.props=A,ce.state=ze,ce.context=Et,A=Fe):(typeof ce.componentDidMount=="function"&&(p.flags|=4194308),A=!1)}else{ce=p.stateNode,pb(d,p),Fe=p.memoizedProps,Et=p.type===p.elementType?Fe:wu(p.type,Fe),ce.props=Et,ai=p.pendingProps,Qt=ce.context,ze=_.contextType,typeof ze=="object"&&ze!==null?ze=Nl(ze):(ze=xn(_)?Xi:Rt.current,ze=Er(p,ze));var wi=_.getDerivedStateFromProps;(Jt=typeof wi=="function"||typeof ce.getSnapshotBeforeUpdate=="function")||typeof ce.UNSAFE_componentWillReceiveProps!="function"&&typeof ce.componentWillReceiveProps!="function"||(Fe!==ai||Qt!==ze)&&zb(p,ce,A,ze),Ed=!1,Qt=p.memoizedState,ce.state=Qt,lg(p,A,ce,O);var Pi=p.memoizedState;Fe!==ai||Qt!==Pi||Mi.current||Ed?(typeof wi=="function"&&(Vv(p,_,wi,A),Pi=p.memoizedState),(Et=Ed||Ub(p,_,Et,A,Qt,Pi,ze)||!1)?(Jt||typeof ce.UNSAFE_componentWillUpdate!="function"&&typeof ce.componentWillUpdate!="function"||(typeof ce.componentWillUpdate=="function"&&ce.componentWillUpdate(A,Pi,ze),typeof ce.UNSAFE_componentWillUpdate=="function"&&ce.UNSAFE_componentWillUpdate(A,Pi,ze)),typeof ce.componentDidUpdate=="function"&&(p.flags|=4),typeof ce.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof ce.componentDidUpdate!="function"||Fe===d.memoizedProps&&Qt===d.memoizedState||(p.flags|=4),typeof ce.getSnapshotBeforeUpdate!="function"||Fe===d.memoizedProps&&Qt===d.memoizedState||(p.flags|=1024),p.memoizedProps=A,p.memoizedState=Pi),ce.props=A,ce.state=Pi,ce.context=ze,A=Et):(typeof ce.componentDidUpdate!="function"||Fe===d.memoizedProps&&Qt===d.memoizedState||(p.flags|=4),typeof ce.getSnapshotBeforeUpdate!="function"||Fe===d.memoizedProps&&Qt===d.memoizedState||(p.flags|=1024),A=!1)}return $v(d,p,_,A,$,O)}function $v(d,p,_,A,O,$){Kb(d,p);var ce=(p.flags&128)!==0;if(!A&&!ce)return O&&lo(p,_,!1),ac(d,p,$);A=p.stateNode,Qn.current=p;var Fe=ce&&typeof _.getDerivedStateFromError!="function"?null:A.render();return p.flags|=1,d!==null&&ce?(p.child=qf(p,d.child,null,$),p.child=qf(p,null,Fe,$)):as(d,p,Fe,$),p.memoizedState=A.state,O&&lo(p,_,!0),p.child}function Jb(d){var p=d.stateNode;p.pendingContext?xd(d,p.pendingContext,p.pendingContext!==p.context):p.context&&xd(d,p.context,!1),Mv(d,p.containerInfo)}function e1(d,p,_,A,O){return Wf(),Tv(O),p.flags|=256,as(d,p,_,A),p.child}var Wv={dehydrated:null,treeContext:null,retryLane:0};function qv(d){return{baseLanes:d,cachePool:null,transitions:null}}function t1(d,p,_){var A=p.pendingProps,O=hs.current,$=!1,ce=(p.flags&128)!==0,Fe;if((Fe=ce)||(Fe=d!==null&&d.memoizedState===null?!1:(O&2)!==0),Fe?($=!0,p.flags&=-129):(d===null||d.memoizedState!==null)&&(O|=1),pt(hs,O&1),d===null)return bv(p),d=p.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((p.mode&1)===0?p.lanes=1:d.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(ce=A.children,d=A.fallback,$?(A=p.mode,$=p.child,ce={mode:"hidden",children:ce},(A&1)===0&&$!==null?($.childLanes=0,$.pendingProps=ce):$=Fc(ce,A,0,null),d=rl(d,A,_,null),$.return=p,d.return=p,$.sibling=d,p.child=$,p.child.memoizedState=qv(_),p.memoizedState=Wv,d):Xv(p,ce));if(O=d.memoizedState,O!==null&&(Fe=O.dehydrated,Fe!==null))return em(d,p,ce,A,Fe,O,_);if($){$=A.fallback,ce=p.mode,O=d.child,Fe=O.sibling;var ze={mode:"hidden",children:A.children};return(ce&1)===0&&p.child!==O?(A=p.child,A.childLanes=0,A.pendingProps=ze,p.deletions=null):(A=Io(O,ze),A.subtreeFlags=O.subtreeFlags&14680064),Fe!==null?$=Io(Fe,$):($=rl($,ce,_,null),$.flags|=2),$.return=p,A.return=p,A.sibling=$,p.child=A,A=$,$=p.child,ce=d.child.memoizedState,ce=ce===null?qv(_):{baseLanes:ce.baseLanes|_,cachePool:null,transitions:ce.transitions},$.memoizedState=ce,$.childLanes=d.childLanes&~_,p.memoizedState=Wv,A}return $=d.child,d=$.sibling,A=Io($,{mode:"visible",children:A.children}),(p.mode&1)===0&&(A.lanes=_),A.return=p,A.sibling=null,d!==null&&(_=p.deletions,_===null?(p.deletions=[d],p.flags|=16):_.push(d)),p.child=A,p.memoizedState=null,A}function Xv(d,p){return p=Fc({mode:"visible",children:p},d.mode,0,null),p.return=d,d.child=p}function Md(d,p,_,A){return A!==null&&Tv(A),qf(p,d.child,null,_),d=Xv(p,p.pendingProps.children),d.flags|=2,p.memoizedState=null,d}function em(d,p,_,A,O,$,ce){if(_)return p.flags&256?(p.flags&=-257,A=Hv(Error(t(422))),Md(d,p,ce,A)):p.memoizedState!==null?(p.child=d.child,p.flags|=128,null):($=A.fallback,O=p.mode,A=Fc({mode:"visible",children:A.children},O,0,null),$=rl($,O,ce,null),$.flags|=2,A.return=p,$.return=p,A.sibling=$,p.child=A,(p.mode&1)!==0&&qf(p,d.child,null,ce),p.child.memoizedState=qv(ce),p.memoizedState=Wv,$);if((p.mode&1)===0)return Md(d,p,ce,null);if(O.data==="$!"){if(A=O.nextSibling&&O.nextSibling.dataset,A)var Fe=A.dgst;return A=Fe,$=Error(t(419)),A=Hv($,A,void 0),Md(d,p,ce,A)}if(Fe=(ce&d.childLanes)!==0,hi||Fe){if(A=aa,A!==null){switch(ce&-ce){case 4:O=2;break;case 16:O=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:O=32;break;case 536870912:O=268435456;break;default:O=0}O=(O&(A.suspendedLanes|ce))!==0?0:O,O!==0&&O!==$.retryLane&&($.retryLane=O,kc(d,O),Mu(A,d,O,-1))}return ly(),A=Hv(Error(t(421))),Md(d,p,ce,A)}return O.data==="$?"?(p.flags|=128,p.child=d.child,p=lm.bind(null,d),O._reactRetry=p,null):(d=$.treeContext,el=$n(O.nextSibling),Jo=p,ss=!0,Au=null,d!==null&&(Zo[Bl++]=Lc,Zo[Bl++]=Rc,Zo[Bl++]=Nh,Lc=d.id,Rc=d.overflow,Nh=p),p=Xv(p,A.children),p.flags|=4096,p)}function Yv(d,p,_){d.lanes|=p;var A=d.alternate;A!==null&&(A.lanes|=p),wv(d.return,p,_)}function Qv(d,p,_,A,O){var $=d.memoizedState;$===null?d.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:A,tail:_,tailMode:O}:($.isBackwards=p,$.rendering=null,$.renderingStartTime=0,$.last=A,$.tail=_,$.tailMode=O)}function i1(d,p,_){var A=p.pendingProps,O=A.revealOrder,$=A.tail;if(as(d,p,A.children,_),A=hs.current,(A&2)!==0)A=A&1|2,p.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=p.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&Yv(d,_,p);else if(d.tag===19)Yv(d,_,p);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===p)break e;for(;d.sibling===null;){if(d.return===null||d.return===p)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}A&=1}if(pt(hs,A),(p.mode&1)===0)p.memoizedState=null;else switch(O){case"forwards":for(_=p.child,O=null;_!==null;)d=_.alternate,d!==null&&ug(d)===null&&(O=_),_=_.sibling;_=O,_===null?(O=p.child,p.child=null):(O=_.sibling,_.sibling=null),Qv(p,!1,O,_,$);break;case"backwards":for(_=null,O=p.child,p.child=null;O!==null;){if(d=O.alternate,d!==null&&ug(d)===null){p.child=O;break}d=O.sibling,O.sibling=_,_=O,O=d}Qv(p,!0,_,null,$);break;case"together":Qv(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function tm(d,p){(p.mode&1)===0&&d!==null&&(d.alternate=null,p.alternate=null,p.flags|=2)}function ac(d,p,_){if(d!==null&&(p.dependencies=d.dependencies),Id|=p.lanes,(_&p.childLanes)===0)return null;if(d!==null&&p.child!==d.child)throw Error(t(153));if(p.child!==null){for(d=p.child,_=Io(d,d.pendingProps),p.child=_,_.return=p;d.sibling!==null;)d=d.sibling,_=_.sibling=Io(d,d.pendingProps),_.return=p;_.sibling=null}return p.child}function n1(d,p,_){switch(p.tag){case 3:Jb(p),Wf();break;case 5:vb(p);break;case 1:xn(p.type)&&rs(p);break;case 4:Mv(p,p.stateNode.containerInfo);break;case 10:var A=p.type._context,O=p.memoizedProps.value;pt(sg,A._currentValue),A._currentValue=O;break;case 13:if(A=p.memoizedState,A!==null)return A.dehydrated!==null?(pt(hs,hs.current&1),p.flags|=128,null):(_&p.child.childLanes)!==0?t1(d,p,_):(pt(hs,hs.current&1),d=ac(d,p,_),d!==null?d.sibling:null);pt(hs,hs.current&1);break;case 19:if(A=(_&p.childLanes)!==0,(d.flags&128)!==0){if(A)return i1(d,p,_);p.flags|=128}if(O=p.memoizedState,O!==null&&(O.rendering=null,O.tail=null,O.lastEffect=null),pt(hs,hs.current),A)break;return null;case 22:case 23:return p.lanes=0,Qb(d,p,_)}return ac(d,p,_)}var Kv,gg,Zv,jh;Kv=function(d,p){for(var _=p.child;_!==null;){if(_.tag===5||_.tag===6)d.appendChild(_.stateNode);else if(_.tag!==4&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===p)break;for(;_.sibling===null;){if(_.return===null||_.return===p)return;_=_.return}_.sibling.return=_.return,_=_.sibling}},gg=function(){},Zv=function(d,p,_,A){var O=d.memoizedProps;if(O!==A){d=p.stateNode,zh(rc.current);var $=null;switch(_){case"input":O=Ki(d,O),A=Ki(d,A),$=[];break;case"select":O=Xe({},O,{value:void 0}),A=Xe({},A,{value:void 0}),$=[];break;case"textarea":O=Sr(d,O),A=Sr(d,A),$=[];break;default:typeof O.onClick!="function"&&typeof A.onClick=="function"&&(d.onclick=Td)}Oi(_,A);var ce;_=null;for(Et in O)if(!A.hasOwnProperty(Et)&&O.hasOwnProperty(Et)&&O[Et]!=null)if(Et==="style"){var Fe=O[Et];for(ce in Fe)Fe.hasOwnProperty(ce)&&(_||(_={}),_[ce]="")}else Et!=="dangerouslySetInnerHTML"&&Et!=="children"&&Et!=="suppressContentEditableWarning"&&Et!=="suppressHydrationWarning"&&Et!=="autoFocus"&&(n.hasOwnProperty(Et)?$||($=[]):($=$||[]).push(Et,null));for(Et in A){var ze=A[Et];if(Fe=O!=null?O[Et]:void 0,A.hasOwnProperty(Et)&&ze!==Fe&&(ze!=null||Fe!=null))if(Et==="style")if(Fe){for(ce in Fe)!Fe.hasOwnProperty(ce)||ze&&ze.hasOwnProperty(ce)||(_||(_={}),_[ce]="");for(ce in ze)ze.hasOwnProperty(ce)&&Fe[ce]!==ze[ce]&&(_||(_={}),_[ce]=ze[ce])}else _||($||($=[]),$.push(Et,_)),_=ze;else Et==="dangerouslySetInnerHTML"?(ze=ze?ze.__html:void 0,Fe=Fe?Fe.__html:void 0,ze!=null&&Fe!==ze&&($=$||[]).push(Et,ze)):Et==="children"?typeof ze!="string"&&typeof ze!="number"||($=$||[]).push(Et,""+ze):Et!=="suppressContentEditableWarning"&&Et!=="suppressHydrationWarning"&&(n.hasOwnProperty(Et)?(ze!=null&&Et==="onScroll"&&Un("scroll",d),$||Fe===ze||($=[])):($=$||[]).push(Et,ze))}_&&($=$||[]).push("style",_);var Et=$;(p.updateQueue=Et)&&(p.flags|=4)}},jh=function(d,p,_,A){_!==A&&(p.flags|=4)};function $a(d,p){if(!ss)switch(d.tailMode){case"hidden":p=d.tail;for(var _=null;p!==null;)p.alternate!==null&&(_=p),p=p.sibling;_===null?d.tail=null:_.sibling=null;break;case"collapsed":_=d.tail;for(var A=null;_!==null;)_.alternate!==null&&(A=_),_=_.sibling;A===null?p||d.tail===null?d.tail=null:d.tail.sibling=null:A.sibling=null}}function kr(d){var p=d.alternate!==null&&d.alternate.child===d.child,_=0,A=0;if(p)for(var O=d.child;O!==null;)_|=O.lanes|O.childLanes,A|=O.subtreeFlags&14680064,A|=O.flags&14680064,O.return=d,O=O.sibling;else for(O=d.child;O!==null;)_|=O.lanes|O.childLanes,A|=O.subtreeFlags,A|=O.flags,O.return=d,O=O.sibling;return d.subtreeFlags|=A,d.childLanes=_,p}function r1(d,p,_){var A=p.pendingProps;switch(yv(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kr(p),null;case 1:return xn(p.type)&&Ko(),kr(p),null;case 3:return A=p.stateNode,Qf(),Ge(Mi),Ge(Rt),Pv(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(d===null||d.child===null)&&(ng(p)?p.flags|=4:d===null||d.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,Au!==null&&(ay(Au),Au=null))),gg(d,p),kr(p),null;case 5:Dv(p);var O=zh(Yp.current);if(_=p.type,d!==null&&p.stateNode!=null)Zv(d,p,_,A,O),d.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!A){if(p.stateNode===null)throw Error(t(166));return kr(p),null}if(d=zh(rc.current),ng(p)){A=p.stateNode,_=p.type;var $=p.memoizedProps;switch(A[Ao]=p,A[wo]=$,d=(p.mode&1)!==0,_){case"dialog":Un("cancel",A),Un("close",A);break;case"iframe":case"object":case"embed":Un("load",A);break;case"video":case"audio":for(O=0;O<Fi.length;O++)Un(Fi[O],A);break;case"source":Un("error",A);break;case"img":case"image":case"link":Un("error",A),Un("load",A);break;case"details":Un("toggle",A);break;case"input":io(A,$),Un("invalid",A);break;case"select":A._wrapperState={wasMultiple:!!$.multiple},Un("invalid",A);break;case"textarea":fa(A,$),Un("invalid",A)}Oi(_,$),O=null;for(var ce in $)if($.hasOwnProperty(ce)){var Fe=$[ce];ce==="children"?typeof Fe=="string"?A.textContent!==Fe&&($.suppressHydrationWarning!==!0&&bd(A.textContent,Fe,d),O=["children",Fe]):typeof Fe=="number"&&A.textContent!==""+Fe&&($.suppressHydrationWarning!==!0&&bd(A.textContent,Fe,d),O=["children",""+Fe]):n.hasOwnProperty(ce)&&Fe!=null&&ce==="onScroll"&&Un("scroll",A)}switch(_){case"input":vi(A),cs(A,$,!0);break;case"textarea":vi(A),Js(A);break;case"select":case"option":break;default:typeof $.onClick=="function"&&(A.onclick=Td)}A=O,p.updateQueue=A,A!==null&&(p.flags|=4)}else{ce=O.nodeType===9?O:O.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Sa(_)),d==="http://www.w3.org/1999/xhtml"?_==="script"?(d=ce.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof A.is=="string"?d=ce.createElement(_,{is:A.is}):(d=ce.createElement(_),_==="select"&&(ce=d,A.multiple?ce.multiple=!0:A.size&&(ce.size=A.size))):d=ce.createElementNS(d,_),d[Ao]=p,d[wo]=A,Kv(d,p,!1,!1),p.stateNode=d;e:{switch(ce=Fn(_,A),_){case"dialog":Un("cancel",d),Un("close",d),O=A;break;case"iframe":case"object":case"embed":Un("load",d),O=A;break;case"video":case"audio":for(O=0;O<Fi.length;O++)Un(Fi[O],d);O=A;break;case"source":Un("error",d),O=A;break;case"img":case"image":case"link":Un("error",d),Un("load",d),O=A;break;case"details":Un("toggle",d),O=A;break;case"input":io(d,A),O=Ki(d,A),Un("invalid",d);break;case"option":O=A;break;case"select":d._wrapperState={wasMultiple:!!A.multiple},O=Xe({},A,{value:void 0}),Un("invalid",d);break;case"textarea":fa(d,A),O=Sr(d,A),Un("invalid",d);break;default:O=A}Oi(_,O),Fe=O;for($ in Fe)if(Fe.hasOwnProperty($)){var ze=Fe[$];$==="style"?Ft(d,ze):$==="dangerouslySetInnerHTML"?(ze=ze?ze.__html:void 0,ze!=null&&Vo(d,ze)):$==="children"?typeof ze=="string"?(_!=="textarea"||ze!=="")&&Aa(d,ze):typeof ze=="number"&&Aa(d,""+ze):$!=="suppressContentEditableWarning"&&$!=="suppressHydrationWarning"&&$!=="autoFocus"&&(n.hasOwnProperty($)?ze!=null&&$==="onScroll"&&Un("scroll",d):ze!=null&&de(d,$,ze,ce))}switch(_){case"input":vi(d),cs(d,A,!1);break;case"textarea":vi(d),Js(d);break;case"option":A.value!=null&&d.setAttribute("value",""+Je(A.value));break;case"select":d.multiple=!!A.multiple,$=A.value,$!=null?gn(d,!!A.multiple,$,!1):A.defaultValue!=null&&gn(d,!!A.multiple,A.defaultValue,!0);break;default:typeof O.onClick=="function"&&(d.onclick=Td)}switch(_){case"button":case"input":case"select":case"textarea":A=!!A.autoFocus;break e;case"img":A=!0;break e;default:A=!1}}A&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return kr(p),null;case 6:if(d&&p.stateNode!=null)jh(d,p,d.memoizedProps,A);else{if(typeof A!="string"&&p.stateNode===null)throw Error(t(166));if(_=zh(Yp.current),zh(rc.current),ng(p)){if(A=p.stateNode,_=p.memoizedProps,A[Ao]=p,($=A.nodeValue!==_)&&(d=Jo,d!==null))switch(d.tag){case 3:bd(A.nodeValue,_,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&bd(A.nodeValue,_,(d.mode&1)!==0)}$&&(p.flags|=4)}else A=(_.nodeType===9?_:_.ownerDocument).createTextNode(A),A[Ao]=p,p.stateNode=A}return kr(p),null;case 13:if(Ge(hs),A=p.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(ss&&el!==null&&(p.mode&1)!==0&&(p.flags&128)===0)ub(),Wf(),p.flags|=98560,$=!1;else if($=ng(p),A!==null&&A.dehydrated!==null){if(d===null){if(!$)throw Error(t(318));if($=p.memoizedState,$=$!==null?$.dehydrated:null,!$)throw Error(t(317));$[Ao]=p}else Wf(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;kr(p),$=!1}else Au!==null&&(ay(Au),Au=null),$=!0;if(!$)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=_,p):(A=A!==null,A!==(d!==null&&d.memoizedState!==null)&&A&&(p.child.flags|=8192,(p.mode&1)!==0&&(d===null||(hs.current&1)!==0?oa===0&&(oa=3):ly())),p.updateQueue!==null&&(p.flags|=4),kr(p),null);case 4:return Qf(),gg(d,p),d===null&&pn(p.stateNode.containerInfo),kr(p),null;case 10:return Av(p.type._context),kr(p),null;case 17:return xn(p.type)&&Ko(),kr(p),null;case 19:if(Ge(hs),$=p.memoizedState,$===null)return kr(p),null;if(A=(p.flags&128)!==0,ce=$.rendering,ce===null)if(A)$a($,!1);else{if(oa!==0||d!==null&&(d.flags&128)!==0)for(d=p.child;d!==null;){if(ce=ug(d),ce!==null){for(p.flags|=128,$a($,!1),A=ce.updateQueue,A!==null&&(p.updateQueue=A,p.flags|=4),p.subtreeFlags=0,A=_,_=p.child;_!==null;)$=_,d=A,$.flags&=14680066,ce=$.alternate,ce===null?($.childLanes=0,$.lanes=d,$.child=null,$.subtreeFlags=0,$.memoizedProps=null,$.memoizedState=null,$.updateQueue=null,$.dependencies=null,$.stateNode=null):($.childLanes=ce.childLanes,$.lanes=ce.lanes,$.child=ce.child,$.subtreeFlags=0,$.deletions=null,$.memoizedProps=ce.memoizedProps,$.memoizedState=ce.memoizedState,$.updateQueue=ce.updateQueue,$.type=ce.type,d=ce.dependencies,$.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),_=_.sibling;return pt(hs,hs.current&1|2),p.child}d=d.sibling}$.tail!==null&&Gr()>tp&&(p.flags|=128,A=!0,$a($,!1),p.lanes=4194304)}else{if(!A)if(d=ug(ce),d!==null){if(p.flags|=128,A=!0,_=d.updateQueue,_!==null&&(p.updateQueue=_,p.flags|=4),$a($,!0),$.tail===null&&$.tailMode==="hidden"&&!ce.alternate&&!ss)return kr(p),null}else 2*Gr()-$.renderingStartTime>tp&&_!==1073741824&&(p.flags|=128,A=!0,$a($,!1),p.lanes=4194304);$.isBackwards?(ce.sibling=p.child,p.child=ce):(_=$.last,_!==null?_.sibling=ce:p.child=ce,$.last=ce)}return $.tail!==null?(p=$.tail,$.rendering=p,$.tail=p.sibling,$.renderingStartTime=Gr(),p.sibling=null,_=hs.current,pt(hs,A?_&1|2:_&1),p):(kr(p),null);case 22:case 23:return oy(),A=p.memoizedState!==null,d!==null&&d.memoizedState!==null!==A&&(p.flags|=8192),A&&(p.mode&1)!==0?(Co&1073741824)!==0&&(kr(p),p.subtreeFlags&6&&(p.flags|=8192)):kr(p),null;case 24:return null;case 25:return null}throw Error(t(156,p.tag))}function US(d,p){switch(yv(p),p.tag){case 1:return xn(p.type)&&Ko(),d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 3:return Qf(),Ge(Mi),Ge(Rt),Pv(),d=p.flags,(d&65536)!==0&&(d&128)===0?(p.flags=d&-65537|128,p):null;case 5:return Dv(p),null;case 13:if(Ge(hs),d=p.memoizedState,d!==null&&d.dehydrated!==null){if(p.alternate===null)throw Error(t(340));Wf()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 19:return Ge(hs),null;case 4:return Qf(),null;case 10:return Av(p.type._context),null;case 22:case 23:return oy(),null;case 24:return null;default:return null}}var vg=!1,Wa=!1,VS=typeof WeakSet=="function"?WeakSet:Set,Ri=null;function Zf(d,p){var _=d.ref;if(_!==null)if(typeof _=="function")try{_(null)}catch(A){ws(d,p,A)}else _.current=null}function Jv(d,p,_){try{_()}catch(A){ws(d,p,A)}}var s1=!1;function zS(d,p){if(nc=Cl,d=si(),qi(d)){if("selectionStart"in d)var _={start:d.selectionStart,end:d.selectionEnd};else e:{_=(_=d.ownerDocument)&&_.defaultView||window;var A=_.getSelection&&_.getSelection();if(A&&A.rangeCount!==0){_=A.anchorNode;var O=A.anchorOffset,$=A.focusNode;A=A.focusOffset;try{_.nodeType,$.nodeType}catch{_=null;break e}var ce=0,Fe=-1,ze=-1,Et=0,Jt=0,ai=d,Qt=null;t:for(;;){for(var wi;ai!==_||O!==0&&ai.nodeType!==3||(Fe=ce+O),ai!==$||A!==0&&ai.nodeType!==3||(ze=ce+A),ai.nodeType===3&&(ce+=ai.nodeValue.length),(wi=ai.firstChild)!==null;)Qt=ai,ai=wi;for(;;){if(ai===d)break t;if(Qt===_&&++Et===O&&(Fe=ce),Qt===$&&++Jt===A&&(ze=ce),(wi=ai.nextSibling)!==null)break;ai=Qt,Qt=ai.parentNode}ai=wi}_=Fe===-1||ze===-1?null:{start:Fe,end:ze}}else _=null}_=_||{start:0,end:0}}else _=null;for(tr={focusedElem:d,selectionRange:_},Cl=!1,Ri=p;Ri!==null;)if(p=Ri,d=p.child,(p.subtreeFlags&1028)!==0&&d!==null)d.return=p,Ri=d;else for(;Ri!==null;){p=Ri;try{var Pi=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Pi!==null){var Bi=Pi.memoizedProps,Es=Pi.memoizedState,gt=p.stateNode,et=gt.getSnapshotBeforeUpdate(p.elementType===p.type?Bi:wu(p.type,Bi),Es);gt.__reactInternalSnapshotBeforeUpdate=et}break;case 3:var yt=p.stateNode.containerInfo;yt.nodeType===1?yt.textContent="":yt.nodeType===9&&yt.documentElement&&yt.removeChild(yt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ci){ws(p,p.return,ci)}if(d=p.sibling,d!==null){d.return=p.return,Ri=d;break}Ri=p.return}return Pi=s1,s1=!1,Pi}function im(d,p,_){var A=p.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var O=A=A.next;do{if((O.tag&d)===d){var $=O.destroy;O.destroy=void 0,$!==void 0&&Jv(p,_,$)}O=O.next}while(O!==A)}}function yg(d,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var _=p=p.next;do{if((_.tag&d)===d){var A=_.create;_.destroy=A()}_=_.next}while(_!==p)}}function ey(d){var p=d.ref;if(p!==null){var _=d.stateNode;switch(d.tag){case 5:d=_;break;default:d=_}typeof p=="function"?p(d):p.current=d}}function a1(d){var p=d.alternate;p!==null&&(d.alternate=null,a1(p)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(p=d.stateNode,p!==null&&(delete p[Ao],delete p[wo],delete p[S],delete p[D],delete p[k])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function o1(d){return d.tag===5||d.tag===3||d.tag===4}function l1(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||o1(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function ty(d,p,_){var A=d.tag;if(A===5||A===6)d=d.stateNode,p?_.nodeType===8?_.parentNode.insertBefore(d,p):_.insertBefore(d,p):(_.nodeType===8?(p=_.parentNode,p.insertBefore(d,_)):(p=_,p.appendChild(d)),_=_._reactRootContainer,_!=null||p.onclick!==null||(p.onclick=Td));else if(A!==4&&(d=d.child,d!==null))for(ty(d,p,_),d=d.sibling;d!==null;)ty(d,p,_),d=d.sibling}function iy(d,p,_){var A=d.tag;if(A===5||A===6)d=d.stateNode,p?_.insertBefore(d,p):_.appendChild(d);else if(A!==4&&(d=d.child,d!==null))for(iy(d,p,_),d=d.sibling;d!==null;)iy(d,p,_),d=d.sibling}var Pa=null,Eu=!1;function Dd(d,p,_){for(_=_.child;_!==null;)u1(d,p,_),_=_.sibling}function u1(d,p,_){if(Rs&&typeof Rs.onCommitFiberUnmount=="function")try{Rs.onCommitFiberUnmount(Sc,_)}catch{}switch(_.tag){case 5:Wa||Zf(_,p);case 6:var A=Pa,O=Eu;Pa=null,Dd(d,p,_),Pa=A,Eu=O,Pa!==null&&(Eu?(d=Pa,_=_.stateNode,d.nodeType===8?d.parentNode.removeChild(_):d.removeChild(_)):Pa.removeChild(_.stateNode));break;case 18:Pa!==null&&(Eu?(d=Pa,_=_.stateNode,d.nodeType===8?As(d.parentNode,_):d.nodeType===1&&As(d,_),$s(d)):As(Pa,_.stateNode));break;case 4:A=Pa,O=Eu,Pa=_.stateNode.containerInfo,Eu=!0,Dd(d,p,_),Pa=A,Eu=O;break;case 0:case 11:case 14:case 15:if(!Wa&&(A=_.updateQueue,A!==null&&(A=A.lastEffect,A!==null))){O=A=A.next;do{var $=O,ce=$.destroy;$=$.tag,ce!==void 0&&(($&2)!==0||($&4)!==0)&&Jv(_,p,ce),O=O.next}while(O!==A)}Dd(d,p,_);break;case 1:if(!Wa&&(Zf(_,p),A=_.stateNode,typeof A.componentWillUnmount=="function"))try{A.props=_.memoizedProps,A.state=_.memoizedState,A.componentWillUnmount()}catch(Fe){ws(_,p,Fe)}Dd(d,p,_);break;case 21:Dd(d,p,_);break;case 22:_.mode&1?(Wa=(A=Wa)||_.memoizedState!==null,Dd(d,p,_),Wa=A):Dd(d,p,_);break;default:Dd(d,p,_)}}function c1(d){var p=d.updateQueue;if(p!==null){d.updateQueue=null;var _=d.stateNode;_===null&&(_=d.stateNode=new VS),p.forEach(function(A){var O=S1.bind(null,d,A);_.has(A)||(_.add(A),A.then(O,O))})}}function Cu(d,p){var _=p.deletions;if(_!==null)for(var A=0;A<_.length;A++){var O=_[A];try{var $=d,ce=p,Fe=ce;e:for(;Fe!==null;){switch(Fe.tag){case 5:Pa=Fe.stateNode,Eu=!1;break e;case 3:Pa=Fe.stateNode.containerInfo,Eu=!0;break e;case 4:Pa=Fe.stateNode.containerInfo,Eu=!0;break e}Fe=Fe.return}if(Pa===null)throw Error(t(160));u1($,ce,O),Pa=null,Eu=!1;var ze=O.alternate;ze!==null&&(ze.return=null),O.return=null}catch(Et){ws(O,p,Et)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)d1(p,d),p=p.sibling}function d1(d,p){var _=d.alternate,A=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(Cu(p,d),oc(d),A&4){try{im(3,d,d.return),yg(3,d)}catch(Bi){ws(d,d.return,Bi)}try{im(5,d,d.return)}catch(Bi){ws(d,d.return,Bi)}}break;case 1:Cu(p,d),oc(d),A&512&&_!==null&&Zf(_,_.return);break;case 5:if(Cu(p,d),oc(d),A&512&&_!==null&&Zf(_,_.return),d.flags&32){var O=d.stateNode;try{Aa(O,"")}catch(Bi){ws(d,d.return,Bi)}}if(A&4&&(O=d.stateNode,O!=null)){var $=d.memoizedProps,ce=_!==null?_.memoizedProps:$,Fe=d.type,ze=d.updateQueue;if(d.updateQueue=null,ze!==null)try{Fe==="input"&&$.type==="radio"&&$.name!=null&&yr(O,$),Fn(Fe,ce);var Et=Fn(Fe,$);for(ce=0;ce<ze.length;ce+=2){var Jt=ze[ce],ai=ze[ce+1];Jt==="style"?Ft(O,ai):Jt==="dangerouslySetInnerHTML"?Vo(O,ai):Jt==="children"?Aa(O,ai):de(O,Jt,ai,Et)}switch(Fe){case"input":bs(O,$);break;case"textarea":Oa(O,$);break;case"select":var Qt=O._wrapperState.wasMultiple;O._wrapperState.wasMultiple=!!$.multiple;var wi=$.value;wi!=null?gn(O,!!$.multiple,wi,!1):Qt!==!!$.multiple&&($.defaultValue!=null?gn(O,!!$.multiple,$.defaultValue,!0):gn(O,!!$.multiple,$.multiple?[]:"",!1))}O[wo]=$}catch(Bi){ws(d,d.return,Bi)}}break;case 6:if(Cu(p,d),oc(d),A&4){if(d.stateNode===null)throw Error(t(162));O=d.stateNode,$=d.memoizedProps;try{O.nodeValue=$}catch(Bi){ws(d,d.return,Bi)}}break;case 3:if(Cu(p,d),oc(d),A&4&&_!==null&&_.memoizedState.isDehydrated)try{$s(p.containerInfo)}catch(Bi){ws(d,d.return,Bi)}break;case 4:Cu(p,d),oc(d);break;case 13:Cu(p,d),oc(d),O=d.child,O.flags&8192&&($=O.memoizedState!==null,O.stateNode.isHidden=$,!$||O.alternate!==null&&O.alternate.memoizedState!==null||(ry=Gr())),A&4&&c1(d);break;case 22:if(Jt=_!==null&&_.memoizedState!==null,d.mode&1?(Wa=(Et=Wa)||Jt,Cu(p,d),Wa=Et):Cu(p,d),oc(d),A&8192){if(Et=d.memoizedState!==null,(d.stateNode.isHidden=Et)&&!Jt&&(d.mode&1)!==0)for(Ri=d,Jt=d.child;Jt!==null;){for(ai=Ri=Jt;Ri!==null;){switch(Qt=Ri,wi=Qt.child,Qt.tag){case 0:case 11:case 14:case 15:im(4,Qt,Qt.return);break;case 1:Zf(Qt,Qt.return);var Pi=Qt.stateNode;if(typeof Pi.componentWillUnmount=="function"){A=Qt,_=Qt.return;try{p=A,Pi.props=p.memoizedProps,Pi.state=p.memoizedState,Pi.componentWillUnmount()}catch(Bi){ws(A,_,Bi)}}break;case 5:Zf(Qt,Qt.return);break;case 22:if(Qt.memoizedState!==null){p1(ai);continue}}wi!==null?(wi.return=Qt,Ri=wi):p1(ai)}Jt=Jt.sibling}e:for(Jt=null,ai=d;;){if(ai.tag===5){if(Jt===null){Jt=ai;try{O=ai.stateNode,Et?($=O.style,typeof $.setProperty=="function"?$.setProperty("display","none","important"):$.display="none"):(Fe=ai.stateNode,ze=ai.memoizedProps.style,ce=ze!=null&&ze.hasOwnProperty("display")?ze.display:null,Fe.style.display=St("display",ce))}catch(Bi){ws(d,d.return,Bi)}}}else if(ai.tag===6){if(Jt===null)try{ai.stateNode.nodeValue=Et?"":ai.memoizedProps}catch(Bi){ws(d,d.return,Bi)}}else if((ai.tag!==22&&ai.tag!==23||ai.memoizedState===null||ai===d)&&ai.child!==null){ai.child.return=ai,ai=ai.child;continue}if(ai===d)break e;for(;ai.sibling===null;){if(ai.return===null||ai.return===d)break e;Jt===ai&&(Jt=null),ai=ai.return}Jt===ai&&(Jt=null),ai.sibling.return=ai.return,ai=ai.sibling}}break;case 19:Cu(p,d),oc(d),A&4&&c1(d);break;case 21:break;default:Cu(p,d),oc(d)}}function oc(d){var p=d.flags;if(p&2){try{e:{for(var _=d.return;_!==null;){if(o1(_)){var A=_;break e}_=_.return}throw Error(t(160))}switch(A.tag){case 5:var O=A.stateNode;A.flags&32&&(Aa(O,""),A.flags&=-33);var $=l1(d);iy(d,$,O);break;case 3:case 4:var ce=A.stateNode.containerInfo,Fe=l1(d);ty(d,Fe,ce);break;default:throw Error(t(161))}}catch(ze){ws(d,d.return,ze)}d.flags&=-3}p&4096&&(d.flags&=-4097)}function HS(d,p,_){Ri=d,h1(d)}function h1(d,p,_){for(var A=(d.mode&1)!==0;Ri!==null;){var O=Ri,$=O.child;if(O.tag===22&&A){var ce=O.memoizedState!==null||vg;if(!ce){var Fe=O.alternate,ze=Fe!==null&&Fe.memoizedState!==null||Wa;Fe=vg;var Et=Wa;if(vg=ce,(Wa=ze)&&!Et)for(Ri=O;Ri!==null;)ce=Ri,ze=ce.child,ce.tag===22&&ce.memoizedState!==null?m1(O):ze!==null?(ze.return=ce,Ri=ze):m1(O);for(;$!==null;)Ri=$,h1($),$=$.sibling;Ri=O,vg=Fe,Wa=Et}f1(d)}else(O.subtreeFlags&8772)!==0&&$!==null?($.return=O,Ri=$):f1(d)}}function f1(d){for(;Ri!==null;){var p=Ri;if((p.flags&8772)!==0){var _=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:Wa||yg(5,p);break;case 1:var A=p.stateNode;if(p.flags&4&&!Wa)if(_===null)A.componentDidMount();else{var O=p.elementType===p.type?_.memoizedProps:wu(p.type,_.memoizedProps);A.componentDidUpdate(O,_.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var $=p.updateQueue;$!==null&&gb(p,$,A);break;case 3:var ce=p.updateQueue;if(ce!==null){if(_=null,p.child!==null)switch(p.child.tag){case 5:_=p.child.stateNode;break;case 1:_=p.child.stateNode}gb(p,ce,_)}break;case 5:var Fe=p.stateNode;if(_===null&&p.flags&4){_=Fe;var ze=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":ze.autoFocus&&_.focus();break;case"img":ze.src&&(_.src=ze.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var Et=p.alternate;if(Et!==null){var Jt=Et.memoizedState;if(Jt!==null){var ai=Jt.dehydrated;ai!==null&&$s(ai)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Wa||p.flags&512&&ey(p)}catch(Qt){ws(p,p.return,Qt)}}if(p===d){Ri=null;break}if(_=p.sibling,_!==null){_.return=p.return,Ri=_;break}Ri=p.return}}function p1(d){for(;Ri!==null;){var p=Ri;if(p===d){Ri=null;break}var _=p.sibling;if(_!==null){_.return=p.return,Ri=_;break}Ri=p.return}}function m1(d){for(;Ri!==null;){var p=Ri;try{switch(p.tag){case 0:case 11:case 15:var _=p.return;try{yg(4,p)}catch(ze){ws(p,_,ze)}break;case 1:var A=p.stateNode;if(typeof A.componentDidMount=="function"){var O=p.return;try{A.componentDidMount()}catch(ze){ws(p,O,ze)}}var $=p.return;try{ey(p)}catch(ze){ws(p,$,ze)}break;case 5:var ce=p.return;try{ey(p)}catch(ze){ws(p,ce,ze)}}}catch(ze){ws(p,p.return,ze)}if(p===d){Ri=null;break}var Fe=p.sibling;if(Fe!==null){Fe.return=p.return,Ri=Fe;break}Ri=p.return}}var jS=Math.ceil,_g=ge.ReactCurrentDispatcher,bg=ge.ReactCurrentOwner,tl=ge.ReactCurrentBatchConfig,or=0,aa=null,Xs=null,os=0,Co=0,Jf=Le(0),oa=0,ep=null,Id=0,Pd=0,ny=0,nm=null,Mo=null,ry=0,tp=1/0,il=null,rm=!1,Tg=null,Ld=null,ip=!1,Rd=null,xg=0,sm=0,Sg=null,Ag=-1,am=0;function qa(){return(or&6)!==0?Gr():Ag!==-1?Ag:Ag=Gr()}function kd(d){return(d.mode&1)===0?1:(or&2)!==0&&os!==0?os&-os:IS.transition!==null?(am===0&&(am=Bf()),am):(d=Jn,d!==0||(d=window.event,d=d===void 0?16:du(d.type)),d)}function Mu(d,p,_,A){if(50<sm)throw sm=0,Sg=null,Error(t(185));fo(d,_,A),((or&2)===0||d!==aa)&&(d===aa&&((or&2)===0&&(Pd|=_),oa===4&&Od(d,os)),Do(d,A),_===1&&or===0&&(p.mode&1)===0&&(tp=Gr()+500,ar&&wd()))}function Do(d,p){var _=d.callbackNode;jo(d,p);var A=lu(d,d===aa?os:0);if(A===0)_!==null&&zo(_),d.callbackNode=null,d.callbackPriority=0;else if(p=A&-A,d.callbackPriority!==p){if(_!=null&&zo(_),p===1)d.tag===0?Ad(v1.bind(null,d)):ra(v1.bind(null,d)),ja(function(){(or&6)===0&&wd()}),_=null;else{switch(cu(A)){case 1:_=rd;break;case 4:_=su;break;case 16:_=bl;break;case 536870912:_=Ah;break;default:_=bl}_=w1(_,g1.bind(null,d))}d.callbackPriority=p,d.callbackNode=_}}function g1(d,p){if(Ag=-1,am=0,(or&6)!==0)throw Error(t(327));var _=d.callbackNode;if(np()&&d.callbackNode!==_)return null;var A=lu(d,d===aa?os:0);if(A===0)return null;if((A&30)!==0||(A&d.expiredLanes)!==0||p)p=om(d,A);else{p=A;var O=or;or|=2;var $=_1();(aa!==d||os!==p)&&(il=null,tp=Gr()+500,$h(d,p));do try{Wh();break}catch(Fe){y1(d,Fe)}while(!0);Sv(),_g.current=$,or=O,Xs!==null?p=0:(aa=null,os=0,p=oa)}if(p!==0){if(p===2&&(O=uu(d),O!==0&&(A=O,p=sy(d,O))),p===1)throw _=ep,$h(d,0),Od(d,A),Do(d,Gr()),_;if(p===6)Od(d,A);else{if(O=d.current.alternate,(A&30)===0&&!GS(O)&&(p=om(d,A),p===2&&($=uu(d),$!==0&&(A=$,p=sy(d,$))),p===1))throw _=ep,$h(d,0),Od(d,A),Do(d,Gr()),_;switch(d.finishedWork=O,d.finishedLanes=A,p){case 0:case 1:throw Error(t(345));case 2:qh(d,Mo,il);break;case 3:if(Od(d,A),(A&130023424)===A&&(p=ry+500-Gr(),10<p)){if(lu(d,0)!==0)break;if(O=d.suspendedLanes,(O&A)!==A){qa(),d.pingedLanes|=d.suspendedLanes&O;break}d.timeoutHandle=Rr(qh.bind(null,d,Mo,il),p);break}qh(d,Mo,il);break;case 4:if(Od(d,A),(A&4194240)===A)break;for(p=d.eventTimes,O=-1;0<A;){var ce=31-Gs(A);$=1<<ce,ce=p[ce],ce>O&&(O=ce),A&=~$}if(A=O,A=Gr()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*jS(A/1960))-A,10<A){d.timeoutHandle=Rr(qh.bind(null,d,Mo,il),A);break}qh(d,Mo,il);break;case 5:qh(d,Mo,il);break;default:throw Error(t(329))}}}return Do(d,Gr()),d.callbackNode===_?g1.bind(null,d):null}function sy(d,p){var _=nm;return d.current.memoizedState.isDehydrated&&($h(d,p).flags|=256),d=om(d,p),d!==2&&(p=Mo,Mo=_,p!==null&&ay(p)),d}function ay(d){Mo===null?Mo=d:Mo.push.apply(Mo,d)}function GS(d){for(var p=d;;){if(p.flags&16384){var _=p.updateQueue;if(_!==null&&(_=_.stores,_!==null))for(var A=0;A<_.length;A++){var O=_[A],$=O.getSnapshot;O=O.value;try{if(!Oe($(),O))return!1}catch{return!1}}}if(_=p.child,p.subtreeFlags&16384&&_!==null)_.return=p,p=_;else{if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function Od(d,p){for(p&=~ny,p&=~Pd,d.suspendedLanes|=p,d.pingedLanes&=~p,d=d.expirationTimes;0<p;){var _=31-Gs(p),A=1<<_;d[_]=-1,p&=~A}}function v1(d){if((or&6)!==0)throw Error(t(327));np();var p=lu(d,0);if((p&1)===0)return Do(d,Gr()),null;var _=om(d,p);if(d.tag!==0&&_===2){var A=uu(d);A!==0&&(p=A,_=sy(d,A))}if(_===1)throw _=ep,$h(d,0),Od(d,p),Do(d,Gr()),_;if(_===6)throw Error(t(345));return d.finishedWork=d.current.alternate,d.finishedLanes=p,qh(d,Mo,il),Do(d,Gr()),null}function wg(d,p){var _=or;or|=1;try{return d(p)}finally{or=_,or===0&&(tp=Gr()+500,ar&&wd())}}function Gh(d){Rd!==null&&Rd.tag===0&&(or&6)===0&&np();var p=or;or|=1;var _=tl.transition,A=Jn;try{if(tl.transition=null,Jn=1,d)return d()}finally{Jn=A,tl.transition=_,or=p,(or&6)===0&&wd()}}function oy(){Co=Jf.current,Ge(Jf)}function $h(d,p){d.finishedWork=null,d.finishedLanes=0;var _=d.timeoutHandle;if(_!==-1&&(d.timeoutHandle=-1,So(_)),Xs!==null)for(_=Xs.return;_!==null;){var A=_;switch(yv(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&Ko();break;case 3:Qf(),Ge(Mi),Ge(Rt),Pv();break;case 5:Dv(A);break;case 4:Qf();break;case 13:Ge(hs);break;case 19:Ge(hs);break;case 10:Av(A.type._context);break;case 22:case 23:oy()}_=_.return}if(aa=d,Xs=d=Io(d.current,null),os=Co=p,oa=0,ep=null,ny=Pd=Id=0,Mo=nm=null,Vh!==null){for(p=0;p<Vh.length;p++)if(_=Vh[p],A=_.interleaved,A!==null){_.interleaved=null;var O=A.next,$=_.pending;if($!==null){var ce=$.next;$.next=O,A.next=ce}_.pending=A}Vh=null}return d}function y1(d,p){do{var _=Xs;try{if(Sv(),cg.current=pg,dg){for(var A=fs.memoizedState;A!==null;){var O=A.queue;O!==null&&(O.pending=null),A=A.next}dg=!1}if(Hh=0,va=sa=fs=null,Qp=!1,Kp=0,bg.current=null,_===null||_.return===null){oa=1,ep=p,Xs=null;break}e:{var $=d,ce=_.return,Fe=_,ze=p;if(p=os,Fe.flags|=32768,ze!==null&&typeof ze=="object"&&typeof ze.then=="function"){var Et=ze,Jt=Fe,ai=Jt.tag;if((Jt.mode&1)===0&&(ai===0||ai===11||ai===15)){var Qt=Jt.alternate;Qt?(Jt.updateQueue=Qt.updateQueue,Jt.memoizedState=Qt.memoizedState,Jt.lanes=Qt.lanes):(Jt.updateQueue=null,Jt.memoizedState=null)}var wi=$b(ce);if(wi!==null){wi.flags&=-257,Wb(wi,ce,Fe,$,p),wi.mode&1&&Gb($,Et,p),p=wi,ze=Et;var Pi=p.updateQueue;if(Pi===null){var Bi=new Set;Bi.add(ze),p.updateQueue=Bi}else Pi.add(ze);break e}else{if((p&1)===0){Gb($,Et,p),ly();break e}ze=Error(t(426))}}else if(ss&&Fe.mode&1){var Es=$b(ce);if(Es!==null){(Es.flags&65536)===0&&(Es.flags|=256),Wb(Es,ce,Fe,$,p),Tv(Kf(ze,Fe));break e}}$=ze=Kf(ze,Fe),oa!==4&&(oa=2),nm===null?nm=[$]:nm.push($),$=ce;do{switch($.tag){case 3:$.flags|=65536,p&=-p,$.lanes|=p;var gt=Hb($,ze,p);mb($,gt);break e;case 1:Fe=ze;var et=$.type,yt=$.stateNode;if(($.flags&128)===0&&(typeof et.getDerivedStateFromError=="function"||yt!==null&&typeof yt.componentDidCatch=="function"&&(Ld===null||!Ld.has(yt)))){$.flags|=65536,p&=-p,$.lanes|=p;var ci=jb($,Fe,p);mb($,ci);break e}}$=$.return}while($!==null)}b1(_)}catch(Ni){p=Ni,Xs===_&&_!==null&&(Xs=_=_.return);continue}break}while(!0)}function _1(){var d=_g.current;return _g.current=pg,d===null?pg:d}function ly(){(oa===0||oa===3||oa===2)&&(oa=4),aa===null||(Id&268435455)===0&&(Pd&268435455)===0||Od(aa,os)}function om(d,p){var _=or;or|=2;var A=_1();(aa!==d||os!==p)&&(il=null,$h(d,p));do try{$S();break}catch(O){y1(d,O)}while(!0);if(Sv(),or=_,_g.current=A,Xs!==null)throw Error(t(261));return aa=null,os=0,oa}function $S(){for(;Xs!==null;)Fd(Xs)}function Wh(){for(;Xs!==null&&!xc();)Fd(Xs)}function Fd(d){var p=A1(d.alternate,d,Co);d.memoizedProps=d.pendingProps,p===null?b1(d):Xs=p,bg.current=null}function b1(d){var p=d;do{var _=p.alternate;if(d=p.return,(p.flags&32768)===0){if(_=r1(_,p,Co),_!==null){Xs=_;return}}else{if(_=US(_,p),_!==null){_.flags&=32767,Xs=_;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{oa=6,Xs=null;return}}if(p=p.sibling,p!==null){Xs=p;return}Xs=p=d}while(p!==null);oa===0&&(oa=5)}function qh(d,p,_){var A=Jn,O=tl.transition;try{tl.transition=null,Jn=1,T1(d,p,_,A)}finally{tl.transition=O,Jn=A}return null}function T1(d,p,_,A){do np();while(Rd!==null);if((or&6)!==0)throw Error(t(327));_=d.finishedWork;var O=d.finishedLanes;if(_===null)return null;if(d.finishedWork=null,d.finishedLanes=0,_===d.current)throw Error(t(177));d.callbackNode=null,d.callbackPriority=0;var $=_.lanes|_.childLanes;if(Na(d,$),d===aa&&(Xs=aa=null,os=0),(_.subtreeFlags&2064)===0&&(_.flags&2064)===0||ip||(ip=!0,w1(bl,function(){return np(),null})),$=(_.flags&15990)!==0,(_.subtreeFlags&15990)!==0||$){$=tl.transition,tl.transition=null;var ce=Jn;Jn=1;var Fe=or;or|=4,bg.current=null,zS(d,_),d1(_,d),qr(tr),Cl=!!nc,tr=nc=null,d.current=_,HS(_),Of(),or=Fe,Jn=ce,tl.transition=$}else d.current=_;if(ip&&(ip=!1,Rd=d,xg=O),$=d.pendingLanes,$===0&&(Ld=null),Ho(_.stateNode),Do(d,Gr()),p!==null)for(A=d.onRecoverableError,_=0;_<p.length;_++)O=p[_],A(O.value,{componentStack:O.stack,digest:O.digest});if(rm)throw rm=!1,d=Tg,Tg=null,d;return(xg&1)!==0&&d.tag!==0&&np(),$=d.pendingLanes,($&1)!==0?d===Sg?sm++:(sm=0,Sg=d):sm=0,wd(),null}function np(){if(Rd!==null){var d=cu(xg),p=tl.transition,_=Jn;try{if(tl.transition=null,Jn=16>d?16:d,Rd===null)var A=!1;else{if(d=Rd,Rd=null,xg=0,(or&6)!==0)throw Error(t(331));var O=or;for(or|=4,Ri=d.current;Ri!==null;){var $=Ri,ce=$.child;if((Ri.flags&16)!==0){var Fe=$.deletions;if(Fe!==null){for(var ze=0;ze<Fe.length;ze++){var Et=Fe[ze];for(Ri=Et;Ri!==null;){var Jt=Ri;switch(Jt.tag){case 0:case 11:case 15:im(8,Jt,$)}var ai=Jt.child;if(ai!==null)ai.return=Jt,Ri=ai;else for(;Ri!==null;){Jt=Ri;var Qt=Jt.sibling,wi=Jt.return;if(a1(Jt),Jt===Et){Ri=null;break}if(Qt!==null){Qt.return=wi,Ri=Qt;break}Ri=wi}}}var Pi=$.alternate;if(Pi!==null){var Bi=Pi.child;if(Bi!==null){Pi.child=null;do{var Es=Bi.sibling;Bi.sibling=null,Bi=Es}while(Bi!==null)}}Ri=$}}if(($.subtreeFlags&2064)!==0&&ce!==null)ce.return=$,Ri=ce;else e:for(;Ri!==null;){if($=Ri,($.flags&2048)!==0)switch($.tag){case 0:case 11:case 15:im(9,$,$.return)}var gt=$.sibling;if(gt!==null){gt.return=$.return,Ri=gt;break e}Ri=$.return}}var et=d.current;for(Ri=et;Ri!==null;){ce=Ri;var yt=ce.child;if((ce.subtreeFlags&2064)!==0&&yt!==null)yt.return=ce,Ri=yt;else e:for(ce=et;Ri!==null;){if(Fe=Ri,(Fe.flags&2048)!==0)try{switch(Fe.tag){case 0:case 11:case 15:yg(9,Fe)}}catch(Ni){ws(Fe,Fe.return,Ni)}if(Fe===ce){Ri=null;break e}var ci=Fe.sibling;if(ci!==null){ci.return=Fe.return,Ri=ci;break e}Ri=Fe.return}}if(or=O,wd(),Rs&&typeof Rs.onPostCommitFiberRoot=="function")try{Rs.onPostCommitFiberRoot(Sc,d)}catch{}A=!0}return A}finally{Jn=_,tl.transition=p}}return!1}function x1(d,p,_){p=Kf(_,p),p=Hb(d,p,1),d=Cd(d,p,1),p=qa(),d!==null&&(fo(d,1,p),Do(d,p))}function ws(d,p,_){if(d.tag===3)x1(d,d,_);else for(;p!==null;){if(p.tag===3){x1(p,d,_);break}else if(p.tag===1){var A=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(Ld===null||!Ld.has(A))){d=Kf(_,d),d=jb(p,d,1),p=Cd(p,d,1),d=qa(),p!==null&&(fo(p,1,d),Do(p,d));break}}p=p.return}}function uy(d,p,_){var A=d.pingCache;A!==null&&A.delete(p),p=qa(),d.pingedLanes|=d.suspendedLanes&_,aa===d&&(os&_)===_&&(oa===4||oa===3&&(os&130023424)===os&&500>Gr()-ry?$h(d,0):ny|=_),Do(d,p)}function Xh(d,p){p===0&&((d.mode&1)===0?p=1:(p=Ba,Ba<<=1,(Ba&130023424)===0&&(Ba=4194304)));var _=qa();d=kc(d,p),d!==null&&(fo(d,p,_),Do(d,_))}function lm(d){var p=d.memoizedState,_=0;p!==null&&(_=p.retryLane),Xh(d,_)}function S1(d,p){var _=0;switch(d.tag){case 13:var A=d.stateNode,O=d.memoizedState;O!==null&&(_=O.retryLane);break;case 19:A=d.stateNode;break;default:throw Error(t(314))}A!==null&&A.delete(p),Xh(d,_)}var A1;A1=function(d,p,_){if(d!==null)if(d.memoizedProps!==p.pendingProps||Mi.current)hi=!0;else{if((d.lanes&_)===0&&(p.flags&128)===0)return hi=!1,n1(d,p,_);hi=(d.flags&131072)!==0}else hi=!1,ss&&(p.flags&1048576)!==0&&sb(p,Bh,p.index);switch(p.lanes=0,p.tag){case 2:var A=p.type;tm(d,p),d=p.pendingProps;var O=Er(p,Rt.current);Yf(p,_),O=kv(null,p,A,d,O,_);var $=Ov();return p.flags|=1,typeof O=="object"&&O!==null&&typeof O.render=="function"&&O.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,xn(A)?($=!0,rs(p)):$=!1,p.memoizedState=O.state!==null&&O.state!==void 0?O.state:null,Cv(p),O.updater=mg,p.stateNode=O,O._reactInternals=p,zv(p,A,d,_),p=$v(null,p,A,!0,$,_)):(p.tag=0,ss&&$&&vv(p),as(null,p,O,_),p=p.child),p;case 16:A=p.elementType;e:{switch(tm(d,p),d=p.pendingProps,O=A._init,A=O(A._payload),p.type=A,O=p.tag=Vl(A),d=wu(A,d),O){case 0:p=Gv(null,p,A,d,_);break e;case 1:p=Zb(null,p,A,d,_);break e;case 11:p=qb(null,p,A,d,_);break e;case 14:p=Xb(null,p,A,wu(A.type,d),_);break e}throw Error(t(306,A,""))}return p;case 0:return A=p.type,O=p.pendingProps,O=p.elementType===A?O:wu(A,O),Gv(d,p,A,O,_);case 1:return A=p.type,O=p.pendingProps,O=p.elementType===A?O:wu(A,O),Zb(d,p,A,O,_);case 3:e:{if(Jb(p),d===null)throw Error(t(387));A=p.pendingProps,$=p.memoizedState,O=$.element,pb(d,p),lg(p,A,null,_);var ce=p.memoizedState;if(A=ce.element,$.isDehydrated)if($={element:A,isDehydrated:!1,cache:ce.cache,pendingSuspenseBoundaries:ce.pendingSuspenseBoundaries,transitions:ce.transitions},p.updateQueue.baseState=$,p.memoizedState=$,p.flags&256){O=Kf(Error(t(423)),p),p=e1(d,p,A,_,O);break e}else if(A!==O){O=Kf(Error(t(424)),p),p=e1(d,p,A,_,O);break e}else for(el=$n(p.stateNode.containerInfo.firstChild),Jo=p,ss=!0,Au=null,_=hb(p,null,A,_),p.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(Wf(),A===O){p=ac(d,p,_);break e}as(d,p,A,_)}p=p.child}return p;case 5:return vb(p),d===null&&bv(p),A=p.type,O=p.pendingProps,$=d!==null?d.memoizedProps:null,ce=O.children,Tu(A,O)?ce=null:$!==null&&Tu(A,$)&&(p.flags|=32),Kb(d,p),as(d,p,ce,_),p.child;case 6:return d===null&&bv(p),null;case 13:return t1(d,p,_);case 4:return Mv(p,p.stateNode.containerInfo),A=p.pendingProps,d===null?p.child=qf(p,null,A,_):as(d,p,A,_),p.child;case 11:return A=p.type,O=p.pendingProps,O=p.elementType===A?O:wu(A,O),qb(d,p,A,O,_);case 7:return as(d,p,p.pendingProps,_),p.child;case 8:return as(d,p,p.pendingProps.children,_),p.child;case 12:return as(d,p,p.pendingProps.children,_),p.child;case 10:e:{if(A=p.type._context,O=p.pendingProps,$=p.memoizedProps,ce=O.value,pt(sg,A._currentValue),A._currentValue=ce,$!==null)if(Oe($.value,ce)){if($.children===O.children&&!Mi.current){p=ac(d,p,_);break e}}else for($=p.child,$!==null&&($.return=p);$!==null;){var Fe=$.dependencies;if(Fe!==null){ce=$.child;for(var ze=Fe.firstContext;ze!==null;){if(ze.context===A){if($.tag===1){ze=Oc(-1,_&-_),ze.tag=2;var Et=$.updateQueue;if(Et!==null){Et=Et.shared;var Jt=Et.pending;Jt===null?ze.next=ze:(ze.next=Jt.next,Jt.next=ze),Et.pending=ze}}$.lanes|=_,ze=$.alternate,ze!==null&&(ze.lanes|=_),wv($.return,_,p),Fe.lanes|=_;break}ze=ze.next}}else if($.tag===10)ce=$.type===p.type?null:$.child;else if($.tag===18){if(ce=$.return,ce===null)throw Error(t(341));ce.lanes|=_,Fe=ce.alternate,Fe!==null&&(Fe.lanes|=_),wv(ce,_,p),ce=$.sibling}else ce=$.child;if(ce!==null)ce.return=$;else for(ce=$;ce!==null;){if(ce===p){ce=null;break}if($=ce.sibling,$!==null){$.return=ce.return,ce=$;break}ce=ce.return}$=ce}as(d,p,O.children,_),p=p.child}return p;case 9:return O=p.type,A=p.pendingProps.children,Yf(p,_),O=Nl(O),A=A(O),p.flags|=1,as(d,p,A,_),p.child;case 14:return A=p.type,O=wu(A,p.pendingProps),O=wu(A.type,O),Xb(d,p,A,O,_);case 15:return Yb(d,p,p.type,p.pendingProps,_);case 17:return A=p.type,O=p.pendingProps,O=p.elementType===A?O:wu(A,O),tm(d,p),p.tag=1,xn(A)?(d=!0,rs(p)):d=!1,Yf(p,_),Vb(p,A,O),zv(p,A,O,_),$v(null,p,A,!0,d,_);case 19:return i1(d,p,_);case 22:return Qb(d,p,_)}throw Error(t(156,p.tag))};function w1(d,p){return rr(d,p)}function um(d,p,_,A){this.tag=d,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nl(d,p,_,A){return new um(d,p,_,A)}function Eg(d){return d=d.prototype,!(!d||!d.isReactComponent)}function Vl(d){if(typeof d=="function")return Eg(d)?1:0;if(d!=null){if(d=d.$$typeof,d===De)return 11;if(d===_t)return 14}return 2}function Io(d,p){var _=d.alternate;return _===null?(_=nl(d.tag,p,d.key,d.mode),_.elementType=d.elementType,_.type=d.type,_.stateNode=d.stateNode,_.alternate=d,d.alternate=_):(_.pendingProps=p,_.type=d.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=d.flags&14680064,_.childLanes=d.childLanes,_.lanes=d.lanes,_.child=d.child,_.memoizedProps=d.memoizedProps,_.memoizedState=d.memoizedState,_.updateQueue=d.updateQueue,p=d.dependencies,_.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},_.sibling=d.sibling,_.index=d.index,_.ref=d.ref,_}function lc(d,p,_,A,O,$){var ce=2;if(A=d,typeof d=="function")Eg(d)&&(ce=1);else if(typeof d=="string")ce=5;else e:switch(d){case fe:return rl(_.children,O,$,p);case ve:ce=8,O|=8;break;case ie:return d=nl(12,_,p,O|2),d.elementType=ie,d.lanes=$,d;case ke:return d=nl(13,_,p,O),d.elementType=ke,d.lanes=$,d;case ut:return d=nl(19,_,p,O),d.elementType=ut,d.lanes=$,d;case tt:return Fc(_,O,$,p);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case re:ce=10;break e;case Ne:ce=9;break e;case De:ce=11;break e;case _t:ce=14;break e;case vt:ce=16,A=null;break e}throw Error(t(130,d==null?d:typeof d,""))}return p=nl(ce,_,p,O),p.elementType=d,p.type=A,p.lanes=$,p}function rl(d,p,_,A){return d=nl(7,d,A,p),d.lanes=_,d}function Fc(d,p,_,A){return d=nl(22,d,A,p),d.elementType=tt,d.lanes=_,d.stateNode={isHidden:!1},d}function Yh(d,p,_){return d=nl(6,d,null,p),d.lanes=_,d}function Bd(d,p,_){return p=nl(4,d.children!==null?d.children:[],d.key,p),p.lanes=_,p.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},p}function rp(d,p,_,A,O){this.tag=p,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tl(0),this.expirationTimes=Tl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tl(0),this.identifierPrefix=A,this.onRecoverableError=O,this.mutableSourceEagerHydrationData=null}function Nd(d,p,_,A,O,$,ce,Fe,ze){return d=new rp(d,p,_,Fe,ze),p===1?(p=1,$===!0&&(p|=8)):p=0,$=nl(3,null,null,p),d.current=$,$.stateNode=d,$.memoizedState={element:A,isDehydrated:_,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cv($),d}function cm(d,p,_){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:be,key:A==null?null:""+A,children:d,containerInfo:p,implementation:_}}function cy(d){if(!d)return Gt;d=d._reactInternals;e:{if(nn(d)!==d||d.tag!==1)throw Error(t(170));var p=d;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(xn(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(t(171))}if(d.tag===1){var _=d.type;if(xn(_))return Sd(d,_,p)}return p}function dm(d,p,_,A,O,$,ce,Fe,ze){return d=Nd(_,A,!0,d,O,$,ce,Fe,ze),d.context=cy(null),_=d.current,A=qa(),O=kd(_),$=Oc(A,O),$.callback=p??null,Cd(_,$,O),d.current.lanes=O,fo(d,O,A),Do(d,A),d}function Ud(d,p,_,A){var O=p.current,$=qa(),ce=kd(O);return _=cy(_),p.context===null?p.context=_:p.pendingContext=_,p=Oc($,ce),p.payload={element:d},A=A===void 0?null:A,A!==null&&(p.callback=A),d=Cd(O,p,ce),d!==null&&(Mu(d,O,ce,$),og(d,O,ce)),ce}function Qh(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function dy(d,p){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var _=d.retryLane;d.retryLane=_!==0&&_<p?_:p}}function hm(d,p){dy(d,p),(d=d.alternate)&&dy(d,p)}function E1(){return null}var hy=typeof reportError=="function"?reportError:function(d){console.error(d)};function sp(d){this._internalRoot=d}Kh.prototype.render=sp.prototype.render=function(d){var p=this._internalRoot;if(p===null)throw Error(t(409));Ud(d,p,null,null)},Kh.prototype.unmount=sp.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var p=d.containerInfo;Gh(function(){Ud(null,d,null,null)}),p[na]=null}};function Kh(d){this._internalRoot=d}Kh.prototype.unstable_scheduleHydration=function(d){if(d){var p=Eh();d={blockedOn:null,target:d,priority:p};for(var _=0;_<wl.length&&p!==0&&p<wl[_].priority;_++);wl.splice(_,0,d),_===0&&Dh(d)}};function Cg(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function ap(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function fy(){}function C1(d,p,_,A,O){if(O){if(typeof A=="function"){var $=A;A=function(){var Et=Qh(ce);$.call(Et)}}var ce=dm(p,A,d,0,null,!1,!1,"",fy);return d._reactRootContainer=ce,d[na]=ce.current,pn(d.nodeType===8?d.parentNode:d),Gh(),ce}for(;O=d.lastChild;)d.removeChild(O);if(typeof A=="function"){var Fe=A;A=function(){var Et=Qh(ze);Fe.call(Et)}}var ze=Nd(d,0,!1,null,null,!1,!1,"",fy);return d._reactRootContainer=ze,d[na]=ze.current,pn(d.nodeType===8?d.parentNode:d),Gh(function(){Ud(p,ze,_,A)}),ze}function fm(d,p,_,A,O){var $=_._reactRootContainer;if($){var ce=$;if(typeof O=="function"){var Fe=O;O=function(){var ze=Qh(ce);Fe.call(ze)}}Ud(p,ce,d,O)}else ce=C1(_,p,d,O,A);return Qh(ce)}Ac=function(d){switch(d.tag){case 3:var p=d.stateNode;if(p.current.memoizedState.isDehydrated){var _=Ku(p.pendingLanes);_!==0&&(wh(p,_|1),Do(p,Gr()),(or&6)===0&&(tp=Gr()+500,wd()))}break;case 13:Gh(function(){var A=kc(d,1);if(A!==null){var O=qa();Mu(A,d,1,O)}}),hm(d,1)}},xl=function(d){if(d.tag===13){var p=kc(d,134217728);if(p!==null){var _=qa();Mu(p,d,134217728,_)}hm(d,134217728)}},wc=function(d){if(d.tag===13){var p=kd(d),_=kc(d,p);if(_!==null){var A=qa();Mu(_,d,p,A)}hm(d,p)}},Eh=function(){return Jn},sd=function(d,p){var _=Jn;try{return Jn=d,p()}finally{Jn=_}},pi=function(d,p,_){switch(p){case"input":if(bs(d,_),p=_.name,_.type==="radio"&&p!=null){for(_=d;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<_.length;p++){var A=_[p];if(A!==d&&A.form===d.form){var O=ye(A);if(!O)throw Error(t(90));xi(A),bs(A,O)}}}break;case"textarea":Oa(d,_);break;case"select":p=_.value,p!=null&&gn(d,!!_.multiple,p,!1)}},bi=wg,Ui=Gh;var WS={usingClientEntryPoint:!1,Events:[j,Y,ye,Ye,jt,wg]},op={findFiberByHostInstance:L,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},py={bundleType:op.bundleType,version:op.version,rendererPackageName:op.rendererPackageName,rendererConfig:op.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ge.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=kf(d),d===null?null:d.stateNode},findFiberByHostInstance:op.findFiberByHostInstance||E1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lp.isDisabled&&lp.supportsFiber)try{Sc=lp.inject(py),Rs=lp}catch{}}return jl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WS,jl.createPortal=function(d,p){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cg(p))throw Error(t(200));return cm(d,p,null,_)},jl.createRoot=function(d,p){if(!Cg(d))throw Error(t(299));var _=!1,A="",O=hy;return p!=null&&(p.unstable_strictMode===!0&&(_=!0),p.identifierPrefix!==void 0&&(A=p.identifierPrefix),p.onRecoverableError!==void 0&&(O=p.onRecoverableError)),p=Nd(d,1,!1,null,null,_,!1,A,O),d[na]=p.current,pn(d.nodeType===8?d.parentNode:d),new sp(p)},jl.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var p=d._reactInternals;if(p===void 0)throw typeof d.render=="function"?Error(t(188)):(d=Object.keys(d).join(","),Error(t(268,d)));return d=kf(p),d=d===null?null:d.stateNode,d},jl.flushSync=function(d){return Gh(d)},jl.hydrate=function(d,p,_){if(!ap(p))throw Error(t(200));return fm(null,d,p,!0,_)},jl.hydrateRoot=function(d,p,_){if(!Cg(d))throw Error(t(405));var A=_!=null&&_.hydratedSources||null,O=!1,$="",ce=hy;if(_!=null&&(_.unstable_strictMode===!0&&(O=!0),_.identifierPrefix!==void 0&&($=_.identifierPrefix),_.onRecoverableError!==void 0&&(ce=_.onRecoverableError)),p=dm(p,null,d,1,_??null,O,!1,$,ce),d[na]=p.current,pn(d),A)for(d=0;d<A.length;d++)_=A[d],O=_._getVersion,O=O(_._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[_,O]:p.mutableSourceEagerHydrationData.push(_,O);return new Kh(p)},jl.render=function(d,p,_){if(!ap(p))throw Error(t(200));return fm(null,d,p,!1,_)},jl.unmountComponentAtNode=function(d){if(!ap(d))throw Error(t(40));return d._reactRootContainer?(Gh(function(){fm(null,null,d,!1,function(){d._reactRootContainer=null,d[na]=null})}),!0):!1},jl.unstable_batchedUpdates=wg,jl.unstable_renderSubtreeIntoContainer=function(d,p,_,A){if(!ap(_))throw Error(t(200));if(d==null||d._reactInternals===void 0)throw Error(t(38));return fm(d,p,_,!1,A)},jl.version="18.3.1-next-f1338f8080-20240426",jl}var rD;function m5(){if(rD)return TA.exports;rD=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),TA.exports=p5(),TA.exports}var sD;function g5(){if(sD)return j1;sD=1;var r=m5();return j1.createRoot=r.createRoot,j1.hydrateRoot=r.hydrateRoot,j1}var v5=g5(),AA={exports:{}},Fr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aD;function y5(){if(aD)return Fr;aD=1;var r=typeof Symbol=="function"&&Symbol.for,e=r?Symbol.for("react.element"):60103,t=r?Symbol.for("react.portal"):60106,i=r?Symbol.for("react.fragment"):60107,n=r?Symbol.for("react.strict_mode"):60108,s=r?Symbol.for("react.profiler"):60114,a=r?Symbol.for("react.provider"):60109,c=r?Symbol.for("react.context"):60110,h=r?Symbol.for("react.async_mode"):60111,m=r?Symbol.for("react.concurrent_mode"):60111,v=r?Symbol.for("react.forward_ref"):60112,b=r?Symbol.for("react.suspense"):60113,x=r?Symbol.for("react.suspense_list"):60120,C=r?Symbol.for("react.memo"):60115,B=r?Symbol.for("react.lazy"):60116,P=r?Symbol.for("react.block"):60121,N=r?Symbol.for("react.fundamental"):60117,ae=r?Symbol.for("react.responder"):60118,X=r?Symbol.for("react.scope"):60119;function de(ue){if(typeof ue=="object"&&ue!==null){var be=ue.$$typeof;switch(be){case e:switch(ue=ue.type,ue){case h:case m:case i:case s:case n:case b:return ue;default:switch(ue=ue&&ue.$$typeof,ue){case c:case v:case B:case C:case a:return ue;default:return be}}case t:return be}}}function ge(ue){return de(ue)===m}return Fr.AsyncMode=h,Fr.ConcurrentMode=m,Fr.ContextConsumer=c,Fr.ContextProvider=a,Fr.Element=e,Fr.ForwardRef=v,Fr.Fragment=i,Fr.Lazy=B,Fr.Memo=C,Fr.Portal=t,Fr.Profiler=s,Fr.StrictMode=n,Fr.Suspense=b,Fr.isAsyncMode=function(ue){return ge(ue)||de(ue)===h},Fr.isConcurrentMode=ge,Fr.isContextConsumer=function(ue){return de(ue)===c},Fr.isContextProvider=function(ue){return de(ue)===a},Fr.isElement=function(ue){return typeof ue=="object"&&ue!==null&&ue.$$typeof===e},Fr.isForwardRef=function(ue){return de(ue)===v},Fr.isFragment=function(ue){return de(ue)===i},Fr.isLazy=function(ue){return de(ue)===B},Fr.isMemo=function(ue){return de(ue)===C},Fr.isPortal=function(ue){return de(ue)===t},Fr.isProfiler=function(ue){return de(ue)===s},Fr.isStrictMode=function(ue){return de(ue)===n},Fr.isSuspense=function(ue){return de(ue)===b},Fr.isValidElementType=function(ue){return typeof ue=="string"||typeof ue=="function"||ue===i||ue===m||ue===s||ue===n||ue===b||ue===x||typeof ue=="object"&&ue!==null&&(ue.$$typeof===B||ue.$$typeof===C||ue.$$typeof===a||ue.$$typeof===c||ue.$$typeof===v||ue.$$typeof===N||ue.$$typeof===ae||ue.$$typeof===X||ue.$$typeof===P)},Fr.typeOf=de,Fr}var oD;function _5(){return oD||(oD=1,AA.exports=y5()),AA.exports}var wA,lD;function b5(){if(lD)return wA;lD=1;var r=_5(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},t={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},n={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};s[r.ForwardRef]=i,s[r.Memo]=n;function a(B){return r.isMemo(B)?n:s[B.$$typeof]||e}var c=Object.defineProperty,h=Object.getOwnPropertyNames,m=Object.getOwnPropertySymbols,v=Object.getOwnPropertyDescriptor,b=Object.getPrototypeOf,x=Object.prototype;function C(B,P,N){if(typeof P!="string"){if(x){var ae=b(P);ae&&ae!==x&&C(B,ae,N)}var X=h(P);m&&(X=X.concat(m(P)));for(var de=a(B),ge=a(P),ue=0;ue<X.length;++ue){var be=X[ue];if(!t[be]&&!(N&&N[be])&&!(ge&&ge[be])&&!(de&&de[be])){var fe=v(P,be);try{c(B,be,fe)}catch{}}}}return B}return wA=C,wA}var T5=b5();const x5=Yu(T5);var EA={exports:{}},Br={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var CA,uD;function S5(){if(uD)return CA;uD=1;var r=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable;function i(s){if(s==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(s)}function n(){try{if(!Object.assign)return!1;var s=new String("abc");if(s[5]="de",Object.getOwnPropertyNames(s)[0]==="5")return!1;for(var a={},c=0;c<10;c++)a["_"+String.fromCharCode(c)]=c;var h=Object.getOwnPropertyNames(a).map(function(v){return a[v]});if(h.join("")!=="0123456789")return!1;var m={};return"abcdefghijklmnopqrst".split("").forEach(function(v){m[v]=v}),Object.keys(Object.assign({},m)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return CA=n()?Object.assign:function(s,a){for(var c,h=i(s),m,v=1;v<arguments.length;v++){c=Object(arguments[v]);for(var b in c)e.call(c,b)&&(h[b]=c[b]);if(r){m=r(c);for(var x=0;x<m.length;x++)t.call(c,m[x])&&(h[m[x]]=c[m[x]])}}return h},CA}/** @license React v16.14.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cD;function A5(){if(cD)return Br;cD=1;var r=S5(),e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,i=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,c=e?Symbol.for("react.provider"):60109,h=e?Symbol.for("react.context"):60110,m=e?Symbol.for("react.forward_ref"):60112,v=e?Symbol.for("react.suspense"):60113,b=e?Symbol.for("react.memo"):60115,x=e?Symbol.for("react.lazy"):60116,C=typeof Symbol=="function"&&Symbol.iterator;function B(Re){for(var lt="https://reactjs.org/docs/error-decoder.html?invariant="+Re,bt=1;bt<arguments.length;bt++)lt+="&args[]="+encodeURIComponent(arguments[bt]);return"Minified React error #"+Re+"; visit "+lt+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N={};function ae(Re,lt,bt){this.props=Re,this.context=lt,this.refs=N,this.updater=bt||P}ae.prototype.isReactComponent={},ae.prototype.setState=function(Re,lt){if(typeof Re!="object"&&typeof Re!="function"&&Re!=null)throw Error(B(85));this.updater.enqueueSetState(this,Re,lt,"setState")},ae.prototype.forceUpdate=function(Re){this.updater.enqueueForceUpdate(this,Re,"forceUpdate")};function X(){}X.prototype=ae.prototype;function de(Re,lt,bt){this.props=Re,this.context=lt,this.refs=N,this.updater=bt||P}var ge=de.prototype=new X;ge.constructor=de,r(ge,ae.prototype),ge.isPureReactComponent=!0;var ue={current:null},be=Object.prototype.hasOwnProperty,fe={key:!0,ref:!0,__self:!0,__source:!0};function ve(Re,lt,bt){var Je,Dt={},Yt=null,vi=null;if(lt!=null)for(Je in lt.ref!==void 0&&(vi=lt.ref),lt.key!==void 0&&(Yt=""+lt.key),lt)be.call(lt,Je)&&!fe.hasOwnProperty(Je)&&(Dt[Je]=lt[Je]);var xi=arguments.length-2;if(xi===1)Dt.children=bt;else if(1<xi){for(var Yi=Array(xi),Ki=0;Ki<xi;Ki++)Yi[Ki]=arguments[Ki+2];Dt.children=Yi}if(Re&&Re.defaultProps)for(Je in xi=Re.defaultProps,xi)Dt[Je]===void 0&&(Dt[Je]=xi[Je]);return{$$typeof:t,type:Re,key:Yt,ref:vi,props:Dt,_owner:ue.current}}function ie(Re,lt){return{$$typeof:t,type:Re.type,key:lt,ref:Re.ref,props:Re.props,_owner:Re._owner}}function re(Re){return typeof Re=="object"&&Re!==null&&Re.$$typeof===t}function Ne(Re){var lt={"=":"=0",":":"=2"};return"$"+(""+Re).replace(/[=:]/g,function(bt){return lt[bt]})}var De=/\/+/g,ke=[];function ut(Re,lt,bt,Je){if(ke.length){var Dt=ke.pop();return Dt.result=Re,Dt.keyPrefix=lt,Dt.func=bt,Dt.context=Je,Dt.count=0,Dt}return{result:Re,keyPrefix:lt,func:bt,context:Je,count:0}}function _t(Re){Re.result=null,Re.keyPrefix=null,Re.func=null,Re.context=null,Re.count=0,10>ke.length&&ke.push(Re)}function vt(Re,lt,bt,Je){var Dt=typeof Re;(Dt==="undefined"||Dt==="boolean")&&(Re=null);var Yt=!1;if(Re===null)Yt=!0;else switch(Dt){case"string":case"number":Yt=!0;break;case"object":switch(Re.$$typeof){case t:case i:Yt=!0}}if(Yt)return bt(Je,Re,lt===""?"."+je(Re,0):lt),1;if(Yt=0,lt=lt===""?".":lt+":",Array.isArray(Re))for(var vi=0;vi<Re.length;vi++){Dt=Re[vi];var xi=lt+je(Dt,vi);Yt+=vt(Dt,xi,bt,Je)}else if(Re===null||typeof Re!="object"?xi=null:(xi=C&&Re[C]||Re["@@iterator"],xi=typeof xi=="function"?xi:null),typeof xi=="function")for(Re=xi.call(Re),vi=0;!(Dt=Re.next()).done;)Dt=Dt.value,xi=lt+je(Dt,vi++),Yt+=vt(Dt,xi,bt,Je);else if(Dt==="object")throw bt=""+Re,Error(B(31,bt==="[object Object]"?"object with keys {"+Object.keys(Re).join(", ")+"}":bt,""));return Yt}function tt(Re,lt,bt){return Re==null?0:vt(Re,"",lt,bt)}function je(Re,lt){return typeof Re=="object"&&Re!==null&&Re.key!=null?Ne(Re.key):lt.toString(36)}function it(Re,lt){Re.func.call(Re.context,lt,Re.count++)}function Xe(Re,lt,bt){var Je=Re.result,Dt=Re.keyPrefix;Re=Re.func.call(Re.context,lt,Re.count++),Array.isArray(Re)?Se(Re,Je,bt,function(Yt){return Yt}):Re!=null&&(re(Re)&&(Re=ie(Re,Dt+(!Re.key||lt&&lt.key===Re.key?"":(""+Re.key).replace(De,"$&/")+"/")+bt)),Je.push(Re))}function Se(Re,lt,bt,Je,Dt){var Yt="";bt!=null&&(Yt=(""+bt).replace(De,"$&/")+"/"),lt=ut(lt,Yt,Je,Dt),tt(Re,Xe,lt),_t(lt)}var ct={current:null};function xt(){var Re=ct.current;if(Re===null)throw Error(B(321));return Re}var ii={ReactCurrentDispatcher:ct,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:ue,IsSomeRendererActing:{current:!1},assign:r};return Br.Children={map:function(Re,lt,bt){if(Re==null)return Re;var Je=[];return Se(Re,Je,null,lt,bt),Je},forEach:function(Re,lt,bt){if(Re==null)return Re;lt=ut(null,null,lt,bt),tt(Re,it,lt),_t(lt)},count:function(Re){return tt(Re,function(){return null},null)},toArray:function(Re){var lt=[];return Se(Re,lt,null,function(bt){return bt}),lt},only:function(Re){if(!re(Re))throw Error(B(143));return Re}},Br.Component=ae,Br.Fragment=n,Br.Profiler=a,Br.PureComponent=de,Br.StrictMode=s,Br.Suspense=v,Br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ii,Br.cloneElement=function(Re,lt,bt){if(Re==null)throw Error(B(267,Re));var Je=r({},Re.props),Dt=Re.key,Yt=Re.ref,vi=Re._owner;if(lt!=null){if(lt.ref!==void 0&&(Yt=lt.ref,vi=ue.current),lt.key!==void 0&&(Dt=""+lt.key),Re.type&&Re.type.defaultProps)var xi=Re.type.defaultProps;for(Yi in lt)be.call(lt,Yi)&&!fe.hasOwnProperty(Yi)&&(Je[Yi]=lt[Yi]===void 0&&xi!==void 0?xi[Yi]:lt[Yi])}var Yi=arguments.length-2;if(Yi===1)Je.children=bt;else if(1<Yi){xi=Array(Yi);for(var Ki=0;Ki<Yi;Ki++)xi[Ki]=arguments[Ki+2];Je.children=xi}return{$$typeof:t,type:Re.type,key:Dt,ref:Yt,props:Je,_owner:vi}},Br.createContext=function(Re,lt){return lt===void 0&&(lt=null),Re={$$typeof:h,_calculateChangedBits:lt,_currentValue:Re,_currentValue2:Re,_threadCount:0,Provider:null,Consumer:null},Re.Provider={$$typeof:c,_context:Re},Re.Consumer=Re},Br.createElement=ve,Br.createFactory=function(Re){var lt=ve.bind(null,Re);return lt.type=Re,lt},Br.createRef=function(){return{current:null}},Br.forwardRef=function(Re){return{$$typeof:m,render:Re}},Br.isValidElement=re,Br.lazy=function(Re){return{$$typeof:x,_ctor:Re,_status:-1,_result:null}},Br.memo=function(Re,lt){return{$$typeof:b,type:Re,compare:lt===void 0?null:lt}},Br.useCallback=function(Re,lt){return xt().useCallback(Re,lt)},Br.useContext=function(Re,lt){return xt().useContext(Re,lt)},Br.useDebugValue=function(){},Br.useEffect=function(Re,lt){return xt().useEffect(Re,lt)},Br.useImperativeHandle=function(Re,lt,bt){return xt().useImperativeHandle(Re,lt,bt)},Br.useLayoutEffect=function(Re,lt){return xt().useLayoutEffect(Re,lt)},Br.useMemo=function(Re,lt){return xt().useMemo(Re,lt)},Br.useReducer=function(Re,lt,bt){return xt().useReducer(Re,lt,bt)},Br.useRef=function(Re){return xt().useRef(Re)},Br.useState=function(Re){return xt().useState(Re)},Br.version="16.14.0",Br}var dD;function w5(){return dD||(dD=1,EA.exports=A5()),EA.exports}var E5=w5();const Qg=Yu(E5);function bn(r,e,t,i){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function c(v){try{m(i.next(v))}catch(b){a(b)}}function h(v){try{m(i.throw(v))}catch(b){a(b)}}function m(v){v.done?s(v.value):n(v.value).then(c,h)}m((i=i.apply(r,e||[])).next())})}function hD(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function jn(r){return this instanceof jn?(this.v=r,this):new jn(r)}function oh(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(r,e||[]),n,s=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",a),n[Symbol.asyncIterator]=function(){return this},n;function a(C){return function(B){return Promise.resolve(B).then(C,b)}}function c(C,B){i[C]&&(n[C]=function(P){return new Promise(function(N,ae){s.push([C,P,N,ae])>1||h(C,P)})},B&&(n[C]=B(n[C])))}function h(C,B){try{m(i[C](B))}catch(P){x(s[0][3],P)}}function m(C){C.value instanceof jn?Promise.resolve(C.value.v).then(v,b):x(s[0][2],C)}function v(C){h("next",C)}function b(C){h("throw",C)}function x(C,B){C(B),s.shift(),s.length&&h(s[0][0],s[0][1])}}function dT(r){var e,t;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=r[n]?function(a){return(t=!t)?{value:jn(r[n](a)),done:!1}:s?s(a):a}:s}}function Um(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof hD=="function"?hD(r):r[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=r[s]&&function(a){return new Promise(function(c,h){a=r[s](a),n(c,h,a.done,a.value)})}}function n(s,a,c,h){Promise.resolve(h).then(function(m){s({value:m,done:c})},a)}}const C5=new TextDecoder("utf-8"),Gw=r=>C5.decode(r),M5=new TextEncoder,o2=r=>M5.encode(r),[aQ,D5]=(()=>{const r=()=>{throw new Error("BigInt is not available in this environment")};function e(){throw r()}return e.asIntN=()=>{throw r()},e.asUintN=()=>{throw r()},typeof BigInt<"u"?[BigInt,!0]:[e,!1]})(),[B_,oQ]=(()=>{const r=()=>{throw new Error("BigInt64Array is not available in this environment")};class e{static get BYTES_PER_ELEMENT(){return 8}static of(){throw r()}static from(){throw r()}constructor(){throw r()}}return typeof BigInt64Array<"u"?[BigInt64Array,!0]:[e,!1]})(),[N_,lQ]=(()=>{const r=()=>{throw new Error("BigUint64Array is not available in this environment")};class e{static get BYTES_PER_ELEMENT(){return 8}static of(){throw r()}static from(){throw r()}constructor(){throw r()}}return typeof BigUint64Array<"u"?[BigUint64Array,!0]:[e,!1]})(),I5=r=>typeof r=="number",GP=r=>typeof r=="boolean",Ra=r=>typeof r=="function",iu=r=>r!=null&&Object(r)===r,wp=r=>iu(r)&&Ra(r.then),U_=r=>iu(r)&&Ra(r[Symbol.iterator]),K0=r=>iu(r)&&Ra(r[Symbol.asyncIterator]),$w=r=>iu(r)&&iu(r.schema),$P=r=>iu(r)&&"done"in r&&"value"in r,WP=r=>iu(r)&&Ra(r.stat)&&I5(r.fd),qP=r=>iu(r)&&l2(r.body),jx=r=>"_getDOMStream"in r&&"_getNodeStream"in r,P5=r=>iu(r)&&Ra(r.abort)&&Ra(r.getWriter)&&!jx(r),l2=r=>iu(r)&&Ra(r.cancel)&&Ra(r.getReader)&&!jx(r),L5=r=>iu(r)&&Ra(r.end)&&Ra(r.write)&&GP(r.writable)&&!jx(r),XP=r=>iu(r)&&Ra(r.read)&&Ra(r.pipe)&&GP(r.readable)&&!jx(r),R5=r=>iu(r)&&Ra(r.clear)&&Ra(r.bytes)&&Ra(r.position)&&Ra(r.setPosition)&&Ra(r.capacity)&&Ra(r.getBufferIdentifier)&&Ra(r.createLong),u2=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function k5(r){const e=r[0]?[r[0]]:[];let t,i,n,s;for(let a,c,h=0,m=0,v=r.length;++h<v;){if(a=e[m],c=r[h],!a||!c||a.buffer!==c.buffer||c.byteOffset<a.byteOffset){c&&(e[++m]=c);continue}if({byteOffset:t,byteLength:n}=a,{byteOffset:i,byteLength:s}=c,t+n<i||i+s<t){c&&(e[++m]=c);continue}e[m]=new Uint8Array(a.buffer,t,i-t+s)}return e}function fD(r,e,t=0,i=e.byteLength){const n=r.byteLength,s=new Uint8Array(r.buffer,r.byteOffset,n),a=new Uint8Array(e.buffer,e.byteOffset,Math.min(i,n));return s.set(a,t),r}function gh(r,e){const t=k5(r),i=t.reduce((v,b)=>v+b.byteLength,0);let n,s,a,c=0,h=-1;const m=Math.min(e||Number.POSITIVE_INFINITY,i);for(const v=t.length;++h<v;){if(n=t[h],s=n.subarray(0,Math.min(n.length,m-c)),m<=c+s.length){s.length<n.length?t[h]=n.subarray(s.length):s.length===n.length&&h++,a?fD(a,s,c):a=s;break}fD(a||(a=new Uint8Array(m)),s,c),c+=s.length}return[a||new Uint8Array(0),t.slice(h),i-(a?a.byteLength:0)]}function es(r,e){let t=$P(e)?e.value:e;return t instanceof r?r===Uint8Array?new r(t.buffer,t.byteOffset,t.byteLength):t:t?(typeof t=="string"&&(t=o2(t)),t instanceof ArrayBuffer?new r(t):t instanceof u2?new r(t):R5(t)?es(r,t.bytes()):ArrayBuffer.isView(t)?t.byteLength<=0?new r(0):new r(t.buffer,t.byteOffset,t.byteLength/r.BYTES_PER_ELEMENT):r.from(t)):new r(0)}const Uy=r=>es(Int32Array,r),Mr=r=>es(Uint8Array,r),Ww=r=>(r.next(),r);function*O5(r,e){const t=function*(n){yield n},i=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof u2?t(e):U_(e)?e:t(e);return yield*Ww(function*(n){let s=null;do s=n.next(yield es(r,s));while(!s.done)}(i[Symbol.iterator]())),new r}const F5=r=>O5(Uint8Array,r);function YP(r,e){return oh(this,arguments,function*(){if(wp(e))return yield jn(yield jn(yield*dT(Um(YP(r,yield jn(e))))));const i=function(a){return oh(this,arguments,function*(){yield yield jn(yield jn(a))})},n=function(a){return oh(this,arguments,function*(){yield jn(yield*dT(Um(Ww(function*(c){let h=null;do h=c.next(yield h==null?void 0:h.value);while(!h.done)}(a[Symbol.iterator]())))))})},s=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof u2?i(e):U_(e)?n(e):K0(e)?e:i(e);return yield jn(yield*dT(Um(Ww(function(a){return oh(this,arguments,function*(){let c=null;do c=yield jn(a.next(yield yield jn(es(r,c))));while(!c.done)})}(s[Symbol.asyncIterator]()))))),yield jn(new r)})}const B5=r=>YP(Uint8Array,r);function c2(r,e,t){if(r!==0){t=t.slice(0,e+1);for(let i=-1;++i<=e;)t[i]+=r}return t}function N5(r,e){let t=0;const i=r.length;if(i!==e.length)return!1;if(i>0)do if(r[t]!==e[t])return!1;while(++t<i);return!0}const pc={fromIterable(r){return G1(U5(r))},fromAsyncIterable(r){return G1(V5(r))},fromDOMStream(r){return G1(z5(r))},fromNodeStream(r){return G1(j5(r))},toDOMStream(r,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(r,e){throw new Error('"toNodeStream" not available in this environment')}},G1=r=>(r.next(),r);function*U5(r){let e,t=!1,i=[],n,s,a,c=0;function h(){return s==="peek"?gh(i,a)[0]:([n,i,c]=gh(i,a),n)}({cmd:s,size:a}=yield null);const m=F5(r)[Symbol.iterator]();try{do if({done:e,value:n}=Number.isNaN(a-c)?m.next():m.next(a-c),!e&&n.byteLength>0&&(i.push(n),c+=n.byteLength),e||a<=c)do({cmd:s,size:a}=yield h());while(a<c);while(!e)}catch(v){(t=!0)&&typeof m.throw=="function"&&m.throw(v)}finally{t===!1&&typeof m.return=="function"&&m.return(null)}return null}function V5(r){return oh(this,arguments,function*(){let t,i=!1,n=[],s,a,c,h=0;function m(){return a==="peek"?gh(n,c)[0]:([s,n,h]=gh(n,c),s)}({cmd:a,size:c}=yield yield jn(null));const v=B5(r)[Symbol.asyncIterator]();try{do if({done:t,value:s}=Number.isNaN(c-h)?yield jn(v.next()):yield jn(v.next(c-h)),!t&&s.byteLength>0&&(n.push(s),h+=s.byteLength),t||c<=h)do({cmd:a,size:c}=yield yield jn(m()));while(c<h);while(!t)}catch(b){(i=!0)&&typeof v.throw=="function"&&(yield jn(v.throw(b)))}finally{i===!1&&typeof v.return=="function"&&(yield jn(v.return(new Uint8Array(0))))}return yield jn(null)})}function z5(r){return oh(this,arguments,function*(){let t=!1,i=!1,n=[],s,a,c,h=0;function m(){return a==="peek"?gh(n,c)[0]:([s,n,h]=gh(n,c),s)}({cmd:a,size:c}=yield yield jn(null));const v=new H5(r);try{do if({done:t,value:s}=Number.isNaN(c-h)?yield jn(v.read()):yield jn(v.read(c-h)),!t&&s.byteLength>0&&(n.push(Mr(s)),h+=s.byteLength),t||c<=h)do({cmd:a,size:c}=yield yield jn(m()));while(c<h);while(!t)}catch(b){(i=!0)&&(yield jn(v.cancel(b)))}finally{i===!1?yield jn(v.cancel()):r.locked&&v.releaseLock()}return yield jn(null)})}class H5{constructor(e){this.source=e,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(e){return bn(this,void 0,void 0,function*(){const{reader:t,source:i}=this;t&&(yield t.cancel(e).catch(()=>{})),i&&i.locked&&this.releaseLock()})}read(e){return bn(this,void 0,void 0,function*(){if(e===0)return{done:this.reader==null,value:new Uint8Array(0)};const t=yield this.reader.read();return!t.done&&(t.value=Mr(t)),t})}}const MA=(r,e)=>{const t=n=>i([e,n]);let i;return[e,t,new Promise(n=>(i=n)&&r.once(e,t))]};function j5(r){return oh(this,arguments,function*(){const t=[];let i="error",n=!1,s=null,a,c,h=0,m=[],v;function b(){return a==="peek"?gh(m,c)[0]:([v,m,h]=gh(m,c),v)}if({cmd:a,size:c}=yield yield jn(null),r.isTTY)return yield yield jn(new Uint8Array(0)),yield jn(null);try{t[0]=MA(r,"end"),t[1]=MA(r,"error");do{if(t[2]=MA(r,"readable"),[i,s]=yield jn(Promise.race(t.map(C=>C[2]))),i==="error")break;if((n=i==="end")||(Number.isFinite(c-h)?(v=Mr(r.read(c-h)),v.byteLength<c-h&&(v=Mr(r.read()))):v=Mr(r.read()),v.byteLength>0&&(m.push(v),h+=v.byteLength)),n||c<=h)do({cmd:a,size:c}=yield yield jn(b()));while(c<h)}while(!n)}finally{yield jn(x(t,i==="error"?s:null))}return yield jn(null);function x(C,B){return v=m=null,new Promise((P,N)=>{for(const[ae,X]of C)r.off(ae,X);try{const ae=r.destroy;ae&&ae.call(r,B),B=void 0}catch(ae){B=ae||B}finally{B!=null?N(B):P()}})}})}var ju;(function(r){r[r.V1=0]="V1",r[r.V2=1]="V2",r[r.V3=2]="V3",r[r.V4=3]="V4",r[r.V5=4]="V5"})(ju||(ju={}));var Gu;(function(r){r[r.Sparse=0]="Sparse",r[r.Dense=1]="Dense"})(Gu||(Gu={}));var tu;(function(r){r[r.HALF=0]="HALF",r[r.SINGLE=1]="SINGLE",r[r.DOUBLE=2]="DOUBLE"})(tu||(tu={}));var wf;(function(r){r[r.DAY=0]="DAY",r[r.MILLISECOND=1]="MILLISECOND"})(wf||(wf={}));var Dr;(function(r){r[r.SECOND=0]="SECOND",r[r.MILLISECOND=1]="MILLISECOND",r[r.MICROSECOND=2]="MICROSECOND",r[r.NANOSECOND=3]="NANOSECOND"})(Dr||(Dr={}));var Ep;(function(r){r[r.YEAR_MONTH=0]="YEAR_MONTH",r[r.DAY_TIME=1]="DAY_TIME",r[r.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Ep||(Ep={}));var Nr;(function(r){r[r.NONE=0]="NONE",r[r.Schema=1]="Schema",r[r.DictionaryBatch=2]="DictionaryBatch",r[r.RecordBatch=3]="RecordBatch",r[r.Tensor=4]="Tensor",r[r.SparseTensor=5]="SparseTensor"})(Nr||(Nr={}));var ht;(function(r){r[r.NONE=0]="NONE",r[r.Null=1]="Null",r[r.Int=2]="Int",r[r.Float=3]="Float",r[r.Binary=4]="Binary",r[r.Utf8=5]="Utf8",r[r.Bool=6]="Bool",r[r.Decimal=7]="Decimal",r[r.Date=8]="Date",r[r.Time=9]="Time",r[r.Timestamp=10]="Timestamp",r[r.Interval=11]="Interval",r[r.List=12]="List",r[r.Struct=13]="Struct",r[r.Union=14]="Union",r[r.FixedSizeBinary=15]="FixedSizeBinary",r[r.FixedSizeList=16]="FixedSizeList",r[r.Map=17]="Map",r[r.Dictionary=-1]="Dictionary",r[r.Int8=-2]="Int8",r[r.Int16=-3]="Int16",r[r.Int32=-4]="Int32",r[r.Int64=-5]="Int64",r[r.Uint8=-6]="Uint8",r[r.Uint16=-7]="Uint16",r[r.Uint32=-8]="Uint32",r[r.Uint64=-9]="Uint64",r[r.Float16=-10]="Float16",r[r.Float32=-11]="Float32",r[r.Float64=-12]="Float64",r[r.DateDay=-13]="DateDay",r[r.DateMillisecond=-14]="DateMillisecond",r[r.TimestampSecond=-15]="TimestampSecond",r[r.TimestampMillisecond=-16]="TimestampMillisecond",r[r.TimestampMicrosecond=-17]="TimestampMicrosecond",r[r.TimestampNanosecond=-18]="TimestampNanosecond",r[r.TimeSecond=-19]="TimeSecond",r[r.TimeMillisecond=-20]="TimeMillisecond",r[r.TimeMicrosecond=-21]="TimeMicrosecond",r[r.TimeNanosecond=-22]="TimeNanosecond",r[r.DenseUnion=-23]="DenseUnion",r[r.SparseUnion=-24]="SparseUnion",r[r.IntervalDayTime=-25]="IntervalDayTime",r[r.IntervalYearMonth=-26]="IntervalYearMonth"})(ht||(ht={}));var cf;(function(r){r[r.OFFSET=0]="OFFSET",r[r.DATA=1]="DATA",r[r.VALIDITY=2]="VALIDITY",r[r.TYPE=3]="TYPE"})(cf||(cf={}));const G5=void 0;function y_(r){if(r===null)return"null";if(r===G5)return"undefined";switch(typeof r){case"number":return`${r}`;case"bigint":return`${r}`;case"string":return`"${r}"`}return typeof r[Symbol.toPrimitive]=="function"?r[Symbol.toPrimitive]("string"):ArrayBuffer.isView(r)?r instanceof B_||r instanceof N_?`[${[...r].map(e=>y_(e))}]`:`[${r}]`:ArrayBuffer.isView(r)?`[${r}]`:JSON.stringify(r,(e,t)=>typeof t=="bigint"?`${t}`:t)}const $5=Symbol.for("isArrowBigNum");function Jc(r,...e){return e.length===0?Object.setPrototypeOf(es(this.TypedArray,r),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(r,...e),this.constructor.prototype)}Jc.prototype[$5]=!0;Jc.prototype.toJSON=function(){return`"${Vm(this)}"`};Jc.prototype.valueOf=function(){return QP(this)};Jc.prototype.toString=function(){return Vm(this)};Jc.prototype[Symbol.toPrimitive]=function(r="default"){switch(r){case"number":return QP(this);case"string":return Vm(this);case"default":return qw(this)}return Vm(this)};function u0(...r){return Jc.apply(this,r)}function c0(...r){return Jc.apply(this,r)}function __(...r){return Jc.apply(this,r)}Object.setPrototypeOf(u0.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(c0.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(__.prototype,Object.create(Uint32Array.prototype));Object.assign(u0.prototype,Jc.prototype,{constructor:u0,signed:!0,TypedArray:Int32Array,BigIntArray:B_});Object.assign(c0.prototype,Jc.prototype,{constructor:c0,signed:!1,TypedArray:Uint32Array,BigIntArray:N_});Object.assign(__.prototype,Jc.prototype,{constructor:__,signed:!0,TypedArray:Uint32Array,BigIntArray:N_});function QP(r){const{buffer:e,byteOffset:t,length:i,signed:n}=r,s=new N_(e,t,i),a=n&&s[s.length-1]&BigInt(1)<<BigInt(63);let c=BigInt(a?1:0),h=BigInt(0);if(a){for(const m of s)c+=~m*(BigInt(1)<<BigInt(32)*h++);c*=BigInt(-1)}else for(const m of s)c+=m*(BigInt(1)<<BigInt(32)*h++);return c}let Vm,qw;D5?(qw=r=>r.byteLength===8?new r.BigIntArray(r.buffer,r.byteOffset,1)[0]:DA(r),Vm=r=>r.byteLength===8?`${new r.BigIntArray(r.buffer,r.byteOffset,1)[0]}`:DA(r)):(Vm=DA,qw=Vm);function DA(r){let e="";const t=new Uint32Array(2);let i=new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2);const n=new Uint32Array((i=new Uint16Array(i).reverse()).buffer);let s=-1;const a=i.length-1;do{for(t[0]=i[s=0];s<a;)i[s++]=t[1]=t[0]/10,t[0]=(t[0]-t[1]*10<<16)+i[s];i[s]=t[1]=t[0]/10,t[0]=t[0]-t[1]*10,e=`${t[0]}${e}`}while(n[0]||n[1]||n[2]||n[3]);return e??"0"}class d2{static new(e,t){switch(t){case!0:return new u0(e);case!1:return new c0(e)}switch(e.constructor){case Int8Array:case Int16Array:case Int32Array:case B_:return new u0(e)}return e.byteLength===16?new __(e):new c0(e)}static signed(e){return new u0(e)}static unsigned(e){return new c0(e)}static decimal(e){return new __(e)}constructor(e,t){return d2.new(e,t)}}var KP,ZP,JP,eL,tL,iL,nL,rL,sL,aL,oL,lL,uL,cL,dL,hL,fL,pL,mL;class En{static isNull(e){return(e==null?void 0:e.typeId)===ht.Null}static isInt(e){return(e==null?void 0:e.typeId)===ht.Int}static isFloat(e){return(e==null?void 0:e.typeId)===ht.Float}static isBinary(e){return(e==null?void 0:e.typeId)===ht.Binary}static isUtf8(e){return(e==null?void 0:e.typeId)===ht.Utf8}static isBool(e){return(e==null?void 0:e.typeId)===ht.Bool}static isDecimal(e){return(e==null?void 0:e.typeId)===ht.Decimal}static isDate(e){return(e==null?void 0:e.typeId)===ht.Date}static isTime(e){return(e==null?void 0:e.typeId)===ht.Time}static isTimestamp(e){return(e==null?void 0:e.typeId)===ht.Timestamp}static isInterval(e){return(e==null?void 0:e.typeId)===ht.Interval}static isList(e){return(e==null?void 0:e.typeId)===ht.List}static isStruct(e){return(e==null?void 0:e.typeId)===ht.Struct}static isUnion(e){return(e==null?void 0:e.typeId)===ht.Union}static isFixedSizeBinary(e){return(e==null?void 0:e.typeId)===ht.FixedSizeBinary}static isFixedSizeList(e){return(e==null?void 0:e.typeId)===ht.FixedSizeList}static isMap(e){return(e==null?void 0:e.typeId)===ht.Map}static isDictionary(e){return(e==null?void 0:e.typeId)===ht.Dictionary}static isDenseUnion(e){return En.isUnion(e)&&e.mode===Gu.Dense}static isSparseUnion(e){return En.isUnion(e)&&e.mode===Gu.Sparse}get typeId(){return ht.NONE}}KP=Symbol.toStringTag;En[KP]=(r=>(r.children=null,r.ArrayType=Array,r[Symbol.toStringTag]="DataType"))(En.prototype);let Cp=class extends En{toString(){return"Null"}get typeId(){return ht.Null}};ZP=Symbol.toStringTag;Cp[ZP]=(r=>r[Symbol.toStringTag]="Null")(Cp.prototype);class Mp extends En{constructor(e,t){super(),this.isSigned=e,this.bitWidth=t}get typeId(){return ht.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?B_:N_}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}JP=Symbol.toStringTag;Mp[JP]=(r=>(r.isSigned=null,r.bitWidth=null,r[Symbol.toStringTag]="Int"))(Mp.prototype);class b_ extends Mp{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(b_.prototype,"ArrayType",{value:Int32Array});class T_ extends En{constructor(e){super(),this.precision=e}get typeId(){return ht.Float}get ArrayType(){switch(this.precision){case tu.HALF:return Uint16Array;case tu.SINGLE:return Float32Array;case tu.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}eL=Symbol.toStringTag;T_[eL]=(r=>(r.precision=null,r[Symbol.toStringTag]="Float"))(T_.prototype);let DT=class extends En{constructor(){super()}get typeId(){return ht.Binary}toString(){return"Binary"}};tL=Symbol.toStringTag;DT[tL]=(r=>(r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Binary"))(DT.prototype);let IT=class extends En{constructor(){super()}get typeId(){return ht.Utf8}toString(){return"Utf8"}};iL=Symbol.toStringTag;IT[iL]=(r=>(r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Utf8"))(IT.prototype);let PT=class extends En{constructor(){super()}get typeId(){return ht.Bool}toString(){return"Bool"}};nL=Symbol.toStringTag;PT[nL]=(r=>(r.ArrayType=Uint8Array,r[Symbol.toStringTag]="Bool"))(PT.prototype);let LT=class extends En{constructor(e,t,i=128){super(),this.scale=e,this.precision=t,this.bitWidth=i}get typeId(){return ht.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};rL=Symbol.toStringTag;LT[rL]=(r=>(r.scale=null,r.precision=null,r.ArrayType=Uint32Array,r[Symbol.toStringTag]="Decimal"))(LT.prototype);class RT extends En{constructor(e){super(),this.unit=e}get typeId(){return ht.Date}toString(){return`Date${(this.unit+1)*32}<${wf[this.unit]}>`}}sL=Symbol.toStringTag;RT[sL]=(r=>(r.unit=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Date"))(RT.prototype);class x_ extends En{constructor(e,t){super(),this.unit=e,this.bitWidth=t}get typeId(){return ht.Time}toString(){return`Time${this.bitWidth}<${Dr[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return B_}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}aL=Symbol.toStringTag;x_[aL]=(r=>(r.unit=null,r.bitWidth=null,r[Symbol.toStringTag]="Time"))(x_.prototype);class kT extends En{constructor(e,t){super(),this.unit=e,this.timezone=t}get typeId(){return ht.Timestamp}toString(){return`Timestamp<${Dr[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}oL=Symbol.toStringTag;kT[oL]=(r=>(r.unit=null,r.timezone=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Timestamp"))(kT.prototype);class OT extends En{constructor(e){super(),this.unit=e}get typeId(){return ht.Interval}toString(){return`Interval<${Ep[this.unit]}>`}}lL=Symbol.toStringTag;OT[lL]=(r=>(r.unit=null,r.ArrayType=Int32Array,r[Symbol.toStringTag]="Interval"))(OT.prototype);let FT=class extends En{constructor(e){super(),this.children=[e]}get typeId(){return ht.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};uL=Symbol.toStringTag;FT[uL]=(r=>(r.children=null,r[Symbol.toStringTag]="List"))(FT.prototype);class hl extends En{constructor(e){super(),this.children=e}get typeId(){return ht.Struct}toString(){return`Struct<{${this.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}}cL=Symbol.toStringTag;hl[cL]=(r=>(r.children=null,r[Symbol.toStringTag]="Struct"))(hl.prototype);class BT extends En{constructor(e,t,i){super(),this.mode=e,this.children=i,this.typeIds=t=Int32Array.from(t),this.typeIdToChildIndex=t.reduce((n,s,a)=>(n[s]=a)&&n||n,Object.create(null))}get typeId(){return ht.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(e=>`${e.type}`).join(" | ")}>`}}dL=Symbol.toStringTag;BT[dL]=(r=>(r.mode=null,r.typeIds=null,r.children=null,r.typeIdToChildIndex=null,r.ArrayType=Int8Array,r[Symbol.toStringTag]="Union"))(BT.prototype);let NT=class extends En{constructor(e){super(),this.byteWidth=e}get typeId(){return ht.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};hL=Symbol.toStringTag;NT[hL]=(r=>(r.byteWidth=null,r.ArrayType=Uint8Array,r[Symbol.toStringTag]="FixedSizeBinary"))(NT.prototype);let UT=class extends En{constructor(e,t){super(),this.listSize=e,this.children=[t]}get typeId(){return ht.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};fL=Symbol.toStringTag;UT[fL]=(r=>(r.children=null,r.listSize=null,r[Symbol.toStringTag]="FixedSizeList"))(UT.prototype);class VT extends En{constructor(e,t=!1){super(),this.children=[e],this.keysSorted=t}get typeId(){return ht.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}}pL=Symbol.toStringTag;VT[pL]=(r=>(r.children=null,r.keysSorted=null,r[Symbol.toStringTag]="Map_"))(VT.prototype);const W5=(r=>()=>++r)(-1);class E0 extends En{constructor(e,t,i,n){super(),this.indices=t,this.dictionary=e,this.isOrdered=n||!1,this.id=i==null?W5():typeof i=="number"?i:i.low}get typeId(){return ht.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}mL=Symbol.toStringTag;E0[mL]=(r=>(r.id=null,r.indices=null,r.isOrdered=null,r.dictionary=null,r[Symbol.toStringTag]="Dictionary"))(E0.prototype);function df(r){const e=r;switch(r.typeId){case ht.Decimal:return r.bitWidth/32;case ht.Timestamp:return 2;case ht.Date:return 1+e.unit;case ht.Interval:return 1+e.unit;case ht.FixedSizeList:return e.listSize;case ht.FixedSizeBinary:return e.byteWidth;default:return 1}}class vr{visitMany(e,...t){return e.map((i,n)=>this.visit(i,...t.map(s=>s[n])))}visit(...e){return this.getVisitFn(e[0],!1).apply(this,e)}getVisitFn(e,t=!0){return q5(this,e,t)}getVisitFnByTypeId(e,t=!0){return Kg(this,e,t)}visitNull(e,...t){return null}visitBool(e,...t){return null}visitInt(e,...t){return null}visitFloat(e,...t){return null}visitUtf8(e,...t){return null}visitBinary(e,...t){return null}visitFixedSizeBinary(e,...t){return null}visitDate(e,...t){return null}visitTimestamp(e,...t){return null}visitTime(e,...t){return null}visitDecimal(e,...t){return null}visitList(e,...t){return null}visitStruct(e,...t){return null}visitUnion(e,...t){return null}visitDictionary(e,...t){return null}visitInterval(e,...t){return null}visitFixedSizeList(e,...t){return null}visitMap(e,...t){return null}}function q5(r,e,t=!0){return typeof e=="number"?Kg(r,e,t):typeof e=="string"&&e in ht?Kg(r,ht[e],t):e&&e instanceof En?Kg(r,pD(e),t):e!=null&&e.type&&e.type instanceof En?Kg(r,pD(e.type),t):Kg(r,ht.NONE,t)}function Kg(r,e,t=!0){let i=null;switch(e){case ht.Null:i=r.visitNull;break;case ht.Bool:i=r.visitBool;break;case ht.Int:i=r.visitInt;break;case ht.Int8:i=r.visitInt8||r.visitInt;break;case ht.Int16:i=r.visitInt16||r.visitInt;break;case ht.Int32:i=r.visitInt32||r.visitInt;break;case ht.Int64:i=r.visitInt64||r.visitInt;break;case ht.Uint8:i=r.visitUint8||r.visitInt;break;case ht.Uint16:i=r.visitUint16||r.visitInt;break;case ht.Uint32:i=r.visitUint32||r.visitInt;break;case ht.Uint64:i=r.visitUint64||r.visitInt;break;case ht.Float:i=r.visitFloat;break;case ht.Float16:i=r.visitFloat16||r.visitFloat;break;case ht.Float32:i=r.visitFloat32||r.visitFloat;break;case ht.Float64:i=r.visitFloat64||r.visitFloat;break;case ht.Utf8:i=r.visitUtf8;break;case ht.Binary:i=r.visitBinary;break;case ht.FixedSizeBinary:i=r.visitFixedSizeBinary;break;case ht.Date:i=r.visitDate;break;case ht.DateDay:i=r.visitDateDay||r.visitDate;break;case ht.DateMillisecond:i=r.visitDateMillisecond||r.visitDate;break;case ht.Timestamp:i=r.visitTimestamp;break;case ht.TimestampSecond:i=r.visitTimestampSecond||r.visitTimestamp;break;case ht.TimestampMillisecond:i=r.visitTimestampMillisecond||r.visitTimestamp;break;case ht.TimestampMicrosecond:i=r.visitTimestampMicrosecond||r.visitTimestamp;break;case ht.TimestampNanosecond:i=r.visitTimestampNanosecond||r.visitTimestamp;break;case ht.Time:i=r.visitTime;break;case ht.TimeSecond:i=r.visitTimeSecond||r.visitTime;break;case ht.TimeMillisecond:i=r.visitTimeMillisecond||r.visitTime;break;case ht.TimeMicrosecond:i=r.visitTimeMicrosecond||r.visitTime;break;case ht.TimeNanosecond:i=r.visitTimeNanosecond||r.visitTime;break;case ht.Decimal:i=r.visitDecimal;break;case ht.List:i=r.visitList;break;case ht.Struct:i=r.visitStruct;break;case ht.Union:i=r.visitUnion;break;case ht.DenseUnion:i=r.visitDenseUnion||r.visitUnion;break;case ht.SparseUnion:i=r.visitSparseUnion||r.visitUnion;break;case ht.Dictionary:i=r.visitDictionary;break;case ht.Interval:i=r.visitInterval;break;case ht.IntervalDayTime:i=r.visitIntervalDayTime||r.visitInterval;break;case ht.IntervalYearMonth:i=r.visitIntervalYearMonth||r.visitInterval;break;case ht.FixedSizeList:i=r.visitFixedSizeList;break;case ht.Map:i=r.visitMap;break}if(typeof i=="function")return i;if(!t)return()=>null;throw new Error(`Unrecognized type '${ht[e]}'`)}function pD(r){switch(r.typeId){case ht.Null:return ht.Null;case ht.Int:{const{bitWidth:e,isSigned:t}=r;switch(e){case 8:return t?ht.Int8:ht.Uint8;case 16:return t?ht.Int16:ht.Uint16;case 32:return t?ht.Int32:ht.Uint32;case 64:return t?ht.Int64:ht.Uint64}return ht.Int}case ht.Float:switch(r.precision){case tu.HALF:return ht.Float16;case tu.SINGLE:return ht.Float32;case tu.DOUBLE:return ht.Float64}return ht.Float;case ht.Binary:return ht.Binary;case ht.Utf8:return ht.Utf8;case ht.Bool:return ht.Bool;case ht.Decimal:return ht.Decimal;case ht.Time:switch(r.unit){case Dr.SECOND:return ht.TimeSecond;case Dr.MILLISECOND:return ht.TimeMillisecond;case Dr.MICROSECOND:return ht.TimeMicrosecond;case Dr.NANOSECOND:return ht.TimeNanosecond}return ht.Time;case ht.Timestamp:switch(r.unit){case Dr.SECOND:return ht.TimestampSecond;case Dr.MILLISECOND:return ht.TimestampMillisecond;case Dr.MICROSECOND:return ht.TimestampMicrosecond;case Dr.NANOSECOND:return ht.TimestampNanosecond}return ht.Timestamp;case ht.Date:switch(r.unit){case wf.DAY:return ht.DateDay;case wf.MILLISECOND:return ht.DateMillisecond}return ht.Date;case ht.Interval:switch(r.unit){case Ep.DAY_TIME:return ht.IntervalDayTime;case Ep.YEAR_MONTH:return ht.IntervalYearMonth}return ht.Interval;case ht.Map:return ht.Map;case ht.List:return ht.List;case ht.Struct:return ht.Struct;case ht.Union:switch(r.mode){case Gu.Dense:return ht.DenseUnion;case Gu.Sparse:return ht.SparseUnion}return ht.Union;case ht.FixedSizeBinary:return ht.FixedSizeBinary;case ht.FixedSizeList:return ht.FixedSizeList;case ht.Dictionary:return ht.Dictionary}throw new Error(`Unrecognized type '${ht[r.typeId]}'`)}vr.prototype.visitInt8=null;vr.prototype.visitInt16=null;vr.prototype.visitInt32=null;vr.prototype.visitInt64=null;vr.prototype.visitUint8=null;vr.prototype.visitUint16=null;vr.prototype.visitUint32=null;vr.prototype.visitUint64=null;vr.prototype.visitFloat16=null;vr.prototype.visitFloat32=null;vr.prototype.visitFloat64=null;vr.prototype.visitDateDay=null;vr.prototype.visitDateMillisecond=null;vr.prototype.visitTimestampSecond=null;vr.prototype.visitTimestampMillisecond=null;vr.prototype.visitTimestampMicrosecond=null;vr.prototype.visitTimestampNanosecond=null;vr.prototype.visitTimeSecond=null;vr.prototype.visitTimeMillisecond=null;vr.prototype.visitTimeMicrosecond=null;vr.prototype.visitTimeNanosecond=null;vr.prototype.visitDenseUnion=null;vr.prototype.visitSparseUnion=null;vr.prototype.visitIntervalDayTime=null;vr.prototype.visitIntervalYearMonth=null;const gL=new Float64Array(1),Vg=new Uint32Array(gL.buffer);function vL(r){const e=(r&31744)>>10,t=(r&1023)/1024,i=Math.pow(-1,(r&32768)>>15);switch(e){case 31:return i*(t?Number.NaN:1/0);case 0:return i*(t?6103515625e-14*t:0)}return i*Math.pow(2,e-15)*(1+t)}function X5(r){if(r!==r)return 32256;gL[0]=r;const e=(Vg[1]&2147483648)>>16&65535;let t=Vg[1]&2146435072,i=0;return t>=1089470464?Vg[0]>0?t=31744:(t=(t&2080374784)>>16,i=(Vg[1]&1048575)>>10):t<=1056964608?(i=1048576+(Vg[1]&1048575),i=1048576+(i<<(t>>20)-998)>>21,t=0):(t=t-1056964608>>10,i=(Vg[1]&1048575)+512>>10),e|t|i&65535}class Rn extends vr{}function Nn(r){return(e,t,i)=>{if(e.setValid(t,i!=null))return r(e,t,i)}}const Y5=(r,e,t)=>{r[e]=Math.trunc(t/864e5)},h2=(r,e,t)=>{r[e]=Math.trunc(t%4294967296),r[e+1]=Math.trunc(t/4294967296)},Q5=(r,e,t)=>{r[e]=Math.trunc(t*1e3%4294967296),r[e+1]=Math.trunc(t*1e3/4294967296)},K5=(r,e,t)=>{r[e]=Math.trunc(t*1e6%4294967296),r[e+1]=Math.trunc(t*1e6/4294967296)},yL=(r,e,t,i)=>{if(t+1<e.length){const{[t]:n,[t+1]:s}=e;r.set(i.subarray(0,s-n),n)}},Z5=({offset:r,values:e},t,i)=>{const n=r+t;i?e[n>>3]|=1<<n%8:e[n>>3]&=~(1<<n%8)},Df=({values:r},e,t)=>{r[e]=t},f2=({values:r},e,t)=>{r[e]=t},_L=({values:r},e,t)=>{r[e]=X5(t)},J5=(r,e,t)=>{switch(r.type.precision){case tu.HALF:return _L(r,e,t);case tu.SINGLE:case tu.DOUBLE:return f2(r,e,t)}},bL=({values:r},e,t)=>{Y5(r,e,t.valueOf())},TL=({values:r},e,t)=>{h2(r,e*2,t.valueOf())},e8=({stride:r,values:e},t,i)=>{e.set(i.subarray(0,r),r*t)},t8=({values:r,valueOffsets:e},t,i)=>yL(r,e,t,i),i8=({values:r,valueOffsets:e},t,i)=>{yL(r,e,t,o2(i))},n8=(r,e,t)=>{r.type.unit===wf.DAY?bL(r,e,t):TL(r,e,t)},xL=({values:r},e,t)=>h2(r,e*2,t/1e3),SL=({values:r},e,t)=>h2(r,e*2,t),AL=({values:r},e,t)=>Q5(r,e*2,t),wL=({values:r},e,t)=>K5(r,e*2,t),r8=(r,e,t)=>{switch(r.type.unit){case Dr.SECOND:return xL(r,e,t);case Dr.MILLISECOND:return SL(r,e,t);case Dr.MICROSECOND:return AL(r,e,t);case Dr.NANOSECOND:return wL(r,e,t)}},EL=({values:r},e,t)=>{r[e]=t},CL=({values:r},e,t)=>{r[e]=t},ML=({values:r},e,t)=>{r[e]=t},DL=({values:r},e,t)=>{r[e]=t},s8=(r,e,t)=>{switch(r.type.unit){case Dr.SECOND:return EL(r,e,t);case Dr.MILLISECOND:return CL(r,e,t);case Dr.MICROSECOND:return ML(r,e,t);case Dr.NANOSECOND:return DL(r,e,t)}},a8=({values:r,stride:e},t,i)=>{r.set(i.subarray(0,e),e*t)},o8=(r,e,t)=>{const i=r.children[0],n=r.valueOffsets,s=yc.getVisitFn(i);if(Array.isArray(t))for(let a=-1,c=n[e],h=n[e+1];c<h;)s(i,c++,t[++a]);else for(let a=-1,c=n[e],h=n[e+1];c<h;)s(i,c++,t.get(++a))},l8=(r,e,t)=>{const i=r.children[0],{valueOffsets:n}=r,s=yc.getVisitFn(i);let{[e]:a,[e+1]:c}=n;const h=t instanceof Map?t.entries():Object.entries(t);for(const m of h)if(s(i,a,m),++a>=c)break},u8=(r,e)=>(t,i,n,s)=>i&&t(i,r,e[s]),c8=(r,e)=>(t,i,n,s)=>i&&t(i,r,e.get(s)),d8=(r,e)=>(t,i,n,s)=>i&&t(i,r,e.get(n.name)),h8=(r,e)=>(t,i,n,s)=>i&&t(i,r,e[n.name]),f8=(r,e,t)=>{const i=r.type.children.map(s=>yc.getVisitFn(s.type)),n=t instanceof Map?d8(e,t):t instanceof Ur?c8(e,t):Array.isArray(t)?u8(e,t):h8(e,t);r.type.children.forEach((s,a)=>n(i[a],r.children[a],s,a))},p8=(r,e,t)=>{r.type.mode===Gu.Dense?IL(r,e,t):PL(r,e,t)},IL=(r,e,t)=>{const i=r.type.typeIdToChildIndex[r.typeIds[e]],n=r.children[i];yc.visit(n,r.valueOffsets[e],t)},PL=(r,e,t)=>{const i=r.type.typeIdToChildIndex[r.typeIds[e]],n=r.children[i];yc.visit(n,e,t)},m8=(r,e,t)=>{var i;(i=r.dictionary)===null||i===void 0||i.set(r.values[e],t)},g8=(r,e,t)=>{r.type.unit===Ep.DAY_TIME?LL(r,e,t):RL(r,e,t)},LL=({values:r},e,t)=>{r.set(t.subarray(0,2),2*e)},RL=({values:r},e,t)=>{r[e]=t[0]*12+t[1]%12},v8=(r,e,t)=>{const{stride:i}=r,n=r.children[0],s=yc.getVisitFn(n);if(Array.isArray(t))for(let a=-1,c=e*i;++a<i;)s(n,c+a,t[a]);else for(let a=-1,c=e*i;++a<i;)s(n,c+a,t.get(a))};Rn.prototype.visitBool=Nn(Z5);Rn.prototype.visitInt=Nn(Df);Rn.prototype.visitInt8=Nn(Df);Rn.prototype.visitInt16=Nn(Df);Rn.prototype.visitInt32=Nn(Df);Rn.prototype.visitInt64=Nn(Df);Rn.prototype.visitUint8=Nn(Df);Rn.prototype.visitUint16=Nn(Df);Rn.prototype.visitUint32=Nn(Df);Rn.prototype.visitUint64=Nn(Df);Rn.prototype.visitFloat=Nn(J5);Rn.prototype.visitFloat16=Nn(_L);Rn.prototype.visitFloat32=Nn(f2);Rn.prototype.visitFloat64=Nn(f2);Rn.prototype.visitUtf8=Nn(i8);Rn.prototype.visitBinary=Nn(t8);Rn.prototype.visitFixedSizeBinary=Nn(e8);Rn.prototype.visitDate=Nn(n8);Rn.prototype.visitDateDay=Nn(bL);Rn.prototype.visitDateMillisecond=Nn(TL);Rn.prototype.visitTimestamp=Nn(r8);Rn.prototype.visitTimestampSecond=Nn(xL);Rn.prototype.visitTimestampMillisecond=Nn(SL);Rn.prototype.visitTimestampMicrosecond=Nn(AL);Rn.prototype.visitTimestampNanosecond=Nn(wL);Rn.prototype.visitTime=Nn(s8);Rn.prototype.visitTimeSecond=Nn(EL);Rn.prototype.visitTimeMillisecond=Nn(CL);Rn.prototype.visitTimeMicrosecond=Nn(ML);Rn.prototype.visitTimeNanosecond=Nn(DL);Rn.prototype.visitDecimal=Nn(a8);Rn.prototype.visitList=Nn(o8);Rn.prototype.visitStruct=Nn(f8);Rn.prototype.visitUnion=Nn(p8);Rn.prototype.visitDenseUnion=Nn(IL);Rn.prototype.visitSparseUnion=Nn(PL);Rn.prototype.visitDictionary=Nn(m8);Rn.prototype.visitInterval=Nn(g8);Rn.prototype.visitIntervalDayTime=Nn(LL);Rn.prototype.visitIntervalYearMonth=Nn(RL);Rn.prototype.visitFixedSizeList=Nn(v8);Rn.prototype.visitMap=Nn(l8);const yc=new Rn,$c=Symbol.for("parent"),d0=Symbol.for("rowIndex");class p2{constructor(e,t){return this[$c]=e,this[d0]=t,new Proxy(this,new _8)}toArray(){return Object.values(this.toJSON())}toJSON(){const e=this[d0],t=this[$c],i=t.type.children,n={};for(let s=-1,a=i.length;++s<a;)n[i[s].name]=nu.visit(t.children[s],e);return n}toString(){return`{${[...this].map(([e,t])=>`${y_(e)}: ${y_(t)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new y8(this[$c],this[d0])}}class y8{constructor(e,t){this.childIndex=0,this.children=e.children,this.rowIndex=t,this.childFields=e.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const e=this.childIndex;return e<this.numChildren?(this.childIndex=e+1,{done:!1,value:[this.childFields[e].name,nu.visit(this.children[e],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(p2.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[$c]:{writable:!0,enumerable:!1,configurable:!1,value:null},[d0]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class _8{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[$c].type.children.map(t=>t.name)}has(e,t){return e[$c].type.children.findIndex(i=>i.name===t)!==-1}getOwnPropertyDescriptor(e,t){if(e[$c].type.children.findIndex(i=>i.name===t)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(e,t){if(Reflect.has(e,t))return e[t];const i=e[$c].type.children.findIndex(n=>n.name===t);if(i!==-1){const n=nu.visit(e[$c].children[i],e[d0]);return Reflect.set(e,t,n),n}}set(e,t,i){const n=e[$c].type.children.findIndex(s=>s.name===t);return n!==-1?(yc.visit(e[$c].children[n],e[d0],i),Reflect.set(e,t,i)):Reflect.has(e,t)||typeof t=="symbol"?Reflect.set(e,t,i):!1}}class Cn extends vr{}function kn(r){return(e,t)=>e.getValid(t)?r(e,t):null}const b8=(r,e)=>864e5*r[e],m2=(r,e)=>4294967296*r[e+1]+(r[e]>>>0),T8=(r,e)=>4294967296*(r[e+1]/1e3)+(r[e]>>>0)/1e3,x8=(r,e)=>4294967296*(r[e+1]/1e6)+(r[e]>>>0)/1e6,kL=r=>new Date(r),S8=(r,e)=>kL(b8(r,e)),A8=(r,e)=>kL(m2(r,e)),w8=(r,e)=>null,OL=(r,e,t)=>{if(t+1>=e.length)return null;const i=e[t],n=e[t+1];return r.subarray(i,n)},E8=({offset:r,values:e},t)=>{const i=r+t;return(e[i>>3]&1<<i%8)!==0},FL=({values:r},e)=>S8(r,e),BL=({values:r},e)=>A8(r,e*2),Fp=({stride:r,values:e},t)=>e[r*t],C8=({stride:r,values:e},t)=>vL(e[r*t]),NL=({values:r},e)=>r[e],M8=({stride:r,values:e},t)=>e.subarray(r*t,r*(t+1)),D8=({values:r,valueOffsets:e},t)=>OL(r,e,t),I8=({values:r,valueOffsets:e},t)=>{const i=OL(r,e,t);return i!==null?Gw(i):null},P8=({values:r},e)=>r[e],L8=({type:r,values:e},t)=>r.precision!==tu.HALF?e[t]:vL(e[t]),R8=(r,e)=>r.type.unit===wf.DAY?FL(r,e):BL(r,e),UL=({values:r},e)=>1e3*m2(r,e*2),VL=({values:r},e)=>m2(r,e*2),zL=({values:r},e)=>T8(r,e*2),HL=({values:r},e)=>x8(r,e*2),k8=(r,e)=>{switch(r.type.unit){case Dr.SECOND:return UL(r,e);case Dr.MILLISECOND:return VL(r,e);case Dr.MICROSECOND:return zL(r,e);case Dr.NANOSECOND:return HL(r,e)}},jL=({values:r},e)=>r[e],GL=({values:r},e)=>r[e],$L=({values:r},e)=>r[e],WL=({values:r},e)=>r[e],O8=(r,e)=>{switch(r.type.unit){case Dr.SECOND:return jL(r,e);case Dr.MILLISECOND:return GL(r,e);case Dr.MICROSECOND:return $L(r,e);case Dr.NANOSECOND:return WL(r,e)}},F8=({values:r,stride:e},t)=>d2.decimal(r.subarray(e*t,e*(t+1))),B8=(r,e)=>{const{valueOffsets:t,stride:i,children:n}=r,{[e*i]:s,[e*i+1]:a}=t,h=n[0].slice(s,a-s);return new Ur([h])},N8=(r,e)=>{const{valueOffsets:t,children:i}=r,{[e]:n,[e+1]:s}=t,a=i[0];return new g2(a.slice(n,s-n))},U8=(r,e)=>new p2(r,e),V8=(r,e)=>r.type.mode===Gu.Dense?qL(r,e):XL(r,e),qL=(r,e)=>{const t=r.type.typeIdToChildIndex[r.typeIds[e]],i=r.children[t];return nu.visit(i,r.valueOffsets[e])},XL=(r,e)=>{const t=r.type.typeIdToChildIndex[r.typeIds[e]],i=r.children[t];return nu.visit(i,e)},z8=(r,e)=>{var t;return(t=r.dictionary)===null||t===void 0?void 0:t.get(r.values[e])},H8=(r,e)=>r.type.unit===Ep.DAY_TIME?YL(r,e):QL(r,e),YL=({values:r},e)=>r.subarray(2*e,2*(e+1)),QL=({values:r},e)=>{const t=r[e],i=new Int32Array(2);return i[0]=Math.trunc(t/12),i[1]=Math.trunc(t%12),i},j8=(r,e)=>{const{stride:t,children:i}=r,s=i[0].slice(e*t,t);return new Ur([s])};Cn.prototype.visitNull=kn(w8);Cn.prototype.visitBool=kn(E8);Cn.prototype.visitInt=kn(P8);Cn.prototype.visitInt8=kn(Fp);Cn.prototype.visitInt16=kn(Fp);Cn.prototype.visitInt32=kn(Fp);Cn.prototype.visitInt64=kn(NL);Cn.prototype.visitUint8=kn(Fp);Cn.prototype.visitUint16=kn(Fp);Cn.prototype.visitUint32=kn(Fp);Cn.prototype.visitUint64=kn(NL);Cn.prototype.visitFloat=kn(L8);Cn.prototype.visitFloat16=kn(C8);Cn.prototype.visitFloat32=kn(Fp);Cn.prototype.visitFloat64=kn(Fp);Cn.prototype.visitUtf8=kn(I8);Cn.prototype.visitBinary=kn(D8);Cn.prototype.visitFixedSizeBinary=kn(M8);Cn.prototype.visitDate=kn(R8);Cn.prototype.visitDateDay=kn(FL);Cn.prototype.visitDateMillisecond=kn(BL);Cn.prototype.visitTimestamp=kn(k8);Cn.prototype.visitTimestampSecond=kn(UL);Cn.prototype.visitTimestampMillisecond=kn(VL);Cn.prototype.visitTimestampMicrosecond=kn(zL);Cn.prototype.visitTimestampNanosecond=kn(HL);Cn.prototype.visitTime=kn(O8);Cn.prototype.visitTimeSecond=kn(jL);Cn.prototype.visitTimeMillisecond=kn(GL);Cn.prototype.visitTimeMicrosecond=kn($L);Cn.prototype.visitTimeNanosecond=kn(WL);Cn.prototype.visitDecimal=kn(F8);Cn.prototype.visitList=kn(B8);Cn.prototype.visitStruct=kn(U8);Cn.prototype.visitUnion=kn(V8);Cn.prototype.visitDenseUnion=kn(qL);Cn.prototype.visitSparseUnion=kn(XL);Cn.prototype.visitDictionary=kn(z8);Cn.prototype.visitInterval=kn(H8);Cn.prototype.visitIntervalDayTime=kn(YL);Cn.prototype.visitIntervalYearMonth=kn(QL);Cn.prototype.visitFixedSizeList=kn(j8);Cn.prototype.visitMap=kn(N8);const nu=new Cn,th=Symbol.for("keys"),h0=Symbol.for("vals");class g2{constructor(e){return this[th]=new Ur([e.children[0]]).memoize(),this[h0]=e.children[1],new Proxy(this,new $8)}[Symbol.iterator](){return new G8(this[th],this[h0])}get size(){return this[th].length}toArray(){return Object.values(this.toJSON())}toJSON(){const e=this[th],t=this[h0],i={};for(let n=-1,s=e.length;++n<s;)i[e.get(n)]=nu.visit(t,n);return i}toString(){return`{${[...this].map(([e,t])=>`${y_(e)}: ${y_(t)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class G8{constructor(e,t){this.keys=e,this.vals=t,this.keyIndex=0,this.numKeys=e.length}[Symbol.iterator](){return this}next(){const e=this.keyIndex;return e===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(e),nu.visit(this.vals,e)]})}}class $8{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[th].toArray().map(String)}has(e,t){return e[th].includes(t)}getOwnPropertyDescriptor(e,t){if(e[th].indexOf(t)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(e,t){if(Reflect.has(e,t))return e[t];const i=e[th].indexOf(t);if(i!==-1){const n=nu.visit(Reflect.get(e,h0),i);return Reflect.set(e,t,n),n}}set(e,t,i){const n=e[th].indexOf(t);return n!==-1?(yc.visit(Reflect.get(e,h0),n,i),Reflect.set(e,t,i)):Reflect.has(e,t)?Reflect.set(e,t,i):!1}}Object.defineProperties(g2.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[th]:{writable:!0,enumerable:!1,configurable:!1,value:null},[h0]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let mD;function KL(r,e,t,i){const{length:n=0}=r;let s=typeof e!="number"?0:e,a=typeof t!="number"?n:t;return s<0&&(s=(s%n+n)%n),a<0&&(a=(a%n+n)%n),a<s&&(mD=s,s=a,a=mD),a>n&&(a=n),i?i(r,s,a):[s,a]}const gD=r=>r!==r;function Z0(r){if(typeof r!=="object"||r===null)return gD(r)?gD:t=>t===r;if(r instanceof Date){const t=r.valueOf();return i=>i instanceof Date?i.valueOf()===t:!1}return ArrayBuffer.isView(r)?t=>t?N5(r,t):!1:r instanceof Map?q8(r):Array.isArray(r)?W8(r):r instanceof Ur?X8(r):Y8(r,!0)}function W8(r){const e=[];for(let t=-1,i=r.length;++t<i;)e[t]=Z0(r[t]);return Gx(e)}function q8(r){let e=-1;const t=[];for(const i of r.values())t[++e]=Z0(i);return Gx(t)}function X8(r){const e=[];for(let t=-1,i=r.length;++t<i;)e[t]=Z0(r.get(t));return Gx(e)}function Y8(r,e=!1){const t=Object.keys(r);if(!e&&t.length===0)return()=>!1;const i=[];for(let n=-1,s=t.length;++n<s;)i[n]=Z0(r[t[n]]);return Gx(i,t)}function Gx(r,e){return t=>{if(!t||typeof t!="object")return!1;switch(t.constructor){case Array:return Q8(r,t);case Map:return vD(r,t,t.keys());case g2:case p2:case Object:case void 0:return vD(r,t,e||Object.keys(t))}return t instanceof Ur?K8(r,t):!1}}function Q8(r,e){const t=r.length;if(e.length!==t)return!1;for(let i=-1;++i<t;)if(!r[i](e[i]))return!1;return!0}function K8(r,e){const t=r.length;if(e.length!==t)return!1;for(let i=-1;++i<t;)if(!r[i](e.get(i)))return!1;return!0}function vD(r,e,t){const i=t[Symbol.iterator](),n=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),s=e instanceof Map?e.values():Object.values(e)[Symbol.iterator]();let a=0;const c=r.length;let h=s.next(),m=i.next(),v=n.next();for(;a<c&&!m.done&&!v.done&&!h.done&&!(m.value!==v.value||!r[a](h.value));++a,m=i.next(),v=n.next(),h=s.next());return a===c&&m.done&&v.done&&h.done?!0:(i.return&&i.return(),n.return&&n.return(),s.return&&s.return(),!1)}function ZL(r,e,t,i){return(t&1<<i)!==0}function Z8(r,e,t,i){return(t&1<<i)>>i}function v2(r,e,t){const i=t.byteLength+7&-8;if(r>0||t.byteLength<i){const n=new Uint8Array(i);return n.set(r%8===0?t.subarray(r>>3):zT(new y2(t,r,e,null,ZL)).subarray(0,i)),n}return t}function zT(r){const e=[];let t=0,i=0,n=0;for(const a of r)a&&(n|=1<<i),++i===8&&(e[t++]=n,n=i=0);(t===0||i>0)&&(e[t++]=n);const s=new Uint8Array(e.length+7&-8);return s.set(e),s}class y2{constructor(e,t,i,n,s){this.bytes=e,this.length=i,this.context=n,this.get=s,this.bit=t%8,this.byteIndex=t>>3,this.byte=e[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function Xw(r,e,t){if(t-e<=0)return 0;if(t-e<8){let s=0;for(const a of new y2(r,e,t-e,r,Z8))s+=a;return s}const i=t>>3<<3,n=e+(e%8===0?0:8-e%8);return Xw(r,e,n)+Xw(r,i,t)+J8(r,n>>3,i-n>>3)}function J8(r,e,t){let i=0,n=Math.trunc(e);const s=new DataView(r.buffer,r.byteOffset,r.byteLength),a=t===void 0?r.byteLength:n+t;for(;a-n>=4;)i+=IA(s.getUint32(n)),n+=4;for(;a-n>=2;)i+=IA(s.getUint16(n)),n+=2;for(;a-n>=1;)i+=IA(s.getUint8(n)),n+=1;return i}function IA(r){let e=Math.trunc(r);return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),(e+(e>>>4)&252645135)*16843009>>>24}const e6=-1;class ls{constructor(e,t,i,n,s,a=[],c){this.type=e,this.children=a,this.dictionary=c,this.offset=Math.floor(Math.max(t||0,0)),this.length=Math.floor(Math.max(i||0,0)),this._nullCount=Math.floor(Math.max(n||0,-1));let h;s instanceof ls?(this.stride=s.stride,this.values=s.values,this.typeIds=s.typeIds,this.nullBitmap=s.nullBitmap,this.valueOffsets=s.valueOffsets):(this.stride=df(e),s&&((h=s[0])&&(this.valueOffsets=h),(h=s[1])&&(this.values=h),(h=s[2])&&(this.nullBitmap=h),(h=s[3])&&(this.typeIds=h))),this.nullable=this._nullCount!==0&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let e=0;const{valueOffsets:t,values:i,nullBitmap:n,typeIds:s}=this;return t&&(e+=t.byteLength),i&&(e+=i.byteLength),n&&(e+=n.byteLength),s&&(e+=s.byteLength),this.children.reduce((a,c)=>a+c.byteLength,e)}get nullCount(){let e=this._nullCount,t;return e<=e6&&(t=this.nullBitmap)&&(this._nullCount=e=this.length-Xw(t,this.offset,this.offset+this.length)),e}getValid(e){if(this.nullable&&this.nullCount>0){const t=this.offset+e;return(this.nullBitmap[t>>3]&1<<t%8)!==0}return!0}setValid(e,t){if(!this.nullable)return t;if(!this.nullBitmap||this.nullBitmap.byteLength<=e>>3){const{nullBitmap:h}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:h,_nullCount:0})}const{nullBitmap:i,offset:n}=this,s=n+e>>3,a=(n+e)%8,c=i[s]>>a&1;return t?c===0&&(i[s]|=1<<a,this._nullCount=this.nullCount+1):c===1&&(i[s]&=~(1<<a),this._nullCount=this.nullCount-1),t}clone(e=this.type,t=this.offset,i=this.length,n=this._nullCount,s=this,a=this.children){return new ls(e,t,i,n,s,a,this.dictionary)}slice(e,t){const{stride:i,typeId:n,children:s}=this,a=+(this._nullCount===0)-1,c=n===16?i:1,h=this._sliceBuffers(e,t,i,n);return this.clone(this.type,this.offset+e,t,a,h,s.length===0||this.valueOffsets?s:this._sliceChildren(s,c*e,c*t))}_changeLengthAndBackfillNullBitmap(e){if(this.typeId===ht.Null)return this.clone(this.type,0,e,0);const{length:t,nullCount:i}=this,n=new Uint8Array((e+63&-64)>>3).fill(255,0,t>>3);n[t>>3]=(1<<t-(t&-8))-1,i>0&&n.set(v2(this.offset,t,this.nullBitmap),0);const s=this.buffers;return s[cf.VALIDITY]=n,this.clone(this.type,0,e,i+(e-t),s)}_sliceBuffers(e,t,i,n){let s;const{buffers:a}=this;return(s=a[cf.TYPE])&&(a[cf.TYPE]=s.subarray(e,e+t)),(s=a[cf.OFFSET])&&(a[cf.OFFSET]=s.subarray(e,e+t+1))||(s=a[cf.DATA])&&(a[cf.DATA]=n===6?s:s.subarray(i*e,i*(e+t))),a}_sliceChildren(e,t,i){return e.map(n=>n.slice(t,i))}}ls.prototype.children=Object.freeze([]);class a_ extends vr{visit(e){return this.getVisitFn(e.type).call(this,e)}visitNull(e){const{["type"]:t,["offset"]:i=0,["length"]:n=0}=e;return new ls(t,i,n,0)}visitBool(e){const{["type"]:t,["offset"]:i=0}=e,n=Mr(e.nullBitmap),s=es(t.ArrayType,e.data),{["length"]:a=s.length>>3,["nullCount"]:c=e.nullBitmap?-1:0}=e;return new ls(t,i,a,c,[void 0,s,n])}visitInt(e){const{["type"]:t,["offset"]:i=0}=e,n=Mr(e.nullBitmap),s=es(t.ArrayType,e.data),{["length"]:a=s.length,["nullCount"]:c=e.nullBitmap?-1:0}=e;return new ls(t,i,a,c,[void 0,s,n])}visitFloat(e){const{["type"]:t,["offset"]:i=0}=e,n=Mr(e.nullBitmap),s=es(t.ArrayType,e.data),{["length"]:a=s.length,["nullCount"]:c=e.nullBitmap?-1:0}=e;return new ls(t,i,a,c,[void 0,s,n])}visitUtf8(e){const{["type"]:t,["offset"]:i=0}=e,n=Mr(e.data),s=Mr(e.nullBitmap),a=Uy(e.valueOffsets),{["length"]:c=a.length-1,["nullCount"]:h=e.nullBitmap?-1:0}=e;return new ls(t,i,c,h,[a,n,s])}visitBinary(e){const{["type"]:t,["offset"]:i=0}=e,n=Mr(e.data),s=Mr(e.nullBitmap),a=Uy(e.valueOffsets),{["length"]:c=a.length-1,["nullCount"]:h=e.nullBitmap?-1:0}=e;return new ls(t,i,c,h,[a,n,s])}visitFixedSizeBinary(e){const{["type"]:t,["offset"]:i=0}=e,n=Mr(e.nullBitmap),s=es(t.ArrayType,e.data),{["length"]:a=s.length/df(t),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new ls(t,i,a,c,[void 0,s,n])}visitDate(e){const{["type"]:t,["offset"]:i=0}=e,n=Mr(e.nullBitmap),s=es(t.ArrayType,e.data),{["length"]:a=s.length/df(t),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new ls(t,i,a,c,[void 0,s,n])}visitTimestamp(e){const{["type"]:t,["offset"]:i=0}=e,n=Mr(e.nullBitmap),s=es(t.ArrayType,e.data),{["length"]:a=s.length/df(t),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new ls(t,i,a,c,[void 0,s,n])}visitTime(e){const{["type"]:t,["offset"]:i=0}=e,n=Mr(e.nullBitmap),s=es(t.ArrayType,e.data),{["length"]:a=s.length/df(t),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new ls(t,i,a,c,[void 0,s,n])}visitDecimal(e){const{["type"]:t,["offset"]:i=0}=e,n=Mr(e.nullBitmap),s=es(t.ArrayType,e.data),{["length"]:a=s.length/df(t),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new ls(t,i,a,c,[void 0,s,n])}visitList(e){const{["type"]:t,["offset"]:i=0,["child"]:n}=e,s=Mr(e.nullBitmap),a=Uy(e.valueOffsets),{["length"]:c=a.length-1,["nullCount"]:h=e.nullBitmap?-1:0}=e;return new ls(t,i,c,h,[a,void 0,s],[n])}visitStruct(e){const{["type"]:t,["offset"]:i=0,["children"]:n=[]}=e,s=Mr(e.nullBitmap),{length:a=n.reduce((h,{length:m})=>Math.max(h,m),0),nullCount:c=e.nullBitmap?-1:0}=e;return new ls(t,i,a,c,[void 0,void 0,s],n)}visitUnion(e){const{["type"]:t,["offset"]:i=0,["children"]:n=[]}=e,s=Mr(e.nullBitmap),a=es(t.ArrayType,e.typeIds),{["length"]:c=a.length,["nullCount"]:h=e.nullBitmap?-1:0}=e;if(En.isSparseUnion(t))return new ls(t,i,c,h,[void 0,void 0,s,a],n);const m=Uy(e.valueOffsets);return new ls(t,i,c,h,[m,void 0,s,a],n)}visitDictionary(e){const{["type"]:t,["offset"]:i=0}=e,n=Mr(e.nullBitmap),s=es(t.indices.ArrayType,e.data),{["dictionary"]:a=new Ur([new a_().visit({type:t.dictionary})])}=e,{["length"]:c=s.length,["nullCount"]:h=e.nullBitmap?-1:0}=e;return new ls(t,i,c,h,[void 0,s,n],[],a)}visitInterval(e){const{["type"]:t,["offset"]:i=0}=e,n=Mr(e.nullBitmap),s=es(t.ArrayType,e.data),{["length"]:a=s.length/df(t),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new ls(t,i,a,c,[void 0,s,n])}visitFixedSizeList(e){const{["type"]:t,["offset"]:i=0,["child"]:n=new a_().visit({type:t.valueType})}=e,s=Mr(e.nullBitmap),{["length"]:a=n.length/df(t),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new ls(t,i,a,c,[void 0,void 0,s],[n])}visitMap(e){const{["type"]:t,["offset"]:i=0,["child"]:n=new a_().visit({type:t.childType})}=e,s=Mr(e.nullBitmap),a=Uy(e.valueOffsets),{["length"]:c=a.length-1,["nullCount"]:h=e.nullBitmap?-1:0}=e;return new ls(t,i,c,h,[a,void 0,s],[n])}}function gr(r){return new a_().visit(r)}class yD{constructor(e=0,t){this.numChunks=e,this.getChunkIterator=t,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const e=this.chunkIterator.next();if(!e.done)return e;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function JL(r){return r.reduce((e,t)=>e+t.nullCount,0)}function eR(r){return r.reduce((e,t,i)=>(e[i+1]=e[i]+t.length,e),new Uint32Array(r.length+1))}function tR(r,e,t,i){const n=[];for(let s=-1,a=r.length;++s<a;){const c=r[s],h=e[s],{length:m}=c;if(h>=i)break;if(t>=h+m)continue;if(h>=t&&h+m<=i){n.push(c);continue}const v=Math.max(0,t-h),b=Math.min(i-h,m);n.push(c.slice(v,b-v))}return n.length===0&&n.push(r[0].slice(0,0)),n}function _2(r,e,t,i){let n=0,s=0,a=e.length-1;do{if(n>=a-1)return t<e[a]?i(r,n,t-e[n]):null;s=n+Math.trunc((a-n)*.5),t<e[s]?a=s:n=s}while(n<a)}function b2(r,e){return r.getValid(e)}function f0(r){function e(t,i,n){return r(t[i],n)}return function(t){const i=this.data;return _2(i,this._offsets,t,e)}}function iR(r){let e;function t(i,n,s){return r(i[n],s,e)}return function(i,n){const s=this.data;e=n;const a=_2(s,this._offsets,i,t);return e=void 0,a}}function nR(r){let e;function t(i,n,s){let a=s,c=0,h=0;for(let m=n-1,v=i.length;++m<v;){const b=i[m];if(~(c=r(b,e,a)))return h+c;a=0,h+=b.length}return-1}return function(i,n){e=i;const s=this.data,a=typeof n!="number"?t(s,0,0):_2(s,this._offsets,n,t);return e=void 0,a}}class Mn extends vr{}function t6(r,e){return e===null&&r.length>0?0:-1}function i6(r,e){const{nullBitmap:t}=r;if(!t||r.nullCount<=0)return-1;let i=0;for(const n of new y2(t,r.offset+(e||0),r.length,t,ZL)){if(!n)return i;++i}return-1}function Xn(r,e,t){if(e===void 0)return-1;if(e===null)return i6(r,t);const i=nu.getVisitFn(r),n=Z0(e);for(let s=(t||0)-1,a=r.length;++s<a;)if(n(i(r,s)))return s;return-1}function rR(r,e,t){const i=nu.getVisitFn(r),n=Z0(e);for(let s=(t||0)-1,a=r.length;++s<a;)if(n(i(r,s)))return s;return-1}Mn.prototype.visitNull=t6;Mn.prototype.visitBool=Xn;Mn.prototype.visitInt=Xn;Mn.prototype.visitInt8=Xn;Mn.prototype.visitInt16=Xn;Mn.prototype.visitInt32=Xn;Mn.prototype.visitInt64=Xn;Mn.prototype.visitUint8=Xn;Mn.prototype.visitUint16=Xn;Mn.prototype.visitUint32=Xn;Mn.prototype.visitUint64=Xn;Mn.prototype.visitFloat=Xn;Mn.prototype.visitFloat16=Xn;Mn.prototype.visitFloat32=Xn;Mn.prototype.visitFloat64=Xn;Mn.prototype.visitUtf8=Xn;Mn.prototype.visitBinary=Xn;Mn.prototype.visitFixedSizeBinary=Xn;Mn.prototype.visitDate=Xn;Mn.prototype.visitDateDay=Xn;Mn.prototype.visitDateMillisecond=Xn;Mn.prototype.visitTimestamp=Xn;Mn.prototype.visitTimestampSecond=Xn;Mn.prototype.visitTimestampMillisecond=Xn;Mn.prototype.visitTimestampMicrosecond=Xn;Mn.prototype.visitTimestampNanosecond=Xn;Mn.prototype.visitTime=Xn;Mn.prototype.visitTimeSecond=Xn;Mn.prototype.visitTimeMillisecond=Xn;Mn.prototype.visitTimeMicrosecond=Xn;Mn.prototype.visitTimeNanosecond=Xn;Mn.prototype.visitDecimal=Xn;Mn.prototype.visitList=Xn;Mn.prototype.visitStruct=Xn;Mn.prototype.visitUnion=Xn;Mn.prototype.visitDenseUnion=rR;Mn.prototype.visitSparseUnion=rR;Mn.prototype.visitDictionary=Xn;Mn.prototype.visitInterval=Xn;Mn.prototype.visitIntervalDayTime=Xn;Mn.prototype.visitIntervalYearMonth=Xn;Mn.prototype.visitFixedSizeList=Xn;Mn.prototype.visitMap=Xn;const HT=new Mn;class Dn extends vr{}function On(r){const{type:e}=r;if(r.nullCount===0&&r.stride===1&&(e.typeId===ht.Timestamp||e instanceof Mp&&e.bitWidth!==64||e instanceof x_&&e.bitWidth!==64||e instanceof T_&&e.precision!==tu.HALF))return new yD(r.data.length,i=>{const n=r.data[i];return n.values.subarray(0,n.length)[Symbol.iterator]()});let t=0;return new yD(r.data.length,i=>{const s=r.data[i].length,a=r.slice(t,t+s);return t+=s,new n6(a)})}class n6{constructor(e){this.vector=e,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}Dn.prototype.visitNull=On;Dn.prototype.visitBool=On;Dn.prototype.visitInt=On;Dn.prototype.visitInt8=On;Dn.prototype.visitInt16=On;Dn.prototype.visitInt32=On;Dn.prototype.visitInt64=On;Dn.prototype.visitUint8=On;Dn.prototype.visitUint16=On;Dn.prototype.visitUint32=On;Dn.prototype.visitUint64=On;Dn.prototype.visitFloat=On;Dn.prototype.visitFloat16=On;Dn.prototype.visitFloat32=On;Dn.prototype.visitFloat64=On;Dn.prototype.visitUtf8=On;Dn.prototype.visitBinary=On;Dn.prototype.visitFixedSizeBinary=On;Dn.prototype.visitDate=On;Dn.prototype.visitDateDay=On;Dn.prototype.visitDateMillisecond=On;Dn.prototype.visitTimestamp=On;Dn.prototype.visitTimestampSecond=On;Dn.prototype.visitTimestampMillisecond=On;Dn.prototype.visitTimestampMicrosecond=On;Dn.prototype.visitTimestampNanosecond=On;Dn.prototype.visitTime=On;Dn.prototype.visitTimeSecond=On;Dn.prototype.visitTimeMillisecond=On;Dn.prototype.visitTimeMicrosecond=On;Dn.prototype.visitTimeNanosecond=On;Dn.prototype.visitDecimal=On;Dn.prototype.visitList=On;Dn.prototype.visitStruct=On;Dn.prototype.visitUnion=On;Dn.prototype.visitDenseUnion=On;Dn.prototype.visitSparseUnion=On;Dn.prototype.visitDictionary=On;Dn.prototype.visitInterval=On;Dn.prototype.visitIntervalDayTime=On;Dn.prototype.visitIntervalYearMonth=On;Dn.prototype.visitFixedSizeList=On;Dn.prototype.visitMap=On;const T2=new Dn,r6=(r,e)=>r+e;class Bp extends vr{visitNull(e,t){return 0}visitInt(e,t){return e.type.bitWidth/8}visitFloat(e,t){return e.type.ArrayType.BYTES_PER_ELEMENT}visitBool(e,t){return 1/8}visitDecimal(e,t){return e.type.bitWidth/8}visitDate(e,t){return(e.type.unit+1)*4}visitTime(e,t){return e.type.bitWidth/8}visitTimestamp(e,t){return e.type.unit===Dr.SECOND?4:8}visitInterval(e,t){return(e.type.unit+1)*4}visitStruct(e,t){return e.children.reduce((i,n)=>i+vh.visit(n,t),0)}visitFixedSizeBinary(e,t){return e.type.byteWidth}visitMap(e,t){return 8+e.children.reduce((i,n)=>i+vh.visit(n,t),0)}visitDictionary(e,t){var i;return e.type.indices.bitWidth/8+(((i=e.dictionary)===null||i===void 0?void 0:i.getByteLength(e.values[t]))||0)}}const s6=({valueOffsets:r},e)=>8+(r[e+1]-r[e]),a6=({valueOffsets:r},e)=>8+(r[e+1]-r[e]),o6=({valueOffsets:r,stride:e,children:t},i)=>{const n=t[0],{[i*e]:s}=r,{[i*e+1]:a}=r,c=vh.getVisitFn(n.type),h=n.slice(s,a-s);let m=8;for(let v=-1,b=a-s;++v<b;)m+=c(h,v);return m},l6=({stride:r,children:e},t)=>{const i=e[0],n=i.slice(t*r,r),s=vh.getVisitFn(i.type);let a=0;for(let c=-1,h=n.length;++c<h;)a+=s(n,c);return a},u6=(r,e)=>r.type.mode===Gu.Dense?sR(r,e):aR(r,e),sR=({type:r,children:e,typeIds:t,valueOffsets:i},n)=>{const s=r.typeIdToChildIndex[t[n]];return 8+vh.visit(e[s],i[n])},aR=({children:r},e)=>4+vh.visitMany(r,r.map(()=>e)).reduce(r6,0);Bp.prototype.visitUtf8=s6;Bp.prototype.visitBinary=a6;Bp.prototype.visitList=o6;Bp.prototype.visitFixedSizeList=l6;Bp.prototype.visitUnion=u6;Bp.prototype.visitDenseUnion=sR;Bp.prototype.visitSparseUnion=aR;const vh=new Bp;var oR;const lR={},uR={};class Ur{constructor(e){var t,i,n;const s=e[0]instanceof Ur?e.flatMap(c=>c.data):e;if(s.length===0||s.some(c=>!(c instanceof ls)))throw new TypeError("Vector constructor expects an Array of Data instances.");const a=(t=s[0])===null||t===void 0?void 0:t.type;switch(s.length){case 0:this._offsets=[0];break;case 1:{const{get:c,set:h,indexOf:m,byteLength:v}=lR[a.typeId],b=s[0];this.isValid=x=>b2(b,x),this.get=x=>c(b,x),this.set=(x,C)=>h(b,x,C),this.indexOf=x=>m(b,x),this.getByteLength=x=>v(b,x),this._offsets=[0,b.length];break}default:Object.setPrototypeOf(this,uR[a.typeId]),this._offsets=eR(s);break}this.data=s,this.type=a,this.stride=df(a),this.numChildren=(n=(i=a.children)===null||i===void 0?void 0:i.length)!==null&&n!==void 0?n:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return this._byteLength===-1&&(this._byteLength=this.data.reduce((e,t)=>e+t.byteLength,0)),this._byteLength}get nullCount(){return this._nullCount===-1&&(this._nullCount=JL(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${ht[this.type.typeId]}Vector`}isValid(e){return!1}get(e){return null}set(e,t){}indexOf(e,t){return-1}includes(e,t){return this.indexOf(e,t)>0}getByteLength(e){return 0}[Symbol.iterator](){return T2.visit(this)}concat(...e){return new Ur(this.data.concat(e.flatMap(t=>t.data).flat(Number.POSITIVE_INFINITY)))}slice(e,t){return new Ur(KL(this,e,t,({data:i,_offsets:n},s,a)=>tR(i,n,s,a)))}toJSON(){return[...this]}toArray(){const{type:e,data:t,length:i,stride:n,ArrayType:s}=this;switch(e.typeId){case ht.Int:case ht.Float:case ht.Decimal:case ht.Time:case ht.Timestamp:switch(t.length){case 0:return new s;case 1:return t[0].values.subarray(0,i*n);default:return t.reduce((a,{values:c,length:h})=>(a.array.set(c.subarray(0,h*n),a.offset),a.offset+=h*n,a),{array:new s(i*n),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(e){var t;return this.getChildAt((t=this.type.children)===null||t===void 0?void 0:t.findIndex(i=>i.name===e))}getChildAt(e){return e>-1&&e<this.numChildren?new Ur(this.data.map(({children:t})=>t[e])):null}get isMemoized(){return En.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(En.isDictionary(this.type)){const e=new jT(this.data[0].dictionary),t=this.data.map(i=>{const n=i.clone();return n.dictionary=e,n});return new Ur(t)}return new jT(this)}unmemoize(){if(En.isDictionary(this.type)&&this.isMemoized){const e=this.data[0].dictionary.unmemoize(),t=this.data.map(i=>{const n=i.clone();return n.dictionary=e,n});return new Ur(t)}return this}}oR=Symbol.toStringTag;Ur[oR]=(r=>{r.type=En.prototype,r.data=[],r.length=0,r.stride=1,r.numChildren=0,r._nullCount=-1,r._byteLength=-1,r._offsets=new Uint32Array([0]),r[Symbol.isConcatSpreadable]=!0;const e=Object.keys(ht).map(t=>ht[t]).filter(t=>typeof t=="number"&&t!==ht.NONE);for(const t of e){const i=nu.getVisitFnByTypeId(t),n=yc.getVisitFnByTypeId(t),s=HT.getVisitFnByTypeId(t),a=vh.getVisitFnByTypeId(t);lR[t]={get:i,set:n,indexOf:s,byteLength:a},uR[t]=Object.create(r,{isValid:{value:f0(b2)},get:{value:f0(nu.getVisitFnByTypeId(t))},set:{value:iR(yc.getVisitFnByTypeId(t))},indexOf:{value:nR(HT.getVisitFnByTypeId(t))},getByteLength:{value:f0(vh.getVisitFnByTypeId(t))}})}return"Vector"})(Ur.prototype);class jT extends Ur{constructor(e){super(e.data);const t=this.get,i=this.set,n=this.slice,s=new Array(this.length);Object.defineProperty(this,"get",{value(a){const c=s[a];if(c!==void 0)return c;const h=t.call(this,a);return s[a]=h,h}}),Object.defineProperty(this,"set",{value(a,c){i.call(this,a,c),s[a]=c}}),Object.defineProperty(this,"slice",{value:(a,c)=>new jT(n.call(this,a,c))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new Ur(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class Yw{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(e,t,i,n){return e.prep(8,24),e.writeInt64(n),e.pad(4),e.writeInt32(i),e.writeInt64(t),e.offset()}}const PA=2,ih=4,pf=4,ns=4,bp=new Int32Array(2),_D=new Float32Array(bp.buffer),bD=new Float64Array(bp.buffer),$1=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;let bf=class Qw{constructor(e,t){this.low=e|0,this.high=t|0}static create(e,t){return e==0&&t==0?Qw.ZERO:new Qw(e,t)}toFloat64(){return(this.low>>>0)+this.high*4294967296}equals(e){return this.low==e.low&&this.high==e.high}};bf.ZERO=new bf(0,0);var Kw;(function(r){r[r.UTF8_BYTES=1]="UTF8_BYTES",r[r.UTF16_STRING=2]="UTF16_STRING"})(Kw||(Kw={}));let C0=class cR{constructor(e){this.bytes_=e,this.position_=0}static allocate(e){return new cR(new Uint8Array(e))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(e){this.position_=e}capacity(){return this.bytes_.length}readInt8(e){return this.readUint8(e)<<24>>24}readUint8(e){return this.bytes_[e]}readInt16(e){return this.readUint16(e)<<16>>16}readUint16(e){return this.bytes_[e]|this.bytes_[e+1]<<8}readInt32(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24}readUint32(e){return this.readInt32(e)>>>0}readInt64(e){return new bf(this.readInt32(e),this.readInt32(e+4))}readUint64(e){return new bf(this.readUint32(e),this.readUint32(e+4))}readFloat32(e){return bp[0]=this.readInt32(e),_D[0]}readFloat64(e){return bp[$1?0:1]=this.readInt32(e),bp[$1?1:0]=this.readInt32(e+4),bD[0]}writeInt8(e,t){this.bytes_[e]=t}writeUint8(e,t){this.bytes_[e]=t}writeInt16(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8}writeUint16(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8}writeInt32(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24}writeUint32(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24}writeInt64(e,t){this.writeInt32(e,t.low),this.writeInt32(e+4,t.high)}writeUint64(e,t){this.writeUint32(e,t.low),this.writeUint32(e+4,t.high)}writeFloat32(e,t){_D[0]=t,this.writeInt32(e,bp[0])}writeFloat64(e,t){bD[0]=t,this.writeInt32(e,bp[$1?0:1]),this.writeInt32(e+4,bp[$1?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+ih+pf)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let e="";for(let t=0;t<pf;t++)e+=String.fromCharCode(this.readInt8(this.position_+ih+t));return e}__offset(e,t){const i=e-this.readInt32(e);return t<this.readInt16(i)?this.readInt16(i+t):0}__union(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e}__string(e,t){e+=this.readInt32(e);const i=this.readInt32(e);let n="",s=0;if(e+=ih,t===Kw.UTF8_BYTES)return this.bytes_.subarray(e,e+i);for(;s<i;){let a;const c=this.readUint8(e+s++);if(c<192)a=c;else{const h=this.readUint8(e+s++);if(c<224)a=(c&31)<<6|h&63;else{const m=this.readUint8(e+s++);if(c<240)a=(c&15)<<12|(h&63)<<6|m&63;else{const v=this.readUint8(e+s++);a=(c&7)<<18|(h&63)<<12|(m&63)<<6|v&63}}}a<65536?n+=String.fromCharCode(a):(a-=65536,n+=String.fromCharCode((a>>10)+55296,(a&1023)+56320))}return n}__union_with_string(e,t){return typeof e=="string"?this.__string(t):this.__union(e,t)}__indirect(e){return e+this.readInt32(e)}__vector(e){return e+this.readInt32(e)+ih}__vector_len(e){return this.readInt32(e+this.readInt32(e))}__has_identifier(e){if(e.length!=pf)throw new Error("FlatBuffers: file identifier must be length "+pf);for(let t=0;t<pf;t++)if(e.charCodeAt(t)!=this.readInt8(this.position()+ih+t))return!1;return!0}createLong(e,t){return bf.create(e,t)}createScalarList(e,t){const i=[];for(let n=0;n<t;++n)e(n)!==null&&i.push(e(n));return i}createObjList(e,t){const i=[];for(let n=0;n<t;++n){const s=e(n);s!==null&&i.push(s.unpack())}return i}},dR=class hR{constructor(e){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null;let t;e?t=e:t=1024,this.bb=C0.allocate(t),this.space=t}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(e){this.force_defaults=e}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(e,t){e>this.minalign&&(this.minalign=e);const i=~(this.bb.capacity()-this.space+t)+1&e-1;for(;this.space<i+e+t;){const n=this.bb.capacity();this.bb=hR.growByteBuffer(this.bb),this.space+=this.bb.capacity()-n}this.pad(i)}pad(e){for(let t=0;t<e;t++)this.bb.writeInt8(--this.space,0)}writeInt8(e){this.bb.writeInt8(this.space-=1,e)}writeInt16(e){this.bb.writeInt16(this.space-=2,e)}writeInt32(e){this.bb.writeInt32(this.space-=4,e)}writeInt64(e){this.bb.writeInt64(this.space-=8,e)}writeFloat32(e){this.bb.writeFloat32(this.space-=4,e)}writeFloat64(e){this.bb.writeFloat64(this.space-=8,e)}addInt8(e){this.prep(1,0),this.writeInt8(e)}addInt16(e){this.prep(2,0),this.writeInt16(e)}addInt32(e){this.prep(4,0),this.writeInt32(e)}addInt64(e){this.prep(8,0),this.writeInt64(e)}addFloat32(e){this.prep(4,0),this.writeFloat32(e)}addFloat64(e){this.prep(8,0),this.writeFloat64(e)}addFieldInt8(e,t,i){(this.force_defaults||t!=i)&&(this.addInt8(t),this.slot(e))}addFieldInt16(e,t,i){(this.force_defaults||t!=i)&&(this.addInt16(t),this.slot(e))}addFieldInt32(e,t,i){(this.force_defaults||t!=i)&&(this.addInt32(t),this.slot(e))}addFieldInt64(e,t,i){(this.force_defaults||!t.equals(i))&&(this.addInt64(t),this.slot(e))}addFieldFloat32(e,t,i){(this.force_defaults||t!=i)&&(this.addFloat32(t),this.slot(e))}addFieldFloat64(e,t,i){(this.force_defaults||t!=i)&&(this.addFloat64(t),this.slot(e))}addFieldOffset(e,t,i){(this.force_defaults||t!=i)&&(this.addOffset(t),this.slot(e))}addFieldStruct(e,t,i){t!=i&&(this.nested(t),this.slot(e))}nested(e){if(e!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(e){this.vtable!==null&&(this.vtable[e]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(e){const t=e.capacity();if(t&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const i=t<<1,n=C0.allocate(i);return n.setPosition(i-t),n.bytes().set(e.bytes(),i-t),n}addOffset(e){this.prep(ih,0),this.writeInt32(this.offset()-e+ih)}startObject(e){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=e;for(let t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const e=this.offset();let t=this.vtable_in_use-1;for(;t>=0&&this.vtable[t]==0;t--);const i=t+1;for(;t>=0;t--)this.addInt16(this.vtable[t]!=0?e-this.vtable[t]:0);const n=2;this.addInt16(e-this.object_start);const s=(i+n)*PA;this.addInt16(s);let a=0;const c=this.space;e:for(t=0;t<this.vtables.length;t++){const h=this.bb.capacity()-this.vtables[t];if(s==this.bb.readInt16(h)){for(let m=PA;m<s;m+=PA)if(this.bb.readInt16(c+m)!=this.bb.readInt16(h+m))continue e;a=this.vtables[t];break}}return a?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,a-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e}finish(e,t,i){const n=i?ns:0;if(t){const s=t;if(this.prep(this.minalign,ih+pf+n),s.length!=pf)throw new Error("FlatBuffers: file identifier must be length "+pf);for(let a=pf-1;a>=0;a--)this.writeInt8(s.charCodeAt(a))}this.prep(this.minalign,ih+n),this.addOffset(e),n&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(e,t){this.finish(e,t,!0)}requiredField(e,t){const i=this.bb.capacity()-e,n=i-this.bb.readInt32(i);if(!(this.bb.readInt16(n+t)!=0))throw new Error("FlatBuffers: field "+t+" must be set")}startVector(e,t,i){this.notNested(),this.vector_num_elems=t,this.prep(ih,e*t),this.prep(i,e*t)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(e){if(!e)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(e))return this.string_maps.get(e);const t=this.createString(e);return this.string_maps.set(e,t),t}createString(e){if(!e)return 0;let t;if(e instanceof Uint8Array)t=e;else{t=[];let i=0;for(;i<e.length;){let n;const s=e.charCodeAt(i++);if(s<55296||s>=56320)n=s;else{const a=e.charCodeAt(i++);n=(s<<10)+a+-56613888}n<128?t.push(n):(n<2048?t.push(n>>6&31|192):(n<65536?t.push(n>>12&15|224):t.push(n>>18&7|240,n>>12&63|128),t.push(n>>6&63|128)),t.push(n&63|128))}}this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length);for(let i=0,n=this.space,s=this.bb.bytes();i<t.length;i++)s[n++]=t[i];return this.endVector()}createLong(e,t){return bf.create(e,t)}createObjectOffset(e){return e===null?0:typeof e=="string"?this.createString(e):e.pack(this)}createObjectOffsetList(e){const t=[];for(let i=0;i<e.length;++i){const n=e[i];if(n!==null)t.push(this.createObjectOffset(n));else throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return t}createStructOffsetList(e,t){return t(this,e.length),this.createObjectOffsetList(e),this.endVector()}};class ka{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsKeyValue(e,t){return(t||new ka).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsKeyValue(e,t){return e.setPosition(e.position()+ns),(t||new ka).__init(e.readInt32(e.position())+e.position(),e)}key(e){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}value(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startKeyValue(e){e.startObject(2)}static addKey(e,t){e.addFieldOffset(0,t,0)}static addValue(e,t){e.addFieldOffset(1,t,0)}static endKeyValue(e){return e.endObject()}static createKeyValue(e,t,i){return ka.startKeyValue(e),ka.addKey(e,t),ka.addValue(e,i),ka.endKeyValue(e)}}var M0;(function(r){r[r.V1=0]="V1",r[r.V2=1]="V2",r[r.V3=2]="V3",r[r.V4=3]="V4",r[r.V5=4]="V5"})(M0||(M0={}));var D0;(function(r){r[r.Little=0]="Little",r[r.Big=1]="Big"})(D0||(D0={}));var GT;(function(r){r[r.DenseArray=0]="DenseArray"})(GT||(GT={}));class Hu{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInt(e,t){return(t||new Hu).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInt(e,t){return e.setPosition(e.position()+ns),(t||new Hu).__init(e.readInt32(e.position())+e.position(),e)}bitWidth(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}isSigned(){const e=this.bb.__offset(this.bb_pos,6);return e?!!this.bb.readInt8(this.bb_pos+e):!1}static startInt(e){e.startObject(2)}static addBitWidth(e,t){e.addFieldInt32(0,t,0)}static addIsSigned(e,t){e.addFieldInt8(1,+t,0)}static endInt(e){return e.endObject()}static createInt(e,t,i){return Hu.startInt(e),Hu.addBitWidth(e,t),Hu.addIsSigned(e,i),Hu.endInt(e)}}class mf{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDictionaryEncoding(e,t){return(t||new mf).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryEncoding(e,t){return e.setPosition(e.position()+ns),(t||new mf).__init(e.readInt32(e.position())+e.position(),e)}id(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}indexType(e){const t=this.bb.__offset(this.bb_pos,6);return t?(e||new Hu).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}isOrdered(){const e=this.bb.__offset(this.bb_pos,8);return e?!!this.bb.readInt8(this.bb_pos+e):!1}dictionaryKind(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt16(this.bb_pos+e):GT.DenseArray}static startDictionaryEncoding(e){e.startObject(4)}static addId(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}static addIndexType(e,t){e.addFieldOffset(1,t,0)}static addIsOrdered(e,t){e.addFieldInt8(2,+t,0)}static addDictionaryKind(e,t){e.addFieldInt16(3,t,GT.DenseArray)}static endDictionaryEncoding(e){return e.endObject()}}class Im{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBinary(e,t){return(t||new Im).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBinary(e,t){return e.setPosition(e.position()+ns),(t||new Im).__init(e.readInt32(e.position())+e.position(),e)}static startBinary(e){e.startObject(0)}static endBinary(e){return e.endObject()}static createBinary(e){return Im.startBinary(e),Im.endBinary(e)}}class Pm{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBool(e,t){return(t||new Pm).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBool(e,t){return e.setPosition(e.position()+ns),(t||new Pm).__init(e.readInt32(e.position())+e.position(),e)}static startBool(e){e.startObject(0)}static endBool(e){return e.endObject()}static createBool(e){return Pm.startBool(e),Pm.endBool(e)}}var $T;(function(r){r[r.DAY=0]="DAY",r[r.MILLISECOND=1]="MILLISECOND"})($T||($T={}));let hT=class Zg{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDate(e,t){return(t||new Zg).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDate(e,t){return e.setPosition(e.position()+ns),(t||new Zg).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):$T.MILLISECOND}static startDate(e){e.startObject(1)}static addUnit(e,t){e.addFieldInt16(0,t,$T.MILLISECOND)}static endDate(e){return e.endObject()}static createDate(e,t){return Zg.startDate(e),Zg.addUnit(e,t),Zg.endDate(e)}};class Yl{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDecimal(e,t){return(t||new Yl).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDecimal(e,t){return e.setPosition(e.position()+ns),(t||new Yl).__init(e.readInt32(e.position())+e.position(),e)}precision(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}scale(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):0}bitWidth(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt32(this.bb_pos+e):128}static startDecimal(e){e.startObject(3)}static addPrecision(e,t){e.addFieldInt32(0,t,0)}static addScale(e,t){e.addFieldInt32(1,t,0)}static addBitWidth(e,t){e.addFieldInt32(2,t,128)}static endDecimal(e){return e.endObject()}static createDecimal(e,t,i,n){return Yl.startDecimal(e),Yl.addPrecision(e,t),Yl.addScale(e,i),Yl.addBitWidth(e,n),Yl.endDecimal(e)}}var I0;(function(r){r[r.SECOND=0]="SECOND",r[r.MILLISECOND=1]="MILLISECOND",r[r.MICROSECOND=2]="MICROSECOND",r[r.NANOSECOND=3]="NANOSECOND"})(I0||(I0={}));class nh{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFixedSizeBinary(e,t){return(t||new nh).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFixedSizeBinary(e,t){return e.setPosition(e.position()+ns),(t||new nh).__init(e.readInt32(e.position())+e.position(),e)}byteWidth(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeBinary(e){e.startObject(1)}static addByteWidth(e,t){e.addFieldInt32(0,t,0)}static endFixedSizeBinary(e){return e.endObject()}static createFixedSizeBinary(e,t){return nh.startFixedSizeBinary(e),nh.addByteWidth(e,t),nh.endFixedSizeBinary(e)}}class rh{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFixedSizeList(e,t){return(t||new rh).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFixedSizeList(e,t){return e.setPosition(e.position()+ns),(t||new rh).__init(e.readInt32(e.position())+e.position(),e)}listSize(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeList(e){e.startObject(1)}static addListSize(e,t){e.addFieldInt32(0,t,0)}static endFixedSizeList(e){return e.endObject()}static createFixedSizeList(e,t){return rh.startFixedSizeList(e),rh.addListSize(e,t),rh.endFixedSizeList(e)}}var WT;(function(r){r[r.HALF=0]="HALF",r[r.SINGLE=1]="SINGLE",r[r.DOUBLE=2]="DOUBLE"})(WT||(WT={}));class sh{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFloatingPoint(e,t){return(t||new sh).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFloatingPoint(e,t){return e.setPosition(e.position()+ns),(t||new sh).__init(e.readInt32(e.position())+e.position(),e)}precision(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):WT.HALF}static startFloatingPoint(e){e.startObject(1)}static addPrecision(e,t){e.addFieldInt16(0,t,WT.HALF)}static endFloatingPoint(e){return e.endObject()}static createFloatingPoint(e,t){return sh.startFloatingPoint(e),sh.addPrecision(e,t),sh.endFloatingPoint(e)}}var qT;(function(r){r[r.YEAR_MONTH=0]="YEAR_MONTH",r[r.DAY_TIME=1]="DAY_TIME",r[r.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(qT||(qT={}));class ah{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInterval(e,t){return(t||new ah).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInterval(e,t){return e.setPosition(e.position()+ns),(t||new ah).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):qT.YEAR_MONTH}static startInterval(e){e.startObject(1)}static addUnit(e,t){e.addFieldInt16(0,t,qT.YEAR_MONTH)}static endInterval(e){return e.endObject()}static createInterval(e,t){return ah.startInterval(e),ah.addUnit(e,t),ah.endInterval(e)}}class Lm{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsList(e,t){return(t||new Lm).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsList(e,t){return e.setPosition(e.position()+ns),(t||new Lm).__init(e.readInt32(e.position())+e.position(),e)}static startList(e){e.startObject(0)}static endList(e){return e.endObject()}static createList(e){return Lm.startList(e),Lm.endList(e)}}let fT=class Jg{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMap(e,t){return(t||new Jg).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMap(e,t){return e.setPosition(e.position()+ns),(t||new Jg).__init(e.readInt32(e.position())+e.position(),e)}keysSorted(){const e=this.bb.__offset(this.bb_pos,4);return e?!!this.bb.readInt8(this.bb_pos+e):!1}static startMap(e){e.startObject(1)}static addKeysSorted(e,t){e.addFieldInt8(0,+t,0)}static endMap(e){return e.endObject()}static createMap(e,t){return Jg.startMap(e),Jg.addKeysSorted(e,t),Jg.endMap(e)}};class Rm{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNull(e,t){return(t||new Rm).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsNull(e,t){return e.setPosition(e.position()+ns),(t||new Rm).__init(e.readInt32(e.position())+e.position(),e)}static startNull(e){e.startObject(0)}static endNull(e){return e.endObject()}static createNull(e){return Rm.startNull(e),Rm.endNull(e)}}class km{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsStruct_(e,t){return(t||new km).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsStruct_(e,t){return e.setPosition(e.position()+ns),(t||new km).__init(e.readInt32(e.position())+e.position(),e)}static startStruct_(e){e.startObject(0)}static endStruct_(e){return e.endObject()}static createStruct_(e){return km.startStruct_(e),km.endStruct_(e)}}let Qy=class wm{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTime(e,t){return(t||new wm).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTime(e,t){return e.setPosition(e.position()+ns),(t||new wm).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):I0.MILLISECOND}bitWidth(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):32}static startTime(e){e.startObject(2)}static addUnit(e,t){e.addFieldInt16(0,t,I0.MILLISECOND)}static addBitWidth(e,t){e.addFieldInt32(1,t,32)}static endTime(e){return e.endObject()}static createTime(e,t,i){return wm.startTime(e),wm.addUnit(e,t),wm.addBitWidth(e,i),wm.endTime(e)}};class mc{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTimestamp(e,t){return(t||new mc).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTimestamp(e,t){return e.setPosition(e.position()+ns),(t||new mc).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):I0.SECOND}timezone(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startTimestamp(e){e.startObject(2)}static addUnit(e,t){e.addFieldInt16(0,t,I0.SECOND)}static addTimezone(e,t){e.addFieldOffset(1,t,0)}static endTimestamp(e){return e.endObject()}static createTimestamp(e,t,i){return mc.startTimestamp(e),mc.addUnit(e,t),mc.addTimezone(e,i),mc.endTimestamp(e)}}var XT;(function(r){r[r.Sparse=0]="Sparse",r[r.Dense=1]="Dense"})(XT||(XT={}));class Ql{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsUnion(e,t){return(t||new Ql).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUnion(e,t){return e.setPosition(e.position()+ns),(t||new Ql).__init(e.readInt32(e.position())+e.position(),e)}mode(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):XT.Sparse}typeIds(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb.__vector(this.bb_pos+t)+e*4):0}typeIdsLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}typeIdsArray(){const e=this.bb.__offset(this.bb_pos,6);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}static startUnion(e){e.startObject(2)}static addMode(e,t){e.addFieldInt16(0,t,XT.Sparse)}static addTypeIds(e,t){e.addFieldOffset(1,t,0)}static createTypeIdsVector(e,t){e.startVector(4,t.length,4);for(let i=t.length-1;i>=0;i--)e.addInt32(t[i]);return e.endVector()}static startTypeIdsVector(e,t){e.startVector(4,t,4)}static endUnion(e){return e.endObject()}static createUnion(e,t,i){return Ql.startUnion(e),Ql.addMode(e,t),Ql.addTypeIds(e,i),Ql.endUnion(e)}}class Om{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsUtf8(e,t){return(t||new Om).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUtf8(e,t){return e.setPosition(e.position()+ns),(t||new Om).__init(e.readInt32(e.position())+e.position(),e)}static startUtf8(e){e.startObject(0)}static endUtf8(e){return e.endObject()}static createUtf8(e){return Om.startUtf8(e),Om.endUtf8(e)}}var Us;(function(r){r[r.NONE=0]="NONE",r[r.Null=1]="Null",r[r.Int=2]="Int",r[r.FloatingPoint=3]="FloatingPoint",r[r.Binary=4]="Binary",r[r.Utf8=5]="Utf8",r[r.Bool=6]="Bool",r[r.Decimal=7]="Decimal",r[r.Date=8]="Date",r[r.Time=9]="Time",r[r.Timestamp=10]="Timestamp",r[r.Interval=11]="Interval",r[r.List=12]="List",r[r.Struct_=13]="Struct_",r[r.Union=14]="Union",r[r.FixedSizeBinary=15]="FixedSizeBinary",r[r.FixedSizeList=16]="FixedSizeList",r[r.Map=17]="Map",r[r.Duration=18]="Duration",r[r.LargeBinary=19]="LargeBinary",r[r.LargeUtf8=20]="LargeUtf8",r[r.LargeList=21]="LargeList"})(Us||(Us={}));let fc=class pT{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsField(e,t){return(t||new pT).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsField(e,t){return e.setPosition(e.position()+ns),(t||new pT).__init(e.readInt32(e.position())+e.position(),e)}name(e){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}nullable(){const e=this.bb.__offset(this.bb_pos,6);return e?!!this.bb.readInt8(this.bb_pos+e):!1}typeType(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint8(this.bb_pos+e):Us.NONE}type(e){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__union(e,this.bb_pos+t):null}dictionary(e){const t=this.bb.__offset(this.bb_pos,12);return t?(e||new mf).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}children(e,t){const i=this.bb.__offset(this.bb_pos,14);return i?(t||new pT).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}childrenLength(){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,t){const i=this.bb.__offset(this.bb_pos,16);return i?(t||new ka).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}static startField(e){e.startObject(7)}static addName(e,t){e.addFieldOffset(0,t,0)}static addNullable(e,t){e.addFieldInt8(1,+t,0)}static addTypeType(e,t){e.addFieldInt8(2,t,Us.NONE)}static addType(e,t){e.addFieldOffset(3,t,0)}static addDictionary(e,t){e.addFieldOffset(4,t,0)}static addChildren(e,t){e.addFieldOffset(5,t,0)}static createChildrenVector(e,t){e.startVector(4,t.length,4);for(let i=t.length-1;i>=0;i--)e.addOffset(t[i]);return e.endVector()}static startChildrenVector(e,t){e.startVector(4,t,4)}static addCustomMetadata(e,t){e.addFieldOffset(6,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let i=t.length-1;i>=0;i--)e.addOffset(t[i]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endField(e){return e.endObject()}},Yd=class uf{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSchema(e,t){return(t||new uf).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSchema(e,t){return e.setPosition(e.position()+ns),(t||new uf).__init(e.readInt32(e.position())+e.position(),e)}endianness(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):D0.Little}fields(e,t){const i=this.bb.__offset(this.bb_pos,6);return i?(t||new fc).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}fieldsLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,t){const i=this.bb.__offset(this.bb_pos,8);return i?(t||new ka).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}features(e){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+e*8):this.bb.createLong(0,0)}featuresLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSchema(e){e.startObject(4)}static addEndianness(e,t){e.addFieldInt16(0,t,D0.Little)}static addFields(e,t){e.addFieldOffset(1,t,0)}static createFieldsVector(e,t){e.startVector(4,t.length,4);for(let i=t.length-1;i>=0;i--)e.addOffset(t[i]);return e.endVector()}static startFieldsVector(e,t){e.startVector(4,t,4)}static addCustomMetadata(e,t){e.addFieldOffset(2,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let i=t.length-1;i>=0;i--)e.addOffset(t[i]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static addFeatures(e,t){e.addFieldOffset(3,t,0)}static createFeaturesVector(e,t){e.startVector(8,t.length,8);for(let i=t.length-1;i>=0;i--)e.addInt64(t[i]);return e.endVector()}static startFeaturesVector(e,t){e.startVector(8,t,8)}static endSchema(e){return e.endObject()}static finishSchemaBuffer(e,t){e.finish(t)}static finishSizePrefixedSchemaBuffer(e,t){e.finish(t,void 0,!0)}static createSchema(e,t,i,n,s){return uf.startSchema(e),uf.addEndianness(e,t),uf.addFields(e,i),uf.addCustomMetadata(e,n),uf.addFeatures(e,s),uf.endSchema(e)}};class zu{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFooter(e,t){return(t||new zu).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFooter(e,t){return e.setPosition(e.position()+ns),(t||new zu).__init(e.readInt32(e.position())+e.position(),e)}version(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):M0.V1}schema(e){const t=this.bb.__offset(this.bb_pos,6);return t?(e||new Yd).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}dictionaries(e,t){const i=this.bb.__offset(this.bb_pos,8);return i?(t||new Yw).__init(this.bb.__vector(this.bb_pos+i)+e*24,this.bb):null}dictionariesLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}recordBatches(e,t){const i=this.bb.__offset(this.bb_pos,10);return i?(t||new Yw).__init(this.bb.__vector(this.bb_pos+i)+e*24,this.bb):null}recordBatchesLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,t){const i=this.bb.__offset(this.bb_pos,12);return i?(t||new ka).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startFooter(e){e.startObject(5)}static addVersion(e,t){e.addFieldInt16(0,t,M0.V1)}static addSchema(e,t){e.addFieldOffset(1,t,0)}static addDictionaries(e,t){e.addFieldOffset(2,t,0)}static startDictionariesVector(e,t){e.startVector(24,t,8)}static addRecordBatches(e,t){e.addFieldOffset(3,t,0)}static startRecordBatchesVector(e,t){e.startVector(24,t,8)}static addCustomMetadata(e,t){e.addFieldOffset(4,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let i=t.length-1;i>=0;i--)e.addOffset(t[i]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endFooter(e){return e.endObject()}static finishFooterBuffer(e,t){e.finish(t)}static finishSizePrefixedFooterBuffer(e,t){e.finish(t,void 0,!0)}}class Vr{constructor(e=[],t,i){this.fields=e||[],this.metadata=t||new Map,i||(i=Zw(e)),this.dictionaries=i}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(e=>e.name)}toString(){return`Schema<{ ${this.fields.map((e,t)=>`${t}: ${e}`).join(", ")} }>`}select(e){const t=new Set(e),i=this.fields.filter(n=>t.has(n.name));return new Vr(i,this.metadata)}selectAt(e){const t=e.map(i=>this.fields[i]).filter(Boolean);return new Vr(t,this.metadata)}assign(...e){const t=e[0]instanceof Vr?e[0]:Array.isArray(e[0])?new Vr(e[0]):new Vr(e),i=[...this.fields],n=W1(W1(new Map,this.metadata),t.metadata),s=t.fields.filter(c=>{const h=i.findIndex(m=>m.name===c.name);return~h?(i[h]=c.clone({metadata:W1(W1(new Map,i[h].metadata),c.metadata)}))&&!1:!0}),a=Zw(s,new Map);return new Vr([...i,...s],n,new Map([...this.dictionaries,...a]))}}Vr.prototype.fields=null;Vr.prototype.metadata=null;Vr.prototype.dictionaries=null;class _s{constructor(e,t,i=!1,n){this.name=e,this.type=t,this.nullable=i,this.metadata=n||new Map}static new(...e){let[t,i,n,s]=e;return e[0]&&typeof e[0]=="object"&&({name:t}=e[0],i===void 0&&(i=e[0].type),n===void 0&&(n=e[0].nullable),s===void 0&&(s=e[0].metadata)),new _s(`${t}`,i,n,s)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...e){let[t,i,n,s]=e;return!e[0]||typeof e[0]!="object"?[t=this.name,i=this.type,n=this.nullable,s=this.metadata]=e:{name:t=this.name,type:i=this.type,nullable:n=this.nullable,metadata:s=this.metadata}=e[0],_s.new(t,i,n,s)}}_s.prototype.type=null;_s.prototype.name=null;_s.prototype.nullable=null;_s.prototype.metadata=null;function W1(r,e){return new Map([...r||new Map,...e||new Map])}function Zw(r,e=new Map){for(let t=-1,i=r.length;++t<i;){const s=r[t].type;if(En.isDictionary(s)){if(!e.has(s.id))e.set(s.id,s.dictionary);else if(e.get(s.id)!==s.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}s.children&&s.children.length>0&&Zw(s.children,e)}return e}var TD=bf,c6=dR,d6=C0;class S_{constructor(e,t=ju.V4,i,n){this.schema=e,this.version=t,i&&(this._recordBatches=i),n&&(this._dictionaryBatches=n)}static decode(e){e=new d6(Mr(e));const t=zu.getRootAsFooter(e),i=Vr.decode(t.schema());return new h6(i,t)}static encode(e){const t=new c6,i=Vr.encode(t,e.schema);zu.startRecordBatchesVector(t,e.numRecordBatches);for(const a of[...e.recordBatches()].slice().reverse())Dp.encode(t,a);const n=t.endVector();zu.startDictionariesVector(t,e.numDictionaries);for(const a of[...e.dictionaryBatches()].slice().reverse())Dp.encode(t,a);const s=t.endVector();return zu.startFooter(t),zu.addSchema(t,i),zu.addVersion(t,ju.V4),zu.addRecordBatches(t,n),zu.addDictionaries(t,s),zu.finishFooterBuffer(t,zu.endFooter(t)),t.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let e,t=-1,i=this.numRecordBatches;++t<i;)(e=this.getRecordBatch(t))&&(yield e)}*dictionaryBatches(){for(let e,t=-1,i=this.numDictionaries;++t<i;)(e=this.getDictionaryBatch(t))&&(yield e)}getRecordBatch(e){return e>=0&&e<this.numRecordBatches&&this._recordBatches[e]||null}getDictionaryBatch(e){return e>=0&&e<this.numDictionaries&&this._dictionaryBatches[e]||null}}class h6 extends S_{constructor(e,t){super(e,t.version()),this._footer=t}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(e){if(e>=0&&e<this.numRecordBatches){const t=this._footer.recordBatches(e);if(t)return Dp.decode(t)}return null}getDictionaryBatch(e){if(e>=0&&e<this.numDictionaries){const t=this._footer.dictionaries(e);if(t)return Dp.decode(t)}return null}}class Dp{constructor(e,t,i){this.metaDataLength=e,this.offset=typeof i=="number"?i:i.low,this.bodyLength=typeof t=="number"?t:t.low}static decode(e){return new Dp(e.metaDataLength(),e.bodyLength(),e.offset())}static encode(e,t){const{metaDataLength:i}=t,n=new TD(t.offset,0),s=new TD(t.bodyLength,0);return Yw.createBlock(e,n,i,s)}}const Vs=Object.freeze({done:!0,value:void 0});class xD{constructor(e){this._json=e}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class x2{tee(){return this._getDOMStream().tee()}pipe(e,t){return this._getNodeStream().pipe(e,t)}pipeTo(e,t){return this._getDOMStream().pipeTo(e,t)}pipeThrough(e,t){return this._getDOMStream().pipeThrough(e,t)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class f6 extends x2{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}get closed(){return this._closedPromise}cancel(e){return bn(this,void 0,void 0,function*(){yield this.return(e)})}write(e){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(e):this.resolvers.shift().resolve({done:!1,value:e}))}abort(e){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:e}:this.resolvers.shift().reject({done:!0,value:e}))}close(){if(this._closedPromiseResolve){const{resolvers:e}=this;for(;e.length>0;)e.shift().resolve(Vs);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(e){return pc.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,e)}toNodeStream(e){return pc.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,e)}throw(e){return bn(this,void 0,void 0,function*(){return yield this.abort(e),Vs})}return(e){return bn(this,void 0,void 0,function*(){return yield this.close(),Vs})}read(e){return bn(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return bn(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(...e){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((t,i)=>{this.resolvers.push({resolve:t,reject:i})}):Promise.resolve(Vs)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class mT extends f6{write(e){if((e=Mr(e)).byteLength>0)return super.write(e)}toString(e=!1){return e?Gw(this.toUint8Array(!0)):this.toUint8Array(!1).then(Gw)}toUint8Array(e=!1){return e?gh(this._values)[0]:bn(this,void 0,void 0,function*(){var t,i;const n=[];let s=0;try{for(var a=Um(this),c;c=yield a.next(),!c.done;){const h=c.value;n.push(h),s+=h.byteLength}}catch(h){t={error:h}}finally{try{c&&!c.done&&(i=a.return)&&(yield i.call(a))}finally{if(t)throw t.error}}return gh(n,s)[0]})}}class YT{constructor(e){e&&(this.source=new p6(pc.fromIterable(e)))}[Symbol.iterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class P0{constructor(e){e instanceof P0?this.source=e.source:e instanceof mT?this.source=new ym(pc.fromAsyncIterable(e)):XP(e)?this.source=new ym(pc.fromNodeStream(e)):l2(e)?this.source=new ym(pc.fromDOMStream(e)):qP(e)?this.source=new ym(pc.fromDOMStream(e.body)):U_(e)?this.source=new ym(pc.fromIterable(e)):wp(e)?this.source=new ym(pc.fromAsyncIterable(e)):K0(e)&&(this.source=new ym(pc.fromAsyncIterable(e)))}[Symbol.asyncIterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}get closed(){return this.source.closed}cancel(e){return this.source.cancel(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class p6{constructor(e){this.source=e}cancel(e){this.return(e)}peek(e){return this.next(e,"peek").value}read(e){return this.next(e,"read").value}next(e,t="read"){return this.source.next({cmd:t,size:e})}throw(e){return Object.create(this.source.throw&&this.source.throw(e)||Vs)}return(e){return Object.create(this.source.return&&this.source.return(e)||Vs)}}class ym{constructor(e){this.source=e,this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}cancel(e){return bn(this,void 0,void 0,function*(){yield this.return(e)})}get closed(){return this._closedPromise}read(e){return bn(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return bn(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(e,t="read"){return bn(this,void 0,void 0,function*(){return yield this.source.next({cmd:t,size:e})})}throw(e){return bn(this,void 0,void 0,function*(){const t=this.source.throw&&(yield this.source.throw(e))||Vs;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)})}return(e){return bn(this,void 0,void 0,function*(){const t=this.source.return&&(yield this.source.return(e))||Vs;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)})}}class SD extends YT{constructor(e,t){super(),this.position=0,this.buffer=Mr(e),this.size=typeof t>"u"?this.buffer.byteLength:t}readInt32(e){const{buffer:t,byteOffset:i}=this.readAt(e,4);return new DataView(t,i).getInt32(0,!0)}seek(e){return this.position=Math.min(e,this.size),e<this.size}read(e){const{buffer:t,size:i,position:n}=this;return t&&n<i?(typeof e!="number"&&(e=Number.POSITIVE_INFINITY),this.position=Math.min(i,n+Math.min(i-n,e)),t.subarray(n,this.position)):null}readAt(e,t){const i=this.buffer,n=Math.min(this.size,e+t);return i?i.subarray(e,n):new Uint8Array(t)}close(){this.buffer&&(this.buffer=null)}throw(e){return this.close(),{done:!0,value:e}}return(e){return this.close(),{done:!0,value:e}}}class QT extends P0{constructor(e,t){super(),this.position=0,this._handle=e,typeof t=="number"?this.size=t:this._pending=bn(this,void 0,void 0,function*(){this.size=(yield e.stat()).size,delete this._pending})}readInt32(e){return bn(this,void 0,void 0,function*(){const{buffer:t,byteOffset:i}=yield this.readAt(e,4);return new DataView(t,i).getInt32(0,!0)})}seek(e){return bn(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(e,this.size),e<this.size})}read(e){return bn(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:t,size:i,position:n}=this;if(t&&n<i){typeof e!="number"&&(e=Number.POSITIVE_INFINITY);let s=n,a=0,c=0;const h=Math.min(i,s+Math.min(i-s,e)),m=new Uint8Array(Math.max(0,(this.position=h)-s));for(;(s+=c)<h&&(a+=c)<m.byteLength;)({bytesRead:c}=yield t.read(m,a,m.byteLength-a,s));return m}return null})}readAt(e,t){return bn(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:i,size:n}=this;if(i&&e+t<n){const s=Math.min(n,e+t),a=new Uint8Array(s-e);return(yield i.read(a,0,t,e)).buffer}return new Uint8Array(t)})}close(){return bn(this,void 0,void 0,function*(){const e=this._handle;this._handle=null,e&&(yield e.close())})}throw(e){return bn(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:e}})}return(e){return bn(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:e}})}}const m6=65536;function i0(r){return r<0&&(r=4294967295+r+1),`0x${r.toString(16)}`}const L0=8,S2=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class fR{constructor(e){this.buffer=e}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(e){const t=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),i=new Uint32Array([e.buffer[1]>>>16,e.buffer[1]&65535,e.buffer[0]>>>16,e.buffer[0]&65535]);let n=t[3]*i[3];this.buffer[0]=n&65535;let s=n>>>16;return n=t[2]*i[3],s+=n,n=t[3]*i[2]>>>0,s+=n,this.buffer[0]+=s<<16,this.buffer[1]=s>>>0<n?m6:0,this.buffer[1]+=s>>>16,this.buffer[1]+=t[1]*i[3]+t[2]*i[2]+t[3]*i[1],this.buffer[1]+=t[0]*i[3]+t[1]*i[2]+t[2]*i[1]+t[3]*i[0]<<16,this}_plus(e){const t=this.buffer[0]+e.buffer[0]>>>0;this.buffer[1]+=e.buffer[1],t<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=t}lessThan(e){return this.buffer[1]<e.buffer[1]||this.buffer[1]===e.buffer[1]&&this.buffer[0]<e.buffer[0]}equals(e){return this.buffer[1]===e.buffer[1]&&this.buffer[0]==e.buffer[0]}greaterThan(e){return e.lessThan(this)}hex(){return`${i0(this.buffer[1])} ${i0(this.buffer[0])}`}}class jr extends fR{times(e){return this._times(e),this}plus(e){return this._plus(e),this}static from(e,t=new Uint32Array(2)){return jr.fromString(typeof e=="string"?e:e.toString(),t)}static fromNumber(e,t=new Uint32Array(2)){return jr.fromString(e.toString(),t)}static fromString(e,t=new Uint32Array(2)){const i=e.length,n=new jr(t);for(let s=0;s<i;){const a=L0<i-s?L0:i-s,c=new jr(new Uint32Array([Number.parseInt(e.slice(s,s+a),10),0])),h=new jr(new Uint32Array([S2[a],0]));n.times(h),n.plus(c),s+=a}return n}static convertArray(e){const t=new Uint32Array(e.length*2);for(let i=-1,n=e.length;++i<n;)jr.from(e[i],new Uint32Array(t.buffer,t.byteOffset+2*i*4,2));return t}static multiply(e,t){return new jr(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new jr(new Uint32Array(e.buffer)).plus(t)}}class Xl extends fR{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(e){return this._times(e),this}plus(e){return this._plus(e),this}lessThan(e){const t=this.buffer[1]<<0,i=e.buffer[1]<<0;return t<i||t===i&&this.buffer[0]<e.buffer[0]}static from(e,t=new Uint32Array(2)){return Xl.fromString(typeof e=="string"?e:e.toString(),t)}static fromNumber(e,t=new Uint32Array(2)){return Xl.fromString(e.toString(),t)}static fromString(e,t=new Uint32Array(2)){const i=e.startsWith("-"),n=e.length,s=new Xl(t);for(let a=i?1:0;a<n;){const c=L0<n-a?L0:n-a,h=new Xl(new Uint32Array([Number.parseInt(e.slice(a,a+c),10),0])),m=new Xl(new Uint32Array([S2[c],0]));s.times(m),s.plus(h),a+=c}return i?s.negate():s}static convertArray(e){const t=new Uint32Array(e.length*2);for(let i=-1,n=e.length;++i<n;)Xl.from(e[i],new Uint32Array(t.buffer,t.byteOffset+2*i*4,2));return t}static multiply(e,t){return new Xl(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new Xl(new Uint32Array(e.buffer)).plus(t)}}class Qd{constructor(e){this.buffer=e}high(){return new Xl(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Xl(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(e){const t=new jr(new Uint32Array([this.buffer[3],0])),i=new jr(new Uint32Array([this.buffer[2],0])),n=new jr(new Uint32Array([this.buffer[1],0])),s=new jr(new Uint32Array([this.buffer[0],0])),a=new jr(new Uint32Array([e.buffer[3],0])),c=new jr(new Uint32Array([e.buffer[2],0])),h=new jr(new Uint32Array([e.buffer[1],0])),m=new jr(new Uint32Array([e.buffer[0],0]));let v=jr.multiply(s,m);this.buffer[0]=v.low();const b=new jr(new Uint32Array([v.high(),0]));return v=jr.multiply(n,m),b.plus(v),v=jr.multiply(s,h),b.plus(v),this.buffer[1]=b.low(),this.buffer[3]=b.lessThan(v)?1:0,this.buffer[2]=b.high(),new jr(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(jr.multiply(i,m)).plus(jr.multiply(n,h)).plus(jr.multiply(s,c)),this.buffer[3]+=jr.multiply(t,m).plus(jr.multiply(i,h)).plus(jr.multiply(n,c)).plus(jr.multiply(s,a)).low(),this}plus(e){const t=new Uint32Array(4);return t[3]=this.buffer[3]+e.buffer[3]>>>0,t[2]=this.buffer[2]+e.buffer[2]>>>0,t[1]=this.buffer[1]+e.buffer[1]>>>0,t[0]=this.buffer[0]+e.buffer[0]>>>0,t[0]<this.buffer[0]>>>0&&++t[1],t[1]<this.buffer[1]>>>0&&++t[2],t[2]<this.buffer[2]>>>0&&++t[3],this.buffer[3]=t[3],this.buffer[2]=t[2],this.buffer[1]=t[1],this.buffer[0]=t[0],this}hex(){return`${i0(this.buffer[3])} ${i0(this.buffer[2])} ${i0(this.buffer[1])} ${i0(this.buffer[0])}`}static multiply(e,t){return new Qd(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new Qd(new Uint32Array(e.buffer)).plus(t)}static from(e,t=new Uint32Array(4)){return Qd.fromString(typeof e=="string"?e:e.toString(),t)}static fromNumber(e,t=new Uint32Array(4)){return Qd.fromString(e.toString(),t)}static fromString(e,t=new Uint32Array(4)){const i=e.startsWith("-"),n=e.length,s=new Qd(t);for(let a=i?1:0;a<n;){const c=L0<n-a?L0:n-a,h=new Qd(new Uint32Array([Number.parseInt(e.slice(a,a+c),10),0,0,0])),m=new Qd(new Uint32Array([S2[c],0,0,0]));s.times(m),s.plus(h),a+=c}return i?s.negate():s}static convertArray(e){const t=new Uint32Array(e.length*4);for(let i=-1,n=e.length;++i<n;)Qd.from(e[i],new Uint32Array(t.buffer,t.byteOffset+4*4*i,4));return t}}class pR extends vr{constructor(e,t,i,n){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=e,this.nodes=t,this.buffers=i,this.dictionaries=n}visit(e){return super.visit(e instanceof _s?e.type:e)}visitNull(e,{length:t}=this.nextFieldNode()){return gr({type:e,length:t})}visitBool(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitInt(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitFloat(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitUtf8(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitBinary(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitFixedSizeBinary(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitDate(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitTimestamp(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitTime(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitDecimal(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitList(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),child:this.visit(e.children[0])})}visitStruct(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),children:this.visitMany(e.children)})}visitUnion(e){return e.mode===Gu.Sparse?this.visitSparseUnion(e):this.visitDenseUnion(e)}visitDenseUnion(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),typeIds:this.readTypeIds(e),valueOffsets:this.readOffsets(e),children:this.visitMany(e.children)})}visitSparseUnion(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),typeIds:this.readTypeIds(e),children:this.visitMany(e.children)})}visitDictionary(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e.indices),dictionary:this.readDictionary(e)})}visitInterval(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitFixedSizeList(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),child:this.visit(e.children[0])})}visitMap(e,{length:t,nullCount:i}=this.nextFieldNode()){return gr({type:e,length:t,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),child:this.visit(e.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(e,t,i=this.nextBufferRange()){return t>0&&this.readData(e,i)||new Uint8Array(0)}readOffsets(e,t){return this.readData(e,t)}readTypeIds(e,t){return this.readData(e,t)}readData(e,{length:t,offset:i}=this.nextBufferRange()){return this.bytes.subarray(i,i+t)}readDictionary(e){return this.dictionaries.get(e.id)}}class g6 extends pR{constructor(e,t,i,n){super(new Uint8Array(0),t,i,n),this.sources=e}readNullBitmap(e,t,{offset:i}=this.nextBufferRange()){return t<=0?new Uint8Array(0):zT(this.sources[i])}readOffsets(e,{offset:t}=this.nextBufferRange()){return es(Uint8Array,es(Int32Array,this.sources[t]))}readTypeIds(e,{offset:t}=this.nextBufferRange()){return es(Uint8Array,es(e.ArrayType,this.sources[t]))}readData(e,{offset:t}=this.nextBufferRange()){const{sources:i}=this;return En.isTimestamp(e)||(En.isInt(e)||En.isTime(e))&&e.bitWidth===64||En.isDate(e)&&e.unit===wf.MILLISECOND?es(Uint8Array,Xl.convertArray(i[t])):En.isDecimal(e)?es(Uint8Array,Qd.convertArray(i[t])):En.isBinary(e)||En.isFixedSizeBinary(e)?v6(i[t]):En.isBool(e)?zT(i[t]):En.isUtf8(e)?o2(i[t].join("")):es(Uint8Array,es(e.ArrayType,i[t].map(n=>+n)))}}function v6(r){const e=r.join(""),t=new Uint8Array(e.length/2);for(let i=0;i<e.length;i+=2)t[i>>1]=Number.parseInt(e.slice(i,i+2),16);return t}class In extends vr{compareSchemas(e,t){return e===t||t instanceof e.constructor&&this.compareManyFields(e.fields,t.fields)}compareManyFields(e,t){return e===t||Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((i,n)=>this.compareFields(i,t[n]))}compareFields(e,t){return e===t||t instanceof e.constructor&&e.name===t.name&&e.nullable===t.nullable&&this.visit(e.type,t.type)}}function ru(r,e){return e instanceof r.constructor}function V_(r,e){return r===e||ru(r,e)}function If(r,e){return r===e||ru(r,e)&&r.bitWidth===e.bitWidth&&r.isSigned===e.isSigned}function $x(r,e){return r===e||ru(r,e)&&r.precision===e.precision}function y6(r,e){return r===e||ru(r,e)&&r.byteWidth===e.byteWidth}function A2(r,e){return r===e||ru(r,e)&&r.unit===e.unit}function z_(r,e){return r===e||ru(r,e)&&r.unit===e.unit&&r.timezone===e.timezone}function H_(r,e){return r===e||ru(r,e)&&r.unit===e.unit&&r.bitWidth===e.bitWidth}function _6(r,e){return r===e||ru(r,e)&&r.children.length===e.children.length&&Ip.compareManyFields(r.children,e.children)}function b6(r,e){return r===e||ru(r,e)&&r.children.length===e.children.length&&Ip.compareManyFields(r.children,e.children)}function w2(r,e){return r===e||ru(r,e)&&r.mode===e.mode&&r.typeIds.every((t,i)=>t===e.typeIds[i])&&Ip.compareManyFields(r.children,e.children)}function T6(r,e){return r===e||ru(r,e)&&r.id===e.id&&r.isOrdered===e.isOrdered&&Ip.visit(r.indices,e.indices)&&Ip.visit(r.dictionary,e.dictionary)}function E2(r,e){return r===e||ru(r,e)&&r.unit===e.unit}function x6(r,e){return r===e||ru(r,e)&&r.listSize===e.listSize&&r.children.length===e.children.length&&Ip.compareManyFields(r.children,e.children)}function S6(r,e){return r===e||ru(r,e)&&r.keysSorted===e.keysSorted&&r.children.length===e.children.length&&Ip.compareManyFields(r.children,e.children)}In.prototype.visitNull=V_;In.prototype.visitBool=V_;In.prototype.visitInt=If;In.prototype.visitInt8=If;In.prototype.visitInt16=If;In.prototype.visitInt32=If;In.prototype.visitInt64=If;In.prototype.visitUint8=If;In.prototype.visitUint16=If;In.prototype.visitUint32=If;In.prototype.visitUint64=If;In.prototype.visitFloat=$x;In.prototype.visitFloat16=$x;In.prototype.visitFloat32=$x;In.prototype.visitFloat64=$x;In.prototype.visitUtf8=V_;In.prototype.visitBinary=V_;In.prototype.visitFixedSizeBinary=y6;In.prototype.visitDate=A2;In.prototype.visitDateDay=A2;In.prototype.visitDateMillisecond=A2;In.prototype.visitTimestamp=z_;In.prototype.visitTimestampSecond=z_;In.prototype.visitTimestampMillisecond=z_;In.prototype.visitTimestampMicrosecond=z_;In.prototype.visitTimestampNanosecond=z_;In.prototype.visitTime=H_;In.prototype.visitTimeSecond=H_;In.prototype.visitTimeMillisecond=H_;In.prototype.visitTimeMicrosecond=H_;In.prototype.visitTimeNanosecond=H_;In.prototype.visitDecimal=V_;In.prototype.visitList=_6;In.prototype.visitStruct=b6;In.prototype.visitUnion=w2;In.prototype.visitDenseUnion=w2;In.prototype.visitSparseUnion=w2;In.prototype.visitDictionary=T6;In.prototype.visitInterval=E2;In.prototype.visitIntervalDayTime=E2;In.prototype.visitIntervalYearMonth=E2;In.prototype.visitFixedSizeList=x6;In.prototype.visitMap=S6;const Ip=new In;function Jw(r,e){return Ip.compareSchemas(r,e)}function LA(r,e){return A6(r,e.map(t=>t.data.concat()))}function A6(r,e){const t=[...r.fields],i=[],n={numBatches:e.reduce((b,x)=>Math.max(b,x.length),0)};let s=0,a=0,c=-1;const h=e.length;let m,v=[];for(;n.numBatches-- >0;){for(a=Number.POSITIVE_INFINITY,c=-1;++c<h;)v[c]=m=e[c].shift(),a=Math.min(a,m?m.length:a);Number.isFinite(a)&&(v=w6(t,a,v,e,n),a>0&&(i[s++]=gr({type:new hl(t),length:a,nullCount:0,children:v.slice()})))}return[r=r.assign(t),i.map(b=>new Kl(r,b))]}function w6(r,e,t,i,n){var s;const a=(e+63&-64)>>3;for(let c=-1,h=i.length;++c<h;){const m=t[c],v=m==null?void 0:m.length;if(v>=e)v===e?t[c]=m:(t[c]=m.slice(0,e),n.numBatches=Math.max(n.numBatches,i[c].unshift(m.slice(e,v-e))));else{const b=r[c];r[c]=b.clone({nullable:!0}),t[c]=(s=m==null?void 0:m._changeLengthAndBackfillNullBitmap(e))!==null&&s!==void 0?s:gr({type:b.type,length:e,nullCount:e,nullBitmap:new Uint8Array(a)})}}return t}var mR;class ul{constructor(...e){var t,i;if(e.length===0)return this.batches=[],this.schema=new Vr([]),this._offsets=[0],this;let n,s;e[0]instanceof Vr&&(n=e.shift()),e[e.length-1]instanceof Uint32Array&&(s=e.pop());const a=h=>{if(h){if(h instanceof Kl)return[h];if(h instanceof ul)return h.batches;if(h instanceof ls){if(h.type instanceof hl)return[new Kl(new Vr(h.type.children),h)]}else{if(Array.isArray(h))return h.flatMap(m=>a(m));if(typeof h[Symbol.iterator]=="function")return[...h].flatMap(m=>a(m));if(typeof h=="object"){const m=Object.keys(h),v=m.map(C=>new Ur([h[C]])),b=new Vr(m.map((C,B)=>new _s(String(C),v[B].type))),[,x]=LA(b,v);return x.length===0?[new Kl(h)]:x}}}return[]},c=e.flatMap(h=>a(h));if(n=(i=n??((t=c[0])===null||t===void 0?void 0:t.schema))!==null&&i!==void 0?i:new Vr([]),!(n instanceof Vr))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const h of c){if(!(h instanceof Kl))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!Jw(n,h.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=n,this.batches=c,this._offsets=s??eR(this.data)}get data(){return this.batches.map(({data:e})=>e)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((e,t)=>e+t.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=JL(this.data)),this._nullCount}isValid(e){return!1}get(e){return null}set(e,t){}indexOf(e,t){return-1}getByteLength(e){return 0}[Symbol.iterator](){return this.batches.length>0?T2.visit(new Ur(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...e){const t=this.schema,i=this.data.concat(e.flatMap(({data:n})=>n));return new ul(t,i.map(n=>new Kl(t,n)))}slice(e,t){const i=this.schema;[e,t]=KL({length:this.numRows},e,t);const n=tR(this.data,this._offsets,e,t);return new ul(i,n.map(s=>new Kl(i,s)))}getChild(e){return this.getChildAt(this.schema.fields.findIndex(t=>t.name===e))}getChildAt(e){if(e>-1&&e<this.schema.fields.length){const t=this.data.map(i=>i.children[e]);if(t.length===0){const{type:i}=this.schema.fields[e],n=gr({type:i,length:0,nullCount:0});t.push(n._changeLengthAndBackfillNullBitmap(this.numRows))}return new Ur(t)}return null}setChild(e,t){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(n=>n.name===e),t)}setChildAt(e,t){let i=this.schema,n=[...this.batches];if(e>-1&&e<this.numCols){t||(t=new Ur([gr({type:new Cp,length:this.numRows})]));const s=i.fields.slice(),a=s[e].clone({type:t.type}),c=this.schema.fields.map((h,m)=>this.getChildAt(m));[s[e],c[e]]=[a,t],[i,n]=LA(i,c)}return new ul(i,n)}select(e){const t=this.schema.fields.reduce((i,n,s)=>i.set(n.name,s),new Map);return this.selectAt(e.map(i=>t.get(i)).filter(i=>i>-1))}selectAt(e){const t=this.schema.selectAt(e),i=this.batches.map(n=>n.selectAt(e));return new ul(t,i)}assign(e){const t=this.schema.fields,[i,n]=e.schema.fields.reduce((c,h,m)=>{const[v,b]=c,x=t.findIndex(C=>C.name===h.name);return~x?b[x]=m:v.push(m),c},[[],[]]),s=this.schema.assign(e.schema),a=[...t.map((c,h)=>[h,n[h]]).map(([c,h])=>h===void 0?this.getChildAt(c):e.getChildAt(h)),...i.map(c=>e.getChildAt(c))].filter(Boolean);return new ul(...LA(s,a))}}mR=Symbol.toStringTag;ul[mR]=(r=>(r.schema=null,r.batches=[],r._offsets=new Uint32Array([0]),r._nullCount=-1,r[Symbol.isConcatSpreadable]=!0,r.isValid=f0(b2),r.get=f0(nu.getVisitFn(ht.Struct)),r.set=iR(yc.getVisitFn(ht.Struct)),r.indexOf=nR(HT.getVisitFn(ht.Struct)),r.getByteLength=f0(vh.getVisitFn(ht.Struct)),"Table"))(ul.prototype);var gR;let Kl=class Ky{constructor(...e){switch(e.length){case 2:{if([this.schema]=e,!(this.schema instanceof Vr))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=gr({nullCount:0,type:new hl(this.schema.fields),children:this.schema.fields.map(t=>gr({type:t.type,nullCount:0}))})]=e,!(this.data instanceof ls))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=AD(this.schema,this.data.children);break}case 1:{const[t]=e,{fields:i,children:n,length:s}=Object.keys(t).reduce((h,m,v)=>(h.children[v]=t[m],h.length=Math.max(h.length,t[m].length),h.fields[v]=_s.new({name:m,type:t[m].type,nullable:!0}),h),{length:0,fields:new Array,children:new Array}),a=new Vr(i),c=gr({type:new hl(i),length:s,children:n,nullCount:0});[this.schema,this.data]=AD(a,c.children,s);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=vR(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(e){return this.data.getValid(e)}get(e){return nu.visit(this.data,e)}set(e,t){return yc.visit(this.data,e,t)}indexOf(e,t){return HT.visit(this.data,e,t)}getByteLength(e){return vh.visit(this.data,e)}[Symbol.iterator](){return T2.visit(new Ur([this.data]))}toArray(){return[...this]}concat(...e){return new ul(this.schema,[this,...e])}slice(e,t){const[i]=new Ur([this.data]).slice(e,t).data;return new Ky(this.schema,i)}getChild(e){var t;return this.getChildAt((t=this.schema.fields)===null||t===void 0?void 0:t.findIndex(i=>i.name===e))}getChildAt(e){return e>-1&&e<this.schema.fields.length?new Ur([this.data.children[e]]):null}setChild(e,t){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(n=>n.name===e),t)}setChildAt(e,t){let i=this.schema,n=this.data;if(e>-1&&e<this.numCols){t||(t=new Ur([gr({type:new Cp,length:this.numRows})]));const s=i.fields.slice(),a=n.children.slice(),c=s[e].clone({type:t.type});[s[e],a[e]]=[c,t.data[0]],i=new Vr(s,new Map(this.schema.metadata)),n=gr({type:new hl(s),children:a})}return new Ky(i,n)}select(e){const t=this.schema.select(e),i=new hl(t.fields),n=[];for(const s of e){const a=this.schema.fields.findIndex(c=>c.name===s);~a&&(n[a]=this.data.children[a])}return new Ky(t,gr({type:i,length:this.numRows,children:n}))}selectAt(e){const t=this.schema.selectAt(e),i=e.map(s=>this.data.children[s]).filter(Boolean),n=gr({type:new hl(t.fields),length:this.numRows,children:i});return new Ky(t,n)}};gR=Symbol.toStringTag;Kl[gR]=(r=>(r._nullCount=-1,r[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(Kl.prototype);function AD(r,e,t=e.reduce((i,n)=>Math.max(i,n.length),0)){var i;const n=[...r.fields],s=[...e],a=(t+63&-64)>>3;for(const[c,h]of r.fields.entries()){const m=e[c];(!m||m.length!==t)&&(n[c]=h.clone({nullable:!0}),s[c]=(i=m==null?void 0:m._changeLengthAndBackfillNullBitmap(t))!==null&&i!==void 0?i:gr({type:h.type,length:t,nullCount:t,nullBitmap:new Uint8Array(a)}))}return[r.assign(n),gr({type:new hl(n),length:t,children:s})]}function vR(r,e,t=new Map){for(let i=-1,n=r.length;++i<n;){const a=r[i].type,c=e[i];if(En.isDictionary(a)){if(!t.has(a.id))c.dictionary&&t.set(a.id,c.dictionary);else if(t.get(a.id)!==c.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}a.children&&a.children.length>0&&vR(a.children,c.children,t)}return t}class C2 extends Kl{constructor(e){const t=e.fields.map(n=>gr({type:n.type})),i=gr({type:new hl(e.fields),nullCount:0,children:t});super(e,i)}}var KT;(function(r){r[r.BUFFER=0]="BUFFER"})(KT||(KT={}));var ZT;(function(r){r[r.LZ4_FRAME=0]="LZ4_FRAME",r[r.ZSTD=1]="ZSTD"})(ZT||(ZT={}));class Tp{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBodyCompression(e,t){return(t||new Tp).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBodyCompression(e,t){return e.setPosition(e.position()+ns),(t||new Tp).__init(e.readInt32(e.position())+e.position(),e)}codec(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):ZT.LZ4_FRAME}method(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt8(this.bb_pos+e):KT.BUFFER}static startBodyCompression(e){e.startObject(2)}static addCodec(e,t){e.addFieldInt8(0,t,ZT.LZ4_FRAME)}static addMethod(e,t){e.addFieldInt8(1,t,KT.BUFFER)}static endBodyCompression(e){return e.endObject()}static createBodyCompression(e,t,i){return Tp.startBodyCompression(e),Tp.addCodec(e,t),Tp.addMethod(e,i),Tp.endBodyCompression(e)}}let yR=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(e,t,i){return e.prep(8,16),e.writeInt64(i),e.writeInt64(t),e.offset()}},_R=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(e,t,i){return e.prep(8,16),e.writeInt64(i),e.writeInt64(t),e.offset()}},hf=class eE{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsRecordBatch(e,t){return(t||new eE).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsRecordBatch(e,t){return e.setPosition(e.position()+ns),(t||new eE).__init(e.readInt32(e.position())+e.position(),e)}length(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}nodes(e,t){const i=this.bb.__offset(this.bb_pos,6);return i?(t||new _R).__init(this.bb.__vector(this.bb_pos+i)+e*16,this.bb):null}nodesLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}buffers(e,t){const i=this.bb.__offset(this.bb_pos,8);return i?(t||new yR).__init(this.bb.__vector(this.bb_pos+i)+e*16,this.bb):null}buffersLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}compression(e){const t=this.bb.__offset(this.bb_pos,10);return t?(e||new Tp).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}static startRecordBatch(e){e.startObject(4)}static addLength(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}static addNodes(e,t){e.addFieldOffset(1,t,0)}static startNodesVector(e,t){e.startVector(16,t,8)}static addBuffers(e,t){e.addFieldOffset(2,t,0)}static startBuffersVector(e,t){e.startVector(16,t,8)}static addCompression(e,t){e.addFieldOffset(3,t,0)}static endRecordBatch(e){return e.endObject()}},e0=class tE{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDictionaryBatch(e,t){return(t||new tE).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryBatch(e,t){return e.setPosition(e.position()+ns),(t||new tE).__init(e.readInt32(e.position())+e.position(),e)}id(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}data(e){const t=this.bb.__offset(this.bb_pos,6);return t?(e||new hf).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}isDelta(){const e=this.bb.__offset(this.bb_pos,8);return e?!!this.bb.readInt8(this.bb_pos+e):!1}static startDictionaryBatch(e){e.startObject(3)}static addId(e,t){e.addFieldInt64(0,t,e.createLong(0,0))}static addData(e,t){e.addFieldOffset(1,t,0)}static addIsDelta(e,t){e.addFieldInt8(2,+t,0)}static endDictionaryBatch(e){return e.endObject()}};var JT;(function(r){r[r.NONE=0]="NONE",r[r.Schema=1]="Schema",r[r.DictionaryBatch=2]="DictionaryBatch",r[r.RecordBatch=3]="RecordBatch",r[r.Tensor=4]="Tensor",r[r.SparseTensor=5]="SparseTensor"})(JT||(JT={}));let mp=class Xd{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMessage(e,t){return(t||new Xd).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMessage(e,t){return e.setPosition(e.position()+ns),(t||new Xd).__init(e.readInt32(e.position())+e.position(),e)}version(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):M0.V1}headerType(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):JT.NONE}header(e){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__union(e,this.bb_pos+t):null}bodyLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb_pos+e):this.bb.createLong(0,0)}customMetadata(e,t){const i=this.bb.__offset(this.bb_pos,12);return i?(t||new ka).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startMessage(e){e.startObject(5)}static addVersion(e,t){e.addFieldInt16(0,t,M0.V1)}static addHeaderType(e,t){e.addFieldInt8(1,t,JT.NONE)}static addHeader(e,t){e.addFieldOffset(2,t,0)}static addBodyLength(e,t){e.addFieldInt64(3,t,e.createLong(0,0))}static addCustomMetadata(e,t){e.addFieldOffset(4,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let i=t.length-1;i>=0;i--)e.addOffset(t[i]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endMessage(e){return e.endObject()}static finishMessageBuffer(e,t){e.finish(t)}static finishSizePrefixedMessageBuffer(e,t){e.finish(t,void 0,!0)}static createMessage(e,t,i,n,s,a){return Xd.startMessage(e),Xd.addVersion(e,t),Xd.addHeaderType(e,i),Xd.addHeader(e,n),Xd.addBodyLength(e,s),Xd.addCustomMetadata(e,a),Xd.endMessage(e)}};var E6=bf;class C6 extends vr{visit(e,t){return e==null||t==null?void 0:super.visit(e,t)}visitNull(e,t){return Rm.startNull(t),Rm.endNull(t)}visitInt(e,t){return Hu.startInt(t),Hu.addBitWidth(t,e.bitWidth),Hu.addIsSigned(t,e.isSigned),Hu.endInt(t)}visitFloat(e,t){return sh.startFloatingPoint(t),sh.addPrecision(t,e.precision),sh.endFloatingPoint(t)}visitBinary(e,t){return Im.startBinary(t),Im.endBinary(t)}visitBool(e,t){return Pm.startBool(t),Pm.endBool(t)}visitUtf8(e,t){return Om.startUtf8(t),Om.endUtf8(t)}visitDecimal(e,t){return Yl.startDecimal(t),Yl.addScale(t,e.scale),Yl.addPrecision(t,e.precision),Yl.addBitWidth(t,e.bitWidth),Yl.endDecimal(t)}visitDate(e,t){return hT.startDate(t),hT.addUnit(t,e.unit),hT.endDate(t)}visitTime(e,t){return Qy.startTime(t),Qy.addUnit(t,e.unit),Qy.addBitWidth(t,e.bitWidth),Qy.endTime(t)}visitTimestamp(e,t){const i=e.timezone&&t.createString(e.timezone)||void 0;return mc.startTimestamp(t),mc.addUnit(t,e.unit),i!==void 0&&mc.addTimezone(t,i),mc.endTimestamp(t)}visitInterval(e,t){return ah.startInterval(t),ah.addUnit(t,e.unit),ah.endInterval(t)}visitList(e,t){return Lm.startList(t),Lm.endList(t)}visitStruct(e,t){return km.startStruct_(t),km.endStruct_(t)}visitUnion(e,t){Ql.startTypeIdsVector(t,e.typeIds.length);const i=Ql.createTypeIdsVector(t,e.typeIds);return Ql.startUnion(t),Ql.addMode(t,e.mode),Ql.addTypeIds(t,i),Ql.endUnion(t)}visitDictionary(e,t){const i=this.visit(e.indices,t);return mf.startDictionaryEncoding(t),mf.addId(t,new E6(e.id,0)),mf.addIsOrdered(t,e.isOrdered),i!==void 0&&mf.addIndexType(t,i),mf.endDictionaryEncoding(t)}visitFixedSizeBinary(e,t){return nh.startFixedSizeBinary(t),nh.addByteWidth(t,e.byteWidth),nh.endFixedSizeBinary(t)}visitFixedSizeList(e,t){return rh.startFixedSizeList(t),rh.addListSize(t,e.listSize),rh.endFixedSizeList(t)}visitMap(e,t){return fT.startMap(t),fT.addKeysSorted(t,e.keysSorted),fT.endMap(t)}}const RA=new C6;function M6(r,e=new Map){return new Vr(I6(r,e),gT(r.customMetadata),e)}function bR(r){return new $u(r.count,TR(r.columns),xR(r.columns))}function D6(r){return new yh(bR(r.data),r.id,r.isDelta)}function I6(r,e){return(r.fields||[]).filter(Boolean).map(t=>_s.fromJSON(t,e))}function wD(r,e){return(r.children||[]).filter(Boolean).map(t=>_s.fromJSON(t,e))}function TR(r){return(r||[]).reduce((e,t)=>[...e,new Jm(t.count,P6(t.VALIDITY)),...TR(t.children)],[])}function xR(r,e=[]){for(let t=-1,i=(r||[]).length;++t<i;){const n=r[t];n.VALIDITY&&e.push(new lh(e.length,n.VALIDITY.length)),n.TYPE&&e.push(new lh(e.length,n.TYPE.length)),n.OFFSET&&e.push(new lh(e.length,n.OFFSET.length)),n.DATA&&e.push(new lh(e.length,n.DATA.length)),e=xR(n.children,e)}return e}function P6(r){return(r||[]).reduce((e,t)=>e+ +(t===0),0)}function L6(r,e){let t,i,n,s,a,c;return!e||!(s=r.dictionary)?(a=CD(r,wD(r,e)),n=new _s(r.name,a,r.nullable,gT(r.customMetadata))):e.has(t=s.id)?(i=(i=s.indexType)?ED(i):new b_,c=new E0(e.get(t),i,t,s.isOrdered),n=new _s(r.name,c,r.nullable,gT(r.customMetadata))):(i=(i=s.indexType)?ED(i):new b_,e.set(t,a=CD(r,wD(r,e))),c=new E0(a,i,t,s.isOrdered),n=new _s(r.name,c,r.nullable,gT(r.customMetadata))),n||null}function gT(r){return new Map(Object.entries(r||{}))}function ED(r){return new Mp(r.isSigned,r.bitWidth)}function CD(r,e){const t=r.type.name;switch(t){case"NONE":return new Cp;case"null":return new Cp;case"binary":return new DT;case"utf8":return new IT;case"bool":return new PT;case"list":return new FT((e||[])[0]);case"struct":return new hl(e||[]);case"struct_":return new hl(e||[])}switch(t){case"int":{const i=r.type;return new Mp(i.isSigned,i.bitWidth)}case"floatingpoint":{const i=r.type;return new T_(tu[i.precision])}case"decimal":{const i=r.type;return new LT(i.scale,i.precision,i.bitWidth)}case"date":{const i=r.type;return new RT(wf[i.unit])}case"time":{const i=r.type;return new x_(Dr[i.unit],i.bitWidth)}case"timestamp":{const i=r.type;return new kT(Dr[i.unit],i.timezone)}case"interval":{const i=r.type;return new OT(Ep[i.unit])}case"union":{const i=r.type;return new BT(Gu[i.mode],i.typeIds||[],e||[])}case"fixedsizebinary":{const i=r.type;return new NT(i.byteWidth)}case"fixedsizelist":{const i=r.type;return new UT(i.listSize,(e||[])[0])}case"map":{const i=r.type;return new VT((e||[])[0],i.keysSorted)}}throw new Error(`Unrecognized type: "${t}"`)}var Qm=bf,R6=dR,k6=C0;class fl{constructor(e,t,i,n){this._version=t,this._headerType=i,this.body=new Uint8Array(0),n&&(this._createHeader=()=>n),this._bodyLength=typeof e=="number"?e:e.low}static fromJSON(e,t){const i=new fl(0,ju.V4,t);return i._createHeader=O6(e,t),i}static decode(e){e=new k6(Mr(e));const t=mp.getRootAsMessage(e),i=t.bodyLength(),n=t.version(),s=t.headerType(),a=new fl(i,n,s);return a._createHeader=F6(t,s),a}static encode(e){const t=new R6;let i=-1;return e.isSchema()?i=Vr.encode(t,e.header()):e.isRecordBatch()?i=$u.encode(t,e.header()):e.isDictionaryBatch()&&(i=yh.encode(t,e.header())),mp.startMessage(t),mp.addVersion(t,ju.V4),mp.addHeader(t,i),mp.addHeaderType(t,e.headerType),mp.addBodyLength(t,new Qm(e.bodyLength,0)),mp.finishMessageBuffer(t,mp.endMessage(t)),t.asUint8Array()}static from(e,t=0){if(e instanceof Vr)return new fl(0,ju.V4,Nr.Schema,e);if(e instanceof $u)return new fl(t,ju.V4,Nr.RecordBatch,e);if(e instanceof yh)return new fl(t,ju.V4,Nr.DictionaryBatch,e);throw new Error(`Unrecognized Message header: ${e}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===Nr.Schema}isRecordBatch(){return this.headerType===Nr.RecordBatch}isDictionaryBatch(){return this.headerType===Nr.DictionaryBatch}}class $u{constructor(e,t,i){this._nodes=t,this._buffers=i,this._length=typeof e=="number"?e:e.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}}class yh{constructor(e,t,i=!1){this._data=e,this._isDelta=i,this._id=typeof t=="number"?t:t.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}}class lh{constructor(e,t){this.offset=typeof e=="number"?e:e.low,this.length=typeof t=="number"?t:t.low}}class Jm{constructor(e,t){this.length=typeof e=="number"?e:e.low,this.nullCount=typeof t=="number"?t:t.low}}function O6(r,e){return()=>{switch(e){case Nr.Schema:return Vr.fromJSON(r);case Nr.RecordBatch:return $u.fromJSON(r);case Nr.DictionaryBatch:return yh.fromJSON(r)}throw new Error(`Unrecognized Message type: { name: ${Nr[e]}, type: ${e} }`)}}function F6(r,e){return()=>{switch(e){case Nr.Schema:return Vr.decode(r.header(new Yd));case Nr.RecordBatch:return $u.decode(r.header(new hf),r.version());case Nr.DictionaryBatch:return yh.decode(r.header(new e0),r.version())}throw new Error(`Unrecognized Message type: { name: ${Nr[e]}, type: ${e} }`)}}_s.encode=q6;_s.decode=$6;_s.fromJSON=L6;Vr.encode=W6;Vr.decode=B6;Vr.fromJSON=M6;$u.encode=X6;$u.decode=N6;$u.fromJSON=bR;yh.encode=Y6;yh.decode=U6;yh.fromJSON=D6;Jm.encode=Q6;Jm.decode=z6;lh.encode=K6;lh.decode=V6;function B6(r,e=new Map){const t=G6(r,e);return new Vr(t,vT(r),e)}function N6(r,e=ju.V4){if(r.compression()!==null)throw new Error("Record batch compression not implemented");return new $u(r.length(),H6(r),j6(r,e))}function U6(r,e=ju.V4){return new yh($u.decode(r.data(),e),r.id(),r.isDelta())}function V6(r){return new lh(r.offset(),r.length())}function z6(r){return new Jm(r.length(),r.nullCount())}function H6(r){const e=[];for(let t,i=-1,n=-1,s=r.nodesLength();++i<s;)(t=r.nodes(i))&&(e[++n]=Jm.decode(t));return e}function j6(r,e){const t=[];for(let i,n=-1,s=-1,a=r.buffersLength();++n<a;)(i=r.buffers(n))&&(e<ju.V4&&(i.bb_pos+=8*(n+1)),t[++s]=lh.decode(i));return t}function G6(r,e){const t=[];for(let i,n=-1,s=-1,a=r.fieldsLength();++n<a;)(i=r.fields(n))&&(t[++s]=_s.decode(i,e));return t}function MD(r,e){const t=[];for(let i,n=-1,s=-1,a=r.childrenLength();++n<a;)(i=r.children(n))&&(t[++s]=_s.decode(i,e));return t}function $6(r,e){let t,i,n,s,a,c;return!e||!(c=r.dictionary())?(n=ID(r,MD(r,e)),i=new _s(r.name(),n,r.nullable(),vT(r))):e.has(t=c.id().low)?(s=(s=c.indexType())?DD(s):new b_,a=new E0(e.get(t),s,t,c.isOrdered()),i=new _s(r.name(),a,r.nullable(),vT(r))):(s=(s=c.indexType())?DD(s):new b_,e.set(t,n=ID(r,MD(r,e))),a=new E0(n,s,t,c.isOrdered()),i=new _s(r.name(),a,r.nullable(),vT(r))),i||null}function vT(r){const e=new Map;if(r)for(let t,i,n=-1,s=Math.trunc(r.customMetadataLength());++n<s;)(t=r.customMetadata(n))&&(i=t.key())!=null&&e.set(i,t.value());return e}function DD(r){return new Mp(r.isSigned(),r.bitWidth())}function ID(r,e){const t=r.typeType();switch(t){case Us.NONE:return new Cp;case Us.Null:return new Cp;case Us.Binary:return new DT;case Us.Utf8:return new IT;case Us.Bool:return new PT;case Us.List:return new FT((e||[])[0]);case Us.Struct_:return new hl(e||[])}switch(t){case Us.Int:{const i=r.type(new Hu);return new Mp(i.isSigned(),i.bitWidth())}case Us.FloatingPoint:{const i=r.type(new sh);return new T_(i.precision())}case Us.Decimal:{const i=r.type(new Yl);return new LT(i.scale(),i.precision(),i.bitWidth())}case Us.Date:{const i=r.type(new hT);return new RT(i.unit())}case Us.Time:{const i=r.type(new Qy);return new x_(i.unit(),i.bitWidth())}case Us.Timestamp:{const i=r.type(new mc);return new kT(i.unit(),i.timezone())}case Us.Interval:{const i=r.type(new ah);return new OT(i.unit())}case Us.Union:{const i=r.type(new Ql);return new BT(i.mode(),i.typeIdsArray()||[],e||[])}case Us.FixedSizeBinary:{const i=r.type(new nh);return new NT(i.byteWidth())}case Us.FixedSizeList:{const i=r.type(new rh);return new UT(i.listSize(),(e||[])[0])}case Us.Map:{const i=r.type(new fT);return new VT((e||[])[0],i.keysSorted())}}throw new Error(`Unrecognized type: "${Us[t]}" (${t})`)}function W6(r,e){const t=e.fields.map(s=>_s.encode(r,s));Yd.startFieldsVector(r,t.length);const i=Yd.createFieldsVector(r,t),n=e.metadata&&e.metadata.size>0?Yd.createCustomMetadataVector(r,[...e.metadata].map(([s,a])=>{const c=r.createString(`${s}`),h=r.createString(`${a}`);return ka.startKeyValue(r),ka.addKey(r,c),ka.addValue(r,h),ka.endKeyValue(r)})):-1;return Yd.startSchema(r),Yd.addFields(r,i),Yd.addEndianness(r,Z6?D0.Little:D0.Big),n!==-1&&Yd.addCustomMetadata(r,n),Yd.endSchema(r)}function q6(r,e){let t=-1,i=-1,n=-1;const s=e.type;let a=e.typeId;En.isDictionary(s)?(a=s.dictionary.typeId,n=RA.visit(s,r),i=RA.visit(s.dictionary,r)):i=RA.visit(s,r);const c=(s.children||[]).map(v=>_s.encode(r,v)),h=fc.createChildrenVector(r,c),m=e.metadata&&e.metadata.size>0?fc.createCustomMetadataVector(r,[...e.metadata].map(([v,b])=>{const x=r.createString(`${v}`),C=r.createString(`${b}`);return ka.startKeyValue(r),ka.addKey(r,x),ka.addValue(r,C),ka.endKeyValue(r)})):-1;return e.name&&(t=r.createString(e.name)),fc.startField(r),fc.addType(r,i),fc.addTypeType(r,a),fc.addChildren(r,h),fc.addNullable(r,!!e.nullable),t!==-1&&fc.addName(r,t),n!==-1&&fc.addDictionary(r,n),m!==-1&&fc.addCustomMetadata(r,m),fc.endField(r)}function X6(r,e){const t=e.nodes||[],i=e.buffers||[];hf.startNodesVector(r,t.length);for(const a of t.slice().reverse())Jm.encode(r,a);const n=r.endVector();hf.startBuffersVector(r,i.length);for(const a of i.slice().reverse())lh.encode(r,a);const s=r.endVector();return hf.startRecordBatch(r),hf.addLength(r,new Qm(e.length,0)),hf.addNodes(r,n),hf.addBuffers(r,s),hf.endRecordBatch(r)}function Y6(r,e){const t=$u.encode(r,e.data);return e0.startDictionaryBatch(r),e0.addId(r,new Qm(e.id,0)),e0.addIsDelta(r,e.isDelta),e0.addData(r,t),e0.endDictionaryBatch(r)}function Q6(r,e){return _R.createFieldNode(r,new Qm(e.length,0),new Qm(e.nullCount,0))}function K6(r,e){return yR.createBuffer(r,new Qm(e.offset,0),new Qm(e.length,0))}const Z6=(()=>{const r=new ArrayBuffer(2);return new DataView(r).setInt16(0,256,!0),new Int16Array(r)[0]===256})(),M2=r=>`Expected ${Nr[r]} Message in stream, but was null or length 0.`,D2=r=>`Header pointer of flatbuffer-encoded ${Nr[r]} Message is null or length 0.`,SR=(r,e)=>`Expected to read ${r} metadata bytes, but only read ${e}.`,AR=(r,e)=>`Expected to read ${r} bytes for message body, but only read ${e}.`;class wR{constructor(e){this.source=e instanceof YT?e:new YT(e)}[Symbol.iterator](){return this}next(){let e;return(e=this.readMetadataLength()).done||e.value===-1&&(e=this.readMetadataLength()).done||(e=this.readMetadata(e.value)).done?Vs:e}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}readMessage(e){let t;if((t=this.next()).done)return null;if(e!=null&&t.value.headerType!==e)throw new Error(M2(e));return t.value}readMessageBody(e){if(e<=0)return new Uint8Array(0);const t=Mr(this.source.read(e));if(t.byteLength<e)throw new Error(AR(e,t.byteLength));return t.byteOffset%8===0&&t.byteOffset+t.byteLength<=t.buffer.byteLength?t:t.slice()}readSchema(e=!1){const t=Nr.Schema,i=this.readMessage(t),n=i==null?void 0:i.header();if(e&&!n)throw new Error(D2(t));return n}readMetadataLength(){const e=this.source.read(Wx),t=e&&new C0(e),i=(t==null?void 0:t.readInt32(0))||0;return{done:i===0,value:i}}readMetadata(e){const t=this.source.read(e);if(!t)return Vs;if(t.byteLength<e)throw new Error(SR(e,t.byteLength));return{done:!1,value:fl.decode(t)}}}class J6{constructor(e,t){this.source=e instanceof P0?e:WP(e)?new QT(e,t):new P0(e)}[Symbol.asyncIterator](){return this}next(){return bn(this,void 0,void 0,function*(){let e;return(e=yield this.readMetadataLength()).done||e.value===-1&&(e=yield this.readMetadataLength()).done||(e=yield this.readMetadata(e.value)).done?Vs:e})}throw(e){return bn(this,void 0,void 0,function*(){return yield this.source.throw(e)})}return(e){return bn(this,void 0,void 0,function*(){return yield this.source.return(e)})}readMessage(e){return bn(this,void 0,void 0,function*(){let t;if((t=yield this.next()).done)return null;if(e!=null&&t.value.headerType!==e)throw new Error(M2(e));return t.value})}readMessageBody(e){return bn(this,void 0,void 0,function*(){if(e<=0)return new Uint8Array(0);const t=Mr(yield this.source.read(e));if(t.byteLength<e)throw new Error(AR(e,t.byteLength));return t.byteOffset%8===0&&t.byteOffset+t.byteLength<=t.buffer.byteLength?t:t.slice()})}readSchema(e=!1){return bn(this,void 0,void 0,function*(){const t=Nr.Schema,i=yield this.readMessage(t),n=i==null?void 0:i.header();if(e&&!n)throw new Error(D2(t));return n})}readMetadataLength(){return bn(this,void 0,void 0,function*(){const e=yield this.source.read(Wx),t=e&&new C0(e),i=(t==null?void 0:t.readInt32(0))||0;return{done:i===0,value:i}})}readMetadata(e){return bn(this,void 0,void 0,function*(){const t=yield this.source.read(e);if(!t)return Vs;if(t.byteLength<e)throw new Error(SR(e,t.byteLength));return{done:!1,value:fl.decode(t)}})}}class eU extends wR{constructor(e){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=e instanceof xD?e:new xD(e)}next(){const{_json:e}=this;if(!this._schema)return this._schema=!0,{done:!1,value:fl.fromJSON(e.schema,Nr.Schema)};if(this._dictionaryIndex<e.dictionaries.length){const t=e.dictionaries[this._dictionaryIndex++];return this._body=t.data.columns,{done:!1,value:fl.fromJSON(t,Nr.DictionaryBatch)}}if(this._batchIndex<e.batches.length){const t=e.batches[this._batchIndex++];return this._body=t.columns,{done:!1,value:fl.fromJSON(t,Nr.RecordBatch)}}return this._body=[],Vs}readMessageBody(e){return t(this._body);function t(i){return(i||[]).reduce((n,s)=>[...n,...s.VALIDITY&&[s.VALIDITY]||[],...s.TYPE&&[s.TYPE]||[],...s.OFFSET&&[s.OFFSET]||[],...s.DATA&&[s.DATA]||[],...t(s.children)],[])}}readMessage(e){let t;if((t=this.next()).done)return null;if(e!=null&&t.value.headerType!==e)throw new Error(M2(e));return t.value}readSchema(){const e=Nr.Schema,t=this.readMessage(e),i=t==null?void 0:t.header();if(!t||!i)throw new Error(D2(e));return i}}const Wx=4,iE="ARROW1",A_=new Uint8Array(iE.length);for(let r=0;r<iE.length;r+=1)A_[r]=iE.codePointAt(r);function I2(r,e=0){for(let t=-1,i=A_.length;++t<i;)if(A_[t]!==r[e+t])return!1;return!0}const j_=A_.length,ER=j_+Wx,tU=j_*2+Wx;class Tf extends x2{constructor(e){super(),this._impl=e}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(e){return this._impl.throw(e)}return(e){return this._impl.return(e)}cancel(){return this._impl.cancel()}reset(e){return this._impl.reset(e),this._DOMStream=void 0,this._nodeStream=void 0,this}open(e){const t=this._impl.open(e);return wp(t)?t.then(()=>this):this}readRecordBatch(e){return this._impl.isFile()?this._impl.readRecordBatch(e):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return pc.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return pc.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw new Error('"throughDOM" not available in this environment')}static from(e){return e instanceof Tf?e:$w(e)?sU(e):WP(e)?lU(e):wp(e)?bn(this,void 0,void 0,function*(){return yield Tf.from(yield e)}):qP(e)||l2(e)||XP(e)||K0(e)?oU(new P0(e)):aU(new YT(e))}static readAll(e){return e instanceof Tf?e.isSync()?PD(e):LD(e):$w(e)||ArrayBuffer.isView(e)||U_(e)||$P(e)?PD(e):LD(e)}}class ex extends Tf{constructor(e){super(e),this._impl=e}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return oh(this,arguments,function*(){yield jn(yield*dT(Um(this[Symbol.iterator]())))})}}class tx extends Tf{constructor(e){super(e),this._impl=e}readAll(){var e,t;return bn(this,void 0,void 0,function*(){const i=new Array;try{for(var n=Um(this),s;s=yield n.next(),!s.done;){const a=s.value;i.push(a)}}catch(a){e={error:a}}finally{try{s&&!s.done&&(t=n.return)&&(yield t.call(n))}finally{if(e)throw e.error}}return i})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class CR extends ex{constructor(e){super(e),this._impl=e}}class iU extends tx{constructor(e){super(e),this._impl=e}}class MR{constructor(e=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=e}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(e){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=e,this.dictionaries=new Map,this}_loadRecordBatch(e,t){const i=this._loadVectors(e,t,this.schema.fields),n=gr({type:new hl(this.schema.fields),length:e.length,children:i});return new Kl(this.schema,n)}_loadDictionaryBatch(e,t){const{id:i,isDelta:n}=e,{dictionaries:s,schema:a}=this,c=s.get(i);if(n||!c){const h=a.dictionaries.get(i),m=this._loadVectors(e.data,t,[h]);return(c&&n?c.concat(new Ur(m)):new Ur(m)).memoize()}return c.memoize()}_loadVectors(e,t,i){return new pR(t,e.nodes,e.buffers,this.dictionaries).visitMany(i)}}class ix extends MR{constructor(e,t){super(t),this._reader=$w(e)?new eU(this._handle=e):new wR(this._handle=e)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(e){return this.closed||(this.autoDestroy=IR(this,e),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(e):Vs}return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(e):Vs}next(){if(this.closed)return Vs;let e;const{_reader:t}=this;for(;e=this._readNextMessageAndValidate();)if(e.isSchema())this.reset(e.header());else if(e.isRecordBatch()){this._recordBatchIndex++;const i=e.header(),n=t.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(i,n)}}else if(e.isDictionaryBatch()){this._dictionaryIndex++;const i=e.header(),n=t.readMessageBody(e.bodyLength),s=this._loadDictionaryBatch(i,n);this.dictionaries.set(i.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new C2(this.schema)}):this.return()}_readNextMessageAndValidate(e){return this._reader.readMessage(e)}}class nx extends MR{constructor(e,t){super(t),this._reader=new J6(this._handle=e)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return bn(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(e){return bn(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=IR(this,e),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(e){return bn(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(e):Vs})}return(e){return bn(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(e):Vs})}next(){return bn(this,void 0,void 0,function*(){if(this.closed)return Vs;let e;const{_reader:t}=this;for(;e=yield this._readNextMessageAndValidate();)if(e.isSchema())yield this.reset(e.header());else if(e.isRecordBatch()){this._recordBatchIndex++;const i=e.header(),n=yield t.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(i,n)}}else if(e.isDictionaryBatch()){this._dictionaryIndex++;const i=e.header(),n=yield t.readMessageBody(e.bodyLength),s=this._loadDictionaryBatch(i,n);this.dictionaries.set(i.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new C2(this.schema)}):yield this.return()})}_readNextMessageAndValidate(e){return bn(this,void 0,void 0,function*(){return yield this._reader.readMessage(e)})}}class DR extends ix{constructor(e,t){super(e instanceof SD?e:new SD(e),t)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(e)}readRecordBatch(e){var t;if(this.closed)return null;this._footer||this.open();const i=(t=this._footer)===null||t===void 0?void 0:t.getRecordBatch(e);if(i&&this._handle.seek(i.offset)){const n=this._reader.readMessage(Nr.RecordBatch);if(n!=null&&n.isRecordBatch()){const s=n.header(),a=this._reader.readMessageBody(n.bodyLength);return this._loadRecordBatch(s,a)}}return null}_readDictionaryBatch(e){var t;const i=(t=this._footer)===null||t===void 0?void 0:t.getDictionaryBatch(e);if(i&&this._handle.seek(i.offset)){const n=this._reader.readMessage(Nr.DictionaryBatch);if(n!=null&&n.isDictionaryBatch()){const s=n.header(),a=this._reader.readMessageBody(n.bodyLength),c=this._loadDictionaryBatch(s,a);this.dictionaries.set(s.id,c)}}}_readFooter(){const{_handle:e}=this,t=e.size-ER,i=e.readInt32(t),n=e.readAt(t-i,i);return S_.decode(n)}_readNextMessageAndValidate(e){var t;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const i=(t=this._footer)===null||t===void 0?void 0:t.getRecordBatch(this._recordBatchIndex);if(i&&this._handle.seek(i.offset))return this._reader.readMessage(e)}return null}}class nU extends nx{constructor(e,...t){const i=typeof t[0]!="number"?t.shift():void 0,n=t[0]instanceof Map?t.shift():void 0;super(e instanceof QT?e:new QT(e,i),n)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(e){const t=Object.create(null,{open:{get:()=>super.open}});return bn(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const i of this._footer.dictionaryBatches())i&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield t.open.call(this,e)})}readRecordBatch(e){var t;return bn(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());const i=(t=this._footer)===null||t===void 0?void 0:t.getRecordBatch(e);if(i&&(yield this._handle.seek(i.offset))){const n=yield this._reader.readMessage(Nr.RecordBatch);if(n!=null&&n.isRecordBatch()){const s=n.header(),a=yield this._reader.readMessageBody(n.bodyLength);return this._loadRecordBatch(s,a)}}return null})}_readDictionaryBatch(e){var t;return bn(this,void 0,void 0,function*(){const i=(t=this._footer)===null||t===void 0?void 0:t.getDictionaryBatch(e);if(i&&(yield this._handle.seek(i.offset))){const n=yield this._reader.readMessage(Nr.DictionaryBatch);if(n!=null&&n.isDictionaryBatch()){const s=n.header(),a=yield this._reader.readMessageBody(n.bodyLength),c=this._loadDictionaryBatch(s,a);this.dictionaries.set(s.id,c)}}})}_readFooter(){return bn(this,void 0,void 0,function*(){const{_handle:e}=this;e._pending&&(yield e._pending);const t=e.size-ER,i=yield e.readInt32(t),n=yield e.readAt(t-i,i);return S_.decode(n)})}_readNextMessageAndValidate(e){return bn(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const t=this._footer.getRecordBatch(this._recordBatchIndex);if(t&&(yield this._handle.seek(t.offset)))return yield this._reader.readMessage(e)}return null})}}class rU extends ix{constructor(e,t){super(e,t)}_loadVectors(e,t,i){return new g6(t,e.nodes,e.buffers,this.dictionaries).visitMany(i)}}function IR(r,e){return e&&typeof e.autoDestroy=="boolean"?e.autoDestroy:r.autoDestroy}function*PD(r){const e=Tf.from(r);try{if(!e.open({autoDestroy:!1}).closed)do yield e;while(!e.reset().open().closed)}finally{e.cancel()}}function LD(r){return oh(this,arguments,function*(){const t=yield jn(Tf.from(r));try{if(!(yield jn(t.open({autoDestroy:!1}))).closed)do yield yield jn(t);while(!(yield jn(t.reset().open())).closed)}finally{yield jn(t.cancel())}})}function sU(r){return new ex(new rU(r))}function aU(r){const e=r.peek(j_+7&-8);return e&&e.byteLength>=4?I2(e)?new CR(new DR(r.read())):new ex(new ix(r)):new ex(new ix(function*(){}()))}function oU(r){return bn(this,void 0,void 0,function*(){const e=yield r.peek(j_+7&-8);return e&&e.byteLength>=4?I2(e)?new CR(new DR(yield r.read())):new tx(new nx(r)):new tx(new nx(function(){return oh(this,arguments,function*(){})}()))})}function lU(r){return bn(this,void 0,void 0,function*(){const{size:e}=yield r.stat(),t=new QT(r,e);return e>=tU&&I2(yield t.readAt(0,j_+7&-8))?new iU(new nU(t)):new tx(new nx(t))})}class xa extends vr{constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(...e){const t=n=>n.flatMap(s=>Array.isArray(s)?t(s):s instanceof Kl?s.data.children:s.data),i=new xa;return i.visitMany(t(e)),i}visit(e){if(e instanceof Ur)return this.visitMany(e.data),this;const{type:t}=e;if(!En.isDictionary(t)){const{length:i,nullCount:n}=e;if(i>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");En.isNull(t)||Xc.call(this,n<=0?new Uint8Array(0):v2(e.offset,i,e.nullBitmap)),this.nodes.push(new Jm(i,n))}return super.visit(e)}visitNull(e){return this}visitDictionary(e){return this.visit(e.clone(e.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function Xc(r){const e=r.byteLength+7&-8;return this.buffers.push(r),this.bufferRegions.push(new lh(this._byteLength,e)),this._byteLength+=e,this}function uU(r){const{type:e,length:t,typeIds:i,valueOffsets:n}=r;if(Xc.call(this,i),e.mode===Gu.Sparse)return nE.call(this,r);if(e.mode===Gu.Dense){if(r.offset<=0)return Xc.call(this,n),nE.call(this,r);{const s=i.reduce((v,b)=>Math.max(v,b),i[0]),a=new Int32Array(s+1),c=new Int32Array(s+1).fill(-1),h=new Int32Array(t),m=c2(-n[0],t,n);for(let v,b,x=-1;++x<t;)(b=c[v=i[x]])===-1&&(b=c[v]=m[v]),h[x]=m[x]-b,++a[v];Xc.call(this,h);for(let v,b=-1,x=e.children.length;++b<x;)if(v=r.children[b]){const C=e.typeIds[b],B=Math.min(t,a[C]);this.visit(v.slice(c[C],B))}}}return this}function cU(r){let e;return r.nullCount>=r.length?Xc.call(this,new Uint8Array(0)):(e=r.values)instanceof Uint8Array?Xc.call(this,v2(r.offset,r.length,e)):Xc.call(this,zT(r.values))}function Np(r){return Xc.call(this,r.values.subarray(0,r.length*r.stride))}function PR(r){const{length:e,values:t,valueOffsets:i}=r,n=i[0],s=i[e],a=Math.min(s-n,t.byteLength-n);return Xc.call(this,c2(-i[0],e,i)),Xc.call(this,t.subarray(n,n+a)),this}function P2(r){const{length:e,valueOffsets:t}=r;return t&&Xc.call(this,c2(t[0],e,t)),this.visit(r.children[0])}function nE(r){return this.visitMany(r.type.children.map((e,t)=>r.children[t]).filter(Boolean))[0]}xa.prototype.visitBool=cU;xa.prototype.visitInt=Np;xa.prototype.visitFloat=Np;xa.prototype.visitUtf8=PR;xa.prototype.visitBinary=PR;xa.prototype.visitFixedSizeBinary=Np;xa.prototype.visitDate=Np;xa.prototype.visitTimestamp=Np;xa.prototype.visitTime=Np;xa.prototype.visitDecimal=Np;xa.prototype.visitList=P2;xa.prototype.visitStruct=nE;xa.prototype.visitUnion=uU;xa.prototype.visitInterval=Np;xa.prototype.visitFixedSizeList=P2;xa.prototype.visitMap=P2;class LR extends x2{constructor(e){super(),this._position=0,this._started=!1,this._sink=new mT,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,iu(e)||(e={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof e.autoDestroy=="boolean"?e.autoDestroy:!0,this._writeLegacyIpcFormat=typeof e.writeLegacyIpcFormat=="boolean"?e.writeLegacyIpcFormat:!1}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw new Error('"throughDOM" not available in this environment')}toString(e=!1){return this._sink.toString(e)}toUint8Array(e=!1){return this._sink.toUint8Array(e)}writeAll(e){return wp(e)?e.then(t=>this.writeAll(t)):K0(e)?O2(this,e):k2(this,e)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(e){return this._sink.toDOMStream(e)}toNodeStream(e){return this._sink.toNodeStream(e)}close(){return this.reset()._sink.close()}abort(e){return this.reset()._sink.abort(e)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(e=this._sink,t=null){return e===this._sink||e instanceof mT?this._sink=e:(this._sink=new mT,e&&P5(e)?this.toDOMStream({type:"bytes"}).pipeTo(e):e&&L5(e)&&this.toNodeStream({objectMode:!1}).pipe(e)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!t||!Jw(t,this._schema))&&(t==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=t,this._writeSchema(t))),this}write(e){let t=null;if(this._sink){if(e==null)return this.finish()&&void 0;if(e instanceof ul&&!(t=e.schema))return this.finish()&&void 0;if(e instanceof Kl&&!(t=e.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(t&&!Jw(t,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,t)}e instanceof Kl?e instanceof C2||this._writeRecordBatch(e):e instanceof ul?this.writeAll(e.batches):U_(e)&&this.writeAll(e)}_writeMessage(e,t=8){const i=t-1,n=fl.encode(e),s=n.byteLength,a=this._writeLegacyIpcFormat?4:8,c=s+a+i&~i,h=c-s-a;return e.headerType===Nr.RecordBatch?this._recordBatchBlocks.push(new Dp(c,e.bodyLength,this._position)):e.headerType===Nr.DictionaryBatch&&this._dictionaryBlocks.push(new Dp(c,e.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(c-a)),s>0&&this._write(n),this._writePadding(h)}_write(e){if(this._started){const t=Mr(e);t&&t.byteLength>0&&(this._sink.write(t),this._position+=t.byteLength)}return this}_writeSchema(e){return this._writeMessage(fl.from(e))}_writeFooter(e){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(A_)}_writePadding(e){return e>0?this._write(new Uint8Array(e)):this}_writeRecordBatch(e){const{byteLength:t,nodes:i,bufferRegions:n,buffers:s}=xa.assemble(e),a=new $u(e.numRows,i,n),c=fl.from(a,t);return this._writeDictionaries(e)._writeMessage(c)._writeBodyBuffers(s)}_writeDictionaryBatch(e,t,i=!1){this._dictionaryDeltaOffsets.set(t,e.length+(this._dictionaryDeltaOffsets.get(t)||0));const{byteLength:n,nodes:s,bufferRegions:a,buffers:c}=xa.assemble(new Ur([e])),h=new $u(e.length,s,a),m=new yh(h,t,i),v=fl.from(m,n);return this._writeMessage(v)._writeBodyBuffers(c)}_writeBodyBuffers(e){let t,i,n;for(let s=-1,a=e.length;++s<a;)(t=e[s])&&(i=t.byteLength)>0&&(this._write(t),(n=(i+7&-8)-i)>0&&this._writePadding(n));return this}_writeDictionaries(e){for(let[t,i]of e.dictionaries){let n=this._dictionaryDeltaOffsets.get(t)||0;if(n===0||(i=i==null?void 0:i.slice(n)).length>0)for(const s of i.data)this._writeDictionaryBatch(s,t,n>0),n+=s.length}return this}}class L2 extends LR{static writeAll(e,t){const i=new L2(t);return wp(e)?e.then(n=>i.writeAll(n)):K0(e)?O2(i,e):k2(i,e)}}class R2 extends LR{static writeAll(e){const t=new R2;return wp(e)?e.then(i=>t.writeAll(i)):K0(e)?O2(t,e):k2(t,e)}constructor(){super(),this._autoDestroy=!0}_writeSchema(e){return this._writeMagic()._writePadding(2)}_writeFooter(e){const t=S_.encode(new S_(e,ju.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(e)._write(t)._write(Int32Array.of(t.byteLength))._writeMagic()}}function k2(r,e){let t=e;e instanceof ul&&(t=e.batches,r.reset(void 0,e.schema));for(const i of t)r.write(i);return r.finish()}function O2(r,e){var t,i,n,s;return bn(this,void 0,void 0,function*(){try{for(t=Um(e);i=yield t.next(),!i.done;){const a=i.value;r.write(a)}}catch(a){n={error:a}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(n)throw n.error}}return r.finish()})}function Zy(r){const e=Tf.from(r);return wp(e)?e.then(t=>Zy(t)):e.isAsync()?e.readAll().then(t=>new ul(t)):new ul(e.readAll())}function kA(r,e="stream"){return(e==="stream"?L2:R2).writeAll(r).toUint8Array(!0)}var RD=function(){function r(e,t,i,n){var s=this;this.getCell=function(a,c){var h=a<s.headerRows&&c<s.headerColumns,m=a>=s.headerRows&&c<s.headerColumns,v=a<s.headerRows&&c>=s.headerColumns;if(h){var b=["blank"];return c>0&&b.push("level"+a),{type:"blank",classNames:b.join(" "),content:""}}else if(v){var x=c-s.headerColumns,b=["col_heading","level"+a,"col"+x];return{type:"columns",classNames:b.join(" "),content:s.getContent(s.columnsTable,x,a)}}else if(m){var C=a-s.headerRows,b=["row_heading","level"+c,"row"+C];return{type:"index",id:"T_".concat(s.uuid,"level").concat(c,"_row").concat(C),classNames:b.join(" "),content:s.getContent(s.indexTable,C,c)}}else{var C=a-s.headerRows,x=c-s.headerColumns,b=["data","row"+C,"col"+x],B=s.styler?s.getContent(s.styler.displayValuesTable,C,x):s.getContent(s.dataTable,C,x);return{type:"data",id:"T_".concat(s.uuid,"row").concat(C,"_col").concat(x),classNames:b.join(" "),content:B}}},this.getContent=function(a,c,h){var m=a.getChildAt(h);if(m===null)return"";var v=s.getColumnTypeId(a,h);switch(v){case ht.Timestamp:return s.nanosToDate(m.get(c));default:return m.get(c)}},this.dataTable=Zy(e),this.indexTable=Zy(t),this.columnsTable=Zy(i),this.styler=n?{caption:n.caption,displayValuesTable:Zy(n.displayValues),styles:n.styles,uuid:n.uuid}:void 0}return Object.defineProperty(r.prototype,"rows",{get:function(){return this.indexTable.numRows+this.columnsTable.numCols},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"columns",{get:function(){return this.indexTable.numCols+this.columnsTable.numRows},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"headerRows",{get:function(){return this.rows-this.dataRows},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"headerColumns",{get:function(){return this.columns-this.dataColumns},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dataRows",{get:function(){return this.dataTable.numRows},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dataColumns",{get:function(){return this.dataTable.numCols},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"uuid",{get:function(){return this.styler&&this.styler.uuid},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"caption",{get:function(){return this.styler&&this.styler.caption},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"styles",{get:function(){return this.styler&&this.styler.styles},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"table",{get:function(){return this.dataTable},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"index",{get:function(){return this.indexTable},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"columnTable",{get:function(){return this.columnsTable},enumerable:!1,configurable:!0}),r.prototype.serialize=function(){return{data:kA(this.dataTable),index:kA(this.indexTable),columns:kA(this.columnsTable)}},r.prototype.getColumnTypeId=function(e,t){return e.schema.fields[t].type.typeId},r.prototype.nanosToDate=function(e){return new Date(e/1e6)},r}(),o_=function(){return o_=Object.assign||function(r){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n])}return r},o_.apply(this,arguments)},l_;(function(r){r.COMPONENT_READY="streamlit:componentReady",r.SET_COMPONENT_VALUE="streamlit:setComponentValue",r.SET_FRAME_HEIGHT="streamlit:setFrameHeight"})(l_||(l_={}));var Wc=function(){function r(){}return r.API_VERSION=1,r.RENDER_EVENT="streamlit:render",r.events=new EventTarget,r.registeredMessageListener=!1,r.setComponentReady=function(){r.registeredMessageListener||(window.addEventListener("message",r.onMessageEvent),r.registeredMessageListener=!0),r.sendBackMsg(l_.COMPONENT_READY,{apiVersion:r.API_VERSION})},r.setFrameHeight=function(e){e===void 0&&(e=document.body.scrollHeight),e!==r.lastFrameHeight&&(r.lastFrameHeight=e,r.sendBackMsg(l_.SET_FRAME_HEIGHT,{height:e}))},r.setComponentValue=function(e){var t;e instanceof RD?(t="dataframe",e=e.serialize()):hU(e)?(t="bytes",e=new Uint8Array(e.buffer)):e instanceof ArrayBuffer?(t="bytes",e=new Uint8Array(e)):t="json",r.sendBackMsg(l_.SET_COMPONENT_VALUE,{value:e,dataType:t})},r.onMessageEvent=function(e){var t=e.data.type;switch(t){case r.RENDER_EVENT:r.onRenderMessage(e.data);break}},r.onRenderMessage=function(e){var t=e.args;t==null&&(console.error("Got null args in onRenderMessage. This should never happen"),t={});var i=e.dfs&&e.dfs.length>0?r.argsDataframeToObject(e.dfs):{};t=o_(o_({},t),i);var n=!!e.disabled,s=e.theme;s&&dU(s);var a={disabled:n,args:t,theme:s},c=new CustomEvent(r.RENDER_EVENT,{detail:a});r.events.dispatchEvent(c)},r.argsDataframeToObject=function(e){var t=e.map(function(i){var n=i.key,s=i.value;return[n,r.toArrowTable(s)]});return Object.fromEntries(t)},r.toArrowTable=function(e){var t,i=(t=e.data,t.data),n=t.index,s=t.columns,a=t.styler;return new RD(i,n,s,a)},r.sendBackMsg=function(e,t){window.parent.postMessage(o_({isStreamlitMessage:!0,type:e},t),"*")},r}(),dU=function(r){var e=document.createElement("style");document.head.appendChild(e),e.innerHTML=`
    :root {
      --primary-color: `.concat(r.primaryColor,`;
      --background-color: `).concat(r.backgroundColor,`;
      --secondary-background-color: `).concat(r.secondaryBackgroundColor,`;
      --text-color: `).concat(r.textColor,`;
      --font: `).concat(r.font,`;
    }

    body {
      background-color: var(--background-color);
      color: var(--text-color);
    }
  `)};function hU(r){var e=!1;try{e=r instanceof BigInt64Array||r instanceof BigUint64Array}catch{}return r instanceof Int8Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray||r instanceof Int16Array||r instanceof Uint16Array||r instanceof Int32Array||r instanceof Uint32Array||r instanceof Float32Array||r instanceof Float64Array||e}var RR=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),fU=function(r){RR(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.componentDidMount=function(){Wc.setFrameHeight()},e.prototype.componentDidUpdate=function(){Wc.setFrameHeight()},e}(Qg.PureComponent);function pU(r){var e=function(t){RR(i,t);function i(n){var s=t.call(this,n)||this;return s.componentDidMount=function(){Wc.events.addEventListener(Wc.RENDER_EVENT,s.onRenderEvent),Wc.setComponentReady()},s.componentDidUpdate=function(){s.state.componentError!=null&&Wc.setFrameHeight()},s.componentWillUnmount=function(){Wc.events.removeEventListener(Wc.RENDER_EVENT,s.onRenderEvent)},s.onRenderEvent=function(a){s.setState({renderData:a.detail})},s.state={renderData:void 0,componentError:void 0},s}return i.prototype.render=function(){return this.state.componentError!=null?Qg.createElement("div",null,Qg.createElement("h1",null,"Component Error"),Qg.createElement("span",null,this.state.componentError.message)):this.state.renderData==null?null:Qg.createElement(r,{width:window.innerWidth,disabled:this.state.renderData.disabled,args:this.state.renderData.args,theme:this.state.renderData.theme})},i.getDerivedStateFromError=function(n){return{componentError:n}},i}(Qg.PureComponent);return x5(e,r)}const mU="modulepreload",gU=function(r,e){return new URL(r,e).href},kD={},rE=function(e,t,i){let n=Promise.resolve();if(t&&t.length>0){let a=function(v){return Promise.all(v.map(b=>Promise.resolve(b).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const c=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),m=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));n=a(t.map(v=>{if(v=gU(v,i),v in kD)return;kD[v]=!0;const b=v.endsWith(".css"),x=b?'[rel="stylesheet"]':"";if(!!i)for(let P=c.length-1;P>=0;P--){const N=c[P];if(N.href===v&&(!b||N.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${v}"]${x}`))return;const B=document.createElement("link");if(B.rel=b?"stylesheet":mU,b||(B.as="script"),B.crossOrigin="",B.href=v,m&&B.setAttribute("nonce",m),document.head.appendChild(B),b)return new Promise((P,N)=>{B.addEventListener("load",P),B.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${v}`)))})}))}function s(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return n.then(a=>{for(const c of a||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})};var OA,OD;function J0(){if(OD)return OA;OD=1;var r;return typeof window<"u"?r=window:typeof Ap<"u"?r=Ap:typeof self<"u"?r=self:r={},OA=r,OA}var vU=J0();const Z=Yu(vU),yU={},_U=Object.freeze(Object.defineProperty({__proto__:null,default:yU},Symbol.toStringTag,{value:"Module"})),bU=s2(_U);var FA,FD;function kR(){if(FD)return FA;FD=1;var r=typeof Ap<"u"?Ap:typeof window<"u"?window:{},e=bU,t;return typeof document<"u"?t=document:(t=r["__GLOBAL_DOCUMENT_CACHE@4"],t||(t=r["__GLOBAL_DOCUMENT_CACHE@4"]=e)),FA=t,FA}var TU=kR();const ot=Yu(TU);var q1={exports:{}},BA={exports:{}},BD;function OR(){return BD||(BD=1,function(r){function e(){return r.exports=e=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var n=arguments[i];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},r.exports.__esModule=!0,r.exports.default=r.exports,e.apply(null,arguments)}r.exports=e,r.exports.__esModule=!0,r.exports.default=r.exports}(BA)),BA.exports}var NA,ND;function FR(){if(ND)return NA;ND=1,NA=e;var r=Object.prototype.toString;function e(t){if(!t)return!1;var i=r.call(t);return i==="[object Function]"||typeof t=="function"&&i!=="[object RegExp]"||typeof window<"u"&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}return NA}var UA,UD;function xU(){if(UD)return UA;UD=1;function r(n,s){var a=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(a)return(a=a.call(n)).next.bind(a);if(Array.isArray(n)||(a=e(n))||s){a&&(n=a);var c=0;return function(){return c>=n.length?{done:!0}:{done:!1,value:n[c++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e(n,s){if(n){if(typeof n=="string")return t(n,s);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(n,s)}}function t(n,s){(s==null||s>n.length)&&(s=n.length);for(var a=0,c=new Array(s);a<s;a++)c[a]=n[a];return c}var i=function(){function n(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1}var s=n.prototype;return s.getIsEnabled=function(){return this.enabled_},s.enable=function(){this.enabled_=!0},s.disable=function(){this.enabled_=!1},s.reset=function(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1},s.addInterceptor=function(c,h){this.typeToInterceptorsMap_.has(c)||this.typeToInterceptorsMap_.set(c,new Set);var m=this.typeToInterceptorsMap_.get(c);return m.has(h)?!1:(m.add(h),!0)},s.removeInterceptor=function(c,h){var m=this.typeToInterceptorsMap_.get(c);return m&&m.has(h)?(m.delete(h),!0):!1},s.clearInterceptorsByType=function(c){var h=this.typeToInterceptorsMap_.get(c);return h?(this.typeToInterceptorsMap_.delete(c),this.typeToInterceptorsMap_.set(c,new Set),!0):!1},s.clear=function(){return this.typeToInterceptorsMap_.size?(this.typeToInterceptorsMap_=new Map,!0):!1},s.getForType=function(c){return this.typeToInterceptorsMap_.get(c)||new Set},s.execute=function(c,h){for(var m=this.getForType(c),v=r(m),b;!(b=v()).done;){var x=b.value;try{h=x(h)}catch{}}return h},n}();return UA=i,UA}var VA,VD;function SU(){if(VD)return VA;VD=1;var r=function(){function t(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1}var i=t.prototype;return i.getIsEnabled=function(){return this.enabled_},i.enable=function(){this.enabled_=!0},i.disable=function(){this.enabled_=!1},i.reset=function(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1},i.getMaxAttempts=function(){return this.maxAttempts_},i.setMaxAttempts=function(s){this.maxAttempts_=s},i.getDelayFactor=function(){return this.delayFactor_},i.setDelayFactor=function(s){this.delayFactor_=s},i.getFuzzFactor=function(){return this.fuzzFactor_},i.setFuzzFactor=function(s){this.fuzzFactor_=s},i.getInitialDelay=function(){return this.initialDelay_},i.setInitialDelay=function(s){this.initialDelay_=s},i.createRetry=function(s){var a=s===void 0?{}:s,c=a.maxAttempts,h=a.delayFactor,m=a.fuzzFactor,v=a.initialDelay;return new e({maxAttempts:c||this.maxAttempts_,delayFactor:h||this.delayFactor_,fuzzFactor:m||this.fuzzFactor_,initialDelay:v||this.initialDelay_})},t}(),e=function(){function t(n){this.maxAttempts_=n.maxAttempts,this.delayFactor_=n.delayFactor,this.fuzzFactor_=n.fuzzFactor,this.currentDelay_=n.initialDelay,this.currentAttempt_=1}var i=t.prototype;return i.moveToNextAttempt=function(){this.currentAttempt_++;var s=this.currentDelay_*this.delayFactor_;this.currentDelay_=this.currentDelay_+s},i.shouldRetry=function(){return this.currentAttempt_<this.maxAttempts_},i.getCurrentDelay=function(){return this.currentDelay_},i.getCurrentMinPossibleDelay=function(){return(1-this.fuzzFactor_)*this.currentDelay_},i.getCurrentMaxPossibleDelay=function(){return(1+this.fuzzFactor_)*this.currentDelay_},i.getCurrentFuzzedDelay=function(){var s=this.getCurrentMinPossibleDelay(),a=this.getCurrentMaxPossibleDelay();return s+Math.random()*(a-s)},t}();return VA=r,VA}var zA,zD;function AU(){if(zD)return zA;zD=1;var r=J0(),e=function(n,s){return s===void 0&&(s=!1),function(a,c,h){if(a){n(a);return}if(c.statusCode>=400&&c.statusCode<=599){var m=h;if(s)if(r.TextDecoder){var v=t(c.headers&&c.headers["content-type"]);try{m=new TextDecoder(v).decode(h)}catch{}}else m=String.fromCharCode.apply(null,new Uint8Array(h));n({cause:m});return}n(null,h)}};function t(i){return i===void 0&&(i=""),i.toLowerCase().split(";").reduce(function(n,s){var a=s.split("="),c=a[0],h=a[1];return c.trim()==="charset"?h.trim():n},"utf-8")}return zA=e,zA}var HD;function wU(){if(HD)return q1.exports;HD=1;var r=J0(),e=OR(),t=FR(),i=xU(),n=SU();m.httpHandler=AU(),m.requestInterceptorsStorage=new i,m.responseInterceptorsStorage=new i,m.retryManager=new n;/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Bjrklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var s=function(B){var P={};return B&&B.trim().split(`
`).forEach(function(N){var ae=N.indexOf(":"),X=N.slice(0,ae).trim().toLowerCase(),de=N.slice(ae+1).trim();typeof P[X]>"u"?P[X]=de:Array.isArray(P[X])?P[X].push(de):P[X]=[P[X],de]}),P};q1.exports=m,q1.exports.default=m,m.XMLHttpRequest=r.XMLHttpRequest||x,m.XDomainRequest="withCredentials"in new m.XMLHttpRequest?m.XMLHttpRequest:r.XDomainRequest,a(["get","put","post","patch","head","delete"],function(C){m[C==="delete"?"del":C]=function(B,P,N){return P=h(B,P,N),P.method=C.toUpperCase(),v(P)}});function a(C,B){for(var P=0;P<C.length;P++)B(C[P])}function c(C){for(var B in C)if(C.hasOwnProperty(B))return!1;return!0}function h(C,B,P){var N=C;return t(B)?(P=B,typeof C=="string"&&(N={uri:C})):N=e({},B,{uri:C}),N.callback=P,N}function m(C,B,P){return B=h(C,B,P),v(B)}function v(C){if(typeof C.callback>"u")throw new Error("callback argument missing");if(C.requestType&&m.requestInterceptorsStorage.getIsEnabled()){var B={uri:C.uri||C.url,headers:C.headers||{},body:C.body,metadata:C.metadata||{},retry:C.retry,timeout:C.timeout},P=m.requestInterceptorsStorage.execute(C.requestType,B);C.uri=P.uri,C.headers=P.headers,C.body=P.body,C.metadata=P.metadata,C.retry=P.retry,C.timeout=P.timeout}var N=!1,ae=function(je,it,Xe){N||(N=!0,C.callback(je,it,Xe))};function X(){be.readyState===4&&!m.responseInterceptorsStorage.getIsEnabled()&&setTimeout(ue,0)}function de(){var tt=void 0;if(be.response?tt=be.response:tt=be.responseText||b(be),ut)try{tt=JSON.parse(tt)}catch{}return tt}function ge(tt){if(clearTimeout(_t),clearTimeout(C.retryTimeout),tt instanceof Error||(tt=new Error(""+(tt||"Unknown XMLHttpRequest Error"))),tt.statusCode=0,!ve&&m.retryManager.getIsEnabled()&&C.retry&&C.retry.shouldRetry()){C.retryTimeout=setTimeout(function(){C.retry.moveToNextAttempt(),C.xhr=be,v(C)},C.retry.getCurrentFuzzedDelay());return}if(C.requestType&&m.responseInterceptorsStorage.getIsEnabled()){var je={headers:vt.headers||{},body:vt.body,responseUrl:be.responseURL,responseType:be.responseType},it=m.responseInterceptorsStorage.execute(C.requestType,je);vt.body=it.body,vt.headers=it.headers}return ae(tt,vt)}function ue(){if(!ve){var tt;clearTimeout(_t),clearTimeout(C.retryTimeout),C.useXDR&&be.status===void 0?tt=200:tt=be.status===1223?204:be.status;var je=vt,it=null;if(tt!==0?(je={body:de(),statusCode:tt,method:re,headers:{},url:ie,rawRequest:be},be.getAllResponseHeaders&&(je.headers=s(be.getAllResponseHeaders()))):it=new Error("Internal XMLHttpRequest Error"),C.requestType&&m.responseInterceptorsStorage.getIsEnabled()){var Xe={headers:je.headers||{},body:je.body,responseUrl:be.responseURL,responseType:be.responseType},Se=m.responseInterceptorsStorage.execute(C.requestType,Xe);je.body=Se.body,je.headers=Se.headers}return ae(it,je,je.body)}}var be=C.xhr||null;be||(C.cors||C.useXDR?be=new m.XDomainRequest:be=new m.XMLHttpRequest);var fe,ve,ie=be.url=C.uri||C.url,re=be.method=C.method||"GET",Ne=C.body||C.data,De=be.headers=C.headers||{},ke=!!C.sync,ut=!1,_t,vt={body:void 0,headers:{},statusCode:0,method:re,url:ie,rawRequest:be};if("json"in C&&C.json!==!1&&(ut=!0,De.accept||De.Accept||(De.Accept="application/json"),re!=="GET"&&re!=="HEAD"&&(De["content-type"]||De["Content-Type"]||(De["Content-Type"]="application/json"),Ne=JSON.stringify(C.json===!0?Ne:C.json))),be.onreadystatechange=X,be.onload=ue,be.onerror=ge,be.onprogress=function(){},be.onabort=function(){ve=!0,clearTimeout(C.retryTimeout)},be.ontimeout=ge,be.open(re,ie,!ke,C.username,C.password),ke||(be.withCredentials=!!C.withCredentials),!ke&&C.timeout>0&&(_t=setTimeout(function(){if(!ve){ve=!0,be.abort("timeout");var tt=new Error("XMLHttpRequest timeout");tt.code="ETIMEDOUT",ge(tt)}},C.timeout)),be.setRequestHeader)for(fe in De)De.hasOwnProperty(fe)&&be.setRequestHeader(fe,De[fe]);else if(C.headers&&!c(C.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in C&&(be.responseType=C.responseType),"beforeSend"in C&&typeof C.beforeSend=="function"&&C.beforeSend(be),be.send(Ne||null),be}function b(C){try{if(C.responseType==="document")return C.responseXML;var B=C.responseXML&&C.responseXML.documentElement.nodeName==="parsererror";if(C.responseType===""&&!B)return C.responseXML}catch{}return null}function x(){}return q1.exports}var EU=wU();const BR=Yu(EU);var HA={exports:{}},jA,jD;function CU(){if(jD)return jA;jD=1;var r=kR(),e=Object.create||function(){function ie(){}return function(re){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return ie.prototype=re,new ie}}();function t(ie,re){this.name="ParsingError",this.code=ie.code,this.message=re||ie.message}t.prototype=e(Error.prototype),t.prototype.constructor=t,t.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function i(ie){function re(De,ke,ut,_t){return(De|0)*3600+(ke|0)*60+(ut|0)+(_t|0)/1e3}var Ne=ie.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return Ne?Ne[3]?re(Ne[1],Ne[2],Ne[3].replace(":",""),Ne[4]):Ne[1]>59?re(Ne[1],Ne[2],0,Ne[4]):re(0,Ne[1],Ne[2],Ne[4]):null}function n(){this.values=e(null)}n.prototype={set:function(ie,re){!this.get(ie)&&re!==""&&(this.values[ie]=re)},get:function(ie,re,Ne){return Ne?this.has(ie)?this.values[ie]:re[Ne]:this.has(ie)?this.values[ie]:re},has:function(ie){return ie in this.values},alt:function(ie,re,Ne){for(var De=0;De<Ne.length;++De)if(re===Ne[De]){this.set(ie,re);break}},integer:function(ie,re){/^-?\d+$/.test(re)&&this.set(ie,parseInt(re,10))},percent:function(ie,re){return re.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(re=parseFloat(re),re>=0&&re<=100)?(this.set(ie,re),!0):!1}};function s(ie,re,Ne,De){var ke=De?ie.split(De):[ie];for(var ut in ke)if(typeof ke[ut]=="string"){var _t=ke[ut].split(Ne);if(_t.length===2){var vt=_t[0].trim(),tt=_t[1].trim();re(vt,tt)}}}function a(ie,re,Ne){var De=ie;function ke(){var vt=i(ie);if(vt===null)throw new t(t.Errors.BadTimeStamp,"Malformed timestamp: "+De);return ie=ie.replace(/^[^\sa-zA-Z-]+/,""),vt}function ut(vt,tt){var je=new n;s(vt,function(it,Xe){switch(it){case"region":for(var Se=Ne.length-1;Se>=0;Se--)if(Ne[Se].id===Xe){je.set(it,Ne[Se].region);break}break;case"vertical":je.alt(it,Xe,["rl","lr"]);break;case"line":var ct=Xe.split(","),xt=ct[0];je.integer(it,xt),je.percent(it,xt)&&je.set("snapToLines",!1),je.alt(it,xt,["auto"]),ct.length===2&&je.alt("lineAlign",ct[1],["start","center","end"]);break;case"position":ct=Xe.split(","),je.percent(it,ct[0]),ct.length===2&&je.alt("positionAlign",ct[1],["start","center","end"]);break;case"size":je.percent(it,Xe);break;case"align":je.alt(it,Xe,["start","center","end","left","right"]);break}},/:/,/\s/),tt.region=je.get("region",null),tt.vertical=je.get("vertical","");try{tt.line=je.get("line","auto")}catch{}tt.lineAlign=je.get("lineAlign","start"),tt.snapToLines=je.get("snapToLines",!0),tt.size=je.get("size",100);try{tt.align=je.get("align","center")}catch{tt.align=je.get("align","middle")}try{tt.position=je.get("position","auto")}catch{tt.position=je.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},tt.align)}tt.positionAlign=je.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},tt.align)}function _t(){ie=ie.replace(/^\s+/,"")}if(_t(),re.startTime=ke(),_t(),ie.substr(0,3)!=="-->")throw new t(t.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+De);ie=ie.substr(3),_t(),re.endTime=ke(),_t(),ut(ie,re)}var c=r.createElement&&r.createElement("textarea"),h={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},m={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},v={v:"title",lang:"lang"},b={rt:"ruby"};function x(ie,re){function Ne(){if(!re)return null;function xt(Re){return re=re.substr(Re.length),Re}var ii=re.match(/^([^<]*)(<[^>]*>?)?/);return xt(ii[1]?ii[1]:ii[2])}function De(xt){return c.innerHTML=xt,xt=c.textContent,c.textContent="",xt}function ke(xt,ii){return!b[ii.localName]||b[ii.localName]===xt.localName}function ut(xt,ii){var Re=h[xt];if(!Re)return null;var lt=ie.document.createElement(Re),bt=v[xt];return bt&&ii&&(lt[bt]=ii.trim()),lt}for(var _t=ie.document.createElement("div"),vt=_t,tt,je=[];(tt=Ne())!==null;){if(tt[0]==="<"){if(tt[1]==="/"){je.length&&je[je.length-1]===tt.substr(2).replace(">","")&&(je.pop(),vt=vt.parentNode);continue}var it=i(tt.substr(1,tt.length-2)),Xe;if(it){Xe=ie.document.createProcessingInstruction("timestamp",it),vt.appendChild(Xe);continue}var Se=tt.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!Se||(Xe=ut(Se[1],Se[3]),!Xe)||!ke(vt,Xe))continue;if(Se[2]){var ct=Se[2].split(".");ct.forEach(function(xt){var ii=/^bg_/.test(xt),Re=ii?xt.slice(3):xt;if(m.hasOwnProperty(Re)){var lt=ii?"background-color":"color",bt=m[Re];Xe.style[lt]=bt}}),Xe.className=ct.join(" ")}je.push(Se[1]),vt.appendChild(Xe),vt=Xe;continue}vt.appendChild(ie.document.createTextNode(De(tt)))}return _t}var C=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function B(ie){for(var re=0;re<C.length;re++){var Ne=C[re];if(ie>=Ne[0]&&ie<=Ne[1])return!0}return!1}function P(ie){var re=[],Ne="",De;if(!ie||!ie.childNodes)return"ltr";function ke(vt,tt){for(var je=tt.childNodes.length-1;je>=0;je--)vt.push(tt.childNodes[je])}function ut(vt){if(!vt||!vt.length)return null;var tt=vt.pop(),je=tt.textContent||tt.innerText;if(je){var it=je.match(/^.*(\n|\r)/);return it?(vt.length=0,it[0]):je}if(tt.tagName==="ruby")return ut(vt);if(tt.childNodes)return ke(vt,tt),ut(vt)}for(ke(re,ie);Ne=ut(re);)for(var _t=0;_t<Ne.length;_t++)if(De=Ne.charCodeAt(_t),B(De))return"rtl";return"ltr"}function N(ie){if(typeof ie.line=="number"&&(ie.snapToLines||ie.line>=0&&ie.line<=100))return ie.line;if(!ie.track||!ie.track.textTrackList||!ie.track.textTrackList.mediaElement)return-1;for(var re=ie.track,Ne=re.textTrackList,De=0,ke=0;ke<Ne.length&&Ne[ke]!==re;ke++)Ne[ke].mode==="showing"&&De++;return++De*-1}function ae(){}ae.prototype.applyStyles=function(ie,re){re=re||this.div;for(var Ne in ie)ie.hasOwnProperty(Ne)&&(re.style[Ne]=ie[Ne])},ae.prototype.formatStyle=function(ie,re){return ie===0?0:ie+re};function X(ie,re,Ne){ae.call(this),this.cue=re,this.cueDiv=x(ie,re.text);var De={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:re.vertical===""?"horizontal-tb":re.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(De,this.cueDiv),this.div=ie.document.createElement("div"),De={direction:P(this.cueDiv),writingMode:re.vertical===""?"horizontal-tb":re.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:re.align==="middle"?"center":re.align,font:Ne.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(De),this.div.appendChild(this.cueDiv);var ke=0;switch(re.positionAlign){case"start":case"line-left":ke=re.position;break;case"center":ke=re.position-re.size/2;break;case"end":case"line-right":ke=re.position-re.size;break}re.vertical===""?this.applyStyles({left:this.formatStyle(ke,"%"),width:this.formatStyle(re.size,"%")}):this.applyStyles({top:this.formatStyle(ke,"%"),height:this.formatStyle(re.size,"%")}),this.move=function(ut){this.applyStyles({top:this.formatStyle(ut.top,"px"),bottom:this.formatStyle(ut.bottom,"px"),left:this.formatStyle(ut.left,"px"),right:this.formatStyle(ut.right,"px"),height:this.formatStyle(ut.height,"px"),width:this.formatStyle(ut.width,"px")})}}X.prototype=e(ae.prototype),X.prototype.constructor=X;function de(ie){var re,Ne,De,ke;if(ie.div){Ne=ie.div.offsetHeight,De=ie.div.offsetWidth,ke=ie.div.offsetTop;var ut=(ut=ie.div.childNodes)&&(ut=ut[0])&&ut.getClientRects&&ut.getClientRects();ie=ie.div.getBoundingClientRect(),re=ut?Math.max(ut[0]&&ut[0].height||0,ie.height/ut.length):0}this.left=ie.left,this.right=ie.right,this.top=ie.top||ke,this.height=ie.height||Ne,this.bottom=ie.bottom||ke+(ie.height||Ne),this.width=ie.width||De,this.lineHeight=re!==void 0?re:ie.lineHeight}de.prototype.move=function(ie,re){switch(re=re!==void 0?re:this.lineHeight,ie){case"+x":this.left+=re,this.right+=re;break;case"-x":this.left-=re,this.right-=re;break;case"+y":this.top+=re,this.bottom+=re;break;case"-y":this.top-=re,this.bottom-=re;break}},de.prototype.overlaps=function(ie){return this.left<ie.right&&this.right>ie.left&&this.top<ie.bottom&&this.bottom>ie.top},de.prototype.overlapsAny=function(ie){for(var re=0;re<ie.length;re++)if(this.overlaps(ie[re]))return!0;return!1},de.prototype.within=function(ie){return this.top>=ie.top&&this.bottom<=ie.bottom&&this.left>=ie.left&&this.right<=ie.right},de.prototype.overlapsOppositeAxis=function(ie,re){switch(re){case"+x":return this.left<ie.left;case"-x":return this.right>ie.right;case"+y":return this.top<ie.top;case"-y":return this.bottom>ie.bottom}},de.prototype.intersectPercentage=function(ie){var re=Math.max(0,Math.min(this.right,ie.right)-Math.max(this.left,ie.left)),Ne=Math.max(0,Math.min(this.bottom,ie.bottom)-Math.max(this.top,ie.top)),De=re*Ne;return De/(this.height*this.width)},de.prototype.toCSSCompatValues=function(ie){return{top:this.top-ie.top,bottom:ie.bottom-this.bottom,left:this.left-ie.left,right:ie.right-this.right,height:this.height,width:this.width}},de.getSimpleBoxPosition=function(ie){var re=ie.div?ie.div.offsetHeight:ie.tagName?ie.offsetHeight:0,Ne=ie.div?ie.div.offsetWidth:ie.tagName?ie.offsetWidth:0,De=ie.div?ie.div.offsetTop:ie.tagName?ie.offsetTop:0;ie=ie.div?ie.div.getBoundingClientRect():ie.tagName?ie.getBoundingClientRect():ie;var ke={left:ie.left,right:ie.right,top:ie.top||De,height:ie.height||re,bottom:ie.bottom||De+(ie.height||re),width:ie.width||Ne};return ke};function ge(ie,re,Ne,De){function ke(Re,lt){for(var bt,Je=new de(Re),Dt=1,Yt=0;Yt<lt.length;Yt++){for(;Re.overlapsOppositeAxis(Ne,lt[Yt])||Re.within(Ne)&&Re.overlapsAny(De);)Re.move(lt[Yt]);if(Re.within(Ne))return Re;var vi=Re.intersectPercentage(Ne);Dt>vi&&(bt=new de(Re),Dt=vi),Re=new de(Je)}return bt||Je}var ut=new de(re),_t=re.cue,vt=N(_t),tt=[];if(_t.snapToLines){var je;switch(_t.vertical){case"":tt=["+y","-y"],je="height";break;case"rl":tt=["+x","-x"],je="width";break;case"lr":tt=["-x","+x"],je="width";break}var it=ut.lineHeight,Xe=it*Math.round(vt),Se=Ne[je]+it,ct=tt[0];Math.abs(Xe)>Se&&(Xe=Xe<0?-1:1,Xe*=Math.ceil(Se/it)*it),vt<0&&(Xe+=_t.vertical===""?Ne.height:Ne.width,tt=tt.reverse()),ut.move(ct,Xe)}else{var xt=ut.lineHeight/Ne.height*100;switch(_t.lineAlign){case"center":vt-=xt/2;break;case"end":vt-=xt;break}switch(_t.vertical){case"":re.applyStyles({top:re.formatStyle(vt,"%")});break;case"rl":re.applyStyles({left:re.formatStyle(vt,"%")});break;case"lr":re.applyStyles({right:re.formatStyle(vt,"%")});break}tt=["+y","-x","+x","-y"],ut=new de(re)}var ii=ke(ut,tt);re.move(ii.toCSSCompatValues(Ne))}function ue(){}ue.StringDecoder=function(){return{decode:function(ie){if(!ie)return"";if(typeof ie!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(ie))}}},ue.convertCueToDOMTree=function(ie,re){return!ie||!re?null:x(ie,re)};var be=.05,fe="sans-serif",ve="1.5%";return ue.processCues=function(ie,re,Ne){if(!ie||!re||!Ne)return null;for(;Ne.firstChild;)Ne.removeChild(Ne.firstChild);var De=ie.document.createElement("div");De.style.position="absolute",De.style.left="0",De.style.right="0",De.style.top="0",De.style.bottom="0",De.style.margin=ve,Ne.appendChild(De);function ke(it){for(var Xe=0;Xe<it.length;Xe++)if(it[Xe].hasBeenReset||!it[Xe].displayState)return!0;return!1}if(!ke(re)){for(var ut=0;ut<re.length;ut++)De.appendChild(re[ut].displayState);return}var _t=[],vt=de.getSimpleBoxPosition(De),tt=Math.round(vt.height*be*100)/100,je={font:tt+"px "+fe};(function(){for(var it,Xe,Se=0;Se<re.length;Se++)Xe=re[Se],it=new X(ie,Xe,je),De.appendChild(it.div),ge(ie,it,vt,_t),Xe.displayState=it.div,_t.push(de.getSimpleBoxPosition(it))})()},ue.Parser=function(ie,re,Ne){Ne||(Ne=re,re={}),re||(re={}),this.window=ie,this.vttjs=re,this.state="INITIAL",this.buffer="",this.decoder=Ne||new TextDecoder("utf8"),this.regionList=[]},ue.Parser.prototype={reportOrThrowError:function(ie){if(ie instanceof t)this.onparsingerror&&this.onparsingerror(ie);else throw ie},parse:function(ie){var re=this;ie&&(re.buffer+=re.decoder.decode(ie,{stream:!0}));function Ne(){for(var it=re.buffer,Xe=0;Xe<it.length&&it[Xe]!=="\r"&&it[Xe]!==`
`;)++Xe;var Se=it.substr(0,Xe);return it[Xe]==="\r"&&++Xe,it[Xe]===`
`&&++Xe,re.buffer=it.substr(Xe),Se}function De(it){var Xe=new n;if(s(it,function(ct,xt){switch(ct){case"id":Xe.set(ct,xt);break;case"width":Xe.percent(ct,xt);break;case"lines":Xe.integer(ct,xt);break;case"regionanchor":case"viewportanchor":var ii=xt.split(",");if(ii.length!==2)break;var Re=new n;if(Re.percent("x",ii[0]),Re.percent("y",ii[1]),!Re.has("x")||!Re.has("y"))break;Xe.set(ct+"X",Re.get("x")),Xe.set(ct+"Y",Re.get("y"));break;case"scroll":Xe.alt(ct,xt,["up"]);break}},/=/,/\s/),Xe.has("id")){var Se=new(re.vttjs.VTTRegion||re.window.VTTRegion);Se.width=Xe.get("width",100),Se.lines=Xe.get("lines",3),Se.regionAnchorX=Xe.get("regionanchorX",0),Se.regionAnchorY=Xe.get("regionanchorY",100),Se.viewportAnchorX=Xe.get("viewportanchorX",0),Se.viewportAnchorY=Xe.get("viewportanchorY",100),Se.scroll=Xe.get("scroll",""),re.onregion&&re.onregion(Se),re.regionList.push({id:Xe.get("id"),region:Se})}}function ke(it){var Xe=new n;s(it,function(Se,ct){switch(Se){case"MPEGT":Xe.integer(Se+"S",ct);break;case"LOCA":Xe.set(Se+"L",i(ct));break}},/[^\d]:/,/,/),re.ontimestampmap&&re.ontimestampmap({MPEGTS:Xe.get("MPEGTS"),LOCAL:Xe.get("LOCAL")})}function ut(it){it.match(/X-TIMESTAMP-MAP/)?s(it,function(Xe,Se){switch(Xe){case"X-TIMESTAMP-MAP":ke(Se);break}},/=/):s(it,function(Xe,Se){switch(Xe){case"Region":De(Se);break}},/:/)}try{var _t;if(re.state==="INITIAL"){if(!/\r\n|\n/.test(re.buffer))return this;_t=Ne();var vt=_t.match(/^WEBVTT([ \t].*)?$/);if(!vt||!vt[0])throw new t(t.Errors.BadSignature);re.state="HEADER"}for(var tt=!1;re.buffer;){if(!/\r\n|\n/.test(re.buffer))return this;switch(tt?tt=!1:_t=Ne(),re.state){case"HEADER":/:/.test(_t)?ut(_t):_t||(re.state="ID");continue;case"NOTE":_t||(re.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(_t)){re.state="NOTE";break}if(!_t)continue;re.cue=new(re.vttjs.VTTCue||re.window.VTTCue)(0,0,"");try{re.cue.align="center"}catch{re.cue.align="middle"}if(re.state="CUE",_t.indexOf("-->")===-1){re.cue.id=_t;continue}case"CUE":try{a(_t,re.cue,re.regionList)}catch(it){re.reportOrThrowError(it),re.cue=null,re.state="BADCUE";continue}re.state="CUETEXT";continue;case"CUETEXT":var je=_t.indexOf("-->")!==-1;if(!_t||je&&(tt=!0)){re.oncue&&re.oncue(re.cue),re.cue=null,re.state="ID";continue}re.cue.text&&(re.cue.text+=`
`),re.cue.text+=_t.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":_t||(re.state="ID");continue}}}catch(it){re.reportOrThrowError(it),re.state==="CUETEXT"&&re.cue&&re.oncue&&re.oncue(re.cue),re.cue=null,re.state=re.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var ie=this;try{if(ie.buffer+=ie.decoder.decode(),(ie.cue||ie.state==="HEADER")&&(ie.buffer+=`

`,ie.parse()),ie.state==="INITIAL")throw new t(t.Errors.BadSignature)}catch(re){ie.reportOrThrowError(re)}return ie.onflush&&ie.onflush(),this}},jA=ue,jA}var GA,GD;function MU(){if(GD)return GA;GD=1;var r="auto",e={"":1,lr:1,rl:1},t={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function i(a){if(typeof a!="string")return!1;var c=e[a.toLowerCase()];return c?a.toLowerCase():!1}function n(a){if(typeof a!="string")return!1;var c=t[a.toLowerCase()];return c?a.toLowerCase():!1}function s(a,c,h){this.hasBeenReset=!1;var m="",v=!1,b=a,x=c,C=h,B=null,P="",N=!0,ae="auto",X="start",de="auto",ge="auto",ue=100,be="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return m},set:function(fe){m=""+fe}},pauseOnExit:{enumerable:!0,get:function(){return v},set:function(fe){v=!!fe}},startTime:{enumerable:!0,get:function(){return b},set:function(fe){if(typeof fe!="number")throw new TypeError("Start time must be set to a number.");b=fe,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return x},set:function(fe){if(typeof fe!="number")throw new TypeError("End time must be set to a number.");x=fe,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return C},set:function(fe){C=""+fe,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return B},set:function(fe){B=fe,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return P},set:function(fe){var ve=i(fe);if(ve===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");P=ve,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return N},set:function(fe){N=!!fe,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return ae},set:function(fe){if(typeof fe!="number"&&fe!==r)throw new SyntaxError("Line: an invalid number or illegal string was specified.");ae=fe,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return X},set:function(fe){var ve=n(fe);ve?(X=ve,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return de},set:function(fe){if(fe<0||fe>100)throw new Error("Position must be between 0 and 100.");de=fe,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return ge},set:function(fe){var ve=n(fe);ve?(ge=ve,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return ue},set:function(fe){if(fe<0||fe>100)throw new Error("Size must be between 0 and 100.");ue=fe,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return be},set:function(fe){var ve=n(fe);if(!ve)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");be=ve,this.hasBeenReset=!0}}}),this.displayState=void 0}return s.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},GA=s,GA}var $A,$D;function DU(){if($D)return $A;$D=1;var r={"":!0,up:!0};function e(n){if(typeof n!="string")return!1;var s=r[n.toLowerCase()];return s?n.toLowerCase():!1}function t(n){return typeof n=="number"&&n>=0&&n<=100}function i(){var n=100,s=3,a=0,c=100,h=0,m=100,v="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return n},set:function(b){if(!t(b))throw new Error("Width must be between 0 and 100.");n=b}},lines:{enumerable:!0,get:function(){return s},set:function(b){if(typeof b!="number")throw new TypeError("Lines must be set to a number.");s=b}},regionAnchorY:{enumerable:!0,get:function(){return c},set:function(b){if(!t(b))throw new Error("RegionAnchorX must be between 0 and 100.");c=b}},regionAnchorX:{enumerable:!0,get:function(){return a},set:function(b){if(!t(b))throw new Error("RegionAnchorY must be between 0 and 100.");a=b}},viewportAnchorY:{enumerable:!0,get:function(){return m},set:function(b){if(!t(b))throw new Error("ViewportAnchorY must be between 0 and 100.");m=b}},viewportAnchorX:{enumerable:!0,get:function(){return h},set:function(b){if(!t(b))throw new Error("ViewportAnchorX must be between 0 and 100.");h=b}},scroll:{enumerable:!0,get:function(){return v},set:function(b){var x=e(b);x===!1?console.warn("Scroll: an invalid or illegal string was specified."):v=x}}})}return $A=i,$A}var WD;function IU(){if(WD)return HA.exports;WD=1;var r=J0(),e=HA.exports={WebVTT:CU(),VTTCue:MU(),VTTRegion:DU()};r.vttjs=e,r.WebVTT=e.WebVTT;var t=e.VTTCue,i=e.VTTRegion,n=r.VTTCue,s=r.VTTRegion;return e.shim=function(){r.VTTCue=t,r.VTTRegion=i},e.restore=function(){r.VTTCue=n,r.VTTRegion=s},r.VTTCue||e.shim(),HA.exports}var PU=IU();const rx=Yu(PU);function zr(){return zr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},zr.apply(null,arguments)}var qD="https://example.com",qx=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=Z.location&&Z.location.href||"");var i=/^\/\//.test(e),n=!Z.location&&!/\/\//i.test(e);e=new Z.URL(e,Z.location||qD);var s=new URL(t,e);return n?s.href.slice(qD.length):i?s.href.slice(s.protocol.length):s.href},F2=function(){function r(){this.listeners={}}var e=r.prototype;return e.on=function(i,n){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(n)},e.off=function(i,n){if(!this.listeners[i])return!1;var s=this.listeners[i].indexOf(n);return this.listeners[i]=this.listeners[i].slice(0),this.listeners[i].splice(s,1),s>-1},e.trigger=function(i){var n=this.listeners[i];if(n)if(arguments.length===2)for(var s=n.length,a=0;a<s;++a)n[a].call(this,arguments[1]);else for(var c=Array.prototype.slice.call(arguments,1),h=n.length,m=0;m<h;++m)n[m].apply(this,c)},e.dispose=function(){this.listeners={}},e.pipe=function(i){this.on("data",function(n){i.push(n)})},r}(),LU=function(e){return Z.atob?Z.atob(e):Buffer.from(e,"base64").toString("binary")};function NR(r){for(var e=LU(r),t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}/*! @name m3u8-parser @version 7.2.0 @license Apache-2.0 */let RU=class extends F2{constructor(){super(),this.buffer=""}push(e){let t;for(this.buffer+=e,t=this.buffer.indexOf(`
`);t>-1;t=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}};const kU="	",WA=function(r){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(r||""),t={};return e[1]&&(t.length=parseInt(e[1],10)),e[2]&&(t.offset=parseInt(e[2],10)),t},OU=function(){const t="(?:"+"[^=]*"+")=(?:"+'"[^"]*"|[^,]*'+")";return new RegExp("(?:^|,)("+t+")")},al=function(r){const e={};if(!r)return e;const t=r.split(OU());let i=t.length,n;for(;i--;)t[i]!==""&&(n=/([^=]*)=(.*)/.exec(t[i]).slice(1),n[0]=n[0].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^\s+|\s+$/g,""),n[1]=n[1].replace(/^['"](.*)['"]$/g,"$1"),e[n[0]]=n[1]);return e},XD=r=>{const e=r.split("x"),t={};return e[0]&&(t.width=parseInt(e[0],10)),e[1]&&(t.height=parseInt(e[1],10)),t};let FU=class extends F2{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let t,i;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((s,a)=>{const c=a(e);return c===e?s:s.concat([c])},[e]).forEach(s=>{for(let a=0;a<this.customParsers.length;a++)if(this.customParsers[a].call(this,s))return;if(s.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:s.slice(1)});return}if(s=s.replace("\r",""),t=/^#EXTM3U/.exec(s),t){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(t=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(s),t){i={type:"tag",tagType:"inf"},t[1]&&(i.duration=parseFloat(t[1])),t[2]&&(i.title=t[2]),this.trigger("data",i);return}if(t=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(s),t){i={type:"tag",tagType:"targetduration"},t[1]&&(i.duration=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-VERSION:([0-9.]*)?/.exec(s),t){i={type:"tag",tagType:"version"},t[1]&&(i.version=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(s),t){i={type:"tag",tagType:"media-sequence"},t[1]&&(i.number=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(s),t){i={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(i.number=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(s),t){i={type:"tag",tagType:"playlist-type"},t[1]&&(i.playlistType=t[1]),this.trigger("data",i);return}if(t=/^#EXT-X-BYTERANGE:(.*)?$/.exec(s),t){i=zr(WA(t[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",i);return}if(t=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(s),t){i={type:"tag",tagType:"allow-cache"},t[1]&&(i.allowed=!/NO/.test(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-MAP:(.*)$/.exec(s),t){if(i={type:"tag",tagType:"map"},t[1]){const a=al(t[1]);a.URI&&(i.uri=a.URI),a.BYTERANGE&&(i.byterange=WA(a.BYTERANGE))}this.trigger("data",i);return}if(t=/^#EXT-X-STREAM-INF:(.*)$/.exec(s),t){i={type:"tag",tagType:"stream-inf"},t[1]&&(i.attributes=al(t[1]),i.attributes.RESOLUTION&&(i.attributes.RESOLUTION=XD(i.attributes.RESOLUTION)),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))),this.trigger("data",i);return}if(t=/^#EXT-X-MEDIA:(.*)$/.exec(s),t){i={type:"tag",tagType:"media"},t[1]&&(i.attributes=al(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-ENDLIST/.exec(s),t){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(t=/^#EXT-X-DISCONTINUITY/.exec(s),t){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(t=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(s),t){i={type:"tag",tagType:"program-date-time"},t[1]&&(i.dateTimeString=t[1],i.dateTimeObject=new Date(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-KEY:(.*)$/.exec(s),t){i={type:"tag",tagType:"key"},t[1]&&(i.attributes=al(t[1]),i.attributes.IV&&(i.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),this.trigger("data",i);return}if(t=/^#EXT-X-START:(.*)$/.exec(s),t){i={type:"tag",tagType:"start"},t[1]&&(i.attributes=al(t[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),this.trigger("data",i);return}if(t=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(s),t){i={type:"tag",tagType:"cue-out-cont"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-CUE-OUT:(.*)?$/.exec(s),t){i={type:"tag",tagType:"cue-out"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(s),t){i={type:"tag",tagType:"cue-in"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-SKIP:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"skip"},i.attributes=al(t[1]),i.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(i.attributes["SKIPPED-SEGMENTS"]=parseInt(i.attributes["SKIPPED-SEGMENTS"],10)),i.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(i.attributes["RECENTLY-REMOVED-DATERANGES"]=i.attributes["RECENTLY-REMOVED-DATERANGES"].split(kU)),this.trigger("data",i);return}if(t=/^#EXT-X-PART:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"part"},i.attributes=al(t[1]),["DURATION"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),["INDEPENDENT","GAP"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=/YES/.test(i.attributes[a]))}),i.attributes.hasOwnProperty("BYTERANGE")&&(i.attributes.byterange=WA(i.attributes.BYTERANGE)),this.trigger("data",i);return}if(t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"server-control"},i.attributes=al(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=/YES/.test(i.attributes[a]))}),this.trigger("data",i);return}if(t=/^#EXT-X-PART-INF:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"part-inf"},i.attributes=al(t[1]),["PART-TARGET"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),this.trigger("data",i);return}if(t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"preload-hint"},i.attributes=al(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(a){if(i.attributes.hasOwnProperty(a)){i.attributes[a]=parseInt(i.attributes[a],10);const c=a==="BYTERANGE-LENGTH"?"length":"offset";i.attributes.byterange=i.attributes.byterange||{},i.attributes.byterange[c]=i.attributes[a],delete i.attributes[a]}}),this.trigger("data",i);return}if(t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"rendition-report"},i.attributes=al(t[1]),["LAST-MSN","LAST-PART"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseInt(i.attributes[a],10))}),this.trigger("data",i);return}if(t=/^#EXT-X-DATERANGE:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"daterange"},i.attributes=al(t[1]),["ID","CLASS"].forEach(function(c){i.attributes.hasOwnProperty(c)&&(i.attributes[c]=String(i.attributes[c]))}),["START-DATE","END-DATE"].forEach(function(c){i.attributes.hasOwnProperty(c)&&(i.attributes[c]=new Date(i.attributes[c]))}),["DURATION","PLANNED-DURATION"].forEach(function(c){i.attributes.hasOwnProperty(c)&&(i.attributes[c]=parseFloat(i.attributes[c]))}),["END-ON-NEXT"].forEach(function(c){i.attributes.hasOwnProperty(c)&&(i.attributes[c]=/YES/i.test(i.attributes[c]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(c){i.attributes.hasOwnProperty(c)&&(i.attributes[c]=i.attributes[c].toString(16))});const a=/^X-([A-Z]+-)+[A-Z]+$/;for(const c in i.attributes){if(!a.test(c))continue;const h=/[0-9A-Fa-f]{6}/g.test(i.attributes[c]),m=/^\d+(\.\d+)?$/.test(i.attributes[c]);i.attributes[c]=h?i.attributes[c].toString(16):m?parseFloat(i.attributes[c]):String(i.attributes[c])}this.trigger("data",i);return}if(t=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(s),t){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(t=/^#EXT-X-I-FRAMES-ONLY/.exec(s),t){this.trigger("data",{type:"tag",tagType:"i-frames-only"});return}if(t=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(s),t){i={type:"tag",tagType:"content-steering"},i.attributes=al(t[1]),this.trigger("data",i);return}if(t=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(s),t){i={type:"tag",tagType:"i-frame-playlist"},i.attributes=al(t[1]),i.attributes.URI&&(i.uri=i.attributes.URI),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes.RESOLUTION&&(i.attributes.RESOLUTION=XD(i.attributes.RESOLUTION)),i.attributes["AVERAGE-BANDWIDTH"]&&(i.attributes["AVERAGE-BANDWIDTH"]=parseInt(i.attributes["AVERAGE-BANDWIDTH"],10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),this.trigger("data",i);return}if(t=/^#EXT-X-DEFINE:(.*)$/.exec(s),t){i={type:"tag",tagType:"define"},i.attributes=al(t[1]),this.trigger("data",i);return}this.trigger("data",{type:"tag",data:s.slice(4)})})}addParser({expression:e,customType:t,dataParser:i,segment:n}){typeof i!="function"&&(i=s=>s),this.customParsers.push(s=>{if(e.exec(s))return this.trigger("data",{type:"custom",data:i(s),customType:t,segment:n}),!0})}addTagMapper({expression:e,map:t}){const i=n=>e.test(n)?t(n):n;this.tagMappers.push(i)}};const BU=r=>r.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),gp=function(r){const e={};return Object.keys(r).forEach(function(t){e[BU(t)]=r[t]}),e},qA=function(r){const{serverControl:e,targetDuration:t,partTargetDuration:i}=r;if(!e)return;const n="#EXT-X-SERVER-CONTROL",s="holdBack",a="partHoldBack",c=t&&t*3,h=i&&i*2;t&&!e.hasOwnProperty(s)&&(e[s]=c,this.trigger("info",{message:`${n} defaulting HOLD-BACK to targetDuration * 3 (${c}).`})),c&&e[s]<c&&(this.trigger("warn",{message:`${n} clamping HOLD-BACK (${e[s]}) to targetDuration * 3 (${c})`}),e[s]=c),i&&!e.hasOwnProperty(a)&&(e[a]=i*3,this.trigger("info",{message:`${n} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[a]}).`})),i&&e[a]<h&&(this.trigger("warn",{message:`${n} clamping PART-HOLD-BACK (${e[a]}) to partTargetDuration * 2 (${h}).`}),e[a]=h)};let NU=class extends F2{constructor(e={}){super(),this.lineStream=new RU,this.parseStream=new FU,this.lineStream.pipe(this.parseStream),this.mainDefinitions=e.mainDefinitions||{},this.params=new URL(e.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;const t=this,i=[];let n={},s,a,c=!1;const h=function(){},m={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},v="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let b=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};let x=0,C=0;const B={};this.on("end",()=>{n.uri||!n.parts&&!n.preloadHints||(!n.map&&s&&(n.map=s),!n.key&&a&&(n.key=a),!n.timeline&&typeof b=="number"&&(n.timeline=b),this.manifest.preloadSegment=n)}),this.parseStream.on("data",function(P){let N,ae;if(t.manifest.definitions){for(const X in t.manifest.definitions)if(P.uri&&(P.uri=P.uri.replace(`{$${X}}`,t.manifest.definitions[X])),P.attributes)for(const de in P.attributes)typeof P.attributes[de]=="string"&&(P.attributes[de]=P.attributes[de].replace(`{$${X}}`,t.manifest.definitions[X]))}({tag(){({version(){P.version&&(this.manifest.version=P.version)},"allow-cache"(){this.manifest.allowCache=P.allowed,"allowed"in P||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const X={};"length"in P&&(n.byterange=X,X.length=P.length,"offset"in P||(P.offset=x)),"offset"in P&&(n.byterange=X,X.offset=P.offset),x=X.offset+X.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),P.title&&(n.title=P.title),P.duration>0&&(n.duration=P.duration),P.duration===0&&(n.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=i},key(){if(!P.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(P.attributes.METHOD==="NONE"){a=null;return}if(!P.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(P.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:P.attributes};return}if(P.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:P.attributes.URI};return}if(P.attributes.KEYFORMAT===v){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(P.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(P.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),P.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(P.attributes.KEYID&&P.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:P.attributes.KEYFORMAT,keyId:P.attributes.KEYID.substring(2)},pssh:NR(P.attributes.URI.split(",")[1])};return}P.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:P.attributes.METHOD||"AES-128",uri:P.attributes.URI},typeof P.attributes.IV<"u"&&(a.iv=P.attributes.IV)},"media-sequence"(){if(!isFinite(P.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+P.number});return}this.manifest.mediaSequence=P.number},"discontinuity-sequence"(){if(!isFinite(P.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+P.number});return}this.manifest.discontinuitySequence=P.number,b=P.number},"playlist-type"(){if(!/VOD|EVENT/.test(P.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+P.playlist});return}this.manifest.playlistType=P.playlistType},map(){s={},P.uri&&(s.uri=P.uri),P.byterange&&(s.byterange=P.byterange),a&&(s.key=a)},"stream-inf"(){if(this.manifest.playlists=i,this.manifest.mediaGroups=this.manifest.mediaGroups||m,!P.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}n.attributes||(n.attributes={}),zr(n.attributes,P.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||m,!(P.attributes&&P.attributes.TYPE&&P.attributes["GROUP-ID"]&&P.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const X=this.manifest.mediaGroups[P.attributes.TYPE];X[P.attributes["GROUP-ID"]]=X[P.attributes["GROUP-ID"]]||{},N=X[P.attributes["GROUP-ID"]],ae={default:/yes/i.test(P.attributes.DEFAULT)},ae.default?ae.autoselect=!0:ae.autoselect=/yes/i.test(P.attributes.AUTOSELECT),P.attributes.LANGUAGE&&(ae.language=P.attributes.LANGUAGE),P.attributes.URI&&(ae.uri=P.attributes.URI),P.attributes["INSTREAM-ID"]&&(ae.instreamId=P.attributes["INSTREAM-ID"]),P.attributes.CHARACTERISTICS&&(ae.characteristics=P.attributes.CHARACTERISTICS),P.attributes.FORCED&&(ae.forced=/yes/i.test(P.attributes.FORCED)),N[P.attributes.NAME]=ae},discontinuity(){b+=1,n.discontinuity=!0,this.manifest.discontinuityStarts.push(i.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=P.dateTimeString,this.manifest.dateTimeObject=P.dateTimeObject),n.dateTimeString=P.dateTimeString,n.dateTimeObject=P.dateTimeObject;const{lastProgramDateTime:X}=this;this.lastProgramDateTime=new Date(P.dateTimeString).getTime(),X===null&&this.manifest.segments.reduceRight((de,ge)=>(ge.programDateTime=de-ge.duration*1e3,ge.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(P.duration)||P.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+P.duration});return}this.manifest.targetDuration=P.duration,qA.call(this,this.manifest)},start(){if(!P.attributes||isNaN(P.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:P.attributes["TIME-OFFSET"],precise:P.attributes.PRECISE}},"cue-out"(){n.cueOut=P.data},"cue-out-cont"(){n.cueOutCont=P.data},"cue-in"(){n.cueIn=P.data},skip(){this.manifest.skip=gp(P.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",P.attributes,["SKIPPED-SEGMENTS"])},part(){c=!0;const X=this.manifest.segments.length,de=gp(P.attributes);n.parts=n.parts||[],n.parts.push(de),de.byterange&&(de.byterange.hasOwnProperty("offset")||(de.byterange.offset=C),C=de.byterange.offset+de.byterange.length);const ge=n.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${ge} for segment #${X}`,P.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((ue,be)=>{ue.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${be} lacks required attribute(s): LAST-PART`})})},"server-control"(){const X=this.manifest.serverControl=gp(P.attributes);X.hasOwnProperty("canBlockReload")||(X.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),qA.call(this,this.manifest),X.canSkipDateranges&&!X.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const X=this.manifest.segments.length,de=gp(P.attributes),ge=de.type&&de.type==="PART";n.preloadHints=n.preloadHints||[],n.preloadHints.push(de),de.byterange&&(de.byterange.hasOwnProperty("offset")||(de.byterange.offset=ge?C:0,ge&&(C=de.byterange.offset+de.byterange.length)));const ue=n.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${ue} for segment #${X}`,P.attributes,["TYPE","URI"]),!!de.type)for(let be=0;be<n.preloadHints.length-1;be++){const fe=n.preloadHints[be];fe.type&&fe.type===de.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${ue} for segment #${X} has the same TYPE ${de.type} as preload hint #${be}`})}},"rendition-report"(){const X=gp(P.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(X);const de=this.manifest.renditionReports.length-1,ge=["LAST-MSN","URI"];c&&ge.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${de}`,P.attributes,ge)},"part-inf"(){this.manifest.partInf=gp(P.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",P.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),qA.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(gp(P.attributes));const X=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${X}`,P.attributes,["ID","START-DATE"]);const de=this.manifest.dateRanges[X];de.endDate&&de.startDate&&new Date(de.endDate)<new Date(de.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),de.duration&&de.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),de.plannedDuration&&de.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const ge=!!de.endOnNext;if(ge&&!de.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),ge&&(de.duration||de.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),de.duration&&de.endDate){const be=de.startDate.getTime()+de.duration*1e3;this.manifest.dateRanges[X].endDate=new Date(be)}if(!B[de.id])B[de.id]=de;else{for(const be in B[de.id])if(de[be]&&JSON.stringify(B[de.id][be])!==JSON.stringify(de[be])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const ue=this.manifest.dateRanges.findIndex(be=>be.id===de.id);this.manifest.dateRanges[ue]=zr(this.manifest.dateRanges[ue],de),B[de.id]=zr(B[de.id],de),this.manifest.dateRanges.pop()}},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=gp(P.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",P.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};const X=(de,ge)=>{if(de in this.manifest.definitions){this.trigger("error",{message:`EXT-X-DEFINE: Duplicate name ${de}`});return}this.manifest.definitions[de]=ge};if("QUERYPARAM"in P.attributes){if("NAME"in P.attributes||"IMPORT"in P.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}const de=this.params.get(P.attributes.QUERYPARAM);if(!de){this.trigger("error",{message:`EXT-X-DEFINE: No query param ${P.attributes.QUERYPARAM}`});return}X(P.attributes.QUERYPARAM,decodeURIComponent(de));return}if("NAME"in P.attributes){if("IMPORT"in P.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}if(!("VALUE"in P.attributes)||typeof P.attributes.VALUE!="string"){this.trigger("error",{message:`EXT-X-DEFINE: No value for ${P.attributes.NAME}`});return}X(P.attributes.NAME,P.attributes.VALUE);return}if("IMPORT"in P.attributes){if(!this.mainDefinitions[P.attributes.IMPORT]){this.trigger("error",{message:`EXT-X-DEFINE: No value ${P.attributes.IMPORT} to import, or IMPORT used on main playlist`});return}X(P.attributes.IMPORT,this.mainDefinitions[P.attributes.IMPORT]);return}this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:P.attributes,uri:P.uri,timeline:b}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",P.attributes,["BANDWIDTH","URI"])}}[P.tagType]||h).call(t)},uri(){n.uri=P.uri,i.push(n),this.manifest.targetDuration&&!("duration"in n)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),n.duration=this.manifest.targetDuration),a&&(n.key=a),n.timeline=b,s&&(n.map=s),C=0,this.lastProgramDateTime!==null&&(n.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=n.duration*1e3),n={}},comment(){},custom(){P.segment?(n.custom=n.custom||{},n.custom[P.customType]=P.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[P.customType]=P.data)}})[P.type].call(t)})}requiredCompatibilityversion(e,t){(e<t||!e)&&this.trigger("warn",{message:`manifest must be at least version ${t}`})}warnOnMissingAttributes_(e,t,i){const n=[];i.forEach(function(s){t.hasOwnProperty(s)||n.push(s)}),n.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${n.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}};var zm={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},UU=["video","audio","text"],YD=["Video","Audio","Text"],UR=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(t,i,n){var s=("00"+Number(i).toString(16)).slice(-2),a=("00"+Number(n).toString(16)).slice(-2);return"avc1."+s+"00"+a})},Kd=function(e){e===void 0&&(e="");var t=e.split(","),i=[];return t.forEach(function(n){n=n.trim();var s;UU.forEach(function(a){var c=zm[a].exec(n.toLowerCase());if(!(!c||c.length<=1)){s=a;var h=n.substring(0,c[1].length),m=n.replace(h,"");i.push({type:h,details:m,mediaType:a})}}),s||i.push({type:n,details:"",mediaType:"unknown"})}),i},VU=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var i=e.mediaGroups.AUDIO[t];if(!i)return null;for(var n in i){var s=i[n];if(s.default&&s.playlists)return Kd(s.playlists[0].attributes.CODECS)}return null},VR=function(e){return e===void 0&&(e=""),zm.audio.test(e.trim().toLowerCase())},zU=function(e){return e===void 0&&(e=""),zm.text.test(e.trim().toLowerCase())},R0=function(e){if(!(!e||typeof e!="string")){var t=e.toLowerCase().split(",").map(function(s){return UR(s.trim())}),i="video";t.length===1&&VR(t[0])?i="audio":t.length===1&&zU(t[0])&&(i="application");var n="mp4";return t.every(function(s){return zm.mp4.test(s)})?n="mp4":t.every(function(s){return zm.webm.test(s)})?n="webm":t.every(function(s){return zm.ogg.test(s)})&&(n="ogg"),i+"/"+n+';codecs="'+e+'"'}},u_=function(e,t){return e===void 0&&(e=""),t===void 0&&(t=!1),Z.MediaSource&&Z.MediaSource.isTypeSupported&&Z.MediaSource.isTypeSupported(R0(e))||t&&Z.ManagedMediaSource&&Z.ManagedMediaSource.isTypeSupported&&Z.ManagedMediaSource.isTypeSupported(R0(e))||!1},XA=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(t){t=t.trim();for(var i=0;i<YD.length;i++){var n=YD[i];if(zm["muxer"+n].test(t))return!0}return!1})},QD="mp4a.40.2",HU="avc1.4d400d",jU=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,GU=/^application\/dash\+xml/i,zR=function(e){return jU.test(e)?"hls":GU.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null},$U=function(e){return e.toString(2).length},WU=function(e){return Math.ceil($U(e)/8)},HR=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},qU=function(e){return HR(e)},en=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!qU(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},uo=Z.BigInt||Number,sE=[uo("0x1"),uo("0x100"),uo("0x10000"),uo("0x1000000"),uo("0x100000000"),uo("0x10000000000"),uo("0x1000000000000"),uo("0x100000000000000"),uo("0x10000000000000000")];(function(){var r=new Uint16Array([65484]),e=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"})();var XU=function(e,t){var i=t===void 0?{}:t,n=i.signed,s=n===void 0?!1:n,a=i.le,c=a===void 0?!1:a;e=en(e);var h=c?"reduce":"reduceRight",m=e[h]?e[h]:Array.prototype[h],v=m.call(e,function(x,C,B){var P=c?B:Math.abs(B+1-e.length);return x+uo(C)*sE[P]},uo(0));if(s){var b=sE[e.length]/uo(2)-uo(1);v=uo(v),v>b&&(v-=b,v-=b,v-=uo(2))}return Number(v)},YU=function(e,t){var i={},n=i.le,s=n===void 0?!1:n;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=uo(e);for(var a=WU(e),c=new Uint8Array(new ArrayBuffer(a)),h=0;h<a;h++){var m=s?h:Math.abs(h+1-c.length);c[m]=Number(e/sE[h]&uo(255)),e<0&&(c[m]=Math.abs(~c[m]),c[m]-=h===0?1:2)}return c},jR=function(e,t){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;t||(e=unescape(encodeURIComponent(e)));for(var i=new Uint8Array(e.length),n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return i},QU=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(t=t.filter(function(c){return c&&(c.byteLength||c.length)&&typeof c!="string"}),t.length<=1)return en(t[0]);var n=t.reduce(function(c,h,m){return c+(h.byteLength||h.length)},0),s=new Uint8Array(n),a=0;return t.forEach(function(c){c=en(c),s.set(c,a),a+=c.byteLength}),s},Ms=function(e,t,i){var n=i===void 0?{}:i,s=n.offset,a=s===void 0?0:s,c=n.mask,h=c===void 0?[]:c;e=en(e),t=en(t);var m=t.every?t.every:Array.prototype.every;return t.length&&e.length-a>=t.length&&m.call(t,function(v,b){var x=h[b]?h[b]&e[a+b]:e[a+b];return v===x})},KU=function(e,t,i){t.forEach(function(n){for(var s in e.mediaGroups[n])for(var a in e.mediaGroups[n][s]){var c=e.mediaGroups[n][s][a];i(c,n,s,a)}})},Vy={},af={},_m={},KD;function Xx(){if(KD)return _m;KD=1;function r(s,a,c){if(c===void 0&&(c=Array.prototype),s&&typeof c.find=="function")return c.find.call(s,a);for(var h=0;h<s.length;h++)if(Object.prototype.hasOwnProperty.call(s,h)){var m=s[h];if(a.call(void 0,m,h,s))return m}}function e(s,a){return a===void 0&&(a=Object),a&&typeof a.freeze=="function"?a.freeze(s):s}function t(s,a){if(s===null||typeof s!="object")throw new TypeError("target is not an object");for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(s[c]=a[c]);return s}var i=e({HTML:"text/html",isHTML:function(s){return s===i.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),n=e({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(s){return s===n.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return _m.assign=t,_m.find=r,_m.freeze=e,_m.MIME_TYPE=i,_m.NAMESPACE=n,_m}var ZD;function GR(){if(ZD)return af;ZD=1;var r=Xx(),e=r.find,t=r.NAMESPACE;function i(ne){return ne!==""}function n(ne){return ne?ne.split(/[\t\n\f\r ]+/).filter(i):[]}function s(ne,oe){return ne.hasOwnProperty(oe)||(ne[oe]=!0),ne}function a(ne){if(!ne)return[];var oe=n(ne);return Object.keys(oe.reduce(s,{}))}function c(ne){return function(oe){return ne&&ne.indexOf(oe)!==-1}}function h(ne,oe){for(var xe in ne)Object.prototype.hasOwnProperty.call(ne,xe)&&(oe[xe]=ne[xe])}function m(ne,oe){var xe=ne.prototype;if(!(xe instanceof oe)){let Ye=function(){};Ye.prototype=oe.prototype,Ye=new Ye,h(xe,Ye),ne.prototype=xe=Ye}xe.constructor!=ne&&(typeof ne!="function"&&console.error("unknown Class:"+ne),xe.constructor=ne)}var v={},b=v.ELEMENT_NODE=1,x=v.ATTRIBUTE_NODE=2,C=v.TEXT_NODE=3,B=v.CDATA_SECTION_NODE=4,P=v.ENTITY_REFERENCE_NODE=5,N=v.ENTITY_NODE=6,ae=v.PROCESSING_INSTRUCTION_NODE=7,X=v.COMMENT_NODE=8,de=v.DOCUMENT_NODE=9,ge=v.DOCUMENT_TYPE_NODE=10,ue=v.DOCUMENT_FRAGMENT_NODE=11,be=v.NOTATION_NODE=12,fe={},ve={};fe.INDEX_SIZE_ERR=(ve[1]="Index size error",1),fe.DOMSTRING_SIZE_ERR=(ve[2]="DOMString size error",2);var ie=fe.HIERARCHY_REQUEST_ERR=(ve[3]="Hierarchy request error",3);fe.WRONG_DOCUMENT_ERR=(ve[4]="Wrong document",4),fe.INVALID_CHARACTER_ERR=(ve[5]="Invalid character",5),fe.NO_DATA_ALLOWED_ERR=(ve[6]="No data allowed",6),fe.NO_MODIFICATION_ALLOWED_ERR=(ve[7]="No modification allowed",7);var re=fe.NOT_FOUND_ERR=(ve[8]="Not found",8);fe.NOT_SUPPORTED_ERR=(ve[9]="Not supported",9);var Ne=fe.INUSE_ATTRIBUTE_ERR=(ve[10]="Attribute in use",10);fe.INVALID_STATE_ERR=(ve[11]="Invalid state",11),fe.SYNTAX_ERR=(ve[12]="Syntax error",12),fe.INVALID_MODIFICATION_ERR=(ve[13]="Invalid modification",13),fe.NAMESPACE_ERR=(ve[14]="Invalid namespace",14),fe.INVALID_ACCESS_ERR=(ve[15]="Invalid access",15);function De(ne,oe){if(oe instanceof Error)var xe=oe;else xe=this,Error.call(this,ve[ne]),this.message=ve[ne],Error.captureStackTrace&&Error.captureStackTrace(this,De);return xe.code=ne,oe&&(this.message=this.message+": "+oe),xe}De.prototype=Error.prototype,h(fe,De);function ke(){}ke.prototype={length:0,item:function(ne){return ne>=0&&ne<this.length?this[ne]:null},toString:function(ne,oe){for(var xe=[],Ye=0;Ye<this.length;Ye++)Fn(this[Ye],xe,ne,oe);return xe.join("")},filter:function(ne){return Array.prototype.filter.call(this,ne)},indexOf:function(ne){return Array.prototype.indexOf.call(this,ne)}};function ut(ne,oe){this._node=ne,this._refresh=oe,_t(this)}function _t(ne){var oe=ne._node._inc||ne._node.ownerDocument._inc;if(ne._inc!==oe){var xe=ne._refresh(ne._node);if(pi(ne,"length",xe.length),!ne.$$length||xe.length<ne.$$length)for(var Ye=xe.length;Ye in ne;Ye++)Object.prototype.hasOwnProperty.call(ne,Ye)&&delete ne[Ye];h(xe,ne),ne._inc=oe}}ut.prototype.item=function(ne){return _t(this),this[ne]||null},m(ut,ke);function vt(){}function tt(ne,oe){for(var xe=ne.length;xe--;)if(ne[xe]===oe)return xe}function je(ne,oe,xe,Ye){if(Ye?oe[tt(oe,Ye)]=xe:oe[oe.length++]=xe,ne){xe.ownerElement=ne;var jt=ne.ownerDocument;jt&&(Ye&&lt(jt,ne,Ye),Re(jt,ne,xe))}}function it(ne,oe,xe){var Ye=tt(oe,xe);if(Ye>=0){for(var jt=oe.length-1;Ye<jt;)oe[Ye]=oe[++Ye];if(oe.length=jt,ne){var bi=ne.ownerDocument;bi&&(lt(bi,ne,xe),xe.ownerElement=null)}}else throw new De(re,new Error(ne.tagName+"@"+xe))}vt.prototype={length:0,item:ke.prototype.item,getNamedItem:function(ne){for(var oe=this.length;oe--;){var xe=this[oe];if(xe.nodeName==ne)return xe}},setNamedItem:function(ne){var oe=ne.ownerElement;if(oe&&oe!=this._ownerElement)throw new De(Ne);var xe=this.getNamedItem(ne.nodeName);return je(this._ownerElement,this,ne,xe),xe},setNamedItemNS:function(ne){var oe=ne.ownerElement,xe;if(oe&&oe!=this._ownerElement)throw new De(Ne);return xe=this.getNamedItemNS(ne.namespaceURI,ne.localName),je(this._ownerElement,this,ne,xe),xe},removeNamedItem:function(ne){var oe=this.getNamedItem(ne);return it(this._ownerElement,this,oe),oe},removeNamedItemNS:function(ne,oe){var xe=this.getNamedItemNS(ne,oe);return it(this._ownerElement,this,xe),xe},getNamedItemNS:function(ne,oe){for(var xe=this.length;xe--;){var Ye=this[xe];if(Ye.localName==oe&&Ye.namespaceURI==ne)return Ye}return null}};function Xe(){}Xe.prototype={hasFeature:function(ne,oe){return!0},createDocument:function(ne,oe,xe){var Ye=new ii;if(Ye.implementation=this,Ye.childNodes=new ke,Ye.doctype=xe||null,xe&&Ye.appendChild(xe),oe){var jt=Ye.createElementNS(ne,oe);Ye.appendChild(jt)}return Ye},createDocumentType:function(ne,oe,xe){var Ye=new ds;return Ye.name=ne,Ye.nodeName=ne,Ye.publicId=oe||"",Ye.systemId=xe||"",Ye}};function Se(){}Se.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(ne,oe){return sn(this,ne,oe)},replaceChild:function(ne,oe){sn(this,ne,oe,cs),oe&&this.removeChild(oe)},removeChild:function(ne){return Je(this,ne)},appendChild:function(ne){return this.insertBefore(ne,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(ne){return Zi(this.ownerDocument||this,this,ne)},normalize:function(){for(var ne=this.firstChild;ne;){var oe=ne.nextSibling;oe&&oe.nodeType==C&&ne.nodeType==C?(this.removeChild(oe),ne.appendData(oe.data)):(ne.normalize(),ne=oe)}},isSupported:function(ne,oe){return this.ownerDocument.implementation.hasFeature(ne,oe)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(ne){for(var oe=this;oe;){var xe=oe._nsMap;if(xe){for(var Ye in xe)if(Object.prototype.hasOwnProperty.call(xe,Ye)&&xe[Ye]===ne)return Ye}oe=oe.nodeType==x?oe.ownerDocument:oe.parentNode}return null},lookupNamespaceURI:function(ne){for(var oe=this;oe;){var xe=oe._nsMap;if(xe&&Object.prototype.hasOwnProperty.call(xe,ne))return xe[ne];oe=oe.nodeType==x?oe.ownerDocument:oe.parentNode}return null},isDefaultNamespace:function(ne){var oe=this.lookupPrefix(ne);return oe==null}};function ct(ne){return ne=="<"&&"&lt;"||ne==">"&&"&gt;"||ne=="&"&&"&amp;"||ne=='"'&&"&quot;"||"&#"+ne.charCodeAt()+";"}h(v,Se),h(v,Se.prototype);function xt(ne,oe){if(oe(ne))return!0;if(ne=ne.firstChild)do if(xt(ne,oe))return!0;while(ne=ne.nextSibling)}function ii(){this.ownerDocument=this}function Re(ne,oe,xe){ne&&ne._inc++;var Ye=xe.namespaceURI;Ye===t.XMLNS&&(oe._nsMap[xe.prefix?xe.localName:""]=xe.value)}function lt(ne,oe,xe,Ye){ne&&ne._inc++;var jt=xe.namespaceURI;jt===t.XMLNS&&delete oe._nsMap[xe.prefix?xe.localName:""]}function bt(ne,oe,xe){if(ne&&ne._inc){ne._inc++;var Ye=oe.childNodes;if(xe)Ye[Ye.length++]=xe;else{for(var jt=oe.firstChild,bi=0;jt;)Ye[bi++]=jt,jt=jt.nextSibling;Ye.length=bi,delete Ye[Ye.length]}}}function Je(ne,oe){var xe=oe.previousSibling,Ye=oe.nextSibling;return xe?xe.nextSibling=Ye:ne.firstChild=Ye,Ye?Ye.previousSibling=xe:ne.lastChild=xe,oe.parentNode=null,oe.previousSibling=null,oe.nextSibling=null,bt(ne.ownerDocument,ne),oe}function Dt(ne){return ne&&(ne.nodeType===Se.DOCUMENT_NODE||ne.nodeType===Se.DOCUMENT_FRAGMENT_NODE||ne.nodeType===Se.ELEMENT_NODE)}function Yt(ne){return ne&&(xi(ne)||Yi(ne)||vi(ne)||ne.nodeType===Se.DOCUMENT_FRAGMENT_NODE||ne.nodeType===Se.COMMENT_NODE||ne.nodeType===Se.PROCESSING_INSTRUCTION_NODE)}function vi(ne){return ne&&ne.nodeType===Se.DOCUMENT_TYPE_NODE}function xi(ne){return ne&&ne.nodeType===Se.ELEMENT_NODE}function Yi(ne){return ne&&ne.nodeType===Se.TEXT_NODE}function Ki(ne,oe){var xe=ne.childNodes||[];if(e(xe,xi)||vi(oe))return!1;var Ye=e(xe,vi);return!(oe&&Ye&&xe.indexOf(Ye)>xe.indexOf(oe))}function io(ne,oe){var xe=ne.childNodes||[];function Ye(bi){return xi(bi)&&bi!==oe}if(e(xe,Ye))return!1;var jt=e(xe,vi);return!(oe&&jt&&xe.indexOf(jt)>xe.indexOf(oe))}function yr(ne,oe,xe){if(!Dt(ne))throw new De(ie,"Unexpected parent node type "+ne.nodeType);if(xe&&xe.parentNode!==ne)throw new De(re,"child not in parent");if(!Yt(oe)||vi(oe)&&ne.nodeType!==Se.DOCUMENT_NODE)throw new De(ie,"Unexpected node type "+oe.nodeType+" for parent node type "+ne.nodeType)}function bs(ne,oe,xe){var Ye=ne.childNodes||[],jt=oe.childNodes||[];if(oe.nodeType===Se.DOCUMENT_FRAGMENT_NODE){var bi=jt.filter(xi);if(bi.length>1||e(jt,Yi))throw new De(ie,"More than one element or text in fragment");if(bi.length===1&&!Ki(ne,xe))throw new De(ie,"Element in fragment can not be inserted before doctype")}if(xi(oe)&&!Ki(ne,xe))throw new De(ie,"Only one element can be added and only after doctype");if(vi(oe)){if(e(Ye,vi))throw new De(ie,"Only one doctype is allowed");var Ui=e(Ye,xi);if(xe&&Ye.indexOf(Ui)<Ye.indexOf(xe))throw new De(ie,"Doctype can only be inserted before an element");if(!xe&&Ui)throw new De(ie,"Doctype can not be appended since element is present")}}function cs(ne,oe,xe){var Ye=ne.childNodes||[],jt=oe.childNodes||[];if(oe.nodeType===Se.DOCUMENT_FRAGMENT_NODE){var bi=jt.filter(xi);if(bi.length>1||e(jt,Yi))throw new De(ie,"More than one element or text in fragment");if(bi.length===1&&!io(ne,xe))throw new De(ie,"Element in fragment can not be inserted before doctype")}if(xi(oe)&&!io(ne,xe))throw new De(ie,"Only one element can be added and only after doctype");if(vi(oe)){if(e(Ye,function(Kr){return vi(Kr)&&Kr!==xe}))throw new De(ie,"Only one doctype is allowed");var Ui=e(Ye,xi);if(xe&&Ye.indexOf(Ui)<Ye.indexOf(xe))throw new De(ie,"Doctype can only be inserted before an element")}}function sn(ne,oe,xe,Ye){yr(ne,oe,xe),ne.nodeType===Se.DOCUMENT_NODE&&(Ye||bs)(ne,oe,xe);var jt=oe.parentNode;if(jt&&jt.removeChild(oe),oe.nodeType===ue){var bi=oe.firstChild;if(bi==null)return oe;var Ui=oe.lastChild}else bi=Ui=oe;var Qr=xe?xe.previousSibling:ne.lastChild;bi.previousSibling=Qr,Ui.nextSibling=xe,Qr?Qr.nextSibling=bi:ne.firstChild=bi,xe==null?ne.lastChild=Ui:xe.previousSibling=Ui;do bi.parentNode=ne;while(bi!==Ui&&(bi=bi.nextSibling));return bt(ne.ownerDocument||ne,ne),oe.nodeType==ue&&(oe.firstChild=oe.lastChild=null),oe}function dn(ne,oe){return oe.parentNode&&oe.parentNode.removeChild(oe),oe.parentNode=ne,oe.previousSibling=ne.lastChild,oe.nextSibling=null,oe.previousSibling?oe.previousSibling.nextSibling=oe:ne.firstChild=oe,ne.lastChild=oe,bt(ne.ownerDocument,ne,oe),oe}ii.prototype={nodeName:"#document",nodeType:de,doctype:null,documentElement:null,_inc:1,insertBefore:function(ne,oe){if(ne.nodeType==ue){for(var xe=ne.firstChild;xe;){var Ye=xe.nextSibling;this.insertBefore(xe,oe),xe=Ye}return ne}return sn(this,ne,oe),ne.ownerDocument=this,this.documentElement===null&&ne.nodeType===b&&(this.documentElement=ne),ne},removeChild:function(ne){return this.documentElement==ne&&(this.documentElement=null),Je(this,ne)},replaceChild:function(ne,oe){sn(this,ne,oe,cs),ne.ownerDocument=this,oe&&this.removeChild(oe),xi(ne)&&(this.documentElement=ne)},importNode:function(ne,oe){return Ar(this,ne,oe)},getElementById:function(ne){var oe=null;return xt(this.documentElement,function(xe){if(xe.nodeType==b&&xe.getAttribute("id")==ne)return oe=xe,!0}),oe},getElementsByClassName:function(ne){var oe=a(ne);return new ut(this,function(xe){var Ye=[];return oe.length>0&&xt(xe.documentElement,function(jt){if(jt!==xe&&jt.nodeType===b){var bi=jt.getAttribute("class");if(bi){var Ui=ne===bi;if(!Ui){var Qr=a(bi);Ui=oe.every(c(Qr))}Ui&&Ye.push(jt)}}}),Ye})},createElement:function(ne){var oe=new gn;oe.ownerDocument=this,oe.nodeName=ne,oe.tagName=ne,oe.localName=ne,oe.childNodes=new ke;var xe=oe.attributes=new vt;return xe._ownerElement=oe,oe},createDocumentFragment:function(){var ne=new an;return ne.ownerDocument=this,ne.childNodes=new ke,ne},createTextNode:function(ne){var oe=new Oa;return oe.ownerDocument=this,oe.appendData(ne),oe},createComment:function(ne){var oe=new Js;return oe.ownerDocument=this,oe.appendData(ne),oe},createCDATASection:function(ne){var oe=new Sa;return oe.ownerDocument=this,oe.appendData(ne),oe},createProcessingInstruction:function(ne,oe){var xe=new Ze;return xe.ownerDocument=this,xe.tagName=xe.nodeName=xe.target=ne,xe.nodeValue=xe.data=oe,xe},createAttribute:function(ne){var oe=new Sr;return oe.ownerDocument=this,oe.name=ne,oe.nodeName=ne,oe.localName=ne,oe.specified=!0,oe},createEntityReference:function(ne){var oe=new Aa;return oe.ownerDocument=this,oe.nodeName=ne,oe},createElementNS:function(ne,oe){var xe=new gn,Ye=oe.split(":"),jt=xe.attributes=new vt;return xe.childNodes=new ke,xe.ownerDocument=this,xe.nodeName=oe,xe.tagName=oe,xe.namespaceURI=ne,Ye.length==2?(xe.prefix=Ye[0],xe.localName=Ye[1]):xe.localName=oe,jt._ownerElement=xe,xe},createAttributeNS:function(ne,oe){var xe=new Sr,Ye=oe.split(":");return xe.ownerDocument=this,xe.nodeName=oe,xe.name=oe,xe.namespaceURI=ne,xe.specified=!0,Ye.length==2?(xe.prefix=Ye[0],xe.localName=Ye[1]):xe.localName=oe,xe}},m(ii,Se);function gn(){this._nsMap={}}gn.prototype={nodeType:b,hasAttribute:function(ne){return this.getAttributeNode(ne)!=null},getAttribute:function(ne){var oe=this.getAttributeNode(ne);return oe&&oe.value||""},getAttributeNode:function(ne){return this.attributes.getNamedItem(ne)},setAttribute:function(ne,oe){var xe=this.ownerDocument.createAttribute(ne);xe.value=xe.nodeValue=""+oe,this.setAttributeNode(xe)},removeAttribute:function(ne){var oe=this.getAttributeNode(ne);oe&&this.removeAttributeNode(oe)},appendChild:function(ne){return ne.nodeType===ue?this.insertBefore(ne,null):dn(this,ne)},setAttributeNode:function(ne){return this.attributes.setNamedItem(ne)},setAttributeNodeNS:function(ne){return this.attributes.setNamedItemNS(ne)},removeAttributeNode:function(ne){return this.attributes.removeNamedItem(ne.nodeName)},removeAttributeNS:function(ne,oe){var xe=this.getAttributeNodeNS(ne,oe);xe&&this.removeAttributeNode(xe)},hasAttributeNS:function(ne,oe){return this.getAttributeNodeNS(ne,oe)!=null},getAttributeNS:function(ne,oe){var xe=this.getAttributeNodeNS(ne,oe);return xe&&xe.value||""},setAttributeNS:function(ne,oe,xe){var Ye=this.ownerDocument.createAttributeNS(ne,oe);Ye.value=Ye.nodeValue=""+xe,this.setAttributeNode(Ye)},getAttributeNodeNS:function(ne,oe){return this.attributes.getNamedItemNS(ne,oe)},getElementsByTagName:function(ne){return new ut(this,function(oe){var xe=[];return xt(oe,function(Ye){Ye!==oe&&Ye.nodeType==b&&(ne==="*"||Ye.tagName==ne)&&xe.push(Ye)}),xe})},getElementsByTagNameNS:function(ne,oe){return new ut(this,function(xe){var Ye=[];return xt(xe,function(jt){jt!==xe&&jt.nodeType===b&&(ne==="*"||jt.namespaceURI===ne)&&(oe==="*"||jt.localName==oe)&&Ye.push(jt)}),Ye})}},ii.prototype.getElementsByTagName=gn.prototype.getElementsByTagName,ii.prototype.getElementsByTagNameNS=gn.prototype.getElementsByTagNameNS,m(gn,Se);function Sr(){}Sr.prototype.nodeType=x,m(Sr,Se);function fa(){}fa.prototype={data:"",substringData:function(ne,oe){return this.data.substring(ne,ne+oe)},appendData:function(ne){ne=this.data+ne,this.nodeValue=this.data=ne,this.length=ne.length},insertData:function(ne,oe){this.replaceData(ne,0,oe)},appendChild:function(ne){throw new Error(ve[ie])},deleteData:function(ne,oe){this.replaceData(ne,oe,"")},replaceData:function(ne,oe,xe){var Ye=this.data.substring(0,ne),jt=this.data.substring(ne+oe);xe=Ye+xe+jt,this.nodeValue=this.data=xe,this.length=xe.length}},m(fa,Se);function Oa(){}Oa.prototype={nodeName:"#text",nodeType:C,splitText:function(ne){var oe=this.data,xe=oe.substring(ne);oe=oe.substring(0,ne),this.data=this.nodeValue=oe,this.length=oe.length;var Ye=this.ownerDocument.createTextNode(xe);return this.parentNode&&this.parentNode.insertBefore(Ye,this.nextSibling),Ye}},m(Oa,fa);function Js(){}Js.prototype={nodeName:"#comment",nodeType:X},m(Js,fa);function Sa(){}Sa.prototype={nodeName:"#cdata-section",nodeType:B},m(Sa,fa);function ds(){}ds.prototype.nodeType=ge,m(ds,Se);function js(){}js.prototype.nodeType=be,m(js,Se);function Vo(){}Vo.prototype.nodeType=N,m(Vo,Se);function Aa(){}Aa.prototype.nodeType=P,m(Aa,Se);function an(){}an.prototype.nodeName="#document-fragment",an.prototype.nodeType=ue,m(an,Se);function Ze(){}Ze.prototype.nodeType=ae,m(Ze,Se);function St(){}St.prototype.serializeToString=function(ne,oe,xe){return Ft.call(ne,oe,xe)},Se.prototype.toString=Ft;function Ft(ne,oe){var xe=[],Ye=this.nodeType==9&&this.documentElement||this,jt=Ye.prefix,bi=Ye.namespaceURI;if(bi&&jt==null){var jt=Ye.lookupPrefix(bi);if(jt==null)var Ui=[{namespace:bi,prefix:null}]}return Fn(this,xe,ne,oe,Ui),xe.join("")}function di(ne,oe,xe){var Ye=ne.prefix||"",jt=ne.namespaceURI;if(!jt||Ye==="xml"&&jt===t.XML||jt===t.XMLNS)return!1;for(var bi=xe.length;bi--;){var Ui=xe[bi];if(Ui.prefix===Ye)return Ui.namespace!==jt}return!0}function Oi(ne,oe,xe){ne.push(" ",oe,'="',xe.replace(/[<>&"\t\n\r]/g,ct),'"')}function Fn(ne,oe,xe,Ye,jt){if(jt||(jt=[]),Ye)if(ne=Ye(ne),ne){if(typeof ne=="string"){oe.push(ne);return}}else return;switch(ne.nodeType){case b:var bi=ne.attributes,Ui=bi.length,Pr=ne.firstChild,Qr=ne.tagName;xe=t.isHTML(ne.namespaceURI)||xe;var Kr=Qr;if(!xe&&!ne.prefix&&ne.namespaceURI){for(var ur,wa=0;wa<bi.length;wa++)if(bi.item(wa).name==="xmlns"){ur=bi.item(wa).value;break}if(!ur)for(var pa=jt.length-1;pa>=0;pa--){var Ls=jt[pa];if(Ls.prefix===""&&Ls.namespace===ne.namespaceURI){ur=Ls.namespace;break}}if(ur!==ne.namespaceURI)for(var pa=jt.length-1;pa>=0;pa--){var Ls=jt[pa];if(Ls.namespace===ne.namespaceURI){Ls.prefix&&(Kr=Ls.prefix+":"+Qr);break}}}oe.push("<",Kr);for(var Ir=0;Ir<Ui;Ir++){var Gn=bi.item(Ir);Gn.prefix=="xmlns"?jt.push({prefix:Gn.localName,namespace:Gn.value}):Gn.nodeName=="xmlns"&&jt.push({prefix:"",namespace:Gn.value})}for(var Ir=0;Ir<Ui;Ir++){var Gn=bi.item(Ir);if(di(Gn,xe,jt)){var ln=Gn.prefix||"",Fa=Gn.namespaceURI;Oi(oe,ln?"xmlns:"+ln:"xmlns",Fa),jt.push({prefix:ln,namespace:Fa})}Fn(Gn,oe,xe,Ye,jt)}if(Qr===Kr&&di(ne,xe,jt)){var ln=ne.prefix||"",Fa=ne.namespaceURI;Oi(oe,ln?"xmlns:"+ln:"xmlns",Fa),jt.push({prefix:ln,namespace:Fa})}if(Pr||xe&&!/^(?:meta|link|img|br|hr|input)$/i.test(Qr)){if(oe.push(">"),xe&&/^script$/i.test(Qr))for(;Pr;)Pr.data?oe.push(Pr.data):Fn(Pr,oe,xe,Ye,jt.slice()),Pr=Pr.nextSibling;else for(;Pr;)Fn(Pr,oe,xe,Ye,jt.slice()),Pr=Pr.nextSibling;oe.push("</",Kr,">")}else oe.push("/>");return;case de:case ue:for(var Pr=ne.firstChild;Pr;)Fn(Pr,oe,xe,Ye,jt.slice()),Pr=Pr.nextSibling;return;case x:return Oi(oe,ne.name,ne.value);case C:return oe.push(ne.data.replace(/[<&>]/g,ct));case B:return oe.push("<![CDATA[",ne.data,"]]>");case X:return oe.push("<!--",ne.data,"-->");case ge:var ea=ne.publicId,no=ne.systemId;if(oe.push("<!DOCTYPE ",ne.name),ea)oe.push(" PUBLIC ",ea),no&&no!="."&&oe.push(" ",no),oe.push(">");else if(no&&no!=".")oe.push(" SYSTEM ",no,">");else{var nn=ne.internalSubset;nn&&oe.push(" [",nn,"]"),oe.push(">")}return;case ae:return oe.push("<?",ne.target," ",ne.data,"?>");case P:return oe.push("&",ne.nodeName,";");default:oe.push("??",ne.nodeName)}}function Ar(ne,oe,xe){var Ye;switch(oe.nodeType){case b:Ye=oe.cloneNode(!1),Ye.ownerDocument=ne;case ue:break;case x:xe=!0;break}if(Ye||(Ye=oe.cloneNode(!1)),Ye.ownerDocument=ne,Ye.parentNode=null,xe)for(var jt=oe.firstChild;jt;)Ye.appendChild(Ar(ne,jt,xe)),jt=jt.nextSibling;return Ye}function Zi(ne,oe,xe){var Ye=new oe.constructor;for(var jt in oe)if(Object.prototype.hasOwnProperty.call(oe,jt)){var bi=oe[jt];typeof bi!="object"&&bi!=Ye[jt]&&(Ye[jt]=bi)}switch(oe.childNodes&&(Ye.childNodes=new ke),Ye.ownerDocument=ne,Ye.nodeType){case b:var Ui=oe.attributes,Qr=Ye.attributes=new vt,Kr=Ui.length;Qr._ownerElement=Ye;for(var ur=0;ur<Kr;ur++)Ye.setAttributeNode(Zi(ne,Ui.item(ur),!0));break;case x:xe=!0}if(xe)for(var wa=oe.firstChild;wa;)Ye.appendChild(Zi(ne,wa,xe)),wa=wa.nextSibling;return Ye}function pi(ne,oe,xe){ne[oe]=xe}try{if(Object.defineProperty){let ne=function(oe){switch(oe.nodeType){case b:case ue:var xe=[];for(oe=oe.firstChild;oe;)oe.nodeType!==7&&oe.nodeType!==8&&xe.push(ne(oe)),oe=oe.nextSibling;return xe.join("");default:return oe.nodeValue}};Object.defineProperty(ut.prototype,"length",{get:function(){return _t(this),this.$$length}}),Object.defineProperty(Se.prototype,"textContent",{get:function(){return ne(this)},set:function(oe){switch(this.nodeType){case b:case ue:for(;this.firstChild;)this.removeChild(this.firstChild);(oe||String(oe))&&this.appendChild(this.ownerDocument.createTextNode(oe));break;default:this.data=oe,this.value=oe,this.nodeValue=oe}}}),pi=function(oe,xe,Ye){oe["$$"+xe]=Ye}}}catch{}return af.DocumentType=ds,af.DOMException=De,af.DOMImplementation=Xe,af.Element=gn,af.Node=Se,af.NodeList=ke,af.XMLSerializer=St,af}var zy={},YA={},JD;function ZU(){return JD||(JD=1,function(r){var e=Xx().freeze;r.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),r.HTML_ENTITIES=e({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),r.entityMap=r.HTML_ENTITIES}(YA)),YA}var X1={},eI;function JU(){if(eI)return X1;eI=1;var r=Xx().NAMESPACE,e=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,t=new RegExp("[\\-\\.0-9"+e.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+e.source+t.source+"*(?::"+e.source+t.source+"*)?$"),n=0,s=1,a=2,c=3,h=4,m=5,v=6,b=7;function x(ie,re){this.message=ie,this.locator=re,Error.captureStackTrace&&Error.captureStackTrace(this,x)}x.prototype=new Error,x.prototype.name=x.name;function C(){}C.prototype={parse:function(ie,re,Ne){var De=this.domBuilder;De.startDocument(),ge(re,re={}),B(ie,re,Ne,De,this.errorHandler),De.endDocument()}};function B(ie,re,Ne,De,ke){function ut(gn){if(gn>65535){gn-=65536;var Sr=55296+(gn>>10),fa=56320+(gn&1023);return String.fromCharCode(Sr,fa)}else return String.fromCharCode(gn)}function _t(gn){var Sr=gn.slice(1,-1);return Object.hasOwnProperty.call(Ne,Sr)?Ne[Sr]:Sr.charAt(0)==="#"?ut(parseInt(Sr.substr(1).replace("x","0x"))):(ke.error("entity not found:"+gn),gn)}function vt(gn){if(gn>ii){var Sr=ie.substring(ii,gn).replace(/&#?\w+;/g,_t);Se&&tt(ii),De.characters(Sr,0,gn-ii),ii=gn}}function tt(gn,Sr){for(;gn>=it&&(Sr=Xe.exec(ie));)je=Sr.index,it=je+Sr[0].length,Se.lineNumber++;Se.columnNumber=gn-je+1}for(var je=0,it=0,Xe=/.*(?:\r\n?|\n)|.*$/g,Se=De.locator,ct=[{currentNSMap:re}],xt={},ii=0;;){try{var Re=ie.indexOf("<",ii);if(Re<0){if(!ie.substr(ii).match(/^\s*$/)){var lt=De.doc,bt=lt.createTextNode(ie.substr(ii));lt.appendChild(bt),De.currentElement=bt}return}switch(Re>ii&&vt(Re),ie.charAt(Re+1)){case"/":var yr=ie.indexOf(">",Re+3),Je=ie.substring(Re+2,yr).replace(/[ \t\n\r]+$/g,""),Dt=ct.pop();yr<0?(Je=ie.substring(Re+2).replace(/[\s<].*/,""),ke.error("end tag name: "+Je+" is not complete:"+Dt.tagName),yr=Re+1+Je.length):Je.match(/\s</)&&(Je=Je.replace(/[\s<].*/,""),ke.error("end tag name: "+Je+" maybe not complete"),yr=Re+1+Je.length);var Yt=Dt.localNSMap,vi=Dt.tagName==Je,xi=vi||Dt.tagName&&Dt.tagName.toLowerCase()==Je.toLowerCase();if(xi){if(De.endElement(Dt.uri,Dt.localName,Je),Yt)for(var Yi in Yt)Object.prototype.hasOwnProperty.call(Yt,Yi)&&De.endPrefixMapping(Yi);vi||ke.fatalError("end tag name: "+Je+" is not match the current start tagName:"+Dt.tagName)}else ct.push(Dt);yr++;break;case"?":Se&&tt(Re),yr=be(ie,Re,De);break;case"!":Se&&tt(Re),yr=ue(ie,Re,De,ke);break;default:Se&&tt(Re);var Ki=new fe,io=ct[ct.length-1].currentNSMap,yr=N(ie,Re,Ki,io,_t,ke),bs=Ki.length;if(!Ki.closed&&de(ie,yr,Ki.tagName,xt)&&(Ki.closed=!0,Ne.nbsp||ke.warning("unclosed xml attribute")),Se&&bs){for(var cs=P(Se,{}),sn=0;sn<bs;sn++){var dn=Ki[sn];tt(dn.offset),dn.locator=P(Se,{})}De.locator=cs,ae(Ki,De,io)&&ct.push(Ki),De.locator=Se}else ae(Ki,De,io)&&ct.push(Ki);r.isHTML(Ki.uri)&&!Ki.closed?yr=X(ie,yr,Ki.tagName,_t,De):yr++}}catch(gn){if(gn instanceof x)throw gn;ke.error("element parse error: "+gn),yr=-1}yr>ii?ii=yr:vt(Math.max(Re,ii)+1)}}function P(ie,re){return re.lineNumber=ie.lineNumber,re.columnNumber=ie.columnNumber,re}function N(ie,re,Ne,De,ke,ut){function _t(Se,ct,xt){Ne.attributeNames.hasOwnProperty(Se)&&ut.fatalError("Attribute "+Se+" redefined"),Ne.addValue(Se,ct.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,ke),xt)}for(var vt,tt,je=++re,it=n;;){var Xe=ie.charAt(je);switch(Xe){case"=":if(it===s)vt=ie.slice(re,je),it=c;else if(it===a)it=c;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(it===c||it===s)if(it===s&&(ut.warning('attribute value must after "="'),vt=ie.slice(re,je)),re=je+1,je=ie.indexOf(Xe,re),je>0)tt=ie.slice(re,je),_t(vt,tt,re-1),it=m;else throw new Error("attribute value no end '"+Xe+"' match");else if(it==h)tt=ie.slice(re,je),_t(vt,tt,re),ut.warning('attribute "'+vt+'" missed start quot('+Xe+")!!"),re=je+1,it=m;else throw new Error('attribute value must after "="');break;case"/":switch(it){case n:Ne.setTagName(ie.slice(re,je));case m:case v:case b:it=b,Ne.closed=!0;case h:case s:break;case a:Ne.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return ut.error("unexpected end of input"),it==n&&Ne.setTagName(ie.slice(re,je)),je;case">":switch(it){case n:Ne.setTagName(ie.slice(re,je));case m:case v:case b:break;case h:case s:tt=ie.slice(re,je),tt.slice(-1)==="/"&&(Ne.closed=!0,tt=tt.slice(0,-1));case a:it===a&&(tt=vt),it==h?(ut.warning('attribute "'+tt+'" missed quot(")!'),_t(vt,tt,re)):((!r.isHTML(De[""])||!tt.match(/^(?:disabled|checked|selected)$/i))&&ut.warning('attribute "'+tt+'" missed value!! "'+tt+'" instead!!'),_t(tt,tt,re));break;case c:throw new Error("attribute value missed!!")}return je;case"":Xe=" ";default:if(Xe<=" ")switch(it){case n:Ne.setTagName(ie.slice(re,je)),it=v;break;case s:vt=ie.slice(re,je),it=a;break;case h:var tt=ie.slice(re,je);ut.warning('attribute "'+tt+'" missed quot(")!!'),_t(vt,tt,re);case m:it=v;break}else switch(it){case a:Ne.tagName,(!r.isHTML(De[""])||!vt.match(/^(?:disabled|checked|selected)$/i))&&ut.warning('attribute "'+vt+'" missed value!! "'+vt+'" instead2!!'),_t(vt,vt,re),re=je,it=s;break;case m:ut.warning('attribute space is required"'+vt+'"!!');case v:it=s,re=je;break;case c:it=h,re=je;break;case b:throw new Error("elements closed character '/' and '>' must be connected to")}}je++}}function ae(ie,re,Ne){for(var De=ie.tagName,ke=null,Xe=ie.length;Xe--;){var ut=ie[Xe],_t=ut.qName,vt=ut.value,Se=_t.indexOf(":");if(Se>0)var tt=ut.prefix=_t.slice(0,Se),je=_t.slice(Se+1),it=tt==="xmlns"&&je;else je=_t,tt=null,it=_t==="xmlns"&&"";ut.localName=je,it!==!1&&(ke==null&&(ke={},ge(Ne,Ne={})),Ne[it]=ke[it]=vt,ut.uri=r.XMLNS,re.startPrefixMapping(it,vt))}for(var Xe=ie.length;Xe--;){ut=ie[Xe];var tt=ut.prefix;tt&&(tt==="xml"&&(ut.uri=r.XML),tt!=="xmlns"&&(ut.uri=Ne[tt||""]))}var Se=De.indexOf(":");Se>0?(tt=ie.prefix=De.slice(0,Se),je=ie.localName=De.slice(Se+1)):(tt=null,je=ie.localName=De);var ct=ie.uri=Ne[tt||""];if(re.startElement(ct,je,De,ie),ie.closed){if(re.endElement(ct,je,De),ke)for(tt in ke)Object.prototype.hasOwnProperty.call(ke,tt)&&re.endPrefixMapping(tt)}else return ie.currentNSMap=Ne,ie.localNSMap=ke,!0}function X(ie,re,Ne,De,ke){if(/^(?:script|textarea)$/i.test(Ne)){var ut=ie.indexOf("</"+Ne+">",re),_t=ie.substring(re+1,ut);if(/[&<]/.test(_t))return/^script$/i.test(Ne)?(ke.characters(_t,0,_t.length),ut):(_t=_t.replace(/&#?\w+;/g,De),ke.characters(_t,0,_t.length),ut)}return re+1}function de(ie,re,Ne,De){var ke=De[Ne];return ke==null&&(ke=ie.lastIndexOf("</"+Ne+">"),ke<re&&(ke=ie.lastIndexOf("</"+Ne)),De[Ne]=ke),ke<re}function ge(ie,re){for(var Ne in ie)Object.prototype.hasOwnProperty.call(ie,Ne)&&(re[Ne]=ie[Ne])}function ue(ie,re,Ne,De){var ke=ie.charAt(re+2);switch(ke){case"-":if(ie.charAt(re+3)==="-"){var ut=ie.indexOf("-->",re+4);return ut>re?(Ne.comment(ie,re+4,ut-re-4),ut+3):(De.error("Unclosed comment"),-1)}else return-1;default:if(ie.substr(re+3,6)=="CDATA["){var ut=ie.indexOf("]]>",re+9);return Ne.startCDATA(),Ne.characters(ie,re+9,ut-re-9),Ne.endCDATA(),ut+3}var _t=ve(ie,re),vt=_t.length;if(vt>1&&/!doctype/i.test(_t[0][0])){var tt=_t[1][0],je=!1,it=!1;vt>3&&(/^public$/i.test(_t[2][0])?(je=_t[3][0],it=vt>4&&_t[4][0]):/^system$/i.test(_t[2][0])&&(it=_t[3][0]));var Xe=_t[vt-1];return Ne.startDTD(tt,je,it),Ne.endDTD(),Xe.index+Xe[0].length}}return-1}function be(ie,re,Ne){var De=ie.indexOf("?>",re);if(De){var ke=ie.substring(re,De).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return ke?(ke[0].length,Ne.processingInstruction(ke[1],ke[2]),De+2):-1}return-1}function fe(){this.attributeNames={}}fe.prototype={setTagName:function(ie){if(!i.test(ie))throw new Error("invalid tagName:"+ie);this.tagName=ie},addValue:function(ie,re,Ne){if(!i.test(ie))throw new Error("invalid attribute:"+ie);this.attributeNames[ie]=this.length,this[this.length++]={qName:ie,value:re,offset:Ne}},length:0,getLocalName:function(ie){return this[ie].localName},getLocator:function(ie){return this[ie].locator},getQName:function(ie){return this[ie].qName},getURI:function(ie){return this[ie].uri},getValue:function(ie){return this[ie].value}};function ve(ie,re){var Ne,De=[],ke=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(ke.lastIndex=re,ke.exec(ie);Ne=ke.exec(ie);)if(De.push(Ne),Ne[1])return De}return X1.XMLReader=C,X1.ParseError=x,X1}var tI;function e7(){if(tI)return zy;tI=1;var r=Xx(),e=GR(),t=ZU(),i=JU(),n=e.DOMImplementation,s=r.NAMESPACE,a=i.ParseError,c=i.XMLReader;function h(N){return N.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function m(N){this.options=N||{locator:{}}}m.prototype.parseFromString=function(N,ae){var X=this.options,de=new c,ge=X.domBuilder||new b,ue=X.errorHandler,be=X.locator,fe=X.xmlns||{},ve=/\/x?html?$/.test(ae),ie=ve?t.HTML_ENTITIES:t.XML_ENTITIES;be&&ge.setDocumentLocator(be),de.errorHandler=v(ue,ge,be),de.domBuilder=X.domBuilder||ge,ve&&(fe[""]=s.HTML),fe.xml=fe.xml||s.XML;var re=X.normalizeLineEndings||h;return N&&typeof N=="string"?de.parse(re(N),fe,ie):de.errorHandler.error("invalid doc source"),ge.doc};function v(N,ae,X){if(!N){if(ae instanceof b)return ae;N=ae}var de={},ge=N instanceof Function;X=X||{};function ue(be){var fe=N[be];!fe&&ge&&(fe=N.length==2?function(ve){N(be,ve)}:N),de[be]=fe&&function(ve){fe("[xmldom "+be+"]	"+ve+C(X))}||function(){}}return ue("warning"),ue("error"),ue("fatalError"),de}function b(){this.cdata=!1}function x(N,ae){ae.lineNumber=N.lineNumber,ae.columnNumber=N.columnNumber}b.prototype={startDocument:function(){this.doc=new n().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(N,ae,X,de){var ge=this.doc,ue=ge.createElementNS(N,X||ae),be=de.length;P(this,ue),this.currentElement=ue,this.locator&&x(this.locator,ue);for(var fe=0;fe<be;fe++){var N=de.getURI(fe),ve=de.getValue(fe),X=de.getQName(fe),ie=ge.createAttributeNS(N,X);this.locator&&x(de.getLocator(fe),ie),ie.value=ie.nodeValue=ve,ue.setAttributeNode(ie)}},endElement:function(N,ae,X){var de=this.currentElement;de.tagName,this.currentElement=de.parentNode},startPrefixMapping:function(N,ae){},endPrefixMapping:function(N){},processingInstruction:function(N,ae){var X=this.doc.createProcessingInstruction(N,ae);this.locator&&x(this.locator,X),P(this,X)},ignorableWhitespace:function(N,ae,X){},characters:function(N,ae,X){if(N=B.apply(this,arguments),N){if(this.cdata)var de=this.doc.createCDATASection(N);else var de=this.doc.createTextNode(N);this.currentElement?this.currentElement.appendChild(de):/^\s*$/.test(N)&&this.doc.appendChild(de),this.locator&&x(this.locator,de)}},skippedEntity:function(N){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(N){(this.locator=N)&&(N.lineNumber=0)},comment:function(N,ae,X){N=B.apply(this,arguments);var de=this.doc.createComment(N);this.locator&&x(this.locator,de),P(this,de)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(N,ae,X){var de=this.doc.implementation;if(de&&de.createDocumentType){var ge=de.createDocumentType(N,ae,X);this.locator&&x(this.locator,ge),P(this,ge),this.doc.doctype=ge}},warning:function(N){console.warn("[xmldom warning]	"+N,C(this.locator))},error:function(N){console.error("[xmldom error]	"+N,C(this.locator))},fatalError:function(N){throw new a(N,this.locator)}};function C(N){if(N)return`
@`+(N.systemId||"")+"#[line:"+N.lineNumber+",col:"+N.columnNumber+"]"}function B(N,ae,X){return typeof N=="string"?N.substr(ae,X):N.length>=ae+X||ae?new java.lang.String(N,ae,X)+"":N}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(N){b.prototype[N]=function(){return null}});function P(N,ae){N.currentElement?N.currentElement.appendChild(ae):N.doc.appendChild(ae)}return zy.__DOMHandler=b,zy.normalizeLineEndings=h,zy.DOMParser=m,zy}var iI;function t7(){if(iI)return Vy;iI=1;var r=GR();return Vy.DOMImplementation=r.DOMImplementation,Vy.XMLSerializer=r.XMLSerializer,Vy.DOMParser=e7().DOMParser,Vy}var $R=t7();/*! @name mpd-parser @version 1.3.1 @license Apache-2.0 */const nI=r=>!!r&&typeof r=="object",Za=(...r)=>r.reduce((e,t)=>(typeof t!="object"||Object.keys(t).forEach(i=>{Array.isArray(e[i])&&Array.isArray(t[i])?e[i]=e[i].concat(t[i]):nI(e[i])&&nI(t[i])?e[i]=Za(e[i],t[i]):e[i]=t[i]}),e),{}),WR=r=>Object.keys(r).map(e=>r[e]),i7=(r,e)=>{const t=[];for(let i=r;i<e;i++)t.push(i);return t},k0=r=>r.reduce((e,t)=>e.concat(t),[]),qR=r=>{if(!r.length)return[];const e=[];for(let t=0;t<r.length;t++)e.push(r[t]);return e},n7=(r,e)=>r.reduce((t,i,n)=>(i[e]&&t.push(n),t),[]),r7=(r,e)=>WR(r.reduce((t,i)=>(i.forEach(n=>{t[e(n)]=n}),t),{}));var O0={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};const w_=({baseUrl:r="",source:e="",range:t="",indexRange:i=""})=>{const n={uri:e,resolvedUri:qx(r||"",e)};if(t||i){const a=(t||i).split("-");let c=Z.BigInt?Z.BigInt(a[0]):parseInt(a[0],10),h=Z.BigInt?Z.BigInt(a[1]):parseInt(a[1],10);c<Number.MAX_SAFE_INTEGER&&typeof c=="bigint"&&(c=Number(c)),h<Number.MAX_SAFE_INTEGER&&typeof h=="bigint"&&(h=Number(h));let m;typeof h=="bigint"||typeof c=="bigint"?m=Z.BigInt(h)-Z.BigInt(c)+Z.BigInt(1):m=h-c+1,typeof m=="bigint"&&m<Number.MAX_SAFE_INTEGER&&(m=Number(m)),n.byterange={length:m,offset:c}}return n},s7=r=>{let e;return typeof r.offset=="bigint"||typeof r.length=="bigint"?e=Z.BigInt(r.offset)+Z.BigInt(r.length)-Z.BigInt(1):e=r.offset+r.length-1,`${r.offset}-${e}`},rI=r=>(r&&typeof r!="number"&&(r=parseInt(r,10)),isNaN(r)?null:r),a7={static(r){const{duration:e,timescale:t=1,sourceDuration:i,periodDuration:n}=r,s=rI(r.endNumber),a=e/t;return typeof s=="number"?{start:0,end:s}:typeof n=="number"?{start:0,end:n/a}:{start:0,end:i/a}},dynamic(r){const{NOW:e,clientOffset:t,availabilityStartTime:i,timescale:n=1,duration:s,periodStart:a=0,minimumUpdatePeriod:c=0,timeShiftBufferDepth:h=1/0}=r,m=rI(r.endNumber),v=(e+t)/1e3,b=i+a,C=v+c-b,B=Math.ceil(C*n/s),P=Math.floor((v-b-h)*n/s),N=Math.floor((v-b)*n/s);return{start:Math.max(0,P),end:typeof m=="number"?m:Math.min(B,N)}}},o7=r=>e=>{const{duration:t,timescale:i=1,periodStart:n,startNumber:s=1}=r;return{number:s+e,duration:t/i,timeline:n,time:e*t}},B2=r=>{const{type:e,duration:t,timescale:i=1,periodDuration:n,sourceDuration:s}=r,{start:a,end:c}=a7[e](r),h=i7(a,c).map(o7(r));if(e==="static"){const m=h.length-1,v=typeof n=="number"?n:s;h[m].duration=v-t/i*m}return h},XR=r=>{const{baseUrl:e,initialization:t={},sourceDuration:i,indexRange:n="",periodStart:s,presentationTime:a,number:c=0,duration:h}=r;if(!e)throw new Error(O0.NO_BASE_URL);const m=w_({baseUrl:e,source:t.sourceURL,range:t.range}),v=w_({baseUrl:e,source:e,indexRange:n});if(v.map=m,h){const b=B2(r);b.length&&(v.duration=b[0].duration,v.timeline=b[0].timeline)}else i&&(v.duration=i,v.timeline=s);return v.presentationTime=a||s,v.number=c,[v]},N2=(r,e,t)=>{const i=r.sidx.map?r.sidx.map:null,n=r.sidx.duration,s=r.timeline||0,a=r.sidx.byterange,c=a.offset+a.length,h=e.timescale,m=e.references.filter(N=>N.referenceType!==1),v=[],b=r.endList?"static":"dynamic",x=r.sidx.timeline;let C=x,B=r.mediaSequence||0,P;typeof e.firstOffset=="bigint"?P=Z.BigInt(c)+e.firstOffset:P=c+e.firstOffset;for(let N=0;N<m.length;N++){const ae=e.references[N],X=ae.referencedSize,de=ae.subsegmentDuration;let ge;typeof P=="bigint"?ge=P+Z.BigInt(X)-Z.BigInt(1):ge=P+X-1;const ue=`${P}-${ge}`,fe=XR({baseUrl:t,timescale:h,timeline:s,periodStart:x,presentationTime:C,number:B,duration:de,sourceDuration:n,indexRange:ue,type:b})[0];i&&(fe.map=i),v.push(fe),typeof P=="bigint"?P+=Z.BigInt(X):P+=X,C+=de/h,B++}return r.segments=v,r},l7=["AUDIO","SUBTITLES"],u7=1/60,YR=r=>r7(r,({timeline:e})=>e).sort((e,t)=>e.timeline>t.timeline?1:-1),c7=(r,e)=>{for(let t=0;t<r.length;t++)if(r[t].attributes.NAME===e)return r[t];return null},sI=r=>{let e=[];return KU(r,l7,(t,i,n,s)=>{e=e.concat(t.playlists||[])}),e},aI=({playlist:r,mediaSequence:e})=>{r.mediaSequence=e,r.segments.forEach((t,i)=>{t.number=r.mediaSequence+i})},d7=({oldPlaylists:r,newPlaylists:e,timelineStarts:t})=>{e.forEach(i=>{i.discontinuitySequence=t.findIndex(function({timeline:h}){return h===i.timeline});const n=c7(r,i.attributes.NAME);if(!n||i.sidx)return;const s=i.segments[0],a=n.segments.findIndex(function(h){return Math.abs(h.presentationTime-s.presentationTime)<u7});if(a===-1){aI({playlist:i,mediaSequence:n.mediaSequence+n.segments.length}),i.segments[0].discontinuity=!0,i.discontinuityStarts.unshift(0),(!n.segments.length&&i.timeline>n.timeline||n.segments.length&&i.timeline>n.segments[n.segments.length-1].timeline)&&i.discontinuitySequence--;return}n.segments[a].discontinuity&&!s.discontinuity&&(s.discontinuity=!0,i.discontinuityStarts.unshift(0),i.discontinuitySequence--),aI({playlist:i,mediaSequence:n.segments[a].number})})},h7=({oldManifest:r,newManifest:e})=>{const t=r.playlists.concat(sI(r)),i=e.playlists.concat(sI(e));return e.timelineStarts=YR([r.timelineStarts,e.timelineStarts]),d7({oldPlaylists:t,newPlaylists:i,timelineStarts:e.timelineStarts}),e},Yx=r=>r&&r.uri+"-"+s7(r.byterange),QA=r=>{const e=r.reduce(function(i,n){return i[n.attributes.baseUrl]||(i[n.attributes.baseUrl]=[]),i[n.attributes.baseUrl].push(n),i},{});let t=[];return Object.values(e).forEach(i=>{const n=WR(i.reduce((s,a)=>{const c=a.attributes.id+(a.attributes.lang||"");return s[c]?(a.segments&&(a.segments[0]&&(a.segments[0].discontinuity=!0),s[c].segments.push(...a.segments)),a.attributes.contentProtection&&(s[c].attributes.contentProtection=a.attributes.contentProtection)):(s[c]=a,s[c].attributes.timelineStarts=[]),s[c].attributes.timelineStarts.push({start:a.attributes.periodStart,timeline:a.attributes.periodStart}),s},{}));t=t.concat(n)}),t.map(i=>(i.discontinuityStarts=n7(i.segments||[],"discontinuity"),i))},U2=(r,e)=>{const t=Yx(r.sidx),i=t&&e[t]&&e[t].sidx;return i&&N2(r,i,r.sidx.resolvedUri),r},f7=(r,e={})=>{if(!Object.keys(e).length)return r;for(const t in r)r[t]=U2(r[t],e);return r},p7=({attributes:r,segments:e,sidx:t,mediaSequence:i,discontinuitySequence:n,discontinuityStarts:s},a)=>{const c={attributes:{NAME:r.id,BANDWIDTH:r.bandwidth,CODECS:r.codecs,"PROGRAM-ID":1},uri:"",endList:r.type==="static",timeline:r.periodStart,resolvedUri:r.baseUrl||"",targetDuration:r.duration,discontinuitySequence:n,discontinuityStarts:s,timelineStarts:r.timelineStarts,mediaSequence:i,segments:e};return r.contentProtection&&(c.contentProtection=r.contentProtection),r.serviceLocation&&(c.attributes.serviceLocation=r.serviceLocation),t&&(c.sidx=t),a&&(c.attributes.AUDIO="audio",c.attributes.SUBTITLES="subs"),c},m7=({attributes:r,segments:e,mediaSequence:t,discontinuityStarts:i,discontinuitySequence:n})=>{typeof e>"u"&&(e=[{uri:r.baseUrl,timeline:r.periodStart,resolvedUri:r.baseUrl||"",duration:r.sourceDuration,number:0}],r.duration=r.sourceDuration);const s={NAME:r.id,BANDWIDTH:r.bandwidth,"PROGRAM-ID":1};r.codecs&&(s.CODECS=r.codecs);const a={attributes:s,uri:"",endList:r.type==="static",timeline:r.periodStart,resolvedUri:r.baseUrl||"",targetDuration:r.duration,timelineStarts:r.timelineStarts,discontinuityStarts:i,discontinuitySequence:n,mediaSequence:t,segments:e};return r.serviceLocation&&(a.attributes.serviceLocation=r.serviceLocation),a},g7=(r,e={},t=!1)=>{let i;const n=r.reduce((s,a)=>{const c=a.attributes.role&&a.attributes.role.value||"",h=a.attributes.lang||"";let m=a.attributes.label||"main";if(h&&!a.attributes.label){const b=c?` (${c})`:"";m=`${a.attributes.lang}${b}`}s[m]||(s[m]={language:h,autoselect:!0,default:c==="main",playlists:[],uri:""});const v=U2(p7(a,t),e);return s[m].playlists.push(v),typeof i>"u"&&c==="main"&&(i=a,i.default=!0),s},{});if(!i){const s=Object.keys(n)[0];n[s].default=!0}return n},v7=(r,e={})=>r.reduce((t,i)=>{const n=i.attributes.label||i.attributes.lang||"text",s=i.attributes.lang||"und";return t[n]||(t[n]={language:s,default:!1,autoselect:!1,playlists:[],uri:""}),t[n].playlists.push(U2(m7(i),e)),t},{}),y7=r=>r.reduce((e,t)=>(t&&t.forEach(i=>{const{channel:n,language:s}=i;e[s]={autoselect:!1,default:!1,instreamId:n,language:s},i.hasOwnProperty("aspectRatio")&&(e[s].aspectRatio=i.aspectRatio),i.hasOwnProperty("easyReader")&&(e[s].easyReader=i.easyReader),i.hasOwnProperty("3D")&&(e[s]["3D"]=i["3D"])}),e),{}),_7=({attributes:r,segments:e,sidx:t,discontinuityStarts:i})=>{const n={attributes:{NAME:r.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:r.width,height:r.height},CODECS:r.codecs,BANDWIDTH:r.bandwidth,"PROGRAM-ID":1},uri:"",endList:r.type==="static",timeline:r.periodStart,resolvedUri:r.baseUrl||"",targetDuration:r.duration,discontinuityStarts:i,timelineStarts:r.timelineStarts,segments:e};return r.frameRate&&(n.attributes["FRAME-RATE"]=r.frameRate),r.contentProtection&&(n.contentProtection=r.contentProtection),r.serviceLocation&&(n.attributes.serviceLocation=r.serviceLocation),t&&(n.sidx=t),n},b7=({attributes:r})=>r.mimeType==="video/mp4"||r.mimeType==="video/webm"||r.contentType==="video",T7=({attributes:r})=>r.mimeType==="audio/mp4"||r.mimeType==="audio/webm"||r.contentType==="audio",x7=({attributes:r})=>r.mimeType==="text/vtt"||r.contentType==="text",S7=(r,e)=>{r.forEach(t=>{t.mediaSequence=0,t.discontinuitySequence=e.findIndex(function({timeline:i}){return i===t.timeline}),t.segments&&t.segments.forEach((i,n)=>{i.number=n})})},oI=r=>r?Object.keys(r).reduce((e,t)=>{const i=r[t];return e.concat(i.playlists)},[]):[],A7=({dashPlaylists:r,locations:e,contentSteering:t,sidxMapping:i={},previousManifest:n,eventStream:s})=>{if(!r.length)return{};const{sourceDuration:a,type:c,suggestedPresentationDelay:h,minimumUpdatePeriod:m}=r[0].attributes,v=QA(r.filter(b7)).map(_7),b=QA(r.filter(T7)),x=QA(r.filter(x7)),C=r.map(ge=>ge.attributes.captionServices).filter(Boolean),B={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:"",duration:a,playlists:f7(v,i)};m>=0&&(B.minimumUpdatePeriod=m*1e3),e&&(B.locations=e),t&&(B.contentSteering=t),c==="dynamic"&&(B.suggestedPresentationDelay=h),s&&s.length>0&&(B.eventStream=s);const P=B.playlists.length===0,N=b.length?g7(b,i,P):null,ae=x.length?v7(x,i):null,X=v.concat(oI(N),oI(ae)),de=X.map(({timelineStarts:ge})=>ge);return B.timelineStarts=YR(de),S7(X,B.timelineStarts),N&&(B.mediaGroups.AUDIO.audio=N),ae&&(B.mediaGroups.SUBTITLES.subs=ae),C.length&&(B.mediaGroups["CLOSED-CAPTIONS"].cc=y7(C)),n?h7({oldManifest:n,newManifest:B}):B},w7=(r,e,t)=>{const{NOW:i,clientOffset:n,availabilityStartTime:s,timescale:a=1,periodStart:c=0,minimumUpdatePeriod:h=0}=r,m=(i+n)/1e3,v=s+c,x=m+h-v;return Math.ceil((x*a-e)/t)},QR=(r,e)=>{const{type:t,minimumUpdatePeriod:i=0,media:n="",sourceDuration:s,timescale:a=1,startNumber:c=1,periodStart:h}=r,m=[];let v=-1;for(let b=0;b<e.length;b++){const x=e[b],C=x.d,B=x.r||0,P=x.t||0;v<0&&(v=P),P&&P>v&&(v=P);let N;if(B<0){const de=b+1;de===e.length?t==="dynamic"&&i>0&&n.indexOf("$Number$")>0?N=w7(r,v,C):N=(s*a-v)/C:N=(e[de].t-v)/C}else N=B+1;const ae=c+m.length+N;let X=c+m.length;for(;X<ae;)m.push({number:X,duration:C/a,time:v,timeline:h}),v+=C,X++}return m},E7=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,C7=r=>(e,t,i,n)=>{if(e==="$$")return"$";if(typeof r[t]>"u")return e;const s=""+r[t];return t==="RepresentationID"||(i?n=parseInt(n,10):n=1,s.length>=n)?s:`${new Array(n-s.length+1).join("0")}${s}`},lI=(r,e)=>r.replace(E7,C7(e)),M7=(r,e)=>!r.duration&&!e?[{number:r.startNumber||1,duration:r.sourceDuration,time:0,timeline:r.periodStart}]:r.duration?B2(r):QR(r,e),D7=(r,e)=>{const t={RepresentationID:r.id,Bandwidth:r.bandwidth||0},{initialization:i={sourceURL:"",range:""}}=r,n=w_({baseUrl:r.baseUrl,source:lI(i.sourceURL,t),range:i.range});return M7(r,e).map(a=>{t.Number=a.number,t.Time=a.time;const c=lI(r.media||"",t),h=r.timescale||1,m=r.presentationTimeOffset||0,v=r.periodStart+(a.time-m)/h;return{uri:c,timeline:a.timeline,duration:a.duration,resolvedUri:qx(r.baseUrl||"",c),map:n,number:a.number,presentationTime:v}})},I7=(r,e)=>{const{baseUrl:t,initialization:i={}}=r,n=w_({baseUrl:t,source:i.sourceURL,range:i.range}),s=w_({baseUrl:t,source:e.media,range:e.mediaRange});return s.map=n,s},P7=(r,e)=>{const{duration:t,segmentUrls:i=[],periodStart:n}=r;if(!t&&!e||t&&e)throw new Error(O0.SEGMENT_TIME_UNSPECIFIED);const s=i.map(h=>I7(r,h));let a;return t&&(a=B2(r)),e&&(a=QR(r,e)),a.map((h,m)=>{if(s[m]){const v=s[m],b=r.timescale||1,x=r.presentationTimeOffset||0;return v.timeline=h.timeline,v.duration=h.duration,v.number=h.number,v.presentationTime=n+(h.time-x)/b,v}}).filter(h=>h)},L7=({attributes:r,segmentInfo:e})=>{let t,i;e.template?(i=D7,t=Za(r,e.template)):e.base?(i=XR,t=Za(r,e.base)):e.list&&(i=P7,t=Za(r,e.list));const n={attributes:r};if(!i)return n;const s=i(t,e.segmentTimeline);if(t.duration){const{duration:a,timescale:c=1}=t;t.duration=a/c}else s.length?t.duration=s.reduce((a,c)=>Math.max(a,Math.ceil(c.duration)),0):t.duration=0;return n.attributes=t,n.segments=s,e.base&&t.indexRange&&(n.sidx=s[0],n.segments=[]),n},R7=r=>r.map(L7),Is=(r,e)=>qR(r.childNodes).filter(({tagName:t})=>t===e),G_=r=>r.textContent.trim(),k7=r=>parseFloat(r.split("/").reduce((e,t)=>e/t)),zg=r=>{const c=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(r);if(!c)return 0;const[h,m,v,b,x,C]=c.slice(1);return parseFloat(h||0)*31536e3+parseFloat(m||0)*2592e3+parseFloat(v||0)*86400+parseFloat(b||0)*3600+parseFloat(x||0)*60+parseFloat(C||0)},O7=r=>(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(r)&&(r+="Z"),Date.parse(r)),uI={mediaPresentationDuration(r){return zg(r)},availabilityStartTime(r){return O7(r)/1e3},minimumUpdatePeriod(r){return zg(r)},suggestedPresentationDelay(r){return zg(r)},type(r){return r},timeShiftBufferDepth(r){return zg(r)},start(r){return zg(r)},width(r){return parseInt(r,10)},height(r){return parseInt(r,10)},bandwidth(r){return parseInt(r,10)},frameRate(r){return k7(r)},startNumber(r){return parseInt(r,10)},timescale(r){return parseInt(r,10)},presentationTimeOffset(r){return parseInt(r,10)},duration(r){const e=parseInt(r,10);return isNaN(e)?zg(r):e},d(r){return parseInt(r,10)},t(r){return parseInt(r,10)},r(r){return parseInt(r,10)},presentationTime(r){return parseInt(r,10)},DEFAULT(r){return r}},ba=r=>r&&r.attributes?qR(r.attributes).reduce((e,t)=>{const i=uI[t.name]||uI.DEFAULT;return e[t.name]=i(t.value),e},{}):{},F7={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},Qx=(r,e)=>e.length?k0(r.map(function(t){return e.map(function(i){const n=G_(i),s=qx(t.baseUrl,n),a=Za(ba(i),{baseUrl:s});return s!==n&&!a.serviceLocation&&t.serviceLocation&&(a.serviceLocation=t.serviceLocation),a})})):r,V2=r=>{const e=Is(r,"SegmentTemplate")[0],t=Is(r,"SegmentList")[0],i=t&&Is(t,"SegmentURL").map(b=>Za({tag:"SegmentURL"},ba(b))),n=Is(r,"SegmentBase")[0],s=t||e,a=s&&Is(s,"SegmentTimeline")[0],c=t||n||e,h=c&&Is(c,"Initialization")[0],m=e&&ba(e);m&&h?m.initialization=h&&ba(h):m&&m.initialization&&(m.initialization={sourceURL:m.initialization});const v={template:m,segmentTimeline:a&&Is(a,"S").map(b=>ba(b)),list:t&&Za(ba(t),{segmentUrls:i,initialization:ba(h)}),base:n&&Za(ba(n),{initialization:ba(h)})};return Object.keys(v).forEach(b=>{v[b]||delete v[b]}),v},B7=(r,e,t)=>i=>{const n=Is(i,"BaseURL"),s=Qx(e,n),a=Za(r,ba(i)),c=V2(i);return s.map(h=>({segmentInfo:Za(t,c),attributes:Za(a,h)}))},N7=r=>r.reduce((e,t)=>{const i=ba(t);i.schemeIdUri&&(i.schemeIdUri=i.schemeIdUri.toLowerCase());const n=F7[i.schemeIdUri];if(n){e[n]={attributes:i};const s=Is(t,"cenc:pssh")[0];if(s){const a=G_(s);e[n].pssh=a&&NR(a)}}return e},{}),U7=r=>{if(r.schemeIdUri==="urn:scte:dash:cc:cea-608:2015")return(typeof r.value!="string"?[]:r.value.split(";")).map(t=>{let i,n;return n=t,/^CC\d=/.test(t)?[i,n]=t.split("="):/^CC\d$/.test(t)&&(i=t),{channel:i,language:n}});if(r.schemeIdUri==="urn:scte:dash:cc:cea-708:2015")return(typeof r.value!="string"?[]:r.value.split(";")).map(t=>{const i={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(t)){const[n,s=""]=t.split("=");i.channel=n,i.language=t,s.split(",").forEach(a=>{const[c,h]=a.split(":");c==="lang"?i.language=h:c==="er"?i.easyReader=Number(h):c==="war"?i.aspectRatio=Number(h):c==="3D"&&(i["3D"]=Number(h))})}else i.language=t;return i.channel&&(i.channel="SERVICE"+i.channel),i})},V7=r=>k0(Is(r.node,"EventStream").map(e=>{const t=ba(e),i=t.schemeIdUri;return Is(e,"Event").map(n=>{const s=ba(n),a=s.presentationTime||0,c=t.timescale||1,h=s.duration||0,m=a/c+r.attributes.start;return{schemeIdUri:i,value:t.value,id:s.id,start:m,end:m+h/c,messageData:G_(n)||s.messageData,contentEncoding:t.contentEncoding,presentationTimeOffset:t.presentationTimeOffset||0}})})),z7=(r,e,t)=>i=>{const n=ba(i),s=Qx(e,Is(i,"BaseURL")),a=Is(i,"Role")[0],c={role:ba(a)};let h=Za(r,n,c);const m=Is(i,"Accessibility")[0],v=U7(ba(m));v&&(h=Za(h,{captionServices:v}));const b=Is(i,"Label")[0];if(b&&b.childNodes.length){const N=b.childNodes[0].nodeValue.trim();h=Za(h,{label:N})}const x=N7(Is(i,"ContentProtection"));Object.keys(x).length&&(h=Za(h,{contentProtection:x}));const C=V2(i),B=Is(i,"Representation"),P=Za(t,C);return k0(B.map(B7(h,s,P)))},H7=(r,e)=>(t,i)=>{const n=Qx(e,Is(t.node,"BaseURL")),s=Za(r,{periodStart:t.attributes.start});typeof t.attributes.duration=="number"&&(s.periodDuration=t.attributes.duration);const a=Is(t.node,"AdaptationSet"),c=V2(t.node);return k0(a.map(z7(s,n,c)))},j7=(r,e)=>{if(r.length>1&&e({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),!r.length)return null;const t=Za({serverURL:G_(r[0])},ba(r[0]));return t.queryBeforeStart=t.queryBeforeStart==="true",t},G7=({attributes:r,priorPeriodAttributes:e,mpdType:t})=>typeof r.start=="number"?r.start:e&&typeof e.start=="number"&&typeof e.duration=="number"?e.start+e.duration:!e&&t==="static"?0:null,$7=(r,e={})=>{const{manifestUri:t="",NOW:i=Date.now(),clientOffset:n=0,eventHandler:s=function(){}}=e,a=Is(r,"Period");if(!a.length)throw new Error(O0.INVALID_NUMBER_OF_PERIOD);const c=Is(r,"Location"),h=ba(r),m=Qx([{baseUrl:t}],Is(r,"BaseURL")),v=Is(r,"ContentSteering");h.type=h.type||"static",h.sourceDuration=h.mediaPresentationDuration||0,h.NOW=i,h.clientOffset=n,c.length&&(h.locations=c.map(G_));const b=[];return a.forEach((x,C)=>{const B=ba(x),P=b[C-1];B.start=G7({attributes:B,priorPeriodAttributes:P?P.attributes:null,mpdType:h.type}),b.push({node:x,attributes:B})}),{locations:h.locations,contentSteeringInfo:j7(v,s),representationInfo:k0(b.map(H7(h,m))),eventStream:k0(b.map(V7))}},KR=r=>{if(r==="")throw new Error(O0.DASH_EMPTY_MANIFEST);const e=new $R.DOMParser;let t,i;try{t=e.parseFromString(r,"application/xml"),i=t&&t.documentElement.tagName==="MPD"?t.documentElement:null}catch{}if(!i||i&&i.getElementsByTagName("parsererror").length>0)throw new Error(O0.DASH_INVALID_XML);return i},W7=r=>{const e=Is(r,"UTCTiming")[0];if(!e)return null;const t=ba(e);switch(t.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":t.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":t.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":t.method="DIRECT",t.value=Date.parse(t.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(O0.UNSUPPORTED_UTC_TIMING_SCHEME)}return t},q7=(r,e={})=>{const t=$7(KR(r),e),i=R7(t.representationInfo);return A7({dashPlaylists:i,locations:t.locations,contentSteering:t.contentSteeringInfo,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest,eventStream:t.eventStream})},X7=r=>W7(KR(r));var KA,cI;function Y7(){if(cI)return KA;cI=1;var r=Math.pow(2,32),e=function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),n;return i.getBigUint64?(n=i.getBigUint64(0),n<Number.MAX_SAFE_INTEGER?Number(n):n):i.getUint32(0)*r+i.getUint32(4)};return KA={getUint64:e,MAX_UINT32:r},KA}var ZA,dI;function Q7(){if(dI)return ZA;dI=1;var r=Y7().getUint64,e=function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8)},s=12;n.version===0?(n.earliestPresentationTime=i.getUint32(s),n.firstOffset=i.getUint32(s+4),s+=8):(n.earliestPresentationTime=r(t.subarray(s)),n.firstOffset=r(t.subarray(s+8)),s+=16),s+=2;var a=i.getUint16(s);for(s+=2;a>0;s+=12,a--)n.references.push({referenceType:(t[s]&128)>>>7,referencedSize:i.getUint32(s)&2147483647,subsegmentDuration:i.getUint32(s+4),startsWithSap:!!(t[s+8]&128),sapType:(t[s+8]&112)>>>4,sapDeltaTime:i.getUint32(s+8)&268435455});return n};return ZA=e,ZA}var K7=Q7();const Z7=Yu(K7);var J7=en([73,68,51]),e9=function(e,t){t===void 0&&(t=0),e=en(e);var i=e[t+5],n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],s=(i&16)>>4;return s?n+20:n+10},Jy=function r(e,t){return t===void 0&&(t=0),e=en(e),e.length-t<10||!Ms(e,J7,{offset:t})?t:(t+=e9(e,t),r(e,t))},hI=function(e){return typeof e=="string"?jR(e):e},t9=function(e){return Array.isArray(e)?e.map(function(t){return hI(t)}):[hI(e)]},i9=function r(e,t,i){i===void 0&&(i=!1),t=t9(t),e=en(e);var n=[];if(!t.length)return n;for(var s=0;s<e.length;){var a=(e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3])>>>0,c=e.subarray(s+4,s+8);if(a===0)break;var h=s+a;if(h>e.length){if(i)break;h=e.length}var m=e.subarray(s+8,h);Ms(c,t[0])&&(t.length===1?n.push(m):n.push.apply(n,r(m,t.slice(1),i))),s=h}return n},Y1={EBML:en([26,69,223,163]),DocType:en([66,130]),Segment:en([24,83,128,103]),SegmentInfo:en([21,73,169,102]),Tracks:en([22,84,174,107]),Track:en([174]),TrackNumber:en([215]),DefaultDuration:en([35,227,131]),TrackEntry:en([174]),TrackType:en([131]),FlagDefault:en([136]),CodecID:en([134]),CodecPrivate:en([99,162]),VideoTrack:en([224]),AudioTrack:en([225]),Cluster:en([31,67,182,117]),Timestamp:en([231]),TimestampScale:en([42,215,177]),BlockGroup:en([160]),BlockDuration:en([155]),Block:en([161]),SimpleBlock:en([163])},aE=[128,64,32,16,8,4,2,1],n9=function(e){for(var t=1,i=0;i<aE.length&&!(e&aE[i]);i++)t++;return t},sx=function(e,t,i,n){i===void 0&&(i=!0),n===void 0&&(n=!1);var s=n9(e[t]),a=e.subarray(t,t+s);return i&&(a=Array.prototype.slice.call(e,t,t+s),a[0]^=aE[s-1]),{length:s,value:XU(a,{signed:n}),bytes:a}},fI=function r(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(t){return r(t)}):typeof e=="number"?YU(e):e},r9=function(e){return Array.isArray(e)?e.map(function(t){return fI(t)}):[fI(e)]},s9=function r(e,t,i){if(i>=t.length)return t.length;var n=sx(t,i,!1);if(Ms(e.bytes,n.bytes))return i;var s=sx(t,i+n.length);return r(e,t,i+s.length+s.value+n.length)},pI=function r(e,t){t=r9(t),e=en(e);var i=[];if(!t.length)return i;for(var n=0;n<e.length;){var s=sx(e,n,!1),a=sx(e,n+s.length),c=n+s.length+a.length;a.value===127&&(a.value=s9(s,e,c),a.value!==e.length&&(a.value-=c));var h=c+a.value>e.length?e.length:c+a.value,m=e.subarray(c,h);Ms(t[0],s.bytes)&&(t.length===1?i.push(m):i=i.concat(r(m,t.slice(1))));var v=s.length+a.length+m.length;n+=v}return i},a9=en([0,0,0,1]),o9=en([0,0,1]),l9=en([0,0,3]),u9=function(e){for(var t=[],i=1;i<e.length-2;)Ms(e.subarray(i,i+3),l9)&&(t.push(i+2),i++),i++;if(t.length===0)return e;var n=e.length-t.length,s=new Uint8Array(n),a=0;for(i=0;i<n;a++,i++)a===t[0]&&(a++,t.shift()),s[i]=e[a];return s},ZR=function(e,t,i,n){e=en(e),i=[].concat(i);for(var s=0,a,c=0;s<e.length&&(c<n||a);){var h=void 0;if(Ms(e.subarray(s),a9)?h=4:Ms(e.subarray(s),o9)&&(h=3),!h){s++;continue}if(c++,a)return u9(e.subarray(a,s));var m=void 0;t==="h264"?m=e[s+h]&31:t==="h265"&&(m=e[s+h]>>1&63),i.indexOf(m)!==-1&&(a=s+h),s+=h+(t==="h264"?1:2)}return e.subarray(0,0)},c9=function(e,t,i){return ZR(e,"h264",t,i)},d9=function(e,t,i){return ZR(e,"h265",t,i)},ol={webm:en([119,101,98,109]),matroska:en([109,97,116,114,111,115,107,97]),flac:en([102,76,97,67]),ogg:en([79,103,103,83]),ac3:en([11,119]),riff:en([82,73,70,70]),avi:en([65,86,73]),wav:en([87,65,86,69]),"3gp":en([102,116,121,112,51,103]),mp4:en([102,116,121,112]),fmp4:en([115,116,121,112]),mov:en([102,116,121,112,113,116]),moov:en([109,111,111,118]),moof:en([109,111,111,102])},F0={aac:function(e){var t=Jy(e);return Ms(e,[255,16],{offset:t,mask:[255,22]})},mp3:function(e){var t=Jy(e);return Ms(e,[255,2],{offset:t,mask:[255,6]})},webm:function(e){var t=pI(e,[Y1.EBML,Y1.DocType])[0];return Ms(t,ol.webm)},mkv:function(e){var t=pI(e,[Y1.EBML,Y1.DocType])[0];return Ms(t,ol.matroska)},mp4:function(e){if(F0["3gp"](e)||F0.mov(e))return!1;if(Ms(e,ol.mp4,{offset:4})||Ms(e,ol.fmp4,{offset:4})||Ms(e,ol.moof,{offset:4})||Ms(e,ol.moov,{offset:4}))return!0},mov:function(e){return Ms(e,ol.mov,{offset:4})},"3gp":function(e){return Ms(e,ol["3gp"],{offset:4})},ac3:function(e){var t=Jy(e);return Ms(e,ol.ac3,{offset:t})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var t=0;t+188<e.length&&t<188;){if(e[t]===71&&e[t+188]===71)return!0;t+=1}return!1},flac:function(e){var t=Jy(e);return Ms(e,ol.flac,{offset:t})},ogg:function(e){return Ms(e,ol.ogg)},avi:function(e){return Ms(e,ol.riff)&&Ms(e,ol.avi,{offset:8})},wav:function(e){return Ms(e,ol.riff)&&Ms(e,ol.wav,{offset:8})},h264:function(e){return c9(e,7,3).length},h265:function(e){return d9(e,[32,33],3).length}},oE=Object.keys(F0).filter(function(r){return r!=="ts"&&r!=="h264"&&r!=="h265"}).concat(["ts","h264","h265"]);oE.forEach(function(r){var e=F0[r];F0[r]=function(t){return e(en(t))}});var h9=F0,z2=function(e){e=en(e);for(var t=0;t<oE.length;t++){var i=oE[t];if(h9[i](e))return i}return""},f9=function(e){return i9(e,["moof"]).length>0},JA,mI;function p9(){if(mI)return JA;mI=1;var r=9e4,e,t,i,n,s,a,c;return e=function(h){return h*r},t=function(h,m){return h*m},i=function(h){return h/r},n=function(h,m){return h/m},s=function(h,m){return e(n(h,m))},a=function(h,m){return t(i(h),m)},c=function(h,m,v){return i(v?h:h-m)},JA={ONE_SECOND_IN_TS:r,secondsToVideoTs:e,secondsToAudioTs:t,videoTsToSeconds:i,audioTsToSeconds:n,audioTsToVideoTs:s,videoTsToAudioTs:a,metadataTsToSeconds:c},JA}var Fm=p9();/**
 * @license
 * Video.js 8.23.3 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var lE="8.23.3";const gf={},Pp=function(r,e){return gf[r]=gf[r]||[],e&&(gf[r]=gf[r].concat(e)),gf[r]},m9=function(r,e){Pp(r,e)},JR=function(r,e){const t=Pp(r).indexOf(e);return t<=-1?!1:(gf[r]=gf[r].slice(),gf[r].splice(t,1),!0)},g9=function(r,e){Pp(r,[].concat(e).map(t=>{const i=(...n)=>(JR(r,i),t(...n));return i}))},ax={prefixed:!0},yT=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"]],gI=yT[0];let e_;for(let r=0;r<yT.length;r++)if(yT[r][1]in ot){e_=yT[r];break}if(e_){for(let r=0;r<e_.length;r++)ax[gI[r]]=e_[r];ax.prefixed=e_[0]!==gI[0]}let Wl=[];const v9=(r,e,t)=>(i,n,s)=>{const a=e.levels[n],c=new RegExp(`^(${a})$`);let h=r;if(i!=="log"&&s.unshift(i.toUpperCase()+":"),t&&(h=`%c${r}`,s.unshift(t)),s.unshift(h+":"),Wl){Wl.push([].concat(s));const v=Wl.length-1e3;Wl.splice(0,v>0?v:0)}if(!Z.console)return;let m=Z.console[i];!m&&i==="debug"&&(m=Z.console.info||Z.console.log),!(!m||!a||!c.test(i))&&m[Array.isArray(s)?"apply":"call"](Z.console,s)};function uE(r,e=":",t=""){let i="info",n;function s(...a){n("log",i,a)}return n=v9(r,s,t),s.createLogger=(a,c,h)=>{const m=c!==void 0?c:e,v=h!==void 0?h:t,b=`${r} ${m} ${a}`;return uE(b,m,v)},s.createNewLogger=(a,c,h)=>uE(a,c,h),s.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:i},s.level=a=>{if(typeof a=="string"){if(!s.levels.hasOwnProperty(a))throw new Error(`"${a}" in not a valid log level`);i=a}return i},s.history=()=>Wl?[].concat(Wl):[],s.history.filter=a=>(Wl||[]).filter(c=>new RegExp(`.*${a}.*`).test(c[0])),s.history.clear=()=>{Wl&&(Wl.length=0)},s.history.disable=()=>{Wl!==null&&(Wl.length=0,Wl=null)},s.history.enable=()=>{Wl===null&&(Wl=[])},s.error=(...a)=>n("error",i,a),s.warn=(...a)=>n("warn",i,a),s.debug=(...a)=>n("debug",i,a),s}const Zn=uE("VIDEOJS"),ek=Zn.createLogger,y9=Object.prototype.toString,tk=function(r){return _h(r)?Object.keys(r):[]};function p0(r,e){tk(r).forEach(t=>e(r[t],t))}function ik(r,e,t=0){return tk(r).reduce((i,n)=>e(i,r[n],n),t)}function _h(r){return!!r&&typeof r=="object"}function B0(r){return _h(r)&&y9.call(r)==="[object Object]"&&r.constructor===Object}function Yr(...r){const e={};return r.forEach(t=>{t&&p0(t,(i,n)=>{if(!B0(i)){e[n]=i;return}B0(e[n])||(e[n]={}),e[n]=Yr(e[n],i)})}),e}function nk(r={}){const e=[];for(const t in r)if(r.hasOwnProperty(t)){const i=r[t];e.push(i)}return e}function Kx(r,e,t,i=!0){const n=a=>Object.defineProperty(r,e,{value:a,enumerable:!0,writable:!0}),s={configurable:!0,enumerable:!0,get(){const a=t();return n(a),a}};return i&&(s.set=n),Object.defineProperty(r,e,s)}var _9=Object.freeze({__proto__:null,each:p0,reduce:ik,isObject:_h,isPlain:B0,merge:Yr,values:nk,defineLazyProperty:Kx});let H2=!1,rk=null,Kc=!1,sk,ak=!1,m0=!1,g0=!1,bh=!1,j2=null,Zx=null;const b9=!!(Z.cast&&Z.cast.framework&&Z.cast.framework.CastReceiverContext);let ok=null,ox=!1,Jx=!1,lx=!1,eS=!1,ux=!1,cx=!1,dx=!1;const E_=!!(ev()&&("ontouchstart"in Z||Z.navigator.maxTouchPoints||Z.DocumentTouch&&Z.document instanceof Z.DocumentTouch)),vp=Z.navigator&&Z.navigator.userAgentData;vp&&vp.platform&&vp.brands&&(Kc=vp.platform==="Android",m0=!!vp.brands.find(r=>r.brand==="Microsoft Edge"),g0=!!vp.brands.find(r=>r.brand==="Chromium"),bh=!m0&&g0,j2=Zx=(vp.brands.find(r=>r.brand==="Chromium")||{}).version||null,Jx=vp.platform==="Windows");if(!g0){const r=Z.navigator&&Z.navigator.userAgent||"";H2=/iPod/i.test(r),rk=function(){const e=r.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),Kc=/Android/i.test(r),sk=function(){const e=r.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;const t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);return t&&i?parseFloat(e[1]+"."+e[2]):t||null}(),ak=/Firefox/i.test(r),m0=/Edg/i.test(r),g0=/Chrome/i.test(r)||/CriOS/i.test(r),bh=!m0&&g0,j2=Zx=function(){const e=r.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),ok=function(){const e=/MSIE\s(\d+)\.\d/.exec(r);let t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(r)&&/rv:11.0/.test(r)&&(t=11),t}(),ux=/Tizen/i.test(r),cx=/Web0S/i.test(r),dx=ux||cx,ox=/Safari/i.test(r)&&!bh&&!Kc&&!m0&&!dx,Jx=/Windows/i.test(r),lx=/iPad/i.test(r)||ox&&E_&&!/iPhone/i.test(r),eS=/iPhone/i.test(r)&&!lx}const Fo=eS||lx||H2,tS=(ox||Fo)&&!bh;var lk=Object.freeze({__proto__:null,get IS_IPOD(){return H2},get IOS_VERSION(){return rk},get IS_ANDROID(){return Kc},get ANDROID_VERSION(){return sk},get IS_FIREFOX(){return ak},get IS_EDGE(){return m0},get IS_CHROMIUM(){return g0},get IS_CHROME(){return bh},get CHROMIUM_VERSION(){return j2},get CHROME_VERSION(){return Zx},IS_CHROMECAST_RECEIVER:b9,get IE_VERSION(){return ok},get IS_SAFARI(){return ox},get IS_WINDOWS(){return Jx},get IS_IPAD(){return lx},get IS_IPHONE(){return eS},get IS_TIZEN(){return ux},get IS_WEBOS(){return cx},get IS_SMART_TV(){return dx},TOUCH_ENABLED:E_,IS_IOS:Fo,IS_ANY_SAFARI:tS});function vI(r){return typeof r=="string"&&!!r.trim()}function T9(r){if(r.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function ev(){return ot===Z.document}function tv(r){return _h(r)&&r.nodeType===1}function uk(){try{return Z.parent!==Z.self}catch{return!0}}function ck(r){return function(e,t){if(!vI(e))return ot[r](null);vI(t)&&(t=ot.querySelector(t));const i=tv(t)?t:ot;return i[r]&&i[r](e)}}function cn(r="div",e={},t={},i){const n=ot.createElement(r);return Object.getOwnPropertyNames(e).forEach(function(s){const a=e[s];s==="textContent"?Up(n,a):(n[s]!==a||s==="tabIndex")&&(n[s]=a)}),Object.getOwnPropertyNames(t).forEach(function(s){n.setAttribute(s,t[s])}),i&&G2(n,i),n}function Up(r,e){return typeof r.textContent>"u"?r.innerText=e:r.textContent=e,r}function cE(r,e){e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}function c_(r,e){return T9(e),r.classList.contains(e)}function Hm(r,...e){return r.classList.add(...e.reduce((t,i)=>t.concat(i.split(/\s+/)),[])),r}function iS(r,...e){return r?(r.classList.remove(...e.reduce((t,i)=>t.concat(i.split(/\s+/)),[])),r):(Zn.warn("removeClass was called with an element that doesn't exist"),null)}function dk(r,e,t){return typeof t=="function"&&(t=t(r,e)),typeof t!="boolean"&&(t=void 0),e.split(/\s+/).forEach(i=>r.classList.toggle(i,t)),r}function hk(r,e){Object.getOwnPropertyNames(e).forEach(function(t){const i=e[t];i===null||typeof i>"u"||i===!1?r.removeAttribute(t):r.setAttribute(t,i===!0?"":i)})}function xp(r){const e={},t=["autoplay","controls","playsinline","loop","muted","default","defaultMuted"];if(r&&r.attributes&&r.attributes.length>0){const i=r.attributes;for(let n=i.length-1;n>=0;n--){const s=i[n].name;let a=i[n].value;t.includes(s)&&(a=a!==null),e[s]=a}}return e}function fk(r,e){return r.getAttribute(e)}function N0(r,e,t){r.setAttribute(e,t)}function nS(r,e){r.removeAttribute(e)}function pk(){ot.body.focus(),ot.onselectstart=function(){return!1}}function mk(){ot.onselectstart=function(){return!0}}function U0(r){if(r&&r.getBoundingClientRect&&r.parentNode){const e=r.getBoundingClientRect(),t={};return["bottom","height","left","right","top","width"].forEach(i=>{e[i]!==void 0&&(t[i]=e[i])}),t.height||(t.height=parseFloat(V0(r,"height"))),t.width||(t.width=parseFloat(V0(r,"width"))),t}}function C_(r){if(!r||r&&!r.offsetParent)return{left:0,top:0,width:0,height:0};const e=r.offsetWidth,t=r.offsetHeight;let i=0,n=0;for(;r.offsetParent&&r!==ot[ax.fullscreenElement];)i+=r.offsetLeft,n+=r.offsetTop,r=r.offsetParent;return{left:i,top:n,width:e,height:t}}function rS(r,e){const t={x:0,y:0};if(Fo){let v=r;for(;v&&v.nodeName.toLowerCase()!=="html";){const b=V0(v,"transform");if(/^matrix/.test(b)){const x=b.slice(7,-1).split(/,\s/).map(Number);t.x+=x[4],t.y+=x[5]}else if(/^matrix3d/.test(b)){const x=b.slice(9,-1).split(/,\s/).map(Number);t.x+=x[12],t.y+=x[13]}if(v.assignedSlot&&v.assignedSlot.parentElement&&Z.WebKitCSSMatrix){const x=Z.getComputedStyle(v.assignedSlot.parentElement).transform,C=new Z.WebKitCSSMatrix(x);t.x+=C.m41,t.y+=C.m42}v=v.parentNode||v.host}}const i={},n=C_(e.target),s=C_(r),a=s.width,c=s.height;let h=e.offsetY-(s.top-n.top),m=e.offsetX-(s.left-n.left);return e.changedTouches&&(m=e.changedTouches[0].pageX-s.left,h=e.changedTouches[0].pageY+s.top,Fo&&(m-=t.x,h-=t.y)),i.y=1-Math.max(0,Math.min(1,h/c)),i.x=Math.max(0,Math.min(1,m/a)),i}function gk(r){return _h(r)&&r.nodeType===3}function sS(r){for(;r.firstChild;)r.removeChild(r.firstChild);return r}function vk(r){return typeof r=="function"&&(r=r()),(Array.isArray(r)?r:[r]).map(e=>{if(typeof e=="function"&&(e=e()),tv(e)||gk(e))return e;if(typeof e=="string"&&/\S/.test(e))return ot.createTextNode(e)}).filter(e=>e)}function G2(r,e){return vk(e).forEach(t=>r.appendChild(t)),r}function yk(r,e){return G2(sS(r),e)}function M_(r){return r.button===void 0&&r.buttons===void 0||r.button===0&&r.buttons===void 0||r.type==="mouseup"&&r.button===0&&r.buttons===0||r.type==="mousedown"&&r.button===0&&r.buttons===0?!0:!(r.button!==0||r.buttons!==1)}const Lp=ck("querySelector"),_k=ck("querySelectorAll");function V0(r,e){if(!r||!e)return"";if(typeof Z.getComputedStyle=="function"){let t;try{t=Z.getComputedStyle(r)}catch{return""}return t?t.getPropertyValue(e)||t[e]:""}return""}function bk(r){[...ot.styleSheets].forEach(e=>{try{const t=[...e.cssRules].map(n=>n.cssText).join(""),i=ot.createElement("style");i.textContent=t,r.document.head.appendChild(i)}catch{const i=ot.createElement("link");i.rel="stylesheet",i.type=e.type,i.media=e.media.mediaText,i.href=e.href,r.document.head.appendChild(i)}})}var Tk=Object.freeze({__proto__:null,isReal:ev,isEl:tv,isInFrame:uk,createEl:cn,textContent:Up,prependTo:cE,hasClass:c_,addClass:Hm,removeClass:iS,toggleClass:dk,setAttributes:hk,getAttributes:xp,getAttribute:fk,setAttribute:N0,removeAttribute:nS,blockTextSelection:pk,unblockTextSelection:mk,getBoundingClientRect:U0,findPosition:C_,getPointerPosition:rS,isTextNode:gk,emptyEl:sS,normalizeContent:vk,appendContent:G2,insertContent:yk,isSingleLeftClick:M_,$:Lp,$$:_k,computedStyle:V0,copyStyleSheetsToWindow:bk});let xk=!1,dE;const x9=function(){if(dE.options.autoSetup===!1)return;const r=Array.prototype.slice.call(ot.getElementsByTagName("video")),e=Array.prototype.slice.call(ot.getElementsByTagName("audio")),t=Array.prototype.slice.call(ot.getElementsByTagName("video-js")),i=r.concat(e,t);if(i&&i.length>0)for(let n=0,s=i.length;n<s;n++){const a=i[n];if(a&&a.getAttribute)a.player===void 0&&a.getAttribute("data-setup")!==null&&dE(a);else{hE(1);break}}else xk||hE(1)};function hE(r,e){ev()&&(e&&(dE=e),Z.setTimeout(x9,r))}function fE(){xk=!0,Z.removeEventListener("load",fE)}ev()&&(ot.readyState==="complete"?fE():Z.addEventListener("load",fE));const Sk=function(r){const e=ot.createElement("style");return e.className=r,e},Ak=function(r,e){r.styleSheet?r.styleSheet.cssText=e:r.textContent=e};var pl=new WeakMap;const S9=3;let A9=S9;function _c(){return A9++}function yI(r,e){if(!pl.has(r))return;const t=pl.get(r);t.handlers[e].length===0&&(delete t.handlers[e],r.removeEventListener?r.removeEventListener(e,t.dispatcher,!1):r.detachEvent&&r.detachEvent("on"+e,t.dispatcher)),Object.getOwnPropertyNames(t.handlers).length<=0&&(delete t.handlers,delete t.dispatcher,delete t.disabled),Object.getOwnPropertyNames(t).length===0&&pl.delete(r)}function $2(r,e,t,i){t.forEach(function(n){r(e,n,i)})}function aS(r){if(r.fixed_)return r;function e(){return!0}function t(){return!1}if(!r||!r.isPropagationStopped||!r.isImmediatePropagationStopped){const i=r||Z.event;r={};const n=["layerX","layerY","keyLocation","path","webkitMovementX","webkitMovementY","mozPressure","mozInputSource"];for(const s in i)n.includes(s)||s==="returnValue"&&i.preventDefault||(r[s]=i[s]);if(r.target||(r.target=r.srcElement||ot),r.relatedTarget||(r.relatedTarget=r.fromElement===r.target?r.toElement:r.fromElement),r.preventDefault=function(){i.preventDefault&&i.preventDefault(),r.returnValue=!1,i.returnValue=!1,r.defaultPrevented=!0},r.defaultPrevented=!1,r.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),r.cancelBubble=!0,i.cancelBubble=!0,r.isPropagationStopped=e},r.isPropagationStopped=t,r.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),r.isImmediatePropagationStopped=e,r.stopPropagation()},r.isImmediatePropagationStopped=t,r.clientX!==null&&r.clientX!==void 0){const s=ot.documentElement,a=ot.body;r.pageX=r.clientX+(s&&s.scrollLeft||a&&a.scrollLeft||0)-(s&&s.clientLeft||a&&a.clientLeft||0),r.pageY=r.clientY+(s&&s.scrollTop||a&&a.scrollTop||0)-(s&&s.clientTop||a&&a.clientTop||0)}r.which=r.charCode||r.keyCode,r.button!==null&&r.button!==void 0&&(r.button=r.button&1?0:r.button&4?1:r.button&2?2:0)}return r.fixed_=!0,r}let Q1;const w9=function(){if(typeof Q1!="boolean"){Q1=!1;try{const r=Object.defineProperty({},"passive",{get(){Q1=!0}});Z.addEventListener("test",null,r),Z.removeEventListener("test",null,r)}catch{}}return Q1},E9=["touchstart","touchmove"];function Wu(r,e,t){if(Array.isArray(e))return $2(Wu,r,e,t);pl.has(r)||pl.set(r,{});const i=pl.get(r);if(i.handlers||(i.handlers={}),i.handlers[e]||(i.handlers[e]=[]),t.guid||(t.guid=_c()),i.handlers[e].push(t),i.dispatcher||(i.disabled=!1,i.dispatcher=function(n,s){if(i.disabled)return;n=aS(n);const a=i.handlers[n.type];if(a){const c=a.slice(0);for(let h=0,m=c.length;h<m&&!n.isImmediatePropagationStopped();h++)try{c[h].call(r,n,s)}catch(v){Zn.error(v)}}}),i.handlers[e].length===1)if(r.addEventListener){let n=!1;w9()&&E9.indexOf(e)>-1&&(n={passive:!0}),r.addEventListener(e,i.dispatcher,n)}else r.attachEvent&&r.attachEvent("on"+e,i.dispatcher)}function Bo(r,e,t){if(!pl.has(r))return;const i=pl.get(r);if(!i.handlers)return;if(Array.isArray(e))return $2(Bo,r,e,t);const n=function(a,c){i.handlers[c]=[],yI(a,c)};if(e===void 0){for(const a in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},a)&&n(r,a);return}const s=i.handlers[e];if(s){if(!t){n(r,e);return}if(t.guid)for(let a=0;a<s.length;a++)s[a].guid===t.guid&&s.splice(a--,1);yI(r,e)}}function iv(r,e,t){const i=pl.has(r)?pl.get(r):{},n=r.parentNode||r.ownerDocument;if(typeof e=="string"?e={type:e,target:r}:e.target||(e.target=r),e=aS(e),i.dispatcher&&i.dispatcher.call(r,e,t),n&&!e.isPropagationStopped()&&e.bubbles===!0)iv.call(null,n,e,t);else if(!n&&!e.defaultPrevented&&e.target&&e.target[e.type]){pl.has(e.target)||pl.set(e.target,{});const s=pl.get(e.target);e.target[e.type]&&(s.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),s.disabled=!1)}return!e.defaultPrevented}function oS(r,e,t){if(Array.isArray(e))return $2(oS,r,e,t);const i=function(){Bo(r,e,i),t.apply(this,arguments)};i.guid=t.guid=t.guid||_c(),Wu(r,e,i)}function W2(r,e,t){const i=function(){Bo(r,e,i),t.apply(this,arguments)};i.guid=t.guid=t.guid||_c(),Wu(r,e,i)}var C9=Object.freeze({__proto__:null,fixEvent:aS,on:Wu,off:Bo,trigger:iv,one:oS,any:W2});const bc=30,us=function(r,e,t){e.guid||(e.guid=_c());const i=e.bind(r);return i.guid=t?t+"_"+e.guid:e.guid,i},Th=function(r,e){let t=Z.performance.now();return function(...n){const s=Z.performance.now();s-t>=e&&(r(...n),t=s)}},wk=function(r,e,t,i=Z){let n;const s=()=>{i.clearTimeout(n),n=null},a=function(){const c=this,h=arguments;let m=function(){n=null,m=null,t||r.apply(c,h)};!n&&t&&r.apply(c,h),i.clearTimeout(n),n=i.setTimeout(m,e)};return a.cancel=s,a};var M9=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:bc,bind_:us,throttle:Th,debounce:wk});let Hy,qu=class{on(e,t){const i=this.addEventListener;this.addEventListener=()=>{},Wu(this,e,t),this.addEventListener=i}off(e,t){Bo(this,e,t)}one(e,t){const i=this.addEventListener;this.addEventListener=()=>{},oS(this,e,t),this.addEventListener=i}any(e,t){const i=this.addEventListener;this.addEventListener=()=>{},W2(this,e,t),this.addEventListener=i}trigger(e){const t=e.type||e;typeof e=="string"&&(e={type:t}),e=aS(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),iv(this,e)}queueTrigger(e){Hy||(Hy=new Map);const t=e.type||e;let i=Hy.get(this);i||(i=new Map,Hy.set(this,i));const n=i.get(t);i.delete(t),Z.clearTimeout(n);const s=Z.setTimeout(()=>{i.delete(t),i.size===0&&(i=null,Hy.delete(this)),this.trigger(e)},0);i.set(t,s)}};qu.prototype.allowedEvents_={};qu.prototype.addEventListener=qu.prototype.on;qu.prototype.removeEventListener=qu.prototype.off;qu.prototype.dispatchEvent=qu.prototype.trigger;const lS=r=>typeof r.name=="function"?r.name():typeof r.name=="string"?r.name:r.name_?r.name_:r.constructor&&r.constructor.name?r.constructor.name:typeof r,xf=r=>r instanceof qu||!!r.eventBusEl_&&["on","one","off","trigger"].every(e=>typeof r[e]=="function"),D9=(r,e)=>{xf(r)?e():(r.eventedCallbacks||(r.eventedCallbacks=[]),r.eventedCallbacks.push(e))},pE=r=>typeof r=="string"&&/\S/.test(r)||Array.isArray(r)&&!!r.length,hx=(r,e,t)=>{if(!r||!r.nodeName&&!xf(r))throw new Error(`Invalid target for ${lS(e)}#${t}; must be a DOM node or evented object.`)},Ek=(r,e,t)=>{if(!pE(r))throw new Error(`Invalid event type for ${lS(e)}#${t}; must be a non-empty string or array.`)},Ck=(r,e,t)=>{if(typeof r!="function")throw new Error(`Invalid listener for ${lS(e)}#${t}; must be a function.`)},ew=(r,e,t)=>{const i=e.length<3||e[0]===r||e[0]===r.eventBusEl_;let n,s,a;return i?(n=r.eventBusEl_,e.length>=3&&e.shift(),[s,a]=e):(n=e[0],s=e[1],a=e[2]),hx(n,r,t),Ek(s,r,t),Ck(a,r,t),a=us(r,a),{isTargetingSelf:i,target:n,type:s,listener:a}},bm=(r,e,t,i)=>{hx(r,r,e),r.nodeName?C9[e](r,t,i):r[e](t,i)},I9={on(...r){const{isTargetingSelf:e,target:t,type:i,listener:n}=ew(this,r,"on");if(bm(t,"on",i,n),!e){const s=()=>this.off(t,i,n);s.guid=n.guid;const a=()=>this.off("dispose",s);a.guid=n.guid,bm(this,"on","dispose",s),bm(t,"on","dispose",a)}},one(...r){const{isTargetingSelf:e,target:t,type:i,listener:n}=ew(this,r,"one");if(e)bm(t,"one",i,n);else{const s=(...a)=>{this.off(t,i,s),n.apply(null,a)};s.guid=n.guid,bm(t,"one",i,s)}},any(...r){const{isTargetingSelf:e,target:t,type:i,listener:n}=ew(this,r,"any");if(e)bm(t,"any",i,n);else{const s=(...a)=>{this.off(t,i,s),n.apply(null,a)};s.guid=n.guid,bm(t,"any",i,s)}},off(r,e,t){if(!r||pE(r))Bo(this.eventBusEl_,r,e);else{const i=r,n=e;hx(i,this,"off"),Ek(n,this,"off"),Ck(t,this,"off"),t=us(this,t),this.off("dispose",t),i.nodeName?(Bo(i,n,t),Bo(i,"dispose",t)):xf(i)&&(i.off(n,t),i.off("dispose",t))}},trigger(r,e){hx(this.eventBusEl_,this,"trigger");const t=r&&typeof r!="string"?r.type:r;if(!pE(t))throw new Error(`Invalid event type for ${lS(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return iv(this.eventBusEl_,r,e)}};function q2(r,e={}){const{eventBusKey:t}=e;if(t){if(!r[t].nodeName)throw new Error(`The eventBusKey "${t}" does not refer to an element.`);r.eventBusEl_=r[t]}else r.eventBusEl_=cn("span",{className:"vjs-event-bus"});return Object.assign(r,I9),r.eventedCallbacks&&r.eventedCallbacks.forEach(i=>{i()}),r.on("dispose",()=>{r.off(),[r,r.el_,r.eventBusEl_].forEach(function(i){i&&pl.has(i)&&pl.delete(i)}),Z.setTimeout(()=>{r.eventBusEl_=null},0)}),r}const P9={state:{},setState(r){typeof r=="function"&&(r=r());let e;return p0(r,(t,i)=>{this.state[i]!==t&&(e=e||{},e[i]={from:this.state[i],to:t}),this.state[i]=t}),e&&xf(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function Mk(r,e){return Object.assign(r,P9),r.state=Object.assign({},r.state,e),typeof r.handleStateChanged=="function"&&xf(r)&&r.on("statechanged",r.handleStateChanged),r}const d_=function(r){return typeof r!="string"?r:r.replace(/./,e=>e.toLowerCase())},Zs=function(r){return typeof r!="string"?r:r.replace(/./,e=>e.toUpperCase())},Dk=function(r,e){return Zs(r)===Zs(e)};var L9=Object.freeze({__proto__:null,toLowerCase:d_,toTitleCase:Zs,titleCaseEquals:Dk});let Vt=class Gl{constructor(e,t,i){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=Yr({},this.options_),t=this.options_=Yr(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){const n=e&&e.id&&e.id()||"no_player";this.id_=`${n}_component_${_c()}`}this.name_=t.name||null,t.el?this.el_=t.el:t.createEl!==!1&&(this.el_=this.createEl()),t.className&&this.el_&&t.className.split(" ").forEach(n=>this.addClass(n)),["on","off","one","any","trigger"].forEach(n=>{this[n]=void 0}),t.evented!==!1&&(q2(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),Mk(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,t.initChildren!==!1&&this.initChildren(),this.ready(i),t.reportTouchActivity!==!1&&this.enableTouchActivity()}dispose(e={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let t=this.children_.length-1;t>=0;t--)this.children_[t].dispose&&this.children_[t].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return!!this.isDisposed_}player(){return this.player_}options(e){return e?(this.options_=Yr(this.options_,e),this.options_):this.options_}el(){return this.el_}createEl(e,t,i){return cn(e,t,i)}localize(e,t,i=e){const n=this.player_.language&&this.player_.language(),s=this.player_.languages&&this.player_.languages(),a=s&&s[n],c=n&&n.split("-")[0],h=s&&s[c];let m=i;return a&&a[e]?m=a[e]:h&&h[e]&&(m=h[e]),t&&(m=m.replace(/\{(\d+)\}/g,function(v,b){const x=t[b-1];let C=x;return typeof x>"u"&&(C=v),C})),m}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(e)return this.childNameIndex_[e]}getDescendant(...e){e=e.reduce((i,n)=>i.concat(n),[]);let t=this;for(let i=0;i<e.length;i++)if(t=t.getChild(e[i]),!t||!t.getChild)return;return t}setIcon(e,t=this.el()){if(!this.player_.options_.experimentalSvgIcons)return;const i="http://www.w3.org/2000/svg",n=cn("span",{className:"vjs-icon-placeholder vjs-svg-icon"},{"aria-hidden":"true"}),s=ot.createElementNS(i,"svg");s.setAttributeNS(null,"viewBox","0 0 512 512");const a=ot.createElementNS(i,"use");return s.appendChild(a),a.setAttributeNS(null,"href",`#vjs-icon-${e}`),n.appendChild(s),this.iconIsSet_?t.replaceChild(n,t.querySelector(".vjs-icon-placeholder")):t.appendChild(n),this.iconIsSet_=!0,n}addChild(e,t={},i=this.children_.length){let n,s;if(typeof e=="string"){s=Zs(e);const a=t.componentClass||s;t.name=s;const c=Gl.getComponent(a);if(!c)throw new Error(`Component ${a} does not exist`);if(typeof c!="function")return null;n=new c(this.player_||this,t)}else n=e;if(n.parentComponent_&&n.parentComponent_.removeChild(n),this.children_.splice(i,0,n),n.parentComponent_=this,typeof n.id=="function"&&(this.childIndex_[n.id()]=n),s=s||n.name&&Zs(n.name()),s&&(this.childNameIndex_[s]=n,this.childNameIndex_[d_(s)]=n),typeof n.el=="function"&&n.el()){let a=null;this.children_[i+1]&&(this.children_[i+1].el_?a=this.children_[i+1].el_:tv(this.children_[i+1])&&(a=this.children_[i+1])),this.contentEl().insertBefore(n.el(),a)}return n}removeChild(e){if(typeof e=="string"&&(e=this.getChild(e)),!e||!this.children_)return;let t=!1;for(let n=this.children_.length-1;n>=0;n--)if(this.children_[n]===e){t=!0,this.children_.splice(n,1);break}if(!t)return;e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Zs(e.name())]=null,this.childNameIndex_[d_(e.name())]=null;const i=e.el();i&&i.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}initChildren(){const e=this.options_.children;if(e){const t=this.options_,i=a=>{const c=a.name;let h=a.opts;if(t[c]!==void 0&&(h=t[c]),h===!1)return;h===!0&&(h={}),h.playerOptions=this.options_.playerOptions;const m=this.addChild(c,h);m&&(this[c]=m)};let n;const s=Gl.getComponent("Tech");Array.isArray(e)?n=e:n=Object.keys(e),n.concat(Object.keys(this.options_).filter(function(a){return!n.some(function(c){return typeof c=="string"?a===c:a===c.name})})).map(a=>{let c,h;return typeof a=="string"?(c=a,h=e[c]||this.options_[c]||{}):(c=a.name,h=a),{name:c,opts:h}}).filter(a=>{const c=Gl.getComponent(a.opts.componentClass||Zs(a.name));return c&&!s.isTech(c)}).forEach(i)}}buildCSSClass(){return""}ready(e,t=!1){if(e){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(e);return}t?e.call(this):this.setTimeout(e,1)}}triggerReady(){this.isReady_=!0,this.setTimeout(function(){const e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(t){t.call(this)},this),this.trigger("ready")},1)}$(e,t){return Lp(e,t||this.contentEl())}$$(e,t){return _k(e,t||this.contentEl())}hasClass(e){return c_(this.el_,e)}addClass(...e){Hm(this.el_,...e)}removeClass(...e){iS(this.el_,...e)}toggleClass(e,t){dk(this.el_,e,t)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return fk(this.el_,e)}setAttribute(e,t){N0(this.el_,e,t)}removeAttribute(e){nS(this.el_,e)}width(e,t){return this.dimension("width",e,t)}height(e,t){return this.dimension("height",e,t)}dimensions(e,t){this.width(e,!0),this.height(t)}dimension(e,t,i){if(t!==void 0){(t===null||t!==t)&&(t=0),(""+t).indexOf("%")!==-1||(""+t).indexOf("px")!==-1?this.el_.style[e]=t:t==="auto"?this.el_.style[e]="":this.el_.style[e]=t+"px",i||this.trigger("componentresize");return}if(!this.el_)return 0;const n=this.el_.style[e],s=n.indexOf("px");return parseInt(s!==-1?n.slice(0,s):this.el_["offset"+Zs(e)],10)}currentDimension(e){let t=0;if(e!=="width"&&e!=="height")throw new Error("currentDimension only accepts width or height value");if(t=V0(this.el_,e),t=parseFloat(t),t===0||isNaN(t)){const i=`offset${Zs(e)}`;t=this.el_[i]}return t}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}getPositions(){const e=this.el_.getBoundingClientRect(),t={x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,right:e.right,bottom:e.bottom,left:e.left},i={x:e.left+e.width/2,y:e.top+e.height/2,width:0,height:0,top:e.top+e.height/2,right:e.left+e.width/2,bottom:e.top+e.height/2,left:e.left+e.width/2};return{boundingClientRect:t,center:i}}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&(e.key!=="Tab"&&!(this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled)&&e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let e=0,t=null;const i=10,n=200;let s;this.on("touchstart",function(c){c.touches.length===1&&(t={pageX:c.touches[0].pageX,pageY:c.touches[0].pageY},e=Z.performance.now(),s=!0)}),this.on("touchmove",function(c){if(c.touches.length>1)s=!1;else if(t){const h=c.touches[0].pageX-t.pageX,m=c.touches[0].pageY-t.pageY;Math.sqrt(h*h+m*m)>i&&(s=!1)}});const a=function(){s=!1};this.on("touchleave",a),this.on("touchcancel",a),this.on("touchend",function(c){t=null,s===!0&&Z.performance.now()-e<n&&(c.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const e=us(this.player(),this.player().reportUserActivity);let t;this.on("touchstart",function(){e(),this.clearInterval(t),t=this.setInterval(e,250)});const i=function(n){e(),this.clearInterval(t)};this.on("touchmove",e),this.on("touchend",i),this.on("touchcancel",i)}setTimeout(e,t){var i;return e=us(this,e),this.clearTimersOnDispose_(),i=Z.setTimeout(()=>{this.setTimeoutIds_.has(i)&&this.setTimeoutIds_.delete(i),e()},t),this.setTimeoutIds_.add(i),i}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),Z.clearTimeout(e)),e}setInterval(e,t){e=us(this,e),this.clearTimersOnDispose_();const i=Z.setInterval(e,t);return this.setIntervalIds_.add(i),i}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),Z.clearInterval(e)),e}requestAnimationFrame(e){this.clearTimersOnDispose_();var t;return e=us(this,e),t=Z.requestAnimationFrame(()=>{this.rafIds_.has(t)&&this.rafIds_.delete(t),e()}),this.rafIds_.add(t),t}requestNamedAnimationFrame(e,t){this.namedRafs_.has(e)&&this.cancelNamedAnimationFrame(e),this.clearTimersOnDispose_(),t=us(this,t);const i=this.requestAnimationFrame(()=>{t(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)});return this.namedRafs_.set(e,i),e}cancelNamedAnimationFrame(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),Z.cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([e,t])=>{this[e].forEach((i,n)=>this[t](n))}),this.clearingTimersOnDispose_=!1}))}getIsDisabled(){return!!this.el_.disabled}getIsExpresslyInert(){return this.el_.inert&&!this.el_.ownerDocument.documentElement.inert}getIsFocusable(e){return(e||this.el_).tabIndex>=0&&!(this.getIsDisabled()||this.getIsExpresslyInert())}getIsAvailableToBeFocused(e){function t(s){const a=Z.getComputedStyle(s,null),c=a.getPropertyValue("visibility");return a.getPropertyValue("display")!=="none"&&!["hidden","collapse"].includes(c)}function i(s){return!(!t(s.parentElement)||!t(s)||s.style.opacity==="0"||Z.getComputedStyle(s).height==="0px"||Z.getComputedStyle(s).width==="0px")}function n(s){if(s.offsetWidth+s.offsetHeight+s.getBoundingClientRect().height+s.getBoundingClientRect().width===0)return!1;const a={x:s.getBoundingClientRect().left+s.offsetWidth/2,y:s.getBoundingClientRect().top+s.offsetHeight/2};if(a.x<0||a.x>(ot.documentElement.clientWidth||Z.innerWidth)||a.y<0||a.y>(ot.documentElement.clientHeight||Z.innerHeight))return!1;let c=ot.elementFromPoint(a.x,a.y);for(;c;){if(c===s)return!0;if(c.parentNode)c=c.parentNode;else return!1}}return e||(e=this.el()),!!(n(e)&&i(e)&&(!e.parentElement||e.tabIndex>=0))}static registerComponent(e,t){if(typeof e!="string"||!e)throw new Error(`Illegal component name, "${e}"; must be a non-empty string.`);const i=Gl.getComponent("Tech"),n=i&&i.isTech(t),s=Gl===t||Gl.prototype.isPrototypeOf(t.prototype);if(n||!s){let c;throw n?c="techs must be registered using Tech.registerTech()":c="must be a Component subclass",new Error(`Illegal component, "${e}"; ${c}.`)}e=Zs(e),Gl.components_||(Gl.components_={});const a=Gl.getComponent("Player");if(e==="Player"&&a&&a.players){const c=a.players,h=Object.keys(c);if(c&&h.length>0){for(let m=0;m<h.length;m++)if(c[h[m]]!==null)throw new Error("Can not register Player component after player has been created.")}}return Gl.components_[e]=t,Gl.components_[d_(e)]=t,t}static getComponent(e){if(!(!e||!Gl.components_))return Gl.components_[e]}};Vt.registerComponent("Component",Vt);function R9(r,e,t){if(typeof e!="number"||e<0||e>t)throw new Error(`Failed to execute '${r}' on 'TimeRanges': The index provided (${e}) is non-numeric or out of bounds (0-${t}).`)}function _I(r,e,t,i){return R9(r,i,t.length-1),t[i][e]}function tw(r){let e;return r===void 0||r.length===0?e={length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:e={length:r.length,start:_I.bind(null,"start",0,r),end:_I.bind(null,"end",1,r)},Z.Symbol&&Z.Symbol.iterator&&(e[Z.Symbol.iterator]=()=>(r||[]).values()),e}function Yc(r,e){return Array.isArray(r)?tw(r):r===void 0||e===void 0?tw():tw([[r,e]])}const Ik=function(r,e){r=r<0?0:r;let t=Math.floor(r%60),i=Math.floor(r/60%60),n=Math.floor(r/3600);const s=Math.floor(e/60%60),a=Math.floor(e/3600);return(isNaN(r)||r===1/0)&&(n=i=t="-"),n=n>0||a>0?n+":":"",i=((n||s>=10)&&i<10?"0"+i:i)+":",t=t<10?"0"+t:t,n+i+t};let X2=Ik;function Pk(r){X2=r}function Lk(){X2=Ik}function Km(r,e=r){return X2(r,e)}var k9=Object.freeze({__proto__:null,createTimeRanges:Yc,createTimeRange:Yc,setFormatTime:Pk,resetFormatTime:Lk,formatTime:Km});function Rk(r,e){let t=0,i,n;if(!e)return 0;(!r||!r.length)&&(r=Yc(0,0));for(let s=0;s<r.length;s++)i=r.start(s),n=r.end(s),n>e&&(n=e),t+=n-i;return t/e}function Hs(r){if(r instanceof Hs)return r;typeof r=="number"?this.code=r:typeof r=="string"?this.message=r:_h(r)&&(typeof r.code=="number"&&(this.code=r.code),Object.assign(this,r)),this.message||(this.message=Hs.defaultMessages[this.code]||"")}Hs.prototype.code=0;Hs.prototype.message="";Hs.prototype.status=null;Hs.prototype.metadata=null;Hs.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];Hs.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};Hs.MEDIA_ERR_CUSTOM=0;Hs.prototype.MEDIA_ERR_CUSTOM=0;Hs.MEDIA_ERR_ABORTED=1;Hs.prototype.MEDIA_ERR_ABORTED=1;Hs.MEDIA_ERR_NETWORK=2;Hs.prototype.MEDIA_ERR_NETWORK=2;Hs.MEDIA_ERR_DECODE=3;Hs.prototype.MEDIA_ERR_DECODE=3;Hs.MEDIA_ERR_SRC_NOT_SUPPORTED=4;Hs.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED=4;Hs.MEDIA_ERR_ENCRYPTED=5;Hs.prototype.MEDIA_ERR_ENCRYPTED=5;function h_(r){return r!=null&&typeof r.then=="function"}function uh(r){h_(r)&&r.then(null,e=>{})}const mE=function(r){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((t,i,n)=>(r[i]&&(t[i]=r[i]),t),{cues:r.cues&&Array.prototype.map.call(r.cues,function(t){return{startTime:t.startTime,endTime:t.endTime,text:t.text,id:t.id}})})},O9=function(r){const e=r.$$("track"),t=Array.prototype.map.call(e,n=>n.track);return Array.prototype.map.call(e,function(n){const s=mE(n.track);return n.src&&(s.src=n.src),s}).concat(Array.prototype.filter.call(r.textTracks(),function(n){return t.indexOf(n)===-1}).map(mE))},F9=function(r,e){return r.forEach(function(t){const i=e.addRemoteTextTrack(t).track;!t.src&&t.cues&&t.cues.forEach(n=>i.addCue(n))}),e.textTracks()};var gE={textTracksToJson:O9,jsonToTextTracks:F9,trackToJson:mE};const iw="vjs-modal-dialog";let nv=class extends Vt{constructor(e,t){super(e,t),this.handleKeyDown_=i=>this.handleKeyDown(i),this.close_=i=>this.close(i),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=cn("div",{className:`${iw}-content`},{role:"document"}),this.descEl_=cn("p",{className:`${iw}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),Up(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog","aria-live":"polite"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${iw} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){if(this.opened_){this.options_.fillAlways&&this.fill();return}const e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}opened(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger({type:"modalclose",bubbles:!0}),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(e){if(typeof e=="boolean"){const t=this.closeable_=!!e;let i=this.getChild("closeButton");if(t&&!i){const n=this.contentEl_;this.contentEl_=this.el_,i=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=n,this.on(i,"close",this.close_)}!t&&i&&(this.off(i,"close",this.close_),this.removeChild(i),i.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){const t=this.contentEl(),i=t.parentNode,n=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,i.removeChild(t),this.empty(),yk(t,e),this.trigger("modalfill"),n?i.insertBefore(t,n):i.appendChild(t);const s=this.getChild("closeButton");s&&i.appendChild(s.el_),this.trigger("aftermodalfill")}empty(){this.trigger("beforemodalempty"),sS(this.contentEl()),this.trigger("modalempty")}content(e){return typeof e<"u"&&(this.content_=e),this.content_}conditionalFocus_(){const e=ot.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,(t.contains(e)||t===e)&&(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(this.trigger({type:"modalKeydown",originalEvent:e,target:this,bubbles:!0}),e.stopPropagation(),e.key==="Escape"&&this.closeable()){e.preventDefault(),this.close();return}if(e.key!=="Tab")return;const t=this.focusableEls_(),i=this.el_.querySelector(":focus");let n;for(let s=0;s<t.length;s++)if(i===t[s]){n=s;break}ot.activeElement===this.el_&&(n=0),e.shiftKey&&n===0?(t[t.length-1].focus(),e.preventDefault()):!e.shiftKey&&n===t.length-1&&(t[0].focus(),e.preventDefault())}focusableEls_(){const e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,t=>(t instanceof Z.HTMLAnchorElement||t instanceof Z.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof Z.HTMLInputElement||t instanceof Z.HTMLSelectElement||t instanceof Z.HTMLTextAreaElement||t instanceof Z.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof Z.HTMLIFrameElement||t instanceof Z.HTMLObjectElement||t instanceof Z.HTMLEmbedElement||t.hasAttribute("tabindex")&&t.getAttribute("tabindex")!==-1||t.hasAttribute("contenteditable"))}};nv.prototype.options_={pauseOnOpen:!0,temporary:!0};Vt.registerComponent("ModalDialog",nv);let Zm=class extends qu{constructor(e=[]){super(),this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let t=0;t<e.length;t++)this.addTrack(e[t])}addTrack(e){const t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.tracks_[t]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},xf(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(e){let t;for(let i=0,n=this.length;i<n;i++)if(this[i]===e){t=this[i],t.off&&t.off(),this.tracks_.splice(i,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})}getTrackById(e){let t=null;for(let i=0,n=this.length;i<n;i++){const s=this[i];if(s.id===e){t=s;break}}return t}};Zm.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const r in Zm.prototype.allowedEvents_)Zm.prototype["on"+r]=null;const nw=function(r,e){for(let t=0;t<r.length;t++)!Object.keys(r[t]).length||e.id===r[t].id||(r[t].enabled=!1)};let kk=class extends Zm{constructor(e=[]){for(let t=e.length-1;t>=0;t--)if(e[t].enabled){nw(e,e[t]);break}super(e),this.changing_=!1}addTrack(e){e.enabled&&nw(this,e),super.addTrack(e),e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,nw(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}};const rw=function(r,e){for(let t=0;t<r.length;t++)!Object.keys(r[t]).length||e.id===r[t].id||(r[t].selected=!1)};let Ok=class extends Zm{constructor(e=[]){for(let t=e.length-1;t>=0;t--)if(e[t].selected){rw(e,e[t]);break}super(e),this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let t=0;t<this.length;t++)if(this[t].selected)return t;return-1},set(){}})}addTrack(e){e.selected&&rw(this,e),super.addTrack(e),e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,rw(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}},Y2=class extends Zm{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}toJSON(){return this.tracks_.map(e=>e.toJSON())}},B9=class{constructor(e=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let t=0,i=e.length;t<i;t++)this.addTrackElement_(e[t])}addTrackElement_(e){const t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.trackElements_[t]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)}getTrackElementByTrack_(e){let t;for(let i=0,n=this.trackElements_.length;i<n;i++)if(e===this.trackElements_[i].track){t=this.trackElements_[i];break}return t}removeTrackElement_(e){for(let t=0,i=this.trackElements_.length;t<i;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&typeof this.trackElements_[t].track.off=="function"&&this.trackElements_[t].track.off(),typeof this.trackElements_[t].off=="function"&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}}},bI=class Fk{constructor(e){Fk.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){const t=this.length||0;let i=0;const n=e.length;this.cues_=e,this.length_=e.length;const s=function(a){""+a in this||Object.defineProperty(this,""+a,{get(){return this.cues_[a]}})};if(t<n)for(i=t;i<n;i++)s.call(this,i)}getCueById(e){let t=null;for(let i=0,n=this.length;i<n;i++){const s=this[i];if(s.id===e){t=s;break}}return t}};const N9={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},U9={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},V9={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},TI={disabled:"disabled",hidden:"hidden",showing:"showing"};let Q2=class extends qu{constructor(e={}){super();const t={id:e.id||"vjs_track_"+_c(),kind:e.kind||"",language:e.language||""};let i=e.label||"";for(const n in t)Object.defineProperty(this,n,{get(){return t[n]},set(){}});Object.defineProperty(this,"label",{get(){return i},set(n){n!==i&&(i=n,this.trigger("labelchange"))}})}};const K2=function(r){return new URL(r,ot.baseURI)},Bk=function(r){return new URL(r,ot.baseURI).href},Z2=function(r){if(typeof r=="string"){const t=r.split("?")[0].replace(/\/+$/,"").match(/\.([^.\/]+)$/);return t?t[1].toLowerCase():""}return""},uS=function(r,e=Z.location){return K2(r).origin!==e.origin};var z9=Object.freeze({__proto__:null,parseUrl:K2,getAbsoluteURL:Bk,getFileExtension:Z2,isCrossOrigin:uS});const xI=function(r,e){const t=new Z.WebVTT.Parser(Z,Z.vttjs,Z.WebVTT.StringDecoder()),i=[];t.oncue=function(n){e.addCue(n)},t.onparsingerror=function(n){i.push(n)},t.onflush=function(){e.trigger({type:"loadeddata",target:e})},t.parse(r),i.length>0&&(Z.console&&Z.console.groupCollapsed&&Z.console.groupCollapsed(`Text Track parsing errors for ${e.src}`),i.forEach(n=>Zn.error(n)),Z.console&&Z.console.groupEnd&&Z.console.groupEnd()),t.flush()},SI=function(r,e){const t={uri:r},i=uS(r);i&&(t.cors=i);const n=e.tech_.crossOrigin()==="use-credentials";n&&(t.withCredentials=n),BR(t,us(this,function(s,a,c){if(s)return Zn.error(s,a);e.loaded_=!0,typeof Z.WebVTT!="function"?e.tech_&&e.tech_.any(["vttjsloaded","vttjserror"],h=>{if(h.type==="vttjserror"){Zn.error(`vttjs failed to load, stopping trying to process ${e.src}`);return}return xI(c,e)}):xI(c,e)}))};let $_=class extends Q2{constructor(e={}){if(!e.tech)throw new Error("A tech was not provided.");const t=Yr(e,{kind:V9[e.kind]||"subtitles",language:e.language||e.srclang||""});let i=TI[t.mode]||"disabled";const n=t.default;(t.kind==="metadata"||t.kind==="chapters")&&(i="hidden"),super(t),this.tech_=t.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1;const s=new bI(this.cues_),a=new bI(this.activeCues_);let c=!1;this.timeupdateHandler=us(this,function(m={}){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_){m.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,c&&(this.trigger("cuechange"),c=!1),m.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});const h=()=>{this.stopTracking()};this.tech_.one("dispose",h),i!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return n},set(){}},mode:{get(){return i},set(m){TI[m]&&i!==m&&(i=m,!this.preload_&&i!=="disabled"&&this.cues.length===0&&SI(this.src,this),this.stopTracking(),i!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?s:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length===0)return a;const m=this.tech_.currentTime(),v=[];for(let b=0,x=this.cues.length;b<x;b++){const C=this.cues[b];C.startTime<=m&&C.endTime>=m&&v.push(C)}if(c=!1,v.length!==this.activeCues_.length)c=!0;else for(let b=0;b<v.length;b++)this.activeCues_.indexOf(v[b])===-1&&(c=!0);return this.activeCues_=v,a.setCues_(this.activeCues_),a},set(){}}}),t.src?(this.src=t.src,this.preload_||(this.loaded_=!0),(this.preload_||t.kind!=="subtitles"&&t.kind!=="captions")&&SI(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let t=e;if(!("getCueAsHTML"in t)){t=new Z.vttjs.VTTCue(e.startTime,e.endTime,e.text);for(const n in e)n in t||(t[n]=e[n]);t.id=e.id,t.originalCue_=e}const i=this.tech_.textTracks();for(let n=0;n<i.length;n++)i[n]!==this&&i[n].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)}toJSON(){return gE.trackToJson(this)}removeCue(e){let t=this.cues_.length;for(;t--;){const i=this.cues_[t];if(i===e||i.originalCue_&&i.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}}};$_.prototype.allowedEvents_={cuechange:"cuechange"};let Nk=class extends Q2{constructor(e={}){const t=Yr(e,{kind:U9[e.kind]||""});super(t);let i=!1;Object.defineProperty(this,"enabled",{get(){return i},set(n){typeof n!="boolean"||n===i||(i=n,this.trigger("enabledchange"))}}),t.enabled&&(this.enabled=t.enabled),this.loaded_=!0}},Uk=class extends Q2{constructor(e={}){const t=Yr(e,{kind:N9[e.kind]||""});super(t);let i=!1;Object.defineProperty(this,"selected",{get(){return i},set(n){typeof n!="boolean"||n===i||(i=n,this.trigger("selectedchange"))}}),t.selected&&(this.selected=t.selected)}},rv=class vE extends qu{constructor(e={}){super();let t;const i=new $_(e);this.kind=i.kind,this.src=i.src,this.srclang=i.language,this.label=i.label,this.default=i.default,Object.defineProperties(this,{readyState:{get(){return t}},track:{get(){return i}}}),t=vE.NONE,i.addEventListener("loadeddata",()=>{t=vE.LOADED,this.trigger({type:"load",target:this})})}};rv.prototype.allowedEvents_={load:"load"};rv.NONE=0;rv.LOADING=1;rv.LOADED=2;rv.ERROR=3;const gc={audio:{ListClass:kk,TrackClass:Nk,capitalName:"Audio"},video:{ListClass:Ok,TrackClass:Uk,capitalName:"Video"},text:{ListClass:Y2,TrackClass:$_,capitalName:"Text"}};Object.keys(gc).forEach(function(r){gc[r].getterName=`${r}Tracks`,gc[r].privateName=`${r}Tracks_`});const z0={remoteText:{ListClass:Y2,TrackClass:$_,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:B9,TrackClass:rv,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},cl=Object.assign({},gc,z0);z0.names=Object.keys(z0);gc.names=Object.keys(gc);cl.names=[].concat(z0.names).concat(gc.names);function H9(r,e,t,i,n={}){const s=r.textTracks();n.kind=e,t&&(n.label=t),i&&(n.language=i),n.tech=r;const a=new cl.text.TrackClass(n);return s.addTrack(a),a}let ts=class ko extends Vt{constructor(e={},t=function(){}){e.reportTouchActivity=!1,super(null,e,t),this.onDurationChange_=i=>this.onDurationChange(i),this.trackProgress_=i=>this.trackProgress(i),this.trackCurrentTime_=i=>this.trackCurrentTime(i),this.stopTrackingCurrentTime_=i=>this.stopTrackingCurrentTime(i),this.disposeSourceHandler_=i=>this.disposeSourceHandler(i),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),cl.names.forEach(i=>{const n=cl[i];e&&e[n.getterName]&&(this[n.privateName]=e[n.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(i=>{e[`native${i}Tracks`]===!1&&(this[`featuresNative${i}Tracks`]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:(e.nativeCaptions===!0||e.nativeTextTracks===!0)&&(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=e.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new cl.text.ListClass,this.initTrackListeners(),e.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(e),1)),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(us(this,function(){const t=this.bufferedPercent();this.bufferedPercent_!==t&&this.trigger("progress"),this.bufferedPercent_=t,t===1&&this.stopTrackingProgress()}),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return Yc(0,0)}bufferedPercent(){return Rk(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(gc.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){e=[].concat(e),e.forEach(t=>{const i=this[`${t}Tracks`]()||[];let n=i.length;for(;n--;){const s=i[n];t==="text"&&this.removeRemoteTextTrack(s),i.removeTrack(s)}})}cleanupAutoTextTracks(){const e=this.autoRemoteTextTracks_||[];let t=e.length;for(;t--;){const i=e[t];this.removeRemoteTextTrack(i)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return e!==void 0&&(this.error_=new Hs(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?Yc(0,0):Yc()}play(){}setScrubbing(e){}scrubbing(){}setCurrentTime(e){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){gc.names.forEach(e=>{const t=gc[e],i=()=>{this.trigger(`${e}trackchange`)},n=this[t.getterName]();n.addEventListener("removetrack",i),n.addEventListener("addtrack",i),this.on("dispose",()=>{n.removeEventListener("removetrack",i),n.removeEventListener("addtrack",i)})})}addWebVttScript_(){if(!Z.WebVTT)if(ot.body.contains(this.el())){if(!this.options_["vtt.js"]&&B0(rx)&&Object.keys(rx).length>0){this.trigger("vttjsloaded");return}const e=ot.createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{e.onload=null,e.onerror=null}),Z.WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const e=this.textTracks(),t=this.remoteTextTracks(),i=c=>e.addTrack(c.track),n=c=>e.removeTrack(c.track);t.on("addtrack",i),t.on("removetrack",n),this.addWebVttScript_();const s=()=>this.trigger("texttrackchange"),a=()=>{s();for(let c=0;c<e.length;c++){const h=e[c];h.removeEventListener("cuechange",s),h.mode==="showing"&&h.addEventListener("cuechange",s)}};a(),e.addEventListener("change",a),e.addEventListener("addtrack",a),e.addEventListener("removetrack",a),this.on("dispose",function(){t.off("addtrack",i),t.off("removetrack",n),e.removeEventListener("change",a),e.removeEventListener("addtrack",a),e.removeEventListener("removetrack",a);for(let c=0;c<e.length;c++)e[c].removeEventListener("cuechange",s)})}addTextTrack(e,t,i){if(!e)throw new Error("TextTrack kind is required but was not provided");return H9(this,e,t,i)}createRemoteTextTrack(e){const t=Yr(e,{tech:this});return new z0.remoteTextEl.TrackClass(t)}addRemoteTextTrack(e={},t){const i=this.createRemoteTextTrack(e);return typeof t!="boolean"&&(t=!1),this.remoteTextTrackEls().addTrackElement_(i),this.remoteTextTracks().addTrack(i.track),t===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(i.track)),i}removeRemoteTextTrack(e){const t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const t=_c();return!this.isReady_||this.paused()?(this.queuedHanders_.add(t),this.one("playing",()=>{this.queuedHanders_.has(t)&&(this.queuedHanders_.delete(t),e())})):this.requestNamedAnimationFrame(t,e),t}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(e){}overrideNativeVideoTracks(e){}canPlayType(e){return""}static canPlayType(e){return""}static canPlaySource(e,t){return ko.canPlayType(e.type)}static isTech(e){return e.prototype instanceof ko||e instanceof ko||e===ko}static registerTech(e,t){if(ko.techs_||(ko.techs_={}),!ko.isTech(t))throw new Error(`Tech ${e} must be a Tech`);if(!ko.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!ko.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Zs(e),ko.techs_[e]=t,ko.techs_[d_(e)]=t,e!=="Tech"&&ko.defaultTechOrder_.push(e),t}static getTech(e){if(e){if(ko.techs_&&ko.techs_[e])return ko.techs_[e];if(e=Zs(e),Z&&Z.videojs&&Z.videojs[e])return Zn.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),Z.videojs[e]}}};cl.names.forEach(function(r){const e=cl[r];ts.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}});ts.prototype.featuresVolumeControl=!0;ts.prototype.featuresMuteControl=!0;ts.prototype.featuresFullscreenResize=!1;ts.prototype.featuresPlaybackRate=!1;ts.prototype.featuresProgressEvents=!1;ts.prototype.featuresSourceset=!1;ts.prototype.featuresTimeupdateEvents=!1;ts.prototype.featuresNativeTextTracks=!1;ts.prototype.featuresVideoFrameCallback=!1;ts.withSourceHandlers=function(r){r.registerSourceHandler=function(t,i){let n=r.sourceHandlers;n||(n=r.sourceHandlers=[]),i===void 0&&(i=n.length),n.splice(i,0,t)},r.canPlayType=function(t){const i=r.sourceHandlers||[];let n;for(let s=0;s<i.length;s++)if(n=i[s].canPlayType(t),n)return n;return""},r.selectSourceHandler=function(t,i){const n=r.sourceHandlers||[];let s;for(let a=0;a<n.length;a++)if(s=n[a].canHandleSource(t,i),s)return n[a];return null},r.canPlaySource=function(t,i){const n=r.selectSourceHandler(t,i);return n?n.canHandleSource(t,i):""},["seekable","seeking","duration"].forEach(function(t){const i=this[t];typeof i=="function"&&(this[t]=function(){return this.sourceHandler_&&this.sourceHandler_[t]?this.sourceHandler_[t].apply(this.sourceHandler_,arguments):i.apply(this,arguments)})},r.prototype),r.prototype.setSource=function(t){let i=r.selectSourceHandler(t,this.options_);i||(r.nativeSourceHandler?i=r.nativeSourceHandler:Zn.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),i!==r.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=i.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},r.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};Vt.registerComponent("Tech",ts);ts.registerTech("Tech",ts);ts.defaultTechOrder_=[];const jm={},fx={},px={};function j9(r,e){jm[r]=jm[r]||[],jm[r].push(e)}function G9(r,e,t){r.setTimeout(()=>Em(e,jm[e.type],t,r),1)}function $9(r,e){r.forEach(t=>t.setTech&&t.setTech(e))}function W9(r,e,t){return r.reduceRight(J2(t),e[t]())}function q9(r,e,t,i){return e[t](r.reduce(J2(t),i))}function AI(r,e,t,i=null){const n="call"+Zs(t),s=r.reduce(J2(n),i),a=s===px,c=a?null:e[t](s);return Q9(r,t,c,a),c}const X9={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},Y9={setCurrentTime:1,setMuted:1,setVolume:1},wI={play:1,pause:1};function J2(r){return(e,t)=>e===px?px:t[r]?t[r](e):e}function Q9(r,e,t,i){for(let n=r.length-1;n>=0;n--){const s=r[n];s[e]&&s[e](i,t)}}function K9(r){fx.hasOwnProperty(r.id())&&delete fx[r.id()]}function Z9(r,e){const t=fx[r.id()];let i=null;if(t==null)return i=e(r),fx[r.id()]=[[e,i]],i;for(let n=0;n<t.length;n++){const[s,a]=t[n];s===e&&(i=a)}return i===null&&(i=e(r),t.push([e,i])),i}function Em(r={},e=[],t,i,n=[],s=!1){const[a,...c]=e;if(typeof a=="string")Em(r,jm[a],t,i,n,s);else if(a){const h=Z9(i,a);if(!h.setSource)return n.push(h),Em(r,c,t,i,n,s);h.setSource(Object.assign({},r),function(m,v){if(m)return Em(r,c,t,i,n,s);n.push(h),Em(v,r.type===v.type?c:jm[v.type],t,i,n,s)})}else c.length?Em(r,c,t,i,n,s):s?t(r,n):Em(r,jm["*"],t,i,n,!0)}const J9={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},mx=function(r=""){const e=Z2(r);return J9[e.toLowerCase()]||""},eV=(r,e)=>{if(!e)return"";if(r.cache_.source.src===e&&r.cache_.source.type)return r.cache_.source.type;const t=r.cache_.sources.filter(n=>n.src===e);if(t.length)return t[0].type;const i=r.$$("source");for(let n=0;n<i.length;n++){const s=i[n];if(s.type&&s.src&&s.src===e)return s.type}return mx(e)},Vk=function(r){if(Array.isArray(r)){let e=[];r.forEach(function(t){t=Vk(t),Array.isArray(t)?e=e.concat(t):_h(t)&&e.push(t)}),r=e}else typeof r=="string"&&r.trim()?r=[EI({src:r})]:_h(r)&&typeof r.src=="string"&&r.src&&r.src.trim()?r=[EI(r)]:r=[];return r};function EI(r){if(!r.type){const e=mx(r.src);e&&(r.type=e)}return r}var tV=`<svg xmlns="http://www.w3.org/2000/svg">
  <defs>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play">
      <path d="M16 10v28l22-14z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-pause">
      <path d="M12 38h8V10h-8v28zm16-28v28h8V10h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-audio">
      <path d="M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h6c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-captions">
      <path d="M38 8H10c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM22 22h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2zm14 0h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-subtitles">
      <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-enter">
      <path d="M14 28h-4v10h10v-4h-6v-6zm-4-8h4v-6h6v-4H10v10zm24 14h-6v4h10V28h-4v6zm-6-24v4h6v6h4V10H28z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-exit">
      <path d="M10 32h6v6h4V28H10v4zm6-16h-6v4h10V10h-4v6zm12 22h4v-6h6v-4H28v10zm4-22v-6h-4v10h10v-4h-6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play-circle">
      <path d="M20 33l12-9-12-9v18zm4-29C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-mute">
      <path d="M33 24c0-3.53-2.04-6.58-5-8.05v4.42l4.91 4.91c.06-.42.09-.85.09-1.28zm5 0c0 1.88-.41 3.65-1.08 5.28l3.03 3.03C41.25 29.82 42 27 42 24c0-8.56-5.99-15.72-14-17.54v4.13c5.78 1.72 10 7.07 10 13.41zM8.55 6L6 8.55 15.45 18H6v12h8l10 10V26.55l8.51 8.51c-1.34 1.03-2.85 1.86-4.51 2.36v4.13a17.94 17.94 0 0 0 7.37-3.62L39.45 42 42 39.45l-18-18L8.55 6zM24 8l-4.18 4.18L24 16.36V8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-low">
      <path d="M14 18v12h8l10 10V8L22 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-medium">
      <path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-high">
      <path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-spinner">
      <path d="M18.8 21l9.53-16.51C26.94 4.18 25.49 4 24 4c-4.8 0-9.19 1.69-12.64 4.51l7.33 12.69.11-.2zm24.28-3c-1.84-5.85-6.3-10.52-11.99-12.68L23.77 18h19.31zm.52 2H28.62l.58 1 9.53 16.5C41.99 33.94 44 29.21 44 24c0-1.37-.14-2.71-.4-4zm-26.53 4l-7.8-13.5C6.01 14.06 4 18.79 4 24c0 1.37.14 2.71.4 4h14.98l-2.31-4zM4.92 30c1.84 5.85 6.3 10.52 11.99 12.68L24.23 30H4.92zm22.54 0l-7.8 13.51c1.4.31 2.85.49 4.34.49 4.8 0 9.19-1.69 12.64-4.51L29.31 26.8 27.46 30z"></path>
    </symbol>
    <symbol viewBox="0 0 24 24" id="vjs-icon-hd">
      <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-chapters">
      <path d="M6 26h4v-4H6v4zm0 8h4v-4H6v4zm0-16h4v-4H6v4zm8 8h28v-4H14v4zm0 8h28v-4H14v4zm0-20v4h28v-4H14z"></path>
    </symbol>
    <symbol viewBox="0 0 40 40" id="vjs-icon-downloading">
      <path d="M18.208 36.875q-3.208-.292-5.979-1.729-2.771-1.438-4.812-3.729-2.042-2.292-3.188-5.229-1.146-2.938-1.146-6.23 0-6.583 4.334-11.416 4.333-4.834 10.833-5.5v3.166q-5.167.75-8.583 4.646Q6.25 14.75 6.25 19.958q0 5.209 3.396 9.104 3.396 3.896 8.562 4.646zM20 28.417L11.542 20l2.083-2.083 4.917 4.916v-11.25h2.916v11.25l4.875-4.916L28.417 20zm1.792 8.458v-3.167q1.833-.25 3.541-.958 1.709-.708 3.167-1.875l2.333 2.292q-1.958 1.583-4.25 2.541-2.291.959-4.791 1.167zm6.791-27.792q-1.541-1.125-3.25-1.854-1.708-.729-3.541-1.021V3.042q2.5.25 4.77 1.208 2.271.958 4.271 2.5zm4.584 21.584l-2.25-2.25q1.166-1.5 1.854-3.209.687-1.708.937-3.541h3.209q-.292 2.5-1.229 4.791-.938 2.292-2.521 4.209zm.541-12.417q-.291-1.833-.958-3.562-.667-1.73-1.833-3.188l2.375-2.208q1.541 1.916 2.458 4.208.917 2.292 1.167 4.75z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download">
      <path d="M10.8 40.55q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h26.35v-7.7h3.4v7.7q0 1.4-1 2.4t-2.4 1zM24 32.1L13.9 22.05l2.45-2.45 5.95 5.95V7.15h3.4v18.4l5.95-5.95 2.45 2.45z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-done">
      <path d="M9.8 40.5v-3.45h28.4v3.45zm9.2-9.05L7.4 19.85l2.45-2.35L19 26.65l19.2-19.2 2.4 2.4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-off">
      <path d="M4.9 4.75L43.25 43.1 41 45.3l-4.75-4.75q-.05.05-.075.025-.025-.025-.075-.025H10.8q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h22.05l-7-7-1.85 1.8L13.9 21.9l1.85-1.85L2.7 7zm26.75 14.7l2.45 2.45-3.75 3.8-2.45-2.5zM25.7 7.15V21.1l-3.4-3.45V7.15z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-share">
      <path d="M36 32.17c-1.52 0-2.89.59-3.93 1.54L17.82 25.4c.11-.45.18-.92.18-1.4s-.07-.95-.18-1.4l14.1-8.23c1.07 1 2.5 1.62 4.08 1.62 3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6c0 .48.07.95.18 1.4l-14.1 8.23c-1.07-1-2.5-1.62-4.08-1.62-3.31 0-6 2.69-6 6s2.69 6 6 6c1.58 0 3.01-.62 4.08-1.62l14.25 8.31c-.1.42-.16.86-.16 1.31A5.83 5.83 0 1 0 36 32.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cog">
      <path d="M38.86 25.95c.08-.64.14-1.29.14-1.95s-.06-1.31-.14-1.95l4.23-3.31c.38-.3.49-.84.24-1.28l-4-6.93c-.25-.43-.77-.61-1.22-.43l-4.98 2.01c-1.03-.79-2.16-1.46-3.38-1.97L29 4.84c-.09-.47-.5-.84-1-.84h-8c-.5 0-.91.37-.99.84l-.75 5.3a14.8 14.8 0 0 0-3.38 1.97L9.9 10.1a1 1 0 0 0-1.22.43l-4 6.93c-.25.43-.14.97.24 1.28l4.22 3.31C9.06 22.69 9 23.34 9 24s.06 1.31.14 1.95l-4.22 3.31c-.38.3-.49.84-.24 1.28l4 6.93c.25.43.77.61 1.22.43l4.98-2.01c1.03.79 2.16 1.46 3.38 1.97l.75 5.3c.08.47.49.84.99.84h8c.5 0 .91-.37.99-.84l.75-5.3a14.8 14.8 0 0 0 3.38-1.97l4.98 2.01a1 1 0 0 0 1.22-.43l4-6.93c.25-.43.14-.97-.24-1.28l-4.22-3.31zM24 31c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-square">
      <path d="M36 8H12c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zm0 28H12V12h24v24z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle">
      <circle cx="24" cy="24" r="20"></circle>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-outline">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-inner-circle">
      <path d="M24 4C12.97 4 4 12.97 4 24s8.97 20 20 20 20-8.97 20-20S35.03 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16zm6-16c0 3.31-2.69 6-6 6s-6-2.69-6-6 2.69-6 6-6 6 2.69 6 6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cancel">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm10 27.17L31.17 34 24 26.83 16.83 34 14 31.17 21.17 24 14 16.83 16.83 14 24 21.17 31.17 14 34 16.83 26.83 24 34 31.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-replay">
      <path d="M24 10V2L14 12l10 10v-8c6.63 0 12 5.37 12 12s-5.37 12-12 12-12-5.37-12-12H8c0 8.84 7.16 16 16 16s16-7.16 16-16-7.16-16-16-16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-repeat">
      <path d="M14 14h20v6l8-8-8-8v6H10v12h4v-8zm20 20H14v-6l-8 8 8 8v-6h24V26h-4v8z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-5">
      <path d="M17.689 98l-8.697 8.696 8.697 8.697 2.486-2.485-4.32-4.319h1.302c4.93 0 9.071 1.722 12.424 5.165 3.352 3.443 5.029 7.638 5.029 12.584h3.55c0-2.958-.553-5.73-1.658-8.313-1.104-2.583-2.622-4.841-4.555-6.774-1.932-1.932-4.19-3.45-6.773-4.555-2.584-1.104-5.355-1.657-8.313-1.657H15.5l4.615-4.615zm-8.08 21.659v13.861h11.357v5.008H9.609V143h12.7c.834 0 1.55-.298 2.146-.894.596-.597.895-1.31.895-2.145v-7.781c0-.835-.299-1.55-.895-2.147a2.929 2.929 0 0 0-2.147-.894h-8.227v-5.096H25.35v-4.384z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-10">
      <path d="M42.315 125.63c0-4.997-1.694-9.235-5.08-12.713-3.388-3.479-7.571-5.218-12.552-5.218h-1.315l4.363 4.363-2.51 2.51-8.787-8.786L25.221 97l2.45 2.45-4.662 4.663h1.375c2.988 0 5.788.557 8.397 1.673 2.61 1.116 4.892 2.65 6.844 4.602 1.953 1.953 3.487 4.234 4.602 6.844 1.116 2.61 1.674 5.41 1.674 8.398zM8.183 142v-19.657H3.176V117.8h9.643V142zm13.63 0c-1.156 0-2.127-.393-2.912-1.178-.778-.778-1.168-1.746-1.168-2.902v-16.04c0-1.156.393-2.127 1.178-2.912.779-.779 1.746-1.168 2.902-1.168h7.696c1.156 0 2.126.392 2.911 1.177.779.78 1.168 1.747 1.168 2.903v16.04c0 1.156-.392 2.127-1.177 2.912-.779.779-1.746 1.168-2.902 1.168zm.556-4.636h6.583v-15.02H22.37z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-30">
      <path d="M26.047 97l-8.733 8.732 8.733 8.733 2.496-2.494-4.336-4.338h1.307c4.95 0 9.108 1.73 12.474 5.187 3.367 3.458 5.051 7.668 5.051 12.635h3.565c0-2.97-.556-5.751-1.665-8.346-1.109-2.594-2.633-4.862-4.574-6.802-1.94-1.941-4.208-3.466-6.803-4.575-2.594-1.109-5.375-1.664-8.345-1.664H23.85l4.634-4.634zM2.555 117.531v4.688h10.297v5.25H5.873v4.687h6.979v5.156H2.555V142H13.36c1.061 0 1.95-.395 2.668-1.186.718-.79 1.076-1.772 1.076-2.94v-16.218c0-1.168-.358-2.149-1.076-2.94-.717-.79-1.607-1.185-2.668-1.185zm22.482.14c-1.149 0-2.11.39-2.885 1.165-.78.78-1.172 1.744-1.172 2.893v15.943c0 1.149.388 2.11 1.163 2.885.78.78 1.745 1.172 2.894 1.172h7.649c1.148 0 2.11-.388 2.884-1.163.78-.78 1.17-1.745 1.17-2.894v-15.943c0-1.15-.386-2.111-1.16-2.885-.78-.78-1.746-1.172-2.894-1.172zm.553 4.518h6.545v14.93H25.59z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-5">
      <path d="M29.508 97l-2.431 2.43 4.625 4.625h-1.364c-2.965 0-5.742.554-8.332 1.66-2.589 1.107-4.851 2.629-6.788 4.566-1.937 1.937-3.458 4.2-4.565 6.788-1.107 2.59-1.66 5.367-1.66 8.331h3.557c0-4.957 1.68-9.16 5.04-12.611 3.36-3.45 7.51-5.177 12.451-5.177h1.304l-4.326 4.33 2.49 2.49 8.715-8.716zm-9.783 21.61v13.89h11.382v5.018H19.725V142h12.727a2.93 2.93 0 0 0 2.15-.896 2.93 2.93 0 0 0 .896-2.15v-7.798c0-.837-.299-1.554-.896-2.152a2.93 2.93 0 0 0-2.15-.896h-8.245V123h11.29v-4.392z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-10">
      <path d="M23.119 97l-2.386 2.383 4.538 4.538h-1.339c-2.908 0-5.633.543-8.173 1.63-2.54 1.085-4.76 2.577-6.66 4.478-1.9 1.9-3.392 4.12-4.478 6.66-1.085 2.54-1.629 5.264-1.629 8.172h3.49c0-4.863 1.648-8.986 4.944-12.372 3.297-3.385 7.368-5.078 12.216-5.078h1.279l-4.245 4.247 2.443 2.442 8.55-8.55zm-9.52 21.45v4.42h4.871V142h4.513v-23.55zm18.136 0c-1.125 0-2.066.377-2.824 1.135-.764.764-1.148 1.709-1.148 2.834v15.612c0 1.124.38 2.066 1.139 2.824.764.764 1.708 1.145 2.833 1.145h7.489c1.125 0 2.066-.378 2.824-1.136.764-.764 1.145-1.709 1.145-2.833v-15.612c0-1.125-.378-2.067-1.136-2.825-.764-.764-1.708-1.145-2.833-1.145zm.54 4.42h6.408v14.617h-6.407z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-30">
      <path d="M25.549 97l-2.437 2.434 4.634 4.635H26.38c-2.97 0-5.753.555-8.347 1.664-2.594 1.109-4.861 2.633-6.802 4.574-1.94 1.94-3.465 4.207-4.574 6.802-1.109 2.594-1.664 5.377-1.664 8.347h3.565c0-4.967 1.683-9.178 5.05-12.636 3.366-3.458 7.525-5.187 12.475-5.187h1.307l-4.335 4.338 2.495 2.494 8.732-8.732zm-11.553 20.53v4.689h10.297v5.249h-6.978v4.688h6.978v5.156H13.996V142h10.808c1.06 0 1.948-.395 2.666-1.186.718-.79 1.077-1.771 1.077-2.94v-16.217c0-1.169-.36-2.15-1.077-2.94-.718-.79-1.605-1.186-2.666-1.186zm21.174.168c-1.149 0-2.11.389-2.884 1.163-.78.78-1.172 1.745-1.172 2.894v15.942c0 1.15.388 2.11 1.162 2.885.78.78 1.745 1.17 2.894 1.17h7.649c1.149 0 2.11-.386 2.885-1.16.78-.78 1.17-1.746 1.17-2.895v-15.942c0-1.15-.387-2.11-1.161-2.885-.78-.78-1.745-1.172-2.894-1.172zm.552 4.516h6.542v14.931h-6.542z"></path>
    </symbol>
    <symbol viewBox="0 0 512 512" id="vjs-icon-audio-description">
      <g fill-rule="evenodd"><path d="M227.29 381.351V162.993c50.38-1.017 89.108-3.028 117.631 17.126 27.374 19.342 48.734 56.965 44.89 105.325-4.067 51.155-41.335 94.139-89.776 98.475-24.085 2.155-71.972 0-71.972 0s-.84-1.352-.773-2.568m48.755-54.804c31.43 1.26 53.208-16.633 56.495-45.386 4.403-38.51-21.188-63.552-58.041-60.796v103.612c-.036 1.466.575 2.22 1.546 2.57"></path><path d="M383.78 381.328c13.336 3.71 17.387-11.06 23.215-21.408 12.722-22.571 22.294-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.226 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M425.154 381.328c13.336 3.71 17.384-11.061 23.215-21.408 12.721-22.571 22.291-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.511c-.586 3.874 2.226 7.315 3.866 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M466.26 381.328c13.337 3.71 17.385-11.061 23.216-21.408 12.722-22.571 22.292-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.225 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894M4.477 383.005H72.58l18.573-28.484 64.169-.135s.065 19.413.065 28.62h48.756V160.307h-58.816c-5.653 9.537-140.85 222.697-140.85 222.697zm152.667-145.282v71.158l-40.453-.27 40.453-70.888z"></path></g>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-next-item">
      <path d="M12 36l17-12-17-12v24zm20-24v24h4V12h-4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-previous-item">
      <path d="M12 12h4v24h-4zm7 12l17 12V12z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-shuffle">
      <path d="M21.17 18.34L10.83 8 8 10.83l10.34 10.34 2.83-2.83zM29 8l4.09 4.09L8 37.17 10.83 40l25.09-25.09L40 19V8H29zm.66 18.83l-2.83 2.83 6.26 6.26L29 40h11V29l-4.09 4.09-6.25-6.26z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cast">
      <path d="M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-picture-in-picture-enter">
      <path d="M38 22H22v11.99h16V22zm8 16V9.96C46 7.76 44.2 6 42 6H6C3.8 6 2 7.76 2 9.96V38c0 2.2 1.8 4 4 4h36c2.2 0 4-1.8 4-4zm-4 .04H6V9.94h36v28.1z"></path>
    </symbol>
    <symbol viewBox="0 0 22 18" id="vjs-icon-picture-in-picture-exit">
      <path d="M18 4H4v10h14V4zm4 12V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H2V1.97h18v14.05z"></path>
      <path fill="none" d="M-1-3h24v24H-1z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-facebook">
      <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-linkedin">
      <path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"></path>
    </symbol>
    <symbol viewBox="0 0 1200 1227" id="vjs-icon-twitter">
      <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"/>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-tumblr">
      <path d="M1328 1329l80 237q-23 35-111 66t-177 32q-104 2-190.5-26T787 1564t-95-106-55.5-120-16.5-118V676H452V461q72-26 129-69.5t91-90 58-102 34-99T779 12q1-5 4.5-8.5T791 0h244v424h333v252h-334v518q0 30 6.5 56t22.5 52.5 49.5 41.5 81.5 14q78-2 134-29z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-pinterest">
      <path d="M1664 896q0 209-103 385.5T1281.5 1561 896 1664q-111 0-218-32 59-93 78-164 9-34 54-211 20 39 73 67.5t114 28.5q121 0 216-68.5t147-188.5 52-270q0-114-59.5-214T1180 449t-255-63q-105 0-196 29t-154.5 77-109 110.5-67 129.5T377 866q0 104 40 183t117 111q30 12 38-20 2-7 8-31t8-30q6-23-11-43-51-61-51-151 0-151 104.5-259.5T904 517q151 0 235.5 82t84.5 213q0 170-68.5 289T980 1220q-61 0-98-43.5T859 1072q8-35 26.5-93.5t30-103T927 800q0-50-27-83t-77-33q-62 0-105 57t-43 142q0 73 25 122l-99 418q-17 70-13 177-206-91-333-281T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z"></path>
    </symbol>
  </defs>
</svg>`;const CI=ux?10009:cx?461:8,Hg={codes:{play:415,pause:19,ff:417,rw:412,back:CI},names:{415:"play",19:"pause",417:"ff",412:"rw",[CI]:"back"},isEventKey(r,e){return e=e.toLowerCase(),!!(this.names[r.keyCode]&&this.names[r.keyCode]===e)},getEventName(r){if(this.names[r.keyCode])return this.names[r.keyCode];if(this.codes[r.code]){const e=this.codes[r.code];return this.names[e]}return null}},MI=5;class iV extends qu{constructor(e){super(),this.player_=e,this.focusableComponents=[],this.isListening_=!1,this.isPaused_=!1,this.onKeyDown_=this.onKeyDown_.bind(this),this.lastFocusedComponent_=null}start(){this.isListening_||(this.player_.on("keydown",this.onKeyDown_),this.player_.on("modalKeydown",this.onKeyDown_),this.player_.on("loadedmetadata",()=>{this.focus(this.updateFocusableComponents()[0])}),this.player_.on("modalclose",()=>{this.refocusComponent()}),this.player_.on("focusin",this.handlePlayerFocus_.bind(this)),this.player_.on("focusout",this.handlePlayerBlur_.bind(this)),this.isListening_=!0,this.player_.errorDisplay&&this.player_.errorDisplay.on("aftermodalfill",()=>{this.updateFocusableComponents(),this.focusableComponents.length&&(this.focusableComponents.length>1?this.focusableComponents[1].focus():this.focusableComponents[0].focus())}))}stop(){this.player_.off("keydown",this.onKeyDown_),this.isListening_=!1}onKeyDown_(e){const t=e.originalEvent?e.originalEvent:e;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)){if(this.isPaused_)return;t.preventDefault();const i=t.key.substring(5).toLowerCase();this.move(i)}else if(Hg.isEventKey(t,"play")||Hg.isEventKey(t,"pause")||Hg.isEventKey(t,"ff")||Hg.isEventKey(t,"rw")){t.preventDefault();const i=Hg.getEventName(t);this.performMediaAction_(i)}else Hg.isEventKey(t,"Back")&&e.target&&typeof e.target.closeable=="function"&&e.target.closeable()&&(t.preventDefault(),e.target.close())}performMediaAction_(e){if(this.player_)switch(e){case"play":this.player_.paused()&&this.player_.play();break;case"pause":this.player_.paused()||this.player_.pause();break;case"ff":this.userSeek_(this.player_.currentTime()+MI);break;case"rw":this.userSeek_(this.player_.currentTime()-MI);break}}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}pause(){this.isPaused_=!0}resume(){this.isPaused_=!1}handlePlayerBlur_(e){const t=e.relatedTarget;let i=null;const n=this.getCurrentComponent(e.target);t&&(i=!!t.closest(".video-js"),t.classList.contains("vjs-text-track-settings")&&!this.isPaused_&&this.searchForTrackSelect_()),(!e.currentTarget.contains(e.relatedTarget)&&!i||!t)&&(n&&n.name()==="CloseButton"?this.refocusComponent():(this.pause(),n&&n.el()&&(this.lastFocusedComponent_=n)))}handlePlayerFocus_(){this.getCurrentComponent()&&this.getCurrentComponent().getIsFocusable()&&this.resume()}updateFocusableComponents(){const e=this.player_,t=[];function i(n){for(const s of n)s.hasOwnProperty("el_")&&s.getIsFocusable()&&s.getIsAvailableToBeFocused(s.el())&&t.push(s),s.hasOwnProperty("children_")&&s.children_.length>0&&i(s.children_)}return e.children_.forEach(n=>{if(n.hasOwnProperty("el_"))if(n.getIsFocusable&&n.getIsAvailableToBeFocused&&n.getIsFocusable()&&n.getIsAvailableToBeFocused(n.el())){t.push(n);return}else n.hasOwnProperty("children_")&&n.children_.length>0?i(n.children_):n.hasOwnProperty("items")&&n.items.length>0?i(n.items):this.findSuitableDOMChild(n)&&t.push(n);if(n.name_==="ErrorDisplay"&&n.opened_){const s=n.el_.querySelector(".vjs-errors-ok-button-container");s&&s.querySelectorAll("button").forEach((c,h)=>{t.push({name:()=>"ModalButton"+(h+1),el:()=>c,getPositions:()=>{const m=c.getBoundingClientRect(),v={x:m.x,y:m.y,width:m.width,height:m.height,top:m.top,right:m.right,bottom:m.bottom,left:m.left},b={x:m.left+m.width/2,y:m.top+m.height/2,width:0,height:0,top:m.top+m.height/2,right:m.left+m.width/2,bottom:m.top+m.height/2,left:m.left+m.width/2};return{boundingClientRect:v,center:b}},getIsAvailableToBeFocused:()=>!0,getIsFocusable:m=>!0,focus:()=>c.focus()})})}}),this.focusableComponents=t,this.focusableComponents}findSuitableDOMChild(e){function t(i){if(e.getIsFocusable(i)&&e.getIsAvailableToBeFocused(i))return i;for(let n=0;n<i.children.length;n++){const s=i.children[n],a=t(s);if(a)return a}return null}return e.el()?t(e.el()):null}getCurrentComponent(e){this.updateFocusableComponents();const t=e||document.activeElement;if(this.focusableComponents.length){for(const i of this.focusableComponents)if(i.el()===t)return i}}add(e){const t=[...this.focusableComponents];e.hasOwnProperty("el_")&&e.getIsFocusable()&&e.getIsAvailableToBeFocused(e.el())&&t.push(e),this.focusableComponents=t,this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents})}remove(e){for(let t=0;t<this.focusableComponents.length;t++)if(this.focusableComponents[t].name()===e.name()){this.focusableComponents.splice(t,1),this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents});return}}clear(){this.focusableComponents.length>0&&(this.focusableComponents=[],this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents}))}move(e){const t=this.getCurrentComponent();if(!t)return;const i=t.getPositions(),n=this.focusableComponents.filter(a=>a!==t&&this.isInDirection_(i.boundingClientRect,a.getPositions().boundingClientRect,e)),s=this.findBestCandidate_(i.center,n,e);s?this.focus(s):this.trigger({type:"endOfFocusableComponents",direction:e,focusedComponent:t})}findBestCandidate_(e,t,i){let n=1/0,s=null;for(const a of t){const c=a.getPositions().center,h=this.calculateDistance_(e,c,i);h<n&&(n=h,s=a)}return s}isInDirection_(e,t,i){switch(i){case"right":return t.left>=e.right;case"left":return t.right<=e.left;case"down":return t.top>=e.bottom;case"up":return t.bottom<=e.top;default:return!1}}refocusComponent(){if(this.lastFocusedComponent_){this.player_.userActive()||this.player_.userActive(!0),this.updateFocusableComponents();for(let e=0;e<this.focusableComponents.length;e++)if(this.focusableComponents[e].name()===this.lastFocusedComponent_.name()){this.focus(this.focusableComponents[e]);return}}else this.focus(this.updateFocusableComponents()[0])}focus(e){typeof e=="object"&&(e.getIsAvailableToBeFocused(e.el())?e.focus():this.findSuitableDOMChild(e)&&this.findSuitableDOMChild(e).focus())}calculateDistance_(e,t,i){const n=Math.abs(e.x-t.x),s=Math.abs(e.y-t.y);let a;switch(i){case"right":case"left":a=n+s*100;break;case"up":a=s*2+n*.5;break;case"down":a=s*5+n;break;default:a=n+s}return a}searchForTrackSelect_(){const e=this;for(const t of e.updateFocusableComponents())if(t.constructor.name==="TextTrackSelect"){e.focus(t);break}}}let nV=class extends Vt{constructor(e,t,i){const n=Yr({createEl:!1},t);if(super(e,n,i),!t.playerOptions.sources||t.playerOptions.sources.length===0)for(let s=0,a=t.playerOptions.techOrder;s<a.length;s++){const c=Zs(a[s]);let h=ts.getTech(c);if(c||(h=Vt.getComponent(c)),h&&h.isSupported()){e.loadTech_(c);break}}else e.src(t.playerOptions.sources)}};Vt.registerComponent("MediaLoader",nV);let cS=class extends Vt{constructor(e,t){super(e,t),this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=i=>this.handleMouseOver(i),this.handleMouseOut_=i=>this.handleMouseOut(i),this.handleClick_=i=>this.handleClick(i),this.handleKeyDown_=i=>this.handleKeyDown(i),this.emitTapEvents(),this.enable()}createEl(e="div",t={},i={}){t=Object.assign({className:this.buildCSSClass(),tabIndex:0},t),e==="button"&&Zn.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),i=Object.assign({role:"button"},i),this.tabIndex_=t.tabIndex;const n=cn(e,t,i);return this.player_.options_.experimentalSvgIcons||n.appendChild(cn("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(n),n}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=cn("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e,t=this.el()){if(e===void 0)return this.controlText_||"Need Text";const i=this.localize(e);this.controlText_=e,Up(this.controlTextEl_,i),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&t.setAttribute("title",i)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){e.key===" "||e.key==="Enter"?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}};Vt.registerComponent("ClickableComponent",cS);let yE=class extends cS{constructor(e,t){super(e,t),this.update(),this.update_=i=>this.update(i),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return cn("div",{className:"vjs-poster"})}crossOrigin(e){if(typeof e>"u")return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.$("img")&&(this.$("img").crossOrigin=e)}update(e){const t=this.player().poster();this.setSrc(t),t?this.show():this.hide()}setSrc(e){if(!e){this.el_.textContent="";return}this.$("img")||this.el_.appendChild(cn("picture",{className:"vjs-poster",tabIndex:-1},{},cn("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=e}handleClick(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?uh(this.player_.play()):this.player_.pause())}};yE.prototype.crossorigin=yE.prototype.crossOrigin;Vt.registerComponent("PosterImage",yE);const dc="#222",DI="#ccc",rV={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function sw(r,e){let t;if(r.length===4)t=r[1]+r[1]+r[2]+r[2]+r[3]+r[3];else if(r.length===7)t=r.slice(1);else throw new Error("Invalid color code provided, "+r+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(t.slice(0,2),16)+","+parseInt(t.slice(2,4),16)+","+parseInt(t.slice(4,6),16)+","+e+")"}function Wd(r,e,t){try{r.style[e]=t}catch{return}}function II(r){return r?`${r}px`:""}let sV=class extends Vt{constructor(e,t,i){super(e,t,i);const n=a=>this.updateDisplay(a),s=a=>{this.updateDisplayOverlay(),this.updateDisplay(a)};e.on("loadstart",a=>this.toggleDisplay(a)),e.on("useractive",n),e.on("userinactive",n),e.on("texttrackchange",n),e.on("loadedmetadata",a=>{this.updateDisplayOverlay(),this.preselectTrack(a)}),e.ready(us(this,function(){if(e.tech_&&e.tech_.featuresNativeTextTracks){this.hide();return}e.on("fullscreenchange",s),e.on("playerresize",s);const a=Z.screen.orientation||Z,c=Z.screen.orientation?"change":"orientationchange";a.addEventListener(c,s),e.on("dispose",()=>a.removeEventListener(c,s));const h=this.options_.playerOptions.tracks||[];for(let m=0;m<h.length;m++)this.player_.addRemoteTextTrack(h[m],!0);this.preselectTrack()}))}preselectTrack(){const e={captions:1,subtitles:1},t=this.player_.textTracks(),i=this.player_.cache_.selectedLanguage;let n,s,a;for(let c=0;c<t.length;c++){const h=t[c];i&&i.enabled&&i.language&&i.language===h.language&&h.kind in e?h.kind===i.kind?a=h:a||(a=h):i&&!i.enabled?(a=null,n=null,s=null):h.default&&(h.kind==="descriptions"&&!n?n=h:h.kind in e&&!s&&(s=h))}a?a.mode="showing":s?s.mode="showing":n&&(n.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof Z.WebVTT=="function"&&Z.WebVTT.processCues(Z,[],this.el_)}updateDisplay(){const e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){const a=[];for(let c=0;c<e.length;++c){const h=e[c];h.mode==="showing"&&a.push(h)}this.updateForTrack(a);return}let i=null,n=null,s=e.length;for(;s--;){const a=e[s];a.mode==="showing"&&(a.kind==="descriptions"?i=a:n=a)}if(n?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(n)):i&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(i)),!Z.CSS.supports("inset","10px")){const a=this.el_,c=a.querySelectorAll(".vjs-text-track-cue"),h=this.player_.controlBar.el_.getBoundingClientRect().height,m=this.player_.el_.getBoundingClientRect().height;a.style="",Wd(a,"position","relative"),Wd(a,"height",m-h+"px"),Wd(a,"top","unset"),dx?Wd(a,"bottom",m+"px"):Wd(a,"bottom","0px"),c.length>0&&c.forEach(v=>{if(v.style.inset){const b=v.style.inset.split(" ");b.length===3&&Object.assign(v.style,{top:b[0],right:b[1],bottom:b[2],left:"unset"})}})}}updateDisplayOverlay(){if(!this.player_.videoHeight()||!Z.CSS.supports("inset-inline: 10px"))return;const e=this.player_.currentWidth(),t=this.player_.currentHeight(),i=e/t,n=this.player_.videoWidth()/this.player_.videoHeight();let s=0,a=0;Math.abs(i-n)>.1&&(i>n?s=Math.round((e-t*n)/2):a=Math.round((t-e/n)/2)),Wd(this.el_,"insetInline",II(s)),Wd(this.el_,"insetBlock",II(a))}updateDisplayState(e){const t=this.player_.textTrackSettings.getValues(),i=e.activeCues;let n=i.length;for(;n--;){const s=i[n];if(!s)continue;const a=s.displayState;if(t.color&&(a.firstChild.style.color=t.color),t.textOpacity&&Wd(a.firstChild,"color",sw(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(a.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&Wd(a.firstChild,"backgroundColor",sw(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?Wd(a,"backgroundColor",sw(t.windowColor,t.windowOpacity)):a.style.backgroundColor=t.windowColor),t.edgeStyle&&(t.edgeStyle==="dropshadow"?a.firstChild.style.textShadow=`2px 2px 3px ${dc}, 2px 2px 4px ${dc}, 2px 2px 5px ${dc}`:t.edgeStyle==="raised"?a.firstChild.style.textShadow=`1px 1px ${dc}, 2px 2px ${dc}, 3px 3px ${dc}`:t.edgeStyle==="depressed"?a.firstChild.style.textShadow=`1px 1px ${DI}, 0 1px ${DI}, -1px -1px ${dc}, 0 -1px ${dc}`:t.edgeStyle==="uniform"&&(a.firstChild.style.textShadow=`0 0 4px ${dc}, 0 0 4px ${dc}, 0 0 4px ${dc}, 0 0 4px ${dc}`)),t.fontPercent&&t.fontPercent!==1){const c=Z.parseFloat(a.style.fontSize);a.style.fontSize=c*t.fontPercent+"px",a.style.height="auto",a.style.top="auto"}t.fontFamily&&t.fontFamily!=="default"&&(t.fontFamily==="small-caps"?a.firstChild.style.fontVariant="small-caps":a.firstChild.style.fontFamily=rV[t.fontFamily])}}updateForTrack(e){if(Array.isArray(e)||(e=[e]),typeof Z.WebVTT!="function"||e.every(i=>!i.activeCues))return;const t=[];for(let i=0;i<e.length;++i){const n=e[i];for(let s=0;s<n.activeCues.length;++s)t.push(n.activeCues[s])}Z.WebVTT.processCues(Z,t,this.el_);for(let i=0;i<e.length;++i){const n=e[i];for(let s=0;s<n.activeCues.length;++s){const a=n.activeCues[s].displayState;Hm(a,"vjs-text-track-cue","vjs-text-track-cue-"+(n.language?n.language:i)),n.language&&N0(a,"lang",n.language)}this.player_.textTrackSettings&&this.updateDisplayState(n)}}};Vt.registerComponent("TextTrackDisplay",sV);let aV=class extends Vt{createEl(){const e=this.player_.isAudio(),t=this.localize(e?"Audio Player":"Video Player"),i=cn("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[t])}),n=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return n.appendChild(i),n}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}};Vt.registerComponent("LoadingSpinner",aV);let No=class extends cS{createEl(e,t={},i={}){e="button",t=Object.assign({className:this.buildCSSClass()},t),i=Object.assign({type:"button"},i);const n=cn(e,t,i);return this.player_.options_.experimentalSvgIcons||n.appendChild(cn("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(n),n}addChild(e,t={}){const i=this.constructor.name;return Zn.warn(`Adding an actionable (user controllable) child to a Button (${i}) is not supported; use a ClickableComponent instead.`),Vt.prototype.addChild.call(this,e,t)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){if(e.key===" "||e.key==="Enter"){e.stopPropagation();return}super.handleKeyDown(e)}};Vt.registerComponent("Button",No);let zk=class extends No{constructor(e,t){super(e,t),this.mouseused_=!1,this.setIcon("play"),this.on("mousedown",i=>this.handleMouseDown(i))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){const t=this.player_.play();if(e.type==="tap"||this.mouseused_&&"clientX"in e&&"clientY"in e){uh(t),this.player_.tech(!0)&&this.player_.tech(!0).focus();return}const i=this.player_.getChild("controlBar"),n=i&&i.getChild("playToggle");if(!n){this.player_.tech(!0).focus();return}const s=()=>n.focus();h_(t)?t.then(s,()=>{}):this.setTimeout(s,1)}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}};zk.prototype.controlText_="Play Video";Vt.registerComponent("BigPlayButton",zk);let oV=class extends No{constructor(e,t){super(e,t),this.setIcon("cancel"),this.controlText(t&&t.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){e.key==="Escape"?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}};Vt.registerComponent("CloseButton",oV);let Hk=class extends No{constructor(e,t={}){super(e,t),t.replay=t.replay===void 0||t.replay,this.setIcon("play"),this.on(e,"play",i=>this.handlePlay(i)),this.on(e,"pause",i=>this.handlePause(i)),t.replay&&this.on(e,"ended",i=>this.handleEnded(i))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(e){this.player_.paused()?uh(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.setIcon("pause"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.setIcon("play"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.setIcon("replay"),this.controlText("Replay"),this.one(this.player_,"seeked",t=>this.handleSeeked(t))}};Hk.prototype.controlText_="Play";Vt.registerComponent("PlayToggle",Hk);let sv=class extends Vt{constructor(e,t){super(e,t),this.on(e,["timeupdate","ended","seeking"],i=>this.update(i)),this.updateTextNode_()}createEl(){const e=this.buildCSSClass(),t=super.createEl("div",{className:`${e} vjs-time-control vjs-control`}),i=cn("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)}`},{role:"presentation"});return t.appendChild(i),this.contentEl_=cn("span",{className:`${e}-display`},{role:"presentation"}),t.appendChild(this.contentEl_),t}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}update(e){!this.player_.options_.enableSmoothSeeking&&e.type==="seeking"||this.updateContent(e)}updateTextNode_(e=0){e=Km(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(!this.contentEl_)return;let t=this.textNode_;t&&this.contentEl_.firstChild!==t&&(t=null,Zn.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=ot.createTextNode(this.formattedTime_),this.textNode_&&(t?this.contentEl_.replaceChild(this.textNode_,t):this.contentEl_.appendChild(this.textNode_))}))}updateContent(e){}};sv.prototype.labelText_="Time";sv.prototype.controlText_="Time";Vt.registerComponent("TimeDisplay",sv);let eC=class extends sv{buildCSSClass(){return"vjs-current-time"}updateContent(e){let t;this.player_.ended()?t=this.player_.duration():e&&e.target&&typeof e.target.pendingSeekTime=="function"?t=e.target.pendingSeekTime():t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)}};eC.prototype.labelText_="Current Time";eC.prototype.controlText_="Current Time";Vt.registerComponent("CurrentTimeDisplay",eC);let tC=class extends sv{constructor(e,t){super(e,t);const i=n=>this.updateContent(n);this.on(e,"durationchange",i),this.on(e,"loadstart",i),this.on(e,"loadedmetadata",i)}buildCSSClass(){return"vjs-duration"}updateContent(e){const t=this.player_.duration();this.updateTextNode_(t)}};tC.prototype.labelText_="Duration";tC.prototype.controlText_="Duration";Vt.registerComponent("DurationDisplay",tC);let lV=class extends Vt{createEl(){const e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),t=super.createEl("div"),i=super.createEl("span",{textContent:"/"});return t.appendChild(i),e.appendChild(t),e}};Vt.registerComponent("TimeDivider",lV);let iC=class extends sv{constructor(e,t){super(e,t),this.on(e,"durationchange",i=>this.updateContent(i))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const e=super.createEl();return this.options_.displayNegative!==!1&&e.insertBefore(cn("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){if(typeof this.player_.duration()!="number")return;let t;this.player_.ended()?t=0:this.player_.remainingTimeDisplay?t=this.player_.remainingTimeDisplay():t=this.player_.remainingTime(),this.updateTextNode_(t)}};iC.prototype.labelText_="Remaining Time";iC.prototype.controlText_="Remaining Time";Vt.registerComponent("RemainingTimeDisplay",iC);let uV=class extends Vt{constructor(e,t){super(e,t),this.updateShowing(),this.on(this.player(),"durationchange",i=>this.updateShowing(i))}createEl(){const e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=cn("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(cn("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")}`})),this.contentEl_.appendChild(ot.createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===1/0?this.show():this.hide()}};Vt.registerComponent("LiveDisplay",uV);let jk=class extends No{constructor(e,t){super(e,t),this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=i=>this.updateLiveEdgeStatus(i),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.setIcon("circle",e),this.textEl_=cn("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}};jk.prototype.controlText_="Seek to live, currently playing live";Vt.registerComponent("SeekToLive",jk);function W_(r,e,t){return r=Number(r),Math.min(t,Math.max(e,isNaN(r)?e:r))}var cV=Object.freeze({__proto__:null,clamp:W_});let nC=class extends Vt{constructor(e,t){super(e,t),this.handleMouseDown_=i=>this.handleMouseDown(i),this.handleMouseUp_=i=>this.handleMouseUp(i),this.handleKeyDown_=i=>this.handleKeyDown(i),this.handleClick_=i=>this.handleClick(i),this.handleMouseMove_=i=>this.handleMouseMove(i),this.update_=i=>this.update(i),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(e,t={},i={}){return t.className=t.className+" vjs-slider",t=Object.assign({tabIndex:0},t),i=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},i),super.createEl(e,t,i)}handleMouseDown(e){const t=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type==="touchstart"&&!bh&&e.preventDefault(),pk(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove_),this.on(t,"mouseup",this.handleMouseUp_),this.on(t,"touchmove",this.handleMouseMove_),this.on(t,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(e){const t=this.bar.el_.ownerDocument;mk(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(t,"mousemove",this.handleMouseMove_),this.off(t,"mouseup",this.handleMouseUp_),this.off(t,"touchmove",this.handleMouseMove_),this.off(t,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const e=this.getProgress();return e===this.progress_||(this.progress_=e,this.requestNamedAnimationFrame("Slider#update",()=>{const t=this.vertical()?"height":"width";this.bar.el().style[t]=(e*100).toFixed(2)+"%"})),e}getProgress(){return Number(W_(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){const t=rS(this.el_,e);return this.vertical()?t.y:t.x}handleKeyDown(e){const t=this.options_.playerOptions.spatialNavigation,i=t&&t.enabled,n=t&&t.horizontalSeek;i?n&&e.key==="ArrowLeft"||!n&&e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepBack()):n&&e.key==="ArrowRight"||!n&&e.key==="ArrowUp"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(this.pendingSeekTime()&&(this.pendingSeekTime(null),this.userSeek_(this.player_.currentTime())),super.handleKeyDown(e)):e.key==="ArrowLeft"||e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepBack()):e.key==="ArrowUp"||e.key==="ArrowRight"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}};Vt.registerComponent("Slider",nC);const aw=(r,e)=>W_(r/e*100,0,100).toFixed(2)+"%";let dV=class extends Vt{constructor(e,t){super(e,t),this.partEls_=[],this.on(e,"progress",i=>this.update(i))}createEl(){const e=super.createEl("div",{className:"vjs-load-progress"}),t=cn("span",{className:"vjs-control-text"}),i=cn("span",{textContent:this.localize("Loaded")}),n=ot.createTextNode(": ");return this.percentageEl_=cn("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(t),t.appendChild(i),t.appendChild(n),t.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{const t=this.player_.liveTracker,i=this.player_.buffered(),n=t&&t.isLive()?t.seekableEnd():this.player_.duration(),s=this.player_.bufferedEnd(),a=this.partEls_,c=aw(s,n);this.percent_!==c&&(this.el_.style.width=c,Up(this.percentageEl_,c),this.percent_=c);for(let h=0;h<i.length;h++){const m=i.start(h),v=i.end(h);let b=a[h];b||(b=this.el_.appendChild(cn()),a[h]=b),!(b.dataset.start===m&&b.dataset.end===v)&&(b.dataset.start=m,b.dataset.end=v,b.style.left=aw(m,s),b.style.width=aw(v-m,s))}for(let h=a.length;h>i.length;h--)this.el_.removeChild(a[h-1]);a.length=i.length})}};Vt.registerComponent("LoadProgressBar",dV);let hV=class extends Vt{constructor(e,t){super(e,t),this.update=Th(us(this,this.update),bc)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(e,t,i){const n=C_(this.el_),s=U0(this.player_.el()),a=e.width*t;if(!s||!n)return;let c=e.left-s.left+a,h=e.width-a+(s.right-e.right);h||(h=e.width-a,c=a);let m=n.width/2;c<m?m+=m-c:h<m&&(m=h),m<0?m=0:m>n.width&&(m=n.width),m=Math.round(m),this.el_.style.right=`-${m}px`,this.write(i)}write(e){Up(this.el_,e)}updateTime(e,t,i,n){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let s;const a=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const c=this.player_.liveTracker.liveWindow(),h=c-t*c;s=(h<1?"":"-")+Km(h,c)}else s=Km(i,a);this.update(e,t,s),n&&n()})}};Vt.registerComponent("TimeTooltip",hV);let rC=class extends Vt{constructor(e,t){super(e,t),this.setIcon("circle"),this.update=Th(us(this,this.update),bc)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,t,i){const n=this.getChild("timeTooltip");if(!n)return;const s=i&&i.target&&typeof i.target.pendingSeekTime=="function"?i.target.pendingSeekTime():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();n.updateTime(e,t,s)}};rC.prototype.options_={children:[]};!Fo&&!Kc&&rC.prototype.options_.children.push("timeTooltip");Vt.registerComponent("PlayProgressBar",rC);let Gk=class extends Vt{constructor(e,t){super(e,t),this.update=Th(us(this,this.update),bc)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t){const i=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,i,()=>{this.el_.style.left=`${e.width*t}px`})}};Gk.prototype.options_={children:["timeTooltip"]};Vt.registerComponent("MouseTimeDisplay",Gk);let $k=class Wk extends nC{constructor(e,t){t=Yr(Wk.prototype.options_,t),t.children=[...t.children];const i=e.options_.disableSeekWhileScrubbingOnMobile&&(Fo||Kc)||e.options_.disableSeekWhileScrubbingOnSTV;(!Fo&&!Kc||i)&&t.children.splice(1,0,"mouseTimeDisplay"),super(e,t),this.shouldDisableSeekWhileScrubbing_=i,this.pendingSeekTime_=null,this.setEventHandlers_()}setEventHandlers_(){this.update_=us(this,this.update),this.update=Th(this.update_,bc),this.on(this.player_,["durationchange","timeupdate"],this.update),this.on(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in ot&&"visibilityState"in ot&&this.on(ot,"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){ot.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,bc))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&e.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if(ot.visibilityState==="hidden")return;const t=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{const i=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),n=this.player_.liveTracker;let s=this.player_.duration();n&&n.isLive()&&(s=this.player_.liveTracker.liveCurrentTime()),this.percent_!==t&&(this.el_.setAttribute("aria-valuenow",(t*100).toFixed(2)),this.percent_=t),(this.currentTime_!==i||this.duration_!==s)&&(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[Km(i,s),Km(s,s)],"{1} of {2}")),this.currentTime_=i,this.duration_=s),this.bar&&this.bar.update(U0(this.el()),this.getProgress(),e)}),t}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}pendingSeekTime(e){if(e!==void 0)if(e!==null){const t=this.player_.duration();this.pendingSeekTime_=Math.max(0,Math.min(e,t))}else this.pendingSeekTime_=null;return this.pendingSeekTime_}getPercent(){if(this.pendingSeekTime()!==null)return this.pendingSeekTime()/this.player_.duration();const e=this.getCurrentTime_();let t;const i=this.player_.liveTracker;return i&&i.isLive()?(t=(e-i.seekableStart())/i.liveWindow(),i.atLiveEdge()&&(t=1)):t=e/this.player_.duration(),t}handleMouseDown(e){M_(e)&&(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.shouldDisableSeekWhileScrubbing_||this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(e,t=!1){if(!M_(e)||isNaN(this.player_.duration()))return;!t&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);let i;const n=this.calculateDistance(e),s=this.player_.liveTracker;if(!s||!s.isLive())i=n*this.player_.duration(),i===this.player_.duration()&&(i=i-.1);else{if(n>=.99){s.seekToLiveEdge();return}const a=s.seekableStart(),c=s.liveCurrentTime();if(i=a+n*s.liveWindow(),i>=c&&(i=c),i<=a&&(i=a+.1),i===1/0)return}this.shouldDisableSeekWhileScrubbing_?this.pendingSeekTime(i):this.userSeek_(i),this.player_.options_.enableSmoothSeeking&&this.update()}enable(){super.enable();const e=this.getChild("mouseTimeDisplay");e&&e.show()}disable(){super.disable();const e=this.getChild("mouseTimeDisplay");e&&e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.pendingSeekTime()!==null&&(this.userSeek_(this.pendingSeekTime()),this.pendingSeekTime(null)),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?uh(this.player_.play()):this.update_()}handlePendingSeek_(e){this.player_.paused()||this.player_.pause();const t=this.pendingSeekTime()!==null?this.pendingSeekTime():this.player_.currentTime();this.pendingSeekTime(t+e),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}stepForward(){this.shouldDisableSeekWhileScrubbing_?this.handlePendingSeek_(this.options().stepSeconds):this.userSeek_(this.player_.currentTime()+this.options().stepSeconds)}stepBack(){this.shouldDisableSeekWhileScrubbing_?this.handlePendingSeek_(-this.options().stepSeconds):this.userSeek_(this.player_.currentTime()-this.options().stepSeconds)}handleAction(e){this.pendingSeekTime()!==null&&(this.userSeek_(this.pendingSeekTime()),this.pendingSeekTime(null)),this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){const t=this.player_.liveTracker;if(e.key===" "||e.key==="Enter")e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(e.key==="Home")e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if(e.key==="End")e.preventDefault(),e.stopPropagation(),t&&t.isLive()?this.userSeek_(t.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(e.key)){e.preventDefault(),e.stopPropagation();const i=parseInt(e.key,10)*.1;t&&t.isLive()?this.userSeek_(t.seekableStart()+t.liveWindow()*i):this.userSeek_(this.player_.duration()*i)}else e.key==="PageDown"?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-this.options().stepSeconds*this.options().pageMultiplier)):e.key==="PageUp"?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+this.options().stepSeconds*this.options().pageMultiplier)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["durationchange","timeupdate"],this.update),this.off(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in ot&&"visibilityState"in ot&&this.off(ot,"visibilitychange",this.toggleVisibility_),super.dispose()}};$k.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar",stepSeconds:5,pageMultiplier:12};Vt.registerComponent("SeekBar",$k);let qk=class extends Vt{constructor(e,t){super(e,t),this.handleMouseMove=Th(us(this,this.handleMouseMove),bc),this.throttledHandleMouseSeek=Th(us(this,this.handleMouseSeek),bc),this.handleMouseUpHandler_=i=>this.handleMouseUp(i),this.handleMouseDownHandler_=i=>this.handleMouseDown(i),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){const t=this.getChild("seekBar");if(!t)return;const i=t.getChild("playProgressBar"),n=t.getChild("mouseTimeDisplay");if(!i&&!n)return;const s=t.el(),a=C_(s);let c=rS(s,e).x;c=W_(c,0,1),n&&n.update(a,c),i&&i.update(a,t.getProgress())}handleMouseSeek(e){const t=this.getChild("seekBar");t&&t.handleMouseMove(e)}enabled(){return this.enabled_}disable(){if(this.children().forEach(e=>e.disable&&e.disable()),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&uh(this.player_.play())}}enable(){this.children().forEach(e=>e.enable&&e.enable()),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){const t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const t=this.getChild("seekBar");t&&t.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}};qk.prototype.options_={children:["seekBar"]};Vt.registerComponent("ProgressControl",qk);let Xk=class extends No{constructor(e,t){super(e,t),this.setIcon("picture-in-picture-enter"),this.on(e,["enterpictureinpicture","leavepictureinpicture"],i=>this.handlePictureInPictureChange(i)),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],i=>this.handlePictureInPictureEnabledChange(i)),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>this.handlePictureInPictureAudioModeChange()),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control vjs-hidden ${super.buildCSSClass()}`}handlePictureInPictureAudioModeChange(){if(!(this.player_.currentType().substring(0,5)==="audio"||this.player_.audioPosterMode()||this.player_.audioOnlyMode())){this.show();return}this.player_.isInPictureInPicture()&&this.player_.exitPictureInPicture(),this.hide()}handlePictureInPictureEnabledChange(){ot.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in Z?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?(this.setIcon("picture-in-picture-exit"),this.controlText("Exit Picture-in-Picture")):(this.setIcon("picture-in-picture-enter"),this.controlText("Picture-in-Picture")),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}show(){typeof ot.exitPictureInPicture=="function"&&super.show()}};Xk.prototype.controlText_="Picture-in-Picture";Vt.registerComponent("PictureInPictureToggle",Xk);let Yk=class extends No{constructor(e,t){super(e,t),this.setIcon("fullscreen-enter"),this.on(e,"fullscreenchange",i=>this.handleFullscreenChange(i)),ot[e.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(e){this.player_.isFullscreen()?(this.controlText("Exit Fullscreen"),this.setIcon("fullscreen-exit")):(this.controlText("Fullscreen"),this.setIcon("fullscreen-enter"))}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}};Yk.prototype.controlText_="Fullscreen";Vt.registerComponent("FullscreenToggle",Yk);const fV=function(r,e){e.tech_&&!e.tech_.featuresVolumeControl&&r.addClass("vjs-hidden"),r.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?r.removeClass("vjs-hidden"):r.addClass("vjs-hidden")})};let pV=class extends Vt{createEl(){const e=super.createEl("div",{className:"vjs-volume-level"});return this.setIcon("circle",e),e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}};Vt.registerComponent("VolumeLevel",pV);let mV=class extends Vt{constructor(e,t){super(e,t),this.update=Th(us(this,this.update),bc)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(e,t,i,n){if(!i){const s=U0(this.el_),a=U0(this.player_.el()),c=e.width*t;if(!a||!s)return;const h=e.left-a.left+c,m=e.width-c+(a.right-e.right);let v=s.width/2;h<v?v+=v-h:m<v&&(v=m),v<0?v=0:v>s.width&&(v=s.width),this.el_.style.right=`-${v}px`}this.write(`${n}%`)}write(e){Up(this.el_,e)}updateVolume(e,t,i,n,s){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(e,t,i,n.toFixed(0)),s&&s()})}};Vt.registerComponent("VolumeLevelTooltip",mV);let Qk=class extends Vt{constructor(e,t){super(e,t),this.update=Th(us(this,this.update),bc)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t,i){const n=100*t;this.getChild("volumeLevelTooltip").updateVolume(e,t,i,n,()=>{i?this.el_.style.bottom=`${e.height*t}px`:this.el_.style.left=`${e.width*t}px`})}};Qk.prototype.options_={children:["volumeLevelTooltip"]};Vt.registerComponent("MouseVolumeLevelDisplay",Qk);let dS=class extends nC{constructor(e,t){super(e,t),this.on("slideractive",i=>this.updateLastVolume_(i)),this.on(e,"volumechange",i=>this.updateARIAAttributes(i)),e.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){M_(e)&&super.handleMouseDown(e)}handleMouseMove(e){const t=this.getChild("mouseVolumeLevelDisplay");if(t){const i=this.el(),n=U0(i),s=this.vertical();let a=rS(i,e);a=s?a.y:a.x,a=W_(a,0,1),t.update(n,a,s)}M_(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){const t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")}volumeAsPercentage_(){return Math.round(this.player_.volume()*100)}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(e)})}};dS.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};!Fo&&!Kc&&dS.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay");dS.prototype.playerEvent="volumechange";Vt.registerComponent("VolumeBar",dS);let Kk=class extends Vt{constructor(e,t={}){t.vertical=t.vertical||!1,(typeof t.volumeBar>"u"||B0(t.volumeBar))&&(t.volumeBar=t.volumeBar||{},t.volumeBar.vertical=t.vertical),super(e,t),fV(this,e),this.throttledHandleMouseMove=Th(us(this,this.handleMouseMove),bc),this.handleMouseUpHandler_=i=>this.handleMouseUp(i),this.on("mousedown",i=>this.handleMouseDown(i)),this.on("touchstart",i=>this.handleMouseDown(i)),this.on("mousemove",i=>this.handleMouseMove(i)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${e}`})}handleMouseDown(e){const t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUpHandler_),this.off(t,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}};Kk.prototype.options_={children:["volumeBar"]};Vt.registerComponent("VolumeControl",Kk);const gV=function(r,e){e.tech_&&!e.tech_.featuresMuteControl&&r.addClass("vjs-hidden"),r.on(e,"loadstart",function(){e.tech_.featuresMuteControl?r.removeClass("vjs-hidden"):r.addClass("vjs-hidden")})};let Zk=class extends No{constructor(e,t){super(e,t),gV(this,e),this.on(e,["loadstart","volumechange"],i=>this.update(i))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.volume(),i=this.player_.lastVolume_();if(t===0){const n=i<.1?.1:i;this.player_.volume(n),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const e=this.player_.volume();let t=3;this.setIcon("volume-high"),Fo&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?(this.setIcon("volume-mute"),t=0):e<.33?(this.setIcon("volume-low"),t=1):e<.67&&(this.setIcon("volume-medium"),t=2),iS(this.el_,[0,1,2,3].reduce((i,n)=>i+`${n?" ":""}vjs-vol-${n}`,"")),Hm(this.el_,`vjs-vol-${t}`)}updateControlText_(){const t=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==t&&this.controlText(t)}};Zk.prototype.controlText_="Mute";Vt.registerComponent("MuteToggle",Zk);let Jk=class extends Vt{constructor(e,t={}){typeof t.inline<"u"?t.inline=t.inline:t.inline=!0,(typeof t.volumeControl>"u"||B0(t.volumeControl))&&(t.volumeControl=t.volumeControl||{},t.volumeControl.vertical=!t.inline),super(e,t),this.handleKeyPressHandler_=i=>this.handleKeyPress(i),this.on(e,["loadstart"],i=>this.volumePanelState_(i)),this.on(this.muteToggle,"keyup",i=>this.handleKeyPress(i)),this.on(this.volumeControl,"keyup",i=>this.handleVolumeControlKeyUp(i)),this.on("keydown",i=>this.handleKeyPress(i)),this.on("mouseover",i=>this.handleMouseOver(i)),this.on("mouseout",i=>this.handleMouseOut(i)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${e}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){e.key==="Escape"&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),Wu(ot,"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),Bo(ot,"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){e.key==="Escape"&&this.handleMouseOut()}};Jk.prototype.options_={children:["muteToggle","volumeControl"]};Vt.registerComponent("VolumePanel",Jk);class eO extends No{constructor(e,t){super(e,t),this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`forward-${this.skipTime}`),this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipForwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(e){if(isNaN(this.player_.duration()))return;const t=this.player_.currentTime(),i=this.player_.liveTracker,n=i&&i.isLive()?i.seekableEnd():this.player_.duration();let s;t+this.skipTime<=n?s=t+this.skipTime:s=n,this.player_.currentTime(s)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}eO.prototype.controlText_="Skip Forward";Vt.registerComponent("SkipForward",eO);class tO extends No{constructor(e,t){super(e,t),this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`replay-${this.skipTime}`),this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipBackwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.currentTime(),i=this.player_.liveTracker,n=i&&i.isLive()&&i.seekableStart();let s;n&&t-this.skipTime<=n?s=n:t>=this.skipTime?s=t-this.skipTime:s=0,this.player_.currentTime(s)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}tO.prototype.controlText_="Skip Backward";Vt.registerComponent("SkipBackward",tO);let iO=class extends Vt{constructor(e,t){super(e,t),t&&(this.menuButton_=t.menuButton),this.focusedChild_=-1,this.on("keydown",i=>this.handleKeyDown(i)),this.boundHandleBlur_=i=>this.handleBlur(i),this.boundHandleTapClick_=i=>this.handleTapClick(i)}addEventListenerForItem(e){e instanceof Vt&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof Vt&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){const t=this.addChild(e);t&&this.addEventListenerForItem(t)}createEl(){const e=this.options_.contentElType||"ul";this.contentEl_=cn(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const t=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),Wu(t,"click",function(i){i.preventDefault(),i.stopImmediatePropagation()}),t}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const t=e.relatedTarget||ot.activeElement;if(!this.children().some(i=>i.el()===t)){const i=this.menuButton_;i&&i.buttonPressed_&&t!==i.el().firstChild&&i.unpressButton()}}handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();const t=this.children();if(!Array.isArray(t))return;const i=t.filter(n=>n.el()===e.target)[0];if(!i)return;i.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}}handleKeyDown(e){e.key==="ArrowLeft"||e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(e.key==="ArrowRight"||e.key==="ArrowUp")&&(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)}focus(e=0){const t=this.children().slice();t.length&&t[0].hasClass("vjs-menu-title")&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())}};Vt.registerComponent("Menu",iO);let sC=class extends Vt{constructor(e,t={}){super(e,t),this.menuButton_=new No(e,t),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const i=No.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+i,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const n=s=>this.handleClick(s);this.handleMenuKeyUp_=s=>this.handleMenuKeyUp(s),this.on(this.menuButton_,"tap",n),this.on(this.menuButton_,"click",n),this.on(this.menuButton_,"keydown",s=>this.handleKeyDown(s)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),Wu(ot,"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",s=>this.handleMouseLeave(s)),this.on("keydown",s=>this.handleSubmenuKeyDown(s))}update(){const e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const e=new iO(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const t=cn("li",{className:"vjs-menu-title",textContent:Zs(this.options_.title),tabIndex:-1}),i=new Vt(this.player_,{el:t});e.addItem(i)}if(this.items=this.createItems(),this.items)for(let t=0;t<this.items.length;t++)e.addItem(this.items[t]);return e}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}setIcon(e){super.setIcon(e,this.menuButton_.el_)}buildWrapperCSSClass(){let e="vjs-menu-button";this.options_.inline===!0?e+="-inline":e+="-popup";const t=No.prototype.buildCSSClass();return`vjs-menu-button ${e} ${t} ${super.buildCSSClass()}`}buildCSSClass(){let e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${super.buildCSSClass()}`}controlText(e,t=this.menuButton_.el()){return this.menuButton_.controlText(e,t)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),Bo(ot,"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){e.key==="Escape"||e.key==="Tab"?(this.buttonPressed_&&this.unpressButton(),!e.key==="Tab"&&(e.preventDefault(),this.menuButton_.focus())):(e.key==="Up"||e.key==="Down"&&!(this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))}handleMenuKeyUp(e){(e.key==="Escape"||e.key==="Tab")&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){(e.key==="Escape"||e.key==="Tab")&&(this.buttonPressed_&&this.unpressButton(),!e.key==="Tab"&&(e.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Fo&&uk())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}};Vt.registerComponent("MenuButton",sC);let aC=class extends sC{constructor(e,t){const i=t.tracks;if(super(e,t),this.items.length<=1&&this.hide(),!i)return;const n=us(this,this.update);i.addEventListener("removetrack",n),i.addEventListener("addtrack",n),i.addEventListener("labelchange",n),this.player_.on("ready",n),this.player_.on("dispose",function(){i.removeEventListener("removetrack",n),i.removeEventListener("addtrack",n),i.removeEventListener("labelchange",n)})}};Vt.registerComponent("TrackButton",aC);let q_=class extends cS{constructor(e,t){super(e,t),this.selectable=t.selectable,this.isSelected_=t.selected||!1,this.multiSelectable=t.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,t,i){this.nonIconControl=!0;const n=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},t),i),s=cn("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)});return this.player_.options_.experimentalSvgIcons?n.appendChild(s):n.replaceChild(s,n.querySelector(".vjs-icon-placeholder")),n}handleKeyDown(e){["Tab","Escape","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"].includes(e.key)||super.handleKeyDown(e)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}};Vt.registerComponent("MenuItem",q_);let X_=class extends q_{constructor(e,t){const i=t.track,n=e.textTracks();t.label=i.label||i.language||"Unknown",t.selected=i.mode==="showing",super(e,t),this.track=i,this.kinds=(t.kinds||[t.kind||this.track.kind]).filter(Boolean);const s=(...c)=>{this.handleTracksChange.apply(this,c)},a=(...c)=>{this.handleSelectedLanguageChange.apply(this,c)};if(e.on(["loadstart","texttrackchange"],s),n.addEventListener("change",s),n.addEventListener("selectedlanguagechange",a),this.on("dispose",function(){e.off(["loadstart","texttrackchange"],s),n.removeEventListener("change",s),n.removeEventListener("selectedlanguagechange",a)}),n.onchange===void 0){let c;this.on(["tap","click"],function(){if(typeof Z.Event!="object")try{c=new Z.Event("change")}catch{}c||(c=ot.createEvent("Event"),c.initEvent("change",!0,!0)),n.dispatchEvent(c)})}this.handleTracksChange()}handleClick(e){const t=this.track,i=this.player_.textTracks();if(super.handleClick(e),!!i)for(let n=0;n<i.length;n++){const s=i[n];this.kinds.indexOf(s.kind)!==-1&&(s===t?s.mode!=="showing"&&(s.mode="showing"):s.mode!=="disabled"&&(s.mode="disabled"))}}handleTracksChange(e){const t=this.track.mode==="showing";t!==this.isSelected_&&this.selected(t)}handleSelectedLanguageChange(e){if(this.track.mode==="showing"){const t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}};Vt.registerComponent("TextTrackMenuItem",X_);let nO=class extends X_{constructor(e,t){t.track={player:e,kind:t.kind,kinds:t.kinds,default:!1,mode:"disabled"},t.kinds||(t.kinds=[t.kind]),t.label?t.track.label=t.label:t.track.label=t.kinds.join(" and ")+" off",t.selectable=!0,t.multiSelectable=!1,super(e,t)}handleTracksChange(e){const t=this.player().textTracks();let i=!0;for(let n=0,s=t.length;n<s;n++){const a=t[n];if(this.options_.kinds.indexOf(a.kind)>-1&&a.mode==="showing"){i=!1;break}}i!==this.isSelected_&&this.selected(i)}handleSelectedLanguageChange(e){const t=this.player().textTracks();let i=!0;for(let n=0,s=t.length;n<s;n++){const a=t[n];if(["captions","descriptions","subtitles"].indexOf(a.kind)>-1&&a.mode==="showing"){i=!1;break}}i&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}};Vt.registerComponent("OffTextTrackMenuItem",nO);let av=class extends aC{constructor(e,t={}){t.tracks=e.textTracks(),super(e,t)}createItems(e=[],t=X_){let i;this.label_&&(i=`${this.label_} off`),e.push(new nO(this.player_,{kinds:this.kinds_,kind:this.kind_,label:i})),this.hideThreshold_+=1;const n=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let s=0;s<n.length;s++){const a=n[s];if(this.kinds_.indexOf(a.kind)>-1){const c=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});c.addClass(`vjs-${a.kind}-menu-item`),e.push(c)}}return e}};Vt.registerComponent("TextTrackButton",av);let rO=class extends q_{constructor(e,t){const i=t.track,n=t.cue,s=e.currentTime();t.selectable=!0,t.multiSelectable=!1,t.label=n.text,t.selected=n.startTime<=s&&s<n.endTime,super(e,t),this.track=i,this.cue=n}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}};Vt.registerComponent("ChaptersTrackMenuItem",rO);let oC=class extends av{constructor(e,t,i){super(e,t,i),this.setIcon("chapters"),this.selectCurrentItem_=()=>{this.items.forEach(n=>{n.selected(this.track_.activeCues[0]===n.cue)})}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(e){if(e&&e.track&&e.track.kind!=="chapters")return;const t=this.findChaptersTrack();t!==this.track_?(this.setTrack(t),super.update()):(!this.items||t&&t.cues&&t.cues.length!==this.items.length)&&super.update()}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const e=this.player_.textTracks()||[];for(let t=e.length-1;t>=0;t--){const i=e[t];if(i.kind===this.kind_)return i}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(Zs(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const e=[];if(!this.track_)return e;const t=this.track_.cues;if(!t)return e;for(let i=0,n=t.length;i<n;i++){const s=t[i],a=new rO(this.player_,{track:this.track_,cue:s});e.push(a)}return e}};oC.prototype.kind_="chapters";oC.prototype.controlText_="Chapters";Vt.registerComponent("ChaptersButton",oC);let lC=class extends av{constructor(e,t,i){super(e,t,i),this.setIcon("audio-description");const n=e.textTracks(),s=us(this,this.handleTracksChange);n.addEventListener("change",s),this.on("dispose",function(){n.removeEventListener("change",s)})}handleTracksChange(e){const t=this.player().textTracks();let i=!1;for(let n=0,s=t.length;n<s;n++){const a=t[n];if(a.kind!==this.kind_&&a.mode==="showing"){i=!0;break}}i?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}};lC.prototype.kind_="descriptions";lC.prototype.controlText_="Descriptions";Vt.registerComponent("DescriptionsButton",lC);let uC=class extends av{constructor(e,t,i){super(e,t,i),this.setIcon("subtitles")}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}};uC.prototype.kind_="subtitles";uC.prototype.controlText_="Subtitles";Vt.registerComponent("SubtitlesButton",uC);let cC=class extends X_{constructor(e,t){t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:!1,default:!1,mode:"disabled"},t.selectable=!1,t.name="CaptionSettingsMenuItem",super(e,t),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+t.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}};Vt.registerComponent("CaptionSettingsMenuItem",cC);let dC=class extends av{constructor(e,t,i){super(e,t,i),this.setIcon("captions")}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new cC(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}};dC.prototype.kind_="captions";dC.prototype.controlText_="Captions";Vt.registerComponent("CaptionsButton",dC);let sO=class extends X_{createEl(e,t,i){const n=super.createEl(e,t,i),s=n.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(this.player_.options_.experimentalSvgIcons?this.setIcon("captions",n):s.appendChild(cn("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),s.appendChild(cn("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),n}};Vt.registerComponent("SubsCapsMenuItem",sO);let hC=class extends av{constructor(e,t={}){super(e,t),this.label_="subtitles",this.setIcon("subtitles"),["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions",this.setIcon("captions")),this.menuButton_.controlText(Zs(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new cC(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,sO),e}};hC.prototype.kinds_=["captions","subtitles"];hC.prototype.controlText_="Subtitles";Vt.registerComponent("SubsCapsButton",hC);let aO=class extends q_{constructor(e,t){const i=t.track,n=e.audioTracks();t.label=i.label||i.language||"Unknown",t.selected=i.enabled,super(e,t),this.track=i,this.addClass(`vjs-${i.kind}-menu-item`);const s=(...a)=>{this.handleTracksChange.apply(this,a)};n.addEventListener("change",s),this.on("dispose",()=>{n.removeEventListener("change",s)})}createEl(e,t,i){const n=super.createEl(e,t,i),s=n.querySelector(".vjs-menu-item-text");return["main-desc","descriptions"].indexOf(this.options_.track.kind)>=0&&(s.appendChild(cn("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),s.appendChild(cn("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),n}handleClick(e){if(super.handleClick(e),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const t=this.player_.audioTracks();for(let i=0;i<t.length;i++){const n=t[i];n!==this.track&&(n.enabled=n===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}};Vt.registerComponent("AudioTrackMenuItem",aO);let oO=class extends aC{constructor(e,t={}){t.tracks=e.audioTracks(),super(e,t),this.setIcon("audio")}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(e=[]){this.hideThreshold_=1;const t=this.player_.audioTracks();for(let i=0;i<t.length;i++){const n=t[i];e.push(new aO(this.player_,{track:n,selectable:!0,multiSelectable:!1}))}return e}};oO.prototype.controlText_="Audio Track";Vt.registerComponent("AudioTrackButton",oO);let fC=class extends q_{constructor(e,t){const i=t.rate,n=parseFloat(i,10);t.label=i,t.selected=n===e.playbackRate(),t.selectable=!0,t.multiSelectable=!1,super(e,t),this.label=i,this.rate=n,this.on(e,"ratechange",s=>this.update(s))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}};fC.prototype.contentElType="button";Vt.registerComponent("PlaybackRateMenuItem",fC);let lO=class extends sC{constructor(e,t){super(e,t),this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",i=>this.updateVisibility(i)),this.on(e,"ratechange",i=>this.updateLabel(i)),this.on(e,"playbackrateschange",i=>this.handlePlaybackRateschange(i))}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=cn("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const e=this.playbackRates(),t=[];for(let i=e.length-1;i>=0;i--)t.push(new fC(this.player(),{rate:e[i]+"x"}));return t}handlePlaybackRateschange(e){this.update()}playbackRates(){const e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}};lO.prototype.controlText_="Playback Rate";Vt.registerComponent("PlaybackRateMenuButton",lO);let uO=class extends Vt{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(e="div",t={},i={}){return t.className||(t.className=this.buildCSSClass()),super.createEl(e,t,i)}};Vt.registerComponent("Spacer",uO);let vV=class extends uO{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:""})}};Vt.registerComponent("CustomControlSpacer",vV);let cO=class extends Vt{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}};cO.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]};Vt.registerComponent("ControlBar",cO);let dO=class extends nv{constructor(e,t){super(e,t),this.on(e,"error",i=>{this.open(i)})}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const e=this.player().error();return e?this.localize(e.message):""}};dO.prototype.options_=Object.assign({},nv.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});Vt.registerComponent("ErrorDisplay",dO);class hO extends Vt{constructor(e,t={}){super(e,t),this.el_.setAttribute("aria-labelledby",this.selectLabelledbyIds)}createEl(){return this.selectLabelledbyIds=[this.options_.legendId,this.options_.labelId].join(" ").trim(),cn("select",{id:this.options_.id},{},this.options_.SelectOptions.map(t=>{const i=(this.options_.labelId?this.options_.labelId:`vjs-track-option-${_c()}`)+"-"+t[1].replace(/\W+/g,""),n=cn("option",{id:i,value:this.localize(t[0]),textContent:this.localize(t[1])});return n.setAttribute("aria-labelledby",`${this.selectLabelledbyIds} ${i}`),n}))}}Vt.registerComponent("TextTrackSelect",hO);class Gm extends Vt{constructor(e,t={}){super(e,t);const i=cn("legend",{textContent:this.localize(this.options_.legendText),id:this.options_.legendId});this.el().appendChild(i);const n=this.options_.selects;for(const s of n){const a=this.options_.selectConfigs[s],c=a.className,h=a.id.replace("%s",this.options_.id_);let m=null;const v=`vjs_select_${_c()}`;if(this.options_.type==="colors"){m=cn("span",{className:c});const x=cn("label",{id:h,className:"vjs-label",textContent:this.localize(a.label)});x.setAttribute("for",v),m.appendChild(x)}const b=new hO(e,{SelectOptions:a.options,legendId:this.options_.legendId,id:v,labelId:h});this.addChild(b),this.options_.type==="colors"&&(m.appendChild(b.el()),this.el().appendChild(m))}}createEl(){return cn("fieldset",{className:this.options_.className})}}Vt.registerComponent("TextTrackFieldset",Gm);class fO extends Vt{constructor(e,t={}){super(e,t);const i=this.options_.textTrackComponentid,n=new Gm(e,{id_:i,legendId:`captions-text-legend-${i}`,legendText:this.localize("Text"),className:"vjs-fg vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(n);const s=new Gm(e,{id_:i,legendId:`captions-background-${i}`,legendText:this.localize("Text Background"),className:"vjs-bg vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(s);const a=new Gm(e,{id_:i,legendId:`captions-window-${i}`,legendText:this.localize("Caption Area Background"),className:"vjs-window vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(a)}createEl(){return cn("div",{className:"vjs-track-settings-colors"})}}Vt.registerComponent("TextTrackSettingsColors",fO);class pO extends Vt{constructor(e,t={}){super(e,t);const i=this.options_.textTrackComponentid,n=new Gm(e,{id_:i,legendId:`captions-font-size-${i}`,legendText:"Font Size",className:"vjs-font-percent vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(n);const s=new Gm(e,{id_:i,legendId:`captions-edge-style-${i}`,legendText:this.localize("Text Edge Style"),className:"vjs-edge-style vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(s);const a=new Gm(e,{id_:i,legendId:`captions-font-family-${i}`,legendText:this.localize("Font Family"),className:"vjs-font-family vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(a)}createEl(){return cn("div",{className:"vjs-track-settings-font"})}}Vt.registerComponent("TextTrackSettingsFont",pO);class mO extends Vt{constructor(e,t={}){super(e,t);const i=new No(e,{controlText:this.localize("restore all settings to the default values"),className:"vjs-default-button"});i.el().classList.remove("vjs-control","vjs-button"),i.el().textContent=this.localize("Reset"),this.addChild(i);const n=this.localize("Done"),s=new No(e,{controlText:n,className:"vjs-done-button"});s.el().classList.remove("vjs-control","vjs-button"),s.el().textContent=n,this.addChild(s)}createEl(){return cn("div",{className:"vjs-track-settings-controls"})}}Vt.registerComponent("TrackSettingsControls",mO);const ow="vjs-text-track-settings",PI=["#000","Black"],LI=["#00F","Blue"],RI=["#0FF","Cyan"],kI=["#0F0","Green"],OI=["#F0F","Magenta"],FI=["#F00","Red"],BI=["#FFF","White"],NI=["#FF0","Yellow"],lw=["1","Opaque"],uw=["0.5","Semi-Transparent"],UI=["0","Transparent"],Sp={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[PI,BI,FI,kI,LI,NI,OI,RI],className:"vjs-bg-color"},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[lw,uw,UI],className:"vjs-bg-opacity vjs-opacity"},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[BI,PI,FI,kI,LI,NI,OI,RI],className:"vjs-text-color"},edgeStyle:{selector:".vjs-edge-style > select",id:"",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Drop shadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:r=>r==="1.00"?null:Number(r)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[lw,uw],className:"vjs-text-opacity vjs-opacity"},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color",className:"vjs-window-color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[UI,uw,lw],className:"vjs-window-opacity vjs-opacity"}};Sp.windowColor.options=Sp.backgroundColor.options;function gO(r,e){if(e&&(r=e(r)),r&&r!=="none")return r}function yV(r,e){const t=r.options[r.options.selectedIndex].value;return gO(t,e)}function _V(r,e,t){if(e){for(let i=0;i<r.options.length;i++)if(gO(r.options[i].value,t)===e){r.selectedIndex=i;break}}}let bV=class extends nv{constructor(e,t){t.temporary=!1,super(e,t),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.renderModalComponents(e),this.endDialog=cn("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),t.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.bindFunctionsToSelectsAndButtons(),this.options_.persistTextTrackSettings&&this.restoreSettings()}renderModalComponents(e){const t=new fO(e,{textTrackComponentid:this.id_,selectConfigs:Sp,fieldSets:[["color","textOpacity"],["backgroundColor","backgroundOpacity"],["windowColor","windowOpacity"]]});this.addChild(t);const i=new pO(e,{textTrackComponentid:this.id_,selectConfigs:Sp,fieldSets:[["fontPercent"],["edgeStyle"],["fontFamily"]]});this.addChild(i);const n=new mO(e);this.addChild(n)}bindFunctionsToSelectsAndButtons(){this.on(this.$(".vjs-done-button"),["click","tap"],()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),["click","tap"],()=>{this.setDefaults(),this.updateDisplay()}),p0(Sp,e=>{this.on(this.$(e.selector),"change",this.updateDisplay)})}dispose(){this.endDialog=null,super.dispose()}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return ik(Sp,(e,t,i)=>{const n=yV(this.$(t.selector),t.parser);return n!==void 0&&(e[i]=n),e},{})}setValues(e){p0(Sp,(t,i)=>{_V(this.$(t.selector),e[i],t.parser)})}setDefaults(){p0(Sp,e=>{const t=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=t})}restoreSettings(){let e;try{e=JSON.parse(Z.localStorage.getItem(ow))}catch(t){Zn.warn(t)}e&&this.setValues(e)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const e=this.getValues();try{Object.keys(e).length?Z.localStorage.setItem(ow,JSON.stringify(e)):Z.localStorage.removeItem(ow)}catch(t){Zn.warn(t)}}updateDisplay(){const e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}handleLanguagechange(){this.fill(),this.renderModalComponents(this.player_),this.bindFunctionsToSelectsAndButtons()}};Vt.registerComponent("TextTrackSettings",bV);let TV=class extends Vt{constructor(e,t){let i=t.ResizeObserver||Z.ResizeObserver;t.ResizeObserver===null&&(i=!1);const n=Yr({createEl:!i,reportTouchActivity:!1},t);super(e,n),this.ResizeObserver=t.ResizeObserver||Z.ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=wk(()=>{this.resizeHandler()},100,!1,this),i?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const s=this.debouncedHandler_;let a=this.unloadListener_=function(){Bo(this,"resize",s),Bo(this,"unload",a),a=null};Wu(this.el_.contentWindow,"unload",a),Wu(this.el_.contentWindow,"resize",s)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}};Vt.registerComponent("ResizeManager",TV);const xV={trackingThreshold:20,liveTolerance:15};let SV=class extends Vt{constructor(e,t){const i=Yr(xV,t,{createEl:!1});super(e,i),this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=n=>this.handlePlay(n),this.handleFirstTimeupdate_=n=>this.handleFirstTimeupdate(n),this.handleSeeked_=n=>this.handleSeeked(n),this.seekToLiveEdge_=n=>this.seekToLiveEdge(n),this.reset_(),this.on(this.player_,"durationchange",n=>this.handleDurationchange(n)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){const e=this.player_.seekable();if(!e||!e.length)return;const t=Number(Z.performance.now().toFixed(4)),i=this.lastTime_===-1?0:(t-this.lastTime_)/1e3;this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+i;const n=this.liveCurrentTime(),s=this.player_.currentTime();let a=this.player_.paused()||this.seekedBehindLive_||Math.abs(n-s)>this.options_.liveTolerance;(!this.timeupdateSeen_||n===1/0)&&(a=!1),a!==this.behindLiveEdge_&&(this.behindLiveEdge_=a,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,bc),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const e=this.player_.seekable(),t=[];let i=e?e.length:0;for(;i--;)t.push(e.end(i));return t.length?t.sort()[t.length-1]:1/0}seekableStart(){const e=this.player_.seekable(),t=[];let i=e?e.length:0;for(;i--;)t.push(e.start(i));return t.length?t.sort()[0]:0}liveWindow(){const e=this.liveCurrentTime();return e===1/0?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const e=this.seekableEnd();return this.lastSeekEnd_!==-1&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}};Vt.registerComponent("LiveTracker",SV);class AV extends Vt{constructor(e,t){super(e,t),this.on("statechanged",i=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:cn("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${_c()}`}),description:cn("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${_c()}`})},cn("div",{className:"vjs-title-bar"},{},nk(this.els))}updateDom_(){const e=this.player_.tech_,t=e&&e.el_,i={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(n=>{const s=this.state[n],a=this.els[n],c=i[n];sS(a),s&&Up(a,s),t&&(t.removeAttribute(c),s&&t.setAttribute(c,a.id))}),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){const e=this.player_.tech_,t=e&&e.el_;t&&(t.removeAttribute("aria-labelledby"),t.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}Vt.registerComponent("TitleBar",AV);const wV={initialDisplay:4e3,position:[],takeFocus:!1};class EV extends No{constructor(e,t){t=Yr(wV,t),super(e,t),this.controlText(t.controlText),this.hide(),this.on(this.player_,["useractive","userinactive"],i=>{this.removeClass("force-display")})}buildCSSClass(){return`vjs-transient-button focus-visible ${this.options_.position.map(e=>`vjs-${e}`).join(" ")}`}createEl(){const e=cn("button",{},{type:"button",class:this.buildCSSClass()},cn("span"));return this.controlTextEl_=e.querySelector("span"),e}show(){super.show(),this.addClass("force-display"),this.options_.takeFocus&&this.el().focus({preventScroll:!0}),this.forceDisplayTimeout=this.player_.setTimeout(()=>{this.removeClass("force-display")},this.options_.initialDisplay)}hide(){this.removeClass("force-display"),super.hide()}dispose(){this.player_.clearTimeout(this.forceDisplayTimeout),super.dispose()}}Vt.registerComponent("TransientButton",EV);const _E=r=>{const e=r.el();if(e.hasAttribute("src"))return r.triggerSourceset(e.src),!0;const t=r.$$("source"),i=[];let n="";if(!t.length)return!1;for(let s=0;s<t.length;s++){const a=t[s].src;a&&i.indexOf(a)===-1&&i.push(a)}return i.length?(i.length===1&&(n=i[0]),r.triggerSourceset(n),!0):!1},CV=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(r){const e=ot.createElement(this.nodeName.toLowerCase());e.innerHTML=r;const t=ot.createDocumentFragment();for(;e.childNodes.length;)t.appendChild(e.childNodes[0]);return this.innerText="",Z.Element.prototype.appendChild.call(this,t),this.innerHTML}}),vO=(r,e)=>{let t={};for(let i=0;i<r.length&&(t=Object.getOwnPropertyDescriptor(r[i],e),!(t&&t.set&&t.get));i++);return t.enumerable=!0,t.configurable=!0,t},MV=r=>vO([r.el(),Z.HTMLMediaElement.prototype,Z.Element.prototype,CV],"innerHTML"),VI=function(r){const e=r.el();if(e.resetSourceWatch_)return;const t={},i=MV(r),n=s=>(...a)=>{const c=s.apply(e,a);return _E(r),c};["append","appendChild","insertAdjacentHTML"].forEach(s=>{e[s]&&(t[s]=e[s],e[s]=n(t[s]))}),Object.defineProperty(e,"innerHTML",Yr(i,{set:n(i.set)})),e.resetSourceWatch_=()=>{e.resetSourceWatch_=null,Object.keys(t).forEach(s=>{e[s]=t[s]}),Object.defineProperty(e,"innerHTML",i)},r.one("sourceset",e.resetSourceWatch_)},DV=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?Bk(Z.Element.prototype.getAttribute.call(this,"src")):""},set(r){return Z.Element.prototype.setAttribute.call(this,"src",r),r}}),IV=r=>vO([r.el(),Z.HTMLMediaElement.prototype,DV],"src"),PV=function(r){if(!r.featuresSourceset)return;const e=r.el();if(e.resetSourceset_)return;const t=IV(r),i=e.setAttribute,n=e.load;Object.defineProperty(e,"src",Yr(t,{set:s=>{const a=t.set.call(e,s);return r.triggerSourceset(e.src),a}})),e.setAttribute=(s,a)=>{const c=i.call(e,s,a);return/src/i.test(s)&&r.triggerSourceset(e.src),c},e.load=()=>{const s=n.call(e);return _E(r)||(r.triggerSourceset(""),VI(r)),s},e.currentSrc?r.triggerSourceset(e.currentSrc):_E(r)||VI(r),e.resetSourceset_=()=>{e.resetSourceset_=null,e.load=n,e.setAttribute=i,Object.defineProperty(e,"src",t),e.resetSourceWatch_&&e.resetSourceWatch_()}};let ki=class _T extends ts{constructor(e,t){super(e,t);const i=e.source;let n=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",i&&(this.el_.currentSrc!==i.src||e.tag&&e.tag.initNetworkState_===3)?this.setSource(i):this.handleLateInit_(this.el_),e.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const s=this.el_.childNodes;let a=s.length;const c=[];for(;a--;){const h=s[a];h.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(h),this.remoteTextTracks().addTrack(h.track),this.textTracks().addTrack(h.track),!n&&!this.el_.hasAttribute("crossorigin")&&uS(h.src)&&(n=!0)):c.push(h))}for(let h=0;h<c.length;h++)this.el_.removeChild(c[h])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&n&&Zn.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(E_||eS)&&e.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),_T.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){PV(this)}restoreMetadataTracksInIOSNativePlayer_(){const e=this.textTracks();let t;const i=()=>{t=[];for(let s=0;s<e.length;s++){const a=e[s];a.kind==="metadata"&&t.push({track:a,storedMode:a.mode})}};i(),e.addEventListener("change",i),this.on("dispose",()=>e.removeEventListener("change",i));const n=()=>{for(let s=0;s<t.length;s++){const a=t[s];a.track.mode==="disabled"&&a.track.mode!==a.storedMode&&(a.track.mode=a.storedMode)}e.removeEventListener("change",n)};this.on("webkitbeginfullscreen",()=>{e.removeEventListener("change",i),e.removeEventListener("change",n),e.addEventListener("change",n)}),this.on("webkitendfullscreen",()=>{e.removeEventListener("change",i),e.addEventListener("change",i),e.removeEventListener("change",n)})}overrideNative_(e,t){if(t!==this[`featuresNative${e}Tracks`])return;const i=e.toLowerCase();this[`${i}TracksListeners_`]&&Object.keys(this[`${i}TracksListeners_`]).forEach(n=>{this.el()[`${i}Tracks`].removeEventListener(n,this[`${i}TracksListeners_`][n])}),this[`featuresNative${e}Tracks`]=!t,this[`${i}TracksListeners_`]=null,this.proxyNativeTracksForType_(i)}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(e){const t=gc[e],i=this.el()[t.getterName],n=this[t.getterName]();if(!this[`featuresNative${t.capitalName}Tracks`]||!i||!i.addEventListener)return;const s={change:c=>{const h={type:"change",target:n,currentTarget:n,srcElement:n};n.trigger(h),e==="text"&&this[z0.remoteText.getterName]().trigger(h)},addtrack(c){n.addTrack(c.track)},removetrack(c){n.removeTrack(c.track)}},a=function(){const c=[];for(let h=0;h<n.length;h++){let m=!1;for(let v=0;v<i.length;v++)if(i[v]===n[h]){m=!0;break}m||c.push(n[h])}for(;c.length;)n.removeTrack(c.shift())};this[t.getterName+"Listeners_"]=s,Object.keys(s).forEach(c=>{const h=s[c];i.addEventListener(c,h),this.on("dispose",m=>i.removeEventListener(c,h))}),this.on("loadstart",a),this.on("dispose",c=>this.off("loadstart",a))}proxyNativeTracks_(){gc.names.forEach(e=>{this.proxyNativeTracksForType_(e)})}createEl(){let e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){const i=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(i,e),_T.disposeMediaElement(e),e=i}else{e=ot.createElement("video");const i=this.options_.tag&&xp(this.options_.tag),n=Yr({},i);(!E_||this.options_.nativeControlsForTouch!==!0)&&delete n.controls,hk(e,Object.assign(n,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}typeof this.options_.preload<"u"&&N0(e,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);const t=["loop","muted","playsinline","autoplay"];for(let i=0;i<t.length;i++){const n=t[i],s=this.options_[n];typeof s<"u"&&(s?N0(e,n,n):nS(e,n),e[n]=s)}return e}handleLateInit_(e){if(e.networkState===0||e.networkState===3)return;if(e.readyState===0){let i=!1;const n=function(){i=!0};this.on("loadstart",n);const s=function(){i||this.trigger("loadstart")};this.on("loadedmetadata",s),this.ready(function(){this.off("loadstart",n),this.off("loadedmetadata",s),i||this.trigger("loadstart")});return}const t=["loadstart"];t.push("loadedmetadata"),e.readyState>=2&&t.push("loadeddata"),e.readyState>=3&&t.push("canplay"),e.readyState>=4&&t.push("canplaythrough"),this.ready(function(){t.forEach(function(i){this.trigger(i)},this)})}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&tS?this.el_.fastSeek(e):this.el_.currentTime=e}catch(t){Zn(t,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===1/0&&Kc&&bh&&this.el_.currentTime===0){const e=()=>{this.el_.currentTime>0&&(this.el_.duration===1/0&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},t=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",t),this.on("dispose",()=>{this.off("webkitbeginfullscreen",t),this.off("webkitendfullscreen",e)})}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)uh(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}},0);else try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}}exitFullScreen(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(e===void 0)return this.el_.src;this.setSrc(e)}addSourceElement(e,t){if(!e)return Zn.error("Invalid source URL."),!1;const i={src:e};t&&(i.type=t);const n=cn("source",{},i);return this.el_.appendChild(n),!0}removeSourceElement(e){if(!e)return Zn.error("Source URL is required to remove the source element."),!1;const t=this.el_.querySelectorAll("source");for(const i of t)if(i.src===e)return this.el_.removeChild(i),!0;return Zn.warn(`No matching source element found with src: ${e}`),!1}reset(){_T.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,t,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,i):super.addTextTrack(e,t,i)}createRemoteTextTrack(e){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(e);const t=ot.createElement("track");return e.kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),t}addRemoteTextTrack(e,t){const i=super.addRemoteTextTrack(e,t);return this.featuresNativeTextTracks&&this.el().appendChild(i),i}removeRemoteTextTrack(e){if(super.removeRemoteTextTrack(e),this.featuresNativeTextTracks){const t=this.$$("track");let i=t.length;for(;i--;)(e===t[i]||e===t[i].track)&&this.el().removeChild(t[i])}}getVideoPlaybackQuality(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();const e={};return typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),Z.performance&&(e.creationTime=Z.performance.now()),e}};Kx(ki,"TEST_VID",function(){if(!ev())return;const r=ot.createElement("video"),e=ot.createElement("track");return e.kind="captions",e.srclang="en",e.label="English",r.appendChild(e),r});ki.isSupported=function(){try{ki.TEST_VID.volume=.5}catch{return!1}return!!(ki.TEST_VID&&ki.TEST_VID.canPlayType)};ki.canPlayType=function(r){return ki.TEST_VID.canPlayType(r)};ki.canPlaySource=function(r,e){return ki.canPlayType(r.type)};ki.canControlVolume=function(){try{const r=ki.TEST_VID.volume;ki.TEST_VID.volume=r/2+.1;const e=r!==ki.TEST_VID.volume;return e&&Fo?(Z.setTimeout(()=>{ki&&ki.prototype&&(ki.prototype.featuresVolumeControl=r!==ki.TEST_VID.volume)}),!1):e}catch{return!1}};ki.canMuteVolume=function(){try{const r=ki.TEST_VID.muted;return ki.TEST_VID.muted=!r,ki.TEST_VID.muted?N0(ki.TEST_VID,"muted","muted"):nS(ki.TEST_VID,"muted","muted"),r!==ki.TEST_VID.muted}catch{return!1}};ki.canControlPlaybackRate=function(){if(Kc&&bh&&Zx<58)return!1;try{const r=ki.TEST_VID.playbackRate;return ki.TEST_VID.playbackRate=r/2+.1,r!==ki.TEST_VID.playbackRate}catch{return!1}};ki.canOverrideAttributes=function(){try{const r=()=>{};Object.defineProperty(ot.createElement("video"),"src",{get:r,set:r}),Object.defineProperty(ot.createElement("audio"),"src",{get:r,set:r}),Object.defineProperty(ot.createElement("video"),"innerHTML",{get:r,set:r}),Object.defineProperty(ot.createElement("audio"),"innerHTML",{get:r,set:r})}catch{return!1}return!0};ki.supportsNativeTextTracks=function(){return tS||Fo&&bh};ki.supportsNativeVideoTracks=function(){return!!(ki.TEST_VID&&ki.TEST_VID.videoTracks)};ki.supportsNativeAudioTracks=function(){return!!(ki.TEST_VID&&ki.TEST_VID.audioTracks)};ki.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([r,e]){Kx(ki.prototype,r,()=>ki[e](),!0)});ki.prototype.featuresVolumeControl=ki.canControlVolume();ki.prototype.movingMediaElementInDOM=!Fo;ki.prototype.featuresFullscreenResize=!0;ki.prototype.featuresProgressEvents=!0;ki.prototype.featuresTimeupdateEvents=!0;ki.prototype.featuresVideoFrameCallback=!!(ki.TEST_VID&&ki.TEST_VID.requestVideoFrameCallback);ki.disposeMediaElement=function(r){if(r){for(r.parentNode&&r.parentNode.removeChild(r);r.hasChildNodes();)r.removeChild(r.firstChild);r.removeAttribute("src"),typeof r.load=="function"&&function(){try{r.load()}catch{}}()}};ki.resetMediaElement=function(r){if(!r)return;const e=r.querySelectorAll("source");let t=e.length;for(;t--;)r.removeChild(e[t]);r.removeAttribute("src"),typeof r.load=="function"&&function(){try{r.load()}catch{}}()};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(r){ki.prototype[r]=function(){return this.el_[r]||this.el_.hasAttribute(r)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(r){ki.prototype["set"+Zs(r)]=function(e){this.el_[r]=e,e?this.el_.setAttribute(r,r):this.el_.removeAttribute(r)}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(r){ki.prototype[r]=function(){return this.el_[r]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(r){ki.prototype["set"+Zs(r)]=function(e){this.el_[r]=e}});["pause","load","play"].forEach(function(r){ki.prototype[r]=function(){return this.el_[r]()}});ts.withSourceHandlers(ki);ki.nativeSourceHandler={};ki.nativeSourceHandler.canPlayType=function(r){try{return ki.TEST_VID.canPlayType(r)}catch{return""}};ki.nativeSourceHandler.canHandleSource=function(r,e){if(r.type)return ki.nativeSourceHandler.canPlayType(r.type);if(r.src){const t=Z2(r.src);return ki.nativeSourceHandler.canPlayType(`video/${t}`)}return""};ki.nativeSourceHandler.handleSource=function(r,e,t){e.setSrc(r.src)};ki.nativeSourceHandler.dispose=function(){};ki.registerSourceHandler(ki.nativeSourceHandler);ts.registerTech("Html5",ki);const yO=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],cw={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},bE=["tiny","xsmall","small","medium","large","xlarge","huge"],bT={};bE.forEach(r=>{const e=r.charAt(0)==="x"?`x-${r.substring(1)}`:r;bT[r]=`vjs-layout-${e}`});const LV={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0};let Ps=class t0 extends Vt{constructor(e,t,i){if(e.id=e.id||t.id||`vjs_video_${_c()}`,t=Object.assign(t0.getTagSettings(e),t),t.initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language){const a=e.closest("[lang]");a&&(t.language=a.getAttribute("lang"))}if(super(null,t,i),this.boundDocumentFullscreenChange_=a=>this.documentFullscreenChange_(a),this.boundFullWindowOnEscKey_=a=>this.fullWindowOnEscKey(a),this.boundUpdateStyleEl_=a=>this.updateStyleEl_(a),this.boundApplyInitTime_=a=>this.applyInitTime_(a),this.boundUpdateCurrentBreakpoint_=a=>this.updateCurrentBreakpoint_(a),this.boundHandleTechClick_=a=>this.handleTechClick_(a),this.boundHandleTechDoubleClick_=a=>this.handleTechDoubleClick_(a),this.boundHandleTechTouchStart_=a=>this.handleTechTouchStart_(a),this.boundHandleTechTouchMove_=a=>this.handleTechTouchMove_(a),this.boundHandleTechTouchEnd_=a=>this.handleTechTouchEnd_(a),this.boundHandleTechTap_=a=>this.handleTechTap_(a),this.boundUpdatePlayerHeightOnAudioOnlyMode_=a=>this.updatePlayerHeightOnAudioOnlyMode_(a),this.isFullscreen_=!1,this.log=ek(this.id_),this.fsApi_=ax,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={controlBarHeight:null,playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=e,this.tagAttributes=e&&xp(e),this.language(this.options_.language),t.languages){const a={};Object.getOwnPropertyNames(t.languages).forEach(function(c){a[c.toLowerCase()]=t.languages[c]}),this.languages_=a}else this.languages_=t0.prototype.options_.languages;this.resetCache_(),this.poster_=t.poster||"",this.controls_=!!t.controls,e.controls=!1,e.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],e.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),t.plugins&&Object.keys(t.plugins).forEach(a=>{if(typeof this[a]!="function")throw new Error(`plugin "${a}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),q2(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(Wu(ot,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const n=Yr(this.options_);if(t.plugins&&Object.keys(t.plugins).forEach(a=>{this[a](t.plugins[a])}),t.debug&&this.debug(!0),this.options_.playerOptions=n,this.middleware_=[],this.playbackRates(t.playbackRates),t.experimentalSvgIcons){const c=new Z.DOMParser().parseFromString(tV,"image/svg+xml");if(c.querySelector("parsererror"))Zn.warn("Failed to load SVG Icons. Falling back to Font Icons."),this.options_.experimentalSvgIcons=null;else{const m=c.documentElement;m.style.display="none",this.el_.appendChild(m),this.addClass("vjs-svg-icons-enabled")}}this.initChildren(),this.isAudio(e.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),t.spatialNavigation&&t.spatialNavigation.enabled&&(this.spatialNavigation=new iV(this),this.addClass("vjs-spatial-navigation-enabled")),E_&&this.addClass("vjs-touch-enabled"),Fo||this.addClass("vjs-workinghover"),t0.players[this.id_]=this;const s=lE.split(".")[0];this.addClass(`vjs-v${s}`),this.userActive(!0),this.reportUserActivity(),this.one("play",a=>this.listenForUserActivity_(a)),this.on("keydown",a=>this.handleKeyDown(a)),this.on("languagechange",a=>this.handleLanguagechange(a)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose"),this.off("dispose"),Bo(ot,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),Bo(ot,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),t0.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),K9(this),cl.names.forEach(e=>{const t=cl[e],i=this[t.getterName]();i&&i.off&&i.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let e=this.tag,t,i=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");const n=this.tag.tagName.toLowerCase()==="video-js";i?t=this.el_=e.parentNode:n||(t=this.el_=super.createEl("div"));const s=xp(e);if(n){for(t=this.el_=e,e=this.tag=ot.createElement("video");t.children.length;)e.appendChild(t.firstChild);c_(t,"video-js")||Hm(t,"video-js"),t.appendChild(e),i=this.playerElIngest_=t,Object.keys(t).forEach(h=>{try{e[h]=t[h]}catch{}})}e.setAttribute("tabindex","-1"),s.tabindex="-1",bh&&Jx&&(e.setAttribute("role","application"),s.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in s&&delete s.width,"height"in s&&delete s.height,Object.getOwnPropertyNames(s).forEach(function(h){n&&h==="class"||t.setAttribute(h,s[h]),n&&e.setAttribute(h,s[h])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=t.player=this,this.addClass("vjs-paused");const a=["IS_SMART_TV","IS_TIZEN","IS_WEBOS","IS_ANDROID","IS_IPAD","IS_IPHONE","IS_CHROMECAST_RECEIVER"].filter(h=>lk[h]).map(h=>"vjs-device-"+h.substring(3).toLowerCase().replace(/\_/g,"-"));if(this.addClass(...a),Z.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=Sk("vjs-styles-dimensions");const h=Lp(".vjs-styles-defaults"),m=Lp("head");m.insertBefore(this.styleEl_,h?h.nextSibling:m.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const c=e.getElementsByTagName("a");for(let h=0;h<c.length;h++){const m=c.item(h);Hm(m,"vjs-hidden"),m.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!i&&e.parentNode.insertBefore(t,e),cE(e,t),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=t,t}crossOrigin(e){if(typeof e>"u")return this.techGet_("crossOrigin");if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){Zn.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,t){const i=e+"_";if(t===void 0)return this[i]||0;if(t===""||t==="auto"){this[i]=void 0,this.updateStyleEl_();return}const n=parseFloat(t);if(isNaN(n)){Zn.error(`Improper value "${t}" supplied for for ${e}`);return}this[i]=n,this.updateStyleEl_()}fluid(e){if(e===void 0)return!!this.fluid_;this.fluid_=!!e,xf(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),D9(this,()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(Z.VIDEOJS_NO_DYNAMIC_STYLE===!0){const c=typeof this.width_=="number"?this.width_:this.options_.width,h=typeof this.height_=="number"?this.height_:this.options_.height,m=this.tech_&&this.tech_.el();m&&(c>=0&&(m.width=c),h>=0&&(m.height=h));return}let e,t,i,n;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?i=this.aspectRatio_:this.videoWidth()>0?i=this.videoWidth()+":"+this.videoHeight():i="16:9";const s=i.split(":"),a=s[1]/s[0];this.width_!==void 0?e=this.width_:this.height_!==void 0?e=this.height_/a:e=this.videoWidth()||300,this.height_!==void 0?t=this.height_:t=e*a,/^[^a-zA-Z]/.test(this.id())?n="dimensions-"+this.id():n=this.id()+"-dimensions",this.addClass(n),Ak(this.styleEl_,`
      .${n} {
        width: ${e}px;
        height: ${t}px;
      }

      .${n}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${a*100}%;
      }
    `)}loadTech_(e,t){this.tech_&&this.unloadTech_();const i=Zs(e),n=e.charAt(0).toLowerCase()+e.slice(1);i!=="Html5"&&this.tag&&(ts.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=i,this.isReady_=!1;let s=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(s=!1);const a={source:t,autoplay:s,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${n}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};cl.names.forEach(h=>{const m=cl[h];a[m.getterName]=this[m.privateName]}),Object.assign(a,this.options_[i]),Object.assign(a,this.options_[n]),Object.assign(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(a.startTime=this.cache_.currentTime);const c=ts.getTech(e);if(!c)throw new Error(`No Tech named '${i}' exists! '${i}' should be registered using videojs.registerTech()'`);this.tech_=new c(a),this.tech_.ready(us(this,this.handleTechReady_),!0),gE.jsonToTextTracks(this.textTracksJson_||[],this.tech_),yO.forEach(h=>{this.on(this.tech_,h,m=>this[`handleTech${Zs(h)}_`](m))}),Object.keys(cw).forEach(h=>{this.on(this.tech_,h,m=>{if(this.tech_.playbackRate()===0&&this.tech_.seeking()){this.queuedCallbacks_.push({callback:this[`handleTech${cw[h]}_`].bind(this),event:m});return}this[`handleTech${cw[h]}_`](m)})}),this.on(this.tech_,"loadstart",h=>this.handleTechLoadStart_(h)),this.on(this.tech_,"sourceset",h=>this.handleTechSourceset_(h)),this.on(this.tech_,"waiting",h=>this.handleTechWaiting_(h)),this.on(this.tech_,"ended",h=>this.handleTechEnded_(h)),this.on(this.tech_,"seeking",h=>this.handleTechSeeking_(h)),this.on(this.tech_,"play",h=>this.handleTechPlay_(h)),this.on(this.tech_,"pause",h=>this.handleTechPause_(h)),this.on(this.tech_,"durationchange",h=>this.handleTechDurationChange_(h)),this.on(this.tech_,"fullscreenchange",(h,m)=>this.handleTechFullscreenChange_(h,m)),this.on(this.tech_,"fullscreenerror",(h,m)=>this.handleTechFullscreenError_(h,m)),this.on(this.tech_,"enterpictureinpicture",h=>this.handleTechEnterPictureInPicture_(h)),this.on(this.tech_,"leavepictureinpicture",h=>this.handleTechLeavePictureInPicture_(h)),this.on(this.tech_,"error",h=>this.handleTechError_(h)),this.on(this.tech_,"posterchange",h=>this.handleTechPosterChange_(h)),this.on(this.tech_,"textdata",h=>this.handleTechTextData_(h)),this.on(this.tech_,"ratechange",h=>this.handleTechRateChange_(h)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(i!=="Html5"||!this.tag)&&cE(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){cl.names.forEach(e=>{const t=cl[e];this[t.privateName]=this[t.getterName]()}),this.textTracksJson_=gE.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return e===void 0&&Zn.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}version(){return{"video.js":lE}}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(e){if(!this.tech_||typeof e!="string")return;const t=()=>{const n=this.muted();this.muted(!0);const s=()=>{this.muted(n)};this.playTerminatedQueue_.push(s);const a=this.play();if(h_(a))return a.catch(c=>{throw s(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${c||""}`)})};let i;if(e==="any"&&!this.muted()?(i=this.play(),h_(i)&&(i=i.catch(t))):e==="muted"&&!this.muted()?i=t():i=this.play(),!!h_(i))return i.then(()=>{this.trigger({type:"autoplay-success",autoplay:e})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:e})})}updateSourceCaches_(e=""){let t=e,i="";typeof t!="string"&&(t=e.src,i=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!i&&(i=eV(this,t)),this.cache_.source=Yr({},e,{src:t,type:i});const n=this.cache_.sources.filter(h=>h.src&&h.src===t),s=[],a=this.$$("source"),c=[];for(let h=0;h<a.length;h++){const m=xp(a[h]);s.push(m),m.src&&m.src===t&&c.push(m.src)}c.length&&!n.length?this.cache_.sources=s:n.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t}handleTechSourceset_(e){if(!this.changingSrc_){let t=s=>this.updateSourceCaches_(s);const i=this.currentSource().src,n=e.src;i&&!/^blob:/.test(i)&&/^blob:/.test(n)&&(!this.lastSource_||this.lastSource_.tech!==n&&this.lastSource_.player!==i)&&(t=()=>{}),t(n),e.src||this.tech_.any(["sourceset","loadstart"],s=>{if(s.type==="sourceset")return;const a=this.techGet_("currentSrc");this.lastSource_.tech=a,this.updateSourceCaches_(a)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})}hasStarted(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(e=>e.callback(e.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),t=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",t))};this.on("timeupdate",t)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){this.controls_&&(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,e):this.paused()?uh(this.play()):this.pause())}handleTechDoubleClick_(e){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),i=>i.contains(e.target))||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isInPictureInPicture()&&!ot.pictureInPictureElement?this.exitPictureInPicture():this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(e){const t=e.target.player;if(t&&t!==this)return;const i=this.el();let n=ot[this.fsApi_.fullscreenElement]===i;!n&&i.matches&&(n=i.matches(":"+this.fsApi_.fullscreen)),this.isFullscreen(n)}handleTechFullscreenChange_(e,t){t&&(t.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(t.isFullscreen))}handleTechFullscreenError_(e,t){this.trigger("fullscreenerror",t)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){const e=this.tech_.error();e&&this.error(e)}handleTechTextData_(){let e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(e,t){this.ready(function(){if(e in Y9)return q9(this.middleware_,this.tech_,e,t);if(e in wI)return AI(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(i){throw Zn(i),i}},!0)}techGet_(e){if(!(!this.tech_||!this.tech_.isReady_)){if(e in X9)return W9(this.middleware_,this.tech_,e);if(e in wI)return AI(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){throw this.tech_[e]===void 0?(Zn(`Video.js: ${e} method not defined for ${this.techName_} playback technology.`,t),t):t.name==="TypeError"?(Zn(`Video.js: ${e} unavailable on ${this.techName_} playback technology element.`,t),this.tech_.isReady_=!1,t):(Zn(t),t)}}}play(){return new Promise(e=>{this.play_(e)})}play_(e=uh){this.playCallbacks_.push(e);const t=!!(!this.changingSrc_&&(this.src()||this.currentSrc())),i=!!(tS||Fo);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!t){this.waitToPlay_=a=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!t&&i&&this.load();return}const n=this.techGet_("play");i&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),n===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(n)}runPlayTerminatedQueue_(){const e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(t){t()})}runPlayCallbacks_(e){const t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach(function(i){i(e)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||Yc(0,0)}scrubbing(e){if(typeof e>"u")return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){if(e===void 0)return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime;if(e<0&&(e=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e),this.cache_.initTime=0,isFinite(e)&&(this.cache_.currentTime=Number(e))}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return(!e||!e.length)&&(e=Yc(0,0)),e}seekable(){let e=this.techGet_("seekable");return(!e||!e.length)&&(e=Yc(0,0)),e}seeking(){return this.techGet_("seeking")}ended(){return this.techGet_("ended")}networkState(){return this.techGet_("networkState")}readyState(){return this.techGet_("readyState")}bufferedPercent(){return Rk(this.buffered(),this.duration())}bufferedEnd(){const e=this.buffered(),t=this.duration();let i=e.end(e.length-1);return i>t&&(i=t),i}volume(e){let t;if(e!==void 0){t=Math.max(0,Math.min(1,e)),this.cache_.volume=t,this.techCall_("setVolume",t),t>0&&this.lastVolume_(t);return}return t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t}muted(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1}defaultMuted(e){return e!==void 0&&this.techCall_("setDefaultMuted",e),this.techGet_("defaultMuted")||!1}lastVolume_(e){if(e!==void 0&&e!==0){this.cache_.lastVolume=e;return}return this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){if(e!==void 0){const t=this.isFullscreen_;this.isFullscreen_=!!e,this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_}requestFullscreen(e){this.isInPictureInPicture()&&this.exitPictureInPicture();const t=this;return new Promise((i,n)=>{function s(){t.off("fullscreenerror",c),t.off("fullscreenchange",a)}function a(){s(),i()}function c(m,v){s(),n(v)}t.one("fullscreenchange",a),t.one("fullscreenerror",c);const h=t.requestFullscreenHelper_(e);h&&(h.then(s,s),h.then(i,n))})}requestFullscreenHelper_(e){let t;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(t=e)),this.fsApi_.requestFullscreen){const i=this.el_[this.fsApi_.requestFullscreen](t);return i&&i.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),i}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const e=this;return new Promise((t,i)=>{function n(){e.off("fullscreenerror",a),e.off("fullscreenchange",s)}function s(){n(),t()}function a(h,m){n(),i(m)}e.one("fullscreenchange",s),e.one("fullscreenerror",a);const c=e.exitFullscreenHelper_();c&&(c.then(n,n),c.then(t,i))})}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const e=ot[this.fsApi_.exitFullscreen]();return e&&uh(e.then(()=>this.isFullscreen(!1))),e}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=ot.documentElement.style.overflow,Wu(ot,"keydown",this.boundFullWindowOnEscKey_),ot.documentElement.style.overflow="hidden",Hm(ot.body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){e.key==="Escape"&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,Bo(ot,"keydown",this.boundFullWindowOnEscKey_),ot.documentElement.style.overflow=this.docOrigOverflow,iS(ot.body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(e===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){if(e!==void 0){this.isInPictureInPicture_=!!e,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&Z.documentPictureInPicture){const e=ot.createElement(this.el().tagName);return e.classList=this.el().classList,e.classList.add("vjs-pip-container"),this.posterImage&&e.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&e.appendChild(this.titleBar.el().cloneNode(!0)),e.appendChild(cn("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),Z.documentPictureInPicture.requestWindow({width:this.videoWidth(),height:this.videoHeight()}).then(t=>(bk(t),this.el_.parentNode.insertBefore(e,this.el_),t.document.body.appendChild(this.el_),t.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger({type:"enterpictureinpicture",pipWindow:t}),t.addEventListener("pagehide",i=>{const n=i.target.querySelector(".video-js");e.parentNode.replaceChild(n,e),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")}),t))}return"pictureInPictureEnabled"in ot&&this.disablePictureInPicture()===!1?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){if(Z.documentPictureInPicture&&Z.documentPictureInPicture.window)return Z.documentPictureInPicture.window.close(),Promise.resolve();if("pictureInPictureEnabled"in ot)return ot.exitPictureInPicture()}handleKeyDown(e){const{userActions:t}=this.options_;!t||!t.hotkeys||(n=>{const s=n.tagName.toLowerCase();if(n.isContentEditable)return!0;const a=["button","checkbox","hidden","radio","reset","submit"];return s==="input"?a.indexOf(n.type)===-1:["textarea"].indexOf(s)!==-1})(this.el_.ownerDocument.activeElement)||(typeof t.hotkeys=="function"?t.hotkeys.call(this,e):this.handleHotkeys(e))}handleHotkeys(e){const t=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:i=a=>e.key.toLowerCase()==="f",muteKey:n=a=>e.key.toLowerCase()==="m",playPauseKey:s=a=>e.key.toLowerCase()==="k"||e.key.toLowerCase()===" "}=t;if(i.call(this,e)){e.preventDefault(),e.stopPropagation();const a=Vt.getComponent("FullscreenToggle");ot[this.fsApi_.fullscreenEnabled]!==!1&&a.prototype.handleClick.call(this,e)}else n.call(this,e)?(e.preventDefault(),e.stopPropagation(),Vt.getComponent("MuteToggle").prototype.handleClick.call(this,e)):s.call(this,e)&&(e.preventDefault(),e.stopPropagation(),Vt.getComponent("PlayToggle").prototype.handleClick.call(this,e))}canPlayType(e){let t;for(let i=0,n=this.options_.techOrder;i<n.length;i++){const s=n[i];let a=ts.getTech(s);if(a||(a=Vt.getComponent(s)),!a){Zn.error(`The "${s}" tech is undefined. Skipped browser support check for that tech.`);continue}if(a.isSupported()&&(t=a.canPlayType(e),t))return t}return""}selectSource(e){const t=this.options_.techOrder.map(c=>[c,ts.getTech(c)]).filter(([c,h])=>h?h.isSupported():(Zn.error(`The "${c}" tech is undefined. Skipped browser support check for that tech.`),!1)),i=function(c,h,m){let v;return c.some(b=>h.some(x=>{if(v=m(b,x),v)return!0})),v};let n;const s=c=>(h,m)=>c(m,h),a=([c,h],m)=>{if(h.canPlaySource(m,this.options_[c.toLowerCase()]))return{source:m,tech:c}};return this.options_.sourceOrder?n=i(e,t,s(a)):n=i(t,e,a),n||!1}handleSrc_(e,t){if(typeof e>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const i=Vk(e);if(!i.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,t||(this.cache_.sources=i),this.updateSourceCaches_(i[0]),G9(this,i[0],(n,s)=>{if(this.middleware_=s,t||(this.cache_.sources=i),this.updateSourceCaches_(n),this.src_(n)){if(i.length>1)return this.handleSrc_(i.slice(1));this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),this.triggerReady();return}$9(s,this.tech_)}),i.length>1){const n=()=>{this.error(null),this.handleSrc_(i.slice(1),!0)},s=()=>{this.off("error",n)};this.one("error",n),this.one("playing",s),this.resetRetryOnError_=()=>{this.off("error",n),this.off("playing",s)}}}src(e){return this.handleSrc_(e,!1)}src_(e){const t=this.selectSource([e]);return t?Dk(t.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(t.tech,t.source),this.tech_.ready(()=>{this.changingSrc_=!1}),!1):!0}addSourceElement(e,t){return this.tech_?this.tech_.addSourceElement(e,t):!1}removeSourceElement(e){return this.tech_?this.tech_.removeSourceElement(e):!1}load(){if(this.tech_&&this.tech_.vhs){this.src(this.currentSource());return}this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{const e=this.play();uh(e.then(()=>this.doReset_()))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),this.error(null),this.titleBar&&this.titleBar.update({title:void 0,description:void 0}),xf(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{currentTimeDisplay:e,durationDisplay:t,progressControl:i,remainingTimeDisplay:n}=this.controlBar||{},{seekBar:s}=i||{};e&&e.updateContent(),t&&t.updateContent(),n&&n.updateContent(),s&&(s.update(),s.loadProgressBar&&s.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const e=this.currentSource(),t=[];return Object.keys(e).length!==0&&t.push(e),this.cache_.sources||t}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){if(e!==void 0){this.techCall_("setPreload",e),this.options_.preload=e;return}return this.techGet_("preload")}autoplay(e){if(e===void 0)return this.options_.autoplay||!1;let t;typeof e=="string"&&/(any|play|muted)/.test(e)||e===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_(typeof e=="string"?e:"play"),t=!1):e?this.options_.autoplay=!0:this.options_.autoplay=!1,t=typeof t>"u"?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)}playsinline(e){return e!==void 0&&(this.techCall_("setPlaysinline",e),this.options_.playsinline=e),this.techGet_("playsinline")}loop(e){if(e!==void 0){this.techCall_("setLoop",e),this.options_.loop=e;return}return this.techGet_("loop")}poster(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(e){if(e===void 0)return this.error_||null;if(Pp("beforeerror").forEach(t=>{const i=t(this,e);if(!(_h(i)&&!Array.isArray(i)||typeof i=="string"||typeof i=="number"||i===null)){this.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=i}),this.options_.suppressNotSupportedError&&e&&e.code===4){const t=function(){this.error(e)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),this.one("loadstart",function(){this.off(["click","touchstart"],t)});return}if(e===null){this.error_=null,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new Hs(e),this.addClass("vjs-error"),Zn.error(`(CODE:${this.error_.code} ${Hs.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),Pp("error").forEach(t=>t(this,this.error_))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(e===void 0)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(t){t.stopPropagation(),t.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let e,t,i;const n=us(this,this.reportUserActivity),s=function(b){(b.screenX!==t||b.screenY!==i)&&(t=b.screenX,i=b.screenY,n())},a=function(){n(),this.clearInterval(e),e=this.setInterval(n,250)},c=function(b){n(),this.clearInterval(e)};this.on("mousedown",a),this.on("mousemove",s),this.on("mouseup",c),this.on("mouseleave",c);const h=this.getChild("controlBar");h&&!Fo&&!Kc&&(h.on("mouseenter",function(b){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),h.on("mouseleave",function(b){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",n),this.on("keyup",n);let m;const v=function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(m);const b=this.options_.inactivityTimeout;b<=0||(m=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},b))};this.setInterval(v,250)}playbackRate(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_}updatePlayerHeightOnAudioOnlyMode_(){const e=this.getChild("ControlBar");!e||this.audioOnlyCache_.controlBarHeight===e.currentHeight()||(this.audioOnlyCache_.controlBarHeight=e.currentHeight(),this.height(this.audioOnlyCache_.controlBarHeight))}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),t=this.getChild("ControlBar"),i=t&&t.currentHeight();e.forEach(n=>{n!==t&&n.el_&&!n.hasClass("vjs-hidden")&&(n.hide(),this.audioOnlyCache_.hiddenChildren.push(n))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.audioOnlyCache_.controlBarHeight=i,this.on("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.height(i),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.off("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.audioOnlyCache_.hiddenChildren.forEach(e=>e.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if(typeof e!="boolean"||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e,e){const t=[];return this.isInPictureInPicture()&&t.push(this.exitPictureInPicture()),this.isFullscreen()&&t.push(this.exitFullscreen()),this.audioPosterMode()&&t.push(this.audioPosterMode(!1)),Promise.all(t).then(()=>this.enableAudioOnlyUI_())}return Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){return typeof e!="boolean"||e===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=e,e?this.audioOnlyMode()?this.audioOnlyMode(!1).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()}))}addTextTrack(e,t,i){if(this.tech_)return this.tech_.addTextTrack(e,t,i)}addRemoteTextTrack(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)}removeRemoteTextTrack(e={}){let{track:t}=e;if(t||(t=e),this.tech_)return this.tech_.removeRemoteTextTrack(t)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(e===void 0)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),xf(this)&&this.trigger("languagechange"))}languages(){return Yr(t0.prototype.options_.languages,this.languages_)}toJSON(){const e=Yr(this.options_),t=e.tracks;e.tracks=[];for(let i=0;i<t.length;i++){let n=t[i];n=Yr(n),n.player=void 0,e.tracks[i]=n}return e}createModal(e,t){t=t||{},t.content=e||"";const i=new nv(this,t);return this.addChild(i),i.on("dispose",()=>{this.removeChild(i)}),i.open(),i}updateCurrentBreakpoint_(){if(!this.responsive())return;const e=this.currentBreakpoint(),t=this.currentWidth();for(let i=0;i<bE.length;i++){const n=bE[i],s=this.breakpoints_[n];if(t<=s){if(e===n)return;e&&this.removeClass(bT[e]),this.addClass(bT[n]),this.breakpoint_=n;break}}}removeCurrentBreakpoint_(){const e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return e===void 0?Object.assign(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Object.assign({},LV,e),this.updateCurrentBreakpoint_(),Object.assign(this.breakpoints_))}responsive(e){if(e===void 0)return this.responsive_;e=!!e;const t=this.responsive_;if(e!==t)return this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return bT[this.breakpoint_]||""}loadMedia(e,t){if(!e||typeof e!="object")return;const i=this.crossOrigin();this.reset(),this.cache_.media=Yr(e);const{artist:n,artwork:s,description:a,poster:c,src:h,textTracks:m,title:v}=this.cache_.media;!s&&c&&(this.cache_.media.artwork=[{src:c,type:mx(c)}]),i&&this.crossOrigin(i),h&&this.src(h),c&&this.poster(c),Array.isArray(m)&&m.forEach(b=>this.addRemoteTextTrack(b,!1)),this.titleBar&&this.titleBar.update({title:v,description:a||n||""}),this.ready(t)}getMedia(){if(!this.cache_.media){const e=this.poster(),t=this.currentSources(),i=Array.prototype.map.call(this.remoteTextTracks(),s=>({kind:s.kind,label:s.label,language:s.language,src:s.src})),n={src:t,textTracks:i};return e&&(n.poster=e,n.artwork=[{src:n.poster,type:mx(n.poster)}]),n}return Yr(this.cache_.media)}static getTagSettings(e){const t={sources:[],tracks:[]},i=xp(e),n=i["data-setup"];if(c_(e,"vjs-fill")&&(i.fill=!0),c_(e,"vjs-fluid")&&(i.fluid=!0),n!==null)try{Object.assign(i,JSON.parse(n||"{}"))}catch(s){Zn.error("data-setup",s)}if(Object.assign(t,i),e.hasChildNodes()){const s=e.childNodes;for(let a=0,c=s.length;a<c;a++){const h=s[a],m=h.nodeName.toLowerCase();m==="source"?t.sources.push(xp(h)):m==="track"&&t.tracks.push(xp(h))}}return t}debug(e){if(e===void 0)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(e===void 0)return this.cache_.playbackRates;Array.isArray(e)&&e.every(t=>typeof t=="number")&&(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}};Ps.prototype.videoTracks=()=>{};Ps.prototype.audioTracks=()=>{};Ps.prototype.textTracks=()=>{};Ps.prototype.remoteTextTracks=()=>{};Ps.prototype.remoteTextTrackEls=()=>{};cl.names.forEach(function(r){const e=cl[r];Ps.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}});Ps.prototype.crossorigin=Ps.prototype.crossOrigin;Ps.players={};const jy=Z.navigator;Ps.prototype.options_={techOrder:ts.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:jy&&(jy.languages&&jy.languages[0]||jy.userLanguage||jy.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1,spatialNavigation:{enabled:!1,horizontalSeek:!1},enableSmoothSeeking:!1,disableSeekWhileScrubbingOnMobile:!1,disableSeekWhileScrubbingOnSTV:!1};yO.forEach(function(r){Ps.prototype[`handleTech${Zs(r)}_`]=function(){return this.trigger(r)}});Vt.registerComponent("Player",Ps);const gx="plugin",v0="activePlugins_",n0={},vx=r=>n0.hasOwnProperty(r),TT=r=>vx(r)?n0[r]:void 0,_O=(r,e)=>{r[v0]=r[v0]||{},r[v0][e]=!0},yx=(r,e,t)=>{const i=(t?"before":"")+"pluginsetup";r.trigger(i,e),r.trigger(i+":"+e.name,e)},RV=function(r,e){const t=function(){yx(this,{name:r,plugin:e,instance:null},!0);const i=e.apply(this,arguments);return _O(this,r),yx(this,{name:r,plugin:e,instance:i}),i};return Object.keys(e).forEach(function(i){t[i]=e[i]}),t},zI=(r,e)=>(e.prototype.name=r,function(...t){yx(this,{name:r,plugin:e,instance:null},!0);const i=new e(this,...t);return this[r]=()=>i,yx(this,i.getEventHash()),i});let xh=class xT{constructor(e){if(this.constructor===xT)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),q2(this),delete this.trigger,Mk(this,this.constructor.defaultState),_O(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(e={}){return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e,t={}){return iv(this.eventBusEl_,e,this.getEventHash(t))}handleStateChanged(e){}dispose(){const{name:e,player:t}=this;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[v0][e]=!1,this.player=this.state=null,t[e]=zI(e,n0[e])}static isBasic(e){const t=typeof e=="string"?TT(e):e;return typeof t=="function"&&!xT.prototype.isPrototypeOf(t.prototype)}static registerPlugin(e,t){if(typeof e!="string")throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(vx(e))Zn.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if(Ps.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if(typeof t!="function")throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof t}.`);return n0[e]=t,e!==gx&&(xT.isBasic(t)?Ps.prototype[e]=RV(e,t):Ps.prototype[e]=zI(e,t)),t}static deregisterPlugin(e){if(e===gx)throw new Error("Cannot de-register base plugin.");vx(e)&&(delete n0[e],delete Ps.prototype[e])}static getPlugins(e=Object.keys(n0)){let t;return e.forEach(i=>{const n=TT(i);n&&(t=t||{},t[i]=n)}),t}static getPluginVersion(e){const t=TT(e);return t&&t.VERSION||""}};xh.getPlugin=TT;xh.BASE_PLUGIN_NAME=gx;xh.registerPlugin(gx,xh);Ps.prototype.usingPlugin=function(r){return!!this[v0]&&this[v0][r]===!0};Ps.prototype.hasPlugin=function(r){return!!vx(r)};function kV(r,e){let t=!1;return function(...i){return t||Zn.warn(r),t=!0,e.apply(this,i)}}function ed(r,e,t,i){return kV(`${e} is deprecated and will be removed in ${r}.0; please use ${t} instead.`,i)}var OV={NetworkBadStatus:"networkbadstatus",NetworkRequestFailed:"networkrequestfailed",NetworkRequestAborted:"networkrequestaborted",NetworkRequestTimeout:"networkrequesttimeout",NetworkBodyParserFailed:"networkbodyparserfailed",StreamingHlsPlaylistParserError:"streaminghlsplaylistparsererror",StreamingDashManifestParserError:"streamingdashmanifestparsererror",StreamingContentSteeringParserError:"streamingcontentsteeringparsererror",StreamingVttParserError:"streamingvttparsererror",StreamingFailedToSelectNextSegment:"streamingfailedtoselectnextsegment",StreamingFailedToDecryptSegment:"streamingfailedtodecryptsegment",StreamingFailedToTransmuxSegment:"streamingfailedtotransmuxsegment",StreamingFailedToAppendSegment:"streamingfailedtoappendsegment",StreamingCodecsChangeError:"streamingcodecschangeerror"};const bO=r=>r.indexOf("#")===0?r.slice(1):r;function ft(r,e,t){let i=ft.getPlayer(r);if(i)return e&&Zn.warn(`Player "${r}" is already initialised. Options will not be applied.`),t&&i.ready(t),i;const n=typeof r=="string"?Lp("#"+bO(r)):r;if(!tv(n))throw new TypeError("The element or ID supplied is not valid. (videojs)");const a=("getRootNode"in n?n.getRootNode()instanceof Z.ShadowRoot:!1)?n.getRootNode():n.ownerDocument.body;(!n.ownerDocument.defaultView||!a.contains(n))&&Zn.warn("The element supplied is not included in the DOM"),e=e||{},e.restoreEl===!0&&(e.restoreEl=(n.parentNode&&n.parentNode.hasAttribute&&n.parentNode.hasAttribute("data-vjs-player")?n.parentNode:n).cloneNode(!0)),Pp("beforesetup").forEach(h=>{const m=h(n,Yr(e));if(!_h(m)||Array.isArray(m)){Zn.error("please return an object in beforesetup hooks");return}e=Yr(e,m)});const c=Vt.getComponent("Player");return i=new c(n,e,t),Pp("setup").forEach(h=>h(i)),i}ft.hooks_=gf;ft.hooks=Pp;ft.hook=m9;ft.hookOnce=g9;ft.removeHook=JR;if(Z.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&ev()){let r=Lp(".vjs-styles-defaults");if(!r){r=Sk("vjs-styles-defaults");const e=Lp("head");e&&e.insertBefore(r,e.firstChild),Ak(r,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}hE(1,ft);ft.VERSION=lE;ft.options=Ps.prototype.options_;ft.getPlayers=()=>Ps.players;ft.getPlayer=r=>{const e=Ps.players;let t;if(typeof r=="string"){const i=bO(r),n=e[i];if(n)return n;t=Lp("#"+i)}else t=r;if(tv(t)){const{player:i,playerId:n}=t;if(i||e[n])return i||e[n]}};ft.getAllPlayers=()=>Object.keys(Ps.players).map(r=>Ps.players[r]).filter(Boolean);ft.players=Ps.players;ft.getComponent=Vt.getComponent;ft.registerComponent=(r,e)=>(ts.isTech(e)&&Zn.warn(`The ${r} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),Vt.registerComponent.call(Vt,r,e));ft.getTech=ts.getTech;ft.registerTech=ts.registerTech;ft.use=j9;Object.defineProperty(ft,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(ft.middleware,"TERMINATOR",{value:px,writeable:!1,enumerable:!0});ft.browser=lk;ft.obj=_9;ft.mergeOptions=ed(9,"videojs.mergeOptions","videojs.obj.merge",Yr);ft.defineLazyProperty=ed(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",Kx);ft.bind=ed(9,"videojs.bind","native Function.prototype.bind",us);ft.registerPlugin=xh.registerPlugin;ft.deregisterPlugin=xh.deregisterPlugin;ft.plugin=(r,e)=>(Zn.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),xh.registerPlugin(r,e));ft.getPlugins=xh.getPlugins;ft.getPlugin=xh.getPlugin;ft.getPluginVersion=xh.getPluginVersion;ft.addLanguage=function(r,e){return r=(""+r).toLowerCase(),ft.options.languages=Yr(ft.options.languages,{[r]:e}),ft.options.languages[r]};ft.log=Zn;ft.createLogger=ek;ft.time=k9;ft.createTimeRange=ed(9,"videojs.createTimeRange","videojs.time.createTimeRanges",Yc);ft.createTimeRanges=ed(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",Yc);ft.formatTime=ed(9,"videojs.formatTime","videojs.time.formatTime",Km);ft.setFormatTime=ed(9,"videojs.setFormatTime","videojs.time.setFormatTime",Pk);ft.resetFormatTime=ed(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",Lk);ft.parseUrl=ed(9,"videojs.parseUrl","videojs.url.parseUrl",K2);ft.isCrossOrigin=ed(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",uS);ft.EventTarget=qu;ft.any=W2;ft.on=Wu;ft.one=oS;ft.off=Bo;ft.trigger=iv;ft.xhr=BR;ft.TrackList=Zm;ft.TextTrack=$_;ft.TextTrackList=Y2;ft.AudioTrack=Nk;ft.AudioTrackList=kk;ft.VideoTrack=Uk;ft.VideoTrackList=Ok;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(r=>{ft[r]=function(){return Zn.warn(`videojs.${r}() is deprecated; use videojs.dom.${r}() instead`),Tk[r].apply(null,arguments)}});ft.computedStyle=ed(9,"videojs.computedStyle","videojs.dom.computedStyle",V0);ft.dom=Tk;ft.fn=M9;ft.num=cV;ft.str=L9;ft.url=z9;ft.Error=OV;/*! @name videojs-contrib-quality-levels @version 4.1.0 @license Apache-2.0 */class FV{constructor(e){let t=this;return t.id=e.id,t.label=t.id,t.width=e.width,t.height=e.height,t.bitrate=e.bandwidth,t.frameRate=e.frameRate,t.enabled_=e.enabled,Object.defineProperty(t,"enabled",{get(){return t.enabled_()},set(i){t.enabled_(i)}}),t}}class _x extends ft.EventTarget{constructor(){super();let e=this;return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get(){return e.selectedIndex_}}),Object.defineProperty(e,"length",{get(){return e.levels_.length}}),e[Symbol.iterator]=()=>e.levels_.values(),e}addQualityLevel(e){let t=this.getQualityLevelById(e.id);if(t)return t;const i=this.levels_.length;return t=new FV(e),""+i in this||Object.defineProperty(this,i,{get(){return this.levels_[i]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"}),t}removeQualityLevel(e){let t=null;for(let i=0,n=this.length;i<n;i++)if(this[i]===e){t=this.levels_.splice(i,1)[0],this.selectedIndex_===i?this.selectedIndex_=-1:this.selectedIndex_>i&&this.selectedIndex_--;break}return t&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),t}getQualityLevelById(e){for(let t=0,i=this.length;t<i;t++){const n=this[t];if(n.id===e)return n}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}_x.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const r in _x.prototype.allowedEvents_)_x.prototype["on"+r]=null;var TO="4.1.0";const BV=function(r,e){const t=r.qualityLevels,i=new _x,n=function(){i.dispose(),r.qualityLevels=t,r.off("dispose",n)};return r.on("dispose",n),r.qualityLevels=()=>i,r.qualityLevels.VERSION=TO,i},xO=function(r){return BV(this,ft.obj.merge({},r))};ft.registerPlugin("qualityLevels",xO);xO.VERSION=TO;/*! @name @videojs/http-streaming @version 3.17.0 @license Apache-2.0 */const Zl=qx,bx=(r,e)=>e&&e.responseURL&&r!==e.responseURL?e.responseURL:r,Tc=r=>ft.log.debug?ft.log.debug.bind(ft,"VHS:",`${r} >`):function(){};function Hr(...r){const e=ft.obj||ft;return(e.merge||e.mergeOptions).apply(e,r)}function Ja(...r){const e=ft.time||ft;return(e.createTimeRanges||e.createTimeRanges).apply(e,r)}function NV(r){if(r.length===0)return"Buffered Ranges are empty";let e=`Buffered Ranges: 
`;for(let t=0;t<r.length;t++){const i=r.start(t),n=r.end(t);e+=`${i} --> ${n}. Duration (${n-i})
`}return e}const ch=1/30,dh=ch*3,SO=function(r,e){const t=[];let i;if(r&&r.length)for(i=0;i<r.length;i++)e(r.start(i),r.end(i))&&t.push([r.start(i),r.end(i)]);return Ja(t)},r0=function(r,e){return SO(r,function(t,i){return t-dh<=e&&i+dh>=e})},K1=function(r,e){return SO(r,function(t){return t-ch>=e})},UV=function(r){if(r.length<2)return Ja();const e=[];for(let t=1;t<r.length;t++){const i=r.end(t-1),n=r.start(t);e.push([i,n])}return Ja(e)},VV=function(r,e){let t=null,i=null,n=0;const s=[],a=[];if(!r||!r.length||!e||!e.length)return Ja();let c=r.length;for(;c--;)s.push({time:r.start(c),type:"start"}),s.push({time:r.end(c),type:"end"});for(c=e.length;c--;)s.push({time:e.start(c),type:"start"}),s.push({time:e.end(c),type:"end"});for(s.sort(function(h,m){return h.time-m.time}),c=0;c<s.length;c++)s[c].type==="start"?(n++,n===2&&(t=s[c].time)):s[c].type==="end"&&(n--,n===1&&(i=s[c].time)),t!==null&&i!==null&&(a.push([t,i]),t=null,i=null);return Ja(a)},AO=r=>{const e=[];if(!r||!r.length)return"";for(let t=0;t<r.length;t++)e.push(r.start(t)+" => "+r.end(t));return e.join(", ")},zV=function(r,e,t=1){return((r.length?r.end(r.length-1):0)-e)/t},Bm=r=>{const e=[];for(let t=0;t<r.length;t++)e.push({start:r.start(t),end:r.end(t)});return e},HV=function(r,e){if(r===e)return!1;if(!r&&e||!e&&r||r.length!==e.length)return!0;for(let t=0;t<r.length;t++)if(r.start(t)!==e.start(t)||r.end(t)!==e.end(t))return!0;return!1},dw=function(r){if(!(!r||!r.length||!r.end))return r.end(r.length-1)},pC=function(r,e){let t=0;if(!r||!r.length)return t;for(let i=0;i<r.length;i++){const n=r.start(i),s=r.end(i);if(!(e>s)){if(e>n&&e<=s){t+=s-e;continue}t+=s-n}}return t},mC=(r,e)=>{if(!e.preload)return e.duration;let t=0;return(e.parts||[]).forEach(function(i){t+=i.duration}),(e.preloadHints||[]).forEach(function(i){i.type==="PART"&&(t+=r.partTargetDuration)}),t},TE=r=>(r.segments||[]).reduce((e,t,i)=>(t.parts?t.parts.forEach(function(n,s){e.push({duration:n.duration,segmentIndex:i,partIndex:s,part:n,segment:t})}):e.push({duration:t.duration,segmentIndex:i,partIndex:null,segment:t,part:null}),e),[]),wO=r=>{const e=r.segments&&r.segments.length&&r.segments[r.segments.length-1];return e&&e.parts||[]},EO=({preloadSegment:r})=>{if(!r)return;const{parts:e,preloadHints:t}=r;let i=(t||[]).reduce((n,s)=>n+(s.type==="PART"?1:0),0);return i+=e&&e.length?e.length:0,i},CO=(r,e)=>{if(e.endList)return 0;if(r&&r.suggestedPresentationDelay)return r.suggestedPresentationDelay;const t=wO(e).length>0;return t&&e.serverControl&&e.serverControl.partHoldBack?e.serverControl.partHoldBack:t&&e.partTargetDuration?e.partTargetDuration*3:e.serverControl&&e.serverControl.holdBack?e.serverControl.holdBack:e.targetDuration?e.targetDuration*3:0},jV=function(r,e){let t=0,i=e-r.mediaSequence,n=r.segments[i];if(n){if(typeof n.start<"u")return{result:n.start,precise:!0};if(typeof n.end<"u")return{result:n.end-n.duration,precise:!0}}for(;i--;){if(n=r.segments[i],typeof n.end<"u")return{result:t+n.end,precise:!0};if(t+=mC(r,n),typeof n.start<"u")return{result:t+n.start,precise:!0}}return{result:t,precise:!1}},GV=function(r,e){let t=0,i,n=e-r.mediaSequence;for(;n<r.segments.length;n++){if(i=r.segments[n],typeof i.start<"u")return{result:i.start-t,precise:!0};if(t+=mC(r,i),typeof i.end<"u")return{result:i.end-t,precise:!0}}return{result:-1,precise:!1}},MO=function(r,e,t){if(typeof e>"u"&&(e=r.mediaSequence+r.segments.length),e<r.mediaSequence)return 0;const i=jV(r,e);if(i.precise)return i.result;const n=GV(r,e);return n.precise?n.result:i.result+t},DO=function(r,e,t){if(!r)return 0;if(typeof t!="number"&&(t=0),typeof e>"u"){if(r.totalDuration)return r.totalDuration;if(!r.endList)return Z.Infinity}return MO(r,e,t)},f_=function({defaultDuration:r,durationList:e,startIndex:t,endIndex:i}){let n=0;if(t>i&&([t,i]=[i,t]),t<0){for(let s=t;s<Math.min(0,i);s++)n+=r;t=0}for(let s=t;s<i;s++)n+=e[s].duration;return n},IO=function(r,e,t,i){if(!r||!r.segments)return null;if(r.endList)return DO(r);if(e===null)return null;e=e||0;let n=MO(r,r.mediaSequence+r.segments.length,e);return t&&(i=typeof i=="number"?i:CO(null,r),n-=i),Math.max(0,n)},$V=function(r,e,t){const n=e||0;let s=IO(r,e,!0,t);return s===null?Ja():(s<n&&(s=n),Ja(n,s))},WV=function({playlist:r,currentTime:e,startingSegmentIndex:t,startingPartIndex:i,startTime:n,exactManifestTimings:s}){let a=e-n;const c=TE(r);let h=0;for(let m=0;m<c.length;m++){const v=c[m];if(t===v.segmentIndex&&!(typeof i=="number"&&typeof v.partIndex=="number"&&i!==v.partIndex)){h=m;break}}if(a<0){if(h>0)for(let m=h-1;m>=0;m--){const v=c[m];if(a+=v.duration,s){if(a<0)continue}else if(a+ch<=0)continue;return{partIndex:v.partIndex,segmentIndex:v.segmentIndex,startTime:n-f_({defaultDuration:r.targetDuration,durationList:c,startIndex:h,endIndex:m})}}return{partIndex:c[0]&&c[0].partIndex||null,segmentIndex:c[0]&&c[0].segmentIndex||0,startTime:e}}if(h<0){for(let m=h;m<0;m++)if(a-=r.targetDuration,a<0)return{partIndex:c[0]&&c[0].partIndex||null,segmentIndex:c[0]&&c[0].segmentIndex||0,startTime:e};h=0}for(let m=h;m<c.length;m++){const v=c[m];a-=v.duration;const b=v.duration>ch,x=a===0,C=b&&a+ch>=0;if(!((x||C)&&m!==c.length-1)){if(s){if(a>0)continue}else if(a-ch>=0)continue;return{partIndex:v.partIndex,segmentIndex:v.segmentIndex,startTime:n+f_({defaultDuration:r.targetDuration,durationList:c,startIndex:h,endIndex:m})}}}return{segmentIndex:c[c.length-1].segmentIndex,partIndex:c[c.length-1].partIndex,startTime:e}},PO=function(r){return r.excludeUntil&&r.excludeUntil>Date.now()},gC=function(r){return r.excludeUntil&&r.excludeUntil===1/0},hS=function(r){const e=PO(r);return!r.disabled&&!e},qV=function(r){return r.disabled},XV=function(r){for(let e=0;e<r.segments.length;e++)if(r.segments[e].key)return!0;return!1},LO=function(r,e){return e.attributes&&e.attributes[r]},YV=function(r,e,t,i=0){return LO("BANDWIDTH",t)?(r*t.attributes.BANDWIDTH-i*8)/e:NaN},xE=(r,e)=>{if(r.playlists.length===1)return!0;const t=e.attributes.BANDWIDTH||Number.MAX_VALUE;return r.playlists.filter(i=>hS(i)?(i.attributes.BANDWIDTH||0)<t:!1).length===0},vC=(r,e)=>!r&&!e||!r&&e||r&&!e?!1:!!(r===e||r.id&&e.id&&r.id===e.id||r.resolvedUri&&e.resolvedUri&&r.resolvedUri===e.resolvedUri||r.uri&&e.uri&&r.uri===e.uri),HI=function(r,e){const t=r&&r.mediaGroups&&r.mediaGroups.AUDIO||{};let i=!1;for(const n in t){for(const s in t[n])if(i=e(t[n][s]),i)break;if(i)break}return!!i},Y_=r=>{if(!r||!r.playlists||!r.playlists.length)return HI(r,t=>t.playlists&&t.playlists.length||t.uri);for(let e=0;e<r.playlists.length;e++){const t=r.playlists[e],i=t.attributes&&t.attributes.CODECS;if(!(i&&i.split(",").every(s=>VR(s))||HI(r,s=>vC(t,s))))return!1}return!0};var Jl={liveEdgeDelay:CO,duration:DO,seekable:$V,getMediaInfoForTime:WV,isEnabled:hS,isDisabled:qV,isExcluded:PO,isIncompatible:gC,playlistEnd:IO,isAes:XV,hasAttribute:LO,estimateSegmentRequestTime:YV,isLowestEnabledRendition:xE,isAudioOnly:Y_,playlistMatch:vC,segmentDurationWithParts:mC};const{log:RO}=ft,y0=(r,e)=>`${r}-${e}`,kO=(r,e,t)=>`placeholder-uri-${r}-${e}-${t}`,QV=({onwarn:r,oninfo:e,manifestString:t,customTagParsers:i=[],customTagMappers:n=[],llhls:s})=>{const a=new NU;r&&a.on("warn",r),e&&a.on("info",e),i.forEach(m=>a.addParser(m)),n.forEach(m=>a.addTagMapper(m)),a.push(t),a.end();const c=a.manifest;if(s||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(m){c.hasOwnProperty(m)&&delete c[m]}),c.segments&&c.segments.forEach(function(m){["parts","preloadHints"].forEach(function(v){m.hasOwnProperty(v)&&delete m[v]})})),!c.targetDuration){let m=10;c.segments&&c.segments.length&&(m=c.segments.reduce((v,b)=>Math.max(v,b.duration),0)),r&&r({message:`manifest has no targetDuration defaulting to ${m}`}),c.targetDuration=m}const h=wO(c);if(h.length&&!c.partTargetDuration){const m=h.reduce((v,b)=>Math.max(v,b.duration),0);r&&(r({message:`manifest has no partTargetDuration defaulting to ${m}`}),RO.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),c.partTargetDuration=m}return c},ov=(r,e)=>{r.mediaGroups&&["AUDIO","SUBTITLES"].forEach(t=>{if(r.mediaGroups[t])for(const i in r.mediaGroups[t])for(const n in r.mediaGroups[t][i]){const s=r.mediaGroups[t][i][n];e(s,t,i,n)}})},OO=({playlist:r,uri:e,id:t})=>{r.id=t,r.playlistErrors_=0,e&&(r.uri=e),r.attributes=r.attributes||{}},KV=r=>{let e=r.playlists.length;for(;e--;){const t=r.playlists[e];OO({playlist:t,id:y0(e,t.uri)}),t.resolvedUri=Zl(r.uri,t.uri),r.playlists[t.id]=t,r.playlists[t.uri]=t,t.attributes.BANDWIDTH||RO.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},ZV=r=>{ov(r,e=>{e.uri&&(e.resolvedUri=Zl(r.uri,e.uri))})},JV=(r,e)=>{const t=y0(0,e),i={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:Z.location.href,resolvedUri:Z.location.href,playlists:[{uri:e,id:t,resolvedUri:e,attributes:{}}]};return i.playlists[t]=i.playlists[0],i.playlists[e]=i.playlists[0],i},FO=(r,e,t=kO)=>{r.uri=e;for(let n=0;n<r.playlists.length;n++)if(!r.playlists[n].uri){const s=`placeholder-uri-${n}`;r.playlists[n].uri=s}const i=Y_(r);ov(r,(n,s,a,c)=>{if(!n.playlists||!n.playlists.length){if(i&&s==="AUDIO"&&!n.uri)for(let h=0;h<r.playlists.length;h++){const m=r.playlists[h];if(m.attributes&&m.attributes.AUDIO&&m.attributes.AUDIO===a)return}n.playlists=[zr({},n)]}n.playlists.forEach(function(h,m){const v=t(s,a,c,h),b=y0(m,v);h.uri?h.resolvedUri=h.resolvedUri||Zl(r.uri,h.uri):(h.uri=m===0?v:b,h.resolvedUri=h.uri),h.id=h.id||b,h.attributes=h.attributes||{},r.playlists[h.id]=h,r.playlists[h.uri]=h})}),KV(r),ZV(r)};class jI{constructor(){this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}setOffset(e=[]){if(this.offset_!==null||!e.length)return;const[t]=e;t.programDateTime!==void 0&&(this.offset_=t.programDateTime/1e3)}setPendingDateRanges(e=[]){if(!e.length)return;const[t]=e,i=t.startDate.getTime();this.trimProcessedDateRanges_(i),this.pendingDateRanges_=e.reduce((n,s)=>(n.set(s.id,s),n),new Map)}processDateRange(e){this.pendingDateRanges_.delete(e.id),this.processedDateRanges_.set(e.id,e)}getDateRangesToProcess(){if(this.offset_===null)return[];const e={},t=[];this.pendingDateRanges_.forEach((i,n)=>{if(!this.processedDateRanges_.has(n)&&(i.startTime=i.startDate.getTime()/1e3-this.offset_,i.processDateRange=()=>this.processDateRange(i),t.push(i),!!i.class))if(e[i.class]){const s=e[i.class].push(i);i.classListIndex=s-1}else e[i.class]=[i],i.classListIndex=0});for(const i of t){const n=e[i.class]||[];i.endDate?i.endTime=i.endDate.getTime()/1e3-this.offset_:i.endOnNext&&n[i.classListIndex+1]?i.endTime=n[i.classListIndex+1].startTime:i.duration?i.endTime=i.startTime+i.duration:i.plannedDuration?i.endTime=i.startTime+i.plannedDuration:i.endTime=i.startTime}return t}trimProcessedDateRanges_(e){new Map(this.processedDateRanges_).forEach((i,n)=>{i.startDate.getTime()<e&&this.processedDateRanges_.delete(n)})}}const BO=22,$m=({requestType:r,request:e,error:t,parseFailure:i})=>{const n=e.status<200||e.status>299,s=e.status>=400&&e.status<=499,a={uri:e.uri,requestType:r},c=n&&!s||i;if(t&&s)a.error=zr({},t),a.errorType=ft.Error.NetworkRequestFailed;else if(e.aborted)a.errorType=ft.Error.NetworkRequestAborted;else if(e.timedout)a.erroType=ft.Error.NetworkRequestTimeout;else if(c){const h=i?ft.Error.NetworkBodyParserFailed:ft.Error.NetworkBadStatus;a.errorType=h,a.status=e.status,a.headers=e.headers}return a},ez=Tc("CodecUtils"),NO=function(r){const e=r.attributes||{};if(e.CODECS)return Kd(e.CODECS)},UO=(r,e)=>{const t=e.attributes||{};return r&&r.mediaGroups&&r.mediaGroups.AUDIO&&t.AUDIO&&r.mediaGroups.AUDIO[t.AUDIO]},tz=(r,e)=>{if(!UO(r,e))return!0;const t=e.attributes||{},i=r.mediaGroups.AUDIO[t.AUDIO];for(const n in i)if(!i[n].uri&&!i[n].playlists)return!0;return!1},D_=function(r){const e={};return r.forEach(({mediaType:t,type:i,details:n})=>{e[t]=e[t]||[],e[t].push(UR(`${i}${n}`))}),Object.keys(e).forEach(function(t){if(e[t].length>1){ez(`multiple ${t} codecs found as attributes: ${e[t].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),e[t]=null;return}e[t]=e[t][0]}),e},GI=function(r){let e=0;return r.audio&&e++,r.video&&e++,e},p_=function(r,e){const t=e.attributes||{},i=D_(NO(e)||[]);if(UO(r,e)&&!i.audio&&!tz(r,e)){const n=D_(VU(r,t.AUDIO)||[]);n.audio&&(i.audio=n.audio)}return i},{EventTarget:iz}=ft,nz=(r,e)=>{if(e.endList||!e.serverControl)return r;const t={};if(e.serverControl.canBlockReload){const{preloadSegment:i}=e;let n=e.mediaSequence+e.segments.length;if(i){const s=i.parts||[],a=EO(e)-1;a>-1&&a!==s.length-1&&(t._HLS_part=a),(a>-1||s.length)&&n--}t._HLS_msn=n}if(e.serverControl&&e.serverControl.canSkipUntil&&(t._HLS_skip=e.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(t).length){const i=new Z.URL(r);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(n){t.hasOwnProperty(n)&&i.searchParams.set(n,t[n])}),r=i.toString()}return r},rz=(r,e)=>{if(!r)return e;const t=Hr(r,e);if(r.preloadHints&&!e.preloadHints&&delete t.preloadHints,r.parts&&!e.parts)delete t.parts;else if(r.parts&&e.parts)for(let i=0;i<e.parts.length;i++)r.parts&&r.parts[i]&&(t.parts[i]=Hr(r.parts[i],e.parts[i]));return!r.skipped&&e.skipped&&(t.skipped=!1),r.preload&&!e.preload&&(t.preload=!1),t},sz=(r,e,t)=>{const i=r.slice(),n=e.slice();t=t||0;const s=[];let a;for(let c=0;c<n.length;c++){const h=i[c+t],m=n[c];h?(a=h.map||a,s.push(rz(h,m))):(a&&!m.map&&(m.map=a),s.push(m))}return s},VO=(r,e)=>{!r.resolvedUri&&r.uri&&(r.resolvedUri=Zl(e,r.uri)),r.key&&!r.key.resolvedUri&&(r.key.resolvedUri=Zl(e,r.key.uri)),r.map&&!r.map.resolvedUri&&(r.map.resolvedUri=Zl(e,r.map.uri)),r.map&&r.map.key&&!r.map.key.resolvedUri&&(r.map.key.resolvedUri=Zl(e,r.map.key.uri)),r.parts&&r.parts.length&&r.parts.forEach(t=>{t.resolvedUri||(t.resolvedUri=Zl(e,t.uri))}),r.preloadHints&&r.preloadHints.length&&r.preloadHints.forEach(t=>{t.resolvedUri||(t.resolvedUri=Zl(e,t.uri))})},zO=function(r){const e=r.segments||[],t=r.preloadSegment;if(t&&t.parts&&t.parts.length){if(t.preloadHints){for(let i=0;i<t.preloadHints.length;i++)if(t.preloadHints[i].type==="MAP")return e}t.duration=r.targetDuration,t.preload=!0,e.push(t)}return e},HO=(r,e)=>r===e||r.segments&&e.segments&&r.segments.length===e.segments.length&&r.endList===e.endList&&r.mediaSequence===e.mediaSequence&&r.preloadSegment===e.preloadSegment,SE=(r,e,t=HO)=>{const i=Hr(r,{}),n=i.playlists[e.id];if(!n||t(n,e))return null;e.segments=zO(e);const s=Hr(n,e);if(s.preloadSegment&&!e.preloadSegment&&delete s.preloadSegment,n.segments){if(e.skip){e.segments=e.segments||[];for(let a=0;a<e.skip.skippedSegments;a++)e.segments.unshift({skipped:!0})}s.segments=sz(n.segments,e.segments,e.mediaSequence-n.mediaSequence)}s.segments.forEach(a=>{VO(a,s.resolvedUri)});for(let a=0;a<i.playlists.length;a++)i.playlists[a].id===e.id&&(i.playlists[a]=s);return i.playlists[e.id]=s,i.playlists[e.uri]=s,ov(r,(a,c,h,m)=>{if(a.playlists)for(let v=0;v<a.playlists.length;v++)e.id===a.playlists[v].id&&(a.playlists[v]=s)}),i},AE=(r,e)=>{const t=r.segments||[],i=t[t.length-1],n=i&&i.parts&&i.parts[i.parts.length-1],s=n&&n.duration||i&&i.duration;return e&&s?s*1e3:(r.partTargetDuration||r.targetDuration||10)*500},$I=(r,e,t)=>{if(!r)return;const i=[];return r.forEach(n=>{if(!n.attributes)return;const{BANDWIDTH:s,RESOLUTION:a,CODECS:c}=n.attributes;i.push({id:n.id,bandwidth:s,resolution:a,codecs:c})}),{type:e,isLive:t,renditions:i}};let s0=class extends iz{constructor(e,t,i={}){if(super(),!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=Tc("PlaylistLoader");const{withCredentials:n=!1}=i;this.src=e,this.vhs_=t,this.withCredentials=n,this.addDateRangesToTextTrack_=i.addDateRangesToTextTrack;const s=t.options_;this.customTagParsers=s&&s.customTagParsers||[],this.customTagMappers=s&&s.customTagMappers||[],this.llhls=s&&s.llhls,this.dateRangesStorage_=new jI,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_),this.on("loadedplaylist",this.handleLoadedPlaylist_.bind(this))}handleLoadedPlaylist_(){const e=this.media();if(!e)return;this.dateRangesStorage_.setOffset(e.segments),this.dateRangesStorage_.setPendingDateRanges(e.dateRanges);const t=this.dateRangesStorage_.getDateRangesToProcess();!t.length||!this.addDateRangesToTextTrack_||this.addDateRangesToTextTrack_(t)}handleMediaupdatetimeout_(){if(this.state!=="HAVE_METADATA")return;const e=this.media();let t=Zl(this.main.uri,e.uri);this.llhls&&(t=nz(t,e)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:t,withCredentials:this.withCredentials,requestType:"hls-playlist"},(i,n)=>{if(this.request){if(i)return this.playlistRequestError(this.request,this.media(),"HAVE_METADATA");this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}})}playlistRequestError(e,t,i){const{uri:n,id:s}=t;this.request=null,i&&(this.state=i),this.error={playlist:this.main.playlists[s],status:e.status,message:`HLS playlist request error at URL: ${n}.`,responseText:e.responseText,code:e.status>=500?4:2,metadata:$m({requestType:e.requestType,request:e,error:e.error})},this.trigger("error")}parseManifest_({url:e,manifestString:t}){try{const i=QV({onwarn:({message:n})=>this.logger_(`m3u8-parser warn for ${e}: ${n}`),oninfo:({message:n})=>this.logger_(`m3u8-parser info for ${e}: ${n}`),manifestString:t,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls});return!i.playlists||!i.playlists.length||this.excludeAudioOnlyVariants(i.playlists),i}catch(i){this.error=i,this.error.metadata={errorType:ft.Error.StreamingHlsPlaylistParserError,error:i}}}excludeAudioOnlyVariants(e){const t=i=>{const n=i.attributes||{},{width:s,height:a}=n.RESOLUTION||{};if(s&&a)return!0;const c=NO(i)||[];return!!D_(c).video};e.some(t)&&e.forEach(i=>{t(i)||(i.excludeUntil=1/0)})}haveMetadata({playlistString:e,playlistObject:t,url:i,id:n}){this.request=null,this.state="HAVE_METADATA";const s={playlistInfo:{type:"media",uri:i}};this.trigger({type:"playlistparsestart",metadata:s});const a=t||this.parseManifest_({url:i,manifestString:e});a.lastRequest=Date.now(),OO({playlist:a,uri:i,id:n});const c=SE(this.main,a);this.targetDuration=a.partTargetDuration||a.targetDuration,this.pendingMedia_=null,c?(this.main=c,this.media_=this.main.playlists[n]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(AE(this.media(),!!c)),s.parsedPlaylist=$I(this.main.playlists,s.playlistInfo.type,!this.media_.endList),this.trigger({type:"playlistparsecomplete",metadata:s}),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),Z.clearTimeout(this.mediaUpdateTimeout),Z.clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new jI,this.off()}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e,t){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof e=="string"){if(!this.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.main.playlists[e]}if(Z.clearTimeout(this.finalRenditionTimeout),t){const c=(e.partTargetDuration||e.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=Z.setTimeout(this.media.bind(this,e,!1),c);return}const i=this.state,n=!this.media_||e.id!==this.media_.id,s=this.main.playlists[e.id];if(s&&s.endList||e.endList&&e.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,n&&(this.trigger("mediachanging"),i==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(AE(e,!0)),!n)return;if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=e;const a={playlistInfo:{type:"media",uri:e.uri}};this.trigger({type:"playlistrequeststart",metadata:a}),this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials,requestType:"hls-playlist"},(c,h)=>{if(this.request){if(e.lastRequest=Date.now(),e.resolvedUri=bx(e.resolvedUri,h),c)return this.playlistRequestError(this.request,e,i);this.trigger({type:"playlistrequestcomplete",metadata:a}),this.haveMetadata({playlistString:h.responseText,url:e.uri,id:e.id}),i==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}pause(){this.mediaUpdateTimeout&&(Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const t=this.media();if(e){const i=t?(t.partTargetDuration||t.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=Z.setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},i);return}if(!this.started){this.start();return}t&&!t.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=Z.setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)},e))}start(){if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=Z.location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0);return}const e={playlistInfo:{type:"multivariant",uri:this.src}};this.trigger({type:"playlistrequeststart",metadata:e}),this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials,requestType:"hls-playlist"},(t,i)=>{if(!this.request)return;if(this.request=null,t)return this.error={status:i.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:i.responseText,code:2,metadata:$m({requestType:i.requestType,request:i,error:t})},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.trigger({type:"playlistrequestcomplete",metadata:e}),this.src=bx(this.src,i),this.trigger({type:"playlistparsestart",metadata:e});const n=this.parseManifest_({manifestString:i.responseText,url:this.src});e.parsedPlaylist=$I(n.playlists,e.playlistInfo.type,!1),this.trigger({type:"playlistparsecomplete",metadata:e}),this.setupInitialPlaylist(n)})}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(e){if(this.state="HAVE_MAIN_MANIFEST",e.playlists){this.main=e,FO(this.main,this.srcUri()),e.playlists.forEach(i=>{i.segments=zO(i),i.segments.forEach(n=>{VO(n,i.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]);return}const t=this.srcUri()||Z.location.href;this.main=JV(e,t),this.haveMetadata({playlistObject:e,url:t,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}updateOrDeleteClone(e,t){const i=this.main,n=e.ID;let s=i.playlists.length;for(;s--;){const a=i.playlists[s];if(a.attributes["PATHWAY-ID"]===n){const c=a.resolvedUri,h=a.id;if(t){const m=this.createCloneURI_(a.resolvedUri,e),v=y0(n,m),b=this.createCloneAttributes_(n,a.attributes),x=this.createClonePlaylist_(a,v,e,b);i.playlists[s]=x,i.playlists[v]=x,i.playlists[m]=x}else i.playlists.splice(s,1);delete i.playlists[h],delete i.playlists[c]}}this.updateOrDeleteCloneMedia(e,t)}updateOrDeleteCloneMedia(e,t){const i=this.main,n=e.ID;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(s=>{if(!(!i.mediaGroups[s]||!i.mediaGroups[s][n])){for(const a in i.mediaGroups[s])if(a===n){for(const c in i.mediaGroups[s][a])i.mediaGroups[s][a][c].playlists.forEach((m,v)=>{const b=i.playlists[m.id],x=b.id,C=b.resolvedUri;delete i.playlists[x],delete i.playlists[C]});delete i.mediaGroups[s][a]}}}),t&&this.createClonedMediaGroups_(e)}addClonePathway(e,t={}){const i=this.main,n=i.playlists.length,s=this.createCloneURI_(t.resolvedUri,e),a=y0(e.ID,s),c=this.createCloneAttributes_(e.ID,t.attributes),h=this.createClonePlaylist_(t,a,e,c);i.playlists[n]=h,i.playlists[a]=h,i.playlists[s]=h,this.createClonedMediaGroups_(e)}createClonedMediaGroups_(e){const t=e.ID,i=e["BASE-ID"],n=this.main;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(s=>{if(!(!n.mediaGroups[s]||n.mediaGroups[s][t]))for(const a in n.mediaGroups[s]){if(a===i)n.mediaGroups[s][t]={};else continue;for(const c in n.mediaGroups[s][a]){const h=n.mediaGroups[s][a][c];n.mediaGroups[s][t][c]=zr({},h);const m=n.mediaGroups[s][t][c],v=this.createCloneURI_(h.resolvedUri,e);m.resolvedUri=v,m.uri=v,m.playlists=[],h.playlists.forEach((b,x)=>{const C=n.playlists[b.id],B=kO(s,t,c),P=y0(t,B);if(C&&!n.playlists[P]){const N=this.createClonePlaylist_(C,P,e),ae=N.resolvedUri;n.playlists[P]=N,n.playlists[ae]=N}m.playlists[x]=this.createClonePlaylist_(b,P,e)})}}})}createClonePlaylist_(e,t,i,n){const s=this.createCloneURI_(e.resolvedUri,i),a={resolvedUri:s,uri:s,id:t};return e.segments&&(a.segments=[]),n&&(a.attributes=n),Hr(e,a)}createCloneURI_(e,t){const i=new URL(e);i.hostname=t["URI-REPLACEMENT"].HOST;const n=t["URI-REPLACEMENT"].PARAMS;for(const s of Object.keys(n))i.searchParams.set(s,n[s]);return i.href}createCloneAttributes_(e,t){const i={"PATHWAY-ID":e};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(n=>{t[n]&&(i[n]=e)}),i}getKeyIdSet(e){if(e.contentProtection){const t=new Set;for(const i in e.contentProtection){const n=e.contentProtection[i].attributes.keyId;n&&t.add(n.toLowerCase())}return t}}};const wE=function(r,e,t,i){const n=r.responseType==="arraybuffer"?r.response:r.responseText;!e&&n&&(r.responseTime=Date.now(),r.roundTripTime=r.responseTime-r.requestTime,r.bytesReceived=n.byteLength||n.length,r.bandwidth||(r.bandwidth=Math.floor(r.bytesReceived/r.roundTripTime*8*1e3))),t.headers&&(r.responseHeaders=t.headers),e&&e.code==="ETIMEDOUT"&&(r.timedout=!0),!e&&!r.aborted&&t.statusCode!==200&&t.statusCode!==206&&t.statusCode!==0&&(e=new Error("XHR Failed with a response of: "+(r&&(n||r.responseText)))),i(e,r)},az=(r,e)=>{if(!r||!r.size)return;let t=e;return r.forEach(i=>{t=i(t)}),t},oz=(r,e,t,i)=>{!r||!r.size||r.forEach(n=>{n(e,t,i)})},jO=function(){const r=function e(t,i){t=Hr({timeout:45e3},t);const n=e.beforeRequest||ft.Vhs.xhr.beforeRequest,s=e._requestCallbackSet||ft.Vhs.xhr._requestCallbackSet||new Set,a=e._responseCallbackSet||ft.Vhs.xhr._responseCallbackSet;n&&typeof n=="function"&&(ft.log.warn("beforeRequest is deprecated, use onRequest instead."),s.add(n));const c=ft.Vhs.xhr.original===!0?ft.xhr:ft.Vhs.xhr,h=az(s,t);s.delete(n);const m=c(h||t,function(b,x){return oz(a,m,b,x),wE(m,b,x,i)}),v=m.abort;return m.abort=function(){return m.aborted=!0,v.apply(m,arguments)},m.uri=t.uri,m.requestType=t.requestType,m.requestTime=Date.now(),m};return r.original=!0,r},lz=function(r){let e;const t=r.offset;return typeof r.offset=="bigint"||typeof r.length=="bigint"?e=Z.BigInt(r.offset)+Z.BigInt(r.length)-Z.BigInt(1):e=r.offset+r.length-1,"bytes="+t+"-"+e},EE=function(r){const e={};return r.byterange&&(e.Range=lz(r.byterange)),e},uz=function(r,e){return r.start(e)+"-"+r.end(e)},cz=function(r,e){const t=r.toString(16);return"00".substring(0,2-t.length)+t+(e%2?" ":"")},dz=function(r){return r>=32&&r<126?String.fromCharCode(r):"."},GO=function(r){const e={};return Object.keys(r).forEach(t=>{const i=r[t];HR(i)?e[t]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}:e[t]=i}),e},Tx=function(r){const e=r.byterange||{length:1/0,offset:0};return[e.length,e.offset,r.resolvedUri].join(",")},$O=function(r){return r.resolvedUri},WO=r=>{const e=Array.prototype.slice.call(r),t=16;let i="",n,s;for(let a=0;a<e.length/t;a++)n=e.slice(a*t,a*t+t).map(cz).join(""),s=e.slice(a*t,a*t+t).map(dz).join(""),i+=n+" "+s+`
`;return i},hz=({bytes:r})=>WO(r),fz=r=>{let e="",t;for(t=0;t<r.length;t++)e+=uz(r,t)+" ";return e};var pz=Object.freeze({__proto__:null,createTransferableMessage:GO,initSegmentId:Tx,segmentKeyId:$O,hexDump:WO,tagDump:hz,textRanges:fz});const qO=.25,mz=(r,e)=>{if(!e.dateTimeObject)return null;const t=e.videoTimingInfo.transmuxerPrependedSeconds,n=e.videoTimingInfo.transmuxedPresentationStart+t,s=r-n;return new Date(e.dateTimeObject.getTime()+s*1e3)},gz=r=>r.transmuxedPresentationEnd-r.transmuxedPresentationStart-r.transmuxerPrependedSeconds,vz=(r,e)=>{let t;try{t=new Date(r)}catch{return null}if(!e||!e.segments||e.segments.length===0)return null;let i=e.segments[0];if(t<new Date(i.dateTimeObject))return null;for(let h=0;h<e.segments.length-1;h++){i=e.segments[h];const m=new Date(e.segments[h+1].dateTimeObject);if(t<m)break}const n=e.segments[e.segments.length-1],s=n.dateTimeObject,a=n.videoTimingInfo?gz(n.videoTimingInfo):n.duration+n.duration*qO,c=new Date(s.getTime()+a*1e3);return t>c?null:(t>new Date(s)&&(i=n),{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:Jl.duration(e,e.mediaSequence+e.segments.indexOf(i)),type:i.videoTimingInfo?"accurate":"estimate"})},yz=(r,e)=>{if(!e||!e.segments||e.segments.length===0)return null;let t=0,i;for(let s=0;s<e.segments.length&&(i=e.segments[s],t=i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationEnd:t+i.duration,!(r<=t));s++);const n=e.segments[e.segments.length-1];if(n.videoTimingInfo&&n.videoTimingInfo.transmuxedPresentationEnd<r)return null;if(r>t){if(r>t+n.duration*qO)return null;i=n}return{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:t-i.duration,type:i.videoTimingInfo?"accurate":"estimate"}},_z=(r,e)=>{let t,i;try{t=new Date(r),i=new Date(e)}catch{}const n=t.getTime();return(i.getTime()-n)/1e3},bz=r=>{if(!r.segments||r.segments.length===0)return!1;for(let e=0;e<r.segments.length;e++)if(!r.segments[e].dateTimeObject)return!1;return!0},Tz=({playlist:r,time:e=void 0,callback:t})=>{if(!t)throw new Error("getProgramTime: callback must be provided");if(!r||e===void 0)return t({message:"getProgramTime: playlist and time must be provided"});const i=yz(e,r);if(!i)return t({message:"valid programTime was not found"});if(i.type==="estimate")return t({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:i.estimatedStart});const n={mediaSeconds:e},s=mz(e,i.segment);return s&&(n.programDateTime=s.toISOString()),t(null,n)},XO=({programTime:r,playlist:e,retryCount:t=2,seekTo:i,pauseAfterSeek:n=!0,tech:s,callback:a})=>{if(!a)throw new Error("seekToProgramTime: callback must be provided");if(typeof r>"u"||!e||!i)return a({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!s.hasStarted_)return a({message:"player must be playing a live stream to start buffering"});if(!bz(e))return a({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});const c=vz(r,e);if(!c)return a({message:`${r} was not found in the stream`});const h=c.segment,m=_z(h.dateTimeObject,r);if(c.type==="estimate"){if(t===0)return a({message:`${r} is not buffered yet. Try again`});i(c.estimatedStart+m),s.one("seeked",()=>{XO({programTime:r,playlist:e,retryCount:t-1,seekTo:i,pauseAfterSeek:n,tech:s,callback:a})});return}const v=h.start+m,b=()=>a(null,s.currentTime());s.one("seeked",b),n&&s.pause(),i(v)},hw=(r,e)=>{if(r.readyState===4)return e()},xz=(r,e,t,i)=>{let n=[],s,a=!1;const c=function(b,x,C,B){return x.abort(),a=!0,t(b,x,C,B)},h=function(b,x){if(a)return;if(b)return b.metadata=$m({requestType:i,request:x,error:b}),c(b,x,"",n);const C=x.responseText.substring(n&&n.byteLength||0,x.responseText.length);if(n=QU(n,jR(C,!0)),s=s||Jy(n),n.length<10||s&&n.length<s+2)return hw(x,()=>c(b,x,"",n));const B=z2(n);return B==="ts"&&n.length<188?hw(x,()=>c(b,x,"",n)):!B&&n.length<376?hw(x,()=>c(b,x,"",n)):c(null,x,B,n)},v=e({uri:r,beforeSend(b){b.overrideMimeType("text/plain; charset=x-user-defined"),b.addEventListener("progress",function({total:x,loaded:C}){return wE(b,null,{statusCode:b.status},h)})}},function(b,x){return wE(v,b,x,h)});return v},{EventTarget:Sz}=ft,WI=function(r,e){if(!HO(r,e)||r.sidx&&e.sidx&&(r.sidx.offset!==e.sidx.offset||r.sidx.length!==e.sidx.length))return!1;if(!r.sidx&&e.sidx||r.sidx&&!e.sidx||r.segments&&!e.segments||!r.segments&&e.segments)return!1;if(!r.segments&&!e.segments)return!0;for(let t=0;t<r.segments.length;t++){const i=r.segments[t],n=e.segments[t];if(i.uri!==n.uri)return!1;if(!i.byterange&&!n.byterange)continue;const s=i.byterange,a=n.byterange;if(s&&!a||!s&&a||s.offset!==a.offset||s.length!==a.length)return!1}return!0},Az=(r,e,t,i)=>{const n=i.attributes.NAME||t;return`placeholder-uri-${r}-${e}-${n}`},wz=({mainXml:r,srcUrl:e,clientOffset:t,sidxMapping:i,previousManifest:n})=>{const s=q7(r,{manifestUri:e,clientOffset:t,sidxMapping:i,previousManifest:n});return FO(s,e,Az),s},Ez=(r,e)=>{ov(r,(t,i,n,s)=>{(!e.mediaGroups[i][n]||!(s in e.mediaGroups[i][n]))&&delete r.mediaGroups[i][n][s]})},Cz=(r,e,t)=>{let i=!0,n=Hr(r,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod,timelineStarts:e.timelineStarts});for(let s=0;s<e.playlists.length;s++){const a=e.playlists[s];if(a.sidx){const h=Yx(a.sidx);t&&t[h]&&t[h].sidx&&N2(a,t[h].sidx,a.sidx.resolvedUri)}const c=SE(n,a,WI);c&&(n=c,i=!1)}return ov(e,(s,a,c,h)=>{if(s.playlists&&s.playlists.length){const m=s.playlists[0].id,v=SE(n,s.playlists[0],WI);v&&(n=v,h in n.mediaGroups[a][c]||(n.mediaGroups[a][c][h]=s),n.mediaGroups[a][c][h].playlists[0]=n.playlists[m],i=!1)}}),Ez(n,e),e.minimumUpdatePeriod!==r.minimumUpdatePeriod&&(i=!1),i?null:n},Mz=(r,e)=>(!r.map&&!e.map||!!(r.map&&e.map&&r.map.byterange.offset===e.map.byterange.offset&&r.map.byterange.length===e.map.byterange.length))&&r.uri===e.uri&&r.byterange.offset===e.byterange.offset&&r.byterange.length===e.byterange.length,qI=(r,e)=>{const t={};for(const i in r){const s=r[i].sidx;if(s){const a=Yx(s);if(!e[a])break;const c=e[a].sidxInfo;Mz(c,s)&&(t[a]=e[a])}}return t},Dz=(r,e)=>{let i=qI(r.playlists,e);return ov(r,(n,s,a,c)=>{if(n.playlists&&n.playlists.length){const h=n.playlists;i=Hr(i,qI(h,e))}}),i};let CE=class extends Sz{constructor(e,t,i={},n){super(),this.isPaused_=!0,this.mainPlaylistLoader_=n||this,n||(this.isMain_=!0);const{withCredentials:s=!1}=i;if(this.vhs_=t,this.withCredentials=s,this.addMetadataToTextTrack=i.addMetadataToTextTrack,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=Tc("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}get isPaused(){return this.isPaused_}requestErrored_(e,t,i){if(!this.request)return!0;if(this.request=null,e)return this.error=typeof e=="object"&&!(e instanceof Error)?e:{status:t.status,message:"DASH request error at URL: "+t.uri,response:t.response,code:2,metadata:e.metadata},i&&(this.state=i),this.trigger("error"),!0}addSidxSegments_(e,t,i){const n=e.sidx&&Yx(e.sidx);if(!e.sidx||!n||this.mainPlaylistLoader_.sidxMapping_[n]){Z.clearTimeout(this.mediaRequest_),this.mediaRequest_=Z.setTimeout(()=>i(!1),0);return}const s=bx(e.sidx.resolvedUri),a=(h,m)=>{if(this.requestErrored_(h,m,t))return;const v=this.mainPlaylistLoader_.sidxMapping_,{requestType:b}=m;let x;try{x=Z7(en(m.response).subarray(8))}catch(C){C.metadata=$m({requestType:b,request:m,parseFailure:!0}),this.requestErrored_(C,m,t);return}return v[n]={sidxInfo:e.sidx,sidx:x},N2(e,x,e.sidx.resolvedUri),i(!0)},c="dash-sidx";this.request=xz(s,this.vhs_.xhr,(h,m,v,b)=>{if(h)return a(h,m);if(!v||v!=="mp4"){const B=v||"unknown";return a({status:m.status,message:`Unsupported ${B} container type for sidx segment at URL: ${s}`,response:"",playlist:e,internal:!0,playlistExclusionDuration:1/0,code:2},m)}const{offset:x,length:C}=e.sidx.byterange;if(b.length>=C+x)return a(h,{response:b.subarray(x,x+C),status:m.status,uri:m.uri});this.request=this.vhs_.xhr({uri:s,responseType:"arraybuffer",requestType:"dash-sidx",headers:EE({byterange:e.sidx.byterange})},a)},c)}dispose(){this.isPaused_=!0,this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},Z.clearTimeout(this.minimumUpdatePeriodTimeout_),Z.clearTimeout(this.mediaRequest_),Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);const t=this.state;if(typeof e=="string"){if(!this.mainPlaylistLoader_.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.mainPlaylistLoader_.main.playlists[e]}const i=!this.media_||e.id!==this.media_.id;if(i&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA",this.media_=e,i&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}i&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,t,n=>{this.haveMetadata({startingState:t,playlist:e})}))}haveMetadata({startingState:e,playlist:t}){this.state="HAVE_METADATA",this.loadedPlaylists_[t.id]=t,Z.clearTimeout(this.mediaRequest_),this.mediaRequest_=null,this.refreshMedia_(t.id),e==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.isPaused_=!0,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(Z.clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(e){this.isPaused_=!1,Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const t=this.media();if(e){const i=t?t.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=Z.setTimeout(()=>this.load(),i);return}if(!this.started){this.start();return}t&&!t.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")}start(){if(this.started=!0,!this.isMain_){Z.clearTimeout(this.mediaRequest_),this.mediaRequest_=Z.setTimeout(()=>this.haveMain_(),0);return}this.requestMain_((e,t)=>{this.haveMain_(),!this.hasPendingRequest()&&!this.media_&&this.media(this.mainPlaylistLoader_.main.playlists[0])})}requestMain_(e){const t={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestrequeststart",metadata:t}),this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials,requestType:"dash-manifest"},(i,n)=>{if(i){const{requestType:a}=n;i.metadata=$m({requestType:a,request:n,error:i})}if(this.requestErrored_(i,n)){this.state==="HAVE_NOTHING"&&(this.started=!1);return}this.trigger({type:"manifestrequestcomplete",metadata:t});const s=n.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=n.responseText,n.responseHeaders&&n.responseHeaders.date?this.mainLoaded_=Date.parse(n.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=bx(this.mainPlaylistLoader_.srcUrl,n),s){this.handleMain_(),this.syncClientServerClock_(()=>e(n,s));return}return e(n,s)})}syncClientServerClock_(e){const t=X7(this.mainPlaylistLoader_.mainXml_);if(t===null)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();if(t.method==="DIRECT")return this.mainPlaylistLoader_.clientOffset_=t.value-Date.now(),e();this.request=this.vhs_.xhr({uri:Zl(this.mainPlaylistLoader_.srcUrl,t.value),method:t.method,withCredentials:this.withCredentials,requestType:"dash-clock-sync"},(i,n)=>{if(!this.request)return;if(i){const{requestType:a}=n;return this.error.metadata=$m({requestType:a,request:n,error:i}),this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e()}let s;t.method==="HEAD"?!n.responseHeaders||!n.responseHeaders.date?s=this.mainLoaded_:s=Date.parse(n.responseHeaders.date):s=Date.parse(n.responseText),this.mainPlaylistLoader_.clientOffset_=s-Date.now(),e()})}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){Z.clearTimeout(this.mediaRequest_),this.mediaRequest_=null;const e=this.mainPlaylistLoader_.main,t={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestparsestart",metadata:t});let i;try{i=wz({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e})}catch(s){this.error=s,this.error.metadata={errorType:ft.Error.StreamingDashManifestParserError,error:s},this.trigger("error")}e&&(i=Cz(e,i,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=i||e;const n=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];if(n&&n!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=n),(!e||i&&i.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(i),i){const{duration:s,endList:a}=i,c=[];i.playlists.forEach(m=>{c.push({id:m.id,bandwidth:m.attributes.BANDWIDTH,resolution:m.attributes.RESOLUTION,codecs:m.attributes.CODECS})});const h={duration:s,isLive:!a,renditions:c};t.parsedManifest=h,this.trigger({type:"manifestparsecomplete",metadata:t})}return!!i}updateMinimumUpdatePeriodTimeout_(){const e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(Z.clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let t=e.main&&e.main.minimumUpdatePeriod;if(t===0&&(e.media()?t=e.media().targetDuration*1e3:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),typeof t!="number"||t<=0){t<0&&this.logger_(`found invalid minimumUpdatePeriod of ${t}, not setting a timeout`);return}this.createMUPTimeout_(t)}createMUPTimeout_(e){const t=this.mainPlaylistLoader_;t.minimumUpdatePeriodTimeout_=Z.setTimeout(()=>{t.minimumUpdatePeriodTimeout_=null,t.trigger("minimumUpdatePeriod"),t.createMUPTimeout_(e)},e)}refreshXml_(){this.requestMain_((e,t)=>{t&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=Dz(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,i=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const t=this.mainPlaylistLoader_.main.playlists,i=!this.media_||this.media_!==t[e];if(i?this.media_=t[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const n=()=>{this.media().endList||(this.mediaUpdateTimeout=Z.setTimeout(()=>{this.trigger("mediaupdatetimeout"),n()},AE(this.media(),!!i)))};n()}this.trigger("loadedplaylist")}addEventStreamToMetadataTrack_(e){if(e&&this.mainPlaylistLoader_.main.eventStream){const t=this.mainPlaylistLoader_.main.eventStream.map(i=>({cueTime:i.start,frames:[{data:i.messageData}]}));this.addMetadataToTextTrack("EventStream",t,this.mainPlaylistLoader_.main.duration)}}getKeyIdSet(e){if(e.contentProtection){const t=new Set;for(const i in e.contentProtection){const n=e.contentProtection[i].attributes["cenc:default_KID"];n&&t.add(n.replace(/-/g,"").toLowerCase())}return t}}};var Qa={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const Iz=r=>{const e=new Uint8Array(new ArrayBuffer(r.length));for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e.buffer},YO=function(r){return r.on=r.addEventListener,r.off=r.removeEventListener,r},Pz=function(r){try{return URL.createObjectURL(new Blob([r],{type:"application/javascript"}))}catch{const t=new BlobBuilder;return t.append(r),URL.createObjectURL(t.getBlob())}},QO=function(r){return function(){const e=Pz(r),t=YO(new Worker(e));t.objURL=e;const i=t.terminate;return t.on=t.addEventListener,t.off=t.removeEventListener,t.terminate=function(){return URL.revokeObjectURL(e),i.call(this)},t}},KO=function(r){return`var browserWorkerPolyFill = ${YO.toString()};
browserWorkerPolyFill(self);
`+r},ZO=function(r){return r.toString().replace(/^function.+?{/,"").slice(0,-1)},Lz=KO(ZO(function(){var r=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=function(){this.init=function(){var S={};this.on=function(D,k){S[D]||(S[D]=[]),S[D]=S[D].concat(k)},this.off=function(D,k){var L;return S[D]?(L=S[D].indexOf(k),S[D]=S[D].slice(),S[D].splice(L,1),L>-1):!1},this.trigger=function(D){var k,L,j,Y;if(k=S[D],!!k)if(arguments.length===2)for(j=k.length,L=0;L<j;++L)k[L].call(this,arguments[1]);else{for(Y=[],L=arguments.length,L=1;L<arguments.length;++L)Y.push(arguments[L]);for(j=k.length,L=0;L<j;++L)k[L].apply(this,Y)}},this.dispose=function(){S={}}}};e.prototype.pipe=function(S){return this.on("data",function(D){S.push(D)}),this.on("done",function(D){S.flush(D)}),this.on("partialdone",function(D){S.partialFlush(D)}),this.on("endedtimeline",function(D){S.endTimeline(D)}),this.on("reset",function(D){S.reset(D)}),S},e.prototype.push=function(S){this.trigger("data",S)},e.prototype.flush=function(S){this.trigger("done",S)},e.prototype.partialFlush=function(S){this.trigger("partialdone",S)},e.prototype.endTimeline=function(S){this.trigger("endedtimeline",S)},e.prototype.reset=function(S){this.trigger("reset",S)};var t=e,i=Math.pow(2,32),n=function(S){var D=new DataView(S.buffer,S.byteOffset,S.byteLength),k;return D.getBigUint64?(k=D.getBigUint64(0),k<Number.MAX_SAFE_INTEGER?Number(k):k):D.getUint32(0)*i+D.getUint32(4)},s={getUint64:n,MAX_UINT32:i},a=s.MAX_UINT32,c,h,m,v,b,x,C,B,P,N,ae,X,de,ge,ue,be,fe,ve,ie,re,Ne,De,ke,ut,_t,vt,tt,je,it,Xe,Se,ct,xt,ii,Re,lt;(function(){var S;if(ke={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(S in ke)ke.hasOwnProperty(S)&&(ke[S]=[S.charCodeAt(0),S.charCodeAt(1),S.charCodeAt(2),S.charCodeAt(3)]);ut=new Uint8Array([105,115,111,109]),vt=new Uint8Array([97,118,99,49]),_t=new Uint8Array([0,0,0,1]),tt=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),je=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),it={video:tt,audio:je},ct=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Se=new Uint8Array([0,0,0,0,0,0,0,0]),xt=new Uint8Array([0,0,0,0,0,0,0,0]),ii=xt,Re=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),lt=xt,Xe=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),c=function(S){var D=[],k=0,L,j,Y;for(L=1;L<arguments.length;L++)D.push(arguments[L]);for(L=D.length;L--;)k+=D[L].byteLength;for(j=new Uint8Array(k+8),Y=new DataView(j.buffer,j.byteOffset,j.byteLength),Y.setUint32(0,j.byteLength),j.set(S,4),L=0,k=8;L<D.length;L++)j.set(D[L],k),k+=D[L].byteLength;return j},h=function(){return c(ke.dinf,c(ke.dref,ct))},m=function(S){return c(ke.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,S.audioobjecttype<<3|S.samplingfrequencyindex>>>1,S.samplingfrequencyindex<<7|S.channelcount<<3,6,1,2]))},v=function(){return c(ke.ftyp,ut,_t,ut,vt)},be=function(S){return c(ke.hdlr,it[S])},b=function(S){return c(ke.mdat,S)},ue=function(S){var D=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,S.duration>>>24&255,S.duration>>>16&255,S.duration>>>8&255,S.duration&255,85,196,0,0]);return S.samplerate&&(D[12]=S.samplerate>>>24&255,D[13]=S.samplerate>>>16&255,D[14]=S.samplerate>>>8&255,D[15]=S.samplerate&255),c(ke.mdhd,D)},ge=function(S){return c(ke.mdia,ue(S),be(S.type),C(S))},x=function(S){return c(ke.mfhd,new Uint8Array([0,0,0,0,(S&4278190080)>>24,(S&16711680)>>16,(S&65280)>>8,S&255]))},C=function(S){return c(ke.minf,S.type==="video"?c(ke.vmhd,Xe):c(ke.smhd,Se),h(),ve(S))},B=function(S,D){for(var k=[],L=D.length;L--;)k[L]=re(D[L]);return c.apply(null,[ke.moof,x(S)].concat(k))},P=function(S){for(var D=S.length,k=[];D--;)k[D]=X(S[D]);return c.apply(null,[ke.moov,ae(4294967295)].concat(k).concat(N(S)))},N=function(S){for(var D=S.length,k=[];D--;)k[D]=Ne(S[D]);return c.apply(null,[ke.mvex].concat(k))},ae=function(S){var D=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(S&4278190080)>>24,(S&16711680)>>16,(S&65280)>>8,S&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return c(ke.mvhd,D)},fe=function(S){var D=S.samples||[],k=new Uint8Array(4+D.length),L,j;for(j=0;j<D.length;j++)L=D[j].flags,k[j+4]=L.dependsOn<<4|L.isDependedOn<<2|L.hasRedundancy;return c(ke.sdtp,k)},ve=function(S){return c(ke.stbl,ie(S),c(ke.stts,lt),c(ke.stsc,ii),c(ke.stsz,Re),c(ke.stco,xt))},function(){var S,D;ie=function(k){return c(ke.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),k.type==="video"?S(k):D(k))},S=function(k){var L=k.sps||[],j=k.pps||[],Y=[],ye=[],Te,Me;for(Te=0;Te<L.length;Te++)Y.push((L[Te].byteLength&65280)>>>8),Y.push(L[Te].byteLength&255),Y=Y.concat(Array.prototype.slice.call(L[Te]));for(Te=0;Te<j.length;Te++)ye.push((j[Te].byteLength&65280)>>>8),ye.push(j[Te].byteLength&255),ye=ye.concat(Array.prototype.slice.call(j[Te]));if(Me=[ke.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(k.width&65280)>>8,k.width&255,(k.height&65280)>>8,k.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),c(ke.avcC,new Uint8Array([1,k.profileIdc,k.profileCompatibility,k.levelIdc,255].concat([L.length],Y,[j.length],ye))),c(ke.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],k.sarRatio){var Le=k.sarRatio[0],Ge=k.sarRatio[1];Me.push(c(ke.pasp,new Uint8Array([(Le&4278190080)>>24,(Le&16711680)>>16,(Le&65280)>>8,Le&255,(Ge&4278190080)>>24,(Ge&16711680)>>16,(Ge&65280)>>8,Ge&255])))}return c.apply(null,Me)},D=function(k){return c(ke.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(k.channelcount&65280)>>8,k.channelcount&255,(k.samplesize&65280)>>8,k.samplesize&255,0,0,0,0,(k.samplerate&65280)>>8,k.samplerate&255,0,0]),m(k))}}(),de=function(S){var D=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(S.id&4278190080)>>24,(S.id&16711680)>>16,(S.id&65280)>>8,S.id&255,0,0,0,0,(S.duration&4278190080)>>24,(S.duration&16711680)>>16,(S.duration&65280)>>8,S.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(S.width&65280)>>8,S.width&255,0,0,(S.height&65280)>>8,S.height&255,0,0]);return c(ke.tkhd,D)},re=function(S){var D,k,L,j,Y,ye,Te;return D=c(ke.tfhd,new Uint8Array([0,0,0,58,(S.id&4278190080)>>24,(S.id&16711680)>>16,(S.id&65280)>>8,S.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),ye=Math.floor(S.baseMediaDecodeTime/a),Te=Math.floor(S.baseMediaDecodeTime%a),k=c(ke.tfdt,new Uint8Array([1,0,0,0,ye>>>24&255,ye>>>16&255,ye>>>8&255,ye&255,Te>>>24&255,Te>>>16&255,Te>>>8&255,Te&255])),Y=92,S.type==="audio"?(L=De(S,Y),c(ke.traf,D,k,L)):(j=fe(S),L=De(S,j.length+Y),c(ke.traf,D,k,L,j))},X=function(S){return S.duration=S.duration||4294967295,c(ke.trak,de(S),ge(S))},Ne=function(S){var D=new Uint8Array([0,0,0,0,(S.id&4278190080)>>24,(S.id&16711680)>>16,(S.id&65280)>>8,S.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return S.type!=="video"&&(D[D.length-1]=0),c(ke.trex,D)},function(){var S,D,k;k=function(L,j){var Y=0,ye=0,Te=0,Me=0;return L.length&&(L[0].duration!==void 0&&(Y=1),L[0].size!==void 0&&(ye=2),L[0].flags!==void 0&&(Te=4),L[0].compositionTimeOffset!==void 0&&(Me=8)),[0,0,Y|ye|Te|Me,1,(L.length&4278190080)>>>24,(L.length&16711680)>>>16,(L.length&65280)>>>8,L.length&255,(j&4278190080)>>>24,(j&16711680)>>>16,(j&65280)>>>8,j&255]},D=function(L,j){var Y,ye,Te,Me,Le,Ge;for(Me=L.samples||[],j+=20+16*Me.length,Te=k(Me,j),ye=new Uint8Array(Te.length+Me.length*16),ye.set(Te),Y=Te.length,Ge=0;Ge<Me.length;Ge++)Le=Me[Ge],ye[Y++]=(Le.duration&4278190080)>>>24,ye[Y++]=(Le.duration&16711680)>>>16,ye[Y++]=(Le.duration&65280)>>>8,ye[Y++]=Le.duration&255,ye[Y++]=(Le.size&4278190080)>>>24,ye[Y++]=(Le.size&16711680)>>>16,ye[Y++]=(Le.size&65280)>>>8,ye[Y++]=Le.size&255,ye[Y++]=Le.flags.isLeading<<2|Le.flags.dependsOn,ye[Y++]=Le.flags.isDependedOn<<6|Le.flags.hasRedundancy<<4|Le.flags.paddingValue<<1|Le.flags.isNonSyncSample,ye[Y++]=Le.flags.degradationPriority&61440,ye[Y++]=Le.flags.degradationPriority&15,ye[Y++]=(Le.compositionTimeOffset&4278190080)>>>24,ye[Y++]=(Le.compositionTimeOffset&16711680)>>>16,ye[Y++]=(Le.compositionTimeOffset&65280)>>>8,ye[Y++]=Le.compositionTimeOffset&255;return c(ke.trun,ye)},S=function(L,j){var Y,ye,Te,Me,Le,Ge;for(Me=L.samples||[],j+=20+8*Me.length,Te=k(Me,j),Y=new Uint8Array(Te.length+Me.length*8),Y.set(Te),ye=Te.length,Ge=0;Ge<Me.length;Ge++)Le=Me[Ge],Y[ye++]=(Le.duration&4278190080)>>>24,Y[ye++]=(Le.duration&16711680)>>>16,Y[ye++]=(Le.duration&65280)>>>8,Y[ye++]=Le.duration&255,Y[ye++]=(Le.size&4278190080)>>>24,Y[ye++]=(Le.size&16711680)>>>16,Y[ye++]=(Le.size&65280)>>>8,Y[ye++]=Le.size&255;return c(ke.trun,Y)},De=function(L,j){return L.type==="audio"?S(L,j):D(L,j)}}();var bt={ftyp:v,mdat:b,moof:B,moov:P,initSegment:function(S){var D=v(),k=P(S),L;return L=new Uint8Array(D.byteLength+k.byteLength),L.set(D),L.set(k,D.byteLength),L}},Je=function(S){var D,k,L=[],j=[];for(j.byteLength=0,j.nalCount=0,j.duration=0,L.byteLength=0,D=0;D<S.length;D++)k=S[D],k.nalUnitType==="access_unit_delimiter_rbsp"?(L.length&&(L.duration=k.dts-L.dts,j.byteLength+=L.byteLength,j.nalCount+=L.length,j.duration+=L.duration,j.push(L)),L=[k],L.byteLength=k.data.byteLength,L.pts=k.pts,L.dts=k.dts):(k.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(L.keyFrame=!0),L.duration=k.dts-L.dts,L.byteLength+=k.data.byteLength,L.push(k));return j.length&&(!L.duration||L.duration<=0)&&(L.duration=j[j.length-1].duration),j.byteLength+=L.byteLength,j.nalCount+=L.length,j.duration+=L.duration,j.push(L),j},Dt=function(S){var D,k,L=[],j=[];for(L.byteLength=0,L.nalCount=0,L.duration=0,L.pts=S[0].pts,L.dts=S[0].dts,j.byteLength=0,j.nalCount=0,j.duration=0,j.pts=S[0].pts,j.dts=S[0].dts,D=0;D<S.length;D++)k=S[D],k.keyFrame?(L.length&&(j.push(L),j.byteLength+=L.byteLength,j.nalCount+=L.nalCount,j.duration+=L.duration),L=[k],L.nalCount=k.length,L.byteLength=k.byteLength,L.pts=k.pts,L.dts=k.dts,L.duration=k.duration):(L.duration+=k.duration,L.nalCount+=k.length,L.byteLength+=k.byteLength,L.push(k));return j.length&&L.duration<=0&&(L.duration=j[j.length-1].duration),j.byteLength+=L.byteLength,j.nalCount+=L.nalCount,j.duration+=L.duration,j.push(L),j},Yt=function(S){var D;return!S[0][0].keyFrame&&S.length>1&&(D=S.shift(),S.byteLength-=D.byteLength,S.nalCount-=D.nalCount,S[0][0].dts=D.dts,S[0][0].pts=D.pts,S[0][0].duration+=D.duration),S},vi=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},xi=function(S,D){var k=vi();return k.dataOffset=D,k.compositionTimeOffset=S.pts-S.dts,k.duration=S.duration,k.size=4*S.length,k.size+=S.byteLength,S.keyFrame&&(k.flags.dependsOn=2,k.flags.isNonSyncSample=0),k},Yi=function(S,D){var k,L,j,Y,ye,Te=D||0,Me=[];for(k=0;k<S.length;k++)for(Y=S[k],L=0;L<Y.length;L++)ye=Y[L],j=xi(ye,Te),Te+=j.size,Me.push(j);return Me},Ki=function(S){var D,k,L,j,Y,ye,Te=0,Me=S.byteLength,Le=S.nalCount,Ge=Me+4*Le,pt=new Uint8Array(Ge),Gt=new DataView(pt.buffer);for(D=0;D<S.length;D++)for(j=S[D],k=0;k<j.length;k++)for(Y=j[k],L=0;L<Y.length;L++)ye=Y[L],Gt.setUint32(Te,ye.data.byteLength),Te+=4,pt.set(ye.data,Te),Te+=ye.data.byteLength;return pt},io=function(S,D){var k,L=D||0,j=[];return k=xi(S,L),j.push(k),j},yr=function(S){var D,k,L=0,j=S.byteLength,Y=S.length,ye=j+4*Y,Te=new Uint8Array(ye),Me=new DataView(Te.buffer);for(D=0;D<S.length;D++)k=S[D],Me.setUint32(L,k.data.byteLength),L+=4,Te.set(k.data,L),L+=k.data.byteLength;return Te},bs={groupNalsIntoFrames:Je,groupFramesIntoGops:Dt,extendFirstKeyFrame:Yt,generateSampleTable:Yi,concatenateNalData:Ki,generateSampleTableForFrame:io,concatenateNalDataForFrame:yr},cs=[33,16,5,32,164,27],sn=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],dn=function(S){for(var D=[];S--;)D.push(0);return D},gn=function(S){return Object.keys(S).reduce(function(D,k){return D[k]=new Uint8Array(S[k].reduce(function(L,j){return L.concat(j)},[])),D},{})},Sr,fa=function(){if(!Sr){var S={96e3:[cs,[227,64],dn(154),[56]],88200:[cs,[231],dn(170),[56]],64e3:[cs,[248,192],dn(240),[56]],48e3:[cs,[255,192],dn(268),[55,148,128],dn(54),[112]],44100:[cs,[255,192],dn(268),[55,163,128],dn(84),[112]],32e3:[cs,[255,192],dn(268),[55,234],dn(226),[112]],24e3:[cs,[255,192],dn(268),[55,255,128],dn(268),[111,112],dn(126),[224]],16e3:[cs,[255,192],dn(268),[55,255,128],dn(268),[111,255],dn(269),[223,108],dn(195),[1,192]],12e3:[sn,dn(268),[3,127,248],dn(268),[6,255,240],dn(268),[13,255,224],dn(268),[27,253,128],dn(259),[56]],11025:[sn,dn(268),[3,127,248],dn(268),[6,255,240],dn(268),[13,255,224],dn(268),[27,255,192],dn(268),[55,175,128],dn(108),[112]],8e3:[sn,dn(268),[3,121,16],dn(47),[7]]};Sr=gn(S)}return Sr},Oa=9e4,Js,Sa,ds,js,Vo,Aa,an;Js=function(S){return S*Oa},Sa=function(S,D){return S*D},ds=function(S){return S/Oa},js=function(S,D){return S/D},Vo=function(S,D){return Js(js(S,D))},Aa=function(S,D){return Sa(ds(S),D)},an=function(S,D,k){return ds(k?S:S-D)};var Ze={ONE_SECOND_IN_TS:Oa,secondsToVideoTs:Js,secondsToAudioTs:Sa,videoTsToSeconds:ds,audioTsToSeconds:js,audioTsToVideoTs:Vo,videoTsToAudioTs:Aa,metadataTsToSeconds:an},St=fa,Ft=Ze,di=function(S){var D,k,L=0;for(D=0;D<S.length;D++)k=S[D],L+=k.data.byteLength;return L},Oi=function(S,D,k,L){var j,Y=0,ye=0,Te=0,Me=0,Le,Ge,pt;if(D.length&&(j=Ft.audioTsToVideoTs(S.baseMediaDecodeTime,S.samplerate),Y=Math.ceil(Ft.ONE_SECOND_IN_TS/(S.samplerate/1024)),k&&L&&(ye=j-Math.max(k,L),Te=Math.floor(ye/Y),Me=Te*Y),!(Te<1||Me>Ft.ONE_SECOND_IN_TS/2))){for(Le=St()[S.samplerate],Le||(Le=D[0].data),Ge=0;Ge<Te;Ge++)pt=D[0],D.splice(0,0,{data:Le,dts:pt.dts-Y,pts:pt.pts-Y});return S.baseMediaDecodeTime-=Math.floor(Ft.videoTsToAudioTs(Me,S.samplerate)),Me}},Fn=function(S,D,k){return D.minSegmentDts>=k?S:(D.minSegmentDts=1/0,S.filter(function(L){return L.dts>=k?(D.minSegmentDts=Math.min(D.minSegmentDts,L.dts),D.minSegmentPts=D.minSegmentDts,!0):!1}))},Ar=function(S){var D,k,L=[];for(D=0;D<S.length;D++)k=S[D],L.push({size:k.data.byteLength,duration:1024});return L},Zi=function(S){var D,k,L=0,j=new Uint8Array(di(S));for(D=0;D<S.length;D++)k=S[D],j.set(k.data,L),L+=k.data.byteLength;return j},pi={prefixWithSilence:Oi,trimAdtsFramesByEarliestDts:Fn,generateSampleTable:Ar,concatenateFrameData:Zi},ne=Ze.ONE_SECOND_IN_TS,oe=function(S,D){typeof D.pts=="number"&&(S.timelineStartInfo.pts===void 0&&(S.timelineStartInfo.pts=D.pts),S.minSegmentPts===void 0?S.minSegmentPts=D.pts:S.minSegmentPts=Math.min(S.minSegmentPts,D.pts),S.maxSegmentPts===void 0?S.maxSegmentPts=D.pts:S.maxSegmentPts=Math.max(S.maxSegmentPts,D.pts)),typeof D.dts=="number"&&(S.timelineStartInfo.dts===void 0&&(S.timelineStartInfo.dts=D.dts),S.minSegmentDts===void 0?S.minSegmentDts=D.dts:S.minSegmentDts=Math.min(S.minSegmentDts,D.dts),S.maxSegmentDts===void 0?S.maxSegmentDts=D.dts:S.maxSegmentDts=Math.max(S.maxSegmentDts,D.dts))},xe=function(S){delete S.minSegmentDts,delete S.maxSegmentDts,delete S.minSegmentPts,delete S.maxSegmentPts},Ye=function(S,D){var k,L,j=S.minSegmentDts;return D||(j-=S.timelineStartInfo.dts),k=S.timelineStartInfo.baseMediaDecodeTime,k+=j,k=Math.max(0,k),S.type==="audio"&&(L=S.samplerate/ne,k*=L,k=Math.floor(k)),k},jt={clearDtsInfo:xe,calculateTrackBaseMediaDecodeTime:Ye,collectDtsInfo:oe},bi=4,Ui=128,Qr=function(S){for(var D=0,k={payloadType:-1,payloadSize:0},L=0,j=0;D<S.byteLength&&S[D]!==Ui;){for(;S[D]===255;)L+=255,D++;for(L+=S[D++];S[D]===255;)j+=255,D++;if(j+=S[D++],!k.payload&&L===bi){var Y=String.fromCharCode(S[D+3],S[D+4],S[D+5],S[D+6]);if(Y==="GA94"){k.payloadType=L,k.payloadSize=j,k.payload=S.subarray(D,D+j);break}else k.payload=void 0}D+=j,L=0,j=0}return k},Kr=function(S){return S.payload[0]!==181||(S.payload[1]<<8|S.payload[2])!==49||String.fromCharCode(S.payload[3],S.payload[4],S.payload[5],S.payload[6])!=="GA94"||S.payload[7]!==3?null:S.payload.subarray(8,S.payload.length-1)},ur=function(S,D){var k=[],L,j,Y,ye;if(!(D[0]&64))return k;for(j=D[0]&31,L=0;L<j;L++)Y=L*3,ye={type:D[Y+2]&3,pts:S},D[Y+2]&4&&(ye.ccData=D[Y+3]<<8|D[Y+4],k.push(ye));return k},wa=function(S){for(var D=S.byteLength,k=[],L=1,j,Y;L<D-2;)S[L]===0&&S[L+1]===0&&S[L+2]===3?(k.push(L+2),L+=2):L++;if(k.length===0)return S;j=D-k.length,Y=new Uint8Array(j);var ye=0;for(L=0;L<j;ye++,L++)ye===k[0]&&(ye++,k.shift()),Y[L]=S[ye];return Y},pa={parseSei:Qr,parseUserData:Kr,parseCaptionPackets:ur,discardEmulationPreventionBytes:wa,USER_DATA_REGISTERED_ITU_T_T35:bi},Ls=t,Ir=pa,Gn=function(S){S=S||{},Gn.prototype.init.call(this),this.parse708captions_=typeof S.parse708captions=="boolean"?S.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new rr(0,0),new rr(0,1),new rr(1,0),new rr(1,1)],this.parse708captions_&&(this.cc708Stream_=new nn({captionServices:S.captionServices})),this.reset(),this.ccStreams_.forEach(function(D){D.on("data",this.trigger.bind(this,"data")),D.on("partialdone",this.trigger.bind(this,"partialdone")),D.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};Gn.prototype=new Ls,Gn.prototype.push=function(S){var D,k,L;if(S.nalUnitType==="sei_rbsp"&&(D=Ir.parseSei(S.escapedRBSP),!!D.payload&&D.payloadType===Ir.USER_DATA_REGISTERED_ITU_T_T35&&(k=Ir.parseUserData(D),!!k))){if(S.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(S.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}L=Ir.parseCaptionPackets(S.pts,k),this.captionPackets_=this.captionPackets_.concat(L),this.latestDts_!==S.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=S.dts}},Gn.prototype.flushCCStreams=function(S){this.ccStreams_.forEach(function(D){return S==="flush"?D.flush():D.partialFlush()},this)},Gn.prototype.flushStream=function(S){if(!this.captionPackets_.length){this.flushCCStreams(S);return}this.captionPackets_.forEach(function(D,k){D.presortIndex=k}),this.captionPackets_.sort(function(D,k){return D.pts===k.pts?D.presortIndex-k.presortIndex:D.pts-k.pts}),this.captionPackets_.forEach(function(D){D.type<2?this.dispatchCea608Packet(D):this.dispatchCea708Packet(D)},this),this.captionPackets_.length=0,this.flushCCStreams(S)},Gn.prototype.flush=function(){return this.flushStream("flush")},Gn.prototype.partialFlush=function(){return this.flushStream("partialFlush")},Gn.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(S){S.reset()})},Gn.prototype.dispatchCea608Packet=function(S){this.setsTextOrXDSActive(S)?this.activeCea608Channel_[S.type]=null:this.setsChannel1Active(S)?this.activeCea608Channel_[S.type]=0:this.setsChannel2Active(S)&&(this.activeCea608Channel_[S.type]=1),this.activeCea608Channel_[S.type]!==null&&this.ccStreams_[(S.type<<1)+this.activeCea608Channel_[S.type]].push(S)},Gn.prototype.setsChannel1Active=function(S){return(S.ccData&30720)===4096},Gn.prototype.setsChannel2Active=function(S){return(S.ccData&30720)===6144},Gn.prototype.setsTextOrXDSActive=function(S){return(S.ccData&28928)===256||(S.ccData&30974)===4138||(S.ccData&30974)===6186},Gn.prototype.dispatchCea708Packet=function(S){this.parse708captions_&&this.cc708Stream_.push(S)};var ln={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},Fa=function(S){var D=ln[S]||S;return S&4096&&S===D?"":String.fromCharCode(D)},Pr=function(S){return 32<=S&&S<=127||160<=S&&S<=255},ea=function(S){this.windowNum=S,this.reset()};ea.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},ea.prototype.getText=function(){return this.rows.join(`
`)},ea.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},ea.prototype.newLine=function(S){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(S),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},ea.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},ea.prototype.addText=function(S){this.rows[this.rowIdx]+=S},ea.prototype.backspace=function(){if(!this.isEmpty()){var S=this.rows[this.rowIdx];this.rows[this.rowIdx]=S.substr(0,S.length-1)}};var no=function(S,D,k){this.serviceNum=S,this.text="",this.currentWindow=new ea(-1),this.windows=[],this.stream=k,typeof D=="string"&&this.createTextDecoder(D)};no.prototype.init=function(S,D){this.startPts=S;for(var k=0;k<8;k++)this.windows[k]=new ea(k),typeof D=="function"&&(this.windows[k].beforeRowOverflow=D)},no.prototype.setCurrentWindow=function(S){this.currentWindow=this.windows[S]},no.prototype.createTextDecoder=function(S){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(S)}catch(D){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+S+" encoding. "+D})}};var nn=function(S){S=S||{},nn.prototype.init.call(this);var D=this,k=S.captionServices||{},L={},j;Object.keys(k).forEach(Y=>{j=k[Y],/^SERVICE/.test(Y)&&(L[Y]=j.encoding)}),this.serviceEncodings=L,this.current708Packet=null,this.services={},this.push=function(Y){Y.type===3?(D.new708Packet(),D.add708Bytes(Y)):(D.current708Packet===null&&D.new708Packet(),D.add708Bytes(Y))}};nn.prototype=new Ls,nn.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},nn.prototype.add708Bytes=function(S){var D=S.ccData,k=D>>>8,L=D&255;this.current708Packet.ptsVals.push(S.pts),this.current708Packet.data.push(k),this.current708Packet.data.push(L)},nn.prototype.push708Packet=function(){var S=this.current708Packet,D=S.data,k=null,L=null,j=0,Y=D[j++];for(S.seq=Y>>6,S.sizeCode=Y&63;j<D.length;j++)Y=D[j++],k=Y>>5,L=Y&31,k===7&&L>0&&(Y=D[j++],k=Y),this.pushServiceBlock(k,j,L),L>0&&(j+=L-1)},nn.prototype.pushServiceBlock=function(S,D,k){var L,j=D,Y=this.current708Packet.data,ye=this.services[S];for(ye||(ye=this.initService(S,j));j<D+k&&j<Y.length;j++)L=Y[j],Pr(L)?j=this.handleText(j,ye):L===24?j=this.multiByteCharacter(j,ye):L===16?j=this.extendedCommands(j,ye):128<=L&&L<=135?j=this.setCurrentWindow(j,ye):152<=L&&L<=159?j=this.defineWindow(j,ye):L===136?j=this.clearWindows(j,ye):L===140?j=this.deleteWindows(j,ye):L===137?j=this.displayWindows(j,ye):L===138?j=this.hideWindows(j,ye):L===139?j=this.toggleWindows(j,ye):L===151?j=this.setWindowAttributes(j,ye):L===144?j=this.setPenAttributes(j,ye):L===145?j=this.setPenColor(j,ye):L===146?j=this.setPenLocation(j,ye):L===143?ye=this.reset(j,ye):L===8?ye.currentWindow.backspace():L===12?ye.currentWindow.clearText():L===13?ye.currentWindow.pendingNewLine=!0:L===14?ye.currentWindow.clearText():L===141&&j++},nn.prototype.extendedCommands=function(S,D){var k=this.current708Packet.data,L=k[++S];return Pr(L)&&(S=this.handleText(S,D,{isExtended:!0})),S},nn.prototype.getPts=function(S){return this.current708Packet.ptsVals[Math.floor(S/2)]},nn.prototype.initService=function(S,D){var L="SERVICE"+S,k=this,L,j;return L in this.serviceEncodings&&(j=this.serviceEncodings[L]),this.services[S]=new no(S,j,k),this.services[S].init(this.getPts(D),function(Y){k.flushDisplayed(Y,k.services[S])}),this.services[S]},nn.prototype.handleText=function(S,D,k){var L=k&&k.isExtended,j=k&&k.isMultiByte,Y=this.current708Packet.data,ye=L?4096:0,Te=Y[S],Me=Y[S+1],Le=D.currentWindow,Ge,pt;function Gt(Rt){return Rt.map(Mi=>("0"+(Mi&255).toString(16)).slice(-2)).join("")}if(j?(pt=[Te,Me],S++):pt=[Te],D.textDecoder_&&!L)Ge=D.textDecoder_.decode(new Uint8Array(pt));else if(j){const Rt=Gt(pt);Ge=String.fromCharCode(parseInt(Rt,16))}else Ge=Fa(ye|Te);return Le.pendingNewLine&&!Le.isEmpty()&&Le.newLine(this.getPts(S)),Le.pendingNewLine=!1,Le.addText(Ge),S},nn.prototype.multiByteCharacter=function(S,D){var k=this.current708Packet.data,L=k[S+1],j=k[S+2];return Pr(L)&&Pr(j)&&(S=this.handleText(++S,D,{isMultiByte:!0})),S},nn.prototype.setCurrentWindow=function(S,D){var k=this.current708Packet.data,L=k[S],j=L&7;return D.setCurrentWindow(j),S},nn.prototype.defineWindow=function(S,D){var k=this.current708Packet.data,L=k[S],j=L&7;D.setCurrentWindow(j);var Y=D.currentWindow;return L=k[++S],Y.visible=(L&32)>>5,Y.rowLock=(L&16)>>4,Y.columnLock=(L&8)>>3,Y.priority=L&7,L=k[++S],Y.relativePositioning=(L&128)>>7,Y.anchorVertical=L&127,L=k[++S],Y.anchorHorizontal=L,L=k[++S],Y.anchorPoint=(L&240)>>4,Y.rowCount=L&15,L=k[++S],Y.columnCount=L&63,L=k[++S],Y.windowStyle=(L&56)>>3,Y.penStyle=L&7,Y.virtualRowCount=Y.rowCount+1,S},nn.prototype.setWindowAttributes=function(S,D){var k=this.current708Packet.data,L=k[S],j=D.currentWindow.winAttr;return L=k[++S],j.fillOpacity=(L&192)>>6,j.fillRed=(L&48)>>4,j.fillGreen=(L&12)>>2,j.fillBlue=L&3,L=k[++S],j.borderType=(L&192)>>6,j.borderRed=(L&48)>>4,j.borderGreen=(L&12)>>2,j.borderBlue=L&3,L=k[++S],j.borderType+=(L&128)>>5,j.wordWrap=(L&64)>>6,j.printDirection=(L&48)>>4,j.scrollDirection=(L&12)>>2,j.justify=L&3,L=k[++S],j.effectSpeed=(L&240)>>4,j.effectDirection=(L&12)>>2,j.displayEffect=L&3,S},nn.prototype.flushDisplayed=function(S,D){for(var k=[],L=0;L<8;L++)D.windows[L].visible&&!D.windows[L].isEmpty()&&k.push(D.windows[L].getText());D.endPts=S,D.text=k.join(`

`),this.pushCaption(D),D.startPts=S},nn.prototype.pushCaption=function(S){S.text!==""&&(this.trigger("data",{startPts:S.startPts,endPts:S.endPts,text:S.text,stream:"cc708_"+S.serviceNum}),S.text="",S.startPts=S.endPts)},nn.prototype.displayWindows=function(S,D){var k=this.current708Packet.data,L=k[++S],j=this.getPts(S);this.flushDisplayed(j,D);for(var Y=0;Y<8;Y++)L&1<<Y&&(D.windows[Y].visible=1);return S},nn.prototype.hideWindows=function(S,D){var k=this.current708Packet.data,L=k[++S],j=this.getPts(S);this.flushDisplayed(j,D);for(var Y=0;Y<8;Y++)L&1<<Y&&(D.windows[Y].visible=0);return S},nn.prototype.toggleWindows=function(S,D){var k=this.current708Packet.data,L=k[++S],j=this.getPts(S);this.flushDisplayed(j,D);for(var Y=0;Y<8;Y++)L&1<<Y&&(D.windows[Y].visible^=1);return S},nn.prototype.clearWindows=function(S,D){var k=this.current708Packet.data,L=k[++S],j=this.getPts(S);this.flushDisplayed(j,D);for(var Y=0;Y<8;Y++)L&1<<Y&&D.windows[Y].clearText();return S},nn.prototype.deleteWindows=function(S,D){var k=this.current708Packet.data,L=k[++S],j=this.getPts(S);this.flushDisplayed(j,D);for(var Y=0;Y<8;Y++)L&1<<Y&&D.windows[Y].reset();return S},nn.prototype.setPenAttributes=function(S,D){var k=this.current708Packet.data,L=k[S],j=D.currentWindow.penAttr;return L=k[++S],j.textTag=(L&240)>>4,j.offset=(L&12)>>2,j.penSize=L&3,L=k[++S],j.italics=(L&128)>>7,j.underline=(L&64)>>6,j.edgeType=(L&56)>>3,j.fontStyle=L&7,S},nn.prototype.setPenColor=function(S,D){var k=this.current708Packet.data,L=k[S],j=D.currentWindow.penColor;return L=k[++S],j.fgOpacity=(L&192)>>6,j.fgRed=(L&48)>>4,j.fgGreen=(L&12)>>2,j.fgBlue=L&3,L=k[++S],j.bgOpacity=(L&192)>>6,j.bgRed=(L&48)>>4,j.bgGreen=(L&12)>>2,j.bgBlue=L&3,L=k[++S],j.edgeRed=(L&48)>>4,j.edgeGreen=(L&12)>>2,j.edgeBlue=L&3,S},nn.prototype.setPenLocation=function(S,D){var k=this.current708Packet.data,L=k[S],j=D.currentWindow.penLoc;return D.currentWindow.pendingNewLine=!0,L=k[++S],j.row=L&15,L=k[++S],j.column=L&63,S},nn.prototype.reset=function(S,D){var k=this.getPts(S);return this.flushDisplayed(k,D),this.initService(D.serviceNum,S)};var Lr={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},ta=function(S){return S===null?"":(S=Lr[S]||S,String.fromCharCode(S))},cr=14,kf=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],_l=function(){for(var S=[],D=cr+1;D--;)S.push({text:"",indent:0,offset:0});return S},rr=function(S,D){rr.prototype.init.call(this),this.field_=S||0,this.dataChannel_=D||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(k){var L,j,Y,ye,Te;if(L=k.ccData&32639,L===this.lastControlCode_){this.lastControlCode_=null;return}if((L&61440)===4096?this.lastControlCode_=L:L!==this.PADDING_&&(this.lastControlCode_=null),Y=L>>>8,ye=L&255,L!==this.PADDING_)if(L===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(L===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(k.pts),this.flushDisplayed(k.pts),j=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=j,this.startPts_=k.pts;else if(L===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(k.pts);else if(L===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(k.pts);else if(L===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(k.pts);else if(L===this.CARRIAGE_RETURN_)this.clearFormatting(k.pts),this.flushDisplayed(k.pts),this.shiftRowsUp_(),this.startPts_=k.pts;else if(L===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1);else if(L===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(k.pts),this.displayed_=_l();else if(L===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=_l();else if(L===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(k.pts),this.displayed_=_l()),this.mode_="paintOn",this.startPts_=k.pts;else if(this.isSpecialCharacter(Y,ye))Y=(Y&3)<<8,Te=ta(Y|ye),this[this.mode_](k.pts,Te),this.column_++;else if(this.isExtCharacter(Y,ye))this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),Y=(Y&3)<<8,Te=ta(Y|ye),this[this.mode_](k.pts,Te),this.column_++;else if(this.isMidRowCode(Y,ye))this.clearFormatting(k.pts),this[this.mode_](k.pts," "),this.column_++,(ye&14)===14&&this.addFormatting(k.pts,["i"]),(ye&1)===1&&this.addFormatting(k.pts,["u"]);else if(this.isOffsetControlCode(Y,ye)){const Le=ye&3;this.nonDisplayed_[this.row_].offset=Le,this.column_+=Le}else if(this.isPAC(Y,ye)){var Me=kf.indexOf(L&7968);if(this.mode_==="rollUp"&&(Me-this.rollUpRows_+1<0&&(Me=this.rollUpRows_-1),this.setRollUp(k.pts,Me)),Me!==this.row_&&Me>=0&&Me<=14&&(this.clearFormatting(k.pts),this.row_=Me),ye&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(k.pts,["u"]),(L&16)===16){const Le=(L&14)>>1;this.column_=Le*4,this.nonDisplayed_[this.row_].indent+=Le}this.isColorPAC(ye)&&(ye&14)===14&&this.addFormatting(k.pts,["i"])}else this.isNormalChar(Y)&&(ye===0&&(ye=null),Te=ta(Y),Te+=ta(ye),this[this.mode_](k.pts,Te),this.column_+=Te.length)}};rr.prototype=new Ls,rr.prototype.flushDisplayed=function(S){const D=L=>{this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+L+"."})},k=[];this.displayed_.forEach((L,j)=>{if(L&&L.text&&L.text.length){try{L.text=L.text.trim()}catch{D(j)}L.text.length&&k.push({text:L.text,line:j+1,position:10+Math.min(70,L.indent*10)+L.offset*2.5})}else L==null&&D(j)}),k.length&&this.trigger("data",{startPts:this.startPts_,endPts:S,content:k,stream:this.name_})},rr.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=_l(),this.nonDisplayed_=_l(),this.lastControlCode_=null,this.column_=0,this.row_=cr,this.rollUpRows_=2,this.formatting_=[]},rr.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},rr.prototype.isSpecialCharacter=function(S,D){return S===this.EXT_&&D>=48&&D<=63},rr.prototype.isExtCharacter=function(S,D){return(S===this.EXT_+1||S===this.EXT_+2)&&D>=32&&D<=63},rr.prototype.isMidRowCode=function(S,D){return S===this.EXT_&&D>=32&&D<=47},rr.prototype.isOffsetControlCode=function(S,D){return S===this.OFFSET_&&D>=33&&D<=35},rr.prototype.isPAC=function(S,D){return S>=this.BASE_&&S<this.BASE_+8&&D>=64&&D<=127},rr.prototype.isColorPAC=function(S){return S>=64&&S<=79||S>=96&&S<=127},rr.prototype.isNormalChar=function(S){return S>=32&&S<=127},rr.prototype.setRollUp=function(S,D){if(this.mode_!=="rollUp"&&(this.row_=cr,this.mode_="rollUp",this.flushDisplayed(S),this.nonDisplayed_=_l(),this.displayed_=_l()),D!==void 0&&D!==this.row_)for(var k=0;k<this.rollUpRows_;k++)this.displayed_[D-k]=this.displayed_[this.row_-k],this.displayed_[this.row_-k]={text:"",indent:0,offset:0};D===void 0&&(D=this.row_),this.topRow_=D-this.rollUpRows_+1},rr.prototype.addFormatting=function(S,D){this.formatting_=this.formatting_.concat(D);var k=D.reduce(function(L,j){return L+"<"+j+">"},"");this[this.mode_](S,k)},rr.prototype.clearFormatting=function(S){if(this.formatting_.length){var D=this.formatting_.reverse().reduce(function(k,L){return k+"</"+L+">"},"");this.formatting_=[],this[this.mode_](S,D)}},rr.prototype.popOn=function(S,D){var k=this.nonDisplayed_[this.row_].text;k+=D,this.nonDisplayed_[this.row_].text=k},rr.prototype.rollUp=function(S,D){var k=this.displayed_[this.row_].text;k+=D,this.displayed_[this.row_].text=k},rr.prototype.shiftRowsUp_=function(){var S;for(S=0;S<this.topRow_;S++)this.displayed_[S]={text:"",indent:0,offset:0};for(S=this.row_+1;S<cr+1;S++)this.displayed_[S]={text:"",indent:0,offset:0};for(S=this.topRow_;S<this.row_;S++)this.displayed_[S]=this.displayed_[S+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},rr.prototype.paintOn=function(S,D){var k=this.displayed_[this.row_].text;k+=D,this.displayed_[this.row_].text=k};var zo={CaptionStream:Gn,Cea608Stream:rr,Cea708Stream:nn},xc={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Of=t,Gr=8589934592,nd=4294967296,rd="shared",su=function(S,D){var k=1;for(S>D&&(k=-1);Math.abs(D-S)>nd;)S+=k*Gr;return S},bl=function(S){var D,k;bl.prototype.init.call(this),this.type_=S||rd,this.push=function(L){if(L.type==="metadata"){this.trigger("data",L);return}this.type_!==rd&&L.type!==this.type_||(k===void 0&&(k=L.dts),L.dts=su(L.dts,k),L.pts=su(L.pts,k),D=L.dts,this.trigger("data",L))},this.flush=function(){k=D,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){k=void 0,D=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};bl.prototype=new Of;var Qu={TimestampRolloverStream:bl,handleRollover:su},Ah=(S,D,k)=>{if(!S)return-1;for(var L=k;L<S.length;L++)if(S[L]===D)return L;return-1},Sc={typedArrayIndexOf:Ah},Rs=Sc.typedArrayIndexOf,Ho={Utf8:3},Gs=function(S,D,k){var L,j="";for(L=D;L<k;L++)j+="%"+("00"+S[L].toString(16)).slice(-2);return j},ro=function(S,D,k){return decodeURIComponent(Gs(S,D,k))},au=function(S,D,k){return unescape(Gs(S,D,k))},ou=function(S){return S[0]<<21|S[1]<<14|S[2]<<7|S[3]},so={APIC:function(S){var D=1,k,L,j="-->";S.data[0]===Ho.Utf8&&(k=Rs(S.data,0,D),!(k<0)&&(S.mimeType=au(S.data,D,k),D=k+1,S.pictureType=S.data[D],D++,L=Rs(S.data,0,D),!(L<0)&&(S.description=ro(S.data,D,L),D=L+1,S.mimeType===j?S.url=au(S.data,D,S.data.length):S.pictureData=S.data.subarray(D,S.data.length))))},"T*":function(S){S.data[0]===Ho.Utf8&&(S.value=ro(S.data,1,S.data.length).replace(/\0*$/,""),S.values=S.value.split("\0"))},TXXX:function(S){var D;S.data[0]===Ho.Utf8&&(D=Rs(S.data,0,1),D!==-1&&(S.description=ro(S.data,1,D),S.value=ro(S.data,D+1,S.data.length).replace(/\0*$/,""),S.data=S.value))},"W*":function(S){S.url=au(S.data,0,S.data.length).replace(/\0.*$/,"")},WXXX:function(S){var D;S.data[0]===Ho.Utf8&&(D=Rs(S.data,0,1),D!==-1&&(S.description=ro(S.data,1,D),S.url=au(S.data,D+1,S.data.length).replace(/\0.*$/,"")))},PRIV:function(S){var D;for(D=0;D<S.data.length;D++)if(S.data[D]===0){S.owner=au(S.data,0,D);break}S.privateData=S.data.subarray(D+1),S.data=S.privateData}},Ba=function(S){var D,k,L=10,j=0,Y=[];if(!(S.length<10||S[0]!==73||S[1]!==68||S[2]!==51)){j=ou(S.subarray(6,10)),j+=10;var ye=S[5]&64;ye&&(L+=4,L+=ou(S.subarray(10,14)),j-=ou(S.subarray(16,20)));do{if(D=ou(S.subarray(L+4,L+8)),D<1)break;k=String.fromCharCode(S[L],S[L+1],S[L+2],S[L+3]);var Te={id:k,data:S.subarray(L+10,L+D+10)};Te.key=Te.id,so[Te.id]?so[Te.id](Te):Te.id[0]==="T"?so["T*"](Te):Te.id[0]==="W"&&so["W*"](Te),Y.push(Te),L+=10,L+=D}while(L<j);return Y}},Ku={parseId3Frames:Ba,parseSyncSafeInteger:ou,frameParsers:so},lu=t,Ff=xc,jo=Ku,uu;uu=function(S){var D={descriptor:S&&S.descriptor},k=0,L=[],j=0,Y;if(uu.prototype.init.call(this),this.dispatchType=Ff.METADATA_STREAM_TYPE.toString(16),D.descriptor)for(Y=0;Y<D.descriptor.length;Y++)this.dispatchType+=("00"+D.descriptor[Y].toString(16)).slice(-2);this.push=function(ye){var Te,Me,Le,Ge,pt,Gt;if(ye.type==="timed-metadata"){if(ye.dataAlignmentIndicator&&(j=0,L.length=0),L.length===0&&(ye.data.length<10||ye.data[0]!==73||ye.data[1]!==68||ye.data[2]!==51)){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(L.push(ye),j+=ye.data.byteLength,L.length===1&&(k=jo.parseSyncSafeInteger(ye.data.subarray(6,10)),k+=10),!(j<k)){for(Te={data:new Uint8Array(k),frames:[],pts:L[0].pts,dts:L[0].dts},pt=0;pt<k;)Te.data.set(L[0].data.subarray(0,k-pt),pt),pt+=L[0].data.byteLength,j-=L[0].data.byteLength,L.shift();Me=10,Te.data[5]&64&&(Me+=4,Me+=jo.parseSyncSafeInteger(Te.data.subarray(10,14)),k-=jo.parseSyncSafeInteger(Te.data.subarray(16,20)));do{if(Le=jo.parseSyncSafeInteger(Te.data.subarray(Me+4,Me+8)),Le<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if(Gt=String.fromCharCode(Te.data[Me],Te.data[Me+1],Te.data[Me+2],Te.data[Me+3]),Ge={id:Gt,data:Te.data.subarray(Me+10,Me+Le+10)},Ge.key=Ge.id,jo.frameParsers[Ge.id]?jo.frameParsers[Ge.id](Ge):Ge.id[0]==="T"?jo.frameParsers["T*"](Ge):Ge.id[0]==="W"&&jo.frameParsers["W*"](Ge),Ge.owner==="com.apple.streaming.transportStreamTimestamp"){var Rt=Ge.data,Mi=(Rt[3]&1)<<30|Rt[4]<<22|Rt[5]<<14|Rt[6]<<6|Rt[7]>>>2;Mi*=4,Mi+=Rt[7]&3,Ge.timeStamp=Mi,Te.pts===void 0&&Te.dts===void 0&&(Te.pts=Ge.timeStamp,Te.dts=Ge.timeStamp),this.trigger("timestamp",Ge)}Te.frames.push(Ge),Me+=10,Me+=Le}while(Me<k);this.trigger("data",Te)}}}},uu.prototype=new lu;var Bf=uu,Tl=t,fo=zo,Na=xc,wh=Qu.TimestampRolloverStream,Jn,cu,Ac,xl=188,wc=71;Jn=function(){var S=new Uint8Array(xl),D=0;Jn.prototype.init.call(this),this.push=function(k){var L=0,j=xl,Y;for(D?(Y=new Uint8Array(k.byteLength+D),Y.set(S.subarray(0,D)),Y.set(k,D),D=0):Y=k;j<Y.byteLength;){if(Y[L]===wc&&Y[j]===wc){this.trigger("data",Y.subarray(L,j)),L+=xl,j+=xl;continue}L++,j++}L<Y.byteLength&&(S.set(Y.subarray(L),0),D=Y.byteLength-L)},this.flush=function(){D===xl&&S[0]===wc&&(this.trigger("data",S),D=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){D=0,this.trigger("reset")}},Jn.prototype=new Tl,cu=function(){var S,D,k,L;cu.prototype.init.call(this),L=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,S=function(j,Y){var ye=0;Y.payloadUnitStartIndicator&&(ye+=j[ye]+1),Y.type==="pat"?D(j.subarray(ye),Y):k(j.subarray(ye),Y)},D=function(j,Y){Y.section_number=j[7],Y.last_section_number=j[8],L.pmtPid=(j[10]&31)<<8|j[11],Y.pmtPid=L.pmtPid},k=function(j,Y){var ye,Te,Me,Le;if(j[5]&1){for(L.programMapTable={video:null,audio:null,"timed-metadata":{}},ye=(j[1]&15)<<8|j[2],Te=3+ye-4,Me=(j[10]&15)<<8|j[11],Le=12+Me;Le<Te;){var Ge=j[Le],pt=(j[Le+1]&31)<<8|j[Le+2];Ge===Na.H264_STREAM_TYPE&&L.programMapTable.video===null?L.programMapTable.video=pt:Ge===Na.ADTS_STREAM_TYPE&&L.programMapTable.audio===null?L.programMapTable.audio=pt:Ge===Na.METADATA_STREAM_TYPE&&(L.programMapTable["timed-metadata"][pt]=Ge),Le+=((j[Le+3]&15)<<8|j[Le+4])+5}Y.programMapTable=L.programMapTable}},this.push=function(j){var Y={},ye=4;if(Y.payloadUnitStartIndicator=!!(j[1]&64),Y.pid=j[1]&31,Y.pid<<=8,Y.pid|=j[2],(j[3]&48)>>>4>1&&(ye+=j[ye]+1),Y.pid===0)Y.type="pat",S(j.subarray(ye),Y),this.trigger("data",Y);else if(Y.pid===this.pmtPid)for(Y.type="pmt",S(j.subarray(ye),Y),this.trigger("data",Y);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([j,ye,Y]):this.processPes_(j,ye,Y)},this.processPes_=function(j,Y,ye){ye.pid===this.programMapTable.video?ye.streamType=Na.H264_STREAM_TYPE:ye.pid===this.programMapTable.audio?ye.streamType=Na.ADTS_STREAM_TYPE:ye.streamType=this.programMapTable["timed-metadata"][ye.pid],ye.type="pes",ye.data=j.subarray(Y),this.trigger("data",ye)}},cu.prototype=new Tl,cu.STREAM_TYPES={h264:27,adts:15},Ac=function(){var S=this,D=!1,k={data:[],size:0},L={data:[],size:0},j={data:[],size:0},Y,ye=function(Me,Le){var Ge;const pt=Me[0]<<16|Me[1]<<8|Me[2];Le.data=new Uint8Array,pt===1&&(Le.packetLength=6+(Me[4]<<8|Me[5]),Le.dataAlignmentIndicator=(Me[6]&4)!==0,Ge=Me[7],Ge&192&&(Le.pts=(Me[9]&14)<<27|(Me[10]&255)<<20|(Me[11]&254)<<12|(Me[12]&255)<<5|(Me[13]&254)>>>3,Le.pts*=4,Le.pts+=(Me[13]&6)>>>1,Le.dts=Le.pts,Ge&64&&(Le.dts=(Me[14]&14)<<27|(Me[15]&255)<<20|(Me[16]&254)<<12|(Me[17]&255)<<5|(Me[18]&254)>>>3,Le.dts*=4,Le.dts+=(Me[18]&6)>>>1)),Le.data=Me.subarray(9+Me[8]))},Te=function(Me,Le,Ge){var pt=new Uint8Array(Me.size),Gt={type:Le},Rt=0,Mi=0,Xi=!1,Er;if(!(!Me.data.length||Me.size<9)){for(Gt.trackId=Me.data[0].pid,Rt=0;Rt<Me.data.length;Rt++)Er=Me.data[Rt],pt.set(Er.data,Mi),Mi+=Er.data.byteLength;ye(pt,Gt),Xi=Le==="video"||Gt.packetLength<=Me.size,(Ge||Xi)&&(Me.size=0,Me.data.length=0),Xi&&S.trigger("data",Gt)}};Ac.prototype.init.call(this),this.push=function(Me){({pat:function(){},pes:function(){var Le,Ge;switch(Me.streamType){case Na.H264_STREAM_TYPE:Le=k,Ge="video";break;case Na.ADTS_STREAM_TYPE:Le=L,Ge="audio";break;case Na.METADATA_STREAM_TYPE:Le=j,Ge="timed-metadata";break;default:return}Me.payloadUnitStartIndicator&&Te(Le,Ge,!0),Le.data.push(Me),Le.size+=Me.data.byteLength},pmt:function(){var Le={type:"metadata",tracks:[]};Y=Me.programMapTable,Y.video!==null&&Le.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+Y.video,codec:"avc",type:"video"}),Y.audio!==null&&Le.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+Y.audio,codec:"adts",type:"audio"}),D=!0,S.trigger("data",Le)}})[Me.type]()},this.reset=function(){k.size=0,k.data.length=0,L.size=0,L.data.length=0,this.trigger("reset")},this.flushStreams_=function(){Te(k,"video"),Te(L,"audio"),Te(j,"timed-metadata")},this.flush=function(){if(!D&&Y){var Me={type:"metadata",tracks:[]};Y.video!==null&&Me.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+Y.video,codec:"avc",type:"video"}),Y.audio!==null&&Me.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+Y.audio,codec:"adts",type:"audio"}),S.trigger("data",Me)}D=!1,this.flushStreams_(),this.trigger("done")}},Ac.prototype=new Tl;var Eh={PAT_PID:0,MP2T_PACKET_LENGTH:xl,TransportPacketStream:Jn,TransportParseStream:cu,ElementaryStream:Ac,TimestampRolloverStream:wh,CaptionStream:fo.CaptionStream,Cea608Stream:fo.Cea608Stream,Cea708Stream:fo.Cea708Stream,MetadataStream:Bf};for(var sd in Na)Na.hasOwnProperty(sd)&&(Eh[sd]=Na[sd]);var Ch=Eh,ad=t,Sl=Ze.ONE_SECOND_IN_TS,ao,Ua=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];ao=function(S){var D,k=0;ao.prototype.init.call(this),this.skipWarn_=function(L,j){this.trigger("log",{level:"warn",message:`adts skiping bytes ${L} to ${j} in frame ${k} outside syncword`})},this.push=function(L){var j=0,Y,ye,Te,Me,Le;if(S||(k=0),L.type==="audio"){D&&D.length?(Te=D,D=new Uint8Array(Te.byteLength+L.data.byteLength),D.set(Te),D.set(L.data,Te.byteLength)):D=L.data;for(var Ge;j+7<D.length;){if(D[j]!==255||(D[j+1]&246)!==240){typeof Ge!="number"&&(Ge=j),j++;continue}if(typeof Ge=="number"&&(this.skipWarn_(Ge,j),Ge=null),ye=(~D[j+1]&1)*2,Y=(D[j+3]&3)<<11|D[j+4]<<3|(D[j+5]&224)>>5,Me=((D[j+6]&3)+1)*1024,Le=Me*Sl/Ua[(D[j+2]&60)>>>2],D.byteLength-j<Y)break;this.trigger("data",{pts:L.pts+k*Le,dts:L.dts+k*Le,sampleCount:Me,audioobjecttype:(D[j+2]>>>6&3)+1,channelcount:(D[j+2]&1)<<2|(D[j+3]&192)>>>6,samplerate:Ua[(D[j+2]&60)>>>2],samplingfrequencyindex:(D[j+2]&60)>>>2,samplesize:16,data:D.subarray(j+7+ye,j+Y)}),k++,j+=Y}typeof Ge=="number"&&(this.skipWarn_(Ge,j),Ge=null),D=D.subarray(j)}},this.flush=function(){k=0,this.trigger("done")},this.reset=function(){D=void 0,this.trigger("reset")},this.endTimeline=function(){D=void 0,this.trigger("endedtimeline")}},ao.prototype=new ad;var Al=ao,Zu;Zu=function(S){var D=S.byteLength,k=0,L=0;this.length=function(){return 8*D},this.bitsAvailable=function(){return 8*D+L},this.loadWord=function(){var j=S.byteLength-D,Y=new Uint8Array(4),ye=Math.min(4,D);if(ye===0)throw new Error("no bytes available");Y.set(S.subarray(j,j+ye)),k=new DataView(Y.buffer).getUint32(0),L=ye*8,D-=ye},this.skipBits=function(j){var Y;L>j?(k<<=j,L-=j):(j-=L,Y=Math.floor(j/8),j-=Y*8,D-=Y,this.loadWord(),k<<=j,L-=j)},this.readBits=function(j){var Y=Math.min(L,j),ye=k>>>32-Y;return L-=Y,L>0?k<<=Y:D>0&&this.loadWord(),Y=j-Y,Y>0?ye<<Y|this.readBits(Y):ye},this.skipLeadingZeros=function(){var j;for(j=0;j<L;++j)if((k&2147483648>>>j)!==0)return k<<=j,L-=j,j;return this.loadWord(),j+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var j=this.skipLeadingZeros();return this.readBits(j+1)-1},this.readExpGolomb=function(){var j=this.readUnsignedExpGolomb();return 1&j?1+j>>>1:-1*(j>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var wl=Zu,Mh=t,Nf=wl,Go,od,Dh;od=function(){var S=0,D,k;od.prototype.init.call(this),this.push=function(L){var j;k?(j=new Uint8Array(k.byteLength+L.data.byteLength),j.set(k),j.set(L.data,k.byteLength),k=j):k=L.data;for(var Y=k.byteLength;S<Y-3;S++)if(k[S+2]===1){D=S+5;break}for(;D<Y;)switch(k[D]){case 0:if(k[D-1]!==0){D+=2;break}else if(k[D-2]!==0){D++;break}S+3!==D-2&&this.trigger("data",k.subarray(S+3,D-2));do D++;while(k[D]!==1&&D<Y);S=D-2,D+=3;break;case 1:if(k[D-1]!==0||k[D-2]!==0){D+=3;break}this.trigger("data",k.subarray(S+3,D-2)),S=D-2,D+=3;break;default:D+=3;break}k=k.subarray(S),D-=S,S=0},this.reset=function(){k=null,S=0,this.trigger("reset")},this.flush=function(){k&&k.byteLength>3&&this.trigger("data",k.subarray(S+3)),k=null,S=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},od.prototype=new Mh,Dh={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},Go=function(){var S=new od,D,k,L,j,Y,ye,Te;Go.prototype.init.call(this),D=this,this.push=function(Me){Me.type==="video"&&(k=Me.trackId,L=Me.pts,j=Me.dts,S.push(Me))},S.on("data",function(Me){var Le={trackId:k,pts:L,dts:j,data:Me,nalUnitTypeCode:Me[0]&31};switch(Le.nalUnitTypeCode){case 5:Le.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:Le.nalUnitType="sei_rbsp",Le.escapedRBSP=Y(Me.subarray(1));break;case 7:Le.nalUnitType="seq_parameter_set_rbsp",Le.escapedRBSP=Y(Me.subarray(1)),Le.config=ye(Le.escapedRBSP);break;case 8:Le.nalUnitType="pic_parameter_set_rbsp";break;case 9:Le.nalUnitType="access_unit_delimiter_rbsp";break}D.trigger("data",Le)}),S.on("done",function(){D.trigger("done")}),S.on("partialdone",function(){D.trigger("partialdone")}),S.on("reset",function(){D.trigger("reset")}),S.on("endedtimeline",function(){D.trigger("endedtimeline")}),this.flush=function(){S.flush()},this.partialFlush=function(){S.partialFlush()},this.reset=function(){S.reset()},this.endTimeline=function(){S.endTimeline()},Te=function(Me,Le){var Ge=8,pt=8,Gt,Rt;for(Gt=0;Gt<Me;Gt++)pt!==0&&(Rt=Le.readExpGolomb(),pt=(Ge+Rt+256)%256),Ge=pt===0?Ge:pt},Y=function(Me){for(var Le=Me.byteLength,Ge=[],pt=1,Gt,Rt;pt<Le-2;)Me[pt]===0&&Me[pt+1]===0&&Me[pt+2]===3?(Ge.push(pt+2),pt+=2):pt++;if(Ge.length===0)return Me;Gt=Le-Ge.length,Rt=new Uint8Array(Gt);var Mi=0;for(pt=0;pt<Gt;Mi++,pt++)Mi===Ge[0]&&(Mi++,Ge.shift()),Rt[pt]=Me[Mi];return Rt},ye=function(Me){var Le=0,Ge=0,pt=0,Gt=0,Rt,Mi,Xi,Er,xn,Ko,xd,Sd,rs,lo,fr,ar=[1,1],Eo,ra;if(Rt=new Nf(Me),Mi=Rt.readUnsignedByte(),Er=Rt.readUnsignedByte(),Xi=Rt.readUnsignedByte(),Rt.skipUnsignedExpGolomb(),Dh[Mi]&&(xn=Rt.readUnsignedExpGolomb(),xn===3&&Rt.skipBits(1),Rt.skipUnsignedExpGolomb(),Rt.skipUnsignedExpGolomb(),Rt.skipBits(1),Rt.readBoolean()))for(fr=xn!==3?8:12,ra=0;ra<fr;ra++)Rt.readBoolean()&&(ra<6?Te(16,Rt):Te(64,Rt));if(Rt.skipUnsignedExpGolomb(),Ko=Rt.readUnsignedExpGolomb(),Ko===0)Rt.readUnsignedExpGolomb();else if(Ko===1)for(Rt.skipBits(1),Rt.skipExpGolomb(),Rt.skipExpGolomb(),xd=Rt.readUnsignedExpGolomb(),ra=0;ra<xd;ra++)Rt.skipExpGolomb();if(Rt.skipUnsignedExpGolomb(),Rt.skipBits(1),Sd=Rt.readUnsignedExpGolomb(),rs=Rt.readUnsignedExpGolomb(),lo=Rt.readBits(1),lo===0&&Rt.skipBits(1),Rt.skipBits(1),Rt.readBoolean()&&(Le=Rt.readUnsignedExpGolomb(),Ge=Rt.readUnsignedExpGolomb(),pt=Rt.readUnsignedExpGolomb(),Gt=Rt.readUnsignedExpGolomb()),Rt.readBoolean()&&Rt.readBoolean()){switch(Eo=Rt.readUnsignedByte(),Eo){case 1:ar=[1,1];break;case 2:ar=[12,11];break;case 3:ar=[10,11];break;case 4:ar=[16,11];break;case 5:ar=[40,33];break;case 6:ar=[24,11];break;case 7:ar=[20,11];break;case 8:ar=[32,11];break;case 9:ar=[80,33];break;case 10:ar=[18,11];break;case 11:ar=[15,11];break;case 12:ar=[64,33];break;case 13:ar=[160,99];break;case 14:ar=[4,3];break;case 15:ar=[3,2];break;case 16:ar=[2,1];break;case 255:{ar=[Rt.readUnsignedByte()<<8|Rt.readUnsignedByte(),Rt.readUnsignedByte()<<8|Rt.readUnsignedByte()];break}}ar&&ar[0]/ar[1]}return{profileIdc:Mi,levelIdc:Xi,profileCompatibility:Er,width:(Sd+1)*16-Le*2-Ge*2,height:(2-lo)*(rs+1)*16-pt*2-Gt*2,sarRatio:ar}}},Go.prototype=new Mh;var ld={H264Stream:Go},El=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],$o=function(S,D){var k=S[D+6]<<21|S[D+7]<<14|S[D+8]<<7|S[D+9],L=S[D+5],j=(L&16)>>4;return k=k>=0?k:0,j?k+20:k+10},oo=function(S,D){return S.length-D<10||S[D]!==73||S[D+1]!==68||S[D+2]!==51?D:(D+=$o(S,D),oo(S,D))},$s=function(S){var D=oo(S,0);return S.length>=D+2&&(S[D]&255)===255&&(S[D+1]&240)===240&&(S[D+1]&22)===16},Va=function(S){return S[0]<<21|S[1]<<14|S[2]<<7|S[3]},Cl=function(S,D,k){var L,j="";for(L=D;L<k;L++)j+="%"+("00"+S[L].toString(16)).slice(-2);return j},ud=function(S,D,k){return unescape(Cl(S,D,k))},Ih=function(S,D){var k=(S[D+5]&224)>>5,L=S[D+4]<<3,j=S[D+3]&6144;return j|L|k},Ph=function(S,D){return S[D]===73&&S[D+1]===68&&S[D+2]===51?"timed-metadata":S[D]&!0&&(S[D+1]&240)===240?"audio":null},Ml=function(S){for(var D=0;D+5<S.length;){if(S[D]!==255||(S[D+1]&246)!==240){D++;continue}return El[(S[D+2]&60)>>>2]}return null},cd=function(S){var D,k,L,j;D=10,S[5]&64&&(D+=4,D+=Va(S.subarray(10,14)));do{if(k=Va(S.subarray(D+4,D+8)),k<1)return null;if(j=String.fromCharCode(S[D],S[D+1],S[D+2],S[D+3]),j==="PRIV"){L=S.subarray(D+10,D+k+10);for(var Y=0;Y<L.byteLength;Y++)if(L[Y]===0){var ye=ud(L,0,Y);if(ye==="com.apple.streaming.transportStreamTimestamp"){var Te=L.subarray(Y+1),Me=(Te[3]&1)<<30|Te[4]<<22|Te[5]<<14|Te[6]<<6|Te[7]>>>2;return Me*=4,Me+=Te[7]&3,Me}break}}D+=10,D+=k}while(D<S.byteLength);return null},du={isLikelyAacData:$s,parseId3TagSize:$o,parseAdtsSize:Ih,parseType:Ph,parseSampleRate:Ml,parseAacTimestamp:cd},Dl=t,po=du,hu;hu=function(){var S=new Uint8Array,D=0;hu.prototype.init.call(this),this.setTimestamp=function(k){D=k},this.push=function(k){var L=0,j=0,Y,ye,Te,Me;for(S.length?(Me=S.length,S=new Uint8Array(k.byteLength+Me),S.set(S.subarray(0,Me)),S.set(k,Me)):S=k;S.length-j>=3;){if(S[j]===73&&S[j+1]===68&&S[j+2]===51){if(S.length-j<10||(L=po.parseId3TagSize(S,j),j+L>S.length))break;ye={type:"timed-metadata",data:S.subarray(j,j+L)},this.trigger("data",ye),j+=L;continue}else if((S[j]&255)===255&&(S[j+1]&240)===240){if(S.length-j<7||(L=po.parseAdtsSize(S,j),j+L>S.length))break;Te={type:"audio",data:S.subarray(j,j+L),pts:D,dts:D},this.trigger("data",Te),j+=L;continue}j++}Y=S.length-j,Y>0?S=S.subarray(j):S=new Uint8Array},this.reset=function(){S=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){S=new Uint8Array,this.trigger("endedtimeline")}},hu.prototype=new Dl;var Uf=hu,_r=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],dd=_r,Vf=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],Ts=Vf,mo=t,Wo=bt,go=bs,fu=pi,xs=jt,za=Ch,ks=Ze,$r=Al,qo=ld.H264Stream,Gi=Uf,At=du.isLikelyAacData,Os=Ze.ONE_SECOND_IN_TS,Xo=dd,pu=Ts,hd,dr,Ju,Yn,ec=function(S,D){D.stream=S,this.trigger("log",D)},Wr=function(S,D){for(var k=Object.keys(D),L=0;L<k.length;L++){var j=k[L];j==="headOfPipeline"||!D[j].on||D[j].on("log",ec.bind(S,j))}},Be=function(S,D){var k;if(S.length!==D.length)return!1;for(k=0;k<S.length;k++)if(S[k]!==D[k])return!1;return!0},fd=function(S,D,k,L,j,Y){var ye=k-D,Te=L-D,Me=j-k;return{start:{dts:S,pts:S+ye},end:{dts:S+Te,pts:S+Me},prependedContentDuration:Y,baseMediaDecodeTime:S}};dr=function(S,D){var k=[],L,j=0,Y=0,ye=1/0;D=D||{},L=D.firstSequenceNumber||0,dr.prototype.init.call(this),this.push=function(Te){xs.collectDtsInfo(S,Te),S&&Xo.forEach(function(Me){S[Me]=Te[Me]}),k.push(Te)},this.setEarliestDts=function(Te){j=Te},this.setVideoBaseMediaDecodeTime=function(Te){ye=Te},this.setAudioAppendStart=function(Te){Y=Te},this.flush=function(){var Te,Me,Le,Ge,pt,Gt,Rt;if(k.length===0){this.trigger("done","AudioSegmentStream");return}Te=fu.trimAdtsFramesByEarliestDts(k,S,j),S.baseMediaDecodeTime=xs.calculateTrackBaseMediaDecodeTime(S,D.keepOriginalTimestamps),Rt=fu.prefixWithSilence(S,Te,Y,ye),S.samples=fu.generateSampleTable(Te),Le=Wo.mdat(fu.concatenateFrameData(Te)),k=[],Me=Wo.moof(L,[S]),Ge=new Uint8Array(Me.byteLength+Le.byteLength),L++,Ge.set(Me),Ge.set(Le,Me.byteLength),xs.clearDtsInfo(S),pt=Math.ceil(Os*1024/S.samplerate),Te.length&&(Gt=Te.length*pt,this.trigger("segmentTimingInfo",fd(ks.audioTsToVideoTs(S.baseMediaDecodeTime,S.samplerate),Te[0].dts,Te[0].pts,Te[0].dts+Gt,Te[0].pts+Gt,Rt||0)),this.trigger("timingInfo",{start:Te[0].pts,end:Te[0].pts+Gt})),this.trigger("data",{track:S,boxes:Ge}),this.trigger("done","AudioSegmentStream")},this.reset=function(){xs.clearDtsInfo(S),k=[],this.trigger("reset")}},dr.prototype=new mo,hd=function(S,D){var k,L=[],j=[],Y,ye;D=D||{},k=D.firstSequenceNumber||0,hd.prototype.init.call(this),delete S.minPTS,this.gopCache_=[],this.push=function(Te){xs.collectDtsInfo(S,Te),Te.nalUnitType==="seq_parameter_set_rbsp"&&!Y&&(Y=Te.config,S.sps=[Te.data],pu.forEach(function(Me){S[Me]=Y[Me]},this)),Te.nalUnitType==="pic_parameter_set_rbsp"&&!ye&&(ye=Te.data,S.pps=[Te.data]),L.push(Te)},this.flush=function(){for(var Te,Me,Le,Ge,pt,Gt,Rt=0,Mi,Xi;L.length&&L[0].nalUnitType!=="access_unit_delimiter_rbsp";)L.shift();if(L.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(Te=go.groupNalsIntoFrames(L),Le=go.groupFramesIntoGops(Te),Le[0][0].keyFrame||(Me=this.getGopForFusion_(L[0],S),Me?(Rt=Me.duration,Le.unshift(Me),Le.byteLength+=Me.byteLength,Le.nalCount+=Me.nalCount,Le.pts=Me.pts,Le.dts=Me.dts,Le.duration+=Me.duration):Le=go.extendFirstKeyFrame(Le)),j.length){var Er;if(D.alignGopsAtEnd?Er=this.alignGopsAtEnd_(Le):Er=this.alignGopsAtStart_(Le),!Er){this.gopCache_.unshift({gop:Le.pop(),pps:S.pps,sps:S.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),L=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}xs.clearDtsInfo(S),Le=Er}xs.collectDtsInfo(S,Le),S.samples=go.generateSampleTable(Le),pt=Wo.mdat(go.concatenateNalData(Le)),S.baseMediaDecodeTime=xs.calculateTrackBaseMediaDecodeTime(S,D.keepOriginalTimestamps),this.trigger("processedGopsInfo",Le.map(function(xn){return{pts:xn.pts,dts:xn.dts,byteLength:xn.byteLength}})),Mi=Le[0],Xi=Le[Le.length-1],this.trigger("segmentTimingInfo",fd(S.baseMediaDecodeTime,Mi.dts,Mi.pts,Xi.dts+Xi.duration,Xi.pts+Xi.duration,Rt)),this.trigger("timingInfo",{start:Le[0].pts,end:Le[Le.length-1].pts+Le[Le.length-1].duration}),this.gopCache_.unshift({gop:Le.pop(),pps:S.pps,sps:S.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),L=[],this.trigger("baseMediaDecodeTime",S.baseMediaDecodeTime),this.trigger("timelineStartInfo",S.timelineStartInfo),Ge=Wo.moof(k,[S]),Gt=new Uint8Array(Ge.byteLength+pt.byteLength),k++,Gt.set(Ge),Gt.set(pt,Ge.byteLength),this.trigger("data",{track:S,boxes:Gt}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),L=[],this.gopCache_.length=0,j.length=0,this.trigger("reset")},this.resetStream_=function(){xs.clearDtsInfo(S),Y=void 0,ye=void 0},this.getGopForFusion_=function(Te){var Me=45e3,Le=1/0,Ge,pt,Gt,Rt,Mi;for(Mi=0;Mi<this.gopCache_.length;Mi++)Rt=this.gopCache_[Mi],Gt=Rt.gop,!(!(S.pps&&Be(S.pps[0],Rt.pps[0]))||!(S.sps&&Be(S.sps[0],Rt.sps[0])))&&(Gt.dts<S.timelineStartInfo.dts||(Ge=Te.dts-Gt.dts-Gt.duration,Ge>=-1e4&&Ge<=Me&&(!pt||Le>Ge)&&(pt=Rt,Le=Ge)));return pt?pt.gop:null},this.alignGopsAtStart_=function(Te){var Me,Le,Ge,pt,Gt,Rt,Mi,Xi;for(Gt=Te.byteLength,Rt=Te.nalCount,Mi=Te.duration,Me=Le=0;Me<j.length&&Le<Te.length&&(Ge=j[Me],pt=Te[Le],Ge.pts!==pt.pts);){if(pt.pts>Ge.pts){Me++;continue}Le++,Gt-=pt.byteLength,Rt-=pt.nalCount,Mi-=pt.duration}return Le===0?Te:Le===Te.length?null:(Xi=Te.slice(Le),Xi.byteLength=Gt,Xi.duration=Mi,Xi.nalCount=Rt,Xi.pts=Xi[0].pts,Xi.dts=Xi[0].dts,Xi)},this.alignGopsAtEnd_=function(Te){var Me,Le,Ge,pt,Gt,Rt;for(Me=j.length-1,Le=Te.length-1,Gt=null,Rt=!1;Me>=0&&Le>=0;){if(Ge=j[Me],pt=Te[Le],Ge.pts===pt.pts){Rt=!0;break}if(Ge.pts>pt.pts){Me--;continue}Me===j.length-1&&(Gt=Le),Le--}if(!Rt&&Gt===null)return null;var Mi;if(Rt?Mi=Le:Mi=Gt,Mi===0)return Te;var Xi=Te.slice(Mi),Er=Xi.reduce(function(xn,Ko){return xn.byteLength+=Ko.byteLength,xn.duration+=Ko.duration,xn.nalCount+=Ko.nalCount,xn},{byteLength:0,duration:0,nalCount:0});return Xi.byteLength=Er.byteLength,Xi.duration=Er.duration,Xi.nalCount=Er.nalCount,Xi.pts=Xi[0].pts,Xi.dts=Xi[0].dts,Xi},this.alignGopsWith=function(Te){j=Te}},hd.prototype=new mo,Yn=function(S,D){this.numberOfTracks=0,this.metadataStream=D,S=S||{},typeof S.remux<"u"?this.remuxTracks=!!S.remux:this.remuxTracks=!0,typeof S.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=S.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Yn.prototype.init.call(this),this.push=function(k){if(k.content||k.text)return this.pendingCaptions.push(k);if(k.frames)return this.pendingMetadata.push(k);this.pendingTracks.push(k.track),this.pendingBytes+=k.boxes.byteLength,k.track.type==="video"&&(this.videoTrack=k.track,this.pendingBoxes.push(k.boxes)),k.track.type==="audio"&&(this.audioTrack=k.track,this.pendingBoxes.unshift(k.boxes))}},Yn.prototype=new mo,Yn.prototype.flush=function(S){var D=0,k={captions:[],captionStreams:{},metadata:[],info:{}},L,j,Y,ye=0,Te;if(this.pendingTracks.length<this.numberOfTracks){if(S!=="VideoSegmentStream"&&S!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(ye=this.videoTrack.timelineStartInfo.pts,pu.forEach(function(Me){k.info[Me]=this.videoTrack[Me]},this)):this.audioTrack&&(ye=this.audioTrack.timelineStartInfo.pts,Xo.forEach(function(Me){k.info[Me]=this.audioTrack[Me]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?k.type=this.pendingTracks[0].type:k.type="combined",this.emittedTracks+=this.pendingTracks.length,Y=Wo.initSegment(this.pendingTracks),k.initSegment=new Uint8Array(Y.byteLength),k.initSegment.set(Y),k.data=new Uint8Array(this.pendingBytes),Te=0;Te<this.pendingBoxes.length;Te++)k.data.set(this.pendingBoxes[Te],D),D+=this.pendingBoxes[Te].byteLength;for(Te=0;Te<this.pendingCaptions.length;Te++)L=this.pendingCaptions[Te],L.startTime=ks.metadataTsToSeconds(L.startPts,ye,this.keepOriginalTimestamps),L.endTime=ks.metadataTsToSeconds(L.endPts,ye,this.keepOriginalTimestamps),k.captionStreams[L.stream]=!0,k.captions.push(L);for(Te=0;Te<this.pendingMetadata.length;Te++)j=this.pendingMetadata[Te],j.cueTime=ks.metadataTsToSeconds(j.pts,ye,this.keepOriginalTimestamps),k.metadata.push(j);for(k.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",k),Te=0;Te<k.captions.length;Te++)L=k.captions[Te],this.trigger("caption",L);for(Te=0;Te<k.metadata.length;Te++)j=k.metadata[Te],this.trigger("id3Frame",j)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Yn.prototype.setRemux=function(S){this.remuxTracks=S},Ju=function(S){var D=this,k=!0,L,j;Ju.prototype.init.call(this),S=S||{},this.baseMediaDecodeTime=S.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var Y={};this.transmuxPipeline_=Y,Y.type="aac",Y.metadataStream=new za.MetadataStream,Y.aacStream=new Gi,Y.audioTimestampRolloverStream=new za.TimestampRolloverStream("audio"),Y.timedMetadataTimestampRolloverStream=new za.TimestampRolloverStream("timed-metadata"),Y.adtsStream=new $r,Y.coalesceStream=new Yn(S,Y.metadataStream),Y.headOfPipeline=Y.aacStream,Y.aacStream.pipe(Y.audioTimestampRolloverStream).pipe(Y.adtsStream),Y.aacStream.pipe(Y.timedMetadataTimestampRolloverStream).pipe(Y.metadataStream).pipe(Y.coalesceStream),Y.metadataStream.on("timestamp",function(ye){Y.aacStream.setTimestamp(ye.timeStamp)}),Y.aacStream.on("data",function(ye){ye.type!=="timed-metadata"&&ye.type!=="audio"||Y.audioSegmentStream||(j=j||{timelineStartInfo:{baseMediaDecodeTime:D.baseMediaDecodeTime},codec:"adts",type:"audio"},Y.coalesceStream.numberOfTracks++,Y.audioSegmentStream=new dr(j,S),Y.audioSegmentStream.on("log",D.getLogTrigger_("audioSegmentStream")),Y.audioSegmentStream.on("timingInfo",D.trigger.bind(D,"audioTimingInfo")),Y.adtsStream.pipe(Y.audioSegmentStream).pipe(Y.coalesceStream),D.trigger("trackinfo",{hasAudio:!!j,hasVideo:!!L}))}),Y.coalesceStream.on("data",this.trigger.bind(this,"data")),Y.coalesceStream.on("done",this.trigger.bind(this,"done")),Wr(this,Y)},this.setupTsPipeline=function(){var Y={};this.transmuxPipeline_=Y,Y.type="ts",Y.metadataStream=new za.MetadataStream,Y.packetStream=new za.TransportPacketStream,Y.parseStream=new za.TransportParseStream,Y.elementaryStream=new za.ElementaryStream,Y.timestampRolloverStream=new za.TimestampRolloverStream,Y.adtsStream=new $r,Y.h264Stream=new qo,Y.captionStream=new za.CaptionStream(S),Y.coalesceStream=new Yn(S,Y.metadataStream),Y.headOfPipeline=Y.packetStream,Y.packetStream.pipe(Y.parseStream).pipe(Y.elementaryStream).pipe(Y.timestampRolloverStream),Y.timestampRolloverStream.pipe(Y.h264Stream),Y.timestampRolloverStream.pipe(Y.adtsStream),Y.timestampRolloverStream.pipe(Y.metadataStream).pipe(Y.coalesceStream),Y.h264Stream.pipe(Y.captionStream).pipe(Y.coalesceStream),Y.elementaryStream.on("data",function(ye){var Te;if(ye.type==="metadata"){for(Te=ye.tracks.length;Te--;)!L&&ye.tracks[Te].type==="video"?(L=ye.tracks[Te],L.timelineStartInfo.baseMediaDecodeTime=D.baseMediaDecodeTime):!j&&ye.tracks[Te].type==="audio"&&(j=ye.tracks[Te],j.timelineStartInfo.baseMediaDecodeTime=D.baseMediaDecodeTime);L&&!Y.videoSegmentStream&&(Y.coalesceStream.numberOfTracks++,Y.videoSegmentStream=new hd(L,S),Y.videoSegmentStream.on("log",D.getLogTrigger_("videoSegmentStream")),Y.videoSegmentStream.on("timelineStartInfo",function(Me){j&&!S.keepOriginalTimestamps&&(j.timelineStartInfo=Me,Y.audioSegmentStream.setEarliestDts(Me.dts-D.baseMediaDecodeTime))}),Y.videoSegmentStream.on("processedGopsInfo",D.trigger.bind(D,"gopInfo")),Y.videoSegmentStream.on("segmentTimingInfo",D.trigger.bind(D,"videoSegmentTimingInfo")),Y.videoSegmentStream.on("baseMediaDecodeTime",function(Me){j&&Y.audioSegmentStream.setVideoBaseMediaDecodeTime(Me)}),Y.videoSegmentStream.on("timingInfo",D.trigger.bind(D,"videoTimingInfo")),Y.h264Stream.pipe(Y.videoSegmentStream).pipe(Y.coalesceStream)),j&&!Y.audioSegmentStream&&(Y.coalesceStream.numberOfTracks++,Y.audioSegmentStream=new dr(j,S),Y.audioSegmentStream.on("log",D.getLogTrigger_("audioSegmentStream")),Y.audioSegmentStream.on("timingInfo",D.trigger.bind(D,"audioTimingInfo")),Y.audioSegmentStream.on("segmentTimingInfo",D.trigger.bind(D,"audioSegmentTimingInfo")),Y.adtsStream.pipe(Y.audioSegmentStream).pipe(Y.coalesceStream)),D.trigger("trackinfo",{hasAudio:!!j,hasVideo:!!L})}}),Y.coalesceStream.on("data",this.trigger.bind(this,"data")),Y.coalesceStream.on("id3Frame",function(ye){ye.dispatchType=Y.metadataStream.dispatchType,D.trigger("id3Frame",ye)}),Y.coalesceStream.on("caption",this.trigger.bind(this,"caption")),Y.coalesceStream.on("done",this.trigger.bind(this,"done")),Wr(this,Y)},this.setBaseMediaDecodeTime=function(Y){var ye=this.transmuxPipeline_;S.keepOriginalTimestamps||(this.baseMediaDecodeTime=Y),j&&(j.timelineStartInfo.dts=void 0,j.timelineStartInfo.pts=void 0,xs.clearDtsInfo(j),ye.audioTimestampRolloverStream&&ye.audioTimestampRolloverStream.discontinuity()),L&&(ye.videoSegmentStream&&(ye.videoSegmentStream.gopCache_=[]),L.timelineStartInfo.dts=void 0,L.timelineStartInfo.pts=void 0,xs.clearDtsInfo(L),ye.captionStream.reset()),ye.timestampRolloverStream&&ye.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(Y){j&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(Y)},this.setRemux=function(Y){var ye=this.transmuxPipeline_;S.remux=Y,ye&&ye.coalesceStream&&ye.coalesceStream.setRemux(Y)},this.alignGopsWith=function(Y){L&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(Y)},this.getLogTrigger_=function(Y){var ye=this;return function(Te){Te.stream=Y,ye.trigger("log",Te)}},this.push=function(Y){if(k){var ye=At(Y);ye&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!ye&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),k=!1}this.transmuxPipeline_.headOfPipeline.push(Y)},this.flush=function(){k=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Ju.prototype=new mo;var Lh={Transmuxer:Ju},vo=function(S){return S>>>0},pd=function(S){return("00"+S.toString(16)).slice(-2)},Ea={toUnsigned:vo,toHexString:pd},tc=function(S){var D="";return D+=String.fromCharCode(S[0]),D+=String.fromCharCode(S[1]),D+=String.fromCharCode(S[2]),D+=String.fromCharCode(S[3]),D},mu=tc,gu=Ea.toUnsigned,vu=mu,yo=function(S,D){var k=[],L,j,Y,ye,Te;if(!D.length)return null;for(L=0;L<S.byteLength;)j=gu(S[L]<<24|S[L+1]<<16|S[L+2]<<8|S[L+3]),Y=vu(S.subarray(L+4,L+8)),ye=j>1?L+j:S.byteLength,Y===D[0]&&(D.length===1?k.push(S.subarray(L+8,ye)):(Te=yo(S.subarray(L+8,ye),D.slice(1)),Te.length&&(k=k.concat(Te)))),L=ye;return k},Ca=yo,Il=Ea.toUnsigned,yu=s.getUint64,Ec=function(S){var D={version:S[0],flags:new Uint8Array(S.subarray(1,4))};return D.version===1?D.baseMediaDecodeTime=yu(S.subarray(4)):D.baseMediaDecodeTime=Il(S[4]<<24|S[5]<<16|S[6]<<8|S[7]),D},Pl=Ec,Ll=function(S){var D=new DataView(S.buffer,S.byteOffset,S.byteLength),k={version:S[0],flags:new Uint8Array(S.subarray(1,4)),trackId:D.getUint32(4)},L=k.flags[2]&1,j=k.flags[2]&2,Y=k.flags[2]&8,ye=k.flags[2]&16,Te=k.flags[2]&32,Me=k.flags[0]&65536,Le=k.flags[0]&131072,Ge;return Ge=8,L&&(Ge+=4,k.baseDataOffset=D.getUint32(12),Ge+=4),j&&(k.sampleDescriptionIndex=D.getUint32(Ge),Ge+=4),Y&&(k.defaultSampleDuration=D.getUint32(Ge),Ge+=4),ye&&(k.defaultSampleSize=D.getUint32(Ge),Ge+=4),Te&&(k.defaultSampleFlags=D.getUint32(Ge)),Me&&(k.durationIsEmpty=!0),!L&&Le&&(k.baseDataOffsetIsMoof=!0),k},_o=Ll,zf=function(S){return{isLeading:(S[0]&12)>>>2,dependsOn:S[0]&3,isDependedOn:(S[1]&192)>>>6,hasRedundancy:(S[1]&48)>>>4,paddingValue:(S[1]&14)>>>1,isNonSyncSample:S[1]&1,degradationPriority:S[2]<<8|S[3]}},Rl=zf,Ws=Rl,er=function(S){var D={version:S[0],flags:new Uint8Array(S.subarray(1,4)),samples:[]},k=new DataView(S.buffer,S.byteOffset,S.byteLength),L=D.flags[2]&1,j=D.flags[2]&4,Y=D.flags[1]&1,ye=D.flags[1]&2,Te=D.flags[1]&4,Me=D.flags[1]&8,Le=k.getUint32(4),Ge=8,pt;for(L&&(D.dataOffset=k.getInt32(Ge),Ge+=4),j&&Le&&(pt={flags:Ws(S.subarray(Ge,Ge+4))},Ge+=4,Y&&(pt.duration=k.getUint32(Ge),Ge+=4),ye&&(pt.size=k.getUint32(Ge),Ge+=4),Me&&(D.version===1?pt.compositionTimeOffset=k.getInt32(Ge):pt.compositionTimeOffset=k.getUint32(Ge),Ge+=4),D.samples.push(pt),Le--);Le--;)pt={},Y&&(pt.duration=k.getUint32(Ge),Ge+=4),ye&&(pt.size=k.getUint32(Ge),Ge+=4),Te&&(pt.flags=Ws(S.subarray(Ge,Ge+4)),Ge+=4),Me&&(D.version===1?pt.compositionTimeOffset=k.getInt32(Ge):pt.compositionTimeOffset=k.getUint32(Ge),Ge+=4),D.samples.push(pt);return D},Ha=er,br={tfdt:Pl,trun:Ha},Ma={parseTfdt:br.tfdt,parseTrun:br.trun},md=function(S){for(var D=0,k=String.fromCharCode(S[D]),L="";k!=="\0";)L+=k,D++,k=String.fromCharCode(S[D]);return L+=k,L},gd={uint8ToCString:md},Yo=gd.uint8ToCString,fn=s.getUint64,bo=function(S){var D=4,k=S[0],L,j,Y,ye,Te,Me,Le,Ge;if(k===0){L=Yo(S.subarray(D)),D+=L.length,j=Yo(S.subarray(D)),D+=j.length;var pt=new DataView(S.buffer);Y=pt.getUint32(D),D+=4,Te=pt.getUint32(D),D+=4,Me=pt.getUint32(D),D+=4,Le=pt.getUint32(D),D+=4}else if(k===1){var pt=new DataView(S.buffer);Y=pt.getUint32(D),D+=4,ye=fn(S.subarray(D)),D+=8,Me=pt.getUint32(D),D+=4,Le=pt.getUint32(D),D+=4,L=Yo(S.subarray(D)),D+=L.length,j=Yo(S.subarray(D)),D+=j.length}Ge=new Uint8Array(S.subarray(D,S.byteLength));var Gt={scheme_id_uri:L,value:j,timescale:Y||1,presentation_time:ye,presentation_time_delta:Te,event_duration:Me,id:Le,message_data:Ge};return Vp(k,Gt)?Gt:void 0},ia=function(S,D,k,L){return S||S===0?S/D:L+k/D},Vp=function(S,D){var k=D.scheme_id_uri!=="\0",L=S===0&&Cc(D.presentation_time_delta)&&k,j=S===1&&Cc(D.presentation_time)&&k;return!(S>1)&&L||j},Cc=function(S){return S!==void 0||S!==null},kl={parseEmsgBox:bo,scaleTime:ia},To;typeof window<"u"?To=window:typeof r<"u"?To=r:typeof self<"u"?To=self:To={};var le=To,E=Ea.toUnsigned,F=Ea.toHexString,R=Ca,V=mu,Q=kl,ee=_o,_e=Ha,Ce=Pl,Ve=s.getUint64,Oe,Qe,kt,ui,yi,si,qi,qr=le,Li=Ku.parseId3Frames;Oe=function(S){var D={},k=R(S,["moov","trak"]);return k.reduce(function(L,j){var Y,ye,Te,Me,Le;return Y=R(j,["tkhd"])[0],!Y||(ye=Y[0],Te=ye===0?12:20,Me=E(Y[Te]<<24|Y[Te+1]<<16|Y[Te+2]<<8|Y[Te+3]),Le=R(j,["mdia","mdhd"])[0],!Le)?null:(ye=Le[0],Te=ye===0?12:20,L[Me]=E(Le[Te]<<24|Le[Te+1]<<16|Le[Te+2]<<8|Le[Te+3]),L)},D)},Qe=function(S,D){var k;k=R(D,["moof","traf"]);var L=k.reduce(function(j,Y){var ye=R(Y,["tfhd"])[0],Te=E(ye[4]<<24|ye[5]<<16|ye[6]<<8|ye[7]),Me=S[Te]||9e4,Le=R(Y,["tfdt"])[0],Ge=new DataView(Le.buffer,Le.byteOffset,Le.byteLength),pt;Le[0]===1?pt=Ve(Le.subarray(4,12)):pt=Ge.getUint32(4);let Gt;return typeof pt=="bigint"?Gt=pt/qr.BigInt(Me):typeof pt=="number"&&!isNaN(pt)&&(Gt=pt/Me),Gt<Number.MAX_SAFE_INTEGER&&(Gt=Number(Gt)),Gt<j&&(j=Gt),j},1/0);return typeof L=="bigint"||isFinite(L)?L:0},kt=function(S,D){var k=R(D,["moof","traf"]),L=0,j=0,Y;if(k&&k.length){var ye=R(k[0],["tfhd"])[0],Te=R(k[0],["trun"])[0],Me=R(k[0],["tfdt"])[0];if(ye){var Le=ee(ye);Y=Le.trackId}if(Me){var Ge=Ce(Me);L=Ge.baseMediaDecodeTime}if(Te){var pt=_e(Te);pt.samples&&pt.samples.length&&(j=pt.samples[0].compositionTimeOffset||0)}}var Gt=S[Y]||9e4;typeof L=="bigint"&&(j=qr.BigInt(j),Gt=qr.BigInt(Gt));var Rt=(L+j)/Gt;return typeof Rt=="bigint"&&Rt<Number.MAX_SAFE_INTEGER&&(Rt=Number(Rt)),Rt},ui=function(S){var D=R(S,["moov","trak"]),k=[];return D.forEach(function(L){var j=R(L,["mdia","hdlr"]),Y=R(L,["tkhd"]);j.forEach(function(ye,Te){var Me=V(ye.subarray(8,12)),Le=Y[Te],Ge,pt,Gt;Me==="vide"&&(Ge=new DataView(Le.buffer,Le.byteOffset,Le.byteLength),pt=Ge.getUint8(0),Gt=pt===0?Ge.getUint32(12):Ge.getUint32(20),k.push(Gt))})}),k},si=function(S){var D=S[0],k=D===0?12:20;return E(S[k]<<24|S[k+1]<<16|S[k+2]<<8|S[k+3])},yi=function(S){var D=R(S,["moov","trak"]),k=[];return D.forEach(function(L){var j={},Y=R(L,["tkhd"])[0],ye,Te;Y&&(ye=new DataView(Y.buffer,Y.byteOffset,Y.byteLength),Te=ye.getUint8(0),j.id=Te===0?ye.getUint32(12):ye.getUint32(20));var Me=R(L,["mdia","hdlr"])[0];if(Me){var Le=V(Me.subarray(8,12));Le==="vide"?j.type="video":Le==="soun"?j.type="audio":j.type=Le}var Ge=R(L,["mdia","minf","stbl","stsd"])[0];if(Ge){var pt=Ge.subarray(8);j.codec=V(pt.subarray(4,8));var Gt=R(pt,[j.codec])[0],Rt,Mi;Gt&&(/^[asm]vc[1-9]$/i.test(j.codec)?(Rt=Gt.subarray(78),Mi=V(Rt.subarray(4,8)),Mi==="avcC"&&Rt.length>11?(j.codec+=".",j.codec+=F(Rt[9]),j.codec+=F(Rt[10]),j.codec+=F(Rt[11])):j.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(j.codec)?(Rt=Gt.subarray(28),Mi=V(Rt.subarray(4,8)),Mi==="esds"&&Rt.length>20&&Rt[19]!==0?(j.codec+="."+F(Rt[19]),j.codec+="."+F(Rt[20]>>>2&63).replace(/^0/,"")):j.codec="mp4a.40.2"):j.codec=j.codec.toLowerCase())}var Xi=R(L,["mdia","mdhd"])[0];Xi&&(j.timescale=si(Xi)),k.push(j)}),k},qi=function(S,D=0){var k=R(S,["emsg"]);return k.map(L=>{var j=Q.parseEmsgBox(new Uint8Array(L)),Y=Li(j.message_data);return{cueTime:Q.scaleTime(j.presentation_time,j.timescale,j.presentation_time_delta,D),duration:Q.scaleTime(j.event_duration,j.timescale),frames:Y}})};var Ss={findBox:R,parseType:V,timescale:Oe,startTime:Qe,compositionStartTime:kt,videoTrackIds:ui,tracks:yi,getTimescaleFromMediaHeader:si,getEmsgID3:qi};const{parseTrun:Mc}=Ma,{findBox:_u}=Ss;var Da=le,Ia=function(S){var D=_u(S,["moof","traf"]),k=_u(S,["mdat"]),L=[];return k.forEach(function(j,Y){var ye=D[Y];L.push({mdat:j,traf:ye})}),L},ma=function(S,D,k){var L=D,j=k.defaultSampleDuration||0,Y=k.defaultSampleSize||0,ye=k.trackId,Te=[];return S.forEach(function(Me){var Le=Mc(Me),Ge=Le.samples;Ge.forEach(function(pt){pt.duration===void 0&&(pt.duration=j),pt.size===void 0&&(pt.size=Y),pt.trackId=ye,pt.dts=L,pt.compositionTimeOffset===void 0&&(pt.compositionTimeOffset=0),typeof L=="bigint"?(pt.pts=L+Da.BigInt(pt.compositionTimeOffset),L+=Da.BigInt(pt.duration)):(pt.pts=L+pt.compositionTimeOffset,L+=pt.duration)}),Te=Te.concat(Ge)}),Te},xo={getMdatTrafPairs:Ia,parseSamples:ma},sr=pa.discardEmulationPreventionBytes,Ol=zo.CaptionStream,Fs=Ca,zp=Pl,Hf=_o,{getMdatTrafPairs:jf,parseSamples:Gf}=xo,ga=function(S,D){for(var k=S,L=0;L<D.length;L++){var j=D[L];if(k<j.size)return j;k-=j.size}return null},Hp=function(S,D,k){var L=new DataView(S.buffer,S.byteOffset,S.byteLength),j={logs:[],seiNals:[]},Y,ye,Te,Me;for(ye=0;ye+4<S.length;ye+=Te)if(Te=L.getUint32(ye),ye+=4,!(Te<=0))switch(S[ye]&31){case 6:var Le=S.subarray(ye+1,ye+1+Te),Ge=ga(ye,D);if(Y={nalUnitType:"sei_rbsp",size:Te,data:Le,escapedRBSP:sr(Le),trackId:k},Ge)Y.pts=Ge.pts,Y.dts=Ge.dts,Me=Ge;else if(Me)Y.pts=Me.pts,Y.dts=Me.dts;else{j.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+ye+" for trackId "+k+". See mux.js#223."});break}j.seiNals.push(Y);break}return j},qs=function(S,D){var k={},L=jf(S);return L.forEach(function(j){var Y=j.mdat,ye=j.traf,Te=Fs(ye,["tfhd"]),Me=Hf(Te[0]),Le=Me.trackId,Ge=Fs(ye,["tfdt"]),pt=Ge.length>0?zp(Ge[0]).baseMediaDecodeTime:0,Gt=Fs(ye,["trun"]),Rt,Mi;D===Le&&Gt.length>0&&(Rt=Gf(Gt,pt,Me),Mi=Hp(Y,Rt,Le),k[Le]||(k[Le]={seiNals:[],logs:[]}),k[Le].seiNals=k[Le].seiNals.concat(Mi.seiNals),k[Le].logs=k[Le].logs.concat(Mi.logs))}),k},vd=function(S,D,k){var L;if(D===null)return null;L=qs(S,D);var j=L[D]||{};return{seiNals:j.seiNals,logs:j.logs,timescale:k}},Rh=function(){var S=!1,D,k,L,j,Y,ye;this.isInitialized=function(){return S},this.init=function(Te){D=new Ol,S=!0,ye=Te?Te.isPartial:!1,D.on("data",function(Me){Me.startTime=Me.startPts/j,Me.endTime=Me.endPts/j,Y.captions.push(Me),Y.captionStreams[Me.stream]=!0}),D.on("log",function(Me){Y.logs.push(Me)})},this.isNewInit=function(Te,Me){return Te&&Te.length===0||Me&&typeof Me=="object"&&Object.keys(Me).length===0?!1:L!==Te[0]||j!==Me[L]},this.parse=function(Te,Me,Le){var Ge;if(this.isInitialized()){if(!Me||!Le)return null;if(this.isNewInit(Me,Le))L=Me[0],j=Le[L];else if(L===null||!j)return k.push(Te),null}else return null;for(;k.length>0;){var pt=k.shift();this.parse(pt,Me,Le)}return Ge=vd(Te,L,j),Ge&&Ge.logs&&(Y.logs=Y.logs.concat(Ge.logs)),Ge===null||!Ge.seiNals?Y.logs.length?{logs:Y.logs,captions:[],captionStreams:[]}:null:(this.pushNals(Ge.seiNals),this.flushStream(),Y)},this.pushNals=function(Te){if(!this.isInitialized()||!Te||Te.length===0)return null;Te.forEach(function(Me){D.push(Me)})},this.flushStream=function(){if(!this.isInitialized())return null;ye?D.partialFlush():D.flush()},this.clearParsedCaptions=function(){Y.captions=[],Y.captionStreams={},Y.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;D.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){k=[],L=null,j=null,Y?this.clearParsedCaptions():Y={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},jp=Rh;const{parseTfdt:Gp}=Ma,Fi=Ca,{getTimescaleFromMediaHeader:gv}=Ss,{parseSamples:ig,getMdatTrafPairs:Ji}=xo;var wr=function(){let S=9e4;this.init=function(D){const k=Fi(D,["moov","trak","mdia","mdhd"])[0];k&&(S=gv(k))},this.parseSegment=function(D){const k=[],L=Ji(D);let j=0;return L.forEach(function(Y){const ye=Y.mdat,Te=Y.traf,Me=Fi(Te,["tfdt"])[0],Le=Fi(Te,["tfhd"])[0],Ge=Fi(Te,["trun"]);if(Me&&(j=Gp(Me).baseMediaDecodeTime),Ge.length&&Le){const pt=ig(Ge,j,Le);let Gt=0;pt.forEach(function(Rt){const Mi="utf-8",Xi=new TextDecoder(Mi),Er=ye.slice(Gt,Gt+Rt.size);if(Fi(Er,["vtte"])[0]){Gt+=Rt.size;return}Fi(Er,["vttc"]).forEach(function(xd){const Sd=Fi(xd,["payl"])[0],rs=Fi(xd,["sttg"])[0],lo=Rt.pts/S,fr=(Rt.pts+Rt.duration)/S;let ar,Eo;if(Sd)try{ar=Xi.decode(Sd)}catch(ra){console.error(ra)}if(rs)try{Eo=Xi.decode(rs)}catch(ra){console.error(ra)}Rt.duration&&ar&&k.push({cueText:ar,start:lo,end:fr,settings:Eo})}),Gt+=Rt.size})}}),k}},bu=xc,pn=function(S){var D=S[1]&31;return D<<=8,D|=S[2],D},Dc=function(S){return!!(S[1]&64)},ic=function(S){var D=0;return(S[3]&48)>>>4>1&&(D+=S[4]+1),D},Ic=function(S,D){var k=pn(S);return k===0?"pat":k===D?"pmt":D?"pes":null},yd=function(S){var D=Dc(S),k=4+ic(S);return D&&(k+=S[k]+1),(S[k+10]&31)<<8|S[k+11]},Fl=function(S){var D={},k=Dc(S),L=4+ic(S);if(k&&(L+=S[L]+1),!!(S[L+5]&1)){var j,Y,ye;j=(S[L+1]&15)<<8|S[L+2],Y=3+j-4,ye=(S[L+10]&15)<<8|S[L+11];for(var Te=12+ye;Te<Y;){var Me=L+Te;D[(S[Me+1]&31)<<8|S[Me+2]]=S[Me],Te+=((S[Me+3]&15)<<8|S[Me+4])+5}return D}},$f=function(S,D){var k=pn(S),L=D[k];switch(L){case bu.H264_STREAM_TYPE:return"video";case bu.ADTS_STREAM_TYPE:return"audio";case bu.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},kh=function(S){var D=Dc(S);if(!D)return null;var k=4+ic(S);if(k>=S.byteLength)return null;var L=null,j;return j=S[k+7],j&192&&(L={},L.pts=(S[k+9]&14)<<27|(S[k+10]&255)<<20|(S[k+11]&254)<<12|(S[k+12]&255)<<5|(S[k+13]&254)>>>3,L.pts*=4,L.pts+=(S[k+13]&6)>>>1,L.dts=L.pts,j&64&&(L.dts=(S[k+14]&14)<<27|(S[k+15]&255)<<20|(S[k+16]&254)<<12|(S[k+17]&255)<<5|(S[k+18]&254)>>>3,L.dts*=4,L.dts+=(S[k+18]&6)>>>1)),L},_d=function(S){switch(S){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},Xr=function(S){for(var D=4+ic(S),k=S.subarray(D),L=0,j=0,Y=!1,ye;j<k.byteLength-3;j++)if(k[j+2]===1){L=j+5;break}for(;L<k.byteLength;)switch(k[L]){case 0:if(k[L-1]!==0){L+=2;break}else if(k[L-2]!==0){L++;break}j+3!==L-2&&(ye=_d(k[j+3]&31),ye==="slice_layer_without_partitioning_rbsp_idr"&&(Y=!0));do L++;while(k[L]!==1&&L<k.length);j=L-2,L+=3;break;case 1:if(k[L-1]!==0||k[L-2]!==0){L+=3;break}ye=_d(k[j+3]&31),ye==="slice_layer_without_partitioning_rbsp_idr"&&(Y=!0),j=L-2,L+=3;break;default:L+=3;break}return k=k.subarray(j),L-=j,j=0,k&&k.byteLength>3&&(ye=_d(k[j+3]&31),ye==="slice_layer_without_partitioning_rbsp_idr"&&(Y=!0)),Y},bd={parseType:Ic,parsePat:yd,parsePmt:Fl,parsePayloadUnitStartIndicator:Dc,parsePesType:$f,parsePesTime:kh,videoPacketContainsKeyFrame:Xr},Td=xc,nc=Qu.handleRollover,tr={};tr.ts=bd,tr.aac=du;var Tu=Ze.ONE_SECOND_IN_TS,Rr=188,So=71,Pc=function(S,D){for(var k=0,L=Rr,j,Y;L<S.byteLength;){if(S[k]===So&&S[L]===So){switch(j=S.subarray(k,L),Y=tr.ts.parseType(j,D.pid),Y){case"pat":D.pid=tr.ts.parsePat(j);break;case"pmt":var ye=tr.ts.parsePmt(j);D.table=D.table||{},Object.keys(ye).forEach(function(Te){D.table[Te]=ye[Te]});break}k+=Rr,L+=Rr;continue}k++,L++}},ja=function(S,D,k){for(var L=0,j=Rr,Y,ye,Te,Me,Le,Ge=!1;j<=S.byteLength;){if(S[L]===So&&(S[j]===So||j===S.byteLength)){switch(Y=S.subarray(L,j),ye=tr.ts.parseType(Y,D.pid),ye){case"pes":Te=tr.ts.parsePesType(Y,D.table),Me=tr.ts.parsePayloadUnitStartIndicator(Y),Te==="audio"&&Me&&(Le=tr.ts.parsePesTime(Y),Le&&(Le.type="audio",k.audio.push(Le),Ge=!0));break}if(Ge)break;L+=Rr,j+=Rr;continue}L++,j++}for(j=S.byteLength,L=j-Rr,Ge=!1;L>=0;){if(S[L]===So&&(S[j]===So||j===S.byteLength)){switch(Y=S.subarray(L,j),ye=tr.ts.parseType(Y,D.pid),ye){case"pes":Te=tr.ts.parsePesType(Y,D.table),Me=tr.ts.parsePayloadUnitStartIndicator(Y),Te==="audio"&&Me&&(Le=tr.ts.parsePesTime(Y),Le&&(Le.type="audio",k.audio.push(Le),Ge=!0));break}if(Ge)break;L-=Rr,j-=Rr;continue}L--,j--}},Oh=function(S,D,k){for(var L=0,j=Rr,Y,ye,Te,Me,Le,Ge,pt,Gt,Rt=!1,Mi={data:[],size:0};j<S.byteLength;){if(S[L]===So&&S[j]===So){switch(Y=S.subarray(L,j),ye=tr.ts.parseType(Y,D.pid),ye){case"pes":if(Te=tr.ts.parsePesType(Y,D.table),Me=tr.ts.parsePayloadUnitStartIndicator(Y),Te==="video"&&(Me&&!Rt&&(Le=tr.ts.parsePesTime(Y),Le&&(Le.type="video",k.video.push(Le),Rt=!0)),!k.firstKeyFrame)){if(Me&&Mi.size!==0){for(Ge=new Uint8Array(Mi.size),pt=0;Mi.data.length;)Gt=Mi.data.shift(),Ge.set(Gt,pt),pt+=Gt.byteLength;if(tr.ts.videoPacketContainsKeyFrame(Ge)){var Xi=tr.ts.parsePesTime(Ge);Xi?(k.firstKeyFrame=Xi,k.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}Mi.size=0}Mi.data.push(Y),Mi.size+=Y.byteLength}break}if(Rt&&k.firstKeyFrame)break;L+=Rr,j+=Rr;continue}L++,j++}for(j=S.byteLength,L=j-Rr,Rt=!1;L>=0;){if(S[L]===So&&S[j]===So){switch(Y=S.subarray(L,j),ye=tr.ts.parseType(Y,D.pid),ye){case"pes":Te=tr.ts.parsePesType(Y,D.table),Me=tr.ts.parsePayloadUnitStartIndicator(Y),Te==="video"&&Me&&(Le=tr.ts.parsePesTime(Y),Le&&(Le.type="video",k.video.push(Le),Rt=!0));break}if(Rt)break;L-=Rr,j-=Rr;continue}L--,j--}},As=function(S,D){if(S.audio&&S.audio.length){var k=D;(typeof k>"u"||isNaN(k))&&(k=S.audio[0].dts),S.audio.forEach(function(Y){Y.dts=nc(Y.dts,k),Y.pts=nc(Y.pts,k),Y.dtsTime=Y.dts/Tu,Y.ptsTime=Y.pts/Tu})}if(S.video&&S.video.length){var L=D;if((typeof L>"u"||isNaN(L))&&(L=S.video[0].dts),S.video.forEach(function(Y){Y.dts=nc(Y.dts,L),Y.pts=nc(Y.pts,L),Y.dtsTime=Y.dts/Tu,Y.ptsTime=Y.pts/Tu}),S.firstKeyFrame){var j=S.firstKeyFrame;j.dts=nc(j.dts,L),j.pts=nc(j.pts,L),j.dtsTime=j.dts/Tu,j.ptsTime=j.pts/Tu}}},$n=function(S){for(var D=!1,k=0,L=null,j=null,Y=0,ye=0,Te;S.length-ye>=3;){var Me=tr.aac.parseType(S,ye);switch(Me){case"timed-metadata":if(S.length-ye<10){D=!0;break}if(Y=tr.aac.parseId3TagSize(S,ye),Y>S.length){D=!0;break}j===null&&(Te=S.subarray(ye,ye+Y),j=tr.aac.parseAacTimestamp(Te)),ye+=Y;break;case"audio":if(S.length-ye<7){D=!0;break}if(Y=tr.aac.parseAdtsSize(S,ye),Y>S.length){D=!0;break}L===null&&(Te=S.subarray(ye,ye+Y),L=tr.aac.parseSampleRate(Te)),k++,ye+=Y;break;default:ye++;break}if(D)return null}if(L===null||j===null)return null;var Le=Tu/L,Ge={audio:[{type:"audio",dts:j,pts:j},{type:"audio",dts:j+k*1024*Le,pts:j+k*1024*Le}]};return Ge},$p=function(S){var D={pid:null,table:null},k={};Pc(S,D);for(var L in D.table)if(D.table.hasOwnProperty(L)){var j=D.table[L];switch(j){case Td.H264_STREAM_TYPE:k.video=[],Oh(S,D,k),k.video.length===0&&delete k.video;break;case Td.ADTS_STREAM_TYPE:k.audio=[],ja(S,D,k),k.audio.length===0&&delete k.audio;break}}return k},Qo=function(S,D){var k=tr.aac.isLikelyAacData(S),L;return k?L=$n(S):L=$p(S),!L||!L.audio&&!L.video?null:(As(L,D),L)},Ao={inspect:Qo,parseAudioPes_:ja};const wo=function(S,D){D.on("data",function(k){const L=k.initSegment;k.initSegment={data:L.buffer,byteOffset:L.byteOffset,byteLength:L.byteLength};const j=k.data;k.data=j.buffer,S.postMessage({action:"data",segment:k,byteOffset:j.byteOffset,byteLength:j.byteLength},[k.data])}),D.on("done",function(k){S.postMessage({action:"done"})}),D.on("gopInfo",function(k){S.postMessage({action:"gopInfo",gopInfo:k})}),D.on("videoSegmentTimingInfo",function(k){const L={start:{decode:Ze.videoTsToSeconds(k.start.dts),presentation:Ze.videoTsToSeconds(k.start.pts)},end:{decode:Ze.videoTsToSeconds(k.end.dts),presentation:Ze.videoTsToSeconds(k.end.pts)},baseMediaDecodeTime:Ze.videoTsToSeconds(k.baseMediaDecodeTime)};k.prependedContentDuration&&(L.prependedContentDuration=Ze.videoTsToSeconds(k.prependedContentDuration)),S.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:L})}),D.on("audioSegmentTimingInfo",function(k){const L={start:{decode:Ze.videoTsToSeconds(k.start.dts),presentation:Ze.videoTsToSeconds(k.start.pts)},end:{decode:Ze.videoTsToSeconds(k.end.dts),presentation:Ze.videoTsToSeconds(k.end.pts)},baseMediaDecodeTime:Ze.videoTsToSeconds(k.baseMediaDecodeTime)};k.prependedContentDuration&&(L.prependedContentDuration=Ze.videoTsToSeconds(k.prependedContentDuration)),S.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:L})}),D.on("id3Frame",function(k){S.postMessage({action:"id3Frame",id3Frame:k})}),D.on("caption",function(k){S.postMessage({action:"caption",caption:k})}),D.on("trackinfo",function(k){S.postMessage({action:"trackinfo",trackInfo:k})}),D.on("audioTimingInfo",function(k){S.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:Ze.videoTsToSeconds(k.start),end:Ze.videoTsToSeconds(k.end)}})}),D.on("videoTimingInfo",function(k){S.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:Ze.videoTsToSeconds(k.start),end:Ze.videoTsToSeconds(k.end)}})}),D.on("log",function(k){S.postMessage({action:"log",log:k})})};class na{constructor(D,k){this.options=k||{},this.self=D,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new Lh.Transmuxer(this.options),wo(this.self,this.transmuxer)}pushMp4Captions(D){this.captionParser||(this.captionParser=new jp,this.captionParser.init());const k=new Uint8Array(D.data,D.byteOffset,D.byteLength),L=this.captionParser.parse(k,D.trackIds,D.timescales);this.self.postMessage({action:"mp4Captions",captions:L&&L.captions||[],logs:L&&L.logs||[],data:k.buffer},[k.buffer])}initMp4WebVttParser(D){this.webVttParser||(this.webVttParser=new wr);const k=new Uint8Array(D.data,D.byteOffset,D.byteLength);this.webVttParser.init(k)}getMp4WebVttText(D){this.webVttParser||(this.webVttParser=new wr);const k=new Uint8Array(D.data,D.byteOffset,D.byteLength),L=this.webVttParser.parseSegment(k);this.self.postMessage({action:"getMp4WebVttText",mp4VttCues:L||[],data:k.buffer},[k.buffer])}probeMp4StartTime({timescales:D,data:k}){const L=Ss.startTime(D,k);this.self.postMessage({action:"probeMp4StartTime",startTime:L,data:k},[k.buffer])}probeMp4Tracks({data:D}){const k=Ss.tracks(D);this.self.postMessage({action:"probeMp4Tracks",tracks:k,data:D},[D.buffer])}probeEmsgID3({data:D,offset:k}){const L=Ss.getEmsgID3(D,k);this.self.postMessage({action:"probeEmsgID3",id3Frames:L,emsgData:D},[D.buffer])}probeTs({data:D,baseStartTime:k}){const L=typeof k=="number"&&!isNaN(k)?k*Ze.ONE_SECOND_IN_TS:void 0,j=Ao.inspect(D,L);let Y=null;j&&(Y={hasVideo:j.video&&j.video.length===2||!1,hasAudio:j.audio&&j.audio.length===2||!1},Y.hasVideo&&(Y.videoStart=j.video[0].ptsTime),Y.hasAudio&&(Y.audioStart=j.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:Y,data:D},[D.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(D){const k=new Uint8Array(D.data,D.byteOffset,D.byteLength);this.transmuxer.push(k)}reset(){this.transmuxer.reset()}setTimestampOffset(D){const k=D.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(Ze.secondsToVideoTs(k)))}setAudioAppendStart(D){this.transmuxer.setAudioAppendStart(Math.ceil(Ze.secondsToVideoTs(D.appendStart)))}setRemux(D){this.transmuxer.setRemux(D.remux)}flush(D){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(D){this.transmuxer.alignGopsWith(D.gopsToAlignWith.slice())}}self.onmessage=function(S){if(S.data.action==="init"&&S.data.options){this.messageHandlers=new na(self,S.data.options);return}this.messageHandlers||(this.messageHandlers=new na(self)),S.data&&S.data.action&&S.data.action!=="init"&&this.messageHandlers[S.data.action]&&this.messageHandlers[S.data.action](S.data)}}));var Rz=QO(Lz);const kz=(r,e,t)=>{const{type:i,initSegment:n,captions:s,captionStreams:a,metadata:c,videoFrameDtsTime:h,videoFramePtsTime:m}=r.data.segment;e.buffer.push({captions:s,captionStreams:a,metadata:c});const v=r.data.segment.boxes||{data:r.data.segment.data},b={type:i,data:new Uint8Array(v.data,v.data.byteOffset,v.data.byteLength),initSegment:new Uint8Array(n.data,n.byteOffset,n.byteLength)};typeof h<"u"&&(b.videoFrameDtsTime=h),typeof m<"u"&&(b.videoFramePtsTime=m),t(b)},Oz=({transmuxedData:r,callback:e})=>{r.buffer=[],e(r)},Fz=(r,e)=>{e.gopInfo=r.data.gopInfo},JO=r=>{const{transmuxer:e,bytes:t,audioAppendStart:i,gopsToAlignWith:n,remux:s,onData:a,onTrackInfo:c,onAudioTimingInfo:h,onVideoTimingInfo:m,onVideoSegmentTimingInfo:v,onAudioSegmentTimingInfo:b,onId3:x,onCaptions:C,onDone:B,onEndedTimeline:P,onTransmuxerLog:N,isEndOfTimeline:ae,segment:X,triggerSegmentEventFn:de}=r,ge={buffer:[]};let ue=ae;const be=ve=>{e.currentTransmux===r&&(ve.data.action==="data"&&kz(ve,ge,a),ve.data.action==="trackinfo"&&c(ve.data.trackInfo),ve.data.action==="gopInfo"&&Fz(ve,ge),ve.data.action==="audioTimingInfo"&&h(ve.data.audioTimingInfo),ve.data.action==="videoTimingInfo"&&m(ve.data.videoTimingInfo),ve.data.action==="videoSegmentTimingInfo"&&v(ve.data.videoSegmentTimingInfo),ve.data.action==="audioSegmentTimingInfo"&&b(ve.data.audioSegmentTimingInfo),ve.data.action==="id3Frame"&&x([ve.data.id3Frame],ve.data.id3Frame.dispatchType),ve.data.action==="caption"&&C(ve.data.caption),ve.data.action==="endedtimeline"&&(ue=!1,P()),ve.data.action==="log"&&N(ve.data.log),ve.data.type==="transmuxed"&&(ue||(e.onmessage=null,Oz({transmuxedData:ge,callback:B}),e4(e))))},fe=()=>{const ve={message:"Received an error message from the transmuxer worker",metadata:{errorType:ft.Error.StreamingFailedToTransmuxSegment,segmentInfo:Mm({segment:X})}};B(null,ve)};if(e.onmessage=be,e.onerror=fe,i&&e.postMessage({action:"setAudioAppendStart",appendStart:i}),Array.isArray(n)&&e.postMessage({action:"alignGopsWith",gopsToAlignWith:n}),typeof s<"u"&&e.postMessage({action:"setRemux",remux:s}),t.byteLength){const ve=t instanceof ArrayBuffer?t:t.buffer,ie=t instanceof ArrayBuffer?0:t.byteOffset;de({type:"segmenttransmuxingstart",segment:X}),e.postMessage({action:"push",data:ve,byteOffset:ie,byteLength:t.byteLength},[ve])}ae&&e.postMessage({action:"endTimeline"}),e.postMessage({action:"flush"})},e4=r=>{r.currentTransmux=null,r.transmuxQueue.length&&(r.currentTransmux=r.transmuxQueue.shift(),typeof r.currentTransmux=="function"?r.currentTransmux():JO(r.currentTransmux))},XI=(r,e)=>{r.postMessage({action:e}),e4(r)},t4=(r,e)=>{if(!e.currentTransmux){e.currentTransmux=r,XI(e,r);return}e.transmuxQueue.push(XI.bind(null,e,r))},Bz=r=>{t4("reset",r)},Nz=r=>{t4("endTimeline",r)},i4=r=>{if(!r.transmuxer.currentTransmux){r.transmuxer.currentTransmux=r,JO(r);return}r.transmuxer.transmuxQueue.push(r)},Uz=r=>{const e=new Rz;e.currentTransmux=null,e.transmuxQueue=[];const t=e.terminate;return e.terminate=()=>(e.currentTransmux=null,e.transmuxQueue.length=0,t.call(e)),e.postMessage({action:"init",options:r}),e};var fw={reset:Bz,endTimeline:Nz,transmux:i4,createTransmuxer:Uz};const _0=function(r){const e=r.transmuxer,t=r.endAction||r.action,i=r.callback,n=zr({},r,{endAction:null,transmuxer:null,callback:null}),s=a=>{a.data.action===t&&(e.removeEventListener("message",s),a.data.data&&(a.data.data=new Uint8Array(a.data.data,r.byteOffset||0,r.byteLength||a.data.data.byteLength),r.data&&(r.data=a.data.data)),i(a.data))};if(e.addEventListener("message",s),r.data){const a=r.data instanceof ArrayBuffer;n.byteOffset=a?0:r.data.byteOffset,n.byteLength=r.data.byteLength;const c=[a?r.data:r.data.buffer];e.postMessage(n,c)}else e.postMessage(n)},hh={FAILURE:2,TIMEOUT:-101,ABORTED:-102},n4="wvtt",ME=r=>{r.forEach(e=>{e.abort()})},Vz=r=>({bandwidth:r.bandwidth,bytesReceived:r.bytesReceived||0,roundTripTime:r.roundTripTime||0}),zz=r=>{const e=r.target,i={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-e.requestTime||0};return i.bytesReceived=r.loaded,i.bandwidth=Math.floor(i.bytesReceived/i.roundTripTime*8*1e3),i},yC=(r,e)=>{const{requestType:t}=e,i=$m({requestType:t,request:e,error:r});return e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:hh.TIMEOUT,xhr:e,metadata:i}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:hh.ABORTED,xhr:e,metadata:i}:r?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:hh.FAILURE,xhr:e,metadata:i}:e.responseType==="arraybuffer"&&e.response.byteLength===0?{status:e.status,message:"Empty HLS response at URL: "+e.uri,code:hh.FAILURE,xhr:e,metadata:i}:null},YI=(r,e,t,i)=>(n,s)=>{const a=s.response,c=yC(n,s);if(c)return t(c,r);if(a.byteLength!==16)return t({status:s.status,message:"Invalid HLS key at URL: "+s.uri,code:hh.FAILURE,xhr:s},r);const h=new DataView(a),m=new Uint32Array([h.getUint32(0),h.getUint32(4),h.getUint32(8),h.getUint32(12)]);for(let b=0;b<e.length;b++)e[b].bytes=m;const v={uri:s.uri};return i({type:"segmentkeyloadcomplete",segment:r,keyInfo:v}),t(null,r)},Hz=(r,e)=>{e===n4&&r.transmuxer.postMessage({action:"initMp4WebVttParser",data:r.map.bytes})},jz=(r,e,t)=>{e===n4&&_0({action:"getMp4WebVttText",data:r.bytes,transmuxer:r.transmuxer,callback:({data:i,mp4VttCues:n})=>{r.bytes=i,t(null,r,{mp4VttCues:n})}})},r4=(r,e)=>{const t=z2(r.map.bytes);if(t!=="mp4"){const i=r.map.resolvedUri||r.map.uri,n=t||"unknown";return e({internal:!0,message:`Found unsupported ${n} container for initialization segment at URL: ${i}`,code:hh.FAILURE,metadata:{mediaType:n}})}_0({action:"probeMp4Tracks",data:r.map.bytes,transmuxer:r.transmuxer,callback:({tracks:i,data:n})=>(r.map.bytes=n,i.forEach(function(s){r.map.tracks=r.map.tracks||{},!r.map.tracks[s.type]&&(r.map.tracks[s.type]=s,typeof s.id=="number"&&s.timescale&&(r.map.timescales=r.map.timescales||{},r.map.timescales[s.id]=s.timescale),s.type==="text"&&Hz(r,s.codec))}),e(null))})},Gz=({segment:r,finishProcessingFn:e,triggerSegmentEventFn:t})=>(i,n)=>{const s=yC(i,n);if(s)return e(s,r);const a=new Uint8Array(n.response);if(t({type:"segmentloaded",segment:r}),r.map.key)return r.map.encryptedBytes=a,e(null,r);r.map.bytes=a,r4(r,function(c){if(c)return c.xhr=n,c.status=n.status,e(c,r);e(null,r)})},$z=({segment:r,finishProcessingFn:e,responseType:t,triggerSegmentEventFn:i})=>(n,s)=>{const a=yC(n,s);if(a)return e(a,r);i({type:"segmentloaded",segment:r});const c=t==="arraybuffer"||!s.responseText?s.response:Iz(s.responseText.substring(r.lastReachedChar||0));return r.stats=Vz(s),r.key?r.encryptedBytes=new Uint8Array(c):r.bytes=new Uint8Array(c),e(null,r)},Wz=({segment:r,bytes:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:n,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:c,isEndOfTimeline:h,endedTimelineFn:m,dataFn:v,doneFn:b,onTransmuxerLog:x,triggerSegmentEventFn:C})=>{const B=r.map&&r.map.tracks||{},P=!!(B.audio&&B.video);let N=i.bind(null,r,"audio","start");const ae=i.bind(null,r,"audio","end");let X=i.bind(null,r,"video","start");const de=i.bind(null,r,"video","end"),ge=()=>i4({bytes:e,transmuxer:r.transmuxer,audioAppendStart:r.audioAppendStart,gopsToAlignWith:r.gopsToAlignWith,remux:P,onData:ue=>{ue.type=ue.type==="combined"?"video":ue.type,v(r,ue)},onTrackInfo:ue=>{t&&(P&&(ue.isMuxed=!0),t(r,ue))},onAudioTimingInfo:ue=>{N&&typeof ue.start<"u"&&(N(ue.start),N=null),ae&&typeof ue.end<"u"&&ae(ue.end)},onVideoTimingInfo:ue=>{X&&typeof ue.start<"u"&&(X(ue.start),X=null),de&&typeof ue.end<"u"&&de(ue.end)},onVideoSegmentTimingInfo:ue=>{const be={pts:{start:ue.start.presentation,end:ue.end.presentation},dts:{start:ue.start.decode,end:ue.end.decode}};C({type:"segmenttransmuxingtiminginfoavailable",segment:r,timingInfo:be}),n(ue)},onAudioSegmentTimingInfo:ue=>{const be={pts:{start:ue.start.pts,end:ue.end.pts},dts:{start:ue.start.dts,end:ue.end.dts}};C({type:"segmenttransmuxingtiminginfoavailable",segment:r,timingInfo:be}),s(ue)},onId3:(ue,be)=>{a(r,ue,be)},onCaptions:ue=>{c(r,[ue])},isEndOfTimeline:h,onEndedTimeline:()=>{m()},onTransmuxerLog:x,onDone:(ue,be)=>{b&&(ue.type=ue.type==="combined"?"video":ue.type,C({type:"segmenttransmuxingcomplete",segment:r}),b(be,r,ue))},segment:r,triggerSegmentEventFn:C});_0({action:"probeTs",transmuxer:r.transmuxer,data:e,baseStartTime:r.baseStartTime,callback:ue=>{r.bytes=e=ue.data;const be=ue.result;be&&(t(r,{hasAudio:be.hasAudio,hasVideo:be.hasVideo,isMuxed:P}),t=null),ge()}})},s4=({segment:r,bytes:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:n,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:c,isEndOfTimeline:h,endedTimelineFn:m,dataFn:v,doneFn:b,onTransmuxerLog:x,triggerSegmentEventFn:C})=>{let B=new Uint8Array(e);if(f9(B)){r.isFmp4=!0;const{tracks:P}=r.map;if(P.text&&(!P.audio||!P.video)){v(r,{data:B,type:"text"}),jz(r,P.text.codec,b);return}const ae={isFmp4:!0,hasVideo:!!P.video,hasAudio:!!P.audio};P.audio&&P.audio.codec&&P.audio.codec!=="enca"&&(ae.audioCodec=P.audio.codec),P.video&&P.video.codec&&P.video.codec!=="encv"&&(ae.videoCodec=P.video.codec),P.video&&P.audio&&(ae.isMuxed=!0),t(r,ae);const X=(de,ge)=>{v(r,{data:B,type:ae.hasAudio&&!ae.isMuxed?"audio":"video"}),ge&&ge.length&&a(r,ge),de&&de.length&&c(r,de),b(null,r,{})};_0({action:"probeMp4StartTime",timescales:r.map.timescales,data:B,transmuxer:r.transmuxer,callback:({data:de,startTime:ge})=>{e=de.buffer,r.bytes=B=de,ae.hasAudio&&!ae.isMuxed&&i(r,"audio","start",ge),ae.hasVideo&&i(r,"video","start",ge),_0({action:"probeEmsgID3",data:B,transmuxer:r.transmuxer,offset:ge,callback:({emsgData:ue,id3Frames:be})=>{if(e=ue.buffer,r.bytes=B=ue,!P.video||!ue.byteLength||!r.transmuxer){X(void 0,be);return}_0({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:r.transmuxer,data:B,timescales:r.map.timescales,trackIds:[P.video.id],callback:fe=>{e=fe.data.buffer,r.bytes=B=fe.data,fe.logs.forEach(function(ve){x(Hr(ve,{stream:"mp4CaptionParser"}))}),X(fe.captions,be)}})}})}});return}if(!r.transmuxer){b(null,r,{});return}if(typeof r.container>"u"&&(r.container=z2(B)),r.container!=="ts"&&r.container!=="aac"){t(r,{hasAudio:!1,hasVideo:!1}),b(null,r,{});return}Wz({segment:r,bytes:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:n,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:c,isEndOfTimeline:h,endedTimelineFn:m,dataFn:v,doneFn:b,onTransmuxerLog:x,triggerSegmentEventFn:C})},a4=function({id:r,key:e,encryptedBytes:t,decryptionWorker:i,segment:n,doneFn:s},a){const c=m=>{if(m.data.source===r){i.removeEventListener("message",c);const v=m.data.decrypted;a(new Uint8Array(v.bytes,v.byteOffset,v.byteLength))}};i.onerror=()=>{const m="An error occurred in the decryption worker",v=Mm({segment:n}),b={message:m,metadata:{error:new Error(m),errorType:ft.Error.StreamingFailedToDecryptSegment,segmentInfo:v,keyInfo:{uri:n.key.resolvedUri||n.map.key.resolvedUri}}};s(b,n)},i.addEventListener("message",c);let h;e.bytes.slice?h=e.bytes.slice():h=new Uint32Array(Array.prototype.slice.call(e.bytes)),i.postMessage(GO({source:r,encrypted:t,key:h,iv:e.iv}),[t.buffer,h.buffer])},qz=({decryptionWorker:r,segment:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:n,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:c,isEndOfTimeline:h,endedTimelineFn:m,dataFn:v,doneFn:b,onTransmuxerLog:x,triggerSegmentEventFn:C})=>{C({type:"segmentdecryptionstart"}),a4({id:e.requestId,key:e.key,encryptedBytes:e.encryptedBytes,decryptionWorker:r,segment:e,doneFn:b},B=>{e.bytes=B,C({type:"segmentdecryptioncomplete",segment:e}),s4({segment:e,bytes:e.bytes,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:n,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:c,isEndOfTimeline:h,endedTimelineFn:m,dataFn:v,doneFn:b,onTransmuxerLog:x,triggerSegmentEventFn:C})})},Xz=({activeXhrs:r,decryptionWorker:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:n,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:c,isEndOfTimeline:h,endedTimelineFn:m,dataFn:v,doneFn:b,onTransmuxerLog:x,triggerSegmentEventFn:C})=>{let B=0,P=!1;return(N,ae)=>{if(!P){if(N)return P=!0,ME(r),b(N,ae);if(B+=1,B===r.length){const X=function(){if(ae.encryptedBytes)return qz({decryptionWorker:e,segment:ae,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:n,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:c,isEndOfTimeline:h,endedTimelineFn:m,dataFn:v,doneFn:b,onTransmuxerLog:x,triggerSegmentEventFn:C});s4({segment:ae,bytes:ae.bytes,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:n,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:c,isEndOfTimeline:h,endedTimelineFn:m,dataFn:v,doneFn:b,onTransmuxerLog:x,triggerSegmentEventFn:C})};if(ae.endOfAllRequests=Date.now(),ae.map&&ae.map.encryptedBytes&&!ae.map.bytes)return C({type:"segmentdecryptionstart",segment:ae}),a4({decryptionWorker:e,id:ae.requestId+"-init",encryptedBytes:ae.map.encryptedBytes,key:ae.map.key,segment:ae,doneFn:b},de=>{ae.map.bytes=de,C({type:"segmentdecryptioncomplete",segment:ae}),r4(ae,ge=>{if(ge)return ME(r),b(ge,ae);X()})});X()}}}},Yz=({loadendState:r,abortFn:e})=>t=>{t.target.aborted&&e&&!r.calledAbortFn&&(e(),r.calledAbortFn=!0)},Qz=({segment:r,progressFn:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:n,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:c,isEndOfTimeline:h,endedTimelineFn:m,dataFn:v})=>b=>{if(!b.target.aborted)return r.stats=Hr(r.stats,zz(b)),!r.stats.firstBytesReceivedAt&&r.stats.bytesReceived&&(r.stats.firstBytesReceivedAt=Date.now()),e(b,r)},Kz=({xhr:r,xhrOptions:e,decryptionWorker:t,segment:i,abortFn:n,progressFn:s,trackInfoFn:a,timingInfoFn:c,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:m,id3Fn:v,captionsFn:b,isEndOfTimeline:x,endedTimelineFn:C,dataFn:B,doneFn:P,onTransmuxerLog:N,triggerSegmentEventFn:ae})=>{const X=[],de=Xz({activeXhrs:X,decryptionWorker:t,trackInfoFn:a,timingInfoFn:c,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:m,id3Fn:v,captionsFn:b,isEndOfTimeline:x,endedTimelineFn:C,dataFn:B,doneFn:P,onTransmuxerLog:N,triggerSegmentEventFn:ae});if(i.key&&!i.key.bytes){const ve=[i.key];i.map&&!i.map.bytes&&i.map.key&&i.map.key.resolvedUri===i.key.resolvedUri&&ve.push(i.map.key);const ie=Hr(e,{uri:i.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),re=YI(i,ve,de,ae),Ne={uri:i.key.resolvedUri};ae({type:"segmentkeyloadstart",segment:i,keyInfo:Ne});const De=r(ie,re);X.push(De)}if(i.map&&!i.map.bytes){if(i.map.key&&(!i.key||i.key.resolvedUri!==i.map.key.resolvedUri)){const De=Hr(e,{uri:i.map.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),ke=YI(i,[i.map.key],de,ae),ut={uri:i.map.key.resolvedUri};ae({type:"segmentkeyloadstart",segment:i,keyInfo:ut});const _t=r(De,ke);X.push(_t)}const ie=Hr(e,{uri:i.map.resolvedUri,responseType:"arraybuffer",headers:EE(i.map),requestType:"segment-media-initialization"}),re=Gz({segment:i,finishProcessingFn:de,triggerSegmentEventFn:ae});ae({type:"segmentloadstart",segment:i});const Ne=r(ie,re);X.push(Ne)}const ge=Hr(e,{uri:i.part&&i.part.resolvedUri||i.resolvedUri,responseType:"arraybuffer",headers:EE(i),requestType:"segment"}),ue=$z({segment:i,finishProcessingFn:de,responseType:ge.responseType,triggerSegmentEventFn:ae});ae({type:"segmentloadstart",segment:i});const be=r(ge,ue);be.addEventListener("progress",Qz({segment:i,progressFn:s,trackInfoFn:a,timingInfoFn:c,videoSegmentTimingInfoFn:h,audioSegmentTimingInfoFn:m,id3Fn:v,captionsFn:b,isEndOfTimeline:x,endedTimelineFn:C,dataFn:B})),X.push(be);const fe={};return X.forEach(ve=>{ve.addEventListener("loadend",Yz({loadendState:fe,abortFn:n}))}),()=>ME(X)},Z1=Tc("PlaylistSelector"),QI=function(r){if(!r||!r.playlist)return;const e=r.playlist;return JSON.stringify({id:e.id,bandwidth:r.bandwidth,width:r.width,height:r.height,codecs:e.attributes&&e.attributes.CODECS||""})},b0=function(r,e){if(!r)return"";const t=Z.getComputedStyle(r);return t?t[e]:""},T0=function(r,e){const t=r.slice();r.sort(function(i,n){const s=e(i,n);return s===0?t.indexOf(i)-t.indexOf(n):s})},_C=function(r,e){let t,i;return r.attributes.BANDWIDTH&&(t=r.attributes.BANDWIDTH),t=t||Z.Number.MAX_VALUE,e.attributes.BANDWIDTH&&(i=e.attributes.BANDWIDTH),i=i||Z.Number.MAX_VALUE,t-i},Zz=function(r,e){let t,i;return r.attributes.RESOLUTION&&r.attributes.RESOLUTION.width&&(t=r.attributes.RESOLUTION.width),t=t||Z.Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(i=e.attributes.RESOLUTION.width),i=i||Z.Number.MAX_VALUE,t===i&&r.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?r.attributes.BANDWIDTH-e.attributes.BANDWIDTH:t-i};let o4=function(r){const{main:e,bandwidth:t,playerWidth:i,playerHeight:n,playerObjectFit:s,limitRenditionByPlayerDimensions:a,playlistController:c}=r;if(!e)return;const h={bandwidth:t,width:i,height:n,limitRenditionByPlayerDimensions:a};let m=e.playlists;Jl.isAudioOnly(e)&&(m=c.getAudioTrackPlaylists_(),h.audioOnly=!0);let v=m.map(fe=>{let ve;const ie=fe.attributes&&fe.attributes.RESOLUTION&&fe.attributes.RESOLUTION.width,re=fe.attributes&&fe.attributes.RESOLUTION&&fe.attributes.RESOLUTION.height;return ve=fe.attributes&&fe.attributes.BANDWIDTH,ve=ve||Z.Number.MAX_VALUE,{bandwidth:ve,width:ie,height:re,playlist:fe}});T0(v,(fe,ve)=>fe.bandwidth-ve.bandwidth),v=v.filter(fe=>!Jl.isIncompatible(fe.playlist));let b=v.filter(fe=>Jl.isEnabled(fe.playlist));b.length||(b=v.filter(fe=>!Jl.isDisabled(fe.playlist)));const x=b.filter(fe=>fe.bandwidth*Qa.BANDWIDTH_VARIANCE<t);let C=x[x.length-1];const B=x.filter(fe=>fe.bandwidth===C.bandwidth)[0];if(a===!1){const fe=B||b[0]||v[0];if(fe&&fe.playlist){let ve="sortedPlaylistReps";return B&&(ve="bandwidthBestRep"),b[0]&&(ve="enabledPlaylistReps"),Z1(`choosing ${QI(fe)} using ${ve} with options`,h),fe.playlist}return Z1("could not choose a playlist with options",h),null}const P=x.filter(fe=>fe.width&&fe.height);T0(P,(fe,ve)=>fe.width-ve.width);const N=P.filter(fe=>fe.width===i&&fe.height===n);C=N[N.length-1];const ae=N.filter(fe=>fe.bandwidth===C.bandwidth)[0];let X,de,ge;ae||(X=P.filter(fe=>s==="cover"?fe.width>i&&fe.height>n:fe.width>i||fe.height>n),de=X.filter(fe=>fe.width===X[0].width&&fe.height===X[0].height),C=de[de.length-1],ge=de.filter(fe=>fe.bandwidth===C.bandwidth)[0]);let ue;if(c.leastPixelDiffSelector){const fe=P.map(ve=>(ve.pixelDiff=Math.abs(ve.width-i)+Math.abs(ve.height-n),ve));T0(fe,(ve,ie)=>ve.pixelDiff===ie.pixelDiff?ie.bandwidth-ve.bandwidth:ve.pixelDiff-ie.pixelDiff),ue=fe[0]}const be=ue||ge||ae||B||b[0]||v[0];if(be&&be.playlist){let fe="sortedPlaylistReps";return ue?fe="leastPixelDiffRep":ge?fe="resolutionPlusOneRep":ae?fe="resolutionBestRep":B?fe="bandwidthBestRep":b[0]&&(fe="enabledPlaylistReps"),Z1(`choosing ${QI(be)} using ${fe} with options`,h),be.playlist}return Z1("could not choose a playlist with options",h),null};const KI=function(){let r=this.useDevicePixelRatio&&Z.devicePixelRatio||1;return isNaN(this.customPixelRatio)||(r=this.customPixelRatio),o4({main:this.playlists.main,bandwidth:this.systemBandwidth,playerWidth:parseInt(b0(this.tech_.el(),"width"),10)*r,playerHeight:parseInt(b0(this.tech_.el(),"height"),10)*r,playerObjectFit:this.usePlayerObjectFit?b0(this.tech_.el(),"objectFit"):"",limitRenditionByPlayerDimensions:this.limitRenditionByPlayerDimensions,playlistController:this.playlistController_})},Jz=function(r){let e=-1,t=-1;if(r<0||r>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){let i=this.useDevicePixelRatio&&Z.devicePixelRatio||1;return isNaN(this.customPixelRatio)||(i=this.customPixelRatio),e<0&&(e=this.systemBandwidth,t=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==t&&(e=r*this.systemBandwidth+(1-r)*e,t=this.systemBandwidth),o4({main:this.playlists.main,bandwidth:e,playerWidth:parseInt(b0(this.tech_.el(),"width"),10)*i,playerHeight:parseInt(b0(this.tech_.el(),"height"),10)*i,playerObjectFit:this.usePlayerObjectFit?b0(this.tech_.el(),"objectFit"):"",limitRenditionByPlayerDimensions:this.limitRenditionByPlayerDimensions,playlistController:this.playlistController_})}},eH=function(r){const{main:e,currentTime:t,bandwidth:i,duration:n,segmentDuration:s,timeUntilRebuffer:a,currentTimeline:c,syncController:h}=r,m=e.playlists.filter(B=>!Jl.isIncompatible(B));let v=m.filter(Jl.isEnabled);v.length||(v=m.filter(B=>!Jl.isDisabled(B)));const x=v.filter(Jl.hasAttribute.bind(null,"BANDWIDTH")).map(B=>{const N=h.getSyncPoint(B,n,c,t)?1:2,X=Jl.estimateSegmentRequestTime(s,i,B)*N-a;return{playlist:B,rebufferingImpact:X}}),C=x.filter(B=>B.rebufferingImpact<=0);return T0(C,(B,P)=>_C(P.playlist,B.playlist)),C.length?C[0]:(T0(x,(B,P)=>B.rebufferingImpact-P.rebufferingImpact),x[0]||null)},tH=function(){const r=this.playlists.main.playlists.filter(Jl.isEnabled);return T0(r,(t,i)=>_C(t,i)),r.filter(t=>!!p_(this.playlists.main,t).video)[0]||null},iH=r=>{let e=0,t;return r.bytes&&(t=new Uint8Array(r.bytes),r.segments.forEach(i=>{t.set(i,e),e+=i.byteLength})),t};function l4(r){try{return new URL(r).pathname.split("/").slice(-2).join("/")}catch{return""}}const nH=function(r,e,t){if(!r[t]){e.trigger({type:"usage",name:"vhs-608"});let i=t;/^cc708_/.test(t)&&(i="SERVICE"+t.split("_")[1]);const n=e.textTracks().getTrackById(i);if(n)r[t]=n;else{const s=e.options_.vhs&&e.options_.vhs.captionServices||{};let a=t,c=t,h=!1;const m=s[i];m&&(a=m.label,c=m.language,h=m.default),r[t]=e.addRemoteTextTrack({kind:"captions",id:i,default:h,label:a,language:c},!1).track}}},rH=function({inbandTextTracks:r,captionArray:e,timestampOffset:t}){if(!e)return;const i=Z.WebKitDataCue||Z.VTTCue;e.forEach(n=>{const s=n.stream;n.content?n.content.forEach(a=>{const c=new i(n.startTime+t,n.endTime+t,a.text);c.line=a.line,c.align="left",c.position=a.position,c.positionAlign="line-left",r[s].addCue(c)}):r[s].addCue(new i(n.startTime+t,n.endTime+t,n.text))})},sH=function(r){Object.defineProperties(r.frame,{id:{get(){return ft.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),r.value.key}},value:{get(){return ft.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),r.value.data}},privateData:{get(){return ft.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),r.value.data}}})},aH=({inbandTextTracks:r,metadataArray:e,timestampOffset:t,videoDuration:i})=>{if(!e)return;const n=Z.WebKitDataCue||Z.VTTCue,s=r.metadataTrack_;if(!s||(e.forEach(v=>{const b=v.cueTime+t;typeof b!="number"||Z.isNaN(b)||b<0||!(b<1/0)||!v.frames||!v.frames.length||v.frames.forEach(x=>{const C=new n(b,b,x.value||x.url||x.data||"");C.frame=x,C.value=x,sH(C),s.addCue(C)})}),!s.cues||!s.cues.length))return;const a=s.cues,c=[];for(let v=0;v<a.length;v++)a[v]&&c.push(a[v]);const h=c.reduce((v,b)=>{const x=v[b.startTime]||[];return x.push(b),v[b.startTime]=x,v},{}),m=Object.keys(h).sort((v,b)=>Number(v)-Number(b));m.forEach((v,b)=>{const x=h[v],C=isFinite(i)?i:v,B=Number(m[b+1])||C;x.forEach(P=>{P.endTime=B})})},oH={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},lH=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),uH=({inbandTextTracks:r,dateRanges:e})=>{const t=r.metadataTrack_;if(!t)return;const i=Z.WebKitDataCue||Z.VTTCue;e.forEach(n=>{for(const s of Object.keys(n)){if(lH.has(s))continue;const a=new i(n.startTime,n.endTime,"");a.id=n.id,a.type="com.apple.quicktime.HLS",a.value={key:oH[s],data:n[s]},(s==="scte35Out"||s==="scte35In")&&(a.value.data=new Uint8Array(a.value.data.match(/[\da-f]{2}/gi)).buffer),t.addCue(a)}n.processDateRange()})},ZI=(r,e,t)=>{r.metadataTrack_||(r.metadataTrack_=t.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,ft.browser.IS_ANY_SAFARI||(r.metadataTrack_.inBandMetadataTrackDispatchType=e))},t_=function(r,e,t){let i,n;if(t&&t.cues)for(i=t.cues.length;i--;)n=t.cues[i],n.startTime>=r&&n.endTime<=e&&t.removeCue(n)},cH=function(r){const e=r.cues;if(!e)return;const t={};for(let i=e.length-1;i>=0;i--){const n=e[i],s=`${n.startTime}-${n.endTime}-${n.text}`;t[s]?r.removeCue(n):t[s]=n}},dH=(r,e,t)=>{if(typeof e>"u"||e===null||!r.length)return[];const i=Math.ceil((e-t+3)*Fm.ONE_SECOND_IN_TS);let n;for(n=0;n<r.length&&!(r[n].pts>i);n++);return r.slice(n)},hH=(r,e,t)=>{if(!e.length)return r;if(t)return e.slice();const i=e[0].pts;let n=0;for(n;n<r.length&&!(r[n].pts>=i);n++);return r.slice(0,n).concat(e)},fH=(r,e,t,i)=>{const n=Math.ceil((e-i)*Fm.ONE_SECOND_IN_TS),s=Math.ceil((t-i)*Fm.ONE_SECOND_IN_TS),a=r.slice();let c=r.length;for(;c--&&!(r[c].pts<=s););if(c===-1)return a;let h=c+1;for(;h--&&!(r[h].pts<=n););return h=Math.max(h,0),a.splice(h,c-h+1),a},pH=function(r,e){if(!r&&!e||!r&&e||r&&!e)return!1;if(r===e)return!0;const t=Object.keys(r).sort(),i=Object.keys(e).sort();if(t.length!==i.length)return!1;for(let n=0;n<t.length;n++){const s=t[n];if(s!==i[n]||r[s]!==e[s])return!1}return!0},mH=function(r,e,t){e=e||[];const i=[];let n=0;for(let s=0;s<e.length;s++){const a=e[s];if(r===a.timeline&&(i.push(s),n+=a.duration,n>t))return s}return i.length===0?0:i[i.length-1]},Gy=1,gH=500,JI=r=>typeof r=="number"&&isFinite(r),J1=1/60,vH=(r,e,t)=>r!=="main"||!e||!t?null:!t.hasAudio&&!t.hasVideo?"Neither audio nor video found in segment.":e.hasVideo&&!t.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.hasVideo&&t.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null,yH=(r,e,t)=>{let i=e-Qa.BACK_BUFFER_LENGTH;r.length&&(i=Math.max(i,r.start(0)));const n=e-t;return Math.min(n,i)},jg=r=>{const{startOfSegment:e,duration:t,segment:i,part:n,playlist:{mediaSequence:s,id:a,segments:c=[]},mediaIndex:h,partIndex:m,timeline:v}=r,b=c.length-1;let x="mediaIndex/partIndex increment";r.getMediaInfoForTime?x=`getMediaInfoForTime (${r.getMediaInfoForTime})`:r.isSyncRequest&&(x="getSyncSegmentCandidate (isSyncRequest)"),r.independent&&(x+=` with independent ${r.independent}`);const C=typeof m=="number",B=r.segment.uri?"segment":"pre-segment",P=C?EO({preloadSegment:i})-1:0;return`${B} [${s+h}/${s+b}]`+(C?` part [${m}/${P}]`:"")+` segment start/end [${i.start} => ${i.end}]`+(C?` part start/end [${n.start} => ${n.end}]`:"")+` startOfSegment [${e}] duration [${t}] timeline [${v}] selected by [${x}] playlist [${a}]`},e3=r=>`${r}TimingInfo`,_H=({segmentTimeline:r,currentTimeline:e,startOfSegment:t,buffered:i,overrideCheck:n})=>!n&&r===e?null:r<e?t:i.length?i.end(i.length-1):t,DE=({timelineChangeController:r,currentTimeline:e,segmentTimeline:t,loaderType:i,audioDisabled:n})=>{if(e===t)return!1;if(i==="audio"){const s=r.lastTimelineChange({type:"main"});return!s||s.to!==t}if(i==="main"&&n){const s=r.pendingTimelineChange({type:"audio"});return!(s&&s.to===t)}return!1},bH=r=>{if(!r)return!1;const e=r.pendingTimelineChange({type:"audio"}),t=r.pendingTimelineChange({type:"main"}),i=e&&t,n=i&&e.to!==t.to;return!!(i&&e.from!==-1&&t.from!==-1&&n)},TH=r=>{const e=r.timelineChangeController_.pendingTimelineChange({type:"audio"}),t=r.timelineChangeController_.pendingTimelineChange({type:"main"});return e&&t&&e.to<t.to},yp=r=>{const e=r.pendingSegment_;if(!e)return;if(DE({timelineChangeController:r.timelineChangeController_,currentTimeline:r.currentTimeline_,segmentTimeline:e.timeline,loaderType:r.loaderType_,audioDisabled:r.audioDisabled_})&&bH(r.timelineChangeController_)){if(TH(r)){r.timelineChangeController_.trigger("audioTimelineBehind");return}r.timelineChangeController_.trigger("fixBadTimelineChange")}},xH=r=>{let e=0;return["video","audio"].forEach(function(t){const i=r[`${t}TimingInfo`];if(!i)return;const{start:n,end:s}=i;let a;typeof n=="bigint"||typeof s=="bigint"?a=Z.BigInt(s)-Z.BigInt(n):typeof n=="number"&&typeof s=="number"&&(a=s-n),typeof a<"u"&&a>e&&(e=a)}),typeof e=="bigint"&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),e},t3=({segmentDuration:r,maxDuration:e})=>r?Math.round(r)>e+ch:!1,SH=(r,e)=>{if(e!=="hls")return null;const t=xH({audioTimingInfo:r.audioTimingInfo,videoTimingInfo:r.videoTimingInfo});if(!t)return null;const i=r.playlist.targetDuration,n=t3({segmentDuration:t,maxDuration:i*2}),s=t3({segmentDuration:t,maxDuration:i}),a=`Segment with index ${r.mediaIndex} from playlist ${r.playlist.id} has a duration of ${t} when the reported duration is ${r.duration} and the target duration is ${i}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return n||s?{severity:n?"warn":"info",message:a}:null},Mm=({type:r,segment:e})=>{if(!e)return;const t=!!(e.key||e.map&&e.map.ke),i=!!(e.map&&!e.map.bytes),n=e.startOfSegment===void 0?e.start:e.startOfSegment;return{type:r||e.type,uri:e.resolvedUri||e.uri,start:n,duration:e.duration,isEncrypted:t,isMediaInitialization:i}};let IE=class extends ft.EventTarget{constructor(e,t={}){if(super(),!e)throw new TypeError("Initialization settings are required");if(typeof e.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.addMetadataToTextTrack=e.addMetadataToTextTrack,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.shouldForceTimestampOffsetAfterResync_=!1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=!1,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=Tc(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(i){i!==this.state_&&(this.logger_(`${this.state_} -> ${i}`),this.state_=i,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():yp(this)}),this.sourceUpdater_.on("codecschange",i=>{this.trigger(zr({type:"codecschange"},i))}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():yp(this)}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",i=>{this.trigger(zr({type:"timelinechange"},i)),this.hasEnoughInfoToLoad_()?this.processLoadQueue_():yp(this),this.hasEnoughInfoToAppend_()?this.processCallQueue_():yp(this)})}get mediaSequenceSync_(){return this.syncController_.getMediaSequenceSync(this.loaderType_)}createTransmuxer_(){return fw.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&Z.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null),this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,Z.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==e}error(e){return typeof e<"u"&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&fw.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return Ja();if(this.loaderType_==="main"){const{hasAudio:t,hasVideo:i,isMuxed:n}=e;if(i&&t&&!this.audioDisabled_&&!n)return this.sourceUpdater_.buffered();if(i)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e,t=!1){if(!e)return null;const i=Tx(e);let n=this.initSegments_[i];return t&&!n&&e.bytes&&(this.initSegments_[i]=n={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),n||e}segmentKey(e,t=!1){if(!e)return null;const i=$O(e);let n=this.keyCache_[i];this.cacheEncryptionKeys_&&t&&!n&&e.bytes&&(this.keyCache_[i]=n={resolvedUri:e.resolvedUri,bytes:e.bytes});const s={resolvedUri:(n||e).resolvedUri};return n&&(s.bytes=n.bytes),s}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(e,t={}){if(!e||this.playlist_&&this.playlist_.endList&&e.endList&&this.playlist_.uri===e.uri)return;const i=this.playlist_,n=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,this.state==="INIT"&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(e));let s=null;if(i&&(i.id?s=i.id:i.uri&&(s=i.uri)),this.logger_(`playlist update [${s} => ${e.id||e.uri}]`),this.mediaSequenceSync_&&(this.mediaSequenceSync_.update(e,this.currentTime_()),this.logger_(`Playlist update:
currentTime: ${this.currentTime_()}
bufferedEnd: ${dw(this.buffered_())}
`,this.mediaSequenceSync_.diagnostics)),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!i||i.uri!==e.uri){this.mediaIndex!==null&&(!e.endList&&typeof e.partTargetDuration=="number"?this.resetLoader():this.resyncLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}const a=e.mediaSequence-i.mediaSequence;if(this.logger_(`live window shift [${a}]`),this.mediaIndex!==null)if(this.mediaIndex-=a,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const c=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!c.parts||!c.parts.length||!c.parts[this.partIndex])){const h=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=h}}n&&(n.mediaIndex-=a,n.mediaIndex<0?(n.mediaIndex=null,n.partIndex=null):(n.mediaIndex>=0&&(n.segment=e.segments[n.mediaIndex]),n.partIndex>=0&&n.segment.parts&&(n.part=n.segment.parts[n.partIndex]))),this.syncController_.saveExpiredSegmentInfo(i,e)}pause(){this.checkBufferTimeout_&&(Z.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetEverything(e){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.mediaSequenceSync_&&this.mediaSequenceSync_.resetAppendedStatus(),this.resyncLoader()}resyncLoader(){this.transmuxer_&&fw.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1;const e=this.currentMediaInfo_&&this.currentMediaInfo_.isFmp4;this.sourceType_==="hls"&&!e&&(this.shouldForceTimestampOffsetAfterResync_=!0),this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(e,t,i=()=>{},n=!1){if(t===1/0&&(t=this.duration_()),t<=e){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}let s=1;const a=()=>{s--,s===0&&i()};(n||!this.audioDisabled_)&&(s++,this.sourceUpdater_.removeAudio(e,t,a)),(n||this.loaderType_==="main")&&(this.gopBuffer_=fH(this.gopBuffer_,e,t,this.timeMapping_),s++,this.sourceUpdater_.removeVideo(e,t,a));for(const c in this.inbandTextTracks_)t_(e,t,this.inbandTextTracks_[c]);t_(e,t,this.segmentMetadataTrack_),a()}monitorBuffer_(){this.checkBufferTimeout_&&Z.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=Z.setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&Z.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=Z.setTimeout(this.monitorBufferTick_.bind(this),gH)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const e=this.chooseNextRequest_();if(!e)return;const t={segmentInfo:Mm({type:this.loaderType_,segment:e})};this.trigger({type:"segmentselected",metadata:t}),typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e)}isEndOfStream_(e=this.mediaIndex,t=this.playlist_,i=this.partIndex){if(!t||!this.mediaSource_)return!1;const n=typeof e=="number"&&t.segments[e],s=e+1===t.segments.length,a=!n||!n.parts||i+1===n.parts.length;return t.endList&&this.mediaSource_.readyState==="open"&&s&&a}chooseNextRequest_(){const e=this.buffered_(),t=dw(e)||0,i=pC(e,this.currentTime_()),n=!this.hasPlayed_()&&i>=1,s=i>=this.goalBufferLength_(),a=this.playlist_.segments;if(!a.length||n||s)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_(),this.loaderType_);const c={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:!this.syncPoint_};if(c.isSyncRequest)c.mediaIndex=mH(this.currentTimeline_,a,t),this.logger_(`choose next request. Can not find sync point. Fallback to media Index: ${c.mediaIndex}`);else if(this.mediaIndex!==null){const x=a[this.mediaIndex],C=typeof this.partIndex=="number"?this.partIndex:-1;c.startOfSegment=x.end?x.end:t,x.parts&&x.parts[C+1]?(c.mediaIndex=this.mediaIndex,c.partIndex=C+1):c.mediaIndex=this.mediaIndex+1}else{let x,C,B;const P=this.fetchAtBuffer_?t:this.currentTime_();if(this.mediaSequenceSync_&&this.logger_(`chooseNextRequest_ request after Quality Switch:
For TargetTime: ${P}.
CurrentTime: ${this.currentTime_()}
BufferedEnd: ${t}
Fetch At Buffer: ${this.fetchAtBuffer_}
`,this.mediaSequenceSync_.diagnostics),this.mediaSequenceSync_&&this.mediaSequenceSync_.isReliable){const N=this.getSyncInfoFromMediaSequenceSync_(P);if(!N){const ae="No sync info found while using media sequence sync";return this.error({message:ae,metadata:{errorType:ft.Error.StreamingFailedToSelectNextSegment,error:new Error(ae)}}),this.logger_("chooseNextRequest_ - no sync info found using media sequence sync"),null}this.logger_(`chooseNextRequest_ mediaSequence syncInfo (${N.start} --> ${N.end})`),x=N.segmentIndex,C=N.partIndex,B=N.start}else{this.logger_("chooseNextRequest_ - fallback to a regular segment selection algorithm, based on a syncPoint.");const N=Jl.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:P,startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});x=N.segmentIndex,C=N.partIndex,B=N.startTime}c.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${P}`:`currentTime ${P}`,c.mediaIndex=x,c.startOfSegment=B,c.partIndex=C,this.logger_(`choose next request. Playlist switched and we have a sync point. Media Index: ${c.mediaIndex} `)}const h=a[c.mediaIndex];let m=h&&typeof c.partIndex=="number"&&h.parts&&h.parts[c.partIndex];if(!h||typeof c.partIndex=="number"&&!m)return null;typeof c.partIndex!="number"&&h.parts&&(c.partIndex=0,m=h.parts[0]);const v=this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments;if(!i&&m&&!v&&!m.independent)if(c.partIndex===0){const x=a[c.mediaIndex-1],C=x.parts&&x.parts.length&&x.parts[x.parts.length-1];C&&C.independent&&(c.mediaIndex-=1,c.partIndex=x.parts.length-1,c.independent="previous segment")}else h.parts[c.partIndex-1].independent&&(c.partIndex-=1,c.independent="previous part");const b=this.mediaSource_&&this.mediaSource_.readyState==="ended";return c.mediaIndex>=a.length-1&&b&&!this.seeking_()?null:(this.shouldForceTimestampOffsetAfterResync_&&(this.shouldForceTimestampOffsetAfterResync_=!1,c.forceTimestampOffset=!0,this.logger_("choose next request. Force timestamp offset after loader resync")),this.generateSegmentInfo_(c))}getSyncInfoFromMediaSequenceSync_(e){if(!this.mediaSequenceSync_)return null;const t=Math.max(e,this.mediaSequenceSync_.start);e!==t&&this.logger_(`getSyncInfoFromMediaSequenceSync_. Pulled target time from ${e} to ${t}`);const i=this.mediaSequenceSync_.getSyncInfoForTime(t);if(!i)return null;if(!i.isAppended)return i;const n=this.mediaSequenceSync_.getSyncInfoForTime(i.end);return n?(n.isAppended&&this.logger_("getSyncInfoFromMediaSequenceSync_: We encounter unexpected scenario where next media sequence sync info is also appended!"),n):null}generateSegmentInfo_(e){const{independent:t,playlist:i,mediaIndex:n,startOfSegment:s,isSyncRequest:a,partIndex:c,forceTimestampOffset:h,getMediaInfoForTime:m}=e,v=i.segments[n],b=typeof c=="number"&&v.parts[c],x={requestId:"segment-loader-"+Math.random(),uri:b&&b.resolvedUri||v.resolvedUri,mediaIndex:n,partIndex:b?c:null,isSyncRequest:a,startOfSegment:s,playlist:i,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:v.timeline,duration:b&&b.duration||v.duration,segment:v,part:b,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:m,independent:t},C=typeof h<"u"?h:this.isPendingTimestampOffset_;x.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:v.timeline,currentTimeline:this.currentTimeline_,startOfSegment:s,buffered:this.buffered_(),overrideCheck:C});const B=dw(this.sourceUpdater_.audioBuffered());return typeof B=="number"&&(x.audioAppendStart=B-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(x.gopsToAlignWith=dH(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),x}timestampOffsetForSegment_(e){return _H(e)}earlyAbortWhenNeeded_(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;const t=this.currentTime_(),i=e.bandwidth,n=this.pendingSegment_.duration,s=Jl.estimateSegmentRequestTime(n,i,this.playlist_,e.bytesReceived),a=zV(this.buffered_(),t,this.vhs_.tech_.playbackRate())-1;if(s<=a)return;const c=eH({main:this.vhs_.playlists.main,currentTime:t,bandwidth:i,duration:this.duration_(),segmentDuration:n,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!c)return;const m=s-a-c.rebufferingImpact;let v=.5;a<=ch&&(v=1),!(!c.playlist||c.playlist.uri===this.playlist_.uri||m<v)&&(this.bandwidth=c.playlist.attributes.BANDWIDTH*Qa.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(e){this.logger_(`Aborting ${jg(e)}`),this.mediaRequestsAborted+=1}handleProgress_(e,t){this.earlyAbortWhenNeeded_(t.stats),!this.checkForAbort_(t.requestId)&&this.trigger("progress")}handleTrackInfo_(e,t){const{hasAudio:i,hasVideo:n}=t,s={segmentInfo:Mm({type:this.loaderType_,segment:e}),trackInfo:{hasAudio:i,hasVideo:n}};this.trigger({type:"segmenttransmuxingtrackinfoavailable",metadata:s}),this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)&&(this.checkForIllegalMediaSwitch(t)||(t=t||{},pH(this.currentMediaInfo_,t)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=t,this.currentMediaInfo_=t,this.logger_("trackinfo update",t),this.trigger("trackinfo")),!this.checkForAbort_(e.requestId)&&(this.pendingSegment_.trackInfo=t,this.hasEnoughInfoToAppend_()?this.processCallQueue_():yp(this))))}handleTimingInfo_(e,t,i,n){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;const s=this.pendingSegment_,a=e3(t);s[a]=s[a]||{},s[a][i]=n,this.logger_(`timinginfo: ${t} - ${i} - ${n}`),this.hasEnoughInfoToAppend_()?this.processCallQueue_():yp(this)}handleCaptions_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(t.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,t));return}const n=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),s={};t.forEach(a=>{s[a.stream]=s[a.stream]||{startTime:1/0,captions:[],endTime:0};const c=s[a.stream];c.startTime=Math.min(c.startTime,a.startTime+n),c.endTime=Math.max(c.endTime,a.endTime+n),c.captions.push(a)}),Object.keys(s).forEach(a=>{const{startTime:c,endTime:h,captions:m}=s[a],v=this.inbandTextTracks_;this.logger_(`adding cues from ${c} -> ${h} for ${a}`),nH(v,this.vhs_.tech_,a),t_(c,h,v[a]),rH({captionArray:m,inbandTextTracks:v,timestampOffset:n})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(e,t,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,t,i));return}this.addMetadataToTextTrack(i,t,this.duration_())}processMetadataQueue_(){this.metadataQueue_.id3.forEach(e=>e()),this.metadataQueue_.caption.forEach(e=>e()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const e=this.callQueue_;this.callQueue_=[],e.forEach(t=>t())}processLoadQueue_(){const e=this.loadQueue_;this.loadQueue_=[],e.forEach(t=>t())}hasEnoughInfoToLoad_(){if(this.loaderType_!=="audio")return!0;const e=this.pendingSegment_;return e?this.getCurrentMediaInfo_()?!DE({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1}getCurrentMediaInfo_(e=this.pendingSegment_){return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(e=this.pendingSegment_){return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const e=this.pendingSegment_,t=this.getCurrentMediaInfo_();if(!e||!t)return!1;const{hasAudio:i,hasVideo:n,isMuxed:s}=t;return!(n&&!e.videoTimingInfo||i&&!this.audioDisabled_&&!s&&!e.audioTimingInfo||DE({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){yp(this),this.callQueue_.push(this.handleData_.bind(this,e,t));return}const i=this.pendingSegment_;if(this.setTimeMapping_(i.timeline),this.updateMediaSecondsLoaded_(i.part||i.segment),this.mediaSource_.readyState!=="closed"){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),i.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),i.isFmp4=e.isFmp4,i.timingInfo=i.timingInfo||{},i.isFmp4)this.trigger("fmp4"),i.timingInfo.start=i[e3(t.type)].start;else{const n=this.getCurrentMediaInfo_(),s=this.loaderType_==="main"&&n&&n.hasVideo;let a;s&&(a=i.videoTimingInfo.start),i.timingInfo.start=this.trueSegmentStart_({currentStart:i.timingInfo.start,playlist:i.playlist,mediaIndex:i.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:s,firstVideoFrameTimeForData:a,videoTimingInfo:i.videoTimingInfo,audioTimingInfo:i.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(i,t.type),this.updateSourceBufferTimestampOffset_(i),i.isSyncRequest){this.updateTimingInfoEnd_(i),this.syncController_.saveSegmentTimingInfo({segmentInfo:i,shouldSaveTimelineMapping:this.loaderType_==="main"});const n=this.chooseNextRequest_();if(n.mediaIndex!==i.mediaIndex||n.partIndex!==i.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}i.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(i,t)}}updateAppendInitSegmentStatus(e,t){this.loaderType_==="main"&&typeof e.timestampOffset=="number"&&!e.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[t]!==e.playlist&&(this.appendInitSegment_[t]=!0)}getInitSegmentAndUpdateState_({type:e,initSegment:t,map:i,playlist:n}){if(i){const s=Tx(i);if(this.activeInitSegmentId_===s)return null;t=this.initSegmentForMap(i,!0).bytes,this.activeInitSegmentId_=s}return t&&this.appendInitSegment_[e]?(this.playlistOfLastInitSegment_[e]=n,this.appendInitSegment_[e]=!1,this.activeInitSegmentId_=null,t):null}handleQuotaExceededError_({segmentInfo:e,type:t,bytes:i},n){const s=this.sourceUpdater_.audioBuffered(),a=this.sourceUpdater_.videoBuffered();s.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+Bm(s).join(", ")),a.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+Bm(a).join(", "));const c=s.length?s.start(0):0,h=s.length?s.end(s.length-1):0,m=a.length?a.start(0):0,v=a.length?a.end(a.length-1):0;if(h-c<=Gy&&v-m<=Gy){this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${i.byteLength}, audio buffer: ${Bm(s).join(", ")}, video buffer: ${Bm(a).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:e,type:t,bytes:i}));const x=this.currentTime_()-Gy;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${x}`),this.remove(0,x,()=>{this.logger_(`On QUOTA_EXCEEDED_ERR, retrying append in ${Gy}s`),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=Z.setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},Gy*1e3)},!0)}handleAppendError_({segmentInfo:e,type:t,bytes:i},n){if(n){if(n.code===BO){this.handleQuotaExceededError_({segmentInfo:e,type:t,bytes:i});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",n),this.error({message:`${t} append of ${i.length}b failed for segment #${e.mediaIndex} in playlist ${e.playlist.id}`,metadata:{errorType:ft.Error.StreamingFailedToAppendSegment}}),this.trigger("appenderror")}}appendToSourceBuffer_({segmentInfo:e,type:t,initSegment:i,data:n,bytes:s}){if(!s){const c=[n];let h=n.byteLength;i&&(c.unshift(i),h+=i.byteLength),s=iH({bytes:h,segments:c})}const a={segmentInfo:Mm({type:this.loaderType_,segment:e})};this.trigger({type:"segmentappendstart",metadata:a}),this.sourceUpdater_.appendBuffer({segmentInfo:e,type:t,bytes:s},this.handleAppendError_.bind(this,{segmentInfo:e,type:t,bytes:s}))}handleSegmentTimingInfo_(e,t,i){if(!this.pendingSegment_||t!==this.pendingSegment_.requestId)return;const n=this.pendingSegment_.segment,s=`${e}TimingInfo`;n[s]||(n[s]={}),n[s].transmuxerPrependedSeconds=i.prependedContentDuration||0,n[s].transmuxedPresentationStart=i.start.presentation,n[s].transmuxedDecodeStart=i.start.decode,n[s].transmuxedPresentationEnd=i.end.presentation,n[s].transmuxedDecodeEnd=i.end.decode,n[s].baseMediaDecodeTime=i.baseMediaDecodeTime}appendData_(e,t){const{type:i,data:n}=t;if(!n||!n.byteLength||i==="audio"&&this.audioDisabled_)return;const s=this.getInitSegmentAndUpdateState_({type:i,initSegment:t.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:s,data:n})}loadSegment_(e){if(this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),typeof e.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){yp(this),this.loadQueue_.push(()=>{const t=zr({},e,{forceTimestampOffset:!0});zr(e,this.generateSegmentInfo_(t)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(e)});return}this.updateTransmuxerAndRequestSegment_(e)}updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));const t=this.createSimplifiedSegmentObj_(e),i=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),n=this.mediaIndex!==null,s=e.timeline!==this.currentTimeline_&&e.timeline>0,a=i||n&&s;this.logger_(`Requesting
${l4(e.uri)}
${jg(e)}`),t.map&&!t.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=Kz({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:t,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:a,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:c,level:h,stream:m})=>{this.logger_(`${jg(e)} logged from transmuxer stream ${m} as a ${h}: ${c}`)},triggerSegmentEventFn:({type:c,segment:h,keyInfo:m,trackInfo:v,timingInfo:b})=>{const C={segmentInfo:Mm({segment:h})};m&&(C.keyInfo=m),v&&(C.trackInfo=v),b&&(C.timingInfo=b),this.trigger({type:c,metadata:C})}})}trimBackBuffer_(e){const t=yH(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)}createSimplifiedSegmentObj_(e){const t=e.segment,i=e.part,n=e.segment.key||e.segment.map&&e.segment.map.key,s=e.segment.map&&!e.segment.map.bytes,a={resolvedUri:i?i.resolvedUri:t.resolvedUri,byterange:i?i.byterange:t.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part,type:this.loaderType_,start:e.startOfSegment,duration:e.duration,isEncrypted:n,isMediaInitialization:s},c=e.playlist.segments[e.mediaIndex-1];if(c&&c.timeline===t.timeline&&(c.videoTimingInfo?a.baseStartTime=c.videoTimingInfo.transmuxedDecodeEnd:c.audioTimingInfo&&(a.baseStartTime=c.audioTimingInfo.transmuxedDecodeEnd)),t.key){const h=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);a.key=this.segmentKey(t.key),a.key.iv=h}return t.map&&(a.map=this.initSegmentForMap(t.map)),a}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,t){if(this.pendingSegment_.byteLength=t.bytesReceived,e<J1){this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record ${J1}`);return}const i={bandwidthInfo:{from:this.bandwidth,to:t.bandwidth}};this.trigger({type:"bandwidthupdated",metadata:i}),this.bandwidth=t.bandwidth,this.roundTrip=t.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,t,i){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,t,i));return}if(this.saveTransferStats_(t.stats),!this.pendingSegment_||t.requestId!==this.pendingSegment_.requestId)return;if(e){if(this.pendingSegment_=null,this.state="READY",e.code===hh.ABORTED)return;if(this.pause(),e.code===hh.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(e),this.trigger("error");return}const n=this.pendingSegment_;this.saveBandwidthRelatedStats_(n.duration,t.stats),n.endOfAllRequests=t.endOfAllRequests,i.gopInfo&&(this.gopBuffer_=hH(this.gopBuffer_,i.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(n)}setTimeMapping_(e){const t=this.syncController_.mappingForTimeline(e);t!==null&&(this.timeMapping_=t)}updateMediaSecondsLoaded_(e){typeof e.start=="number"&&typeof e.end=="number"?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return e===null?!1:this.loaderType_==="main"&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset()}trueSegmentStart_({currentStart:e,playlist:t,mediaIndex:i,firstVideoFrameTimeForData:n,currentVideoTimestampOffset:s,useVideoTimingInfo:a,videoTimingInfo:c,audioTimingInfo:h}){if(typeof e<"u")return e;if(!a)return h.start;const m=t.segments[i-1];return i===0||!m||typeof m.start>"u"||m.end!==n+s?n:c.start}waitForAppendsToComplete_(e){const t=this.getCurrentMediaInfo_(e);if(!t){this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),this.trigger("error");return}const{hasAudio:i,hasVideo:n,isMuxed:s}=t,a=this.loaderType_==="main"&&n,c=!this.audioDisabled_&&i&&!s;if(e.waitingOnAppends=0,!e.hasAppendedData_){!e.timingInfo&&typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),this.checkAppendsDone_(e);return}a&&e.waitingOnAppends++,c&&e.waitingOnAppends++,a&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),c&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,e.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){const t=vH(this.loaderType_,this.getCurrentMediaInfo_(),e);return t?(this.error({message:t,playlistExclusionDuration:1/0}),this.trigger("error"),!0):!1}updateSourceBufferTimestampOffset_(e){if(e.timestampOffset===null||typeof e.timingInfo.start!="number"||e.changedTimestampOffset||this.loaderType_!=="main")return;let t=!1;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo}),e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),t=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),t=!0),t&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e,audioTimingInfo:t,timingInfo:i}){return this.useDtsForTimestampOffset_?e&&typeof e.transmuxedDecodeStart=="number"?e.transmuxedDecodeStart:t&&typeof t.transmuxedDecodeStart=="number"?t.transmuxedDecodeStart:i.start:i.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};const t=this.getMediaInfo_(),n=this.loaderType_==="main"&&t&&t.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;n&&(e.timingInfo.end=typeof n.end=="number"?n.end:n.start+e.duration)}handleAppendsDone_(){if(this.pendingSegment_){const h={segmentInfo:Mm({type:this.loaderType_,segment:this.pendingSegment_})};this.trigger({type:"appendsdone",metadata:h})}if(!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}const e=this.pendingSegment_;e.part&&e.part.syncInfo?e.part.syncInfo.markAppended():e.segment.syncInfo&&e.segment.syncInfo.markAppended(),this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:this.loaderType_==="main"});const t=SH(e,this.sourceType_);if(t&&(t.severity==="warn"?ft.log.warn(t.message):this.logger_(t.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_)){this.logger_(`Throwing away un-appended sync request ${jg(e)}`);return}this.logger_(`Appended ${jg(e)}`),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");const i=e.segment,n=e.part,s=i.end&&this.currentTime_()-i.end>e.playlist.targetDuration*3,a=n&&n.end&&this.currentTime_()-n.end>e.playlist.partTargetDuration*3;if(s||a){this.logger_(`bad ${s?"segment":"part"} ${jg(e)}`),this.resetEverything();return}this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(e){if(e.duration<J1){this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record ${J1}`);return}const t=this.throughput.rate,i=Date.now()-e.endOfAllRequests+1,n=Math.floor(e.byteLength/i*8*1e3);this.throughput.rate+=(n-t)/++this.throughput.count}addSegmentMetadataCue_(e){if(!this.segmentMetadataTrack_)return;const t=e.segment,i=t.start,n=t.end;if(!JI(i)||!JI(n))return;t_(i,n,this.segmentMetadataTrack_);const s=Z.WebKitDataCue||Z.VTTCue,a={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,programDateTime:t.programDateTime,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:i,end:n},c=JSON.stringify(a),h=new s(i,n,c);h.value=a,this.segmentMetadataTrack_.addCue(h)}};function vf(){}const u4=function(r){return typeof r!="string"?r:r.replace(/./,e=>e.toUpperCase())},AH=["video","audio"],PE=(r,e)=>{const t=e[`${r}Buffer`];return t&&t.updating||e.queuePending[r]},wH=(r,e)=>{for(let t=0;t<e.length;t++){const i=e[t];if(i.type==="mediaSource")return null;if(i.type===r)return t}return null},x0=(r,e)=>{if(e.queue.length===0)return;let t=0,i=e.queue[t];if(i.type==="mediaSource"){!e.updating()&&e.mediaSource.readyState!=="closed"&&(e.queue.shift(),i.action(e),i.doneFn&&i.doneFn(),x0("audio",e),x0("video",e));return}if(r!=="mediaSource"&&!(!e.ready()||e.mediaSource.readyState==="closed"||PE(r,e))){if(i.type!==r){if(t=wH(r,e.queue),t===null)return;i=e.queue[t]}if(e.queue.splice(t,1),e.queuePending[r]=i,i.action(r,e),!i.doneFn){e.queuePending[r]=null,x0(r,e);return}}},c4=(r,e)=>{const t=e[`${r}Buffer`],i=u4(r);t&&(t.removeEventListener("updateend",e[`on${i}UpdateEnd_`]),t.removeEventListener("error",e[`on${i}Error_`]),e.codecs[r]=null,e[`${r}Buffer`]=null)},Jd=(r,e)=>r&&e&&Array.prototype.indexOf.call(r.sourceBuffers,e)!==-1,ku={appendBuffer:(r,e,t)=>(i,n)=>{const s=n[`${i}Buffer`];if(Jd(n.mediaSource,s)){n.logger_(`Appending segment ${e.mediaIndex}'s ${r.length} bytes to ${i}Buffer`);try{s.appendBuffer(r)}catch(a){n.logger_(`Error with code ${a.code} `+(a.code===BO?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${e.mediaIndex} to ${i}Buffer`),n.queuePending[i]=null,t(a)}}},remove:(r,e)=>(t,i)=>{const n=i[`${t}Buffer`];if(Jd(i.mediaSource,n)){i.logger_(`Removing ${r} to ${e} from ${t}Buffer`);try{n.remove(r,e)}catch{i.logger_(`Remove ${r} to ${e} from ${t}Buffer failed`)}}},timestampOffset:r=>(e,t)=>{const i=t[`${e}Buffer`];Jd(t.mediaSource,i)&&(t.logger_(`Setting ${e}timestampOffset to ${r}`),i.timestampOffset=r)},callback:r=>(e,t)=>{r()},endOfStream:r=>e=>{if(e.mediaSource.readyState==="open"){e.logger_(`Calling mediaSource endOfStream(${r||""})`);try{e.mediaSource.endOfStream(r)}catch(t){ft.log.warn("Failed to call media source endOfStream",t)}}},duration:r=>e=>{e.logger_(`Setting mediaSource duration to ${r}`);try{e.mediaSource.duration=r}catch(t){ft.log.warn("Failed to set media source duration",t)}},abort:()=>(r,e)=>{if(e.mediaSource.readyState!=="open")return;const t=e[`${r}Buffer`];if(Jd(e.mediaSource,t)){e.logger_(`calling abort on ${r}Buffer`);try{t.abort()}catch(i){ft.log.warn(`Failed to abort on ${r}Buffer`,i)}}},addSourceBuffer:(r,e)=>t=>{const i=u4(r),n=R0(e);t.logger_(`Adding ${r}Buffer with codec ${e} to mediaSource`);const s=t.mediaSource.addSourceBuffer(n);s.addEventListener("updateend",t[`on${i}UpdateEnd_`]),s.addEventListener("error",t[`on${i}Error_`]),t.codecs[r]=e,t[`${r}Buffer`]=s},removeSourceBuffer:r=>e=>{const t=e[`${r}Buffer`];if(c4(r,e),!!Jd(e.mediaSource,t)){e.logger_(`Removing ${r}Buffer with codec ${e.codecs[r]} from mediaSource`);try{e.mediaSource.removeSourceBuffer(t)}catch(i){ft.log.warn(`Failed to removeSourceBuffer ${r}Buffer`,i)}}},changeType:r=>(e,t)=>{const i=t[`${e}Buffer`],n=R0(r);if(!Jd(t.mediaSource,i))return;const s=r.substring(0,r.indexOf(".")),a=t.codecs[e];if(a.substring(0,a.indexOf("."))===s)return;const h={codecsChangeInfo:{from:a,to:r}};t.trigger({type:"codecschange",metadata:h}),t.logger_(`changing ${e}Buffer codec from ${a} to ${r}`);try{i.changeType(n),t.codecs[e]=r}catch(m){h.errorType=ft.Error.StreamingCodecsChangeError,h.error=m,m.metadata=h,t.error_=m,t.trigger("error"),ft.log.warn(`Failed to changeType on ${e}Buffer`,m)}}},Ou=({type:r,sourceUpdater:e,action:t,doneFn:i,name:n})=>{e.queue.push({type:r,action:t,doneFn:i,name:n}),x0(r,e)},i3=(r,e)=>t=>{const i=e[`${r}Buffered`](),n=NV(i);if(e.logger_(`received "updateend" event for ${r} Source Buffer: `,n),e.queuePending[r]){const s=e.queuePending[r].doneFn;e.queuePending[r]=null,s&&s(e[`${r}Error_`])}x0(r,e)};let d4=class extends ft.EventTarget{constructor(e){super(),this.mediaSource=e,this.sourceopenListener_=()=>x0("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=Tc("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=i3("video",this),this.onAudioUpdateEnd_=i3("audio",this),this.onVideoError_=t=>{this.videoError_=t},this.onAudioError_=t=>{this.audioError_=t},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,t){Ou({type:"mediaSource",sourceUpdater:this,action:ku.addSourceBuffer(e,t),name:"addSourceBuffer"})}abort(e){Ou({type:e,sourceUpdater:this,action:ku.abort(e),name:"abort"})}removeSourceBuffer(e){if(!this.canRemoveSourceBuffer()){ft.log.error("removeSourceBuffer is not supported!");return}Ou({type:"mediaSource",sourceUpdater:this,action:ku.removeSourceBuffer(e),name:"removeSourceBuffer"})}canRemoveSourceBuffer(){return!ft.browser.IS_FIREFOX&&Z.MediaSource&&Z.MediaSource.prototype&&typeof Z.MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return Z.SourceBuffer&&Z.SourceBuffer.prototype&&typeof Z.SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(e,t){if(!this.canChangeType()){ft.log.error("changeType is not supported!");return}Ou({type:e,sourceUpdater:this,action:ku.changeType(t),name:"changeType"})}addOrChangeSourceBuffers(e){if(!e||typeof e!="object"||Object.keys(e).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach(t=>{const i=e[t];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(t,i);this.canChangeType()&&this.changeType(t,i)})}appendBuffer(e,t){const{segmentInfo:i,type:n,bytes:s}=e;if(this.processedAppend_=!0,n==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([e,t]),this.logger_(`delayed audio append of ${s.length} until video append`);return}const a=t;if(Ou({type:n,sourceUpdater:this,action:ku.appendBuffer(s,i||{mediaIndex:-1},a),doneFn:t,name:"appendBuffer"}),n==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const c=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${c.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,c.forEach(h=>{this.appendBuffer.apply(this,h)})}}audioBuffered(){return Jd(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:Ja()}videoBuffered(){return Jd(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:Ja()}buffered(){const e=Jd(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,t=Jd(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return t&&!e?this.audioBuffered():e&&!t?this.videoBuffered():VV(this.audioBuffered(),this.videoBuffered())}setDuration(e,t=vf){Ou({type:"mediaSource",sourceUpdater:this,action:ku.duration(e),name:"duration",doneFn:t})}endOfStream(e=null,t=vf){typeof e!="string"&&(e=void 0),Ou({type:"mediaSource",sourceUpdater:this,action:ku.endOfStream(e),name:"endOfStream",doneFn:t})}removeAudio(e,t,i=vf){if(!this.audioBuffered().length||this.audioBuffered().end(0)===0){i();return}Ou({type:"audio",sourceUpdater:this,action:ku.remove(e,t),doneFn:i,name:"remove"})}removeVideo(e,t,i=vf){if(!this.videoBuffered().length||this.videoBuffered().end(0)===0){i();return}Ou({type:"video",sourceUpdater:this,action:ku.remove(e,t),doneFn:i,name:"remove"})}updating(){return!!(PE("audio",this)||PE("video",this))}audioTimestampOffset(e){return typeof e<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(Ou({type:"audio",sourceUpdater:this,action:ku.timestampOffset(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return typeof e<"u"&&this.videoBuffer&&this.videoTimestampOffset_!==e&&(Ou({type:"video",sourceUpdater:this,action:ku.timestampOffset(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){this.audioBuffer&&Ou({type:"audio",sourceUpdater:this,action:ku.callback(e),name:"callback"})}videoQueueCallback(e){this.videoBuffer&&Ou({type:"video",sourceUpdater:this,action:ku.callback(e),name:"callback"})}dispose(){this.trigger("dispose"),AH.forEach(e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[`${e}QueueCallback`](()=>c4(e,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}};const n3=r=>decodeURIComponent(escape(String.fromCharCode.apply(null,r))),EH=r=>{const e=new Uint8Array(r);return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")},r3=new Uint8Array(`

`.split("").map(r=>r.charCodeAt(0)));let CH=class extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}},MH=class extends IE{constructor(e,t={}){super(e,t),this.mediaSource_=null,this.subtitlesTrack_=null,this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.loadVttJs=e.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return Ja();const e=this.subtitlesTrack_.cues,t=e[0].startTime,i=e[e.length-1].startTime;return Ja([[t,i]])}initSegmentForMap(e,t=!1){if(!e)return null;const i=Tx(e);let n=this.initSegments_[i];if(t&&!n&&e.bytes){const s=r3.byteLength+e.bytes.byteLength,a=new Uint8Array(s);a.set(e.bytes),a.set(r3,e.bytes.byteLength),this.initSegments_[i]=n={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:a}}return n||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return typeof e>"u"?this.subtitlesTrack_:(this.subtitlesTrack_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}remove(e,t){t_(e,t,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(e){if(this.syncController_.timestampOffsetForTimeline(e.timeline)===null){const t=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};this.syncController_.one("timestampoffset",t),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(e)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(e,t,i){if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(t.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(e){e.code===hh.TIMEOUT&&this.handleTimeout_(),e.code===hh.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(e);return}const n=this.pendingSegment_,s=i.mp4VttCues&&i.mp4VttCues.length;s&&(n.mp4VttCues=i.mp4VttCues),this.saveBandwidthRelatedStats_(n.duration,t.stats),t.key&&this.segmentKey(t.key,!0),this.state="APPENDING",this.trigger("appending");const a=n.segment;if(a.map&&(a.map.bytes=t.map.bytes),n.bytes=t.bytes,typeof Z.WebVTT!="function"&&typeof this.loadVttJs=="function"){this.state="WAITING_ON_VTTJS",this.loadVttJs().then(()=>this.segmentRequestFinished_(e,t,i),()=>this.stopForError({message:"Error loading vtt.js"}));return}a.requested=!0;try{this.parseVTTCues_(n)}catch(c){this.stopForError({message:c.message,metadata:{errorType:ft.Error.StreamingVttParserError,error:c}});return}if(s||this.updateTimeMapping_(n,this.syncController_.timelines[n.timeline],this.playlist_),n.cues.length?n.timingInfo={start:n.cues[0].startTime,end:n.cues[n.cues.length-1].endTime}:n.timingInfo={start:n.startOfSegment,end:n.startOfSegment+n.duration},n.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}n.byteLength=n.bytes.byteLength,this.mediaSecondsLoaded+=a.duration,n.cues.forEach(c=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new Z.VTTCue(c.startTime,c.endTime,c.text):c)}),cH(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(e,t){const i=e&&e.type==="vtt",n=t&&t.type==="text";i&&n&&super.handleData_(e,t)}updateTimingInfoEnd_(){}parseMp4VttCues_(e){const t=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();e.mp4VttCues.forEach(i=>{const n=i.start+t,s=i.end+t,a=new Z.VTTCue(n,s,i.cueText);i.settings&&i.settings.split(" ").forEach(c=>{const h=c.split(":"),m=h[0],v=h[1];a[m]=isNaN(v)?v:Number(v)}),e.cues.push(a)})}parseVTTCues_(e){let t,i=!1;if(typeof Z.WebVTT!="function")throw new CH;if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},e.mp4VttCues){this.parseMp4VttCues_(e);return}typeof Z.TextDecoder=="function"?t=new Z.TextDecoder("utf8"):(t=Z.WebVTT.StringDecoder(),i=!0);const n=new Z.WebVTT.Parser(Z,Z.vttjs,t);if(n.oncue=e.cues.push.bind(e.cues),n.ontimestampmap=a=>{e.timestampmap=a},n.onparsingerror=a=>{ft.log.warn("Error encountered when parsing cues: "+a.message)},e.segment.map){let a=e.segment.map.bytes;i&&(a=n3(a)),n.parse(a)}let s=e.bytes;i&&(s=n3(s)),n.parse(s),n.flush()}updateTimeMapping_(e,t,i){const n=e.segment;if(!t)return;if(!e.cues.length){n.empty=!0;return}const{MPEGTS:s,LOCAL:a}=e.timestampmap,h=s/Fm.ONE_SECOND_IN_TS-a+t.mapping;if(e.cues.forEach(m=>{const v=m.endTime-m.startTime,b=this.handleRollover_(m.startTime+h,t.time);m.startTime=Math.max(b,0),m.endTime=Math.max(b+v,0)}),!i.syncInfo){const m=e.cues[0].startTime,v=e.cues[e.cues.length-1].startTime;i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:Math.min(m,v-n.duration)}}}handleRollover_(e,t){if(t===null)return e;let i=e*Fm.ONE_SECOND_IN_TS;const n=t*Fm.ONE_SECOND_IN_TS;let s;for(n<i?s=-8589934592:s=8589934592;Math.abs(i-n)>4294967296;)i+=s;return i/Fm.ONE_SECOND_IN_TS}};const DH=function(r,e){const t=r.cues;for(let i=0;i<t.length;i++){const n=t[i];if(e>=n.adStartTime&&e<=n.adEndTime)return n}return null},IH=function(r,e,t=0){if(!r.segments)return;let i=t,n;for(let s=0;s<r.segments.length;s++){const a=r.segments[s];if(n||(n=DH(e,i+a.duration/2)),n){if("cueIn"in a){n.endTime=i,n.adEndTime=i,i+=a.duration,n=null;continue}if(i<n.endTime){i+=a.duration;continue}n.endTime+=a.duration}else if("cueOut"in a&&(n=new Z.VTTCue(i,i+a.duration,a.cueOut),n.adStartTime=i,n.adEndTime=i+parseFloat(a.cueOut),e.addCue(n)),"cueOutCont"in a){const[c,h]=a.cueOutCont.split("/").map(parseFloat);n=new Z.VTTCue(i,i+a.duration,""),n.adStartTime=i-c,n.adEndTime=n.adStartTime+h,e.addCue(n)}i+=a.duration}};class s3{constructor({start:e,end:t,segmentIndex:i,partIndex:n=null,appended:s=!1}){this.start_=e,this.end_=t,this.segmentIndex_=i,this.partIndex_=n,this.appended_=s}isInRange(e){return e>=this.start&&e<this.end}markAppended(){this.appended_=!0}resetAppendedStatus(){this.appended_=!1}get isAppended(){return this.appended_}get start(){return this.start_}get end(){return this.end_}get segmentIndex(){return this.segmentIndex_}get partIndex(){return this.partIndex_}}class PH{constructor(e,t=[]){this.segmentSyncInfo_=e,this.partsSyncInfo_=t}get segmentSyncInfo(){return this.segmentSyncInfo_}get partsSyncInfo(){return this.partsSyncInfo_}get hasPartsSyncInfo(){return this.partsSyncInfo_.length>0}resetAppendStatus(){this.segmentSyncInfo_.resetAppendedStatus(),this.partsSyncInfo_.forEach(e=>e.resetAppendedStatus())}}class h4{constructor(){this.storage_=new Map,this.diagnostics_="",this.isReliable_=!1,this.start_=-1/0,this.end_=1/0}get start(){return this.start_}get end(){return this.end_}get diagnostics(){return this.diagnostics_}get isReliable(){return this.isReliable_}resetAppendedStatus(){this.storage_.forEach(e=>e.resetAppendStatus())}update(e,t){const{mediaSequence:i,segments:n}=e;if(this.isReliable_=this.isReliablePlaylist_(i,n),!!this.isReliable_)return this.updateStorage_(n,i,this.calculateBaseTime_(i,n,t))}getSyncInfoForTime(e){for(const{segmentSyncInfo:t,partsSyncInfo:i}of this.storage_.values())if(i.length){for(const n of i)if(n.isInRange(e))return n}else if(t.isInRange(e))return t;return null}getSyncInfoForMediaSequence(e){return this.storage_.get(e)}updateStorage_(e,t,i){const n=new Map;let s=`
`,a=i,c=t;this.start_=a,e.forEach((h,m)=>{const v=this.storage_.get(c),b=a,x=b+h.duration,C=!!(v&&v.segmentSyncInfo&&v.segmentSyncInfo.isAppended),B=new s3({start:b,end:x,appended:C,segmentIndex:m});h.syncInfo=B;let P=a;const N=(h.parts||[]).map((ae,X)=>{const de=P,ge=P+ae.duration,ue=!!(v&&v.partsSyncInfo&&v.partsSyncInfo[X]&&v.partsSyncInfo[X].isAppended),be=new s3({start:de,end:ge,appended:ue,segmentIndex:m,partIndex:X});return P=ge,s+=`Media Sequence: ${c}.${X} | Range: ${de} --> ${ge} | Appended: ${ue}
`,ae.syncInfo=be,be});n.set(c,new PH(B,N)),s+=`${l4(h.resolvedUri)} | Media Sequence: ${c} | Range: ${b} --> ${x} | Appended: ${C}
`,c++,a=x}),this.end_=a,this.storage_=n,this.diagnostics_=s}calculateBaseTime_(e,t,i){if(!this.storage_.size)return 0;if(this.storage_.has(e))return this.storage_.get(e).segmentSyncInfo.start;const n=Math.min(...this.storage_.keys());if(e<n){const s=n-e;let a=this.storage_.get(n).segmentSyncInfo.start;for(let c=0;c<s;c++){const h=t[c];a-=h.duration}return a}return i}isReliablePlaylist_(e,t){return e!=null&&Array.isArray(t)&&t.length}}class a3 extends h4{constructor(e){super(),this.parent_=e}calculateBaseTime_(e,t,i){if(!this.storage_.size){const n=this.parent_.getSyncInfoForMediaSequence(e);return n?n.segmentSyncInfo.start:0}return super.calculateBaseTime_(e,t,i)}}const LH=86400,pw=[{name:"VOD",run:(r,e,t,i,n)=>t!==1/0?{time:0,segmentIndex:0,partIndex:null}:null},{name:"MediaSequence",run:(r,e,t,i,n,s)=>{const a=r.getMediaSequenceSync(s);if(!a||!a.isReliable)return null;const c=a.getSyncInfoForTime(n);return c?{time:c.start,partIndex:c.partIndex,segmentIndex:c.segmentIndex}:null}},{name:"ProgramDateTime",run:(r,e,t,i,n)=>{if(!Object.keys(r.timelineToDatetimeMappings).length)return null;let s=null,a=null;const c=TE(e);n=n||0;for(let h=0;h<c.length;h++){const m=e.endList||n===0?h:c.length-(h+1),v=c[m],b=v.segment,x=r.timelineToDatetimeMappings[b.timeline];if(!x||!b.dateTimeObject)continue;let B=b.dateTimeObject.getTime()/1e3+x;if(b.parts&&typeof v.partIndex=="number")for(let N=0;N<v.partIndex;N++)B+=b.parts[N].duration;const P=Math.abs(n-B);if(a!==null&&(P===0||a<P))break;a=P,s={time:B,segmentIndex:v.segmentIndex,partIndex:v.partIndex}}return s}},{name:"Segment",run:(r,e,t,i,n)=>{let s=null,a=null;n=n||0;const c=TE(e);for(let h=0;h<c.length;h++){const m=e.endList||n===0?h:c.length-(h+1),v=c[m],b=v.segment,x=v.part&&v.part.start||b&&b.start;if(b.timeline===i&&typeof x<"u"){const C=Math.abs(n-x);if(a!==null&&a<C)break;(!s||a===null||a>=C)&&(a=C,s={time:x,segmentIndex:v.segmentIndex,partIndex:v.partIndex})}}return s}},{name:"Discontinuity",run:(r,e,t,i,n)=>{let s=null;if(n=n||0,e.discontinuityStarts&&e.discontinuityStarts.length){let a=null;for(let c=0;c<e.discontinuityStarts.length;c++){const h=e.discontinuityStarts[c],m=e.discontinuitySequence+c+1,v=r.discontinuities[m];if(v){const b=Math.abs(n-v.time);if(a!==null&&a<b)break;(!s||a===null||a>=b)&&(a=b,s={time:v.time,segmentIndex:h,partIndex:null})}}}return s}},{name:"Playlist",run:(r,e,t,i,n)=>e.syncInfo?{time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence,partIndex:null}:null}];let RH=class extends ft.EventTarget{constructor(e={}){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={};const t=new h4,i=new a3(t),n=new a3(t);this.mediaSequenceStorage_={main:t,audio:i,vtt:n},this.logger_=Tc("SyncController")}getMediaSequenceSync(e){return this.mediaSequenceStorage_[e]||null}getSyncPoint(e,t,i,n,s){if(t!==1/0)return pw.find(({name:h})=>h==="VOD").run(this,e,t);const a=this.runStrategies_(e,t,i,n,s);if(!a.length)return null;for(const c of a){const{syncPoint:h,strategy:m}=c,{segmentIndex:v,time:b}=h;if(v<0)continue;const x=e.segments[v],C=b,B=C+x.duration;if(this.logger_(`Strategy: ${m}. Current time: ${n}. selected segment: ${v}. Time: [${C} -> ${B}]}`),n>=C&&n<B)return this.logger_("Found sync point with exact match: ",h),h}return this.selectSyncPoint_(a,{key:"time",value:n})}getExpiredTime(e,t){if(!e||!e.segments)return null;const i=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!i.length)return null;const n=this.selectSyncPoint_(i,{key:"segmentIndex",value:0});return n.segmentIndex>0&&(n.time*=-1),Math.abs(n.time+f_({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:n.segmentIndex,endIndex:0}))}runStrategies_(e,t,i,n,s){const a=[];for(let c=0;c<pw.length;c++){const h=pw[c],m=h.run(this,e,t,i,n,s);m&&(m.strategy=h.name,a.push({strategy:h.name,syncPoint:m}))}return a}selectSyncPoint_(e,t){let i=e[0].syncPoint,n=Math.abs(e[0].syncPoint[t.key]-t.value),s=e[0].strategy;for(let a=1;a<e.length;a++){const c=Math.abs(e[a].syncPoint[t.key]-t.value);c<n&&(n=c,i=e[a].syncPoint,s=e[a].strategy)}return this.logger_(`syncPoint for [${t.key}: ${t.value}] chosen with strategy [${s}]: [time:${i.time}, segmentIndex:${i.segmentIndex}`+(typeof i.partIndex=="number"?`,partIndex:${i.partIndex}`:"")+"]"),i}saveExpiredSegmentInfo(e,t){const i=t.mediaSequence-e.mediaSequence;if(i>LH){ft.log.warn(`Not saving expired segment info. Media sequence gap ${i} is too large.`);return}for(let n=i-1;n>=0;n--){const s=e.segments[n];if(s&&typeof s.start<"u"){t.syncInfo={mediaSequence:e.mediaSequence+n,time:s.start},this.logger_(`playlist refresh sync: [time:${t.syncInfo.time}, mediaSequence: ${t.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){const t=e.segments[0],i=t.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[t.timeline]=-i}}saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:t}){const i=this.calculateSegmentTimeMapping_(e,e.timingInfo,t),n=e.segment;i&&(this.saveDiscontinuitySyncInfo_(e),e.playlist.syncInfo||(e.playlist.syncInfo={mediaSequence:e.playlist.mediaSequence+e.mediaIndex,time:n.start}));const s=n.dateTimeObject;n.discontinuity&&t&&s&&(this.timelineToDatetimeMappings[n.timeline]=-(s.getTime()/1e3))}timestampOffsetForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].time}mappingForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,t,i){const n=e.segment,s=e.part;let a=this.timelines[e.timeline],c,h;if(typeof e.timestampOffset=="number")a={time:e.startOfSegment,mapping:e.startOfSegment-t.start},i&&(this.timelines[e.timeline]=a,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${a.time}] [mapping: ${a.mapping}]`)),c=e.startOfSegment,h=t.end+a.mapping;else if(a)c=t.start+a.mapping,h=t.end+a.mapping;else return!1;return s&&(s.start=c,s.end=h),(!n.start||c<n.start)&&(n.start=c),n.end=h,!0}saveDiscontinuitySyncInfo_(e){const t=e.playlist,i=e.segment;if(i.discontinuity)this.discontinuities[i.timeline]={time:i.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(let n=0;n<t.discontinuityStarts.length;n++){const s=t.discontinuityStarts[n],a=t.discontinuitySequence+n+1,c=s-e.mediaIndex,h=Math.abs(c);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>h){let m;c<0?m=i.start-f_({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex,endIndex:s}):m=i.end+f_({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex+1,endIndex:s}),this.discontinuities[a]={time:m,accuracy:h}}}}dispose(){this.trigger("dispose"),this.off()}},kH=class extends ft.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:e,from:t,to:i}){return typeof t=="number"&&typeof i=="number"&&(this.pendingTimelineChanges_[e]={type:e,from:t,to:i},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[e]}lastTimelineChange({type:e,from:t,to:i}){if(typeof t=="number"&&typeof i=="number"){this.lastTimelineChanges_[e]={type:e,from:t,to:i},delete this.pendingTimelineChanges_[e];const n={timelineChangeInfo:{from:t,to:i}};this.trigger({type:"timelinechange",metadata:n})}return this.lastTimelineChanges_[e]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}};const OH=KO(ZO(function(){var r=function(){function P(){this.listeners={}}var N=P.prototype;return N.on=function(X,de){this.listeners[X]||(this.listeners[X]=[]),this.listeners[X].push(de)},N.off=function(X,de){if(!this.listeners[X])return!1;var ge=this.listeners[X].indexOf(de);return this.listeners[X]=this.listeners[X].slice(0),this.listeners[X].splice(ge,1),ge>-1},N.trigger=function(X){var de=this.listeners[X];if(de)if(arguments.length===2)for(var ge=de.length,ue=0;ue<ge;++ue)de[ue].call(this,arguments[1]);else for(var be=Array.prototype.slice.call(arguments,1),fe=de.length,ve=0;ve<fe;++ve)de[ve].apply(this,be)},N.dispose=function(){this.listeners={}},N.pipe=function(X){this.on("data",function(de){X.push(de)})},P}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function e(P){return P.subarray(0,P.byteLength-P[P.byteLength-1])}/*! @name aes-decrypter @version 4.0.2 @license Apache-2.0 */const t=function(){const P=[[[],[],[],[],[]],[[],[],[],[],[]]],N=P[0],ae=P[1],X=N[4],de=ae[4];let ge,ue,be;const fe=[],ve=[];let ie,re,Ne,De,ke,ut;for(ge=0;ge<256;ge++)ve[(fe[ge]=ge<<1^(ge>>7)*283)^ge]=ge;for(ue=be=0;!X[ue];ue^=ie||1,be=ve[be]||1)for(De=be^be<<1^be<<2^be<<3^be<<4,De=De>>8^De&255^99,X[ue]=De,de[De]=ue,Ne=fe[re=fe[ie=fe[ue]]],ut=Ne*16843009^re*65537^ie*257^ue*16843008,ke=fe[De]*257^De*16843008,ge=0;ge<4;ge++)N[ge][ue]=ke=ke<<24^ke>>>8,ae[ge][De]=ut=ut<<24^ut>>>8;for(ge=0;ge<5;ge++)N[ge]=N[ge].slice(0),ae[ge]=ae[ge].slice(0);return P};let i=null;class n{constructor(N){i||(i=t()),this._tables=[[i[0][0].slice(),i[0][1].slice(),i[0][2].slice(),i[0][3].slice(),i[0][4].slice()],[i[1][0].slice(),i[1][1].slice(),i[1][2].slice(),i[1][3].slice(),i[1][4].slice()]];let ae,X,de;const ge=this._tables[0][4],ue=this._tables[1],be=N.length;let fe=1;if(be!==4&&be!==6&&be!==8)throw new Error("Invalid aes key size");const ve=N.slice(0),ie=[];for(this._key=[ve,ie],ae=be;ae<4*be+28;ae++)de=ve[ae-1],(ae%be===0||be===8&&ae%be===4)&&(de=ge[de>>>24]<<24^ge[de>>16&255]<<16^ge[de>>8&255]<<8^ge[de&255],ae%be===0&&(de=de<<8^de>>>24^fe<<24,fe=fe<<1^(fe>>7)*283)),ve[ae]=ve[ae-be]^de;for(X=0;ae;X++,ae--)de=ve[X&3?ae:ae-4],ae<=4||X<4?ie[X]=de:ie[X]=ue[0][ge[de>>>24]]^ue[1][ge[de>>16&255]]^ue[2][ge[de>>8&255]]^ue[3][ge[de&255]]}decrypt(N,ae,X,de,ge,ue){const be=this._key[1];let fe=N^be[0],ve=de^be[1],ie=X^be[2],re=ae^be[3],Ne,De,ke;const ut=be.length/4-2;let _t,vt=4;const tt=this._tables[1],je=tt[0],it=tt[1],Xe=tt[2],Se=tt[3],ct=tt[4];for(_t=0;_t<ut;_t++)Ne=je[fe>>>24]^it[ve>>16&255]^Xe[ie>>8&255]^Se[re&255]^be[vt],De=je[ve>>>24]^it[ie>>16&255]^Xe[re>>8&255]^Se[fe&255]^be[vt+1],ke=je[ie>>>24]^it[re>>16&255]^Xe[fe>>8&255]^Se[ve&255]^be[vt+2],re=je[re>>>24]^it[fe>>16&255]^Xe[ve>>8&255]^Se[ie&255]^be[vt+3],vt+=4,fe=Ne,ve=De,ie=ke;for(_t=0;_t<4;_t++)ge[(3&-_t)+ue]=ct[fe>>>24]<<24^ct[ve>>16&255]<<16^ct[ie>>8&255]<<8^ct[re&255]^be[vt++],Ne=fe,fe=ve,ve=ie,ie=re,re=Ne}}class s extends r{constructor(){super(r),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(N){this.jobs.push(N),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const a=function(P){return P<<24|(P&65280)<<8|(P&16711680)>>8|P>>>24},c=function(P,N,ae){const X=new Int32Array(P.buffer,P.byteOffset,P.byteLength>>2),de=new n(Array.prototype.slice.call(N)),ge=new Uint8Array(P.byteLength),ue=new Int32Array(ge.buffer);let be,fe,ve,ie,re,Ne,De,ke,ut;for(be=ae[0],fe=ae[1],ve=ae[2],ie=ae[3],ut=0;ut<X.length;ut+=4)re=a(X[ut]),Ne=a(X[ut+1]),De=a(X[ut+2]),ke=a(X[ut+3]),de.decrypt(re,Ne,De,ke,ue,ut),ue[ut]=a(ue[ut]^be),ue[ut+1]=a(ue[ut+1]^fe),ue[ut+2]=a(ue[ut+2]^ve),ue[ut+3]=a(ue[ut+3]^ie),be=re,fe=Ne,ve=De,ie=ke;return ge};class h{constructor(N,ae,X,de){const ge=h.STEP,ue=new Int32Array(N.buffer),be=new Uint8Array(N.byteLength);let fe=0;for(this.asyncStream_=new s,this.asyncStream_.push(this.decryptChunk_(ue.subarray(fe,fe+ge),ae,X,be)),fe=ge;fe<ue.length;fe+=ge)X=new Uint32Array([a(ue[fe-4]),a(ue[fe-3]),a(ue[fe-2]),a(ue[fe-1])]),this.asyncStream_.push(this.decryptChunk_(ue.subarray(fe,fe+ge),ae,X,be));this.asyncStream_.push(function(){de(null,e(be))})}static get STEP(){return 32e3}decryptChunk_(N,ae,X,de){return function(){const ge=c(N,ae,X);de.set(ge,N.byteOffset)}}}var m=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},v;typeof window<"u"?v=window:typeof m<"u"?v=m:typeof self<"u"?v=self:v={};var b=v,x=function(N){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(N):N&&N.buffer instanceof ArrayBuffer},C=b.BigInt||Number;C("0x1"),C("0x100"),C("0x10000"),C("0x1000000"),C("0x100000000"),C("0x10000000000"),C("0x1000000000000"),C("0x100000000000000"),C("0x10000000000000000"),function(){var P=new Uint16Array([65484]),N=new Uint8Array(P.buffer,P.byteOffset,P.byteLength);return N[0]===255?"big":N[0]===204?"little":"unknown"}();const B=function(P){const N={};return Object.keys(P).forEach(ae=>{const X=P[ae];x(X)?N[ae]={bytes:X.buffer,byteOffset:X.byteOffset,byteLength:X.byteLength}:N[ae]=X}),N};self.onmessage=function(P){const N=P.data,ae=new Uint8Array(N.encrypted.bytes,N.encrypted.byteOffset,N.encrypted.byteLength),X=new Uint32Array(N.key.bytes,N.key.byteOffset,N.key.byteLength/4),de=new Uint32Array(N.iv.bytes,N.iv.byteOffset,N.iv.byteLength/4);new h(ae,X,de,function(ge,ue){self.postMessage(B({source:N.source,decrypted:ue}),[ue.buffer])})}}));var FH=QO(OH);const BH=r=>{let e=r.default?"main":"alternative";return r.characteristics&&r.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},f4=(r,e)=>{r.abort(),r.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},LE=(r,e)=>{e.activePlaylistLoader=r,r.load()},NH=(r,e)=>()=>{const{segmentLoaders:{[r]:t,main:i},mediaTypes:{[r]:n}}=e,s=n.activeTrack(),a=n.getActiveGroup(),c=n.activePlaylistLoader,h=n.lastGroup_;if(!(a&&h&&a.id===h.id)&&(n.lastGroup_=a,n.lastTrack_=s,f4(t,n),!(!a||a.isMainPlaylist))){if(!a.playlistLoader){c&&i.resetEverything();return}t.resyncLoader(),LE(a.playlistLoader,n)}},UH=(r,e)=>()=>{const{segmentLoaders:{[r]:t},mediaTypes:{[r]:i}}=e;i.lastGroup_=null,t.abort(),t.pause()},VH=(r,e)=>()=>{const{mainPlaylistLoader:t,segmentLoaders:{[r]:i,main:n},mediaTypes:{[r]:s}}=e,a=s.activeTrack(),c=s.getActiveGroup(),h=s.activePlaylistLoader,m=s.lastTrack_;if(!(m&&a&&m.id===a.id)&&(s.lastGroup_=c,s.lastTrack_=a,f4(i,s),!!c)){if(c.isMainPlaylist){if(!a||!m||a.id===m.id)return;const v=e.vhs.playlistController_,b=v.selectPlaylist();if(v.media()===b)return;s.logger_(`track change. Switching main audio from ${m.id} to ${a.id}`),t.pause(),n.resetEverything(),v.fastQualityChange_(b);return}if(r==="AUDIO"){if(!c.playlistLoader){n.setAudio(!0),n.resetEverything();return}i.setAudio(!0),n.setAudio(!1)}if(h===c.playlistLoader){LE(c.playlistLoader,s);return}i.track&&i.track(a),i.resetEverything(),LE(c.playlistLoader,s)}},xx={AUDIO:(r,e)=>()=>{const{mediaTypes:{[r]:t},excludePlaylist:i}=e,n=t.activeTrack(),s=t.activeGroup(),a=(s.filter(h=>h.default)[0]||s[0]).id,c=t.tracks[a];if(n===c){i({error:{message:"Problem encountered loading the default audio track."}});return}ft.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const h in t.tracks)t.tracks[h].enabled=t.tracks[h]===c;t.onTrackChanged()},SUBTITLES:(r,e)=>()=>{const{mediaTypes:{[r]:t}}=e;ft.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");const i=t.activeTrack();i&&(i.mode="disabled"),t.onTrackChanged()}},o3={AUDIO:(r,e,t)=>{if(!e)return;const{tech:i,requestOptions:n,segmentLoaders:{[r]:s}}=t;e.on("loadedmetadata",()=>{const a=e.media();s.playlist(a,n),(!i.paused()||a.endList&&i.preload()!=="none")&&s.load()}),e.on("loadedplaylist",()=>{s.playlist(e.media(),n),i.paused()||s.load()}),e.on("error",xx[r](r,t))},SUBTITLES:(r,e,t)=>{const{tech:i,requestOptions:n,segmentLoaders:{[r]:s},mediaTypes:{[r]:a}}=t;e.on("loadedmetadata",()=>{const c=e.media();s.playlist(c,n),s.track(a.activeTrack()),(!i.paused()||c.endList&&i.preload()!=="none")&&s.load()}),e.on("loadedplaylist",()=>{s.playlist(e.media(),n),i.paused()||s.load()}),e.on("error",xx[r](r,t))}},zH={AUDIO:(r,e)=>{const{vhs:t,sourceType:i,segmentLoaders:{[r]:n},requestOptions:s,main:{mediaGroups:a},mediaTypes:{[r]:{groups:c,tracks:h,logger_:m}},mainPlaylistLoader:v}=e,b=Y_(v.main);(!a[r]||Object.keys(a[r]).length===0)&&(a[r]={main:{default:{default:!0}}},b&&(a[r].main.default.playlists=v.main.playlists));for(const x in a[r]){c[x]||(c[x]=[]);for(const C in a[r][x]){let B=a[r][x][C],P;if(b?(m(`AUDIO group '${x}' label '${C}' is a main playlist`),B.isMainPlaylist=!0,P=null):i==="vhs-json"&&B.playlists?P=new s0(B.playlists[0],t,s):B.resolvedUri?P=new s0(B.resolvedUri,t,s):B.playlists&&i==="dash"?P=new CE(B.playlists[0],t,s,v):P=null,B=Hr({id:C,playlistLoader:P},B),o3[r](r,B.playlistLoader,e),c[x].push(B),typeof h[C]>"u"){const N=new ft.AudioTrack({id:C,kind:BH(B),enabled:!1,language:B.language,default:B.default,label:C});h[C]=N}}}n.on("error",xx[r](r,e))},SUBTITLES:(r,e)=>{const{tech:t,vhs:i,sourceType:n,segmentLoaders:{[r]:s},requestOptions:a,main:{mediaGroups:c},mediaTypes:{[r]:{groups:h,tracks:m}},mainPlaylistLoader:v}=e;for(const b in c[r]){h[b]||(h[b]=[]);for(const x in c[r][b]){if(!i.options_.useForcedSubtitles&&c[r][b][x].forced)continue;let C=c[r][b][x],B;if(n==="hls")B=new s0(C.resolvedUri,i,a);else if(n==="dash"){if(!C.playlists.filter(N=>N.excludeUntil!==1/0).length)return;B=new CE(C.playlists[0],i,a,v)}else n==="vhs-json"&&(B=new s0(C.playlists?C.playlists[0]:C.resolvedUri,i,a));if(C=Hr({id:x,playlistLoader:B},C),o3[r](r,C.playlistLoader,e),h[b].push(C),typeof m[x]>"u"){const P=t.addRemoteTextTrack({id:x,kind:"subtitles",default:C.default&&C.autoselect,language:C.language,label:x},!1).track;m[x]=P}}}s.on("error",xx[r](r,e))},"CLOSED-CAPTIONS":(r,e)=>{const{tech:t,main:{mediaGroups:i},mediaTypes:{[r]:{groups:n,tracks:s}}}=e;for(const a in i[r]){n[a]||(n[a]=[]);for(const c in i[r][a]){const h=i[r][a][c];if(!/^(?:CC|SERVICE)/.test(h.instreamId))continue;const m=t.options_.vhs&&t.options_.vhs.captionServices||{};let v={label:c,language:h.language,instreamId:h.instreamId,default:h.default&&h.autoselect};if(m[v.instreamId]&&(v=Hr(v,m[v.instreamId])),v.default===void 0&&delete v.default,n[a].push(Hr({id:c},h)),typeof s[c]>"u"){const b=t.addRemoteTextTrack({id:v.instreamId,kind:"captions",default:v.default,language:v.language,label:v.label},!1).track;s[c]=b}}}}},p4=(r,e)=>{for(let t=0;t<r.length;t++)if(vC(e,r[t])||r[t].playlists&&p4(r[t].playlists,e))return!0;return!1},HH=(r,e)=>t=>{const{mainPlaylistLoader:i,mediaTypes:{[r]:{groups:n}}}=e,s=i.media();if(!s)return null;let a=null;s.attributes[r]&&(a=n[s.attributes[r]]);const c=Object.keys(n);if(!a)if(r==="AUDIO"&&c.length>1&&Y_(e.main))for(let h=0;h<c.length;h++){const m=n[c[h]];if(p4(m,s)){a=m;break}}else n.main?a=n.main:c.length===1&&(a=n[c[0]]);return typeof t>"u"?a:t===null||!a?null:a.filter(h=>h.id===t.id)[0]||null},jH={AUDIO:(r,e)=>()=>{const{mediaTypes:{[r]:{tracks:t}}}=e;for(const i in t)if(t[i].enabled)return t[i];return null},SUBTITLES:(r,e)=>()=>{const{mediaTypes:{[r]:{tracks:t}}}=e;for(const i in t)if(t[i].mode==="showing"||t[i].mode==="hidden")return t[i];return null}},GH=(r,{mediaTypes:e})=>()=>{const t=e[r].activeTrack();return t?e[r].activeGroup(t):null},$H=r=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(m=>{zH[m](m,r)});const{mediaTypes:e,mainPlaylistLoader:t,tech:i,vhs:n,segmentLoaders:{["AUDIO"]:s,main:a}}=r;["AUDIO","SUBTITLES"].forEach(m=>{e[m].activeGroup=HH(m,r),e[m].activeTrack=jH[m](m,r),e[m].onGroupChanged=NH(m,r),e[m].onGroupChanging=UH(m,r),e[m].onTrackChanged=VH(m,r),e[m].getActiveGroup=GH(m,r)});const c=e.AUDIO.activeGroup();if(c){const m=(c.filter(b=>b.default)[0]||c[0]).id;e.AUDIO.tracks[m].enabled=!0,e.AUDIO.onGroupChanged(),e.AUDIO.onTrackChanged(),e.AUDIO.getActiveGroup().playlistLoader?(a.setAudio(!1),s.setAudio(!0)):a.setAudio(!0)}t.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(m=>e[m].onGroupChanged())}),t.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(m=>e[m].onGroupChanging())});const h=()=>{e.AUDIO.onTrackChanged(),i.trigger({type:"usage",name:"vhs-audio-change"})};i.audioTracks().addEventListener("change",h),i.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),n.on("dispose",()=>{i.audioTracks().removeEventListener("change",h),i.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),i.clearTracks("audio");for(const m in e.AUDIO.tracks)i.audioTracks().addTrack(e.AUDIO.tracks[m])},WH=()=>{const r={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{r[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:vf,activeTrack:vf,getActiveGroup:vf,onGroupChanged:vf,onTrackChanged:vf,lastTrack_:null,logger_:Tc(`MediaGroups[${e}]`)}}),r};class l3{constructor(){this.priority_=[],this.pathwayClones_=new Map}set version(e){e===1&&(this.version_=e)}set ttl(e){this.ttl_=e||300}set reloadUri(e){e&&(this.reloadUri_=Zl(this.reloadUri_,e))}set priority(e){e&&e.length&&(this.priority_=e)}set pathwayClones(e){e&&e.length&&(this.pathwayClones_=new Map(e.map(t=>[t.ID,t])))}get version(){return this.version_}get ttl(){return this.ttl_}get reloadUri(){return this.reloadUri_}get priority(){return this.priority_}get pathwayClones(){return this.pathwayClones_}}class qH extends ft.EventTarget{constructor(e,t){super(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=!1,this.availablePathways_=new Set,this.steeringManifest=new l3,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.currentPathwayClones=new Map,this.nextPathwayClones=new Map,this.excludedSteeringManifestURLs=new Set,this.logger_=Tc("Content Steering"),this.xhr_=e,this.getBandwidth_=t}assignTagProperties(e,t){this.manifestType_=t.serverUri?"HLS":"DASH";const i=t.serverUri||t.serverURL;if(!i){this.logger_(`steering manifest URL is ${i}, cannot request steering manifest.`),this.trigger("error");return}if(i.startsWith("data:")){this.decodeDataUriManifest_(i.substring(i.indexOf(",")+1));return}this.steeringManifest.reloadUri=Zl(e,i),this.defaultPathway=t.pathwayId||t.defaultServiceLocation,this.queryBeforeStart=t.queryBeforeStart,this.proxyServerUrl_=t.proxyServerURL,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering")}requestSteeringManifest(e){const t=this.steeringManifest.reloadUri;if(!t)return;const i=e?t:this.getRequestURI(t);if(!i){this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),this.dispose();return}const n={contentSteeringInfo:{uri:i}};this.trigger({type:"contentsteeringloadstart",metadata:n}),this.request_=this.xhr_({uri:i,requestType:"content-steering-manifest"},(s,a)=>{if(s){if(a.status===410){this.logger_(`manifest request 410 ${s}.`),this.logger_(`There will be no more content steering requests to ${i} this session.`),this.excludedSteeringManifestURLs.add(i);return}if(a.status===429){const m=a.responseHeaders["retry-after"];this.logger_(`manifest request 429 ${s}.`),this.logger_(`content steering will retry in ${m} seconds.`),this.startTTLTimeout_(parseInt(m,10));return}this.logger_(`manifest failed to load ${s}.`),this.startTTLTimeout_();return}this.trigger({type:"contentsteeringloadcomplete",metadata:n});let c;try{c=JSON.parse(this.request_.responseText)}catch(m){const v={errorType:ft.Error.StreamingContentSteeringParserError,error:m};this.trigger({type:"error",metadata:v})}this.assignSteeringProperties_(c);const h={contentSteeringInfo:n.contentSteeringInfo,contentSteeringManifest:{version:this.steeringManifest.version,reloadUri:this.steeringManifest.reloadUri,priority:this.steeringManifest.priority}};this.trigger({type:"contentsteeringparsed",metadata:h}),this.startTTLTimeout_()})}setProxyServerUrl_(e){const t=new Z.URL(e),i=new Z.URL(this.proxyServerUrl_);return i.searchParams.set("url",encodeURI(t.toString())),this.setSteeringParams_(i.toString())}decodeDataUriManifest_(e){const t=JSON.parse(Z.atob(e));this.assignSteeringProperties_(t)}setSteeringParams_(e){const t=new Z.URL(e),i=this.getPathway(),n=this.getBandwidth_();if(i){const s=`_${this.manifestType_}_pathway`;t.searchParams.set(s,i)}if(n){const s=`_${this.manifestType_}_throughput`;t.searchParams.set(s,n)}return t.toString()}assignSteeringProperties_(e){if(this.steeringManifest.version=e.VERSION,!this.steeringManifest.version){this.logger_(`manifest version is ${e.VERSION}, which is not supported.`),this.trigger("error");return}this.steeringManifest.ttl=e.TTL,this.steeringManifest.reloadUri=e["RELOAD-URI"],this.steeringManifest.priority=e["PATHWAY-PRIORITY"]||e["SERVICE-LOCATION-PRIORITY"],this.steeringManifest.pathwayClones=e["PATHWAY-CLONES"],this.nextPathwayClones=this.steeringManifest.pathwayClones,this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose());const i=(n=>{for(const s of n)if(this.availablePathways_.has(s))return s;return[...this.availablePathways_][0]})(this.steeringManifest.priority);this.currentPathway!==i&&(this.currentPathway=i,this.trigger("content-steering"))}getPathway(){return this.currentPathway||this.defaultPathway}getRequestURI(e){if(!e)return null;const t=n=>this.excludedSteeringManifestURLs.has(n);if(this.proxyServerUrl_){const n=this.setProxyServerUrl_(e);if(!t(n))return n}const i=this.setSteeringParams_(e);return t(i)?null:i}startTTLTimeout_(e=this.steeringManifest.ttl){const t=e*1e3;this.ttlTimeout_=Z.setTimeout(()=>{this.requestSteeringManifest()},t)}clearTTLTimeout_(){Z.clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}abort(){this.request_&&this.request_.abort(),this.request_=null}dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.steeringManifest=new l3}addAvailablePathway(e){e&&this.availablePathways_.add(e)}clearAvailablePathways(){this.availablePathways_.clear()}excludePathway(e){return this.availablePathways_.delete(e)}didDASHTagChange(e,t){return!t&&this.steeringManifest.reloadUri||t&&(Zl(e,t.serverURL)!==this.steeringManifest.reloadUri||t.defaultServiceLocation!==this.defaultPathway||t.queryBeforeStart!==this.queryBeforeStart||t.proxyServerURL!==this.proxyServerUrl_)}getAvailablePathways(){return this.availablePathways_}}const XH=(r,e)=>{let t=null;return(...i)=>{clearTimeout(t),t=setTimeout(()=>{r.apply(null,i)},e)}},YH=10;let _p;const QH=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],KH=function(r){return this.audioSegmentLoader_[r]+this.mainSegmentLoader_[r]},ZH=function({currentPlaylist:r,buffered:e,currentTime:t,nextPlaylist:i,bufferLowWaterLine:n,bufferHighWaterLine:s,duration:a,bufferBasedABR:c,log:h}){if(!i)return ft.log.warn("We received no playlist to switch to. Please check your stream."),!1;const m=`allowing switch ${r&&r.id||"null"} -> ${i.id}`;if(!r)return h(`${m} as current playlist is not set`),!0;if(i.id===r.id)return!1;const v=!!r0(e,t).length;if(!r.endList)return!v&&typeof r.partTargetDuration=="number"?(h(`not ${m} as current playlist is live llhls, but currentTime isn't in buffered.`),!1):(h(`${m} as current playlist is live`),!0);const b=pC(e,t),x=c?Qa.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Qa.MAX_BUFFER_LOW_WATER_LINE;if(a<x)return h(`${m} as duration < max low water line (${a} < ${x})`),!0;const C=i.attributes.BANDWIDTH,B=r.attributes.BANDWIDTH;if(C<B&&(!c||b<s)){let P=`${m} as next bandwidth < current bandwidth (${C} < ${B})`;return c&&(P+=` and forwardBuffer < bufferHighWaterLine (${b} < ${s})`),h(P),!0}if((!c||C>B)&&b>=n){let P=`${m} as forwardBuffer >= bufferLowWaterLine (${b} >= ${n})`;return c&&(P+=` and next bandwidth > current bandwidth (${C} > ${B})`),h(P),!0}return h(`not ${m} as no switching criteria met`),!1};class JH extends ft.EventTarget{constructor(e){super(),this.fastQualityChange_=XH(this.fastQualityChange_.bind(this),100);const{src:t,withCredentials:i,tech:n,bandwidth:s,externVhs:a,useCueTags:c,playlistExclusionDuration:h,enableLowInitialPlaylist:m,sourceType:v,cacheEncryptionKeys:b,bufferBasedABR:x,leastPixelDiffSelector:C,captionServices:B,experimentalUseMMS:P}=e;if(!t)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:N}=e;(N===null||typeof N>"u")&&(N=1/0),_p=a,this.bufferBasedABR=!!x,this.leastPixelDiffSelector=!!C,this.withCredentials=i,this.tech_=n,this.vhs_=n.vhs,this.player_=e.player_,this.sourceType_=v,this.useCueTags_=c,this.playlistExclusionDuration=h,this.maxPlaylistRetries=N,this.enableLowInitialPlaylist=m,this.usingManagedMediaSource_=!1,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:i,maxPlaylistRetries:N,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=WH(),P&&Z.ManagedMediaSource?(this.tech_.el_.disableRemotePlayback=!0,this.mediaSource=new Z.ManagedMediaSource,this.usingManagedMediaSource_=!0,ft.log("Using ManagedMediaSource")):Z.MediaSource&&(this.mediaSource=new Z.MediaSource),this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.load=this.load.bind(this),this.pause=this.pause.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.mediaSource.addEventListener("startstreaming",this.load),this.mediaSource.addEventListener("endstreaming",this.pause),this.seekable_=Ja(),this.hasPlayed_=!1,this.syncController_=new RH(e),this.segmentMetadataTrack_=n.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.segmentMetadataTrack_.mode="hidden",this.decrypter_=new FH,this.sourceUpdater_=new d4(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new kH,this.keyStatusMap_=new Map;const ae={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,captionServices:B,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:s,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:b,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings,addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)};this.mainPlaylistLoader_=this.sourceType_==="dash"?new CE(t,this.vhs_,Hr(this.requestOptions_,{addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)})):new s0(t,this.vhs_,Hr(this.requestOptions_,{addDateRangesToTextTrack:this.addDateRangesToTextTrack_.bind(this)})),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new IE(Hr(ae,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new IE(Hr(ae,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new MH(Hr(ae,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise((ge,ue)=>{function be(){n.off("vttjserror",fe),ge()}function fe(){n.off("vttjsloaded",be),ue()}n.one("vttjsloaded",be),n.one("vttjserror",fe),n.addWebVttScript_()})}),e);const X=()=>this.mainSegmentLoader_.bandwidth;this.contentSteeringController_=new qH(this.vhs_.xhr,X),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),QH.forEach(ge=>{this[ge+"_"]=KH.bind(this,ge)}),this.logger_=Tc("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const de=this.tech_.preload()==="none"?"play":"loadstart";this.tech_.one(de,()=>{const ge=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-ge,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const e=this.mainAppendsToLoadedData_(),t=this.audioAppendsToLoadedData_();return e===-1||t===-1?-1:e+t}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(e="abr"){const t=this.selectPlaylist();t&&this.shouldSwitchToMedia_(t)&&this.switchMedia_(t,e)}switchMedia_(e,t,i){const n=this.media(),s=n&&(n.id||n.uri),a=e&&(e.id||e.uri);if(s&&s!==a){this.logger_(`switch media ${s} -> ${a} from ${t}`);const c={renditionInfo:{id:a,bandwidth:e.attributes.BANDWIDTH,resolution:e.attributes.RESOLUTION,codecs:e.attributes.CODECS},cause:t};this.trigger({type:"renditionselected",metadata:c}),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${t}`})}this.mainPlaylistLoader_.media(e,i)}switchMediaForDASHContentSteering_(){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{const t=this.mediaTypes_[e],i=t?t.activeGroup():null,n=this.contentSteeringController_.getPathway();if(i&&n){const a=(i.length?i[0].playlists:i.playlists).filter(c=>c.attributes.serviceLocation===n);a.length&&this.mediaTypes_[e].activePlaylistLoader.media(a[0])}})}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=Z.setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(Z.clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const e=this.main(),t=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return t;const i=e.mediaGroups.AUDIO,n=Object.keys(i);let s;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)s=this.mediaTypes_.AUDIO.activeTrack();else{const c=i.main||n.length&&i[n[0]];for(const h in c)if(c[h].default){s={label:h};break}}if(!s)return t;const a=[];for(const c in i)if(i[c][s.label]){const h=i[c][s.label];if(h.playlists&&h.playlists.length)a.push.apply(a,h.playlists);else if(h.uri)a.push(h);else if(e.playlists.length)for(let m=0;m<e.playlists.length;m++){const v=e.playlists[m];v.attributes&&v.attributes.AUDIO&&v.attributes.AUDIO===c&&a.push(v)}}return a.length?a:t}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{const t=this.mainPlaylistLoader_.media(),i=t.targetDuration*1.5*1e3;xE(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,t.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(t,this.requestOptions_),this.mainSegmentLoader_.load()),$H({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),t),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let t=this.mainPlaylistLoader_.media();if(!t){this.attachContentSteeringListeners_(),this.initContentSteeringController_(),this.excludeUnsupportedVariants_();let i;if(this.enableLowInitialPlaylist&&(i=this.selectInitialPlaylist()),i||(i=this.selectPlaylist()),!i||!this.shouldSwitchToMedia_(i)||(this.initialMedia_=i,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;t=this.initialMedia_}this.handleUpdatedMediaPlaylist(t)}),this.mainPlaylistLoader_.on("error",()=>{const t=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:t.playlist,error:t})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{const t=this.mainPlaylistLoader_.media(),i=t.targetDuration*1.5*1e3;xE(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,this.sourceType_==="dash"&&this.mainPlaylistLoader_.isPaused&&this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(t,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_?this.runFastQualitySwitch_():this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{const t=this.mainPlaylistLoader_.media();if(t.lastExcludeReason_==="playlist-unchanged")return;this.stuckAtPlaylistEnd_(t)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})}),["manifestrequeststart","manifestrequestcomplete","manifestparsestart","manifestparsecomplete","playlistrequeststart","playlistrequestcomplete","playlistparsestart","playlistparsecomplete","renditiondisabled","renditionenabled"].forEach(t=>{this.mainPlaylistLoader_.on(t,i=>{this.player_.trigger(zr({},i))})})}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_&&this.runFastQualitySwitch_(),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,t){const i=e.mediaGroups||{};let n=!0;const s=Object.keys(i.AUDIO);for(const a in i.AUDIO)for(const c in i.AUDIO[a])i.AUDIO[a][c].uri||(n=!1);n&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(i.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),_p.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),s.length&&Object.keys(i.AUDIO[s[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(e){const t=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,i=this.tech_.currentTime(),n=this.bufferLowWaterLine(),s=this.bufferHighWaterLine(),a=this.tech_.buffered();return ZH({buffered:a,currentTime:i,currentPlaylist:t,nextPlaylist:e,bufferLowWaterLine:n,bufferHighWaterLine:s,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{const i=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:i.playlist,error:i})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.timelineChangeController_.on("audioTimelineBehind",()=>{const i=this.audioSegmentLoader_.pendingSegment_;if(!i||!i.segment||!i.segment.syncInfo)return;const n=i.segment.syncInfo.end+.01;this.tech_.setCurrentTime(n)}),this.timelineChangeController_.on("fixBadTimelineChange",()=>{this.logger_("Fix bad timeline change. Restarting al segment loaders..."),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}),this.mainSegmentLoader_.on("earlyabort",i=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:YH}))});const e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const i=this.getCodecsOrExclude_();i&&this.sourceUpdater_.addOrChangeSourceBuffers(i)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()}),["segmentselected","segmentloadstart","segmentloaded","segmentkeyloadstart","segmentkeyloadcomplete","segmentdecryptionstart","segmentdecryptioncomplete","segmenttransmuxingstart","segmenttransmuxingcomplete","segmenttransmuxingtrackinfoavailable","segmenttransmuxingtiminginfoavailable","segmentappendstart","appendsdone","bandwidthupdated","timelinechange","codecschange"].forEach(i=>{this.mainSegmentLoader_.on(i,n=>{this.player_.trigger(zr({},n))}),this.audioSegmentLoader_.on(i,n=>{this.player_.trigger(zr({},n))}),this.subtitleSegmentLoader_.on(i,n=>{this.player_.trigger(zr({},n))})})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}pause(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}fastQualityChange_(e=this.selectPlaylist()){if(e&&e===this.mainPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(e,"fast-quality"),this.waitingForFastQualityPlaylistReceived_=!0}runFastQualitySwitch_(){this.waitingForFastQualityPlaylistReceived_=!1,this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const e=this.tech_.seekable();if(this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList||e.start){const t=this.seekable();if(!t.length)return!1;const i=t.end(0);let n=i;if(e.start){const s=e.start.timeOffset;s<0?n=Math.max(i+s,t.start(0)):n=Math.min(i,s)}this.trigger("firstplay"),this.tech_.setCurrentTime(n)}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const e=this.tech_.play();typeof e<"u"&&typeof e.then=="function"&&e.then(null,t=>{})}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;const t=this.duration();e[e.length-1].endTime=isNaN(t)||Math.abs(t)===1/0?Number.MAX_VALUE:t}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const t=this.mainSegmentLoader_.getCurrentMediaInfo_();!t||t.hasVideo?e=e&&this.audioSegmentLoader_.ended_:e=this.audioSegmentLoader_.ended_}e&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;const i=this.syncController_.getExpiredTime(e,this.duration());if(i===null)return!1;const n=_p.Playlist.playlistEnd(e,i),s=this.tech_.currentTime(),a=this.tech_.buffered();if(!a.length)return n-s<=dh;const c=a.end(a.length-1);return c-s<=dh&&n-c<=dh}excludePlaylist({playlistToExclude:e=this.mainPlaylistLoader_.media(),error:t={},playlistExclusionDuration:i}){if(e=e||this.mainPlaylistLoader_.media(),i=i||t.playlistExclusionDuration||this.playlistExclusionDuration,!e){this.error=t,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}e.playlistErrors_++;const n=this.mainPlaylistLoader_.main.playlists,s=n.filter(hS),a=s.length===1&&s[0]===e;if(n.length===1&&i!==1/0)return ft.log.warn(`Problem encountered with playlist ${e.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(a);if(a){if(this.main().contentSteering){const B=this.pathwayAttribute_(e),P=this.contentSteeringController_.steeringManifest.ttl*1e3;this.contentSteeringController_.excludePathway(B),this.excludeThenChangePathway_(),setTimeout(()=>{this.contentSteeringController_.addAvailablePathway(B)},P);return}let C=!1;n.forEach(B=>{if(B===e)return;const P=B.excludeUntil;typeof P<"u"&&P!==1/0&&(C=!0,delete B.excludeUntil)}),C&&(ft.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let c;e.playlistErrors_>this.maxPlaylistRetries?c=1/0:c=Date.now()+i*1e3,e.excludeUntil=c,t.reason&&(e.lastExcludeReason_=t.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const h=this.selectPlaylist();if(!h){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}const m=t.internal?this.logger_:ft.log.warn,v=t.message?" "+t.message:"";m(`${t.internal?"Internal problem":"Problem"} encountered with playlist ${e.id}.${v} Switching to playlist ${h.id}.`),h.attributes.AUDIO!==e.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),h.attributes.SUBTITLES!==e.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const b=h.targetDuration/2*1e3||5*1e3,x=typeof h.lastRequest=="number"&&Date.now()-h.lastRequest<=b;return this.switchMedia_(h,"exclude",a||x)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(e,t){const i=[],n=e==="all";(n||e==="main")&&i.push(this.mainPlaylistLoader_);const s=[];(n||e==="audio")&&s.push("AUDIO"),(n||e==="subtitle")&&(s.push("CLOSED-CAPTIONS"),s.push("SUBTITLES")),s.forEach(a=>{const c=this.mediaTypes_[a]&&this.mediaTypes_[a].activePlaylistLoader;c&&i.push(c)}),["main","audio","subtitle"].forEach(a=>{const c=this[`${a}SegmentLoader_`];c&&(e===a||e==="all")&&i.push(c)}),i.forEach(a=>t.forEach(c=>{typeof a[c]=="function"&&a[c]()}))}setCurrentTime(e){const t=r0(this.tech_.buffered(),e);if(!(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media())||!this.mainPlaylistLoader_.media().segments)return 0;if(t&&t.length)return e;this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}duration(){if(!this.mainPlaylistLoader_)return 0;const e=this.mainPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:_p.Playlist.duration(e):1/0:0}seekable(){return this.seekable_}getSeekableRange_(e,t){const i=e.media();if(!i)return null;const n=this.syncController_.getMediaSequenceSync(t);if(n&&n.isReliable){const c=n.start,h=n.end;if(!isFinite(c)||!isFinite(h))return null;const m=_p.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,i),v=Math.max(c,h-m);return Ja([[c,v]])}const s=this.syncController_.getExpiredTime(i,this.duration());if(s===null)return null;const a=_p.Playlist.seekable(i,s,_p.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,i));return a.length?a:null}computeFinalSeekable_(e,t){if(!t)return e;const i=e.start(0),n=e.end(0),s=t.start(0),a=t.end(0);return s>n||i>a?e:Ja([[Math.max(i,s),Math.min(n,a)]])}onSyncInfoUpdate_(){if(!this.mainPlaylistLoader_)return;const e=this.getSeekableRange_(this.mainPlaylistLoader_,"main");if(!e)return;let t;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(t=this.getSeekableRange_(this.mediaTypes_.AUDIO.activePlaylistLoader,"audio"),!t))return;const i=this.seekable_;if(this.seekable_=this.computeFinalSeekable_(e,t),!this.seekable_||i&&i.length&&this.seekable_.length&&i.start(0)===this.seekable_.start(0)&&i.end(0)===this.seekable_.end(0))return;this.logger_(`seekable updated [${AO(this.seekable_)}]`);const n={seekableRanges:this.seekable_};this.trigger({type:"seekablerangeschanged",metadata:n}),this.tech_.trigger("seekablechanged")}updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,e),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(e){const n=this.seekable();if(!n.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<n.end(n.length-1))&&this.sourceUpdater_.setDuration(n.end(n.length-1));return}const t=this.tech_.buffered();let i=_p.Playlist.duration(this.mainPlaylistLoader_.media());t.length>0&&(i=Math.max(i,t.end(t.length-1))),this.mediaSource.duration!==i&&this.sourceUpdater_.setDuration(i)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.keyStatusMap_.clear(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(e=>{const t=this.mediaTypes_[e].groups;for(const i in t)t[i].forEach(n=>{n.playlistLoader&&n.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,t=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),i=e?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!t||!i)}getCodecsOrExclude_(){const e={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},t=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();e.video=e.main;const i=p_(this.main(),t),n={},s=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(e.main.hasVideo&&(n.video=i.video||e.main.videoCodec||HU),e.main.isMuxed&&(n.video+=`,${i.audio||e.main.audioCodec||QD}`),(e.main.hasAudio&&!e.main.isMuxed||e.audio.hasAudio||s)&&(n.audio=i.audio||e.main.audioCodec||e.audio.audioCodec||QD,e.audio.isFmp4=e.main.hasAudio&&!e.main.isMuxed?e.main.isFmp4:e.audio.isFmp4),!n.audio&&!n.video){this.excludePlaylist({playlistToExclude:t,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0});return}const a=(m,v)=>m?u_(v,this.usingManagedMediaSource_):XA(v),c={};let h;if(["video","audio"].forEach(function(m){if(n.hasOwnProperty(m)&&!a(e[m].isFmp4,n[m])){const v=e[m].isFmp4?"browser":"muxer";c[v]=c[v]||[],c[v].push(n[m]),m==="audio"&&(h=v)}}),s&&h&&t.attributes.AUDIO){const m=t.attributes.AUDIO;this.main().playlists.forEach(v=>{(v.attributes&&v.attributes.AUDIO)===m&&v!==t&&(v.excludeUntil=1/0)}),this.logger_(`excluding audio group ${m} as ${h} does not support codec(s): "${n.audio}"`)}if(Object.keys(c).length){const m=Object.keys(c).reduce((v,b)=>(v&&(v+=", "),v+=`${b} does not support codec(s): "${c[b].join(",")}"`,v),"")+".";this.excludePlaylist({playlistToExclude:t,error:{internal:!0,message:m},playlistExclusionDuration:1/0});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const m=[];if(["video","audio"].forEach(v=>{const b=(Kd(this.sourceUpdater_.codecs[v]||"")[0]||{}).type,x=(Kd(n[v]||"")[0]||{}).type;b&&x&&b.toLowerCase()!==x.toLowerCase()&&m.push(`"${this.sourceUpdater_.codecs[v]}" -> "${n[v]}"`)}),m.length){this.excludePlaylist({playlistToExclude:t,error:{message:`Codec switching not supported: ${m.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0});return}}return n}tryToCreateSourceBuffers_(){if(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||!this.areMediaTypesKnown_())return;const e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);const t=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(t)}excludeUnsupportedVariants_(){const e=this.main().playlists,t=[];Object.keys(e).forEach(i=>{const n=e[i];if(t.indexOf(n.id)!==-1)return;t.push(n.id);const s=p_(this.main,n),a=[];s.audio&&!XA(s.audio)&&!u_(s.audio,this.usingManagedMediaSource_)&&a.push(`audio codec ${s.audio}`),s.video&&!XA(s.video)&&!u_(s.video,this.usingManagedMediaSource_)&&a.push(`video codec ${s.video}`),s.text&&s.text==="stpp.ttml.im1t"&&a.push(`text codec ${s.text}`),a.length&&(n.excludeUntil=1/0,this.logger_(`excluding ${n.id} for unsupported: ${a.join(", ")}`))})}excludeIncompatibleVariants_(e){const t=[],i=this.main().playlists,n=D_(Kd(e)),s=GI(n),a=n.video&&Kd(n.video)[0]||null,c=n.audio&&Kd(n.audio)[0]||null;Object.keys(i).forEach(h=>{const m=i[h];if(t.indexOf(m.id)!==-1||m.excludeUntil===1/0)return;t.push(m.id);const v=[],b=p_(this.mainPlaylistLoader_.main,m),x=GI(b);if(!(!b.audio&&!b.video)){if(x!==s&&v.push(`codec count "${x}" !== "${s}"`),!this.sourceUpdater_.canChangeType()){const C=b.video&&Kd(b.video)[0]||null,B=b.audio&&Kd(b.audio)[0]||null;C&&a&&C.type.toLowerCase()!==a.type.toLowerCase()&&v.push(`video codec "${C.type}" !== "${a.type}"`),B&&c&&B.type.toLowerCase()!==c.type.toLowerCase()&&v.push(`audio codec "${B.type}" !== "${c.type}"`)}v.length&&(m.excludeUntil=1/0,this.logger_(`excluding ${m.id}: ${v.join(" && ")}`))}})}updateAdCues_(e){let t=0;const i=this.seekable();i.length&&(t=i.start(0)),IH(e,this.cueTagsTrack_,t)}goalBufferLength(){const e=this.tech_.currentTime(),t=Qa.GOAL_BUFFER_LENGTH,i=Qa.GOAL_BUFFER_LENGTH_RATE,n=Math.max(t,Qa.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*i,n)}bufferLowWaterLine(){const e=this.tech_.currentTime(),t=Qa.BUFFER_LOW_WATER_LINE,i=Qa.BUFFER_LOW_WATER_LINE_RATE,n=Math.max(t,Qa.MAX_BUFFER_LOW_WATER_LINE),s=Math.max(t,Qa.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*i,this.bufferBasedABR?s:n)}bufferHighWaterLine(){return Qa.BUFFER_HIGH_WATER_LINE}addDateRangesToTextTrack_(e){ZI(this.inbandTextTracks_,"com.apple.streaming",this.tech_),uH({inbandTextTracks:this.inbandTextTracks_,dateRanges:e})}addMetadataToTextTrack(e,t,i){const n=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();ZI(this.inbandTextTracks_,e,this.tech_),aH({inbandTextTracks:this.inbandTextTracks_,metadataArray:t,timestampOffset:n,videoDuration:i})}pathwayAttribute_(e){return e.attributes["PATHWAY-ID"]||e.attributes.serviceLocation}initContentSteeringController_(){const e=this.main();if(e.contentSteering){for(const t of e.playlists)this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(t));if(this.contentSteeringController_.assignTagProperties(e.uri,e.contentSteering),this.contentSteeringController_.queryBeforeStart){this.contentSteeringController_.requestSteeringManifest(!0);return}this.tech_.one("canplay",()=>{this.contentSteeringController_.requestSteeringManifest()})}}resetContentSteeringController_(){this.contentSteeringController_.clearAvailablePathways(),this.contentSteeringController_.dispose(),this.initContentSteeringController_()}attachContentSteeringListeners_(){this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this)),["contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"].forEach(t=>{this.contentSteeringController_.on(t,i=>{this.trigger(zr({},i))})}),this.sourceType_==="dash"&&this.mainPlaylistLoader_.on("loadedplaylist",()=>{const t=this.main();(this.contentSteeringController_.didDASHTagChange(t.uri,t.contentSteering)||(()=>{const s=this.contentSteeringController_.getAvailablePathways(),a=[];for(const c of t.playlists){const h=c.attributes.serviceLocation;if(h&&(a.push(h),!s.has(h)))return!0}return!!(!a.length&&s.size)})())&&this.resetContentSteeringController_()})}excludeThenChangePathway_(){const e=this.contentSteeringController_.getPathway();if(!e)return;this.handlePathwayClones_();const i=this.main().playlists,n=new Set;let s=!1;Object.keys(i).forEach(a=>{const c=i[a],h=this.pathwayAttribute_(c),m=h&&e!==h;c.excludeUntil===1/0&&c.lastExcludeReason_==="content-steering"&&!m&&(delete c.excludeUntil,delete c.lastExcludeReason_,s=!0);const b=!c.excludeUntil&&c.excludeUntil!==1/0;!n.has(c.id)&&m&&b&&(n.add(c.id),c.excludeUntil=1/0,c.lastExcludeReason_="content-steering",this.logger_(`excluding ${c.id} for ${c.lastExcludeReason_}`))}),this.contentSteeringController_.manifestType_==="DASH"&&Object.keys(this.mediaTypes_).forEach(a=>{const c=this.mediaTypes_[a];if(c.activePlaylistLoader){const h=c.activePlaylistLoader.media_;h&&h.attributes.serviceLocation!==e&&(s=!0)}}),s&&this.changeSegmentPathway_()}handlePathwayClones_(){const t=this.main().playlists,i=this.contentSteeringController_.currentPathwayClones,n=this.contentSteeringController_.nextPathwayClones;if(i&&i.size||n&&n.size){for(const[a,c]of i.entries())n.get(a)||(this.mainPlaylistLoader_.updateOrDeleteClone(c),this.contentSteeringController_.excludePathway(a));for(const[a,c]of n.entries()){const h=i.get(a);if(!h){t.filter(v=>v.attributes["PATHWAY-ID"]===c["BASE-ID"]).forEach(v=>{this.mainPlaylistLoader_.addClonePathway(c,v)}),this.contentSteeringController_.addAvailablePathway(a);continue}this.equalPathwayClones_(h,c)||(this.mainPlaylistLoader_.updateOrDeleteClone(c,!0),this.contentSteeringController_.addAvailablePathway(a))}this.contentSteeringController_.currentPathwayClones=new Map(JSON.parse(JSON.stringify([...n])))}}equalPathwayClones_(e,t){if(e["BASE-ID"]!==t["BASE-ID"]||e.ID!==t.ID||e["URI-REPLACEMENT"].HOST!==t["URI-REPLACEMENT"].HOST)return!1;const i=e["URI-REPLACEMENT"].PARAMS,n=t["URI-REPLACEMENT"].PARAMS;for(const s in i)if(i[s]!==n[s])return!1;for(const s in n)if(i[s]!==n[s])return!1;return!0}changeSegmentPathway_(){const e=this.selectPlaylist();this.pauseLoading(),this.contentSteeringController_.manifestType_==="DASH"&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(e,"content-steering")}excludeNonUsablePlaylistsByKeyId_(){if(!this.mainPlaylistLoader_||!this.mainPlaylistLoader_.main)return;let e=0;const t="non-usable";this.mainPlaylistLoader_.main.playlists.forEach(i=>{const n=this.mainPlaylistLoader_.getKeyIdSet(i);!n||!n.size||n.forEach(s=>{const a="usable",c=this.keyStatusMap_.has(s)&&this.keyStatusMap_.get(s)===a,h=i.lastExcludeReason_===t&&i.excludeUntil===1/0;c?c&&h&&(delete i.excludeUntil,delete i.lastExcludeReason_,this.logger_(`enabling playlist ${i.id} because key ID ${s} is ${a}`)):(i.excludeUntil!==1/0&&i.lastExcludeReason_!==t&&(i.excludeUntil=1/0,i.lastExcludeReason_=t,this.logger_(`excluding playlist ${i.id} because the key ID ${s} doesn't exist in the keyStatusMap or is not ${a}`)),e++)})}),e>=this.mainPlaylistLoader_.main.playlists.length&&this.mainPlaylistLoader_.main.playlists.forEach(i=>{const n=i&&i.attributes&&i.attributes.RESOLUTION&&i.attributes.RESOLUTION.height<720,s=i.excludeUntil===1/0&&i.lastExcludeReason_===t;n&&s&&(delete i.excludeUntil,ft.log.warn(`enabling non-HD playlist ${i.id} because all playlists were excluded due to ${t} key IDs`))})}addKeyStatus_(e,t){const s=(typeof e=="string"?e:EH(e)).slice(0,32).toLowerCase();this.logger_(`KeyStatus '${t}' with key ID ${s} added to the keyStatusMap`),this.keyStatusMap_.set(s,t)}updatePlaylistByKeyStatus(e,t){this.addKeyStatus_(e,t),this.waitingForFastQualityPlaylistReceived_||this.excludeNonUsableThenChangePlaylist_(),this.mainPlaylistLoader_.off("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this)),this.mainPlaylistLoader_.on("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this))}excludeNonUsableThenChangePlaylist_(){this.excludeNonUsablePlaylistsByKeyId_(),this.fastQualityChange_()}}const ej=(r,e,t)=>i=>{const n=r.main.playlists[e],s=gC(n),a=hS(n);if(typeof i>"u")return a;i?delete n.disabled:n.disabled=!0;const c={renditionInfo:{id:e,bandwidth:n.attributes.BANDWIDTH,resolution:n.attributes.RESOLUTION,codecs:n.attributes.CODECS},cause:"fast-quality"};return i!==a&&!s&&(i?(t(n),r.trigger({type:"renditionenabled",metadata:c})):r.trigger({type:"renditiondisabled",metadata:c})),i};let tj=class{constructor(e,t,i){const{playlistController_:n}=e,s=n.fastQualityChange_.bind(n);if(t.attributes){const a=t.attributes.RESOLUTION;this.width=a&&a.width,this.height=a&&a.height,this.bandwidth=t.attributes.BANDWIDTH,this.frameRate=t.attributes["FRAME-RATE"]}this.codecs=p_(n.main(),t),this.playlist=t,this.id=i,this.enabled=ej(e.playlists,t.id,s)}};const ij=function(r){r.representations=()=>{const e=r.playlistController_.main(),t=Y_(e)?r.playlistController_.getAudioTrackPlaylists_():e.playlists;return t?t.filter(i=>!gC(i)).map((i,n)=>new tj(r,i,i.id)):[]}},u3=["seeking","seeked","pause","playing","error"];let nj=class extends ft.EventTarget{constructor(e){super(),this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.playedRanges_=[],this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=Tc("PlaybackWatcher"),this.logger_("initialize");const t=()=>this.monitorCurrentTime_(),i=()=>this.monitorCurrentTime_(),n=()=>this.techWaiting_(),s=()=>this.resetTimeUpdate_(),a=this.playlistController_,c=["main","subtitle","audio"],h={};c.forEach(v=>{h[v]={reset:()=>this.resetSegmentDownloads_(v),updateend:()=>this.checkSegmentDownloads_(v)},a[`${v}SegmentLoader_`].on("appendsdone",h[v].updateend),a[`${v}SegmentLoader_`].on("playlistupdate",h[v].reset),this.tech_.on(["seeked","seeking"],h[v].reset)});const m=v=>{["main","audio"].forEach(b=>{a[`${b}SegmentLoader_`][v]("appended",this.seekingAppendCheck_)})};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),m("off"))},this.clearSeekingAppendCheck_=()=>m("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),m("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",n),this.tech_.on(u3,s),this.tech_.on("canplay",i),this.tech_.one("play",t),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",n),this.tech_.off(u3,s),this.tech_.off("canplay",i),this.tech_.off("play",t),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),c.forEach(v=>{a[`${v}SegmentLoader_`].off("appendsdone",h[v].updateend),a[`${v}SegmentLoader_`].off("playlistupdate",h[v].reset),this.tech_.off(["seeked","seeking"],h[v].reset)}),this.checkCurrentTimeTimeout_&&Z.clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&Z.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=Z.setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){const t=this.playlistController_[`${e}SegmentLoader_`];this[`${e}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[`${e}StalledDownloads_`]=0,this[`${e}Buffered_`]=t.buffered_()}checkSegmentDownloads_(e){const t=this.playlistController_,i=t[`${e}SegmentLoader_`],n=i.buffered_(),s=HV(this[`${e}Buffered_`],n);if(this[`${e}Buffered_`]=n,s){const a={bufferedRanges:n};t.trigger({type:"bufferedrangeschanged",metadata:a}),this.resetSegmentDownloads_(e);return}this[`${e}StalledDownloads_`]++,this.logger_(`found #${this[`${e}StalledDownloads_`]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:i.playlist_&&i.playlist_.id,buffered:Bm(n)}),!(this[`${e}StalledDownloads_`]<10)&&(this.logger_(`${e} loader stalled download exclusion`),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),e!=="subtitle"&&t.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:1/0}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+dh>=t.end(t.length-1)))return this.techWaiting_();if(this.consecutiveUpdates>=5&&e===this.lastRecordedTime)this.consecutiveUpdates++,this.waiting_();else if(e===this.lastRecordedTime)this.consecutiveUpdates++;else{this.playedRanges_.push(Ja([this.lastRecordedTime,e]));const i={playedRanges:this.playedRanges_};this.playlistController_.trigger({type:"playedrangeschanged",metadata:i}),this.consecutiveUpdates=0,this.lastRecordedTime=e}}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const t=this.seekable(),i=this.tech_.currentTime(),n=this.afterSeekableWindow_(t,i,this.media(),this.allowSeeksWithinUnsafeLiveWindow);let s;if(n&&(s=t.end(t.length-1)),this.beforeSeekableWindow_(t,i)){const B=t.start(0);s=B+(B===t.end(0)?0:dh)}if(typeof s<"u")return this.logger_(`Trying to seek outside of seekable at time ${i} with seekable range ${AO(t)}. Seeking to ${s}.`),this.tech_.setCurrentTime(s),!0;const a=this.playlistController_.sourceUpdater_,c=this.tech_.buffered(),h=a.audioBuffer?a.audioBuffered():null,m=a.videoBuffer?a.videoBuffered():null,v=this.media(),b=v.partTargetDuration?v.partTargetDuration:(v.targetDuration-ch)*2,x=[h,m];for(let B=0;B<x.length;B++){if(!x[B])continue;if(pC(x[B],i)<b)return!1}const C=K1(c,i);return C.length===0?!1:(s=C.start(0)+dh,this.logger_(`Buffered region starts (${C.start(0)})  just beyond seek point (${i}). Seeking to ${s}.`),this.tech_.setCurrentTime(s),!0)}waiting_(){if(this.techWaiting_())return;const e=this.tech_.currentTime(),t=this.tech_.buffered(),i=r0(t,e);if(i.length&&e+3<=i.end(0)){this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${i.start(0)} -> ${i.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});return}}techWaiting_(){const e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,t)){const c=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${t}. Seeking to live point (seekable end) ${c}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(c),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const i=this.tech_.vhs.playlistController_.sourceUpdater_,n=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:i.audioBuffered(),videoBuffered:i.videoBuffered(),currentTime:t}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const a=K1(n,t);return a.length>0?(this.logger_(`Stopped at ${t} and seeking to ${a.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(t),!0):!1}afterSeekableWindow_(e,t,i,n=!1){if(!e.length)return!1;let s=e.end(e.length-1)+dh;const a=!i.endList,c=typeof i.partTargetDuration=="number";return a&&(c||n)&&(s=e.end(e.length-1)+i.targetDuration*3),t>s}beforeSeekableWindow_(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:e,audioBuffered:t,currentTime:i}){if(!e)return;let n;if(e.length&&t.length){const s=r0(e,i-3),a=r0(e,i),c=r0(t,i);c.length&&!a.length&&s.length&&(n={start:s.end(0),end:c.end(0)})}else K1(e,i).length||(n=this.gapFromVideoUnderflow_(e,i));return n?(this.logger_(`Encountered a gap in video from ${n.start} to ${n.end}. Seeking to current time ${i}`),!0):!1}skipTheGap_(e){const t=this.tech_.buffered(),i=this.tech_.currentTime(),n=K1(t,i);if(this.resetTimeUpdate_(),n.length===0||i!==e)return;this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",e,"nextRange start:",n.start(0)),this.tech_.setCurrentTime(n.start(0)+ch);const s={gapInfo:{from:i,to:n.start(0)}};this.playlistController_.trigger({type:"gapjumped",metadata:s}),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"})}gapFromVideoUnderflow_(e,t){const i=UV(e);for(let n=0;n<i.length;n++){const s=i.start(n),a=i.end(n);if(t-s<4&&t-s>2)return{start:s,end:a}}return null}};const rj={errorInterval:30,getSource(r){const t=this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource();return r(t)}},m4=function(r,e){let t=0,i=0;const n=Hr(rj,e);r.ready(()=>{r.trigger({type:"usage",name:"vhs-error-reload-initialized"})});const s=function(){i&&r.currentTime(i)},a=function(v){v!=null&&(i=r.duration()!==1/0&&r.currentTime()||0,r.one("loadedmetadata",s),r.src(v),r.trigger({type:"usage",name:"vhs-error-reload"}),r.play())},c=function(){if(Date.now()-t<n.errorInterval*1e3){r.trigger({type:"usage",name:"vhs-error-reload-canceled"});return}if(!n.getSource||typeof n.getSource!="function"){ft.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return t=Date.now(),n.getSource.call(r,a)},h=function(){r.off("loadedmetadata",s),r.off("error",c),r.off("dispose",h)},m=function(v){h(),m4(r,v)};r.on("error",c),r.on("dispose",h),r.reloadSourceOnError=m},sj=function(r){m4(this,r)};var g4="3.17.0",aj="7.1.0",oj="1.3.1",lj="7.2.0",uj="4.0.2";const zs={PlaylistLoader:s0,Playlist:Jl,utils:pz,STANDARD_PLAYLIST_SELECTOR:KI,INITIAL_PLAYLIST_SELECTOR:tH,lastBandwidthSelector:KI,movingAverageBandwidthSelector:Jz,comparePlaylistBandwidth:_C,comparePlaylistResolution:Zz,xhr:jO()};Object.keys(Qa).forEach(r=>{Object.defineProperty(zs,r,{get(){return ft.log.warn(`using Vhs.${r} is UNSAFE be sure you know what you are doing`),Qa[r]},set(e){if(ft.log.warn(`using Vhs.${r} is UNSAFE be sure you know what you are doing`),typeof e!="number"||e<0){ft.log.warn(`value of Vhs.${r} must be greater than or equal to 0`);return}Qa[r]=e}})});const v4="videojs-vhs",y4=function(r,e){const t=e.media();let i=-1;for(let n=0;n<r.length;n++)if(r[n].id===t.id){i=n;break}r.selectedIndex_=i,r.trigger({selectedIndex:i,type:"change"})},cj=function(r,e){e.representations().forEach(t=>{r.addQualityLevel(t)}),y4(r,e.playlists)};zs.canPlaySource=function(){return ft.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const dj=(r,e,t)=>{if(!r)return r;let i={};e&&e.attributes&&e.attributes.CODECS&&(i=D_(Kd(e.attributes.CODECS))),t&&t.attributes&&t.attributes.CODECS&&(i.audio=t.attributes.CODECS);const n=R0(i.video),s=R0(i.audio),a={};for(const c in r)a[c]={},s&&(a[c].audioContentType=s),n&&(a[c].videoContentType=n),e.contentProtection&&e.contentProtection[c]&&e.contentProtection[c].pssh&&(a[c].pssh=e.contentProtection[c].pssh),typeof r[c]=="string"&&(a[c].url=r[c]);return Hr(r,a)},hj=(r,e)=>r.reduce((t,i)=>{if(!i.contentProtection)return t;const n=e.reduce((s,a)=>{const c=i.contentProtection[a];return c&&c.pssh&&(s[a]={pssh:c.pssh}),s},{});return Object.keys(n).length&&t.push(n),t},[]),fj=({player:r,sourceKeySystems:e,audioMedia:t,mainPlaylists:i})=>{if(!r.eme.initializeMediaKeys)return Promise.resolve();const n=t?i.concat([t]):i,s=hj(n,Object.keys(e)),a=[],c=[];return s.forEach(h=>{c.push(new Promise((m,v)=>{r.tech_.one("keysessioncreated",m)})),a.push(new Promise((m,v)=>{r.eme.initializeMediaKeys({keySystems:h},b=>{if(b){v(b);return}m()})}))}),Promise.race([Promise.all(a),Promise.race(c)])},pj=({player:r,sourceKeySystems:e,media:t,audioMedia:i})=>{const n=dj(e,t,i);return n?(r.currentSource().keySystems=n,n&&!r.eme?(ft.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},_4=()=>{if(!Z.localStorage)return null;const r=Z.localStorage.getItem(v4);if(!r)return null;try{return JSON.parse(r)}catch{return null}},mj=r=>{if(!Z.localStorage)return!1;let e=_4();e=e?Hr(e,r):r;try{Z.localStorage.setItem(v4,JSON.stringify(e))}catch{return!1}return e},gj=r=>r.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(r.substring(r.indexOf(",")+1)):r,b4=(r,e)=>{r._requestCallbackSet||(r._requestCallbackSet=new Set),r._requestCallbackSet.add(e)},T4=(r,e)=>{r._responseCallbackSet||(r._responseCallbackSet=new Set),r._responseCallbackSet.add(e)},x4=(r,e)=>{r._requestCallbackSet&&(r._requestCallbackSet.delete(e),r._requestCallbackSet.size||delete r._requestCallbackSet)},S4=(r,e)=>{r._responseCallbackSet&&(r._responseCallbackSet.delete(e),r._responseCallbackSet.size||delete r._responseCallbackSet)};zs.supportsNativeHls=function(){if(!ot||!ot.createElement)return!1;const r=ot.createElement("video");return ft.getTech("Html5").isSupported()?["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(t){return/maybe|probably/i.test(r.canPlayType(t))}):!1}();zs.supportsNativeDash=function(){return!ot||!ot.createElement||!ft.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(ot.createElement("video").canPlayType("application/dash+xml"))}();zs.supportsTypeNatively=r=>r==="hls"?zs.supportsNativeHls:r==="dash"?zs.supportsNativeDash:!1;zs.isSupported=function(){return ft.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};zs.xhr.onRequest=function(r){b4(zs.xhr,r)};zs.xhr.onResponse=function(r){T4(zs.xhr,r)};zs.xhr.offRequest=function(r){x4(zs.xhr,r)};zs.xhr.offResponse=function(r){S4(zs.xhr,r)};const vj=ft.getComponent("Component");let A4=class extends vj{constructor(e,t,i){if(super(t,i.vhs),typeof i.initialBandwidth=="number"&&(this.options_.bandwidth=i.initialBandwidth),this.logger_=Tc("VhsHandler"),t.options_&&t.options_.playerId){const n=ft.getPlayer(t.options_.playerId);this.player_=n}if(this.tech_=t,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&t.overrideNativeAudioTracks&&t.overrideNativeVideoTracks)t.overrideNativeAudioTracks(!0),t.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(ot,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],n=>{const s=ot.fullscreenElement||ot.webkitFullscreenElement||ot.mozFullScreenElement||ot.msFullscreenElement;s&&s.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(e={}){if(this.options_=Hr(this.options_,e),this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.usePlayerObjectFit=this.options_.usePlayerObjectFit||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=typeof this.options_.useNetworkInformationApi<"u"?this.options_.useNetworkInformationApi:!0,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){const i=_4();i&&i.bandwidth&&(this.options_.bandwidth=i.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),i&&i.throughput&&(this.options_.throughput=i.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=Qa.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Qa.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","usePlayerObjectFit","customPixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(i=>{typeof this.source_[i]<"u"&&(this.options_[i]=this.source_[i])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio,this.usePlayerObjectFit=this.options_.usePlayerObjectFit;const t=this.options_.customPixelRatio;typeof t=="number"&&t>=0&&(this.customPixelRatio=t)}setOptions(e={}){this.setOptions_(e)}src(e,t){if(!e)return;this.setOptions_(),this.options_.src=gj(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=zs,this.options_.sourceType=zR(t),this.options_.seekTo=s=>{this.tech_.setCurrentTime(s)},this.options_.player_=this.player_,this.playlistController_=new JH(this.options_);const i=Hr({liveRangeSafeTimeDelta:dh},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new nj(i),this.attachStreamingEventListeners_(),this.playlistController_.on("error",()=>{const s=ft.players[this.tech_.options_.playerId];let a=this.playlistController_.error;typeof a=="object"&&!a.code?a.code=3:typeof a=="string"&&(a={message:a,code:3}),s.error(a)});const n=this.options_.bufferBasedABR?zs.movingAverageBandwidthSelector(.55):zs.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):n.bind(this),this.playlistController_.selectInitialPlaylist=zs.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(s){this.playlistController_.selectPlaylist=s.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(s){this.playlistController_.mainSegmentLoader_.throughput.rate=s,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let s=this.playlistController_.mainSegmentLoader_.bandwidth;const a=Z.navigator.connection||Z.navigator.mozConnection||Z.navigator.webkitConnection,c=1e7;if(this.options_.useNetworkInformationApi&&a){const h=a.downlink*1e3*1e3;h>=c&&s>=c?s=Math.max(s,h):s=h}return s},set(s){this.playlistController_.mainSegmentLoader_.bandwidth=s,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const s=1/(this.bandwidth||1);let a;return this.throughput>0?a=1/this.throughput:a=0,Math.floor(1/(s+a))},set(){ft.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>Bm(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>Bm(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{this.options_.useBandwidthFromLocalStorage&&mj({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})}),this.playlistController_.on("selectedinitialmedia",()=>{ij(this)}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=Z.URL.createObjectURL(this.playlistController_.mediaSource),(ft.browser.IS_ANY_SAFARI||ft.browser.IS_IOS)&&this.options_.overrideNative&&this.options_.sourceType==="hls"&&typeof this.tech_.addSourceElement=="function"?(this.tech_.addSourceElement(this.mediaSourceUrl_),this.tech_.addSourceElement(this.source_.src)):this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),fj({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(t=>{this.logger_("error while creating EME key session",t),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,t=pj({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});if(this.player_.tech_.on("keystatuschange",i=>{this.playlistController_.updatePlaylistByKeyStatus(i.keyId,i.status)}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),!t){this.playlistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()}setupQualityLevels_(){const e=ft.players[this.tech_.options_.playerId];!e||!e.qualityLevels||this.qualityLevels_||(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{cj(this.qualityLevels_,this)}),this.playlists.on("mediachange",()=>{y4(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":g4,"mux.js":aj,"mpd-parser":oj,"m3u8-parser":lj,"aes-decrypter":uj}}version(){return this.constructor.version()}canChangeType(){return d4.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&Z.URL.revokeObjectURL&&(Z.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,t){return Tz({playlist:this.playlistController_.media(),time:e,callback:t})}seekToProgramTime(e,t,i=!0,n=2){return XO({programTime:e,playlist:this.playlistController_.media(),retryCount:n,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}setupXhrHooks_(){this.xhr.onRequest=e=>{b4(this.xhr,e)},this.xhr.onResponse=e=>{T4(this.xhr,e)},this.xhr.offRequest=e=>{x4(this.xhr,e)},this.xhr.offResponse=e=>{S4(this.xhr,e)},this.player_.trigger("xhr-hooks-ready")}attachStreamingEventListeners_(){const e=["seekablerangeschanged","bufferedrangeschanged","contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"],t=["gapjumped","playedrangeschanged"];e.forEach(i=>{this.playlistController_.on(i,n=>{this.player_.trigger(zr({},n))})}),t.forEach(i=>{this.playbackWatcher_.on(i,n=>{this.player_.trigger(zr({},n))})})}};const Sx={name:"videojs-http-streaming",VERSION:g4,canHandleSource(r,e={}){const t=Hr(ft.options,e);return!t.vhs.experimentalUseMMS&&!u_("avc1.4d400d,mp4a.40.2",!1)?!1:Sx.canPlayType(r.type,t)},handleSource(r,e,t={}){const i=Hr(ft.options,t);return e.vhs=new A4(r,e,i),e.vhs.xhr=jO(),e.vhs.setupXhrHooks_(),e.vhs.src(r.src,r.type),e.vhs},canPlayType(r,e){const t=zR(r);if(!t)return"";const i=Sx.getOverrideNative(e);return!zs.supportsTypeNatively(t)||i?"maybe":""},getOverrideNative(r={}){const{vhs:e={}}=r,t=!(ft.browser.IS_ANY_SAFARI||ft.browser.IS_IOS),{overrideNative:i=t}=e;return i}},yj=()=>u_("avc1.4d400d,mp4a.40.2",!0);yj()&&ft.getTech("Html5").registerSourceHandler(Sx,0);ft.VhsHandler=A4;ft.VhsSourceHandler=Sx;ft.Vhs=zs;ft.use||ft.registerComponent("Vhs",zs);ft.options.vhs=ft.options.vhs||{};(!ft.getPlugin||!ft.getPlugin("reloadSourceOnError"))&&ft.registerPlugin("reloadSourceOnError",sj);var ST={exports:{}},eT={exports:{}},c3;function _j(){return c3||(c3=1,function(r,e){function t(h){if(h&&typeof h=="object"){var m=h.which||h.keyCode||h.charCode;m&&(h=m)}if(typeof h=="number")return a[h];var v=String(h),b=i[v.toLowerCase()];if(b)return b;var b=n[v.toLowerCase()];if(b)return b;if(v.length===1)return v.charCodeAt(0)}t.isEventKey=function(m,v){if(m&&typeof m=="object"){var b=m.which||m.keyCode||m.charCode;if(b==null)return!1;if(typeof v=="string"){var x=i[v.toLowerCase()];if(x)return x===b;var x=n[v.toLowerCase()];if(x)return x===b}else if(typeof v=="number")return v===b;return!1}},e=r.exports=t;var i=e.code=e.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},n=e.aliases={windows:91,"":16,"":18,"":17,"":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */for(s=97;s<123;s++)i[String.fromCharCode(s)]=s-32;for(var s=48;s<58;s++)i[s-48]=s;for(s=1;s<13;s++)i["f"+s]=s+111;for(s=0;s<10;s++)i["numpad "+s]=s+96;var a=e.names=e.title={};for(s in i)a[i[s]]=s;for(var c in n)i[c]=n[c]}(eT,eT.exports)),eT.exports}var bj=_j();const wn=Yu(bj);function Tn(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function H0(r,e){return H0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},H0(r,e)}function mi(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,H0(r,e)}var mw,d3;function Tj(){if(d3)return mw;d3=1,mw=r;function r(e,t){var i,n=null;try{i=JSON.parse(e,t)}catch(s){n=s}return[n,i]}return mw}var xj=Tj();const Sj=Yu(xj);var tT={exports:{}},gw,h3;function Aj(){if(h3)return gw;h3=1;var r=J0(),e=function(n,s){return s===void 0&&(s=!1),function(a,c,h){if(a){n(a);return}if(c.statusCode>=400&&c.statusCode<=599){var m=h;if(s)if(r.TextDecoder){var v=t(c.headers&&c.headers["content-type"]);try{m=new TextDecoder(v).decode(h)}catch{}}else m=String.fromCharCode.apply(null,new Uint8Array(h));n({cause:m});return}n(null,h)}};function t(i){return i===void 0&&(i=""),i.toLowerCase().split(";").reduce(function(n,s){var a=s.split("="),c=a[0],h=a[1];return c.trim()==="charset"?h.trim():n},"utf-8")}return gw=e,gw}var f3;function wj(){if(f3)return tT.exports;f3=1;var r=J0(),e=OR(),t=FR();c.httpHandler=Aj();/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Bjrklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var i=function(x){var C={};return x&&x.trim().split(`
`).forEach(function(B){var P=B.indexOf(":"),N=B.slice(0,P).trim().toLowerCase(),ae=B.slice(P+1).trim();typeof C[N]>"u"?C[N]=ae:Array.isArray(C[N])?C[N].push(ae):C[N]=[C[N],ae]}),C};tT.exports=c,tT.exports.default=c,c.XMLHttpRequest=r.XMLHttpRequest||v,c.XDomainRequest="withCredentials"in new c.XMLHttpRequest?c.XMLHttpRequest:r.XDomainRequest,n(["get","put","post","patch","head","delete"],function(b){c[b==="delete"?"del":b]=function(x,C,B){return C=a(x,C,B),C.method=b.toUpperCase(),h(C)}});function n(b,x){for(var C=0;C<b.length;C++)x(b[C])}function s(b){for(var x in b)if(b.hasOwnProperty(x))return!1;return!0}function a(b,x,C){var B=b;return t(x)?(C=x,typeof b=="string"&&(B={uri:b})):B=e({},x,{uri:b}),B.callback=C,B}function c(b,x,C){return x=a(b,x,C),h(x)}function h(b){if(typeof b.callback>"u")throw new Error("callback argument missing");var x=!1,C=function(ut,_t,vt){x||(x=!0,b.callback(ut,_t,vt))};function B(){X.readyState===4&&setTimeout(ae,0)}function P(){var ke=void 0;if(X.response?ke=X.response:ke=X.responseText||m(X),re)try{ke=JSON.parse(ke)}catch{}return ke}function N(ke){return clearTimeout(Ne),ke instanceof Error||(ke=new Error(""+(ke||"Unknown XMLHttpRequest Error"))),ke.statusCode=0,C(ke,De)}function ae(){if(!ge){var ke;clearTimeout(Ne),b.useXDR&&X.status===void 0?ke=200:ke=X.status===1223?204:X.status;var ut=De,_t=null;return ke!==0?(ut={body:P(),statusCode:ke,method:be,headers:{},url:ue,rawRequest:X},X.getAllResponseHeaders&&(ut.headers=i(X.getAllResponseHeaders()))):_t=new Error("Internal XMLHttpRequest Error"),C(_t,ut,ut.body)}}var X=b.xhr||null;X||(b.cors||b.useXDR?X=new c.XDomainRequest:X=new c.XMLHttpRequest);var de,ge,ue=X.url=b.uri||b.url,be=X.method=b.method||"GET",fe=b.body||b.data,ve=X.headers=b.headers||{},ie=!!b.sync,re=!1,Ne,De={body:void 0,headers:{},statusCode:0,method:be,url:ue,rawRequest:X};if("json"in b&&b.json!==!1&&(re=!0,ve.accept||ve.Accept||(ve.Accept="application/json"),be!=="GET"&&be!=="HEAD"&&(ve["content-type"]||ve["Content-Type"]||(ve["Content-Type"]="application/json"),fe=JSON.stringify(b.json===!0?fe:b.json))),X.onreadystatechange=B,X.onload=ae,X.onerror=N,X.onprogress=function(){},X.onabort=function(){ge=!0},X.ontimeout=N,X.open(be,ue,!ie,b.username,b.password),ie||(X.withCredentials=!!b.withCredentials),!ie&&b.timeout>0&&(Ne=setTimeout(function(){if(!ge){ge=!0,X.abort("timeout");var ke=new Error("XMLHttpRequest timeout");ke.code="ETIMEDOUT",N(ke)}},b.timeout)),X.setRequestHeader)for(de in ve)ve.hasOwnProperty(de)&&X.setRequestHeader(de,ve[de]);else if(b.headers&&!s(b.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in b&&(X.responseType=b.responseType),"beforeSend"in b&&typeof b.beforeSend=="function"&&b.beforeSend(X),X.send(fe||null),X}function m(b){try{if(b.responseType==="document")return b.responseXML;var x=b.responseXML&&b.responseXML.documentElement.nodeName==="parsererror";if(b.responseType===""&&!x)return b.responseXML}catch{}return null}function v(){}return tT.exports}var Ej=wj();const w4=Yu(Ej);function E4(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(E4=function(){return!!r})()}function C4(r,e,t){if(E4())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var n=new(r.bind.apply(r,i));return t&&H0(n,t.prototype),n}function Cj(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&H0(r,e)}var vw={exports:{}},p3;function Mj(){return p3||(p3=1,function(r,e){(function(t){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,c={buildAbsoluteURL:function(h,m,v){if(v=v||{},h=h.trim(),m=m.trim(),!m){if(!v.alwaysNormalize)return h;var b=c.parseURL(h);if(!b)throw new Error("Error trying to parse base URL.");return b.path=c.normalizePath(b.path),c.buildURLFromParts(b)}var x=c.parseURL(m);if(!x)throw new Error("Error trying to parse relative URL.");if(x.scheme)return v.alwaysNormalize?(x.path=c.normalizePath(x.path),c.buildURLFromParts(x)):m;var C=c.parseURL(h);if(!C)throw new Error("Error trying to parse base URL.");if(!C.netLoc&&C.path&&C.path[0]!=="/"){var B=n.exec(C.path);C.netLoc=B[1],C.path=B[2]}C.netLoc&&!C.path&&(C.path="/");var P={scheme:C.scheme,netLoc:x.netLoc,path:null,params:x.params,query:x.query,fragment:x.fragment};if(!x.netLoc&&(P.netLoc=C.netLoc,x.path[0]!=="/"))if(!x.path)P.path=C.path,x.params||(P.params=C.params,x.query||(P.query=C.query));else{var N=C.path,ae=N.substring(0,N.lastIndexOf("/")+1)+x.path;P.path=c.normalizePath(ae)}return P.path===null&&(P.path=v.alwaysNormalize?c.normalizePath(x.path):x.path),c.buildURLFromParts(P)},parseURL:function(h){var m=i.exec(h);return m?{scheme:m[1]||"",netLoc:m[2]||"",path:m[3]||"",params:m[4]||"",query:m[5]||"",fragment:m[6]||""}:null},normalizePath:function(h){for(h=h.split("").reverse().join("").replace(s,"");h.length!==(h=h.replace(a,"")).length;);return h.split("").reverse().join("")},buildURLFromParts:function(h){return h.scheme+h.netLoc+h.path+h.params+h.query+h.fragment}};r.exports=c})()}(vw)),vw.exports}var Dj=Mj();const m3=Yu(Dj);var g3="http://example.com",fS=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=Z.location&&Z.location.href||"");var i=typeof Z.URL=="function",n=/^\/\//.test(e),s=!Z.location&&!/\/\//i.test(e);if(i?e=new Z.URL(e,Z.location||g3):/\/\//i.test(e)||(e=m3.buildAbsoluteURL(Z.location&&Z.location.href||"",e)),i){var a=new URL(t,e);return s?a.href.slice(g3.length):n?a.href.slice(a.protocol.length):a.href}return m3.buildAbsoluteURL(e,t)},bC=function(){function r(){this.listeners={}}var e=r.prototype;return e.on=function(i,n){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(n)},e.off=function(i,n){if(!this.listeners[i])return!1;var s=this.listeners[i].indexOf(n);return this.listeners[i]=this.listeners[i].slice(0),this.listeners[i].splice(s,1),s>-1},e.trigger=function(i){var n=this.listeners[i];if(n)if(arguments.length===2)for(var s=n.length,a=0;a<s;++a)n[a].call(this,arguments[1]);else for(var c=Array.prototype.slice.call(arguments,1),h=n.length,m=0;m<h;++m)n[m].apply(this,c)},e.dispose=function(){this.listeners={}},e.pipe=function(i){this.on("data",function(n){i.push(n)})},r}(),Ij=function(e){return Z.atob?Z.atob(e):Buffer.from(e,"base64").toString("binary")};function M4(r){for(var e=Ij(r),t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}/*! @name m3u8-parser @version 4.8.0 @license Apache-2.0 */var Pj=function(r){mi(e,r);function e(){var i;return i=r.call(this)||this,i.buffer="",i}var t=e.prototype;return t.push=function(n){var s;for(this.buffer+=n,s=this.buffer.indexOf(`
`);s>-1;s=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,s)),this.buffer=this.buffer.substring(s+1)},e}(bC),Lj="	",yw=function(e){var t=/([0-9.]*)?@?([0-9.]*)?/.exec(e||""),i={};return t[1]&&(i.length=parseInt(t[1],10)),t[2]&&(i.offset=parseInt(t[2],10)),i},Rj=function(){var e="[^=]*",t='"[^"]*"|[^,]*',i="(?:"+e+")=(?:"+t+")";return new RegExp("(?:^|,)("+i+")")},Hc=function(e){for(var t=e.split(Rj()),i={},n=t.length,s;n--;)t[n]!==""&&(s=/([^=]*)=(.*)/.exec(t[n]).slice(1),s[0]=s[0].replace(/^\s+|\s+$/g,""),s[1]=s[1].replace(/^\s+|\s+$/g,""),s[1]=s[1].replace(/^['"](.*)['"]$/g,"$1"),i[s[0]]=s[1]);return i},kj=function(r){mi(e,r);function e(){var i;return i=r.call(this)||this,i.customParsers=[],i.tagMappers=[],i}var t=e.prototype;return t.push=function(n){var s=this,a,c;if(n=n.trim(),n.length!==0){if(n[0]!=="#"){this.trigger("data",{type:"uri",uri:n});return}var h=this.tagMappers.reduce(function(m,v){var b=v(n);return b===n?m:m.concat([b])},[n]);h.forEach(function(m){for(var v=0;v<s.customParsers.length;v++)if(s.customParsers[v].call(s,m))return;if(m.indexOf("#EXT")!==0){s.trigger("data",{type:"comment",text:m.slice(1)});return}if(m=m.replace("\r",""),a=/^#EXTM3U/.exec(m),a){s.trigger("data",{type:"tag",tagType:"m3u"});return}if(a=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(m),a){c={type:"tag",tagType:"inf"},a[1]&&(c.duration=parseFloat(a[1])),a[2]&&(c.title=a[2]),s.trigger("data",c);return}if(a=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(m),a){c={type:"tag",tagType:"targetduration"},a[1]&&(c.duration=parseInt(a[1],10)),s.trigger("data",c);return}if(a=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(m),a){c={type:"tag",tagType:"version"},a[1]&&(c.version=parseInt(a[1],10)),s.trigger("data",c);return}if(a=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(m),a){c={type:"tag",tagType:"media-sequence"},a[1]&&(c.number=parseInt(a[1],10)),s.trigger("data",c);return}if(a=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(m),a){c={type:"tag",tagType:"discontinuity-sequence"},a[1]&&(c.number=parseInt(a[1],10)),s.trigger("data",c);return}if(a=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(m),a){c={type:"tag",tagType:"playlist-type"},a[1]&&(c.playlistType=a[1]),s.trigger("data",c);return}if(a=/^#EXT-X-BYTERANGE:?(.*)?$/.exec(m),a){c=zr(yw(a[1]),{type:"tag",tagType:"byterange"}),s.trigger("data",c);return}if(a=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(m),a){c={type:"tag",tagType:"allow-cache"},a[1]&&(c.allowed=!/NO/.test(a[1])),s.trigger("data",c);return}if(a=/^#EXT-X-MAP:?(.*)$/.exec(m),a){if(c={type:"tag",tagType:"map"},a[1]){var b=Hc(a[1]);b.URI&&(c.uri=b.URI),b.BYTERANGE&&(c.byterange=yw(b.BYTERANGE))}s.trigger("data",c);return}if(a=/^#EXT-X-STREAM-INF:?(.*)$/.exec(m),a){if(c={type:"tag",tagType:"stream-inf"},a[1]){if(c.attributes=Hc(a[1]),c.attributes.RESOLUTION){var x=c.attributes.RESOLUTION.split("x"),C={};x[0]&&(C.width=parseInt(x[0],10)),x[1]&&(C.height=parseInt(x[1],10)),c.attributes.RESOLUTION=C}c.attributes.BANDWIDTH&&(c.attributes.BANDWIDTH=parseInt(c.attributes.BANDWIDTH,10)),c.attributes["FRAME-RATE"]&&(c.attributes["FRAME-RATE"]=parseFloat(c.attributes["FRAME-RATE"])),c.attributes["PROGRAM-ID"]&&(c.attributes["PROGRAM-ID"]=parseInt(c.attributes["PROGRAM-ID"],10))}s.trigger("data",c);return}if(a=/^#EXT-X-MEDIA:?(.*)$/.exec(m),a){c={type:"tag",tagType:"media"},a[1]&&(c.attributes=Hc(a[1])),s.trigger("data",c);return}if(a=/^#EXT-X-ENDLIST/.exec(m),a){s.trigger("data",{type:"tag",tagType:"endlist"});return}if(a=/^#EXT-X-DISCONTINUITY/.exec(m),a){s.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(a=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(m),a){c={type:"tag",tagType:"program-date-time"},a[1]&&(c.dateTimeString=a[1],c.dateTimeObject=new Date(a[1])),s.trigger("data",c);return}if(a=/^#EXT-X-KEY:?(.*)$/.exec(m),a){c={type:"tag",tagType:"key"},a[1]&&(c.attributes=Hc(a[1]),c.attributes.IV&&(c.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(c.attributes.IV=c.attributes.IV.substring(2)),c.attributes.IV=c.attributes.IV.match(/.{8}/g),c.attributes.IV[0]=parseInt(c.attributes.IV[0],16),c.attributes.IV[1]=parseInt(c.attributes.IV[1],16),c.attributes.IV[2]=parseInt(c.attributes.IV[2],16),c.attributes.IV[3]=parseInt(c.attributes.IV[3],16),c.attributes.IV=new Uint32Array(c.attributes.IV))),s.trigger("data",c);return}if(a=/^#EXT-X-START:?(.*)$/.exec(m),a){c={type:"tag",tagType:"start"},a[1]&&(c.attributes=Hc(a[1]),c.attributes["TIME-OFFSET"]=parseFloat(c.attributes["TIME-OFFSET"]),c.attributes.PRECISE=/YES/.test(c.attributes.PRECISE)),s.trigger("data",c);return}if(a=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(m),a){c={type:"tag",tagType:"cue-out-cont"},a[1]?c.data=a[1]:c.data="",s.trigger("data",c);return}if(a=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(m),a){c={type:"tag",tagType:"cue-out"},a[1]?c.data=a[1]:c.data="",s.trigger("data",c);return}if(a=/^#EXT-X-CUE-IN:?(.*)?$/.exec(m),a){c={type:"tag",tagType:"cue-in"},a[1]?c.data=a[1]:c.data="",s.trigger("data",c);return}if(a=/^#EXT-X-SKIP:(.*)$/.exec(m),a&&a[1]){c={type:"tag",tagType:"skip"},c.attributes=Hc(a[1]),c.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(c.attributes["SKIPPED-SEGMENTS"]=parseInt(c.attributes["SKIPPED-SEGMENTS"],10)),c.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(c.attributes["RECENTLY-REMOVED-DATERANGES"]=c.attributes["RECENTLY-REMOVED-DATERANGES"].split(Lj)),s.trigger("data",c);return}if(a=/^#EXT-X-PART:(.*)$/.exec(m),a&&a[1]){c={type:"tag",tagType:"part"},c.attributes=Hc(a[1]),["DURATION"].forEach(function(B){c.attributes.hasOwnProperty(B)&&(c.attributes[B]=parseFloat(c.attributes[B]))}),["INDEPENDENT","GAP"].forEach(function(B){c.attributes.hasOwnProperty(B)&&(c.attributes[B]=/YES/.test(c.attributes[B]))}),c.attributes.hasOwnProperty("BYTERANGE")&&(c.attributes.byterange=yw(c.attributes.BYTERANGE)),s.trigger("data",c);return}if(a=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(m),a&&a[1]){c={type:"tag",tagType:"server-control"},c.attributes=Hc(a[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(B){c.attributes.hasOwnProperty(B)&&(c.attributes[B]=parseFloat(c.attributes[B]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(B){c.attributes.hasOwnProperty(B)&&(c.attributes[B]=/YES/.test(c.attributes[B]))}),s.trigger("data",c);return}if(a=/^#EXT-X-PART-INF:(.*)$/.exec(m),a&&a[1]){c={type:"tag",tagType:"part-inf"},c.attributes=Hc(a[1]),["PART-TARGET"].forEach(function(B){c.attributes.hasOwnProperty(B)&&(c.attributes[B]=parseFloat(c.attributes[B]))}),s.trigger("data",c);return}if(a=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(m),a&&a[1]){c={type:"tag",tagType:"preload-hint"},c.attributes=Hc(a[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(B){if(c.attributes.hasOwnProperty(B)){c.attributes[B]=parseInt(c.attributes[B],10);var P=B==="BYTERANGE-LENGTH"?"length":"offset";c.attributes.byterange=c.attributes.byterange||{},c.attributes.byterange[P]=c.attributes[B],delete c.attributes[B]}}),s.trigger("data",c);return}if(a=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(m),a&&a[1]){c={type:"tag",tagType:"rendition-report"},c.attributes=Hc(a[1]),["LAST-MSN","LAST-PART"].forEach(function(B){c.attributes.hasOwnProperty(B)&&(c.attributes[B]=parseInt(c.attributes[B],10))}),s.trigger("data",c);return}s.trigger("data",{type:"tag",data:m.slice(4)})})}},t.addParser=function(n){var s=this,a=n.expression,c=n.customType,h=n.dataParser,m=n.segment;typeof h!="function"&&(h=function(b){return b}),this.customParsers.push(function(v){var b=a.exec(v);if(b)return s.trigger("data",{type:"custom",data:h(v),customType:c,segment:m}),!0})},t.addTagMapper=function(n){var s=n.expression,a=n.map,c=function(m){return s.test(m)?a(m):m};this.tagMappers.push(c)},e}(bC),Oj=function(e){return e.toLowerCase().replace(/-(\w)/g,function(t){return t[1].toUpperCase()})},Gg=function(e){var t={};return Object.keys(e).forEach(function(i){t[Oj(i)]=e[i]}),t},_w=function(e){var t=e.serverControl,i=e.targetDuration,n=e.partTargetDuration;if(t){var s="#EXT-X-SERVER-CONTROL",a="holdBack",c="partHoldBack",h=i&&i*3,m=n&&n*2;i&&!t.hasOwnProperty(a)&&(t[a]=h,this.trigger("info",{message:s+" defaulting HOLD-BACK to targetDuration * 3 ("+h+")."})),h&&t[a]<h&&(this.trigger("warn",{message:s+" clamping HOLD-BACK ("+t[a]+") to targetDuration * 3 ("+h+")"}),t[a]=h),n&&!t.hasOwnProperty(c)&&(t[c]=n*3,this.trigger("info",{message:s+" defaulting PART-HOLD-BACK to partTargetDuration * 3 ("+t[c]+")."})),n&&t[c]<m&&(this.trigger("warn",{message:s+" clamping PART-HOLD-BACK ("+t[c]+") to partTargetDuration * 2 ("+m+")."}),t[c]=m)}},Fj=function(r){mi(e,r);function e(){var i;i=r.call(this)||this,i.lineStream=new Pj,i.parseStream=new kj,i.lineStream.pipe(i.parseStream);var n=Tn(i),s=[],a={},c,h,m=!1,v=function(){},b={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},x="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",C=0;i.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};var B=0,P=0;return i.on("end",function(){a.uri||!a.parts&&!a.preloadHints||(!a.map&&c&&(a.map=c),!a.key&&h&&(a.key=h),!a.timeline&&typeof C=="number"&&(a.timeline=C),i.manifest.preloadSegment=a)}),i.parseStream.on("data",function(N){var ae,X;({tag:function(){({version:function(){N.version&&(this.manifest.version=N.version)},"allow-cache":function(){this.manifest.allowCache=N.allowed,"allowed"in N||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var ue={};"length"in N&&(a.byterange=ue,ue.length=N.length,"offset"in N||(N.offset=B)),"offset"in N&&(a.byterange=ue,ue.offset=N.offset),B=ue.offset+ue.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),N.duration>0&&(a.duration=N.duration),N.duration===0&&(a.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=s},key:function(){if(!N.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(N.attributes.METHOD==="NONE"){h=null;return}if(!N.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(N.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:N.attributes};return}if(N.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:N.attributes.URI};return}if(N.attributes.KEYFORMAT===x){var ue=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];if(ue.indexOf(N.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(N.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),N.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(N.attributes.KEYID&&N.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:N.attributes.KEYFORMAT,keyId:N.attributes.KEYID.substring(2)},pssh:M4(N.attributes.URI.split(",")[1])};return}N.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),h={method:N.attributes.METHOD||"AES-128",uri:N.attributes.URI},typeof N.attributes.IV<"u"&&(h.iv=N.attributes.IV)},"media-sequence":function(){if(!isFinite(N.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+N.number});return}this.manifest.mediaSequence=N.number},"discontinuity-sequence":function(){if(!isFinite(N.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+N.number});return}this.manifest.discontinuitySequence=N.number,C=N.number},"playlist-type":function(){if(!/VOD|EVENT/.test(N.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+N.playlist});return}this.manifest.playlistType=N.playlistType},map:function(){c={},N.uri&&(c.uri=N.uri),N.byterange&&(c.byterange=N.byterange),h&&(c.key=h)},"stream-inf":function(){if(this.manifest.playlists=s,this.manifest.mediaGroups=this.manifest.mediaGroups||b,!N.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}a.attributes||(a.attributes={}),zr(a.attributes,N.attributes)},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||b,!(N.attributes&&N.attributes.TYPE&&N.attributes["GROUP-ID"]&&N.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}var ue=this.manifest.mediaGroups[N.attributes.TYPE];ue[N.attributes["GROUP-ID"]]=ue[N.attributes["GROUP-ID"]]||{},ae=ue[N.attributes["GROUP-ID"]],X={default:/yes/i.test(N.attributes.DEFAULT)},X.default?X.autoselect=!0:X.autoselect=/yes/i.test(N.attributes.AUTOSELECT),N.attributes.LANGUAGE&&(X.language=N.attributes.LANGUAGE),N.attributes.URI&&(X.uri=N.attributes.URI),N.attributes["INSTREAM-ID"]&&(X.instreamId=N.attributes["INSTREAM-ID"]),N.attributes.CHARACTERISTICS&&(X.characteristics=N.attributes.CHARACTERISTICS),N.attributes.FORCED&&(X.forced=/yes/i.test(N.attributes.FORCED)),ae[N.attributes.NAME]=X},discontinuity:function(){C+=1,a.discontinuity=!0,this.manifest.discontinuityStarts.push(s.length)},"program-date-time":function(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=N.dateTimeString,this.manifest.dateTimeObject=N.dateTimeObject),a.dateTimeString=N.dateTimeString,a.dateTimeObject=N.dateTimeObject},targetduration:function(){if(!isFinite(N.duration)||N.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+N.duration});return}this.manifest.targetDuration=N.duration,_w.call(this,this.manifest)},start:function(){if(!N.attributes||isNaN(N.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:N.attributes["TIME-OFFSET"],precise:N.attributes.PRECISE}},"cue-out":function(){a.cueOut=N.data},"cue-out-cont":function(){a.cueOutCont=N.data},"cue-in":function(){a.cueIn=N.data},skip:function(){this.manifest.skip=Gg(N.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",N.attributes,["SKIPPED-SEGMENTS"])},part:function(){var ue=this;m=!0;var be=this.manifest.segments.length,fe=Gg(N.attributes);a.parts=a.parts||[],a.parts.push(fe),fe.byterange&&(fe.byterange.hasOwnProperty("offset")||(fe.byterange.offset=P),P=fe.byterange.offset+fe.byterange.length);var ve=a.parts.length-1;this.warnOnMissingAttributes_("#EXT-X-PART #"+ve+" for segment #"+be,N.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach(function(ie,re){ie.hasOwnProperty("lastPart")||ue.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #"+re+" lacks required attribute(s): LAST-PART"})})},"server-control":function(){var ue=this.manifest.serverControl=Gg(N.attributes);ue.hasOwnProperty("canBlockReload")||(ue.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),_w.call(this,this.manifest),ue.canSkipDateranges&&!ue.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint":function(){var ue=this.manifest.segments.length,be=Gg(N.attributes),fe=be.type&&be.type==="PART";a.preloadHints=a.preloadHints||[],a.preloadHints.push(be),be.byterange&&(be.byterange.hasOwnProperty("offset")||(be.byterange.offset=fe?P:0,fe&&(P=be.byterange.offset+be.byterange.length)));var ve=a.preloadHints.length-1;if(this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #"+ve+" for segment #"+ue,N.attributes,["TYPE","URI"]),!!be.type)for(var ie=0;ie<a.preloadHints.length-1;ie++){var re=a.preloadHints[ie];re.type&&re.type===be.type&&this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #"+ve+" for segment #"+ue+" has the same TYPE "+be.type+" as preload hint #"+ie})}},"rendition-report":function(){var ue=Gg(N.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(ue);var be=this.manifest.renditionReports.length-1,fe=["LAST-MSN","URI"];m&&fe.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+be,N.attributes,fe)},"part-inf":function(){this.manifest.partInf=Gg(N.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",N.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),_w.call(this,this.manifest)}}[N.tagType]||v).call(n)},uri:function(){a.uri=N.uri,s.push(a),this.manifest.targetDuration&&!("duration"in a)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),a.duration=this.manifest.targetDuration),h&&(a.key=h),a.timeline=C,c&&(a.map=c),P=0,a={}},comment:function(){},custom:function(){N.segment?(a.custom=a.custom||{},a.custom[N.customType]=N.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[N.customType]=N.data)}})[N.type].call(n)}),i}var t=e.prototype;return t.warnOnMissingAttributes_=function(n,s,a){var c=[];a.forEach(function(h){s.hasOwnProperty(h)||c.push(h)}),c.length&&this.trigger("warn",{message:n+" lacks required attribute(s): "+c.join(", ")})},t.push=function(n){this.lineStream.push(n)},t.end=function(){this.lineStream.push(`
`),this.trigger("end")},t.addParser=function(n){this.parseStream.addParser(n)},t.addTagMapper=function(n){this.parseStream.addTagMapper(n)},e}(bC),Wm={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},Bj=["video","audio","text"],v3=["Video","Audio","Text"],D4=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(t,i,n){var s=("00"+Number(i).toString(16)).slice(-2),a=("00"+Number(n).toString(16)).slice(-2);return"avc1."+s+"00"+a})},Zd=function(e){e===void 0&&(e="");var t=e.split(","),i=[];return t.forEach(function(n){n=n.trim();var s;Bj.forEach(function(a){var c=Wm[a].exec(n.toLowerCase());if(!(!c||c.length<=1)){s=a;var h=n.substring(0,c[1].length),m=n.replace(h,"");i.push({type:h,details:m,mediaType:a})}}),s||i.push({type:n,details:"",mediaType:"unknown"})}),i},Nj=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var i=e.mediaGroups.AUDIO[t];if(!i)return null;for(var n in i){var s=i[n];if(s.default&&s.playlists)return Zd(s.playlists[0].attributes.CODECS)}return null},I4=function(e){return e===void 0&&(e=""),Wm.audio.test(e.trim().toLowerCase())},Uj=function(e){return e===void 0&&(e=""),Wm.text.test(e.trim().toLowerCase())},I_=function(e){if(!(!e||typeof e!="string")){var t=e.toLowerCase().split(",").map(function(s){return D4(s.trim())}),i="video";t.length===1&&I4(t[0])?i="audio":t.length===1&&Uj(t[0])&&(i="application");var n="mp4";return t.every(function(s){return Wm.mp4.test(s)})?n="mp4":t.every(function(s){return Wm.webm.test(s)})?n="webm":t.every(function(s){return Wm.ogg.test(s)})&&(n="ogg"),i+"/"+n+';codecs="'+e+'"'}},AT=function(e){return e===void 0&&(e=""),Z.MediaSource&&Z.MediaSource.isTypeSupported&&Z.MediaSource.isTypeSupported(I_(e))||!1},bw=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(t){t=t.trim();for(var i=0;i<v3.length;i++){var n=v3[i];if(Wm["muxer"+n].test(t))return!0}return!1})},y3="mp4a.40.2",Vj="avc1.4d400d",zj=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,Hj=/^application\/dash\+xml/i,P4=function(e){return zj.test(e)?"hls":Hj.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null},jj=function(e){return e.toString(2).length},Gj=function(e){return Math.ceil(jj(e)/8)},L4=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},$j=function(e){return L4(e)},tn=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!$j(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},co=Z.BigInt||Number,RE=[co("0x1"),co("0x100"),co("0x10000"),co("0x1000000"),co("0x100000000"),co("0x10000000000"),co("0x1000000000000"),co("0x100000000000000"),co("0x10000000000000000")];(function(){var r=new Uint16Array([65484]),e=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"})();var Wj=function(e,t){var i=t===void 0?{}:t,n=i.signed,s=n===void 0?!1:n,a=i.le,c=a===void 0?!1:a;e=tn(e);var h=c?"reduce":"reduceRight",m=e[h]?e[h]:Array.prototype[h],v=m.call(e,function(x,C,B){var P=c?B:Math.abs(B+1-e.length);return x+co(C)*RE[P]},co(0));if(s){var b=RE[e.length]/co(2)-co(1);v=co(v),v>b&&(v-=b,v-=b,v-=co(2))}return Number(v)},qj=function(e,t){var i={},n=i.le,s=n===void 0?!1:n;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=co(e);for(var a=Gj(e),c=new Uint8Array(new ArrayBuffer(a)),h=0;h<a;h++){var m=s?h:Math.abs(h+1-c.length);c[m]=Number(e/RE[h]&co(255)),e<0&&(c[m]=Math.abs(~c[m]),c[m]-=h===0?1:2)}return c},R4=function(e,t){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;t||(e=unescape(encodeURIComponent(e)));for(var i=new Uint8Array(e.length),n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return i},Xj=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(t=t.filter(function(c){return c&&(c.byteLength||c.length)&&typeof c!="string"}),t.length<=1)return tn(t[0]);var n=t.reduce(function(c,h,m){return c+(h.byteLength||h.length)},0),s=new Uint8Array(n),a=0;return t.forEach(function(c){c=tn(c),s.set(c,a),a+=c.byteLength}),s},Ds=function(e,t,i){var n=i===void 0?{}:i,s=n.offset,a=s===void 0?0:s,c=n.mask,h=c===void 0?[]:c;e=tn(e),t=tn(t);var m=t.every?t.every:Array.prototype.every;return t.length&&e.length-a>=t.length&&m.call(t,function(v,b){var x=h[b]?h[b]&e[a+b]:e[a+b];return v===x})},Yj=function(e,t,i){t.forEach(function(n){for(var s in e.mediaGroups[n])for(var a in e.mediaGroups[n][s]){var c=e.mediaGroups[n][s][a];i(c,n,s,a)}})};/*! @name mpd-parser @version 0.22.1 @license Apache-2.0 */var _3=function(e){return!!e&&typeof e=="object"},ml=function r(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.reduce(function(n,s){return typeof s!="object"||Object.keys(s).forEach(function(a){Array.isArray(n[a])&&Array.isArray(s[a])?n[a]=n[a].concat(s[a]):_3(n[a])&&_3(s[a])?n[a]=r(n[a],s[a]):n[a]=s[a]}),n},{})},k4=function(e){return Object.keys(e).map(function(t){return e[t]})},Qj=function(e,t){for(var i=[],n=e;n<t;n++)i.push(n);return i},pS=function(e){return e.reduce(function(t,i){return t.concat(i)},[])},O4=function(e){if(!e.length)return[];for(var t=[],i=0;i<e.length;i++)t.push(e[i]);return t},Kj=function(e,t){return e.reduce(function(i,n,s){return n[t]&&i.push(s),i},[])},kE=function(e,t){for(var i=0;i<e.length;i++)if(t(e[i]))return i;return-1},Zj=function(e,t){return k4(e.reduce(function(i,n){return n.forEach(function(s){i[t(s)]=s}),i},{}))},j0={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"},P_=function(e){var t=e.baseUrl,i=t===void 0?"":t,n=e.source,s=n===void 0?"":n,a=e.range,c=a===void 0?"":a,h=e.indexRange,m=h===void 0?"":h,v={uri:s,resolvedUri:fS(i||"",s)};if(c||m){var b=c||m,x=b.split("-"),C=Z.BigInt?Z.BigInt(x[0]):parseInt(x[0],10),B=Z.BigInt?Z.BigInt(x[1]):parseInt(x[1],10);C<Number.MAX_SAFE_INTEGER&&typeof C=="bigint"&&(C=Number(C)),B<Number.MAX_SAFE_INTEGER&&typeof B=="bigint"&&(B=Number(B));var P;typeof B=="bigint"||typeof C=="bigint"?P=Z.BigInt(B)-Z.BigInt(C)+Z.BigInt(1):P=B-C+1,typeof P=="bigint"&&P<Number.MAX_SAFE_INTEGER&&(P=Number(P)),v.byterange={length:P,offset:C}}return v},Jj=function(e){var t;return typeof e.offset=="bigint"||typeof e.length=="bigint"?t=Z.BigInt(e.offset)+Z.BigInt(e.length)-Z.BigInt(1):t=e.offset+e.length-1,e.offset+"-"+t},b3=function(e){return e&&typeof e!="number"&&(e=parseInt(e,10)),isNaN(e)?null:e},eG={static:function(e){var t=e.duration,i=e.timescale,n=i===void 0?1:i,s=e.sourceDuration,a=e.periodDuration,c=b3(e.endNumber),h=t/n;return typeof c=="number"?{start:0,end:c}:typeof a=="number"?{start:0,end:a/h}:{start:0,end:s/h}},dynamic:function(e){var t=e.NOW,i=e.clientOffset,n=e.availabilityStartTime,s=e.timescale,a=s===void 0?1:s,c=e.duration,h=e.periodStart,m=h===void 0?0:h,v=e.minimumUpdatePeriod,b=v===void 0?0:v,x=e.timeShiftBufferDepth,C=x===void 0?1/0:x,B=b3(e.endNumber),P=(t+i)/1e3,N=n+m,ae=P+b,X=ae-N,de=Math.ceil(X*a/c),ge=Math.floor((P-N-C)*a/c),ue=Math.floor((P-N)*a/c);return{start:Math.max(0,ge),end:typeof B=="number"?B:Math.min(de,ue)}}},tG=function(e){return function(t){var i=e.duration,n=e.timescale,s=n===void 0?1:n,a=e.periodStart,c=e.startNumber,h=c===void 0?1:c;return{number:h+t,duration:i/s,timeline:a,time:t*i}}},TC=function(e){var t=e.type,i=e.duration,n=e.timescale,s=n===void 0?1:n,a=e.periodDuration,c=e.sourceDuration,h=eG[t](e),m=h.start,v=h.end,b=Qj(m,v).map(tG(e));if(t==="static"){var x=b.length-1,C=typeof a=="number"?a:c;b[x].duration=C-i/s*x}return b},F4=function(e){var t=e.baseUrl,i=e.initialization,n=i===void 0?{}:i,s=e.sourceDuration,a=e.indexRange,c=a===void 0?"":a,h=e.periodStart,m=e.presentationTime,v=e.number,b=v===void 0?0:v,x=e.duration;if(!t)throw new Error(j0.NO_BASE_URL);var C=P_({baseUrl:t,source:n.sourceURL,range:n.range}),B=P_({baseUrl:t,source:t,indexRange:c});if(B.map=C,x){var P=TC(e);P.length&&(B.duration=P[0].duration,B.timeline=P[0].timeline)}else s&&(B.duration=s,B.timeline=h);return B.presentationTime=m||h,B.number=b,[B]},xC=function(e,t,i){var n=e.sidx.map?e.sidx.map:null,s=e.sidx.duration,a=e.timeline||0,c=e.sidx.byterange,h=c.offset+c.length,m=t.timescale,v=t.references.filter(function(ie){return ie.referenceType!==1}),b=[],x=e.endList?"static":"dynamic",C=e.sidx.timeline,B=C,P=e.mediaSequence||0,N;typeof t.firstOffset=="bigint"?N=Z.BigInt(h)+t.firstOffset:N=h+t.firstOffset;for(var ae=0;ae<v.length;ae++){var X=t.references[ae],de=X.referencedSize,ge=X.subsegmentDuration,ue=void 0;typeof N=="bigint"?ue=N+Z.BigInt(de)-Z.BigInt(1):ue=N+de-1;var be=N+"-"+ue,fe={baseUrl:i,timescale:m,timeline:a,periodStart:C,presentationTime:B,number:P,duration:ge,sourceDuration:s,indexRange:be,type:x},ve=F4(fe)[0];n&&(ve.map=n),b.push(ve),typeof N=="bigint"?N+=Z.BigInt(de):N+=de,B+=ge/m,P++}return e.segments=b,e},iG=["AUDIO","SUBTITLES"],nG=1/60,B4=function(e){return Zj(e,function(t){var i=t.timeline;return i}).sort(function(t,i){return t.timeline>i.timeline?1:-1})},rG=function(e,t){for(var i=0;i<e.length;i++)if(e[i].attributes.NAME===t)return e[i];return null},T3=function(e){var t=[];return Yj(e,iG,function(i,n,s,a){t=t.concat(i.playlists||[])}),t},x3=function(e){var t=e.playlist,i=e.mediaSequence;t.mediaSequence=i,t.segments.forEach(function(n,s){n.number=t.mediaSequence+s})},sG=function(e){var t=e.oldPlaylists,i=e.newPlaylists,n=e.timelineStarts;i.forEach(function(s){s.discontinuitySequence=kE(n,function(v){var b=v.timeline;return b===s.timeline});var a=rG(t,s.attributes.NAME);if(a&&!s.sidx){var c=s.segments[0],h=kE(a.segments,function(v){return Math.abs(v.presentationTime-c.presentationTime)<nG});if(h===-1){x3({playlist:s,mediaSequence:a.mediaSequence+a.segments.length}),s.segments[0].discontinuity=!0,s.discontinuityStarts.unshift(0),(!a.segments.length&&s.timeline>a.timeline||a.segments.length&&s.timeline>a.segments[a.segments.length-1].timeline)&&s.discontinuitySequence--;return}var m=a.segments[h];m.discontinuity&&!c.discontinuity&&(c.discontinuity=!0,s.discontinuityStarts.unshift(0),s.discontinuitySequence--),x3({playlist:s,mediaSequence:a.segments[h].number})}})},aG=function(e){var t=e.oldManifest,i=e.newManifest,n=t.playlists.concat(T3(t)),s=i.playlists.concat(T3(i));return i.timelineStarts=B4([t.timelineStarts,i.timelineStarts]),sG({oldPlaylists:n,newPlaylists:s,timelineStarts:i.timelineStarts}),i},mS=function(e){return e&&e.uri+"-"+Jj(e.byterange)},Tw=function(e){var t=k4(e.reduce(function(i,n){var s=n.attributes.id+(n.attributes.lang||"");if(!i[s])i[s]=n,i[s].attributes.timelineStarts=[];else{if(n.segments){var a;n.segments[0]&&(n.segments[0].discontinuity=!0),(a=i[s].segments).push.apply(a,n.segments)}n.attributes.contentProtection&&(i[s].attributes.contentProtection=n.attributes.contentProtection)}return i[s].attributes.timelineStarts.push({start:n.attributes.periodStart,timeline:n.attributes.periodStart}),i},{}));return t.map(function(i){return i.discontinuityStarts=Kj(i.segments||[],"discontinuity"),i})},SC=function(e,t){var i=mS(e.sidx),n=i&&t[i]&&t[i].sidx;return n&&xC(e,n,e.sidx.resolvedUri),e},oG=function(e,t){if(t===void 0&&(t={}),!Object.keys(t).length)return e;for(var i in e)e[i]=SC(e[i],t);return e},lG=function(e,t){var i,n=e.attributes,s=e.segments,a=e.sidx,c=e.mediaSequence,h=e.discontinuitySequence,m=e.discontinuityStarts,v={attributes:(i={NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs},i["PROGRAM-ID"]=1,i),uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:"",targetDuration:n.duration,discontinuitySequence:h,discontinuityStarts:m,timelineStarts:n.timelineStarts,mediaSequence:c,segments:s};return n.contentProtection&&(v.contentProtection=n.contentProtection),a&&(v.sidx=a),t&&(v.attributes.AUDIO="audio",v.attributes.SUBTITLES="subs"),v},uG=function(e){var t,i=e.attributes,n=e.segments,s=e.mediaSequence,a=e.discontinuityStarts,c=e.discontinuitySequence;typeof n>"u"&&(n=[{uri:i.baseUrl,timeline:i.periodStart,resolvedUri:i.baseUrl||"",duration:i.sourceDuration,number:0}],i.duration=i.sourceDuration);var h=(t={NAME:i.id,BANDWIDTH:i.bandwidth},t["PROGRAM-ID"]=1,t);return i.codecs&&(h.CODECS=i.codecs),{attributes:h,uri:"",endList:i.type==="static",timeline:i.periodStart,resolvedUri:i.baseUrl||"",targetDuration:i.duration,timelineStarts:i.timelineStarts,discontinuityStarts:a,discontinuitySequence:c,mediaSequence:s,segments:n}},cG=function(e,t,i){t===void 0&&(t={}),i===void 0&&(i=!1);var n,s=e.reduce(function(c,h){var m=h.attributes.role&&h.attributes.role.value||"",v=h.attributes.lang||"",b=h.attributes.label||"main";if(v&&!h.attributes.label){var x=m?" ("+m+")":"";b=""+h.attributes.lang+x}c[b]||(c[b]={language:v,autoselect:!0,default:m==="main",playlists:[],uri:""});var C=SC(lG(h,i),t);return c[b].playlists.push(C),typeof n>"u"&&m==="main"&&(n=h,n.default=!0),c},{});if(!n){var a=Object.keys(s)[0];s[a].default=!0}return s},dG=function(e,t){return t===void 0&&(t={}),e.reduce(function(i,n){var s=n.attributes.lang||"text";return i[s]||(i[s]={language:s,default:!1,autoselect:!1,playlists:[],uri:""}),i[s].playlists.push(SC(uG(n),t)),i},{})},hG=function(e){return e.reduce(function(t,i){return i&&i.forEach(function(n){var s=n.channel,a=n.language;t[a]={autoselect:!1,default:!1,instreamId:s,language:a},n.hasOwnProperty("aspectRatio")&&(t[a].aspectRatio=n.aspectRatio),n.hasOwnProperty("easyReader")&&(t[a].easyReader=n.easyReader),n.hasOwnProperty("3D")&&(t[a]["3D"]=n["3D"])}),t},{})},fG=function(e){var t,i=e.attributes,n=e.segments,s=e.sidx,a=e.discontinuityStarts,c={attributes:(t={NAME:i.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:i.width,height:i.height},CODECS:i.codecs,BANDWIDTH:i.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:i.type==="static",timeline:i.periodStart,resolvedUri:"",targetDuration:i.duration,discontinuityStarts:a,timelineStarts:i.timelineStarts,segments:n};return i.frameRate&&(c.attributes["FRAME-RATE"]=i.frameRate),i.contentProtection&&(c.contentProtection=i.contentProtection),s&&(c.sidx=s),c},pG=function(e){var t=e.attributes;return t.mimeType==="video/mp4"||t.mimeType==="video/webm"||t.contentType==="video"},mG=function(e){var t=e.attributes;return t.mimeType==="audio/mp4"||t.mimeType==="audio/webm"||t.contentType==="audio"},gG=function(e){var t=e.attributes;return t.mimeType==="text/vtt"||t.contentType==="text"},vG=function(e,t){e.forEach(function(i){i.mediaSequence=0,i.discontinuitySequence=kE(t,function(n){var s=n.timeline;return s===i.timeline}),i.segments&&i.segments.forEach(function(n,s){n.number=s})})},S3=function(e){return e?Object.keys(e).reduce(function(t,i){var n=e[i];return t.concat(n.playlists)},[]):[]},yG=function(e){var t,i=e.dashPlaylists,n=e.locations,s=e.sidxMapping,a=s===void 0?{}:s,c=e.previousManifest;if(!i.length)return{};var h=i[0].attributes,m=h.sourceDuration,v=h.type,b=h.suggestedPresentationDelay,x=h.minimumUpdatePeriod,C=Tw(i.filter(pG)).map(fG),B=Tw(i.filter(mG)),P=Tw(i.filter(gG)),N=i.map(function(fe){return fe.attributes.captionServices}).filter(Boolean),ae={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(t={AUDIO:{},VIDEO:{}},t["CLOSED-CAPTIONS"]={},t.SUBTITLES={},t),uri:"",duration:m,playlists:oG(C,a)};x>=0&&(ae.minimumUpdatePeriod=x*1e3),n&&(ae.locations=n),v==="dynamic"&&(ae.suggestedPresentationDelay=b);var X=ae.playlists.length===0,de=B.length?cG(B,a,X):null,ge=P.length?dG(P,a):null,ue=C.concat(S3(de),S3(ge)),be=ue.map(function(fe){var ve=fe.timelineStarts;return ve});return ae.timelineStarts=B4(be),vG(ue,ae.timelineStarts),de&&(ae.mediaGroups.AUDIO.audio=de),ge&&(ae.mediaGroups.SUBTITLES.subs=ge),N.length&&(ae.mediaGroups["CLOSED-CAPTIONS"].cc=hG(N)),c?aG({oldManifest:c,newManifest:ae}):ae},_G=function(e,t,i){var n=e.NOW,s=e.clientOffset,a=e.availabilityStartTime,c=e.timescale,h=c===void 0?1:c,m=e.periodStart,v=m===void 0?0:m,b=e.minimumUpdatePeriod,x=b===void 0?0:b,C=(n+s)/1e3,B=a+v,P=C+x,N=P-B;return Math.ceil((N*h-t)/i)},N4=function(e,t){for(var i=e.type,n=e.minimumUpdatePeriod,s=n===void 0?0:n,a=e.media,c=a===void 0?"":a,h=e.sourceDuration,m=e.timescale,v=m===void 0?1:m,b=e.startNumber,x=b===void 0?1:b,C=e.periodStart,B=[],P=-1,N=0;N<t.length;N++){var ae=t[N],X=ae.d,de=ae.r||0,ge=ae.t||0;P<0&&(P=ge),ge&&ge>P&&(P=ge);var ue=void 0;if(de<0){var be=N+1;be===t.length?i==="dynamic"&&s>0&&c.indexOf("$Number$")>0?ue=_G(e,P,X):ue=(h*v-P)/X:ue=(t[be].t-P)/X}else ue=de+1;for(var fe=x+B.length+ue,ve=x+B.length;ve<fe;)B.push({number:ve,duration:X/v,time:P,timeline:C}),P+=X,ve++}return B},bG=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,TG=function(e){return function(t,i,n,s){if(t==="$$")return"$";if(typeof e[i]>"u")return t;var a=""+e[i];return i==="RepresentationID"||(n?s=parseInt(s,10):s=1,a.length>=s)?a:""+new Array(s-a.length+1).join("0")+a}},A3=function(e,t){return e.replace(bG,TG(t))},xG=function(e,t){return!e.duration&&!t?[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodStart}]:e.duration?TC(e):N4(e,t)},SG=function(e,t){var i={RepresentationID:e.id,Bandwidth:e.bandwidth||0},n=e.initialization,s=n===void 0?{sourceURL:"",range:""}:n,a=P_({baseUrl:e.baseUrl,source:A3(s.sourceURL,i),range:s.range}),c=xG(e,t);return c.map(function(h){i.Number=h.number,i.Time=h.time;var m=A3(e.media||"",i),v=e.timescale||1,b=e.presentationTimeOffset||0,x=e.periodStart+(h.time-b)/v,C={uri:m,timeline:h.timeline,duration:h.duration,resolvedUri:fS(e.baseUrl||"",m),map:a,number:h.number,presentationTime:x};return C})},AG=function(e,t){var i=e.baseUrl,n=e.initialization,s=n===void 0?{}:n,a=P_({baseUrl:i,source:s.sourceURL,range:s.range}),c=P_({baseUrl:i,source:t.media,range:t.mediaRange});return c.map=a,c},wG=function(e,t){var i=e.duration,n=e.segmentUrls,s=n===void 0?[]:n,a=e.periodStart;if(!i&&!t||i&&t)throw new Error(j0.SEGMENT_TIME_UNSPECIFIED);var c=s.map(function(v){return AG(e,v)}),h;i&&(h=TC(e)),t&&(h=N4(e,t));var m=h.map(function(v,b){if(c[b]){var x=c[b],C=e.timescale||1,B=e.presentationTimeOffset||0;return x.timeline=v.timeline,x.duration=v.duration,x.number=v.number,x.presentationTime=a+(v.time-B)/C,x}}).filter(function(v){return v});return m},EG=function(e){var t=e.attributes,i=e.segmentInfo,n,s;i.template?(s=SG,n=ml(t,i.template)):i.base?(s=F4,n=ml(t,i.base)):i.list&&(s=wG,n=ml(t,i.list));var a={attributes:t};if(!s)return a;var c=s(n,i.segmentTimeline);if(n.duration){var h=n,m=h.duration,v=h.timescale,b=v===void 0?1:v;n.duration=m/b}else c.length?n.duration=c.reduce(function(x,C){return Math.max(x,Math.ceil(C.duration))},0):n.duration=0;return a.attributes=n,a.segments=c,i.base&&n.indexRange&&(a.sidx=c[0],a.segments=[]),a},CG=function(e){return e.map(EG)},da=function(e,t){return O4(e.childNodes).filter(function(i){var n=i.tagName;return n===t})},AC=function(e){return e.textContent.trim()},MG=function(e){return parseFloat(e.split("/").reduce(function(t,i){return t/i}))},$g=function(e){var t=31536e3,i=30*24*60*60,n=24*60*60,s=60*60,a=60,c=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/,h=c.exec(e);if(!h)return 0;var m=h.slice(1),v=m[0],b=m[1],x=m[2],C=m[3],B=m[4],P=m[5];return parseFloat(v||0)*t+parseFloat(b||0)*i+parseFloat(x||0)*n+parseFloat(C||0)*s+parseFloat(B||0)*a+parseFloat(P||0)},DG=function(e){var t=/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/;return t.test(e)&&(e+="Z"),Date.parse(e)},w3={mediaPresentationDuration:function(e){return $g(e)},availabilityStartTime:function(e){return DG(e)/1e3},minimumUpdatePeriod:function(e){return $g(e)},suggestedPresentationDelay:function(e){return $g(e)},type:function(e){return e},timeShiftBufferDepth:function(e){return $g(e)},start:function(e){return $g(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},frameRate:function(e){return MG(e)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},presentationTimeOffset:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?$g(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},Oo=function(e){return e&&e.attributes?O4(e.attributes).reduce(function(t,i){var n=w3[i.name]||w3.DEFAULT;return t[i.name]=n(i.value),t},{}):{}},IG={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},gS=function(e,t){return t.length?pS(e.map(function(i){return t.map(function(n){return fS(i,AC(n))})})):e},wC=function(e){var t=da(e,"SegmentTemplate")[0],i=da(e,"SegmentList")[0],n=i&&da(i,"SegmentURL").map(function(x){return ml({tag:"SegmentURL"},Oo(x))}),s=da(e,"SegmentBase")[0],a=i||t,c=a&&da(a,"SegmentTimeline")[0],h=i||s||t,m=h&&da(h,"Initialization")[0],v=t&&Oo(t);v&&m?v.initialization=m&&Oo(m):v&&v.initialization&&(v.initialization={sourceURL:v.initialization});var b={template:v,segmentTimeline:c&&da(c,"S").map(function(x){return Oo(x)}),list:i&&ml(Oo(i),{segmentUrls:n,initialization:Oo(m)}),base:s&&ml(Oo(s),{initialization:Oo(m)})};return Object.keys(b).forEach(function(x){b[x]||delete b[x]}),b},PG=function(e,t,i){return function(n){var s=da(n,"BaseURL"),a=gS(t,s),c=ml(e,Oo(n)),h=wC(n);return a.map(function(m){return{segmentInfo:ml(i,h),attributes:ml(c,{baseUrl:m})}})}},LG=function(e){return e.reduce(function(t,i){var n=Oo(i);n.schemeIdUri&&(n.schemeIdUri=n.schemeIdUri.toLowerCase());var s=IG[n.schemeIdUri];if(s){t[s]={attributes:n};var a=da(i,"cenc:pssh")[0];if(a){var c=AC(a);t[s].pssh=c&&M4(c)}}return t},{})},RG=function(e){if(e.schemeIdUri==="urn:scte:dash:cc:cea-608:2015"){var t=typeof e.value!="string"?[]:e.value.split(";");return t.map(function(n){var s,a;if(a=n,/^CC\d=/.test(n)){var c=n.split("=");s=c[0],a=c[1]}else/^CC\d$/.test(n)&&(s=n);return{channel:s,language:a}})}else if(e.schemeIdUri==="urn:scte:dash:cc:cea-708:2015"){var i=typeof e.value!="string"?[]:e.value.split(";");return i.map(function(n){var s={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(n)){var a=n.split("="),c=a[0],h=a[1],m=h===void 0?"":h;s.channel=c,s.language=n,m.split(",").forEach(function(v){var b=v.split(":"),x=b[0],C=b[1];x==="lang"?s.language=C:x==="er"?s.easyReader=Number(C):x==="war"?s.aspectRatio=Number(C):x==="3D"&&(s["3D"]=Number(C))})}else s.language=n;return s.channel&&(s.channel="SERVICE"+s.channel),s})}},kG=function(e,t,i){return function(n){var s=Oo(n),a=gS(t,da(n,"BaseURL")),c=da(n,"Role")[0],h={role:Oo(c)},m=ml(e,s,h),v=da(n,"Accessibility")[0],b=RG(Oo(v));b&&(m=ml(m,{captionServices:b}));var x=da(n,"Label")[0];if(x&&x.childNodes.length){var C=x.childNodes[0].nodeValue.trim();m=ml(m,{label:C})}var B=LG(da(n,"ContentProtection"));Object.keys(B).length&&(m=ml(m,{contentProtection:B}));var P=wC(n),N=da(n,"Representation"),ae=ml(i,P);return pS(N.map(PG(m,a,ae)))}},OG=function(e,t){return function(i,n){var s=gS(t,da(i.node,"BaseURL")),a=ml(e,{periodStart:i.attributes.start});typeof i.attributes.duration=="number"&&(a.periodDuration=i.attributes.duration);var c=da(i.node,"AdaptationSet"),h=wC(i.node);return pS(c.map(kG(a,s,h)))}},FG=function(e){var t=e.attributes,i=e.priorPeriodAttributes,n=e.mpdType;return typeof t.start=="number"?t.start:i&&typeof i.start=="number"&&typeof i.duration=="number"?i.start+i.duration:!i&&n==="static"?0:null},BG=function(e,t){t===void 0&&(t={});var i=t,n=i.manifestUri,s=n===void 0?"":n,a=i.NOW,c=a===void 0?Date.now():a,h=i.clientOffset,m=h===void 0?0:h,v=da(e,"Period");if(!v.length)throw new Error(j0.INVALID_NUMBER_OF_PERIOD);var b=da(e,"Location"),x=Oo(e),C=gS([s],da(e,"BaseURL"));x.type=x.type||"static",x.sourceDuration=x.mediaPresentationDuration||0,x.NOW=c,x.clientOffset=m,b.length&&(x.locations=b.map(AC));var B=[];return v.forEach(function(P,N){var ae=Oo(P),X=B[N-1];ae.start=FG({attributes:ae,priorPeriodAttributes:X?X.attributes:null,mpdType:x.type}),B.push({node:P,attributes:ae})}),{locations:x.locations,representationInfo:pS(B.map(OG(x,C)))}},U4=function(e){if(e==="")throw new Error(j0.DASH_EMPTY_MANIFEST);var t=new $R.DOMParser,i,n;try{i=t.parseFromString(e,"application/xml"),n=i&&i.documentElement.tagName==="MPD"?i.documentElement:null}catch{}if(!n||n&&n.getElementsByTagName("parsererror").length>0)throw new Error(j0.DASH_INVALID_XML);return n},NG=function(e){var t=da(e,"UTCTiming")[0];if(!t)return null;var i=Oo(t);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT",i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(j0.UNSUPPORTED_UTC_TIMING_SCHEME)}return i},UG=function(e,t){t===void 0&&(t={});var i=BG(U4(e),t),n=CG(i.representationInfo);return yG({dashPlaylists:n,locations:i.locations,sidxMapping:t.sidxMapping,previousManifest:t.previousManifest})},VG=function(e){return NG(U4(e))},xw,E3;function zG(){if(E3)return xw;E3=1;var r=Math.pow(2,32),e=function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),n;return i.getBigUint64?(n=i.getBigUint64(0),n<Number.MAX_SAFE_INTEGER?Number(n):n):i.getUint32(0)*r+i.getUint32(4)};return xw={getUint64:e,MAX_UINT32:r},xw}var Sw,C3;function HG(){if(C3)return Sw;C3=1;var r=zG().getUint64,e=function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8)},s=12;n.version===0?(n.earliestPresentationTime=i.getUint32(s),n.firstOffset=i.getUint32(s+4),s+=8):(n.earliestPresentationTime=r(t.subarray(s)),n.firstOffset=r(t.subarray(s+8)),s+=16),s+=2;var a=i.getUint16(s);for(s+=2;a>0;s+=12,a--)n.references.push({referenceType:(t[s]&128)>>>7,referencedSize:i.getUint32(s)&2147483647,subsegmentDuration:i.getUint32(s+4),startsWithSap:!!(t[s+8]&128),sapType:(t[s+8]&112)>>>4,sapDeltaTime:i.getUint32(s+8)&268435455});return n};return Sw=e,Sw}var jG=HG();const GG=Yu(jG);var $G=tn([73,68,51]),WG=function(e,t){t===void 0&&(t=0),e=tn(e);var i=e[t+5],n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],s=(i&16)>>4;return s?n+20:n+10},i_=function r(e,t){return t===void 0&&(t=0),e=tn(e),e.length-t<10||!Ds(e,$G,{offset:t})?t:(t+=WG(e,t),r(e,t))},M3=function(e){return typeof e=="string"?R4(e):e},qG=function(e){return Array.isArray(e)?e.map(function(t){return M3(t)}):[M3(e)]},XG=function r(e,t,i){i===void 0&&(i=!1),t=qG(t),e=tn(e);var n=[];if(!t.length)return n;for(var s=0;s<e.length;){var a=(e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3])>>>0,c=e.subarray(s+4,s+8);if(a===0)break;var h=s+a;if(h>e.length){if(i)break;h=e.length}var m=e.subarray(s+8,h);Ds(c,t[0])&&(t.length===1?n.push(m):n.push.apply(n,r(m,t.slice(1),i))),s=h}return n},iT={EBML:tn([26,69,223,163]),DocType:tn([66,130]),Segment:tn([24,83,128,103]),SegmentInfo:tn([21,73,169,102]),Tracks:tn([22,84,174,107]),Track:tn([174]),TrackNumber:tn([215]),DefaultDuration:tn([35,227,131]),TrackEntry:tn([174]),TrackType:tn([131]),FlagDefault:tn([136]),CodecID:tn([134]),CodecPrivate:tn([99,162]),VideoTrack:tn([224]),AudioTrack:tn([225]),Cluster:tn([31,67,182,117]),Timestamp:tn([231]),TimestampScale:tn([42,215,177]),BlockGroup:tn([160]),BlockDuration:tn([155]),Block:tn([161]),SimpleBlock:tn([163])},OE=[128,64,32,16,8,4,2,1],YG=function(e){for(var t=1,i=0;i<OE.length&&!(e&OE[i]);i++)t++;return t},Ax=function(e,t,i,n){i===void 0&&(i=!0),n===void 0&&(n=!1);var s=YG(e[t]),a=e.subarray(t,t+s);return i&&(a=Array.prototype.slice.call(e,t,t+s),a[0]^=OE[s-1]),{length:s,value:Wj(a,{signed:n}),bytes:a}},D3=function r(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(t){return r(t)}):typeof e=="number"?qj(e):e},QG=function(e){return Array.isArray(e)?e.map(function(t){return D3(t)}):[D3(e)]},KG=function r(e,t,i){if(i>=t.length)return t.length;var n=Ax(t,i,!1);if(Ds(e.bytes,n.bytes))return i;var s=Ax(t,i+n.length);return r(e,t,i+s.length+s.value+n.length)},I3=function r(e,t){t=QG(t),e=tn(e);var i=[];if(!t.length)return i;for(var n=0;n<e.length;){var s=Ax(e,n,!1),a=Ax(e,n+s.length),c=n+s.length+a.length;a.value===127&&(a.value=KG(s,e,c),a.value!==e.length&&(a.value-=c));var h=c+a.value>e.length?e.length:c+a.value,m=e.subarray(c,h);Ds(t[0],s.bytes)&&(t.length===1?i.push(m):i=i.concat(r(m,t.slice(1))));var v=s.length+a.length+m.length;n+=v}return i},ZG=tn([0,0,0,1]),JG=tn([0,0,1]),e$=tn([0,0,3]),t$=function(e){for(var t=[],i=1;i<e.length-2;)Ds(e.subarray(i,i+3),e$)&&(t.push(i+2),i++),i++;if(t.length===0)return e;var n=e.length-t.length,s=new Uint8Array(n),a=0;for(i=0;i<n;a++,i++)a===t[0]&&(a++,t.shift()),s[i]=e[a];return s},V4=function(e,t,i,n){e=tn(e),i=[].concat(i);for(var s=0,a,c=0;s<e.length&&(c<n||a);){var h=void 0;if(Ds(e.subarray(s),ZG)?h=4:Ds(e.subarray(s),JG)&&(h=3),!h){s++;continue}if(c++,a)return t$(e.subarray(a,s));var m=void 0;t==="h264"?m=e[s+h]&31:t==="h265"&&(m=e[s+h]>>1&63),i.indexOf(m)!==-1&&(a=s+h),s+=h+(t==="h264"?1:2)}return e.subarray(0,0)},i$=function(e,t,i){return V4(e,"h264",t,i)},n$=function(e,t,i){return V4(e,"h265",t,i)},ll={webm:tn([119,101,98,109]),matroska:tn([109,97,116,114,111,115,107,97]),flac:tn([102,76,97,67]),ogg:tn([79,103,103,83]),ac3:tn([11,119]),riff:tn([82,73,70,70]),avi:tn([65,86,73]),wav:tn([87,65,86,69]),"3gp":tn([102,116,121,112,51,103]),mp4:tn([102,116,121,112]),fmp4:tn([115,116,121,112]),mov:tn([102,116,121,112,113,116]),moov:tn([109,111,111,118]),moof:tn([109,111,111,102])},G0={aac:function(e){var t=i_(e);return Ds(e,[255,16],{offset:t,mask:[255,22]})},mp3:function(e){var t=i_(e);return Ds(e,[255,2],{offset:t,mask:[255,6]})},webm:function(e){var t=I3(e,[iT.EBML,iT.DocType])[0];return Ds(t,ll.webm)},mkv:function(e){var t=I3(e,[iT.EBML,iT.DocType])[0];return Ds(t,ll.matroska)},mp4:function(e){if(G0["3gp"](e)||G0.mov(e))return!1;if(Ds(e,ll.mp4,{offset:4})||Ds(e,ll.fmp4,{offset:4})||Ds(e,ll.moof,{offset:4})||Ds(e,ll.moov,{offset:4}))return!0},mov:function(e){return Ds(e,ll.mov,{offset:4})},"3gp":function(e){return Ds(e,ll["3gp"],{offset:4})},ac3:function(e){var t=i_(e);return Ds(e,ll.ac3,{offset:t})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var t=0;t+188<e.length&&t<188;){if(e[t]===71&&e[t+188]===71)return!0;t+=1}return!1},flac:function(e){var t=i_(e);return Ds(e,ll.flac,{offset:t})},ogg:function(e){return Ds(e,ll.ogg)},avi:function(e){return Ds(e,ll.riff)&&Ds(e,ll.avi,{offset:8})},wav:function(e){return Ds(e,ll.riff)&&Ds(e,ll.wav,{offset:8})},h264:function(e){return i$(e,7,3).length},h265:function(e){return n$(e,[32,33],3).length}},FE=Object.keys(G0).filter(function(r){return r!=="ts"&&r!=="h264"&&r!=="h265"}).concat(["ts","h264","h265"]);FE.forEach(function(r){var e=G0[r];G0[r]=function(t){return e(tn(t))}});var r$=G0,EC=function(e){e=tn(e);for(var t=0;t<FE.length;t++){var i=FE[t];if(r$[i](e))return i}return""},s$=function(e){return XG(e,["moof"]).length>0},Aw,P3;function a$(){if(P3)return Aw;P3=1;var r=9e4,e,t,i,n,s,a,c;return e=function(h){return h*r},t=function(h,m){return h*m},i=function(h){return h/r},n=function(h,m){return h/m},s=function(h,m){return e(n(h,m))},a=function(h,m){return t(i(h),m)},c=function(h,m,v){return i(v?h:h-m)},Aw={ONE_SECOND_IN_TS:r,secondsToVideoTs:e,secondsToAudioTs:t,videoTsToSeconds:i,audioTsToSeconds:n,audioTsToVideoTs:s,videoTsToAudioTs:a,metadataTsToSeconds:c},Aw}var wx=a$();function BE(r){return BE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},BE(r)}function o$(r){try{return Function.toString.call(r).indexOf("[native code]")!==-1}catch{return typeof r=="function"}}function NE(r){var e=typeof Map=="function"?new Map:void 0;return NE=function(i){if(i===null||!o$(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(i))return e.get(i);e.set(i,n)}function n(){return C4(i,arguments,BE(this).constructor)}return n.prototype=Object.create(i.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),H0(n,i)},NE(r)}/**
 * @license
 * Video.js 7.21.7 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var z4="7.21.7",yf={},Rp=function(e,t){return yf[e]=yf[e]||[],t&&(yf[e]=yf[e].concat(t)),yf[e]},l$=function(e,t){Rp(e,t)},H4=function(e,t){var i=Rp(e).indexOf(t);return i<=-1?!1:(yf[e]=yf[e].slice(),yf[e].splice(i,1),!0)},u$=function(e,t){Rp(e,[].concat(t).map(function(i){var n=function s(){return H4(e,s),i.apply(void 0,arguments)};return n}))},Ex={prefixed:!0},wT=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],L3=wT[0],n_;for(var nT=0;nT<wT.length;nT++)if(wT[nT][1]in ot){n_=wT[nT];break}if(n_){for(var rT=0;rT<n_.length;rT++)Ex[L3[rT]]=n_[rT];Ex.prefixed=n_[0]!==L3[0]}var ql=[],c$=function(e,t){return function(i,n,s){var a=t.levels[n],c=new RegExp("^("+a+")$");if(i!=="log"&&s.unshift(i.toUpperCase()+":"),s.unshift(e+":"),ql){ql.push([].concat(s));var h=ql.length-1e3;ql.splice(0,h>0?h:0)}if(Z.console){var m=Z.console[i];!m&&i==="debug"&&(m=Z.console.info||Z.console.log),!(!m||!a||!c.test(i))&&m[Array.isArray(s)?"apply":"call"](Z.console,s)}}};function j4(r){var e="info",t,i=function(){for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];t("log",e,a)};return t=c$(r,i),i.createLogger=function(n){return j4(r+": "+n)},i.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:e},i.level=function(n){if(typeof n=="string"){if(!i.levels.hasOwnProperty(n))throw new Error('"'+n+'" in not a valid log level');e=n}return e},i.history=function(){return ql?[].concat(ql):[]},i.history.filter=function(n){return(ql||[]).filter(function(s){return new RegExp(".*"+n+".*").test(s[0])})},i.history.clear=function(){ql&&(ql.length=0)},i.history.disable=function(){ql!==null&&(ql.length=0,ql=null)},i.history.enable=function(){ql===null&&(ql=[])},i.error=function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t("error",e,s)},i.warn=function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t("warn",e,s)},i.debug=function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t("debug",e,s)},i}var qn=j4("VIDEOJS"),G4=qn.createLogger,d$=Object.prototype.toString,$4=function(e){return Ef(e)?Object.keys(e):[]};function S0(r,e){$4(r).forEach(function(t){return e(r[t],t)})}function h$(r,e,t){return t===void 0&&(t=0),$4(r).reduce(function(i,n){return e(i,r[n],n)},t)}function Ks(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return Object.assign?zr.apply(void 0,[r].concat(t)):(t.forEach(function(n){n&&S0(n,function(s,a){r[a]=s})}),r)}function Ef(r){return!!r&&typeof r=="object"}function L_(r){return Ef(r)&&d$.call(r)==="[object Object]"&&r.constructor===Object}function R_(r,e){if(!r||!e)return"";if(typeof Z.getComputedStyle=="function"){var t;try{t=Z.getComputedStyle(r)}catch{return""}return t?t.getPropertyValue(e)||t[e]:""}return""}var eo=Z.navigator&&Z.navigator.userAgent||"",R3=/AppleWebKit\/([\d.]+)/i.exec(eo),f$=R3?parseFloat(R3.pop()):null,W4=/iPod/i.test(eo),p$=function(){var r=eo.match(/OS (\d+)_/i);return r&&r[1]?r[1]:null}(),Pf=/Android/i.test(eo),CC=function(){var r=eo.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!r)return null;var e=r[1]&&parseFloat(r[1]),t=r[2]&&parseFloat(r[2]);return e&&t?parseFloat(r[1]+"."+r[2]):e||null}(),q4=Pf&&CC<5&&f$<537,X4=/Firefox/i.test(eo),Q_=/Edg/i.test(eo),Lf=!Q_&&(/Chrome/i.test(eo)||/CriOS/i.test(eo)),Y4=function(){var r=eo.match(/(Chrome|CriOS)\/(\d+)/);return r&&r[2]?parseFloat(r[2]):null}(),K_=function(){var r=/MSIE\s(\d+)\.\d/.exec(eo),e=r&&parseFloat(r[1]);return!e&&/Trident\/7.0/i.test(eo)&&/rv:11.0/.test(eo)&&(e=11),e}(),MC=/Safari/i.test(eo)&&!Lf&&!Pf&&!Q_,Q4=/Windows/i.test(eo),$0=!!(lv()&&("ontouchstart"in Z||Z.navigator.maxTouchPoints||Z.DocumentTouch&&Z.document instanceof Z.DocumentTouch)),DC=/iPad/i.test(eo)||MC&&$0&&!/iPhone/i.test(eo),IC=/iPhone/i.test(eo)&&!DC,yl=IC||DC||W4,vS=(MC||yl)&&!Lf,m$=Object.freeze({__proto__:null,IS_IPOD:W4,IOS_VERSION:p$,IS_ANDROID:Pf,ANDROID_VERSION:CC,IS_NATIVE_ANDROID:q4,IS_FIREFOX:X4,IS_EDGE:Q_,IS_CHROME:Lf,CHROME_VERSION:Y4,IE_VERSION:K_,IS_SAFARI:MC,IS_WINDOWS:Q4,TOUCH_ENABLED:$0,IS_IPAD:DC,IS_IPHONE:IC,IS_IOS:yl,IS_ANY_SAFARI:vS});function k3(r){return typeof r=="string"&&!!r.trim()}function K4(r){if(r.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function g$(r){return new RegExp("(^|\\s)"+r+"($|\\s)")}function lv(){return ot===Z.document}function uv(r){return Ef(r)&&r.nodeType===1}function Z4(){try{return Z.parent!==Z.self}catch{return!0}}function J4(r){return function(e,t){if(!k3(e))return ot[r](null);k3(t)&&(t=ot.querySelector(t));var i=uv(t)?t:ot;return i[r]&&i[r](e)}}function xr(r,e,t,i){r===void 0&&(r="div"),e===void 0&&(e={}),t===void 0&&(t={});var n=ot.createElement(r);return Object.getOwnPropertyNames(e).forEach(function(s){var a=e[s];s.indexOf("aria-")!==-1||s==="role"||s==="type"?(qn.warn(`Setting attributes in the second argument of createEl()
has been deprecated. Use the third argument instead.
`+("createEl(type, properties, attributes). Attempting to set "+s+" to "+a+".")),n.setAttribute(s,a)):s==="textContent"?eg(n,a):(n[s]!==a||s==="tabIndex")&&(n[s]=a)}),Object.getOwnPropertyNames(t).forEach(function(s){n.setAttribute(s,t[s])}),i&&LC(n,i),n}function eg(r,e){return typeof r.textContent>"u"?r.innerText=e:r.textContent=e,r}function UE(r,e){e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}function qm(r,e){return K4(e),r.classList?r.classList.contains(e):g$(e).test(r.className)}function Sf(r,e){return r.classList?r.classList.add(e):qm(r,e)||(r.className=(r.className+" "+e).trim()),r}function Z_(r,e){return r?(r.classList?r.classList.remove(e):(K4(e),r.className=r.className.split(/\s+/).filter(function(t){return t!==e}).join(" ")),r):(qn.warn("removeClass was called with an element that doesn't exist"),null)}function eF(r,e,t){var i=qm(r,e);if(typeof t=="function"&&(t=t(r,e)),typeof t!="boolean"&&(t=!i),t!==i)return t?Sf(r,e):Z_(r,e),r}function tF(r,e){Object.getOwnPropertyNames(e).forEach(function(t){var i=e[t];i===null||typeof i>"u"||i===!1?r.removeAttribute(t):r.setAttribute(t,i===!0?"":i)})}function ff(r){var e={},t=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(r&&r.attributes&&r.attributes.length>0)for(var i=r.attributes,n=i.length-1;n>=0;n--){var s=i[n].name,a=i[n].value;(typeof r[s]=="boolean"||t.indexOf(","+s+",")!==-1)&&(a=a!==null),e[s]=a}return e}function iF(r,e){return r.getAttribute(e)}function W0(r,e,t){r.setAttribute(e,t)}function yS(r,e){r.removeAttribute(e)}function nF(){ot.body.focus(),ot.onselectstart=function(){return!1}}function rF(){ot.onselectstart=function(){return!0}}function q0(r){if(r&&r.getBoundingClientRect&&r.parentNode){var e=r.getBoundingClientRect(),t={};return["bottom","height","left","right","top","width"].forEach(function(i){e[i]!==void 0&&(t[i]=e[i])}),t.height||(t.height=parseFloat(R_(r,"height"))),t.width||(t.width=parseFloat(R_(r,"width"))),t}}function k_(r){if(!r||r&&!r.offsetParent)return{left:0,top:0,width:0,height:0};for(var e=r.offsetWidth,t=r.offsetHeight,i=0,n=0;r.offsetParent&&r!==ot[Ex.fullscreenElement];)i+=r.offsetLeft,n+=r.offsetTop,r=r.offsetParent;return{left:i,top:n,width:e,height:t}}function _S(r,e){var t={x:0,y:0};if(yl)for(var i=r;i&&i.nodeName.toLowerCase()!=="html";){var n=R_(i,"transform");if(/^matrix/.test(n)){var s=n.slice(7,-1).split(/,\s/).map(Number);t.x+=s[4],t.y+=s[5]}else if(/^matrix3d/.test(n)){var a=n.slice(9,-1).split(/,\s/).map(Number);t.x+=a[12],t.y+=a[13]}i=i.parentNode}var c={},h=k_(e.target),m=k_(r),v=m.width,b=m.height,x=e.offsetY-(m.top-h.top),C=e.offsetX-(m.left-h.left);return e.changedTouches&&(C=e.changedTouches[0].pageX-m.left,x=e.changedTouches[0].pageY+m.top,yl&&(C-=t.x,x-=t.y)),c.y=1-Math.max(0,Math.min(1,x/b)),c.x=Math.max(0,Math.min(1,C/v)),c}function sF(r){return Ef(r)&&r.nodeType===3}function PC(r){for(;r.firstChild;)r.removeChild(r.firstChild);return r}function aF(r){return typeof r=="function"&&(r=r()),(Array.isArray(r)?r:[r]).map(function(e){if(typeof e=="function"&&(e=e()),uv(e)||sF(e))return e;if(typeof e=="string"&&/\S/.test(e))return ot.createTextNode(e)}).filter(function(e){return e})}function LC(r,e){return aF(e).forEach(function(t){return r.appendChild(t)}),r}function oF(r,e){return LC(PC(r),e)}function O_(r){return r.button===void 0&&r.buttons===void 0||r.button===0&&r.buttons===void 0||r.type==="mouseup"&&r.button===0&&r.buttons===0?!0:!(r.button!==0||r.buttons!==1)}var kp=J4("querySelector"),lF=J4("querySelectorAll"),uF=Object.freeze({__proto__:null,isReal:lv,isEl:uv,isInFrame:Z4,createEl:xr,textContent:eg,prependTo:UE,hasClass:qm,addClass:Sf,removeClass:Z_,toggleClass:eF,setAttributes:tF,getAttributes:ff,getAttribute:iF,setAttribute:W0,removeAttribute:yS,blockTextSelection:nF,unblockTextSelection:rF,getBoundingClientRect:q0,findPosition:k_,getPointerPosition:_S,isTextNode:sF,emptyEl:PC,normalizeContent:aF,appendContent:LC,insertContent:oF,isSingleLeftClick:O_,$:kp,$$:lF}),cF=!1,VE,v$=function(){if(VE.options.autoSetup!==!1){var e=Array.prototype.slice.call(ot.getElementsByTagName("video")),t=Array.prototype.slice.call(ot.getElementsByTagName("audio")),i=Array.prototype.slice.call(ot.getElementsByTagName("video-js")),n=e.concat(t,i);if(n&&n.length>0)for(var s=0,a=n.length;s<a;s++){var c=n[s];if(c&&c.getAttribute){if(c.player===void 0){var h=c.getAttribute("data-setup");h!==null&&VE(c)}}else{zE(1);break}}else cF||zE(1)}};function zE(r,e){lv()&&(e&&(VE=e),Z.setTimeout(v$,r))}function HE(){cF=!0,Z.removeEventListener("load",HE)}lv()&&(ot.readyState==="complete"?HE():Z.addEventListener("load",HE));var dF=function(e){var t=ot.createElement("style");return t.className=e,t},hF=function(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t},y$=3,_$=y$;function Rf(){return _$++}var fF;Z.WeakMap||(fF=function(){function r(){this.vdata="vdata"+Math.floor(Z.performance&&Z.performance.now()||Date.now()),this.data={}}var e=r.prototype;return e.set=function(i,n){var s=i[this.vdata]||Rf();return i[this.vdata]||(i[this.vdata]=s),this.data[s]=n,this},e.get=function(i){var n=i[this.vdata];if(n)return this.data[n];qn("We have no data for this element",i)},e.has=function(i){var n=i[this.vdata];return n in this.data},e.delete=function(i){var n=i[this.vdata];n&&(delete this.data[n],delete i[this.vdata])},r}());var gl=Z.WeakMap?new WeakMap:new fF;function O3(r,e){if(gl.has(r)){var t=gl.get(r);t.handlers[e].length===0&&(delete t.handlers[e],r.removeEventListener?r.removeEventListener(e,t.dispatcher,!1):r.detachEvent&&r.detachEvent("on"+e,t.dispatcher)),Object.getOwnPropertyNames(t.handlers).length<=0&&(delete t.handlers,delete t.dispatcher,delete t.disabled),Object.getOwnPropertyNames(t).length===0&&gl.delete(r)}}function RC(r,e,t,i){t.forEach(function(n){r(e,n,i)})}function bS(r){if(r.fixed_)return r;function e(){return!0}function t(){return!1}if(!r||!r.isPropagationStopped||!r.isImmediatePropagationStopped){var i=r||Z.event;r={};for(var n in i)n!=="layerX"&&n!=="layerY"&&n!=="keyLocation"&&n!=="webkitMovementX"&&n!=="webkitMovementY"&&n!=="path"&&(n==="returnValue"&&i.preventDefault||(r[n]=i[n]));if(r.target||(r.target=r.srcElement||ot),r.relatedTarget||(r.relatedTarget=r.fromElement===r.target?r.toElement:r.fromElement),r.preventDefault=function(){i.preventDefault&&i.preventDefault(),r.returnValue=!1,i.returnValue=!1,r.defaultPrevented=!0},r.defaultPrevented=!1,r.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),r.cancelBubble=!0,i.cancelBubble=!0,r.isPropagationStopped=e},r.isPropagationStopped=t,r.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),r.isImmediatePropagationStopped=e,r.stopPropagation()},r.isImmediatePropagationStopped=t,r.clientX!==null&&r.clientX!==void 0){var s=ot.documentElement,a=ot.body;r.pageX=r.clientX+(s&&s.scrollLeft||a&&a.scrollLeft||0)-(s&&s.clientLeft||a&&a.clientLeft||0),r.pageY=r.clientY+(s&&s.scrollTop||a&&a.scrollTop||0)-(s&&s.clientTop||a&&a.clientTop||0)}r.which=r.charCode||r.keyCode,r.button!==null&&r.button!==void 0&&(r.button=r.button&1?0:r.button&4?1:r.button&2?2:0)}return r.fixed_=!0,r}var sT,b$=function(){if(typeof sT!="boolean"){sT=!1;try{var e=Object.defineProperty({},"passive",{get:function(){sT=!0}});Z.addEventListener("test",null,e),Z.removeEventListener("test",null,e)}catch{}}return sT},T$=["touchstart","touchmove"];function Xu(r,e,t){if(Array.isArray(e))return RC(Xu,r,e,t);gl.has(r)||gl.set(r,{});var i=gl.get(r);if(i.handlers||(i.handlers={}),i.handlers[e]||(i.handlers[e]=[]),t.guid||(t.guid=Rf()),i.handlers[e].push(t),i.dispatcher||(i.disabled=!1,i.dispatcher=function(s,a){if(!i.disabled){s=bS(s);var c=i.handlers[s.type];if(c)for(var h=c.slice(0),m=0,v=h.length;m<v&&!s.isImmediatePropagationStopped();m++)try{h[m].call(r,s,a)}catch(b){qn.error(b)}}}),i.handlers[e].length===1)if(r.addEventListener){var n=!1;b$()&&T$.indexOf(e)>-1&&(n={passive:!0}),r.addEventListener(e,i.dispatcher,n)}else r.attachEvent&&r.attachEvent("on"+e,i.dispatcher)}function Uo(r,e,t){if(gl.has(r)){var i=gl.get(r);if(i.handlers){if(Array.isArray(e))return RC(Uo,r,e,t);var n=function(m,v){i.handlers[v]=[],O3(m,v)};if(e===void 0){for(var s in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},s)&&n(r,s);return}var a=i.handlers[e];if(a){if(!t){n(r,e);return}if(t.guid)for(var c=0;c<a.length;c++)a[c].guid===t.guid&&a.splice(c--,1);O3(r,e)}}}}function cv(r,e,t){var i=gl.has(r)?gl.get(r):{},n=r.parentNode||r.ownerDocument;if(typeof e=="string"?e={type:e,target:r}:e.target||(e.target=r),e=bS(e),i.dispatcher&&i.dispatcher.call(r,e,t),n&&!e.isPropagationStopped()&&e.bubbles===!0)cv.call(null,n,e,t);else if(!n&&!e.defaultPrevented&&e.target&&e.target[e.type]){gl.has(e.target)||gl.set(e.target,{});var s=gl.get(e.target);e.target[e.type]&&(s.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),s.disabled=!1)}return!e.defaultPrevented}function TS(r,e,t){if(Array.isArray(e))return RC(TS,r,e,t);var i=function n(){Uo(r,e,n),t.apply(this,arguments)};i.guid=t.guid=t.guid||Rf(),Xu(r,e,i)}function pF(r,e,t){var i=function n(){Uo(r,e,n),t.apply(this,arguments)};i.guid=t.guid=t.guid||Rf(),Xu(r,e,i)}var x$=Object.freeze({__proto__:null,fixEvent:bS,on:Xu,off:Uo,trigger:cv,one:TS,any:pF}),Zc=30,ys=function(e,t,i){t.guid||(t.guid=Rf());var n=t.bind(e);return n.guid=i?i+"_"+t.guid:t.guid,n},Cf=function(e,t){var i=Z.performance.now(),n=function(){var a=Z.performance.now();a-i>=t&&(e.apply(void 0,arguments),i=a)};return n},S$=function(e,t,i,n){n===void 0&&(n=Z);var s,a=function(){n.clearTimeout(s),s=null},c=function(){var m=this,v=arguments,b=function(){s=null,b=null,e.apply(m,v)};n.clearTimeout(s),s=n.setTimeout(b,t)};return c.cancel=a,c},to=function(){};to.prototype.allowedEvents_={};to.prototype.on=function(r,e){var t=this.addEventListener;this.addEventListener=function(){},Xu(this,r,e),this.addEventListener=t};to.prototype.addEventListener=to.prototype.on;to.prototype.off=function(r,e){Uo(this,r,e)};to.prototype.removeEventListener=to.prototype.off;to.prototype.one=function(r,e){var t=this.addEventListener;this.addEventListener=function(){},TS(this,r,e),this.addEventListener=t};to.prototype.any=function(r,e){var t=this.addEventListener;this.addEventListener=function(){},pF(this,r,e),this.addEventListener=t};to.prototype.trigger=function(r){var e=r.type||r;typeof r=="string"&&(r={type:e}),r=bS(r),this.allowedEvents_[e]&&this["on"+e]&&this["on"+e](r),cv(this,r)};to.prototype.dispatchEvent=to.prototype.trigger;var $y;to.prototype.queueTrigger=function(r){var e=this;$y||($y=new Map);var t=r.type||r,i=$y.get(this);i||(i=new Map,$y.set(this,i));var n=i.get(t);i.delete(t),Z.clearTimeout(n);var s=Z.setTimeout(function(){i.delete(t),i.size===0&&(i=null,$y.delete(e)),e.trigger(r)},0);i.set(t,s)};var xS=function(e){return typeof e.name=="function"?e.name():typeof e.name=="string"?e.name:e.name_?e.name_:e.constructor&&e.constructor.name?e.constructor.name:typeof e},Af=function(e){return e instanceof to||!!e.eventBusEl_&&["on","one","off","trigger"].every(function(t){return typeof e[t]=="function"})},A$=function(e,t){Af(e)?t():(e.eventedCallbacks||(e.eventedCallbacks=[]),e.eventedCallbacks.push(t))},jE=function(e){return typeof e=="string"&&/\S/.test(e)||Array.isArray(e)&&!!e.length},Cx=function(e,t,i){if(!e||!e.nodeName&&!Af(e))throw new Error("Invalid target for "+xS(t)+"#"+i+"; must be a DOM node or evented object.")},mF=function(e,t,i){if(!jE(e))throw new Error("Invalid event type for "+xS(t)+"#"+i+"; must be a non-empty string or array.")},gF=function(e,t,i){if(typeof e!="function")throw new Error("Invalid listener for "+xS(t)+"#"+i+"; must be a function.")},ww=function(e,t,i){var n=t.length<3||t[0]===e||t[0]===e.eventBusEl_,s,a,c;return n?(s=e.eventBusEl_,t.length>=3&&t.shift(),a=t[0],c=t[1]):(s=t[0],a=t[1],c=t[2]),Cx(s,e,i),mF(a,e,i),gF(c,e,i),c=ys(e,c),{isTargetingSelf:n,target:s,type:a,listener:c}},Tm=function(e,t,i,n){Cx(e,e,t),e.nodeName?x$[t](e,i,n):e[t](i,n)},w$={on:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];var s=ww(this,i,"on"),a=s.isTargetingSelf,c=s.target,h=s.type,m=s.listener;if(Tm(c,"on",h,m),!a){var v=function(){return e.off(c,h,m)};v.guid=m.guid;var b=function(){return e.off("dispose",v)};b.guid=m.guid,Tm(this,"on","dispose",v),Tm(c,"on","dispose",b)}},one:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];var s=ww(this,i,"one"),a=s.isTargetingSelf,c=s.target,h=s.type,m=s.listener;if(a)Tm(c,"one",h,m);else{var v=function b(){e.off(c,h,b);for(var x=arguments.length,C=new Array(x),B=0;B<x;B++)C[B]=arguments[B];m.apply(null,C)};v.guid=m.guid,Tm(c,"one",h,v)}},any:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];var s=ww(this,i,"any"),a=s.isTargetingSelf,c=s.target,h=s.type,m=s.listener;if(a)Tm(c,"any",h,m);else{var v=function b(){e.off(c,h,b);for(var x=arguments.length,C=new Array(x),B=0;B<x;B++)C[B]=arguments[B];m.apply(null,C)};v.guid=m.guid,Tm(c,"any",h,v)}},off:function(e,t,i){if(!e||jE(e))Uo(this.eventBusEl_,e,t);else{var n=e,s=t;Cx(n,this,"off"),mF(s,this,"off"),gF(i,this,"off"),i=ys(this,i),this.off("dispose",i),n.nodeName?(Uo(n,s,i),Uo(n,"dispose",i)):Af(n)&&(n.off(s,i),n.off("dispose",i))}},trigger:function(e,t){Cx(this.eventBusEl_,this,"trigger");var i=e&&typeof e!="string"?e.type:e;if(!jE(i)){var n="Invalid event type for "+xS(this)+"#trigger; must be a non-empty string or object with a type key that has a non-empty value.";if(e)(this.log||qn).error(n);else throw new Error(n)}return cv(this.eventBusEl_,e,t)}};function kC(r,e){e===void 0&&(e={});var t=e,i=t.eventBusKey;if(i){if(!r[i].nodeName)throw new Error('The eventBusKey "'+i+'" does not refer to an element.');r.eventBusEl_=r[i]}else r.eventBusEl_=xr("span",{className:"vjs-event-bus"});return Ks(r,w$),r.eventedCallbacks&&r.eventedCallbacks.forEach(function(n){n()}),r.on("dispose",function(){r.off(),[r,r.el_,r.eventBusEl_].forEach(function(n){n&&gl.has(n)&&gl.delete(n)}),Z.setTimeout(function(){r.eventBusEl_=null},0)}),r}var E$={state:{},setState:function(e){var t=this;typeof e=="function"&&(e=e());var i;return S0(e,function(n,s){t.state[s]!==n&&(i=i||{},i[s]={from:t.state[s],to:n}),t.state[s]=n}),i&&Af(this)&&this.trigger({changes:i,type:"statechanged"}),i}};function vF(r,e){return Ks(r,E$),r.state=Ks({},r.state,e),typeof r.handleStateChanged=="function"&&Af(r)&&r.on("statechanged",r.handleStateChanged),r}var ET=function(e){return typeof e!="string"?e:e.replace(/./,function(t){return t.toLowerCase()})},ha=function(e){return typeof e!="string"?e:e.replace(/./,function(t){return t.toUpperCase()})},C$=function(e,t){return ha(e)===ha(t)};function vs(){for(var r={},e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.forEach(function(n){n&&S0(n,function(s,a){if(!L_(s)){r[a]=s;return}L_(r[a])||(r[a]={}),r[a]=vs(r[a],s)})}),r}var M$=function(){function r(){this.map_={}}var e=r.prototype;return e.has=function(i){return i in this.map_},e.delete=function(i){var n=this.has(i);return delete this.map_[i],n},e.set=function(i,n){return this.map_[i]=n,this},e.forEach=function(i,n){for(var s in this.map_)i.call(n,this.map_[s],s,this)},r}(),D$=Z.Map?Z.Map:M$,I$=function(){function r(){this.set_={}}var e=r.prototype;return e.has=function(i){return i in this.set_},e.delete=function(i){var n=this.has(i);return delete this.set_[i],n},e.add=function(i){return this.set_[i]=1,this},e.forEach=function(i,n){for(var s in this.set_)i.call(n,s,s,this)},r}(),Ew=Z.Set?Z.Set:I$,ei=function(){function r(t,i,n){var s=this;if(!t&&this.play?this.player_=t=this:this.player_=t,this.isDisposed_=!1,this.parentComponent_=null,this.options_=vs({},this.options_),i=this.options_=vs(this.options_,i),this.id_=i.id||i.el&&i.el.id,!this.id_){var a=t&&t.id&&t.id()||"no_player";this.id_=a+"_component_"+Rf()}this.name_=i.name||null,i.el?this.el_=i.el:i.createEl!==!1&&(this.el_=this.createEl()),i.className&&this.el_&&i.className.split(" ").forEach(function(c){return s.addClass(c)}),i.evented!==!1&&(kC(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),vF(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Ew,this.setIntervalIds_=new Ew,this.rafIds_=new Ew,this.namedRafs_=new D$,this.clearingTimersOnDispose_=!1,i.initChildren!==!1&&this.initChildren(),this.ready(n),i.reportTouchActivity!==!1&&this.enableTouchActivity()}var e=r.prototype;return e.dispose=function(i){if(i===void 0&&(i={}),!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var n=this.children_.length-1;n>=0;n--)this.children_[n].dispose&&this.children_[n].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(i.restoreEl?this.el_.parentNode.replaceChild(i.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}},e.isDisposed=function(){return!!this.isDisposed_},e.player=function(){return this.player_},e.options=function(i){return i?(this.options_=vs(this.options_,i),this.options_):this.options_},e.el=function(){return this.el_},e.createEl=function(i,n,s){return xr(i,n,s)},e.localize=function(i,n,s){s===void 0&&(s=i);var a=this.player_.language&&this.player_.language(),c=this.player_.languages&&this.player_.languages(),h=c&&c[a],m=a&&a.split("-")[0],v=c&&c[m],b=s;return h&&h[i]?b=h[i]:v&&v[i]&&(b=v[i]),n&&(b=b.replace(/\{(\d+)\}/g,function(x,C){var B=n[C-1],P=B;return typeof B>"u"&&(P=x),P})),b},e.handleLanguagechange=function(){},e.contentEl=function(){return this.contentEl_||this.el_},e.id=function(){return this.id_},e.name=function(){return this.name_},e.children=function(){return this.children_},e.getChildById=function(i){return this.childIndex_[i]},e.getChild=function(i){if(i)return this.childNameIndex_[i]},e.getDescendant=function(){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];n=n.reduce(function(h,m){return h.concat(m)},[]);for(var a=this,c=0;c<n.length;c++)if(a=a.getChild(n[c]),!a||!a.getChild)return;return a},e.addChild=function(i,n,s){n===void 0&&(n={}),s===void 0&&(s=this.children_.length);var a,c;if(typeof i=="string"){c=ha(i);var h=n.componentClass||c;n.name=c;var m=r.getComponent(h);if(!m)throw new Error("Component "+h+" does not exist");if(typeof m!="function")return null;a=new m(this.player_||this,n)}else a=i;if(a.parentComponent_&&a.parentComponent_.removeChild(a),this.children_.splice(s,0,a),a.parentComponent_=this,typeof a.id=="function"&&(this.childIndex_[a.id()]=a),c=c||a.name&&ha(a.name()),c&&(this.childNameIndex_[c]=a,this.childNameIndex_[ET(c)]=a),typeof a.el=="function"&&a.el()){var v=null;this.children_[s+1]&&(this.children_[s+1].el_?v=this.children_[s+1].el_:uv(this.children_[s+1])&&(v=this.children_[s+1])),this.contentEl().insertBefore(a.el(),v)}return a},e.removeChild=function(i){if(typeof i=="string"&&(i=this.getChild(i)),!(!i||!this.children_)){for(var n=!1,s=this.children_.length-1;s>=0;s--)if(this.children_[s]===i){n=!0,this.children_.splice(s,1);break}if(n){i.parentComponent_=null,this.childIndex_[i.id()]=null,this.childNameIndex_[ha(i.name())]=null,this.childNameIndex_[ET(i.name())]=null;var a=i.el();a&&a.parentNode===this.contentEl()&&this.contentEl().removeChild(i.el())}}},e.initChildren=function(){var i=this,n=this.options_.children;if(n){var s=this.options_,a=function(v){var b=v.name,x=v.opts;if(s[b]!==void 0&&(x=s[b]),x!==!1){x===!0&&(x={}),x.playerOptions=i.options_.playerOptions;var C=i.addChild(b,x);C&&(i[b]=C)}},c,h=r.getComponent("Tech");Array.isArray(n)?c=n:c=Object.keys(n),c.concat(Object.keys(this.options_).filter(function(m){return!c.some(function(v){return typeof v=="string"?m===v:m===v.name})})).map(function(m){var v,b;return typeof m=="string"?(v=m,b=n[v]||i.options_[v]||{}):(v=m.name,b=m),{name:v,opts:b}}).filter(function(m){var v=r.getComponent(m.opts.componentClass||ha(m.name));return v&&!h.isTech(v)}).forEach(a)}},e.buildCSSClass=function(){return""},e.ready=function(i,n){if(n===void 0&&(n=!1),!!i){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(i);return}n?i.call(this):this.setTimeout(i,1)}},e.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var i=this.readyQueue_;this.readyQueue_=[],i&&i.length>0&&i.forEach(function(n){n.call(this)},this),this.trigger("ready")},1)},e.$=function(i,n){return kp(i,n||this.contentEl())},e.$$=function(i,n){return lF(i,n||this.contentEl())},e.hasClass=function(i){return qm(this.el_,i)},e.addClass=function(i){Sf(this.el_,i)},e.removeClass=function(i){Z_(this.el_,i)},e.toggleClass=function(i,n){eF(this.el_,i,n)},e.show=function(){this.removeClass("vjs-hidden")},e.hide=function(){this.addClass("vjs-hidden")},e.lockShowing=function(){this.addClass("vjs-lock-showing")},e.unlockShowing=function(){this.removeClass("vjs-lock-showing")},e.getAttribute=function(i){return iF(this.el_,i)},e.setAttribute=function(i,n){W0(this.el_,i,n)},e.removeAttribute=function(i){yS(this.el_,i)},e.width=function(i,n){return this.dimension("width",i,n)},e.height=function(i,n){return this.dimension("height",i,n)},e.dimensions=function(i,n){this.width(i,!0),this.height(n)},e.dimension=function(i,n,s){if(n!==void 0){(n===null||n!==n)&&(n=0),(""+n).indexOf("%")!==-1||(""+n).indexOf("px")!==-1?this.el_.style[i]=n:n==="auto"?this.el_.style[i]="":this.el_.style[i]=n+"px",s||this.trigger("componentresize");return}if(!this.el_)return 0;var a=this.el_.style[i],c=a.indexOf("px");return parseInt(c!==-1?a.slice(0,c):this.el_["offset"+ha(i)],10)},e.currentDimension=function(i){var n=0;if(i!=="width"&&i!=="height")throw new Error("currentDimension only accepts width or height value");if(n=R_(this.el_,i),n=parseFloat(n),n===0||isNaN(n)){var s="offset"+ha(i);n=this.el_[s]}return n},e.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},e.currentWidth=function(){return this.currentDimension("width")},e.currentHeight=function(){return this.currentDimension("height")},e.focus=function(){this.el_.focus()},e.blur=function(){this.el_.blur()},e.handleKeyDown=function(i){this.player_&&(wn.isEventKey(i,"Tab")||i.stopPropagation(),this.player_.handleKeyDown(i))},e.handleKeyPress=function(i){this.handleKeyDown(i)},e.emitTapEvents=function(){var i=0,n=null,s=10,a=200,c;this.on("touchstart",function(m){m.touches.length===1&&(n={pageX:m.touches[0].pageX,pageY:m.touches[0].pageY},i=Z.performance.now(),c=!0)}),this.on("touchmove",function(m){if(m.touches.length>1)c=!1;else if(n){var v=m.touches[0].pageX-n.pageX,b=m.touches[0].pageY-n.pageY,x=Math.sqrt(v*v+b*b);x>s&&(c=!1)}});var h=function(){c=!1};this.on("touchleave",h),this.on("touchcancel",h),this.on("touchend",function(m){if(n=null,c===!0){var v=Z.performance.now()-i;v<a&&(m.preventDefault(),this.trigger("tap"))}})},e.enableTouchActivity=function(){if(!(!this.player()||!this.player().reportUserActivity)){var i=ys(this.player(),this.player().reportUserActivity),n;this.on("touchstart",function(){i(),this.clearInterval(n),n=this.setInterval(i,250)});var s=function(c){i(),this.clearInterval(n)};this.on("touchmove",i),this.on("touchend",s),this.on("touchcancel",s)}},e.setTimeout=function(i,n){var s=this,a;return i=ys(this,i),this.clearTimersOnDispose_(),a=Z.setTimeout(function(){s.setTimeoutIds_.has(a)&&s.setTimeoutIds_.delete(a),i()},n),this.setTimeoutIds_.add(a),a},e.clearTimeout=function(i){return this.setTimeoutIds_.has(i)&&(this.setTimeoutIds_.delete(i),Z.clearTimeout(i)),i},e.setInterval=function(i,n){i=ys(this,i),this.clearTimersOnDispose_();var s=Z.setInterval(i,n);return this.setIntervalIds_.add(s),s},e.clearInterval=function(i){return this.setIntervalIds_.has(i)&&(this.setIntervalIds_.delete(i),Z.clearInterval(i)),i},e.requestAnimationFrame=function(i){var n=this;if(!this.supportsRaf_)return this.setTimeout(i,1e3/60);this.clearTimersOnDispose_();var s;return i=ys(this,i),s=Z.requestAnimationFrame(function(){n.rafIds_.has(s)&&n.rafIds_.delete(s),i()}),this.rafIds_.add(s),s},e.requestNamedAnimationFrame=function(i,n){var s=this;if(!this.namedRafs_.has(i)){this.clearTimersOnDispose_(),n=ys(this,n);var a=this.requestAnimationFrame(function(){n(),s.namedRafs_.has(i)&&s.namedRafs_.delete(i)});return this.namedRafs_.set(i,a),i}},e.cancelNamedAnimationFrame=function(i){this.namedRafs_.has(i)&&(this.cancelAnimationFrame(this.namedRafs_.get(i)),this.namedRafs_.delete(i))},e.cancelAnimationFrame=function(i){return this.supportsRaf_?(this.rafIds_.has(i)&&(this.rafIds_.delete(i),Z.cancelAnimationFrame(i)),i):this.clearTimeout(i)},e.clearTimersOnDispose_=function(){var i=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(n){var s=n[0],a=n[1];i[s].forEach(function(c,h){return i[a](h)})}),i.clearingTimersOnDispose_=!1}))},r.registerComponent=function(i,n){if(typeof i!="string"||!i)throw new Error('Illegal component name, "'+i+'"; must be a non-empty string.');var s=r.getComponent("Tech"),a=s&&s.isTech(n),c=r===n||r.prototype.isPrototypeOf(n.prototype);if(a||!c){var h;throw a?h="techs must be registered using Tech.registerTech()":h="must be a Component subclass",new Error('Illegal component, "'+i+'"; '+h+".")}i=ha(i),r.components_||(r.components_={});var m=r.getComponent("Player");if(i==="Player"&&m&&m.players){var v=m.players,b=Object.keys(v);if(v&&b.length>0&&b.map(function(x){return v[x]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return r.components_[i]=n,r.components_[ET(i)]=n,n},r.getComponent=function(i){if(!(!i||!r.components_))return r.components_[i]},r}();ei.prototype.supportsRaf_=typeof Z.requestAnimationFrame=="function"&&typeof Z.cancelAnimationFrame=="function";ei.registerComponent("Component",ei);function P$(r,e,t){if(typeof e!="number"||e<0||e>t)throw new Error("Failed to execute '"+r+"' on 'TimeRanges': The index provided ("+e+") is non-numeric or out of bounds (0-"+t+").")}function F3(r,e,t,i){return P$(r,i,t.length-1),t[i][e]}function Cw(r){var e;return r===void 0||r.length===0?e={length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:e={length:r.length,start:F3.bind(null,"start",0,r),end:F3.bind(null,"end",1,r)},Z.Symbol&&Z.Symbol.iterator&&(e[Z.Symbol.iterator]=function(){return(r||[]).values()}),e}function Xm(r,e){return Array.isArray(r)?Cw(r):r===void 0||e===void 0?Cw():Cw([[r,e]])}function yF(r,e){var t=0,i,n;if(!e)return 0;(!r||!r.length)&&(r=Xm(0,0));for(var s=0;s<r.length;s++)i=r.start(s),n=r.end(s),n>e&&(n=e),t+=n-i;return t/e}function vl(r){if(r instanceof vl)return r;typeof r=="number"?this.code=r:typeof r=="string"?this.message=r:Ef(r)&&(typeof r.code=="number"&&(this.code=r.code),Ks(this,r)),this.message||(this.message=vl.defaultMessages[this.code]||"")}vl.prototype.code=0;vl.prototype.message="";vl.prototype.status=null;vl.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];vl.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Wg=0;Wg<vl.errorTypes.length;Wg++)vl[vl.errorTypes[Wg]]=Wg,vl.prototype[vl.errorTypes[Wg]]=Wg;function m_(r){return r!=null&&typeof r.then=="function"}function fh(r){m_(r)&&r.then(null,function(e){})}var GE=function(e){var t=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(i,n,s){return e[n]&&(i[n]=e[n]),i},{cues:e.cues&&Array.prototype.map.call(e.cues,function(i){return{startTime:i.startTime,endTime:i.endTime,text:i.text,id:i.id}})});return t},L$=function(e){var t=e.$$("track"),i=Array.prototype.map.call(t,function(s){return s.track}),n=Array.prototype.map.call(t,function(s){var a=GE(s.track);return s.src&&(a.src=s.src),a});return n.concat(Array.prototype.filter.call(e.textTracks(),function(s){return i.indexOf(s)===-1}).map(GE))},R$=function(e,t){return e.forEach(function(i){var n=t.addRemoteTextTrack(i).track;!i.src&&i.cues&&i.cues.forEach(function(s){return n.addCue(s)})}),t.textTracks()},B3={textTracksToJson:L$,jsonToTextTracks:R$,trackToJson_:GE},Mw="vjs-modal-dialog",dv=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.handleKeyDown_=function(a){return s.handleKeyDown(a)},s.close_=function(a){return s.close(a)},s.opened_=s.hasBeenOpened_=s.hasBeenFilled_=!1,s.closeable(!s.options_.uncloseable),s.content(s.options_.content),s.contentEl_=xr("div",{className:Mw+"-content"},{role:"document"}),s.descEl_=xr("p",{className:Mw+"-description vjs-control-text",id:s.el().getAttribute("aria-describedby")}),eg(s.descEl_,s.description()),s.el_.appendChild(s.descEl_),s.el_.appendChild(s.contentEl_),s}var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},t.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,r.prototype.dispose.call(this)},t.buildCSSClass=function(){return Mw+" vjs-hidden "+r.prototype.buildCSSClass.call(this)},t.label=function(){return this.localize(this.options_.label||"Modal Window")},t.description=function(){var n=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(n+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),n},t.open=function(){if(!this.opened_){var n=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!n.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&n.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=n.controls(),n.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},t.opened=function(n){return typeof n=="boolean"&&this[n?"open":"close"](),this.opened_},t.close=function(){if(this.opened_){var n=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&n.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&n.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},t.closeable=function(n){if(typeof n=="boolean"){var s=this.closeable_=!!n,a=this.getChild("closeButton");if(s&&!a){var c=this.contentEl_;this.contentEl_=this.el_,a=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=c,this.on(a,"close",this.close_)}!s&&a&&(this.off(a,"close",this.close_),this.removeChild(a),a.dispose())}return this.closeable_},t.fill=function(){this.fillWith(this.content())},t.fillWith=function(n){var s=this.contentEl(),a=s.parentNode,c=s.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,a.removeChild(s),this.empty(),oF(s,n),this.trigger("modalfill"),c?a.insertBefore(s,c):a.appendChild(s);var h=this.getChild("closeButton");h&&a.appendChild(h.el_)},t.empty=function(){this.trigger("beforemodalempty"),PC(this.contentEl()),this.trigger("modalempty")},t.content=function(n){return typeof n<"u"&&(this.content_=n),this.content_},t.conditionalFocus_=function(){var n=ot.activeElement,s=this.player_.el_;this.previouslyActiveEl_=null,(s.contains(n)||s===n)&&(this.previouslyActiveEl_=n,this.focus())},t.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},t.handleKeyDown=function(n){if(n.stopPropagation(),wn.isEventKey(n,"Escape")&&this.closeable()){n.preventDefault(),this.close();return}if(wn.isEventKey(n,"Tab")){for(var s=this.focusableEls_(),a=this.el_.querySelector(":focus"),c,h=0;h<s.length;h++)if(a===s[h]){c=h;break}ot.activeElement===this.el_&&(c=0),n.shiftKey&&c===0?(s[s.length-1].focus(),n.preventDefault()):!n.shiftKey&&c===s.length-1&&(s[0].focus(),n.preventDefault())}},t.focusableEls_=function(){var n=this.el_.querySelectorAll("*");return Array.prototype.filter.call(n,function(s){return(s instanceof Z.HTMLAnchorElement||s instanceof Z.HTMLAreaElement)&&s.hasAttribute("href")||(s instanceof Z.HTMLInputElement||s instanceof Z.HTMLSelectElement||s instanceof Z.HTMLTextAreaElement||s instanceof Z.HTMLButtonElement)&&!s.hasAttribute("disabled")||s instanceof Z.HTMLIFrameElement||s instanceof Z.HTMLObjectElement||s instanceof Z.HTMLEmbedElement||s.hasAttribute("tabindex")&&s.getAttribute("tabindex")!==-1||s.hasAttribute("contenteditable")})},e}(ei);dv.prototype.options_={pauseOnOpen:!0,temporary:!0};ei.registerComponent("ModalDialog",dv);var X0=function(r){mi(e,r);function e(i){var n;i===void 0&&(i=[]),n=r.call(this)||this,n.tracks_=[],Object.defineProperty(Tn(n),"length",{get:function(){return this.tracks_.length}});for(var s=0;s<i.length;s++)n.addTrack(i[s]);return n}var t=e.prototype;return t.addTrack=function(n){var s=this,a=this.tracks_.length;""+a in this||Object.defineProperty(this,a,{get:function(){return this.tracks_[a]}}),this.tracks_.indexOf(n)===-1&&(this.tracks_.push(n),this.trigger({track:n,type:"addtrack",target:this})),n.labelchange_=function(){s.trigger({track:n,type:"labelchange",target:s})},Af(n)&&n.addEventListener("labelchange",n.labelchange_)},t.removeTrack=function(n){for(var s,a=0,c=this.length;a<c;a++)if(this[a]===n){s=this[a],s.off&&s.off(),this.tracks_.splice(a,1);break}s&&this.trigger({track:s,type:"removetrack",target:this})},t.getTrackById=function(n){for(var s=null,a=0,c=this.length;a<c;a++){var h=this[a];if(h.id===n){s=h;break}}return s},e}(to);X0.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(var k$ in X0.prototype.allowedEvents_)X0.prototype["on"+k$]=null;var Dw=function(e,t){for(var i=0;i<e.length;i++)!Object.keys(e[i]).length||t.id===e[i].id||(e[i].enabled=!1)},O$=function(r){mi(e,r);function e(i){var n;i===void 0&&(i=[]);for(var s=i.length-1;s>=0;s--)if(i[s].enabled){Dw(i,i[s]);break}return n=r.call(this,i)||this,n.changing_=!1,n}var t=e.prototype;return t.addTrack=function(n){var s=this;n.enabled&&Dw(this,n),r.prototype.addTrack.call(this,n),n.addEventListener&&(n.enabledChange_=function(){s.changing_||(s.changing_=!0,Dw(s,n),s.changing_=!1,s.trigger("change"))},n.addEventListener("enabledchange",n.enabledChange_))},t.removeTrack=function(n){r.prototype.removeTrack.call(this,n),n.removeEventListener&&n.enabledChange_&&(n.removeEventListener("enabledchange",n.enabledChange_),n.enabledChange_=null)},e}(X0),Iw=function(e,t){for(var i=0;i<e.length;i++)!Object.keys(e[i]).length||t.id===e[i].id||(e[i].selected=!1)},F$=function(r){mi(e,r);function e(i){var n;i===void 0&&(i=[]);for(var s=i.length-1;s>=0;s--)if(i[s].selected){Iw(i,i[s]);break}return n=r.call(this,i)||this,n.changing_=!1,Object.defineProperty(Tn(n),"selectedIndex",{get:function(){for(var c=0;c<this.length;c++)if(this[c].selected)return c;return-1},set:function(){}}),n}var t=e.prototype;return t.addTrack=function(n){var s=this;n.selected&&Iw(this,n),r.prototype.addTrack.call(this,n),n.addEventListener&&(n.selectedChange_=function(){s.changing_||(s.changing_=!0,Iw(s,n),s.changing_=!1,s.trigger("change"))},n.addEventListener("selectedchange",n.selectedChange_))},t.removeTrack=function(n){r.prototype.removeTrack.call(this,n),n.removeEventListener&&n.selectedChange_&&(n.removeEventListener("selectedchange",n.selectedChange_),n.selectedChange_=null)},e}(X0),_F=function(r){mi(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.addTrack=function(n){var s=this;r.prototype.addTrack.call(this,n),this.queueChange_||(this.queueChange_=function(){return s.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return s.trigger("selectedlanguagechange")}),n.addEventListener("modechange",this.queueChange_);var a=["metadata","chapters"];a.indexOf(n.kind)===-1&&n.addEventListener("modechange",this.triggerSelectedlanguagechange_)},t.removeTrack=function(n){r.prototype.removeTrack.call(this,n),n.removeEventListener&&(this.queueChange_&&n.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&n.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},e}(X0),B$=function(){function r(t){t===void 0&&(t=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var i=0,n=t.length;i<n;i++)this.addTrackElement_(t[i])}var e=r.prototype;return e.addTrackElement_=function(i){var n=this.trackElements_.length;""+n in this||Object.defineProperty(this,n,{get:function(){return this.trackElements_[n]}}),this.trackElements_.indexOf(i)===-1&&this.trackElements_.push(i)},e.getTrackElementByTrack_=function(i){for(var n,s=0,a=this.trackElements_.length;s<a;s++)if(i===this.trackElements_[s].track){n=this.trackElements_[s];break}return n},e.removeTrackElement_=function(i){for(var n=0,s=this.trackElements_.length;n<s;n++)if(i===this.trackElements_[n]){this.trackElements_[n].track&&typeof this.trackElements_[n].track.off=="function"&&this.trackElements_[n].track.off(),typeof this.trackElements_[n].off=="function"&&this.trackElements_[n].off(),this.trackElements_.splice(n,1);break}},r}(),N3=function(){function r(t){r.prototype.setCues_.call(this,t),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var e=r.prototype;return e.setCues_=function(i){var n=this.length||0,s=0,a=i.length;this.cues_=i,this.length_=i.length;var c=function(m){""+m in this||Object.defineProperty(this,""+m,{get:function(){return this.cues_[m]}})};if(n<a)for(s=n;s<a;s++)c.call(this,s)},e.getCueById=function(i){for(var n=null,s=0,a=this.length;s<a;s++){var c=this[s];if(c.id===i){n=c;break}}return n},r}(),N$={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},U$={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},V$={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},U3={disabled:"disabled",hidden:"hidden",showing:"showing"},OC=function(r){mi(e,r);function e(t){var i;t===void 0&&(t={}),i=r.call(this)||this;var n={id:t.id||"vjs_track_"+Rf(),kind:t.kind||"",language:t.language||""},s=t.label||"",a=function(m){Object.defineProperty(Tn(i),m,{get:function(){return n[m]},set:function(){}})};for(var c in n)a(c);return Object.defineProperty(Tn(i),"label",{get:function(){return s},set:function(m){m!==s&&(s=m,this.trigger("labelchange"))}}),i}return e}(to),FC=function(e){var t=["protocol","hostname","port","pathname","search","hash","host"],i=ot.createElement("a");i.href=e;for(var n={},s=0;s<t.length;s++)n[t[s]]=i[t[s]];return n.protocol==="http:"&&(n.host=n.host.replace(/:80$/,"")),n.protocol==="https:"&&(n.host=n.host.replace(/:443$/,"")),n.protocol||(n.protocol=Z.location.protocol),n.host||(n.host=Z.location.host),n},bF=function(e){if(!e.match(/^https?:\/\//)){var t=ot.createElement("a");t.href=e,e=t.href}return e},BC=function(e){if(typeof e=="string"){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/,i=t.exec(e);if(i)return i.pop().toLowerCase()}return""},SS=function(e,t){t===void 0&&(t=Z.location);var i=FC(e),n=i.protocol===":"?t.protocol:i.protocol,s=n+i.host!==t.protocol+t.host;return s},z$=Object.freeze({__proto__:null,parseUrl:FC,getAbsoluteURL:bF,getFileExtension:BC,isCrossOrigin:SS}),V3=function(e,t){var i=new Z.WebVTT.Parser(Z,Z.vttjs,Z.WebVTT.StringDecoder()),n=[];i.oncue=function(s){t.addCue(s)},i.onparsingerror=function(s){n.push(s)},i.onflush=function(){t.trigger({type:"loadeddata",target:t})},i.parse(e),n.length>0&&(Z.console&&Z.console.groupCollapsed&&Z.console.groupCollapsed("Text Track parsing errors for "+t.src),n.forEach(function(s){return qn.error(s)}),Z.console&&Z.console.groupEnd&&Z.console.groupEnd()),i.flush()},z3=function(e,t){var i={uri:e},n=SS(e);n&&(i.cors=n);var s=t.tech_.crossOrigin()==="use-credentials";s&&(i.withCredentials=s),w4(i,ys(this,function(a,c,h){if(a)return qn.error(a,c);t.loaded_=!0,typeof Z.WebVTT!="function"?t.tech_&&t.tech_.any(["vttjsloaded","vttjserror"],function(m){if(m.type==="vttjserror"){qn.error("vttjs failed to load, stopping trying to process "+t.src);return}return V3(h,t)}):V3(h,t)}))},J_=function(r){mi(e,r);function e(i){var n;if(i===void 0&&(i={}),!i.tech)throw new Error("A tech was not provided.");var s=vs(i,{kind:V$[i.kind]||"subtitles",language:i.language||i.srclang||""}),a=U3[s.mode]||"disabled",c=s.default;(s.kind==="metadata"||s.kind==="chapters")&&(a="hidden"),n=r.call(this,s)||this,n.tech_=s.tech,n.cues_=[],n.activeCues_=[],n.preload_=n.tech_.preloadTextTracks!==!1;var h=new N3(n.cues_),m=new N3(n.activeCues_),v=!1;n.timeupdateHandler=ys(Tn(n),function(x){if(x===void 0&&(x={}),!this.tech_.isDisposed()){if(!this.tech_.isReady_){x.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,v&&(this.trigger("cuechange"),v=!1),x.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});var b=function(){n.stopTracking()};return n.tech_.one("dispose",b),a!=="disabled"&&n.startTracking(),Object.defineProperties(Tn(n),{default:{get:function(){return c},set:function(){}},mode:{get:function(){return a},set:function(C){U3[C]&&a!==C&&(a=C,!this.preload_&&a!=="disabled"&&this.cues.length===0&&z3(this.src,this),this.stopTracking(),a!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?h:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(this.cues.length===0)return m;for(var C=this.tech_.currentTime(),B=[],P=0,N=this.cues.length;P<N;P++){var ae=this.cues[P];(ae.startTime<=C&&ae.endTime>=C||ae.startTime===ae.endTime&&ae.startTime<=C&&ae.startTime+.5>=C)&&B.push(ae)}if(v=!1,B.length!==this.activeCues_.length)v=!0;else for(var X=0;X<B.length;X++)this.activeCues_.indexOf(B[X])===-1&&(v=!0);return this.activeCues_=B,m.setCues_(this.activeCues_),m},set:function(){}}}),s.src?(n.src=s.src,n.preload_||(n.loaded_=!0),(n.preload_||s.kind!=="subtitles"&&s.kind!=="captions")&&z3(n.src,Tn(n))):n.loaded_=!0,n}var t=e.prototype;return t.startTracking=function(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)},t.stopTracking=function(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)},t.addCue=function(n){var s=n;if(!("getCueAsHTML"in s)){s=new Z.vttjs.VTTCue(n.startTime,n.endTime,n.text);for(var a in n)a in s||(s[a]=n[a]);s.id=n.id,s.originalCue_=n}for(var c=this.tech_.textTracks(),h=0;h<c.length;h++)c[h]!==this&&c[h].removeCue(s);this.cues_.push(s),this.cues.setCues_(this.cues_)},t.removeCue=function(n){for(var s=this.cues_.length;s--;){var a=this.cues_[s];if(a===n||a.originalCue_&&a.originalCue_===n){this.cues_.splice(s,1),this.cues.setCues_(this.cues_);break}}},e}(OC);J_.prototype.allowedEvents_={cuechange:"cuechange"};var TF=function(r){mi(e,r);function e(t){var i;t===void 0&&(t={});var n=vs(t,{kind:U$[t.kind]||""});i=r.call(this,n)||this;var s=!1;return Object.defineProperty(Tn(i),"enabled",{get:function(){return s},set:function(c){typeof c!="boolean"||c===s||(s=c,this.trigger("enabledchange"))}}),n.enabled&&(i.enabled=n.enabled),i.loaded_=!0,i}return e}(OC),xF=function(r){mi(e,r);function e(t){var i;t===void 0&&(t={});var n=vs(t,{kind:N$[t.kind]||""});i=r.call(this,n)||this;var s=!1;return Object.defineProperty(Tn(i),"selected",{get:function(){return s},set:function(c){typeof c!="boolean"||c===s||(s=c,this.trigger("selectedchange"))}}),n.selected&&(i.selected=n.selected),i}return e}(OC),SF=0,H$=1,AF=2,j$=3,hv=function(r){mi(e,r);function e(t){var i;t===void 0&&(t={}),i=r.call(this)||this;var n,s=new J_(t);return i.kind=s.kind,i.src=s.src,i.srclang=s.language,i.label=s.label,i.default=s.default,Object.defineProperties(Tn(i),{readyState:{get:function(){return n}},track:{get:function(){return s}}}),n=SF,s.addEventListener("loadeddata",function(){n=AF,i.trigger({type:"load",target:Tn(i)})}),i}return e}(to);hv.prototype.allowedEvents_={load:"load"};hv.NONE=SF;hv.LOADING=H$;hv.LOADED=AF;hv.ERROR=j$;var vc={audio:{ListClass:O$,TrackClass:TF,capitalName:"Audio"},video:{ListClass:F$,TrackClass:xF,capitalName:"Video"},text:{ListClass:_F,TrackClass:J_,capitalName:"Text"}};Object.keys(vc).forEach(function(r){vc[r].getterName=r+"Tracks",vc[r].privateName=r+"Tracks_"});var Y0={remoteText:{ListClass:_F,TrackClass:J_,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:B$,TrackClass:hv,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},dl=zr({},vc,Y0);Y0.names=Object.keys(Y0);vc.names=Object.keys(vc);dl.names=[].concat(Y0.names).concat(vc.names);function G$(r,e,t,i,n){n===void 0&&(n={});var s=r.textTracks();n.kind=e,t&&(n.label=t),i&&(n.language=i),n.tech=r;var a=new dl.text.TrackClass(n);return s.addTrack(a),a}var is=function(r){mi(e,r);function e(i,n){var s;return i===void 0&&(i={}),n===void 0&&(n=function(){}),i.reportTouchActivity=!1,s=r.call(this,null,i,n)||this,s.onDurationChange_=function(a){return s.onDurationChange(a)},s.trackProgress_=function(a){return s.trackProgress(a)},s.trackCurrentTime_=function(a){return s.trackCurrentTime(a)},s.stopTrackingCurrentTime_=function(a){return s.stopTrackingCurrentTime(a)},s.disposeSourceHandler_=function(a){return s.disposeSourceHandler(a)},s.queuedHanders_=new Set,s.hasStarted_=!1,s.on("playing",function(){this.hasStarted_=!0}),s.on("loadstart",function(){this.hasStarted_=!1}),dl.names.forEach(function(a){var c=dl[a];i&&i[c.getterName]&&(s[c.privateName]=i[c.getterName])}),s.featuresProgressEvents||s.manualProgressOn(),s.featuresTimeupdateEvents||s.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(a){i["native"+a+"Tracks"]===!1&&(s["featuresNative"+a+"Tracks"]=!1)}),i.nativeCaptions===!1||i.nativeTextTracks===!1?s.featuresNativeTextTracks=!1:(i.nativeCaptions===!0||i.nativeTextTracks===!0)&&(s.featuresNativeTextTracks=!0),s.featuresNativeTextTracks||s.emulateTextTracks(),s.preloadTextTracks=i.preloadTextTracks!==!1,s.autoRemoteTextTracks_=new dl.text.ListClass,s.initTrackListeners(),i.nativeControlsForTouch||s.emitTapEvents(),s.constructor&&(s.name_=s.constructor.name||"Unknown Tech"),s}var t=e.prototype;return t.triggerSourceset=function(n){var s=this;this.isReady_||this.one("ready",function(){return s.setTimeout(function(){return s.triggerSourceset(n)},1)}),this.trigger({src:n,type:"sourceset"})},t.manualProgressOn=function(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)},t.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)},t.trackProgress=function(n){this.stopTrackingProgress(),this.progressInterval=this.setInterval(ys(this,function(){var s=this.bufferedPercent();this.bufferedPercent_!==s&&this.trigger("progress"),this.bufferedPercent_=s,s===1&&this.stopTrackingProgress()}),500)},t.onDurationChange=function(n){this.duration_=this.duration()},t.buffered=function(){return Xm(0,0)},t.bufferedPercent=function(){return yF(this.buffered(),this.duration_)},t.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},t.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)},t.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)},t.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},t.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},t.dispose=function(){this.clearTracks(vc.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),r.prototype.dispose.call(this)},t.clearTracks=function(n){var s=this;n=[].concat(n),n.forEach(function(a){for(var c=s[a+"Tracks"]()||[],h=c.length;h--;){var m=c[h];a==="text"&&s.removeRemoteTextTrack(m),c.removeTrack(m)}})},t.cleanupAutoTextTracks=function(){for(var n=this.autoRemoteTextTracks_||[],s=n.length;s--;){var a=n[s];this.removeRemoteTextTrack(a)}},t.reset=function(){},t.crossOrigin=function(){},t.setCrossOrigin=function(){},t.error=function(n){return n!==void 0&&(this.error_=new vl(n),this.trigger("error")),this.error_},t.played=function(){return this.hasStarted_?Xm(0,0):Xm()},t.play=function(){},t.setScrubbing=function(){},t.scrubbing=function(){},t.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},t.initTrackListeners=function(){var n=this;vc.names.forEach(function(s){var a=vc[s],c=function(){n.trigger(s+"trackchange")},h=n[a.getterName]();h.addEventListener("removetrack",c),h.addEventListener("addtrack",c),n.on("dispose",function(){h.removeEventListener("removetrack",c),h.removeEventListener("addtrack",c)})})},t.addWebVttScript_=function(){var n=this;if(!Z.WebVTT)if(ot.body.contains(this.el())){if(!this.options_["vtt.js"]&&L_(rx)&&Object.keys(rx).length>0){this.trigger("vttjsloaded");return}var s=ot.createElement("script");s.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",s.onload=function(){n.trigger("vttjsloaded")},s.onerror=function(){n.trigger("vttjserror")},this.on("dispose",function(){s.onload=null,s.onerror=null}),Z.WebVTT=!0,this.el().parentNode.appendChild(s)}else this.ready(this.addWebVttScript_)},t.emulateTextTracks=function(){var n=this,s=this.textTracks(),a=this.remoteTextTracks(),c=function(x){return s.addTrack(x.track)},h=function(x){return s.removeTrack(x.track)};a.on("addtrack",c),a.on("removetrack",h),this.addWebVttScript_();var m=function(){return n.trigger("texttrackchange")},v=function(){m();for(var x=0;x<s.length;x++){var C=s[x];C.removeEventListener("cuechange",m),C.mode==="showing"&&C.addEventListener("cuechange",m)}};v(),s.addEventListener("change",v),s.addEventListener("addtrack",v),s.addEventListener("removetrack",v),this.on("dispose",function(){a.off("addtrack",c),a.off("removetrack",h),s.removeEventListener("change",v),s.removeEventListener("addtrack",v),s.removeEventListener("removetrack",v);for(var b=0;b<s.length;b++){var x=s[b];x.removeEventListener("cuechange",m)}})},t.addTextTrack=function(n,s,a){if(!n)throw new Error("TextTrack kind is required but was not provided");return G$(this,n,s,a)},t.createRemoteTextTrack=function(n){var s=vs(n,{tech:this});return new Y0.remoteTextEl.TrackClass(s)},t.addRemoteTextTrack=function(n,s){var a=this;n===void 0&&(n={});var c=this.createRemoteTextTrack(n);return s!==!0&&s!==!1&&(qn.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),s=!0),this.remoteTextTrackEls().addTrackElement_(c),this.remoteTextTracks().addTrack(c.track),s!==!0&&this.ready(function(){return a.autoRemoteTextTracks_.addTrack(c.track)}),c},t.removeRemoteTextTrack=function(n){var s=this.remoteTextTrackEls().getTrackElementByTrack_(n);this.remoteTextTrackEls().removeTrackElement_(s),this.remoteTextTracks().removeTrack(n),this.autoRemoteTextTracks_.removeTrack(n)},t.getVideoPlaybackQuality=function(){return{}},t.requestPictureInPicture=function(){var n=this.options_.Promise||Z.Promise;if(n)return n.reject()},t.disablePictureInPicture=function(){return!0},t.setDisablePictureInPicture=function(){},t.requestVideoFrameCallback=function(n){var s=this,a=Rf();return!this.isReady_||this.paused()?(this.queuedHanders_.add(a),this.one("playing",function(){s.queuedHanders_.has(a)&&(s.queuedHanders_.delete(a),n())})):this.requestNamedAnimationFrame(a,n),a},t.cancelVideoFrameCallback=function(n){this.queuedHanders_.has(n)?this.queuedHanders_.delete(n):this.cancelNamedAnimationFrame(n)},t.setPoster=function(){},t.playsinline=function(){},t.setPlaysinline=function(){},t.overrideNativeAudioTracks=function(){},t.overrideNativeVideoTracks=function(){},t.canPlayType=function(){return""},e.canPlayType=function(){return""},e.canPlaySource=function(n,s){return e.canPlayType(n.type)},e.isTech=function(n){return n.prototype instanceof e||n instanceof e||n===e},e.registerTech=function(n,s){if(e.techs_||(e.techs_={}),!e.isTech(s))throw new Error("Tech "+n+" must be a Tech");if(!e.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!e.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return n=ha(n),e.techs_[n]=s,e.techs_[ET(n)]=s,n!=="Tech"&&e.defaultTechOrder_.push(n),s},e.getTech=function(n){if(n){if(e.techs_&&e.techs_[n])return e.techs_[n];if(n=ha(n),Z&&Z.videojs&&Z.videojs[n])return qn.warn("The "+n+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),Z.videojs[n]}},e}(ei);dl.names.forEach(function(r){var e=dl[r];is.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}});is.prototype.featuresVolumeControl=!0;is.prototype.featuresMuteControl=!0;is.prototype.featuresFullscreenResize=!1;is.prototype.featuresPlaybackRate=!1;is.prototype.featuresProgressEvents=!1;is.prototype.featuresSourceset=!1;is.prototype.featuresTimeupdateEvents=!1;is.prototype.featuresNativeTextTracks=!1;is.prototype.featuresVideoFrameCallback=!1;is.withSourceHandlers=function(r){r.registerSourceHandler=function(t,i){var n=r.sourceHandlers;n||(n=r.sourceHandlers=[]),i===void 0&&(i=n.length),n.splice(i,0,t)},r.canPlayType=function(t){for(var i=r.sourceHandlers||[],n,s=0;s<i.length;s++)if(n=i[s].canPlayType(t),n)return n;return""},r.selectSourceHandler=function(t,i){for(var n=r.sourceHandlers||[],s,a=0;a<n.length;a++)if(s=n[a].canHandleSource(t,i),s)return n[a];return null},r.canPlaySource=function(t,i){var n=r.selectSourceHandler(t,i);return n?n.canHandleSource(t,i):""};var e=["seekable","seeking","duration"];e.forEach(function(t){var i=this[t];typeof i=="function"&&(this[t]=function(){return this.sourceHandler_&&this.sourceHandler_[t]?this.sourceHandler_[t].apply(this.sourceHandler_,arguments):i.apply(this,arguments)})},r.prototype),r.prototype.setSource=function(t){var i=r.selectSourceHandler(t,this.options_);i||(r.nativeSourceHandler?i=r.nativeSourceHandler:qn.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),i!==r.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=i.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},r.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};ei.registerComponent("Tech",is);is.registerTech("Tech",is);is.defaultTechOrder_=[];var Ym={},$E={},Mx={};function $$(r,e){Ym[r]=Ym[r]||[],Ym[r].push(e)}function W$(r,e,t){r.setTimeout(function(){return Cm(e,Ym[e.type],t,r)},1)}function q$(r,e){r.forEach(function(t){return t.setTech&&t.setTech(e)})}function X$(r,e,t){return r.reduceRight(NC(t),e[t]())}function Y$(r,e,t,i){return e[t](r.reduce(NC(t),i))}function H3(r,e,t,i){i===void 0&&(i=null);var n="call"+ha(t),s=r.reduce(NC(n),i),a=s===Mx,c=a?null:e[t](s);return Z$(r,t,c,a),c}var Q$={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},K$={setCurrentTime:1,setMuted:1,setVolume:1},j3={play:1,pause:1};function NC(r){return function(e,t){return e===Mx?Mx:t[r]?t[r](e):e}}function Z$(r,e,t,i){for(var n=r.length-1;n>=0;n--){var s=r[n];s[e]&&s[e](i,t)}}function J$(r){$E[r.id()]=null}function eW(r,e){var t=$E[r.id()],i=null;if(t==null)return i=e(r),$E[r.id()]=[[e,i]],i;for(var n=0;n<t.length;n++){var s=t[n],a=s[0],c=s[1];a===e&&(i=c)}return i===null&&(i=e(r),t.push([e,i])),i}function Cm(r,e,t,i,n,s){r===void 0&&(r={}),e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s=!1);var a=e,c=a[0],h=a.slice(1);if(typeof c=="string")Cm(r,Ym[c],t,i,n,s);else if(c){var m=eW(i,c);if(!m.setSource)return n.push(m),Cm(r,h,t,i,n,s);m.setSource(Ks({},r),function(v,b){if(v)return Cm(r,h,t,i,n,s);n.push(m),Cm(b,r.type===b.type?h:Ym[b.type],t,i,n,s)})}else h.length?Cm(r,h,t,i,n,s):s?t(r,n):Cm(r,Ym["*"],t,i,n,!0)}var tW={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},Dx=function(e){e===void 0&&(e="");var t=BC(e),i=tW[t.toLowerCase()];return i||""},iW=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var i=e.cache_.sources.filter(function(c){return c.src===t});if(i.length)return i[0].type;for(var n=e.$$("source"),s=0;s<n.length;s++){var a=n[s];if(a.type&&a.src&&a.src===t)return a.type}return Dx(t)},nW=function r(e){if(Array.isArray(e)){var t=[];e.forEach(function(i){i=r(i),Array.isArray(i)?t=t.concat(i):Ef(i)&&t.push(i)}),e=t}else typeof e=="string"&&e.trim()?e=[G3({src:e})]:Ef(e)&&typeof e.src=="string"&&e.src&&e.src.trim()?e=[G3(e)]:e=[];return e};function G3(r){if(!r.type){var e=Dx(r.src);e&&(r.type=e)}return r}var rW=function(r){mi(e,r);function e(t,i,n){var s,a=vs({createEl:!1},i);if(s=r.call(this,t,a,n)||this,!i.playerOptions.sources||i.playerOptions.sources.length===0)for(var c=0,h=i.playerOptions.techOrder;c<h.length;c++){var m=ha(h[c]),v=is.getTech(m);if(m||(v=ei.getComponent(m)),v&&v.isSupported()){t.loadTech_(m);break}}else t.src(i.playerOptions.sources);return s}return e}(ei);ei.registerComponent("MediaLoader",rW);var AS=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.options_.controlText&&s.controlText(s.options_.controlText),s.handleMouseOver_=function(a){return s.handleMouseOver(a)},s.handleMouseOut_=function(a){return s.handleMouseOut(a)},s.handleClick_=function(a){return s.handleClick(a)},s.handleKeyDown_=function(a){return s.handleKeyDown(a)},s.emitTapEvents(),s.enable(),s}var t=e.prototype;return t.createEl=function(n,s,a){n===void 0&&(n="div"),s===void 0&&(s={}),a===void 0&&(a={}),s=Ks({className:this.buildCSSClass(),tabIndex:0},s),n==="button"&&qn.error("Creating a ClickableComponent with an HTML element of "+n+" is not supported; use a Button instead."),a=Ks({role:"button"},a),this.tabIndex_=s.tabIndex;var c=xr(n,s,a);return c.appendChild(xr("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(c),c},t.dispose=function(){this.controlTextEl_=null,r.prototype.dispose.call(this)},t.createControlTextEl=function(n){return this.controlTextEl_=xr("span",{className:"vjs-control-text"},{"aria-live":"polite"}),n&&n.appendChild(this.controlTextEl_),this.controlText(this.controlText_,n),this.controlTextEl_},t.controlText=function(n,s){if(s===void 0&&(s=this.el()),n===void 0)return this.controlText_||"Need Text";var a=this.localize(n);this.controlText_=n,eg(this.controlTextEl_,a),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&s.setAttribute("title",a)},t.buildCSSClass=function(){return"vjs-control vjs-button "+r.prototype.buildCSSClass.call(this)},t.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))},t.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)},t.handleLanguagechange=function(){this.controlText(this.controlText_)},t.handleClick=function(n){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},t.handleKeyDown=function(n){wn.isEventKey(n,"Space")||wn.isEventKey(n,"Enter")?(n.preventDefault(),n.stopPropagation(),this.trigger("click")):r.prototype.handleKeyDown.call(this,n)},e}(ei);ei.registerComponent("ClickableComponent",AS);var sW=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.update(),s.update_=function(a){return s.update(a)},i.on("posterchange",s.update_),s}var t=e.prototype;return t.dispose=function(){this.player().off("posterchange",this.update_),r.prototype.dispose.call(this)},t.createEl=function(){var n=xr("div",{className:"vjs-poster",tabIndex:-1});return n},t.update=function(n){var s=this.player().poster();this.setSrc(s),s?this.show():this.hide()},t.setSrc=function(n){var s="";n&&(s='url("'+n+'")'),this.el_.style.backgroundImage=s},t.handleClick=function(n){if(this.player_.controls()){var s=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;this.player_.tech(!0)&&!((K_||Q_)&&s)&&this.player_.tech(!0).focus(),this.player_.paused()?fh(this.player_.play()):this.player_.pause()}},e}(AS);ei.registerComponent("PosterImage",sW);var hc="#222",$3="#ccc",aW={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Pw(r,e){var t;if(r.length===4)t=r[1]+r[1]+r[2]+r[2]+r[3]+r[3];else if(r.length===7)t=r.slice(1);else throw new Error("Invalid color code provided, "+r+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(t.slice(0,2),16)+","+parseInt(t.slice(2,4),16)+","+parseInt(t.slice(4,6),16)+","+e+")"}function Lw(r,e,t){try{r.style[e]=t}catch{return}}var oW=function(r){mi(e,r);function e(i,n,s){var a;a=r.call(this,i,n,s)||this;var c=function(m){return a.updateDisplay(m)};return i.on("loadstart",function(h){return a.toggleDisplay(h)}),i.on("texttrackchange",c),i.on("loadedmetadata",function(h){return a.preselectTrack(h)}),i.ready(ys(Tn(a),function(){if(i.tech_&&i.tech_.featuresNativeTextTracks){this.hide();return}i.on("fullscreenchange",c),i.on("playerresize",c),Z.addEventListener("orientationchange",c),i.on("dispose",function(){return Z.removeEventListener("orientationchange",c)});for(var h=this.options_.playerOptions.tracks||[],m=0;m<h.length;m++)this.player_.addRemoteTextTrack(h[m],!0);this.preselectTrack()})),a}var t=e.prototype;return t.preselectTrack=function(){for(var n={captions:1,subtitles:1},s=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,c,h,m,v=0;v<s.length;v++){var b=s[v];a&&a.enabled&&a.language&&a.language===b.language&&b.kind in n?b.kind===a.kind?m=b:m||(m=b):a&&!a.enabled?(m=null,c=null,h=null):b.default&&(b.kind==="descriptions"&&!c?c=b:b.kind in n&&!h&&(h=b))}m?m.mode="showing":h?h.mode="showing":c&&(c.mode="showing")},t.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})},t.clearDisplay=function(){typeof Z.WebVTT=="function"&&Z.WebVTT.processCues(Z,[],this.el_)},t.updateDisplay=function(){var n=this.player_.textTracks(),s=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),s){for(var a=[],c=0;c<n.length;++c){var h=n[c];h.mode==="showing"&&a.push(h)}this.updateForTrack(a);return}for(var m=null,v=null,b=n.length;b--;){var x=n[b];x.mode==="showing"&&(x.kind==="descriptions"?m=x:v=x)}v?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(v)):m&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(m))},t.updateDisplayState=function(n){for(var s=this.player_.textTrackSettings.getValues(),a=n.activeCues,c=a.length;c--;){var h=a[c];if(h){var m=h.displayState;if(s.color&&(m.firstChild.style.color=s.color),s.textOpacity&&Lw(m.firstChild,"color",Pw(s.color||"#fff",s.textOpacity)),s.backgroundColor&&(m.firstChild.style.backgroundColor=s.backgroundColor),s.backgroundOpacity&&Lw(m.firstChild,"backgroundColor",Pw(s.backgroundColor||"#000",s.backgroundOpacity)),s.windowColor&&(s.windowOpacity?Lw(m,"backgroundColor",Pw(s.windowColor,s.windowOpacity)):m.style.backgroundColor=s.windowColor),s.edgeStyle&&(s.edgeStyle==="dropshadow"?m.firstChild.style.textShadow="2px 2px 3px "+hc+", 2px 2px 4px "+hc+", 2px 2px 5px "+hc:s.edgeStyle==="raised"?m.firstChild.style.textShadow="1px 1px "+hc+", 2px 2px "+hc+", 3px 3px "+hc:s.edgeStyle==="depressed"?m.firstChild.style.textShadow="1px 1px "+$3+", 0 1px "+$3+", -1px -1px "+hc+", 0 -1px "+hc:s.edgeStyle==="uniform"&&(m.firstChild.style.textShadow="0 0 4px "+hc+", 0 0 4px "+hc+", 0 0 4px "+hc+", 0 0 4px "+hc)),s.fontPercent&&s.fontPercent!==1){var v=Z.parseFloat(m.style.fontSize);m.style.fontSize=v*s.fontPercent+"px",m.style.height="auto",m.style.top="auto"}s.fontFamily&&s.fontFamily!=="default"&&(s.fontFamily==="small-caps"?m.firstChild.style.fontVariant="small-caps":m.firstChild.style.fontFamily=aW[s.fontFamily])}}},t.updateForTrack=function(n){if(Array.isArray(n)||(n=[n]),!(typeof Z.WebVTT!="function"||n.every(function(C){return!C.activeCues}))){for(var s=[],a=0;a<n.length;++a)for(var c=n[a],h=0;h<c.activeCues.length;++h)s.push(c.activeCues[h]);Z.WebVTT.processCues(Z,s,this.el_);for(var m=0;m<n.length;++m){for(var v=n[m],b=0;b<v.activeCues.length;++b){var x=v.activeCues[b].displayState;Sf(x,"vjs-text-track-cue"),Sf(x,"vjs-text-track-cue-"+(v.language?v.language:m)),v.language&&W0(x,"lang",v.language)}this.player_.textTrackSettings&&this.updateDisplayState(v)}}},e}(ei);ei.registerComponent("TextTrackDisplay",oW);var lW=function(r){mi(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.createEl=function(){var n=this.player_.isAudio(),s=this.localize(n?"Audio Player":"Video Player"),a=xr("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[s])}),c=r.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return c.appendChild(a),c},e}(ei);ei.registerComponent("LoadingSpinner",lW);var Qc=function(r){mi(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.createEl=function(n,s,a){s===void 0&&(s={}),a===void 0&&(a={}),n="button",s=Ks({className:this.buildCSSClass()},s),a=Ks({type:"button"},a);var c=xr(n,s,a);return c.appendChild(xr("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(c),c},t.addChild=function(n,s){s===void 0&&(s={});var a=this.constructor.name;return qn.warn("Adding an actionable (user controllable) child to a Button ("+a+") is not supported; use a ClickableComponent instead."),ei.prototype.addChild.call(this,n,s)},t.enable=function(){r.prototype.enable.call(this),this.el_.removeAttribute("disabled")},t.disable=function(){r.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},t.handleKeyDown=function(n){if(wn.isEventKey(n,"Space")||wn.isEventKey(n,"Enter")){n.stopPropagation();return}r.prototype.handleKeyDown.call(this,n)},e}(AS);ei.registerComponent("Button",Qc);var wF=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.mouseused_=!1,s.on("mousedown",function(a){return s.handleMouseDown(a)}),s}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-big-play-button"},t.handleClick=function(n){var s=this.player_.play();if(this.mouseused_&&n.clientX&&n.clientY){var a=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;fh(s),this.player_.tech(!0)&&!((K_||Q_)&&a)&&this.player_.tech(!0).focus();return}var c=this.player_.getChild("controlBar"),h=c&&c.getChild("playToggle");if(!h){this.player_.tech(!0).focus();return}var m=function(){return h.focus()};m_(s)?s.then(m,function(){}):this.setTimeout(m,1)},t.handleKeyDown=function(n){this.mouseused_=!1,r.prototype.handleKeyDown.call(this,n)},t.handleMouseDown=function(n){this.mouseused_=!0},e}(Qc);wF.prototype.controlText_="Play Video";ei.registerComponent("BigPlayButton",wF);var uW=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.controlText(n&&n.controlText||s.localize("Close")),s}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-close-button "+r.prototype.buildCSSClass.call(this)},t.handleClick=function(n){this.trigger({type:"close",bubbles:!1})},t.handleKeyDown=function(n){wn.isEventKey(n,"Esc")?(n.preventDefault(),n.stopPropagation(),this.trigger("click")):r.prototype.handleKeyDown.call(this,n)},e}(Qc);ei.registerComponent("CloseButton",uW);var EF=function(r){mi(e,r);function e(i,n){var s;return n===void 0&&(n={}),s=r.call(this,i,n)||this,n.replay=n.replay===void 0||n.replay,s.on(i,"play",function(a){return s.handlePlay(a)}),s.on(i,"pause",function(a){return s.handlePause(a)}),n.replay&&s.on(i,"ended",function(a){return s.handleEnded(a)}),s}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-play-control "+r.prototype.buildCSSClass.call(this)},t.handleClick=function(n){this.player_.paused()?fh(this.player_.play()):this.player_.pause()},t.handleSeeked=function(n){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(n):this.handlePlay(n)},t.handlePlay=function(n){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},t.handlePause=function(n){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},t.handleEnded=function(n){var s=this;this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",function(a){return s.handleSeeked(a)})},e}(Qc);EF.prototype.controlText_="Play";ei.registerComponent("PlayToggle",EF);var CF=function(e,t){e=e<0?0:e;var i=Math.floor(e%60),n=Math.floor(e/60%60),s=Math.floor(e/3600),a=Math.floor(t/60%60),c=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(s=n=i="-"),s=s>0||c>0?s+":":"",n=((s||a>=10)&&n<10?"0"+n:n)+":",i=i<10?"0"+i:i,s+n+i},UC=CF;function cW(r){UC=r}function dW(){UC=CF}function Q0(r,e){return e===void 0&&(e=r),UC(r,e)}var fv=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.on(i,["timeupdate","ended"],function(a){return s.updateContent(a)}),s.updateTextNode_(),s}var t=e.prototype;return t.createEl=function(){var n=this.buildCSSClass(),s=r.prototype.createEl.call(this,"div",{className:n+" vjs-time-control vjs-control"}),a=xr("span",{className:"vjs-control-text",textContent:this.localize(this.labelText_)+""},{role:"presentation"});return s.appendChild(a),this.contentEl_=xr("span",{className:n+"-display"},{"aria-live":"off",role:"presentation"}),s.appendChild(this.contentEl_),s},t.dispose=function(){this.contentEl_=null,this.textNode_=null,r.prototype.dispose.call(this)},t.updateTextNode_=function(n){var s=this;n===void 0&&(n=0),n=Q0(n),this.formattedTime_!==n&&(this.formattedTime_=n,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",function(){if(s.contentEl_){var a=s.textNode_;a&&s.contentEl_.firstChild!==a&&(a=null,qn.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),s.textNode_=ot.createTextNode(s.formattedTime_),s.textNode_&&(a?s.contentEl_.replaceChild(s.textNode_,a):s.contentEl_.appendChild(s.textNode_))}}))},t.updateContent=function(n){},e}(ei);fv.prototype.labelText_="Time";fv.prototype.controlText_="Time";ei.registerComponent("TimeDisplay",fv);var VC=function(r){mi(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-current-time"},t.updateContent=function(n){var s;this.player_.ended()?s=this.player_.duration():s=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(s)},e}(fv);VC.prototype.labelText_="Current Time";VC.prototype.controlText_="Current Time";ei.registerComponent("CurrentTimeDisplay",VC);var zC=function(r){mi(e,r);function e(i,n){var s;s=r.call(this,i,n)||this;var a=function(h){return s.updateContent(h)};return s.on(i,"durationchange",a),s.on(i,"loadstart",a),s.on(i,"loadedmetadata",a),s}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-duration"},t.updateContent=function(n){var s=this.player_.duration();this.updateTextNode_(s)},e}(fv);zC.prototype.labelText_="Duration";zC.prototype.controlText_="Duration";ei.registerComponent("DurationDisplay",zC);var hW=function(r){mi(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.createEl=function(){var n=r.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),s=r.prototype.createEl.call(this,"div"),a=r.prototype.createEl.call(this,"span",{textContent:"/"});return s.appendChild(a),n.appendChild(s),n},e}(ei);ei.registerComponent("TimeDivider",hW);var HC=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.on(i,"durationchange",function(a){return s.updateContent(a)}),s}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-remaining-time"},t.createEl=function(){var n=r.prototype.createEl.call(this);return this.options_.displayNegative!==!1&&n.insertBefore(xr("span",{},{"aria-hidden":!0},"-"),this.contentEl_),n},t.updateContent=function(n){if(typeof this.player_.duration()=="number"){var s;this.player_.ended()?s=0:this.player_.remainingTimeDisplay?s=this.player_.remainingTimeDisplay():s=this.player_.remainingTime(),this.updateTextNode_(s)}},e}(fv);HC.prototype.labelText_="Remaining Time";HC.prototype.controlText_="Remaining Time";ei.registerComponent("RemainingTimeDisplay",HC);var fW=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.updateShowing(),s.on(s.player(),"durationchange",function(a){return s.updateShowing(a)}),s}var t=e.prototype;return t.createEl=function(){var n=r.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=xr("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(xr("span",{className:"vjs-control-text",textContent:this.localize("Stream Type")+""})),this.contentEl_.appendChild(ot.createTextNode(this.localize("LIVE"))),n.appendChild(this.contentEl_),n},t.dispose=function(){this.contentEl_=null,r.prototype.dispose.call(this)},t.updateShowing=function(n){this.player().duration()===1/0?this.show():this.hide()},e}(ei);ei.registerComponent("LiveDisplay",fW);var MF=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.updateLiveEdgeStatus(),s.player_.liveTracker&&(s.updateLiveEdgeStatusHandler_=function(a){return s.updateLiveEdgeStatus(a)},s.on(s.player_.liveTracker,"liveedgechange",s.updateLiveEdgeStatusHandler_)),s}var t=e.prototype;return t.createEl=function(){var n=r.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=xr("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),n.appendChild(this.textEl_),n},t.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},t.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},t.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,r.prototype.dispose.call(this)},e}(Qc);MF.prototype.controlText_="Seek to live, currently playing live";ei.registerComponent("SeekToLive",MF);var wS=function(e,t,i){return e=Number(e),Math.min(i,Math.max(t,isNaN(e)?t:e))},jC=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.handleMouseDown_=function(a){return s.handleMouseDown(a)},s.handleMouseUp_=function(a){return s.handleMouseUp(a)},s.handleKeyDown_=function(a){return s.handleKeyDown(a)},s.handleClick_=function(a){return s.handleClick(a)},s.handleMouseMove_=function(a){return s.handleMouseMove(a)},s.update_=function(a){return s.update(a)},s.bar=s.getChild(s.options_.barName),s.vertical(!!s.options_.vertical),s.enable(),s}var t=e.prototype;return t.enabled=function(){return this.enabled_},t.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},t.disable=function(){if(this.enabled()){var n=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(n,"mousemove",this.handleMouseMove_),this.off(n,"mouseup",this.handleMouseUp_),this.off(n,"touchmove",this.handleMouseMove_),this.off(n,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},t.createEl=function(n,s,a){return s===void 0&&(s={}),a===void 0&&(a={}),s.className=s.className+" vjs-slider",s=Ks({tabIndex:0},s),a=Ks({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},a),r.prototype.createEl.call(this,n,s,a)},t.handleMouseDown=function(n){var s=this.bar.el_.ownerDocument;n.type==="mousedown"&&n.preventDefault(),n.type==="touchstart"&&!Lf&&n.preventDefault(),nF(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(s,"mousemove",this.handleMouseMove_),this.on(s,"mouseup",this.handleMouseUp_),this.on(s,"touchmove",this.handleMouseMove_),this.on(s,"touchend",this.handleMouseUp_),this.handleMouseMove(n,!0)},t.handleMouseMove=function(n){},t.handleMouseUp=function(){var n=this.bar.el_.ownerDocument;rF(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(n,"mousemove",this.handleMouseMove_),this.off(n,"mouseup",this.handleMouseUp_),this.off(n,"touchmove",this.handleMouseMove_),this.off(n,"touchend",this.handleMouseUp_),this.update()},t.update=function(){var n=this;if(!(!this.el_||!this.bar)){var s=this.getProgress();return s===this.progress_||(this.progress_=s,this.requestNamedAnimationFrame("Slider#update",function(){var a=n.vertical()?"height":"width";n.bar.el().style[a]=(s*100).toFixed(2)+"%"})),s}},t.getProgress=function(){return Number(wS(this.getPercent(),0,1).toFixed(4))},t.calculateDistance=function(n){var s=_S(this.el_,n);return this.vertical()?s.y:s.x},t.handleKeyDown=function(n){wn.isEventKey(n,"Left")||wn.isEventKey(n,"Down")?(n.preventDefault(),n.stopPropagation(),this.stepBack()):wn.isEventKey(n,"Right")||wn.isEventKey(n,"Up")?(n.preventDefault(),n.stopPropagation(),this.stepForward()):r.prototype.handleKeyDown.call(this,n)},t.handleClick=function(n){n.stopPropagation(),n.preventDefault()},t.vertical=function(n){if(n===void 0)return this.vertical_||!1;this.vertical_=!!n,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},e}(ei);ei.registerComponent("Slider",jC);var Rw=function(e,t){return wS(e/t*100,0,100).toFixed(2)+"%"},pW=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.partEls_=[],s.on(i,"progress",function(a){return s.update(a)}),s}var t=e.prototype;return t.createEl=function(){var n=r.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),s=xr("span",{className:"vjs-control-text"}),a=xr("span",{textContent:this.localize("Loaded")}),c=ot.createTextNode(": ");return this.percentageEl_=xr("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),n.appendChild(s),s.appendChild(a),s.appendChild(c),s.appendChild(this.percentageEl_),n},t.dispose=function(){this.partEls_=null,this.percentageEl_=null,r.prototype.dispose.call(this)},t.update=function(n){var s=this;this.requestNamedAnimationFrame("LoadProgressBar#update",function(){var a=s.player_.liveTracker,c=s.player_.buffered(),h=a&&a.isLive()?a.seekableEnd():s.player_.duration(),m=s.player_.bufferedEnd(),v=s.partEls_,b=Rw(m,h);s.percent_!==b&&(s.el_.style.width=b,eg(s.percentageEl_,b),s.percent_=b);for(var x=0;x<c.length;x++){var C=c.start(x),B=c.end(x),P=v[x];P||(P=s.el_.appendChild(xr()),v[x]=P),!(P.dataset.start===C&&P.dataset.end===B)&&(P.dataset.start=C,P.dataset.end=B,P.style.left=Rw(C,m),P.style.width=Rw(B-C,m))}for(var N=v.length;N>c.length;N--)s.el_.removeChild(v[N-1]);v.length=c.length})},e}(ei);ei.registerComponent("LoadProgressBar",pW);var mW=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.update=Cf(ys(Tn(s),s.update),Zc),s}var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},t.update=function(n,s,a){var c=k_(this.el_),h=q0(this.player_.el()),m=n.width*s;if(!(!h||!c)){var v=n.left-h.left+m,b=n.width-m+(h.right-n.right),x=c.width/2;v<x?x+=x-v:b<x&&(x=b),x<0?x=0:x>c.width&&(x=c.width),x=Math.round(x),this.el_.style.right="-"+x+"px",this.write(a)}},t.write=function(n){eg(this.el_,n)},t.updateTime=function(n,s,a,c){var h=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",function(){var m,v=h.player_.duration();if(h.player_.liveTracker&&h.player_.liveTracker.isLive()){var b=h.player_.liveTracker.liveWindow(),x=b-s*b;m=(x<1?"":"-")+Q0(x,b)}else m=Q0(a,v);h.update(n,s,m),c&&c()})},e}(ei);ei.registerComponent("TimeTooltip",mW);var GC=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.update=Cf(ys(Tn(s),s.update),Zc),s}var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},t.update=function(n,s){var a=this.getChild("timeTooltip");if(a){var c=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();a.updateTime(n,s,c)}},e}(ei);GC.prototype.options_={children:[]};!yl&&!Pf&&GC.prototype.options_.children.push("timeTooltip");ei.registerComponent("PlayProgressBar",GC);var DF=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.update=Cf(ys(Tn(s),s.update),Zc),s}var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},t.update=function(n,s){var a=this,c=s*this.player_.duration();this.getChild("timeTooltip").updateTime(n,s,c,function(){a.el_.style.left=n.width*s+"px"})},e}(ei);DF.prototype.options_={children:["timeTooltip"]};ei.registerComponent("MouseTimeDisplay",DF);var aT=5,W3=12,$C=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.setEventHandlers_(),s}var t=e.prototype;return t.setEventHandlers_=function(){var n=this;this.update_=ys(this,this.update),this.update=Cf(this.update_,Zc),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=function(s){return n.enableInterval_(s)},this.disableIntervalHandler_=function(s){return n.disableInterval_(s)},this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in ot&&"visibilityState"in ot&&this.on(ot,"visibilitychange",this.toggleVisibility_)},t.toggleVisibility_=function(n){ot.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(n)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())},t.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,Zc))},t.disableInterval_=function(n){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&n&&n.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},t.update=function(n){var s=this;if(ot.visibilityState!=="hidden"){var a=r.prototype.update.call(this);return this.requestNamedAnimationFrame("SeekBar#update",function(){var c=s.player_.ended()?s.player_.duration():s.getCurrentTime_(),h=s.player_.liveTracker,m=s.player_.duration();h&&h.isLive()&&(m=s.player_.liveTracker.liveCurrentTime()),s.percent_!==a&&(s.el_.setAttribute("aria-valuenow",(a*100).toFixed(2)),s.percent_=a),(s.currentTime_!==c||s.duration_!==m)&&(s.el_.setAttribute("aria-valuetext",s.localize("progress bar timing: currentTime={1} duration={2}",[Q0(c,m),Q0(m,m)],"{1} of {2}")),s.currentTime_=c,s.duration_=m),s.bar&&s.bar.update(q0(s.el()),s.getProgress())}),a}},t.userSeek_=function(n){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(n)},t.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},t.getPercent=function(){var n=this.getCurrentTime_(),s,a=this.player_.liveTracker;return a&&a.isLive()?(s=(n-a.seekableStart())/a.liveWindow(),a.atLiveEdge()&&(s=1)):s=n/this.player_.duration(),s},t.handleMouseDown=function(n){O_(n)&&(n.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),r.prototype.handleMouseDown.call(this,n))},t.handleMouseMove=function(n,s){if(s===void 0&&(s=!1),!!O_(n)){!s&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);var a,c=this.calculateDistance(n),h=this.player_.liveTracker;if(!h||!h.isLive())a=c*this.player_.duration(),a===this.player_.duration()&&(a=a-.1);else{if(c>=.99){h.seekToLiveEdge();return}var m=h.seekableStart(),v=h.liveCurrentTime();if(a=m+c*h.liveWindow(),a>=v&&(a=v),a<=m&&(a=m+.1),a===1/0)return}this.userSeek_(a)}},t.enable=function(){r.prototype.enable.call(this);var n=this.getChild("mouseTimeDisplay");n&&n.show()},t.disable=function(){r.prototype.disable.call(this);var n=this.getChild("mouseTimeDisplay");n&&n.hide()},t.handleMouseUp=function(n){r.prototype.handleMouseUp.call(this,n),n&&n.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?fh(this.player_.play()):this.update_()},t.stepForward=function(){this.userSeek_(this.player_.currentTime()+aT)},t.stepBack=function(){this.userSeek_(this.player_.currentTime()-aT)},t.handleAction=function(n){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleKeyDown=function(n){var s=this.player_.liveTracker;if(wn.isEventKey(n,"Space")||wn.isEventKey(n,"Enter"))n.preventDefault(),n.stopPropagation(),this.handleAction(n);else if(wn.isEventKey(n,"Home"))n.preventDefault(),n.stopPropagation(),this.userSeek_(0);else if(wn.isEventKey(n,"End"))n.preventDefault(),n.stopPropagation(),s&&s.isLive()?this.userSeek_(s.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(wn(n))){n.preventDefault(),n.stopPropagation();var a=(wn.codes[wn(n)]-wn.codes[0])*10/100;s&&s.isLive()?this.userSeek_(s.seekableStart()+s.liveWindow()*a):this.userSeek_(this.player_.duration()*a)}else wn.isEventKey(n,"PgDn")?(n.preventDefault(),n.stopPropagation(),this.userSeek_(this.player_.currentTime()-aT*W3)):wn.isEventKey(n,"PgUp")?(n.preventDefault(),n.stopPropagation(),this.userSeek_(this.player_.currentTime()+aT*W3)):r.prototype.handleKeyDown.call(this,n)},t.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in ot&&"visibilityState"in ot&&this.off(ot,"visibilitychange",this.toggleVisibility_),r.prototype.dispose.call(this)},e}(jC);$C.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};!yl&&!Pf&&$C.prototype.options_.children.splice(1,0,"mouseTimeDisplay");ei.registerComponent("SeekBar",$C);var IF=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.handleMouseMove=Cf(ys(Tn(s),s.handleMouseMove),Zc),s.throttledHandleMouseSeek=Cf(ys(Tn(s),s.handleMouseSeek),Zc),s.handleMouseUpHandler_=function(a){return s.handleMouseUp(a)},s.handleMouseDownHandler_=function(a){return s.handleMouseDown(a)},s.enable(),s}var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},t.handleMouseMove=function(n){var s=this.getChild("seekBar");if(s){var a=s.getChild("playProgressBar"),c=s.getChild("mouseTimeDisplay");if(!(!a&&!c)){var h=s.el(),m=k_(h),v=_S(h,n).x;v=wS(v,0,1),c&&c.update(m,v),a&&a.update(m,s.getProgress())}}},t.handleMouseSeek=function(n){var s=this.getChild("seekBar");s&&s.handleMouseMove(n)},t.enabled=function(){return this.enabled_},t.disable=function(){if(this.children().forEach(function(s){return s.disable&&s.disable()}),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){var n=this.getChild("seekBar");this.player_.scrubbing(!1),n.videoWasPlaying&&fh(this.player_.play())}},t.enable=function(){this.children().forEach(function(n){return n.enable&&n.enable()}),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},t.removeListenersAddedOnMousedownAndTouchstart=function(){var n=this.el_.ownerDocument;this.off(n,"mousemove",this.throttledHandleMouseSeek),this.off(n,"touchmove",this.throttledHandleMouseSeek),this.off(n,"mouseup",this.handleMouseUpHandler_),this.off(n,"touchend",this.handleMouseUpHandler_)},t.handleMouseDown=function(n){var s=this.el_.ownerDocument,a=this.getChild("seekBar");a&&a.handleMouseDown(n),this.on(s,"mousemove",this.throttledHandleMouseSeek),this.on(s,"touchmove",this.throttledHandleMouseSeek),this.on(s,"mouseup",this.handleMouseUpHandler_),this.on(s,"touchend",this.handleMouseUpHandler_)},t.handleMouseUp=function(n){var s=this.getChild("seekBar");s&&s.handleMouseUp(n),this.removeListenersAddedOnMousedownAndTouchstart()},e}(ei);IF.prototype.options_={children:["seekBar"]};ei.registerComponent("ProgressControl",IF);var PF=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.on(i,["enterpictureinpicture","leavepictureinpicture"],function(a){return s.handlePictureInPictureChange(a)}),s.on(i,["disablepictureinpicturechanged","loadedmetadata"],function(a){return s.handlePictureInPictureEnabledChange(a)}),s.on(i,["loadedmetadata","audioonlymodechange","audiopostermodechange"],function(){var a=i.currentType().substring(0,5)==="audio";a||i.audioPosterMode()||i.audioOnlyMode()?(i.isInPictureInPicture()&&i.exitPictureInPicture(),s.hide()):s.show()}),s.disable(),s}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-picture-in-picture-control "+r.prototype.buildCSSClass.call(this)},t.handlePictureInPictureEnabledChange=function(){ot.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1?this.enable():this.disable()},t.handlePictureInPictureChange=function(n){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()},t.handleClick=function(n){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},e}(Qc);PF.prototype.controlText_="Picture-in-Picture";ei.registerComponent("PictureInPictureToggle",PF);var LF=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.on(i,"fullscreenchange",function(a){return s.handleFullscreenChange(a)}),ot[i.fsApi_.fullscreenEnabled]===!1&&s.disable(),s}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-fullscreen-control "+r.prototype.buildCSSClass.call(this)},t.handleFullscreenChange=function(n){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},t.handleClick=function(n){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},e}(Qc);LF.prototype.controlText_="Fullscreen";ei.registerComponent("FullscreenToggle",LF);var gW=function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})},vW=function(r){mi(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.createEl=function(){var n=r.prototype.createEl.call(this,"div",{className:"vjs-volume-level"});return n.appendChild(r.prototype.createEl.call(this,"span",{className:"vjs-control-text"})),n},e}(ei);ei.registerComponent("VolumeLevel",vW);var yW=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.update=Cf(ys(Tn(s),s.update),Zc),s}var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})},t.update=function(n,s,a,c){if(!a){var h=q0(this.el_),m=q0(this.player_.el()),v=n.width*s;if(!m||!h)return;var b=n.left-m.left+v,x=n.width-v+(m.right-n.right),C=h.width/2;b<C?C+=C-b:x<C&&(C=x),C<0?C=0:C>h.width&&(C=h.width),this.el_.style.right="-"+C+"px"}this.write(c+"%")},t.write=function(n){eg(this.el_,n)},t.updateVolume=function(n,s,a,c,h){var m=this;this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",function(){m.update(n,s,a,c.toFixed(0)),h&&h()})},e}(ei);ei.registerComponent("VolumeLevelTooltip",yW);var RF=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.update=Cf(ys(Tn(s),s.update),Zc),s}var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},t.update=function(n,s,a){var c=this,h=100*s;this.getChild("volumeLevelTooltip").updateVolume(n,s,a,h,function(){a?c.el_.style.bottom=n.height*s+"px":c.el_.style.left=n.width*s+"px"})},e}(ei);RF.prototype.options_={children:["volumeLevelTooltip"]};ei.registerComponent("MouseVolumeLevelDisplay",RF);var ES=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.on("slideractive",function(a){return s.updateLastVolume_(a)}),s.on(i,"volumechange",function(a){return s.updateARIAAttributes(a)}),i.ready(function(){return s.updateARIAAttributes()}),s}var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},t.handleMouseDown=function(n){O_(n)&&r.prototype.handleMouseDown.call(this,n)},t.handleMouseMove=function(n){var s=this.getChild("mouseVolumeLevelDisplay");if(s){var a=this.el(),c=q0(a),h=this.vertical(),m=_S(a,n);m=h?m.y:m.x,m=wS(m,0,1),s.update(c,m,h)}O_(n)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(n)))},t.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},t.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},t.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},t.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},t.updateARIAAttributes=function(n){var s=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",s),this.el_.setAttribute("aria-valuetext",s+"%")},t.volumeAsPercentage_=function(){return Math.round(this.player_.volume()*100)},t.updateLastVolume_=function(){var n=this,s=this.player_.volume();this.one("sliderinactive",function(){n.player_.volume()===0&&n.player_.lastVolume_(s)})},e}(jC);ES.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};!yl&&!Pf&&ES.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay");ES.prototype.playerEvent="volumechange";ei.registerComponent("VolumeBar",ES);var kF=function(r){mi(e,r);function e(i,n){var s;return n===void 0&&(n={}),n.vertical=n.vertical||!1,(typeof n.volumeBar>"u"||L_(n.volumeBar))&&(n.volumeBar=n.volumeBar||{},n.volumeBar.vertical=n.vertical),s=r.call(this,i,n)||this,gW(Tn(s),i),s.throttledHandleMouseMove=Cf(ys(Tn(s),s.handleMouseMove),Zc),s.handleMouseUpHandler_=function(a){return s.handleMouseUp(a)},s.on("mousedown",function(a){return s.handleMouseDown(a)}),s.on("touchstart",function(a){return s.handleMouseDown(a)}),s.on("mousemove",function(a){return s.handleMouseMove(a)}),s.on(s.volumeBar,["focus","slideractive"],function(){s.volumeBar.addClass("vjs-slider-active"),s.addClass("vjs-slider-active"),s.trigger("slideractive")}),s.on(s.volumeBar,["blur","sliderinactive"],function(){s.volumeBar.removeClass("vjs-slider-active"),s.removeClass("vjs-slider-active"),s.trigger("sliderinactive")}),s}var t=e.prototype;return t.createEl=function(){var n="vjs-volume-horizontal";return this.options_.vertical&&(n="vjs-volume-vertical"),r.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+n})},t.handleMouseDown=function(n){var s=this.el_.ownerDocument;this.on(s,"mousemove",this.throttledHandleMouseMove),this.on(s,"touchmove",this.throttledHandleMouseMove),this.on(s,"mouseup",this.handleMouseUpHandler_),this.on(s,"touchend",this.handleMouseUpHandler_)},t.handleMouseUp=function(n){var s=this.el_.ownerDocument;this.off(s,"mousemove",this.throttledHandleMouseMove),this.off(s,"touchmove",this.throttledHandleMouseMove),this.off(s,"mouseup",this.handleMouseUpHandler_),this.off(s,"touchend",this.handleMouseUpHandler_)},t.handleMouseMove=function(n){this.volumeBar.handleMouseMove(n)},e}(ei);kF.prototype.options_={children:["volumeBar"]};ei.registerComponent("VolumeControl",kF);var _W=function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})},OF=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,_W(Tn(s),i),s.on(i,["loadstart","volumechange"],function(a){return s.update(a)}),s}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-mute-control "+r.prototype.buildCSSClass.call(this)},t.handleClick=function(n){var s=this.player_.volume(),a=this.player_.lastVolume_();if(s===0){var c=a<.1?.1:a;this.player_.volume(c),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},t.update=function(n){this.updateIcon_(),this.updateControlText_()},t.updateIcon_=function(){var n=this.player_.volume(),s=3;yl&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),n===0||this.player_.muted()?s=0:n<.33?s=1:n<.67&&(s=2);for(var a=0;a<4;a++)Z_(this.el_,"vjs-vol-"+a);Sf(this.el_,"vjs-vol-"+s)},t.updateControlText_=function(){var n=this.player_.muted()||this.player_.volume()===0,s=n?"Unmute":"Mute";this.controlText()!==s&&this.controlText(s)},e}(Qc);OF.prototype.controlText_="Mute";ei.registerComponent("MuteToggle",OF);var FF=function(r){mi(e,r);function e(i,n){var s;return n===void 0&&(n={}),typeof n.inline<"u"?n.inline=n.inline:n.inline=!0,(typeof n.volumeControl>"u"||L_(n.volumeControl))&&(n.volumeControl=n.volumeControl||{},n.volumeControl.vertical=!n.inline),s=r.call(this,i,n)||this,s.handleKeyPressHandler_=function(a){return s.handleKeyPress(a)},s.on(i,["loadstart"],function(a){return s.volumePanelState_(a)}),s.on(s.muteToggle,"keyup",function(a){return s.handleKeyPress(a)}),s.on(s.volumeControl,"keyup",function(a){return s.handleVolumeControlKeyUp(a)}),s.on("keydown",function(a){return s.handleKeyPress(a)}),s.on("mouseover",function(a){return s.handleMouseOver(a)}),s.on("mouseout",function(a){return s.handleMouseOut(a)}),s.on(s.volumeControl,["slideractive"],s.sliderActive_),s.on(s.volumeControl,["sliderinactive"],s.sliderInactive_),s}var t=e.prototype;return t.sliderActive_=function(){this.addClass("vjs-slider-active")},t.sliderInactive_=function(){this.removeClass("vjs-slider-active")},t.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},t.createEl=function(){var n="vjs-volume-panel-horizontal";return this.options_.inline||(n="vjs-volume-panel-vertical"),r.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+n})},t.dispose=function(){this.handleMouseOut(),r.prototype.dispose.call(this)},t.handleVolumeControlKeyUp=function(n){wn.isEventKey(n,"Esc")&&this.muteToggle.focus()},t.handleMouseOver=function(n){this.addClass("vjs-hover"),Xu(ot,"keyup",this.handleKeyPressHandler_)},t.handleMouseOut=function(n){this.removeClass("vjs-hover"),Uo(ot,"keyup",this.handleKeyPressHandler_)},t.handleKeyPress=function(n){wn.isEventKey(n,"Esc")&&this.handleMouseOut()},e}(ei);FF.prototype.options_={children:["muteToggle","volumeControl"]};ei.registerComponent("VolumePanel",FF);var BF=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,n&&(s.menuButton_=n.menuButton),s.focusedChild_=-1,s.on("keydown",function(a){return s.handleKeyDown(a)}),s.boundHandleBlur_=function(a){return s.handleBlur(a)},s.boundHandleTapClick_=function(a){return s.handleTapClick(a)},s}var t=e.prototype;return t.addEventListenerForItem=function(n){n instanceof ei&&(this.on(n,"blur",this.boundHandleBlur_),this.on(n,["tap","click"],this.boundHandleTapClick_))},t.removeEventListenerForItem=function(n){n instanceof ei&&(this.off(n,"blur",this.boundHandleBlur_),this.off(n,["tap","click"],this.boundHandleTapClick_))},t.removeChild=function(n){typeof n=="string"&&(n=this.getChild(n)),this.removeEventListenerForItem(n),r.prototype.removeChild.call(this,n)},t.addItem=function(n){var s=this.addChild(n);s&&this.addEventListenerForItem(s)},t.createEl=function(){var n=this.options_.contentElType||"ul";this.contentEl_=xr(n,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var s=r.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return s.appendChild(this.contentEl_),Xu(s,"click",function(a){a.preventDefault(),a.stopImmediatePropagation()}),s},t.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,r.prototype.dispose.call(this)},t.handleBlur=function(n){var s=n.relatedTarget||ot.activeElement;if(!this.children().some(function(c){return c.el()===s})){var a=this.menuButton_;a&&a.buttonPressed_&&s!==a.el().firstChild&&a.unpressButton()}},t.handleTapClick=function(n){if(this.menuButton_){this.menuButton_.unpressButton();var s=this.children();if(!Array.isArray(s))return;var a=s.filter(function(c){return c.el()===n.target})[0];if(!a)return;a.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}},t.handleKeyDown=function(n){wn.isEventKey(n,"Left")||wn.isEventKey(n,"Down")?(n.preventDefault(),n.stopPropagation(),this.stepForward()):(wn.isEventKey(n,"Right")||wn.isEventKey(n,"Up"))&&(n.preventDefault(),n.stopPropagation(),this.stepBack())},t.stepForward=function(){var n=0;this.focusedChild_!==void 0&&(n=this.focusedChild_+1),this.focus(n)},t.stepBack=function(){var n=0;this.focusedChild_!==void 0&&(n=this.focusedChild_-1),this.focus(n)},t.focus=function(n){n===void 0&&(n=0);var s=this.children().slice(),a=s.length&&s[0].hasClass("vjs-menu-title");a&&s.shift(),s.length>0&&(n<0?n=0:n>=s.length&&(n=s.length-1),this.focusedChild_=n,s[n].el_.focus())},e}(ei);ei.registerComponent("Menu",BF);var WC=function(r){mi(e,r);function e(i,n){var s;n===void 0&&(n={}),s=r.call(this,i,n)||this,s.menuButton_=new Qc(i,n),s.menuButton_.controlText(s.controlText_),s.menuButton_.el_.setAttribute("aria-haspopup","true");var a=Qc.prototype.buildCSSClass();s.menuButton_.el_.className=s.buildCSSClass()+" "+a,s.menuButton_.removeClass("vjs-control"),s.addChild(s.menuButton_),s.update(),s.enabled_=!0;var c=function(m){return s.handleClick(m)};return s.handleMenuKeyUp_=function(h){return s.handleMenuKeyUp(h)},s.on(s.menuButton_,"tap",c),s.on(s.menuButton_,"click",c),s.on(s.menuButton_,"keydown",function(h){return s.handleKeyDown(h)}),s.on(s.menuButton_,"mouseenter",function(){s.addClass("vjs-hover"),s.menu.show(),Xu(ot,"keyup",s.handleMenuKeyUp_)}),s.on("mouseleave",function(h){return s.handleMouseLeave(h)}),s.on("keydown",function(h){return s.handleSubmenuKeyDown(h)}),s}var t=e.prototype;return t.update=function(){var n=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=n,this.addChild(n),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))},t.createMenu=function(){var n=new BF(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var s=xr("li",{className:"vjs-menu-title",textContent:ha(this.options_.title),tabIndex:-1}),a=new ei(this.player_,{el:s});n.addItem(a)}if(this.items=this.createItems(),this.items)for(var c=0;c<this.items.length;c++)n.addItem(this.items[c]);return n},t.createItems=function(){},t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},t.buildWrapperCSSClass=function(){var n="vjs-menu-button";this.options_.inline===!0?n+="-inline":n+="-popup";var s=Qc.prototype.buildCSSClass();return"vjs-menu-button "+n+" "+s+" "+r.prototype.buildCSSClass.call(this)},t.buildCSSClass=function(){var n="vjs-menu-button";return this.options_.inline===!0?n+="-inline":n+="-popup","vjs-menu-button "+n+" "+r.prototype.buildCSSClass.call(this)},t.controlText=function(n,s){return s===void 0&&(s=this.menuButton_.el()),this.menuButton_.controlText(n,s)},t.dispose=function(){this.handleMouseLeave(),r.prototype.dispose.call(this)},t.handleClick=function(n){this.buttonPressed_?this.unpressButton():this.pressButton()},t.handleMouseLeave=function(n){this.removeClass("vjs-hover"),Uo(ot,"keyup",this.handleMenuKeyUp_)},t.focus=function(){this.menuButton_.focus()},t.blur=function(){this.menuButton_.blur()},t.handleKeyDown=function(n){wn.isEventKey(n,"Esc")||wn.isEventKey(n,"Tab")?(this.buttonPressed_&&this.unpressButton(),wn.isEventKey(n,"Tab")||(n.preventDefault(),this.menuButton_.focus())):(wn.isEventKey(n,"Up")||wn.isEventKey(n,"Down"))&&(this.buttonPressed_||(n.preventDefault(),this.pressButton()))},t.handleMenuKeyUp=function(n){(wn.isEventKey(n,"Esc")||wn.isEventKey(n,"Tab"))&&this.removeClass("vjs-hover")},t.handleSubmenuKeyPress=function(n){this.handleSubmenuKeyDown(n)},t.handleSubmenuKeyDown=function(n){(wn.isEventKey(n,"Esc")||wn.isEventKey(n,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),wn.isEventKey(n,"Tab")||(n.preventDefault(),this.menuButton_.focus()))},t.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),yl&&Z4())return;this.menu.focus()}},t.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},t.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},t.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},e}(ei);ei.registerComponent("MenuButton",WC);var qC=function(r){mi(e,r);function e(t,i){var n,s=i.tracks;if(n=r.call(this,t,i)||this,n.items.length<=1&&n.hide(),!s)return Tn(n);var a=ys(Tn(n),n.update);return s.addEventListener("removetrack",a),s.addEventListener("addtrack",a),s.addEventListener("labelchange",a),n.player_.on("ready",a),n.player_.on("dispose",function(){s.removeEventListener("removetrack",a),s.removeEventListener("addtrack",a),s.removeEventListener("labelchange",a)}),n}return e}(WC);ei.registerComponent("TrackButton",qC);var bW=["Tab","Esc","Up","Down","Right","Left"],eb=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.selectable=n.selectable,s.isSelected_=n.selected||!1,s.multiSelectable=n.multiSelectable,s.selected(s.isSelected_),s.selectable?s.multiSelectable?s.el_.setAttribute("role","menuitemcheckbox"):s.el_.setAttribute("role","menuitemradio"):s.el_.setAttribute("role","menuitem"),s}var t=e.prototype;return t.createEl=function(n,s,a){this.nonIconControl=!0;var c=r.prototype.createEl.call(this,"li",Ks({className:"vjs-menu-item",tabIndex:-1},s),a);return c.replaceChild(xr("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),c.querySelector(".vjs-icon-placeholder")),c},t.handleKeyDown=function(n){bW.some(function(s){return wn.isEventKey(n,s)})||r.prototype.handleKeyDown.call(this,n)},t.handleClick=function(n){this.selected(!0)},t.selected=function(n){this.selectable&&(n?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},e}(AS);ei.registerComponent("MenuItem",eb);var tb=function(r){mi(e,r);function e(i,n){var s,a=n.track,c=i.textTracks();n.label=a.label||a.language||"Unknown",n.selected=a.mode==="showing",s=r.call(this,i,n)||this,s.track=a,s.kinds=(n.kinds||[n.kind||s.track.kind]).filter(Boolean);var h=function(){for(var x=arguments.length,C=new Array(x),B=0;B<x;B++)C[B]=arguments[B];s.handleTracksChange.apply(Tn(s),C)},m=function(){for(var x=arguments.length,C=new Array(x),B=0;B<x;B++)C[B]=arguments[B];s.handleSelectedLanguageChange.apply(Tn(s),C)};if(i.on(["loadstart","texttrackchange"],h),c.addEventListener("change",h),c.addEventListener("selectedlanguagechange",m),s.on("dispose",function(){i.off(["loadstart","texttrackchange"],h),c.removeEventListener("change",h),c.removeEventListener("selectedlanguagechange",m)}),c.onchange===void 0){var v;s.on(["tap","click"],function(){if(typeof Z.Event!="object")try{v=new Z.Event("change")}catch{}v||(v=ot.createEvent("Event"),v.initEvent("change",!0,!0)),c.dispatchEvent(v)})}return s.handleTracksChange(),s}var t=e.prototype;return t.handleClick=function(n){var s=this.track,a=this.player_.textTracks();if(r.prototype.handleClick.call(this,n),!!a)for(var c=0;c<a.length;c++){var h=a[c];this.kinds.indexOf(h.kind)!==-1&&(h===s?h.mode!=="showing"&&(h.mode="showing"):h.mode!=="disabled"&&(h.mode="disabled"))}},t.handleTracksChange=function(n){var s=this.track.mode==="showing";s!==this.isSelected_&&this.selected(s)},t.handleSelectedLanguageChange=function(n){if(this.track.mode==="showing"){var s=this.player_.cache_.selectedLanguage;if(s&&s.enabled&&s.language===this.track.language&&s.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},t.dispose=function(){this.track=null,r.prototype.dispose.call(this)},e}(eb);ei.registerComponent("TextTrackMenuItem",tb);var NF=function(r){mi(e,r);function e(i,n){return n.track={player:i,kind:n.kind,kinds:n.kinds,default:!1,mode:"disabled"},n.kinds||(n.kinds=[n.kind]),n.label?n.track.label=n.label:n.track.label=n.kinds.join(" and ")+" off",n.selectable=!0,n.multiSelectable=!1,r.call(this,i,n)||this}var t=e.prototype;return t.handleTracksChange=function(n){for(var s=this.player().textTracks(),a=!0,c=0,h=s.length;c<h;c++){var m=s[c];if(this.options_.kinds.indexOf(m.kind)>-1&&m.mode==="showing"){a=!1;break}}a!==this.isSelected_&&this.selected(a)},t.handleSelectedLanguageChange=function(n){for(var s=this.player().textTracks(),a=!0,c=0,h=s.length;c<h;c++){var m=s[c];if(["captions","descriptions","subtitles"].indexOf(m.kind)>-1&&m.mode==="showing"){a=!1;break}}a&&(this.player_.cache_.selectedLanguage={enabled:!1})},e}(tb);ei.registerComponent("OffTextTrackMenuItem",NF);var pv=function(r){mi(e,r);function e(i,n){return n===void 0&&(n={}),n.tracks=i.textTracks(),r.call(this,i,n)||this}var t=e.prototype;return t.createItems=function(n,s){n===void 0&&(n=[]),s===void 0&&(s=tb);var a;this.label_&&(a=this.label_+" off"),n.push(new NF(this.player_,{kinds:this.kinds_,kind:this.kind_,label:a})),this.hideThreshold_+=1;var c=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var h=0;h<c.length;h++){var m=c[h];if(this.kinds_.indexOf(m.kind)>-1){var v=new s(this.player_,{track:m,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});v.addClass("vjs-"+m.kind+"-menu-item"),n.push(v)}}return n},e}(qC);ei.registerComponent("TextTrackButton",pv);var UF=function(r){mi(e,r);function e(i,n){var s,a=n.track,c=n.cue,h=i.currentTime();return n.selectable=!0,n.multiSelectable=!1,n.label=c.text,n.selected=c.startTime<=h&&h<c.endTime,s=r.call(this,i,n)||this,s.track=a,s.cue=c,s}var t=e.prototype;return t.handleClick=function(n){r.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime)},e}(eb);ei.registerComponent("ChaptersTrackMenuItem",UF);var XC=function(r){mi(e,r);function e(i,n,s){var a;return a=r.call(this,i,n,s)||this,a.selectCurrentItem_=function(){a.items.forEach(function(c){c.selected(a.track_.activeCues[0]===c.cue)})},a}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-chapters-button "+r.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-chapters-button "+r.prototype.buildWrapperCSSClass.call(this)},t.update=function(n){if(!(n&&n.track&&n.track.kind!=="chapters")){var s=this.findChaptersTrack();s!==this.track_?(this.setTrack(s),r.prototype.update.call(this)):(!this.items||s&&s.cues&&s.cues.length!==this.items.length)&&r.prototype.update.call(this)}},t.setTrack=function(n){if(this.track_!==n){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var s=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);s&&s.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=n,this.track_){this.track_.mode="hidden";var a=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);a&&a.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}},t.findChaptersTrack=function(){for(var n=this.player_.textTracks()||[],s=n.length-1;s>=0;s--){var a=n[s];if(a.kind===this.kind_)return a}},t.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(ha(this.kind_))},t.createMenu=function(){return this.options_.title=this.getMenuCaption(),r.prototype.createMenu.call(this)},t.createItems=function(){var n=[];if(!this.track_)return n;var s=this.track_.cues;if(!s)return n;for(var a=0,c=s.length;a<c;a++){var h=s[a],m=new UF(this.player_,{track:this.track_,cue:h});n.push(m)}return n},e}(pv);XC.prototype.kind_="chapters";XC.prototype.controlText_="Chapters";ei.registerComponent("ChaptersButton",XC);var YC=function(r){mi(e,r);function e(i,n,s){var a;a=r.call(this,i,n,s)||this;var c=i.textTracks(),h=ys(Tn(a),a.handleTracksChange);return c.addEventListener("change",h),a.on("dispose",function(){c.removeEventListener("change",h)}),a}var t=e.prototype;return t.handleTracksChange=function(n){for(var s=this.player().textTracks(),a=!1,c=0,h=s.length;c<h;c++){var m=s[c];if(m.kind!==this.kind_&&m.mode==="showing"){a=!0;break}}a?this.disable():this.enable()},t.buildCSSClass=function(){return"vjs-descriptions-button "+r.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+r.prototype.buildWrapperCSSClass.call(this)},e}(pv);YC.prototype.kind_="descriptions";YC.prototype.controlText_="Descriptions";ei.registerComponent("DescriptionsButton",YC);var QC=function(r){mi(e,r);function e(i,n,s){return r.call(this,i,n,s)||this}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-subtitles-button "+r.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+r.prototype.buildWrapperCSSClass.call(this)},e}(pv);QC.prototype.kind_="subtitles";QC.prototype.controlText_="Subtitles";ei.registerComponent("SubtitlesButton",QC);var KC=function(r){mi(e,r);function e(i,n){var s;return n.track={player:i,kind:n.kind,label:n.kind+" settings",selectable:!1,default:!1,mode:"disabled"},n.selectable=!1,n.name="CaptionSettingsMenuItem",s=r.call(this,i,n)||this,s.addClass("vjs-texttrack-settings"),s.controlText(", opens "+n.kind+" settings dialog"),s}var t=e.prototype;return t.handleClick=function(n){this.player().getChild("textTrackSettings").open()},e}(tb);ei.registerComponent("CaptionSettingsMenuItem",KC);var ZC=function(r){mi(e,r);function e(i,n,s){return r.call(this,i,n,s)||this}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-captions-button "+r.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-captions-button "+r.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(){var n=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(n.push(new KC(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),r.prototype.createItems.call(this,n)},e}(pv);ZC.prototype.kind_="captions";ZC.prototype.controlText_="Captions";ei.registerComponent("CaptionsButton",ZC);var VF=function(r){mi(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.createEl=function(n,s,a){var c=r.prototype.createEl.call(this,n,s,a),h=c.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(h.appendChild(xr("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),h.appendChild(xr("span",{className:"vjs-control-text",textContent:" "+this.localize("Captions")}))),c},e}(tb);ei.registerComponent("SubsCapsMenuItem",VF);var JC=function(r){mi(e,r);function e(i,n){var s;return n===void 0&&(n={}),s=r.call(this,i,n)||this,s.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(s.player_.language_)>-1&&(s.label_="captions"),s.menuButton_.controlText(ha(s.label_)),s}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-subs-caps-button "+r.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+r.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(){var n=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(n.push(new KC(this.player_,{kind:this.label_})),this.hideThreshold_+=1),n=r.prototype.createItems.call(this,n,VF),n},e}(pv);JC.prototype.kinds_=["captions","subtitles"];JC.prototype.controlText_="Subtitles";ei.registerComponent("SubsCapsButton",JC);var zF=function(r){mi(e,r);function e(i,n){var s,a=n.track,c=i.audioTracks();n.label=a.label||a.language||"Unknown",n.selected=a.enabled,s=r.call(this,i,n)||this,s.track=a,s.addClass("vjs-"+a.kind+"-menu-item");var h=function(){for(var v=arguments.length,b=new Array(v),x=0;x<v;x++)b[x]=arguments[x];s.handleTracksChange.apply(Tn(s),b)};return c.addEventListener("change",h),s.on("dispose",function(){c.removeEventListener("change",h)}),s}var t=e.prototype;return t.createEl=function(n,s,a){var c=r.prototype.createEl.call(this,n,s,a),h=c.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="main-desc"&&(h.appendChild(xr("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),h.appendChild(xr("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),c},t.handleClick=function(n){if(r.prototype.handleClick.call(this,n),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks)for(var s=this.player_.audioTracks(),a=0;a<s.length;a++){var c=s[a];c!==this.track&&(c.enabled=c===this.track)}},t.handleTracksChange=function(n){this.selected(this.track.enabled)},e}(eb);ei.registerComponent("AudioTrackMenuItem",zF);var HF=function(r){mi(e,r);function e(i,n){return n===void 0&&(n={}),n.tracks=i.audioTracks(),r.call(this,i,n)||this}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-audio-button "+r.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-audio-button "+r.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(n){n===void 0&&(n=[]),this.hideThreshold_=1;for(var s=this.player_.audioTracks(),a=0;a<s.length;a++){var c=s[a];n.push(new zF(this.player_,{track:c,selectable:!0,multiSelectable:!1}))}return n},e}(qC);HF.prototype.controlText_="Audio Track";ei.registerComponent("AudioTrackButton",HF);var eM=function(r){mi(e,r);function e(i,n){var s,a=n.rate,c=parseFloat(a,10);return n.label=a,n.selected=c===i.playbackRate(),n.selectable=!0,n.multiSelectable=!1,s=r.call(this,i,n)||this,s.label=a,s.rate=c,s.on(i,"ratechange",function(h){return s.update(h)}),s}var t=e.prototype;return t.handleClick=function(n){r.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},t.update=function(n){this.selected(this.player().playbackRate()===this.rate)},e}(eb);eM.prototype.contentElType="button";ei.registerComponent("PlaybackRateMenuItem",eM);var jF=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.menuButton_.el_.setAttribute("aria-describedby",s.labelElId_),s.updateVisibility(),s.updateLabel(),s.on(i,"loadstart",function(a){return s.updateVisibility(a)}),s.on(i,"ratechange",function(a){return s.updateLabel(a)}),s.on(i,"playbackrateschange",function(a){return s.handlePlaybackRateschange(a)}),s}var t=e.prototype;return t.createEl=function(){var n=r.prototype.createEl.call(this);return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=xr("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),n.appendChild(this.labelEl_),n},t.dispose=function(){this.labelEl_=null,r.prototype.dispose.call(this)},t.buildCSSClass=function(){return"vjs-playback-rate "+r.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-playback-rate "+r.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(){for(var n=this.playbackRates(),s=[],a=n.length-1;a>=0;a--)s.push(new eM(this.player(),{rate:n[a]+"x"}));return s},t.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},t.handleClick=function(n){var s=this.player().playbackRate(),a=this.playbackRates(),c=a.indexOf(s),h=(c+1)%a.length;this.player().playbackRate(a[h])},t.handlePlaybackRateschange=function(n){this.update()},t.playbackRates=function(){var n=this.player();return n.playbackRates&&n.playbackRates()||[]},t.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},t.updateVisibility=function(n){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},t.updateLabel=function(n){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")},e}(WC);jF.prototype.controlText_="Playback Rate";ei.registerComponent("PlaybackRateMenuButton",jF);var GF=function(r){mi(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-spacer "+r.prototype.buildCSSClass.call(this)},t.createEl=function(n,s,a){return n===void 0&&(n="div"),s===void 0&&(s={}),a===void 0&&(a={}),s.className||(s.className=this.buildCSSClass()),r.prototype.createEl.call(this,n,s,a)},e}(ei);ei.registerComponent("Spacer",GF);var TW=function(r){mi(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-custom-control-spacer "+r.prototype.buildCSSClass.call(this)},t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),textContent:""})},e}(GF);ei.registerComponent("CustomControlSpacer",TW);var Ix=function(r){mi(e,r);function e(){return r.apply(this,arguments)||this}var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},e}(ei);Ix.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]};"exitPictureInPicture"in ot&&Ix.prototype.options_.children.splice(Ix.prototype.options_.children.length-1,0,"pictureInPictureToggle");ei.registerComponent("ControlBar",Ix);var $F=function(r){mi(e,r);function e(i,n){var s;return s=r.call(this,i,n)||this,s.on(i,"error",function(a){return s.open(a)}),s}var t=e.prototype;return t.buildCSSClass=function(){return"vjs-error-display "+r.prototype.buildCSSClass.call(this)},t.content=function(){var n=this.player().error();return n?this.localize(n.message):""},e}(dv);$F.prototype.options_=zr({},dv.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});ei.registerComponent("ErrorDisplay",$F);var kw="vjs-text-track-settings",q3=["#000","Black"],X3=["#00F","Blue"],Y3=["#0FF","Cyan"],Q3=["#0F0","Green"],K3=["#F0F","Magenta"],Z3=["#F00","Red"],J3=["#FFF","White"],eP=["#FF0","Yellow"],Ow=["1","Opaque"],Fw=["0.5","Semi-Transparent"],tP=["0","Transparent"],Dm={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[q3,J3,Z3,Q3,X3,eP,K3,Y3]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Ow,Fw,tP]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[J3,q3,Z3,Q3,X3,eP,K3,Y3]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return e==="1.00"?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Ow,Fw]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[tP,Fw,Ow]}};Dm.windowColor.options=Dm.backgroundColor.options;function WF(r,e){if(e&&(r=e(r)),r&&r!=="none")return r}function xW(r,e){var t=r.options[r.options.selectedIndex].value;return WF(t,e)}function SW(r,e,t){if(e){for(var i=0;i<r.options.length;i++)if(WF(r.options[i].value,t)===e){r.selectedIndex=i;break}}}var AW=function(r){mi(e,r);function e(i,n){var s;return n.temporary=!1,s=r.call(this,i,n)||this,s.updateDisplay=s.updateDisplay.bind(Tn(s)),s.fill(),s.hasBeenOpened_=s.hasBeenFilled_=!0,s.endDialog=xr("p",{className:"vjs-control-text",textContent:s.localize("End of dialog window.")}),s.el().appendChild(s.endDialog),s.setDefaults(),n.persistTextTrackSettings===void 0&&(s.options_.persistTextTrackSettings=s.options_.playerOptions.persistTextTrackSettings),s.on(s.$(".vjs-done-button"),"click",function(){s.saveSettings(),s.close()}),s.on(s.$(".vjs-default-button"),"click",function(){s.setDefaults(),s.updateDisplay()}),S0(Dm,function(a){s.on(s.$(a.selector),"change",s.updateDisplay)}),s.options_.persistTextTrackSettings&&s.restoreSettings(),s}var t=e.prototype;return t.dispose=function(){this.endDialog=null,r.prototype.dispose.call(this)},t.createElSelect_=function(n,s,a){var c=this;s===void 0&&(s=""),a===void 0&&(a="label");var h=Dm[n],m=h.id.replace("%s",this.id_),v=[s,m].join(" ").trim();return["<"+a+' id="'+m+'" class="'+(a==="label"?"vjs-label":"")+'">',this.localize(h.label),"</"+a+">",'<select aria-labelledby="'+v+'">'].concat(h.options.map(function(b){var x=m+"-"+b[1].replace(/\W+/g,"");return['<option id="'+x+'" value="'+b[0]+'" ','aria-labelledby="'+v+" "+x+'">',c.localize(b[1]),"</option>"].join("")})).concat("</select>").join("")},t.createElFgColor_=function(){var n="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+n+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",n),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",n),"</span>","</fieldset>"].join("")},t.createElBgColor_=function(){var n="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+n+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",n),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",n),"</span>","</fieldset>"].join("")},t.createElWinColor_=function(){var n="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+n+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",n),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",n),"</span>","</fieldset>"].join("")},t.createElColors_=function(){return xr("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},t.createElFont_=function(){return xr("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},t.createElControls_=function(){var n=this.localize("restore all settings to the default values");return xr("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+n+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+n+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},t.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},t.label=function(){return this.localize("Caption Settings Dialog")},t.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},t.buildCSSClass=function(){return r.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},t.getValues=function(){var n=this;return h$(Dm,function(s,a,c){var h=xW(n.$(a.selector),a.parser);return h!==void 0&&(s[c]=h),s},{})},t.setValues=function(n){var s=this;S0(Dm,function(a,c){SW(s.$(a.selector),n[c],a.parser)})},t.setDefaults=function(){var n=this;S0(Dm,function(s){var a=s.hasOwnProperty("default")?s.default:0;n.$(s.selector).selectedIndex=a})},t.restoreSettings=function(){var n;try{n=JSON.parse(Z.localStorage.getItem(kw))}catch(s){qn.warn(s)}n&&this.setValues(n)},t.saveSettings=function(){if(this.options_.persistTextTrackSettings){var n=this.getValues();try{Object.keys(n).length?Z.localStorage.setItem(kw,JSON.stringify(n)):Z.localStorage.removeItem(kw)}catch(s){qn.warn(s)}}},t.updateDisplay=function(){var n=this.player_.getChild("textTrackDisplay");n&&n.updateDisplay()},t.conditionalBlur_=function(){this.previouslyActiveEl_=null;var n=this.player_.controlBar,s=n&&n.subsCapsButton,a=n&&n.captionsButton;s?s.focus():a&&a.focus()},e}(dv);ei.registerComponent("TextTrackSettings",AW);var wW=function(r){mi(e,r);function e(i,n){var s,a=n.ResizeObserver||Z.ResizeObserver;n.ResizeObserver===null&&(a=!1);var c=vs({createEl:!a,reportTouchActivity:!1},n);return s=r.call(this,i,c)||this,s.ResizeObserver=n.ResizeObserver||Z.ResizeObserver,s.loadListener_=null,s.resizeObserver_=null,s.debouncedHandler_=S$(function(){s.resizeHandler()},100,!1,Tn(s)),a?(s.resizeObserver_=new s.ResizeObserver(s.debouncedHandler_),s.resizeObserver_.observe(i.el())):(s.loadListener_=function(){if(!(!s.el_||!s.el_.contentWindow)){var h=s.debouncedHandler_,m=s.unloadListener_=function(){Uo(this,"resize",h),Uo(this,"unload",m),m=null};Xu(s.el_.contentWindow,"unload",m),Xu(s.el_.contentWindow,"resize",h)}},s.one("load",s.loadListener_)),s}var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})},t.resizeHandler=function(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")},t.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,r.prototype.dispose.call(this)},e}(ei);ei.registerComponent("ResizeManager",wW);var EW={trackingThreshold:20,liveTolerance:15},CW=function(r){mi(e,r);function e(i,n){var s,a=vs(EW,n,{createEl:!1});return s=r.call(this,i,a)||this,s.handleVisibilityChange_=function(c){return s.handleVisibilityChange(c)},s.trackLiveHandler_=function(){return s.trackLive_()},s.handlePlay_=function(c){return s.handlePlay(c)},s.handleFirstTimeupdate_=function(c){return s.handleFirstTimeupdate(c)},s.handleSeeked_=function(c){return s.handleSeeked(c)},s.seekToLiveEdge_=function(c){return s.seekToLiveEdge(c)},s.reset_(),s.on(s.player_,"durationchange",function(c){return s.handleDurationchange(c)}),s.on(s.player_,"canplay",function(){return s.toggleTracking()}),K_&&"hidden"in ot&&"visibilityState"in ot&&s.on(ot,"visibilitychange",s.handleVisibilityChange_),s}var t=e.prototype;return t.handleVisibilityChange=function(){this.player_.duration()===1/0&&(ot.hidden?this.stopTracking():this.startTracking())},t.trackLive_=function(){var n=this.player_.seekable();if(!(!n||!n.length)){var s=Number(Z.performance.now().toFixed(4)),a=this.lastTime_===-1?0:(s-this.lastTime_)/1e3;this.lastTime_=s,this.pastSeekEnd_=this.pastSeekEnd()+a;var c=this.liveCurrentTime(),h=this.player_.currentTime(),m=this.player_.paused()||this.seekedBehindLive_||Math.abs(c-h)>this.options_.liveTolerance;(!this.timeupdateSeen_||c===1/0)&&(m=!1),m!==this.behindLiveEdge_&&(this.behindLiveEdge_=m,this.trigger("liveedgechange"))}},t.handleDurationchange=function(){this.toggleTracking()},t.toggleTracking=function(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},t.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,Zc),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))},t.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)},t.handleSeeked=function(){var n=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&n>2,this.nextSeekedFromUser_=!1,this.trackLive_()},t.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)},t.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)},t.nextSeekedFromUser=function(){this.nextSeekedFromUser_=!0},t.stopTracking=function(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},t.seekableEnd=function(){for(var n=this.player_.seekable(),s=[],a=n?n.length:0;a--;)s.push(n.end(a));return s.length?s.sort()[s.length-1]:1/0},t.seekableStart=function(){for(var n=this.player_.seekable(),s=[],a=n?n.length:0;a--;)s.push(n.start(a));return s.length?s.sort()[0]:0},t.liveWindow=function(){var n=this.liveCurrentTime();return n===1/0?0:n-this.seekableStart()},t.isLive=function(){return this.isTracking()},t.atLiveEdge=function(){return!this.behindLiveEdge()},t.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},t.pastSeekEnd=function(){var n=this.seekableEnd();return this.lastSeekEnd_!==-1&&n!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=n,this.pastSeekEnd_},t.behindLiveEdge=function(){return this.behindLiveEdge_},t.isTracking=function(){return typeof this.trackingInterval_=="number"},t.seekToLiveEdge=function(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))},t.dispose=function(){this.off(ot,"visibilitychange",this.handleVisibilityChange_),this.stopTracking(),r.prototype.dispose.call(this)},e}(ei);ei.registerComponent("LiveTracker",CW);var WE=function(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var i=e.$$("source"),n=[],s="";if(!i.length)return!1;for(var a=0;a<i.length;a++){var c=i[a].src;c&&n.indexOf(c)===-1&&n.push(c)}return n.length?(n.length===1&&(s=n[0]),e.triggerSourceset(s),!0):!1},MW=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(e){var t=ot.createElement(this.nodeName.toLowerCase());t.innerHTML=e;for(var i=ot.createDocumentFragment();t.childNodes.length;)i.appendChild(t.childNodes[0]);return this.innerText="",Z.Element.prototype.appendChild.call(this,i),this.innerHTML}}),qF=function(e,t){for(var i={},n=0;n<e.length&&(i=Object.getOwnPropertyDescriptor(e[n],t),!(i&&i.set&&i.get));n++);return i.enumerable=!0,i.configurable=!0,i},DW=function(e){return qF([e.el(),Z.HTMLMediaElement.prototype,Z.Element.prototype,MW],"innerHTML")},iP=function(e){var t=e.el();if(!t.resetSourceWatch_){var i={},n=DW(e),s=function(c){return function(){for(var h=arguments.length,m=new Array(h),v=0;v<h;v++)m[v]=arguments[v];var b=c.apply(t,m);return WE(e),b}};["append","appendChild","insertAdjacentHTML"].forEach(function(a){t[a]&&(i[a]=t[a],t[a]=s(i[a]))}),Object.defineProperty(t,"innerHTML",vs(n,{set:s(n.set)})),t.resetSourceWatch_=function(){t.resetSourceWatch_=null,Object.keys(i).forEach(function(a){t[a]=i[a]}),Object.defineProperty(t,"innerHTML",n)},e.one("sourceset",t.resetSourceWatch_)}},IW=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?bF(Z.Element.prototype.getAttribute.call(this,"src")):""},set:function(e){return Z.Element.prototype.setAttribute.call(this,"src",e),e}}),PW=function(e){return qF([e.el(),Z.HTMLMediaElement.prototype,IW],"src")},LW=function(e){if(e.featuresSourceset){var t=e.el();if(!t.resetSourceset_){var i=PW(e),n=t.setAttribute,s=t.load;Object.defineProperty(t,"src",vs(i,{set:function(c){var h=i.set.call(t,c);return e.triggerSourceset(t.src),h}})),t.setAttribute=function(a,c){var h=n.call(t,a,c);return/src/i.test(a)&&e.triggerSourceset(t.src),h},t.load=function(){var a=s.call(t);return WE(e)||(e.triggerSourceset(""),iP(e)),a},t.currentSrc?e.triggerSourceset(t.currentSrc):WE(e)||iP(e),t.resetSourceset_=function(){t.resetSourceset_=null,t.load=s,t.setAttribute=n,Object.defineProperty(t,"src",i),t.resetSourceWatch_&&t.resetSourceWatch_()}}}},tM=function(e,t,i,n){n===void 0&&(n=!0);var s=function(h){return Object.defineProperty(e,t,{value:h,enumerable:!0,writable:!0})},a={configurable:!0,enumerable:!0,get:function(){var h=i();return s(h),h}};return n&&(a.set=s),Object.defineProperty(e,t,a)},Ci=function(r){mi(e,r);function e(i,n){var s;s=r.call(this,i,n)||this;var a=i.source,c=!1;if(s.featuresVideoFrameCallback=s.featuresVideoFrameCallback&&s.el_.tagName==="VIDEO",a&&(s.el_.currentSrc!==a.src||i.tag&&i.tag.initNetworkState_===3)?s.setSource(a):s.handleLateInit_(s.el_),i.enableSourceset&&s.setupSourcesetHandling_(),s.isScrubbing_=!1,s.el_.hasChildNodes()){for(var h=s.el_.childNodes,m=h.length,v=[];m--;){var b=h[m],x=b.nodeName.toLowerCase();x==="track"&&(s.featuresNativeTextTracks?(s.remoteTextTrackEls().addTrackElement_(b),s.remoteTextTracks().addTrack(b.track),s.textTracks().addTrack(b.track),!c&&!s.el_.hasAttribute("crossorigin")&&SS(b.src)&&(c=!0)):v.push(b))}for(var C=0;C<v.length;C++)s.el_.removeChild(v[C])}return s.proxyNativeTracks_(),s.featuresNativeTextTracks&&c&&qn.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),s.restoreMetadataTracksInIOSNativePlayer_(),($0||IC||q4)&&i.nativeControlsForTouch===!0&&s.setControls(!0),s.proxyWebkitFullscreen_(),s.triggerReady(),s}var t=e.prototype;return t.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),e.disposeMediaElement(this.el_),this.options_=null,r.prototype.dispose.call(this)},t.setupSourcesetHandling_=function(){LW(this)},t.restoreMetadataTracksInIOSNativePlayer_=function(){var n=this.textTracks(),s,a=function(){s=[];for(var m=0;m<n.length;m++){var v=n[m];v.kind==="metadata"&&s.push({track:v,storedMode:v.mode})}};a(),n.addEventListener("change",a),this.on("dispose",function(){return n.removeEventListener("change",a)});var c=function h(){for(var m=0;m<s.length;m++){var v=s[m];v.track.mode==="disabled"&&v.track.mode!==v.storedMode&&(v.track.mode=v.storedMode)}n.removeEventListener("change",h)};this.on("webkitbeginfullscreen",function(){n.removeEventListener("change",a),n.removeEventListener("change",c),n.addEventListener("change",c)}),this.on("webkitendfullscreen",function(){n.removeEventListener("change",a),n.addEventListener("change",a),n.removeEventListener("change",c)})},t.overrideNative_=function(n,s){var a=this;if(s===this["featuresNative"+n+"Tracks"]){var c=n.toLowerCase();this[c+"TracksListeners_"]&&Object.keys(this[c+"TracksListeners_"]).forEach(function(h){var m=a.el()[c+"Tracks"];m.removeEventListener(h,a[c+"TracksListeners_"][h])}),this["featuresNative"+n+"Tracks"]=!s,this[c+"TracksListeners_"]=null,this.proxyNativeTracksForType_(c)}},t.overrideNativeAudioTracks=function(n){this.overrideNative_("Audio",n)},t.overrideNativeVideoTracks=function(n){this.overrideNative_("Video",n)},t.proxyNativeTracksForType_=function(n){var s=this,a=vc[n],c=this.el()[a.getterName],h=this[a.getterName]();if(!(!this["featuresNative"+a.capitalName+"Tracks"]||!c||!c.addEventListener)){var m={change:function(x){var C={type:"change",target:h,currentTarget:h,srcElement:h};h.trigger(C),n==="text"&&s[Y0.remoteText.getterName]().trigger(C)},addtrack:function(x){h.addTrack(x.track)},removetrack:function(x){h.removeTrack(x.track)}},v=function(){for(var x=[],C=0;C<h.length;C++){for(var B=!1,P=0;P<c.length;P++)if(c[P]===h[C]){B=!0;break}B||x.push(h[C])}for(;x.length;)h.removeTrack(x.shift())};this[a.getterName+"Listeners_"]=m,Object.keys(m).forEach(function(b){var x=m[b];c.addEventListener(b,x),s.on("dispose",function(C){return c.removeEventListener(b,x)})}),this.on("loadstart",v),this.on("dispose",function(b){return s.off("loadstart",v)})}},t.proxyNativeTracks_=function(){var n=this;vc.names.forEach(function(s){n.proxyNativeTracksForType_(s)})},t.createEl=function(){var n=this.options_.tag;if(!n||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(n){var s=n.cloneNode(!0);n.parentNode&&n.parentNode.insertBefore(s,n),e.disposeMediaElement(n),n=s}else{n=ot.createElement("video");var a=this.options_.tag&&ff(this.options_.tag),c=vs({},a);(!$0||this.options_.nativeControlsForTouch!==!0)&&delete c.controls,tF(n,Ks(c,{id:this.options_.techId,class:"vjs-tech"}))}n.playerId=this.options_.playerId}typeof this.options_.preload<"u"&&W0(n,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(n.disablePictureInPicture=this.options_.disablePictureInPicture);for(var h=["loop","muted","playsinline","autoplay"],m=0;m<h.length;m++){var v=h[m],b=this.options_[v];typeof b<"u"&&(b?W0(n,v,v):yS(n,v),n[v]=b)}return n},t.handleLateInit_=function(n){if(!(n.networkState===0||n.networkState===3)){if(n.readyState===0){var s=!1,a=function(){s=!0};this.on("loadstart",a);var c=function(){s||this.trigger("loadstart")};this.on("loadedmetadata",c),this.ready(function(){this.off("loadstart",a),this.off("loadedmetadata",c),s||this.trigger("loadstart")});return}var h=["loadstart"];h.push("loadedmetadata"),n.readyState>=2&&h.push("loadeddata"),n.readyState>=3&&h.push("canplay"),n.readyState>=4&&h.push("canplaythrough"),this.ready(function(){h.forEach(function(m){this.trigger(m)},this)})}},t.setScrubbing=function(n){this.isScrubbing_=n},t.scrubbing=function(){return this.isScrubbing_},t.setCurrentTime=function(n){try{this.isScrubbing_&&this.el_.fastSeek&&vS?this.el_.fastSeek(n):this.el_.currentTime=n}catch(s){qn(s,"Video is not ready. (Video.js)")}},t.duration=function(){var n=this;if(this.el_.duration===1/0&&Pf&&Lf&&this.el_.currentTime===0){var s=function a(){n.el_.currentTime>0&&(n.el_.duration===1/0&&n.trigger("durationchange"),n.off("timeupdate",a))};return this.on("timeupdate",s),NaN}return this.el_.duration||NaN},t.width=function(){return this.el_.offsetWidth},t.height=function(){return this.el_.offsetHeight},t.proxyWebkitFullscreen_=function(){var n=this;if("webkitDisplayingFullscreen"in this.el_){var s=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},a=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",s),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",a),this.on("dispose",function(){n.off("webkitbeginfullscreen",a),n.off("webkitendfullscreen",s)})}},t.supportsFullScreen=function(){if(typeof this.el_.webkitEnterFullScreen=="function"){var n=Z.navigator&&Z.navigator.userAgent||"";if(/Android/.test(n)||!/Chrome|Mac OS X 10.5/.test(n))return!0}return!1},t.enterFullScreen=function(){var n=this.el_;if(n.paused&&n.networkState<=n.HAVE_METADATA)fh(this.el_.play()),this.setTimeout(function(){n.pause();try{n.webkitEnterFullScreen()}catch(s){this.trigger("fullscreenerror",s)}},0);else try{n.webkitEnterFullScreen()}catch(s){this.trigger("fullscreenerror",s)}},t.exitFullScreen=function(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()},t.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},t.requestVideoFrameCallback=function(n){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(n):r.prototype.requestVideoFrameCallback.call(this,n)},t.cancelVideoFrameCallback=function(n){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(n):r.prototype.cancelVideoFrameCallback.call(this,n)},t.src=function(n){if(n===void 0)return this.el_.src;this.setSrc(n)},t.reset=function(){e.resetMediaElement(this.el_)},t.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},t.setControls=function(n){this.el_.controls=!!n},t.addTextTrack=function(n,s,a){return this.featuresNativeTextTracks?this.el_.addTextTrack(n,s,a):r.prototype.addTextTrack.call(this,n,s,a)},t.createRemoteTextTrack=function(n){if(!this.featuresNativeTextTracks)return r.prototype.createRemoteTextTrack.call(this,n);var s=ot.createElement("track");return n.kind&&(s.kind=n.kind),n.label&&(s.label=n.label),(n.language||n.srclang)&&(s.srclang=n.language||n.srclang),n.default&&(s.default=n.default),n.id&&(s.id=n.id),n.src&&(s.src=n.src),s},t.addRemoteTextTrack=function(n,s){var a=r.prototype.addRemoteTextTrack.call(this,n,s);return this.featuresNativeTextTracks&&this.el().appendChild(a),a},t.removeRemoteTextTrack=function(n){if(r.prototype.removeRemoteTextTrack.call(this,n),this.featuresNativeTextTracks)for(var s=this.$$("track"),a=s.length;a--;)(n===s[a]||n===s[a].track)&&this.el().removeChild(s[a])},t.getVideoPlaybackQuality=function(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();var n={};return typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(n.droppedVideoFrames=this.el().webkitDroppedFrameCount,n.totalVideoFrames=this.el().webkitDecodedFrameCount),Z.performance&&typeof Z.performance.now=="function"?n.creationTime=Z.performance.now():Z.performance&&Z.performance.timing&&typeof Z.performance.timing.navigationStart=="number"&&(n.creationTime=Z.Date.now()-Z.performance.timing.navigationStart),n},e}(is);tM(Ci,"TEST_VID",function(){if(lv()){var r=ot.createElement("video"),e=ot.createElement("track");return e.kind="captions",e.srclang="en",e.label="English",r.appendChild(e),r}});Ci.isSupported=function(){try{Ci.TEST_VID.volume=.5}catch{return!1}return!!(Ci.TEST_VID&&Ci.TEST_VID.canPlayType)};Ci.canPlayType=function(r){return Ci.TEST_VID.canPlayType(r)};Ci.canPlaySource=function(r,e){return Ci.canPlayType(r.type)};Ci.canControlVolume=function(){try{var r=Ci.TEST_VID.volume;Ci.TEST_VID.volume=r/2+.1;var e=r!==Ci.TEST_VID.volume;return e&&yl?(Z.setTimeout(function(){Ci&&Ci.prototype&&(Ci.prototype.featuresVolumeControl=r!==Ci.TEST_VID.volume)}),!1):e}catch{return!1}};Ci.canMuteVolume=function(){try{var r=Ci.TEST_VID.muted;return Ci.TEST_VID.muted=!r,Ci.TEST_VID.muted?W0(Ci.TEST_VID,"muted","muted"):yS(Ci.TEST_VID,"muted","muted"),r!==Ci.TEST_VID.muted}catch{return!1}};Ci.canControlPlaybackRate=function(){if(Pf&&Lf&&Y4<58)return!1;try{var r=Ci.TEST_VID.playbackRate;return Ci.TEST_VID.playbackRate=r/2+.1,r!==Ci.TEST_VID.playbackRate}catch{return!1}};Ci.canOverrideAttributes=function(){try{var r=function(){};Object.defineProperty(ot.createElement("video"),"src",{get:r,set:r}),Object.defineProperty(ot.createElement("audio"),"src",{get:r,set:r}),Object.defineProperty(ot.createElement("video"),"innerHTML",{get:r,set:r}),Object.defineProperty(ot.createElement("audio"),"innerHTML",{get:r,set:r})}catch{return!1}return!0};Ci.supportsNativeTextTracks=function(){return vS||yl&&Lf};Ci.supportsNativeVideoTracks=function(){return!!(Ci.TEST_VID&&Ci.TEST_VID.videoTracks)};Ci.supportsNativeAudioTracks=function(){return!!(Ci.TEST_VID&&Ci.TEST_VID.audioTracks)};Ci.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function(r){var e=r[0],t=r[1];tM(Ci.prototype,e,function(){return Ci[t]()},!0)});Ci.prototype.featuresVolumeControl=Ci.canControlVolume();Ci.prototype.movingMediaElementInDOM=!yl;Ci.prototype.featuresFullscreenResize=!0;Ci.prototype.featuresProgressEvents=!0;Ci.prototype.featuresTimeupdateEvents=!0;Ci.prototype.featuresVideoFrameCallback=!!(Ci.TEST_VID&&Ci.TEST_VID.requestVideoFrameCallback);var Px;Ci.patchCanPlayType=function(){CC>=4&&!X4&&!Lf&&(Px=Ci.TEST_VID&&Ci.TEST_VID.constructor.prototype.canPlayType,Ci.TEST_VID.constructor.prototype.canPlayType=function(r){var e=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;return r&&e.test(r)?"maybe":Px.call(this,r)})};Ci.unpatchCanPlayType=function(){var r=Ci.TEST_VID.constructor.prototype.canPlayType;return Px&&(Ci.TEST_VID.constructor.prototype.canPlayType=Px),r};Ci.patchCanPlayType();Ci.disposeMediaElement=function(r){if(r){for(r.parentNode&&r.parentNode.removeChild(r);r.hasChildNodes();)r.removeChild(r.firstChild);r.removeAttribute("src"),typeof r.load=="function"&&function(){try{r.load()}catch{}}()}};Ci.resetMediaElement=function(r){if(r){for(var e=r.querySelectorAll("source"),t=e.length;t--;)r.removeChild(e[t]);r.removeAttribute("src"),typeof r.load=="function"&&function(){try{r.load()}catch{}}()}};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(r){Ci.prototype[r]=function(){return this.el_[r]||this.el_.hasAttribute(r)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(r){Ci.prototype["set"+ha(r)]=function(e){this.el_[r]=e,e?this.el_.setAttribute(r,r):this.el_.removeAttribute(r)}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(r){Ci.prototype[r]=function(){return this.el_[r]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(r){Ci.prototype["set"+ha(r)]=function(e){this.el_[r]=e}});["pause","load","play"].forEach(function(r){Ci.prototype[r]=function(){return this.el_[r]()}});is.withSourceHandlers(Ci);Ci.nativeSourceHandler={};Ci.nativeSourceHandler.canPlayType=function(r){try{return Ci.TEST_VID.canPlayType(r)}catch{return""}};Ci.nativeSourceHandler.canHandleSource=function(r,e){if(r.type)return Ci.nativeSourceHandler.canPlayType(r.type);if(r.src){var t=BC(r.src);return Ci.nativeSourceHandler.canPlayType("video/"+t)}return""};Ci.nativeSourceHandler.handleSource=function(r,e,t){e.setSrc(r.src)};Ci.nativeSourceHandler.dispose=function(){};Ci.registerSourceHandler(Ci.nativeSourceHandler);is.registerTech("Html5",Ci);var XF=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Bw={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},qE=["tiny","xsmall","small","medium","large","xlarge","huge"],CT={};qE.forEach(function(r){var e=r.charAt(0)==="x"?"x-"+r.substring(1):r;CT[r]="vjs-layout-"+e});var RW={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Ta=function(r){mi(e,r);function e(i,n,s){var a;if(i.id=i.id||n.id||"vjs_video_"+Rf(),n=Ks(e.getTagSettings(i),n),n.initChildren=!1,n.createEl=!1,n.evented=!1,n.reportTouchActivity=!1,!n.language)if(typeof i.closest=="function"){var c=i.closest("[lang]");c&&c.getAttribute&&(n.language=c.getAttribute("lang"))}else for(var h=i;h&&h.nodeType===1;){if(ff(h).hasOwnProperty("lang")){n.language=h.getAttribute("lang");break}h=h.parentNode}if(a=r.call(this,null,n,s)||this,a.boundDocumentFullscreenChange_=function(x){return a.documentFullscreenChange_(x)},a.boundFullWindowOnEscKey_=function(x){return a.fullWindowOnEscKey(x)},a.boundUpdateStyleEl_=function(x){return a.updateStyleEl_(x)},a.boundApplyInitTime_=function(x){return a.applyInitTime_(x)},a.boundUpdateCurrentBreakpoint_=function(x){return a.updateCurrentBreakpoint_(x)},a.boundHandleTechClick_=function(x){return a.handleTechClick_(x)},a.boundHandleTechDoubleClick_=function(x){return a.handleTechDoubleClick_(x)},a.boundHandleTechTouchStart_=function(x){return a.handleTechTouchStart_(x)},a.boundHandleTechTouchMove_=function(x){return a.handleTechTouchMove_(x)},a.boundHandleTechTouchEnd_=function(x){return a.handleTechTouchEnd_(x)},a.boundHandleTechTap_=function(x){return a.handleTechTap_(x)},a.isFullscreen_=!1,a.log=G4(a.id_),a.fsApi_=Ex,a.isPosterFromTech_=!1,a.queuedCallbacks_=[],a.isReady_=!1,a.hasStarted_=!1,a.userActive_=!1,a.debugEnabled_=!1,a.audioOnlyMode_=!1,a.audioPosterMode_=!1,a.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!a.options_||!a.options_.techOrder||!a.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(a.tag=i,a.tagAttributes=i&&ff(i),a.language(a.options_.language),n.languages){var m={};Object.getOwnPropertyNames(n.languages).forEach(function(x){m[x.toLowerCase()]=n.languages[x]}),a.languages_=m}else a.languages_=e.prototype.options_.languages;a.resetCache_(),a.poster_=n.poster||"",a.controls_=!!n.controls,i.controls=!1,i.removeAttribute("controls"),a.changingSrc_=!1,a.playCallbacks_=[],a.playTerminatedQueue_=[],i.hasAttribute("autoplay")?a.autoplay(!0):a.autoplay(a.options_.autoplay),n.plugins&&Object.keys(n.plugins).forEach(function(x){if(typeof a[x]!="function")throw new Error('plugin "'+x+'" does not exist')}),a.scrubbing_=!1,a.el_=a.createEl(),kC(Tn(a),{eventBusKey:"el_"}),a.fsApi_.requestFullscreen&&(Xu(ot,a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_),a.on(a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_)),a.fluid_&&a.on(["playerreset","resize"],a.boundUpdateStyleEl_);var v=vs(a.options_);n.plugins&&Object.keys(n.plugins).forEach(function(x){a[x](n.plugins[x])}),n.debug&&a.debug(!0),a.options_.playerOptions=v,a.middleware_=[],a.playbackRates(n.playbackRates),a.initChildren(),a.isAudio(i.nodeName.toLowerCase()==="audio"),a.controls()?a.addClass("vjs-controls-enabled"):a.addClass("vjs-controls-disabled"),a.el_.setAttribute("role","region"),a.isAudio()?a.el_.setAttribute("aria-label",a.localize("Audio Player")):a.el_.setAttribute("aria-label",a.localize("Video Player")),a.isAudio()&&a.addClass("vjs-audio"),a.flexNotSupported_()&&a.addClass("vjs-no-flex"),$0&&a.addClass("vjs-touch-enabled"),yl||a.addClass("vjs-workinghover"),e.players[a.id_]=Tn(a);var b=z4.split(".")[0];return a.addClass("vjs-v"+b),a.userActive(!0),a.reportUserActivity(),a.one("play",function(x){return a.listenForUserActivity_(x)}),a.on("stageclick",function(x){return a.handleStageClick_(x)}),a.on("keydown",function(x){return a.handleKeyDown(x)}),a.on("languagechange",function(x){return a.handleLanguagechange(x)}),a.breakpoints(a.options_.breakpoints),a.responsive(a.options_.responsive),a.on("ready",function(){a.audioPosterMode(a.options_.audioPosterMode),a.audioOnlyMode(a.options_.audioOnlyMode)}),a}var t=e.prototype;return t.dispose=function(){var n=this;this.trigger("dispose"),this.off("dispose"),Uo(ot,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),Uo(ot,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),e.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),J$(this),dl.names.forEach(function(s){var a=dl[s],c=n[a.getterName]();c&&c.off&&c.off()}),r.prototype.dispose.call(this,{restoreEl:this.options_.restoreEl})},t.createEl=function(){var n=this.tag,s,a=this.playerElIngest_=n.parentNode&&n.parentNode.hasAttribute&&n.parentNode.hasAttribute("data-vjs-player"),c=this.tag.tagName.toLowerCase()==="video-js";a?s=this.el_=n.parentNode:c||(s=this.el_=r.prototype.createEl.call(this,"div"));var h=ff(n);if(c){for(s=this.el_=n,n=this.tag=ot.createElement("video");s.children.length;)n.appendChild(s.firstChild);qm(s,"video-js")||Sf(s,"video-js"),s.appendChild(n),a=this.playerElIngest_=s,Object.keys(s).forEach(function(B){try{n[B]=s[B]}catch{}})}if(n.setAttribute("tabindex","-1"),h.tabindex="-1",(K_||Lf&&Q4)&&(n.setAttribute("role","application"),h.role="application"),n.removeAttribute("width"),n.removeAttribute("height"),"width"in h&&delete h.width,"height"in h&&delete h.height,Object.getOwnPropertyNames(h).forEach(function(B){c&&B==="class"||s.setAttribute(B,h[B]),c&&n.setAttribute(B,h[B])}),n.playerId=n.id,n.id+="_html5_api",n.className="vjs-tech",n.player=s.player=this,this.addClass("vjs-paused"),Z.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=dF("vjs-styles-dimensions");var m=kp(".vjs-styles-defaults"),v=kp("head");v.insertBefore(this.styleEl_,m?m.nextSibling:v.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var b=n.getElementsByTagName("a"),x=0;x<b.length;x++){var C=b.item(x);Sf(C,"vjs-hidden"),C.setAttribute("hidden","hidden")}return n.initNetworkState_=n.networkState,n.parentNode&&!a&&n.parentNode.insertBefore(s,n),UE(n,s),this.children_.unshift(n),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=s,s},t.crossOrigin=function(n){if(!n)return this.techGet_("crossOrigin");if(n!=="anonymous"&&n!=="use-credentials"){qn.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+n+'"');return}this.techCall_("setCrossOrigin",n)},t.width=function(n){return this.dimension("width",n)},t.height=function(n){return this.dimension("height",n)},t.dimension=function(n,s){var a=n+"_";if(s===void 0)return this[a]||0;if(s===""||s==="auto"){this[a]=void 0,this.updateStyleEl_();return}var c=parseFloat(s);if(isNaN(c)){qn.error('Improper value "'+s+'" supplied for for '+n);return}this[a]=c,this.updateStyleEl_()},t.fluid=function(n){var s=this;if(n===void 0)return!!this.fluid_;this.fluid_=!!n,Af(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),n?(this.addClass("vjs-fluid"),this.fill(!1),A$(this,function(){s.on(["playerreset","resize"],s.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()},t.fill=function(n){if(n===void 0)return!!this.fill_;this.fill_=!!n,n?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},t.aspectRatio=function(n){if(n===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(n))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=n,this.fluid(!0),this.updateStyleEl_()},t.updateStyleEl_=function(){if(Z.VIDEOJS_NO_DYNAMIC_STYLE===!0){var n=typeof this.width_=="number"?this.width_:this.options_.width,s=typeof this.height_=="number"?this.height_:this.options_.height,a=this.tech_&&this.tech_.el();a&&(n>=0&&(a.width=n),s>=0&&(a.height=s));return}var c,h,m,v;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?m=this.aspectRatio_:this.videoWidth()>0?m=this.videoWidth()+":"+this.videoHeight():m="16:9";var b=m.split(":"),x=b[1]/b[0];this.width_!==void 0?c=this.width_:this.height_!==void 0?c=this.height_/x:c=this.videoWidth()||300,this.height_!==void 0?h=this.height_:h=c*x,/^[^a-zA-Z]/.test(this.id())?v="dimensions-"+this.id():v=this.id()+"-dimensions",this.addClass(v),hF(this.styleEl_,`
      .`+v+` {
        width: `+c+`px;
        height: `+h+`px;
      }

      .`+v+`.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: `+x*100+`%;
      }
    `)},t.loadTech_=function(n,s){var a=this;this.tech_&&this.unloadTech_();var c=ha(n),h=n.charAt(0).toLowerCase()+n.slice(1);c!=="Html5"&&this.tag&&(is.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=c,this.isReady_=!1;var m=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(m=!1);var v={source:s,autoplay:m,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+h+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};dl.names.forEach(function(x){var C=dl[x];v[C.getterName]=a[C.privateName]}),Ks(v,this.options_[c]),Ks(v,this.options_[h]),Ks(v,this.options_[n.toLowerCase()]),this.tag&&(v.tag=this.tag),s&&s.src===this.cache_.src&&this.cache_.currentTime>0&&(v.startTime=this.cache_.currentTime);var b=is.getTech(n);if(!b)throw new Error("No Tech named '"+c+"' exists! '"+c+"' should be registered using videojs.registerTech()'");this.tech_=new b(v),this.tech_.ready(ys(this,this.handleTechReady_),!0),B3.jsonToTextTracks(this.textTracksJson_||[],this.tech_),XF.forEach(function(x){a.on(a.tech_,x,function(C){return a["handleTech"+ha(x)+"_"](C)})}),Object.keys(Bw).forEach(function(x){a.on(a.tech_,x,function(C){if(a.tech_.playbackRate()===0&&a.tech_.seeking()){a.queuedCallbacks_.push({callback:a["handleTech"+Bw[x]+"_"].bind(a),event:C});return}a["handleTech"+Bw[x]+"_"](C)})}),this.on(this.tech_,"loadstart",function(x){return a.handleTechLoadStart_(x)}),this.on(this.tech_,"sourceset",function(x){return a.handleTechSourceset_(x)}),this.on(this.tech_,"waiting",function(x){return a.handleTechWaiting_(x)}),this.on(this.tech_,"ended",function(x){return a.handleTechEnded_(x)}),this.on(this.tech_,"seeking",function(x){return a.handleTechSeeking_(x)}),this.on(this.tech_,"play",function(x){return a.handleTechPlay_(x)}),this.on(this.tech_,"firstplay",function(x){return a.handleTechFirstPlay_(x)}),this.on(this.tech_,"pause",function(x){return a.handleTechPause_(x)}),this.on(this.tech_,"durationchange",function(x){return a.handleTechDurationChange_(x)}),this.on(this.tech_,"fullscreenchange",function(x,C){return a.handleTechFullscreenChange_(x,C)}),this.on(this.tech_,"fullscreenerror",function(x,C){return a.handleTechFullscreenError_(x,C)}),this.on(this.tech_,"enterpictureinpicture",function(x){return a.handleTechEnterPictureInPicture_(x)}),this.on(this.tech_,"leavepictureinpicture",function(x){return a.handleTechLeavePictureInPicture_(x)}),this.on(this.tech_,"error",function(x){return a.handleTechError_(x)}),this.on(this.tech_,"posterchange",function(x){return a.handleTechPosterChange_(x)}),this.on(this.tech_,"textdata",function(x){return a.handleTechTextData_(x)}),this.on(this.tech_,"ratechange",function(x){return a.handleTechRateChange_(x)}),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(c!=="Html5"||!this.tag)&&UE(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},t.unloadTech_=function(){var n=this;dl.names.forEach(function(s){var a=dl[s];n[a.privateName]=n[a.getterName]()}),this.textTracksJson_=B3.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},t.tech=function(n){return n===void 0&&qn.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_},t.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)},t.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)},t.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},t.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())},t.manualAutoplay_=function(n){var s=this;if(!(!this.tech_||typeof n!="string")){var a=function(){var m=s.muted();s.muted(!0);var v=function(){s.muted(m)};s.playTerminatedQueue_.push(v);var b=s.play();if(m_(b))return b.catch(function(x){throw v(),new Error("Rejection at manualAutoplay. Restoring muted value. "+(x||""))})},c;if(n==="any"&&!this.muted()?(c=this.play(),m_(c)&&(c=c.catch(a))):n==="muted"&&!this.muted()?c=a():c=this.play(),!!m_(c))return c.then(function(){s.trigger({type:"autoplay-success",autoplay:n})}).catch(function(){s.trigger({type:"autoplay-failure",autoplay:n})})}},t.updateSourceCaches_=function(n){n===void 0&&(n="");var s=n,a="";typeof s!="string"&&(s=n.src,a=n.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],s&&!a&&(a=iW(this,s)),this.cache_.source=vs({},n,{src:s,type:a});for(var c=this.cache_.sources.filter(function(C){return C.src&&C.src===s}),h=[],m=this.$$("source"),v=[],b=0;b<m.length;b++){var x=ff(m[b]);h.push(x),x.src&&x.src===s&&v.push(x.src)}v.length&&!c.length?this.cache_.sources=h:c.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=s},t.handleTechSourceset_=function(n){var s=this;if(!this.changingSrc_){var a=function(v){return s.updateSourceCaches_(v)},c=this.currentSource().src,h=n.src;c&&!/^blob:/.test(c)&&/^blob:/.test(h)&&(!this.lastSource_||this.lastSource_.tech!==h&&this.lastSource_.player!==c)&&(a=function(){}),a(h),n.src||this.tech_.any(["sourceset","loadstart"],function(m){if(m.type!=="sourceset"){var v=s.techGet("currentSrc");s.lastSource_.tech=v,s.updateSourceCaches_(v)}})}this.lastSource_={player:this.currentSource().src,tech:n.src},this.trigger({src:n.src,type:"sourceset"})},t.hasStarted=function(n){if(n===void 0)return this.hasStarted_;n!==this.hasStarted_&&(this.hasStarted_=n,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},t.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},t.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(function(n){return n.callback(n.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},t.handleTechWaiting_=function(){var n=this;this.addClass("vjs-waiting"),this.trigger("waiting");var s=this.currentTime(),a=function c(){s!==n.currentTime()&&(n.removeClass("vjs-waiting"),n.off("timeupdate",c))};this.on("timeupdate",a)},t.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},t.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},t.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},t.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},t.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},t.handleTechFirstPlay_=function(){this.options_.starttime&&(qn.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},t.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},t.handleTechEnded_=function(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},t.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},t.handleTechClick_=function(n){this.controls_&&(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,n):this.paused()?fh(this.play()):this.pause())},t.handleTechDoubleClick_=function(n){if(this.controls_){var s=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(a){return a.contains(n.target)});s||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,n):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}},t.handleTechTap_=function(){this.userActive(!this.userActive())},t.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},t.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},t.handleTechTouchEnd_=function(n){n.cancelable&&n.preventDefault()},t.handleStageClick_=function(){this.reportUserActivity()},t.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},t.documentFullscreenChange_=function(n){var s=n.target.player;if(!(s&&s!==this)){var a=this.el(),c=ot[this.fsApi_.fullscreenElement]===a;!c&&a.matches?c=a.matches(":"+this.fsApi_.fullscreen):!c&&a.msMatchesSelector&&(c=a.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(c)}},t.handleTechFullscreenChange_=function(n,s){var a=this;s&&(s.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",function(){a.removeClass("vjs-ios-native-fs")})),this.isFullscreen(s.isFullscreen))},t.handleTechFullscreenError_=function(n,s){this.trigger("fullscreenerror",s)},t.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},t.handleTechEnterPictureInPicture_=function(n){this.isInPictureInPicture(!0)},t.handleTechLeavePictureInPicture_=function(n){this.isInPictureInPicture(!1)},t.handleTechError_=function(){var n=this.tech_.error();this.error(n)},t.handleTechTextData_=function(){var n=null;arguments.length>1&&(n=arguments[1]),this.trigger("textdata",n)},t.getCache=function(){return this.cache_},t.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}},t.techCall_=function(n,s){this.ready(function(){if(n in K$)return Y$(this.middleware_,this.tech_,n,s);if(n in j3)return H3(this.middleware_,this.tech_,n,s);try{this.tech_&&this.tech_[n](s)}catch(a){throw qn(a),a}},!0)},t.techGet_=function(n){if(!(!this.tech_||!this.tech_.isReady_)){if(n in Q$)return X$(this.middleware_,this.tech_,n);if(n in j3)return H3(this.middleware_,this.tech_,n);try{return this.tech_[n]()}catch(s){throw this.tech_[n]===void 0?(qn("Video.js: "+n+" method not defined for "+this.techName_+" playback technology.",s),s):s.name==="TypeError"?(qn("Video.js: "+n+" unavailable on "+this.techName_+" playback technology element.",s),this.tech_.isReady_=!1,s):(qn(s),s)}}},t.play=function(){var n=this,s=this.options_.Promise||Z.Promise;return s?new s(function(a){n.play_(a)}):this.play_()},t.play_=function(n){var s=this;n===void 0&&(n=fh),this.playCallbacks_.push(n);var a=!!(!this.changingSrc_&&(this.src()||this.currentSrc())),c=!!(vS||yl);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!a){this.waitToPlay_=function(v){s.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!a&&c&&this.load();return}var h=this.techGet_("play"),m=c&&this.hasClass("vjs-ended");m&&this.resetProgressBar_(),h===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(h)},t.runPlayTerminatedQueue_=function(){var n=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],n.forEach(function(s){s()})},t.runPlayCallbacks_=function(n){var s=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],s.forEach(function(a){a(n)})},t.pause=function(){this.techCall_("pause")},t.paused=function(){return this.techGet_("paused")!==!1},t.played=function(){return this.techGet_("played")||Xm(0,0)},t.scrubbing=function(n){if(typeof n>"u")return this.scrubbing_;this.scrubbing_=!!n,this.techCall_("setScrubbing",this.scrubbing_),n?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},t.currentTime=function(n){if(typeof n<"u"){if(n<0&&(n=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=n,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",n),this.cache_.initTime=0;return}return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime},t.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},t.duration=function(n){if(n===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;n=parseFloat(n),n<0&&(n=1/0),n!==this.cache_.duration&&(this.cache_.duration=n,n===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(n)||this.trigger("durationchange"))},t.remainingTime=function(){return this.duration()-this.currentTime()},t.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},t.buffered=function(){var n=this.techGet_("buffered");return(!n||!n.length)&&(n=Xm(0,0)),n},t.bufferedPercent=function(){return yF(this.buffered(),this.duration())},t.bufferedEnd=function(){var n=this.buffered(),s=this.duration(),a=n.end(n.length-1);return a>s&&(a=s),a},t.volume=function(n){var s;if(n!==void 0){s=Math.max(0,Math.min(1,parseFloat(n))),this.cache_.volume=s,this.techCall_("setVolume",s),s>0&&this.lastVolume_(s);return}return s=parseFloat(this.techGet_("volume")),isNaN(s)?1:s},t.muted=function(n){if(n!==void 0){this.techCall_("setMuted",n);return}return this.techGet_("muted")||!1},t.defaultMuted=function(n){return n!==void 0?this.techCall_("setDefaultMuted",n):this.techGet_("defaultMuted")||!1},t.lastVolume_=function(n){if(n!==void 0&&n!==0){this.cache_.lastVolume=n;return}return this.cache_.lastVolume},t.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},t.isFullscreen=function(n){if(n!==void 0){var s=this.isFullscreen_;this.isFullscreen_=!!n,this.isFullscreen_!==s&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_},t.requestFullscreen=function(n){var s=this.options_.Promise||Z.Promise;if(s){var a=this;return new s(function(c,h){function m(){a.off("fullscreenerror",b),a.off("fullscreenchange",v)}function v(){m(),c()}function b(C,B){m(),h(B)}a.one("fullscreenchange",v),a.one("fullscreenerror",b);var x=a.requestFullscreenHelper_(n);x&&(x.then(m,m),x.then(c,h))})}return this.requestFullscreenHelper_()},t.requestFullscreenHelper_=function(n){var s=this,a;if(this.fsApi_.prefixed||(a=this.options_.fullscreen&&this.options_.fullscreen.options||{},n!==void 0&&(a=n)),this.fsApi_.requestFullscreen){var c=this.el_[this.fsApi_.requestFullscreen](a);return c&&c.then(function(){return s.isFullscreen(!0)},function(){return s.isFullscreen(!1)}),c}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()},t.exitFullscreen=function(){var n=this.options_.Promise||Z.Promise;if(n){var s=this;return new n(function(a,c){function h(){s.off("fullscreenerror",v),s.off("fullscreenchange",m)}function m(){h(),a()}function v(x,C){h(),c(C)}s.one("fullscreenchange",m),s.one("fullscreenerror",v);var b=s.exitFullscreenHelper_();b&&(b.then(h,h),b.then(a,c))})}return this.exitFullscreenHelper_()},t.exitFullscreenHelper_=function(){var n=this;if(this.fsApi_.requestFullscreen){var s=ot[this.fsApi_.exitFullscreen]();return s&&fh(s.then(function(){return n.isFullscreen(!1)})),s}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()},t.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=ot.documentElement.style.overflow,Xu(ot,"keydown",this.boundFullWindowOnEscKey_),ot.documentElement.style.overflow="hidden",Sf(ot.body,"vjs-full-window"),this.trigger("enterFullWindow")},t.fullWindowOnEscKey=function(n){wn.isEventKey(n,"Esc")&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())},t.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,Uo(ot,"keydown",this.boundFullWindowOnEscKey_),ot.documentElement.style.overflow=this.docOrigOverflow,Z_(ot.body,"vjs-full-window"),this.trigger("exitFullWindow")},t.disablePictureInPicture=function(n){if(n===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",n),this.options_.disablePictureInPicture=n,this.trigger("disablepictureinpicturechanged")},t.isInPictureInPicture=function(n){if(n!==void 0){this.isInPictureInPicture_=!!n,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_},t.requestPictureInPicture=function(){if("pictureInPictureEnabled"in ot&&this.disablePictureInPicture()===!1)return this.techGet_("requestPictureInPicture")},t.exitPictureInPicture=function(){if("pictureInPictureEnabled"in ot)return ot.exitPictureInPicture()},t.handleKeyDown=function(n){var s=this.options_.userActions;if(!(!s||!s.hotkeys)){var a=function(h){var m=h.tagName.toLowerCase();if(h.isContentEditable)return!0;var v=["button","checkbox","hidden","radio","reset","submit"];if(m==="input")return v.indexOf(h.type)===-1;var b=["textarea"];return b.indexOf(m)!==-1};a(this.el_.ownerDocument.activeElement)||(typeof s.hotkeys=="function"?s.hotkeys.call(this,n):this.handleHotkeys(n))}},t.handleHotkeys=function(n){var s=this.options_.userActions?this.options_.userActions.hotkeys:{},a=s.fullscreenKey,c=a===void 0?function(P){return wn.isEventKey(P,"f")}:a,h=s.muteKey,m=h===void 0?function(P){return wn.isEventKey(P,"m")}:h,v=s.playPauseKey,b=v===void 0?function(P){return wn.isEventKey(P,"k")||wn.isEventKey(P,"Space")}:v;if(c.call(this,n)){n.preventDefault(),n.stopPropagation();var x=ei.getComponent("FullscreenToggle");ot[this.fsApi_.fullscreenEnabled]!==!1&&x.prototype.handleClick.call(this,n)}else if(m.call(this,n)){n.preventDefault(),n.stopPropagation();var C=ei.getComponent("MuteToggle");C.prototype.handleClick.call(this,n)}else if(b.call(this,n)){n.preventDefault(),n.stopPropagation();var B=ei.getComponent("PlayToggle");B.prototype.handleClick.call(this,n)}},t.canPlayType=function(n){for(var s,a=0,c=this.options_.techOrder;a<c.length;a++){var h=c[a],m=is.getTech(h);if(m||(m=ei.getComponent(h)),!m){qn.error('The "'+h+'" tech is undefined. Skipped browser support check for that tech.');continue}if(m.isSupported()&&(s=m.canPlayType(n),s))return s}return""},t.selectSource=function(n){var s=this,a=this.options_.techOrder.map(function(b){return[b,is.getTech(b)]}).filter(function(b){var x=b[0],C=b[1];return C?C.isSupported():(qn.error('The "'+x+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),c=function(x,C,B){var P;return x.some(function(N){return C.some(function(ae){if(P=B(N,ae),P)return!0})}),P},h,m=function(x){return function(C,B){return x(B,C)}},v=function(x,C){var B=x[0],P=x[1];if(P.canPlaySource(C,s.options_[B.toLowerCase()]))return{source:C,tech:B}};return this.options_.sourceOrder?h=c(n,a,m(v)):h=c(a,n,v),h||!1},t.handleSrc_=function(n,s){var a=this;if(typeof n>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();var c=nW(n);if(!c.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,s||(this.cache_.sources=c),this.updateSourceCaches_(c[0]),W$(this,c[0],function(v,b){a.middleware_=b,s||(a.cache_.sources=c),a.updateSourceCaches_(v);var x=a.src_(v);if(x){if(c.length>1)return a.handleSrc_(c.slice(1));a.changingSrc_=!1,a.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),a.triggerReady();return}q$(b,a.tech_)}),this.options_.retryOnError&&c.length>1){var h=function(){a.error(null),a.handleSrc_(c.slice(1),!0)},m=function(){a.off("error",h)};this.one("error",h),this.one("playing",m),this.resetRetryOnError_=function(){a.off("error",h),a.off("playing",m)}}},t.src=function(n){return this.handleSrc_(n,!1)},t.src_=function(n){var s=this,a=this.selectSource([n]);return a?C$(a.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",n):this.techCall_("src",n.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(a.tech,a.source),this.tech_.ready(function(){s.changingSrc_=!1}),!1):!0},t.load=function(){this.techCall_("load")},t.reset=function(){var n=this,s=this.options_.Promise||Z.Promise;if(this.paused()||!s)this.doReset_();else{var a=this.play();fh(a.then(function(){return n.doReset_()}))}},t.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Af(this)&&this.trigger("playerreset")},t.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},t.resetProgressBar_=function(){this.currentTime(0);var n=this.controlBar||{},s=n.durationDisplay,a=n.remainingTimeDisplay;s&&s.updateContent(),a&&a.updateContent()},t.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},t.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},t.currentSources=function(){var n=this.currentSource(),s=[];return Object.keys(n).length!==0&&s.push(n),this.cache_.sources||s},t.currentSource=function(){return this.cache_.source||{}},t.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},t.currentType=function(){return this.currentSource()&&this.currentSource().type||""},t.preload=function(n){if(n!==void 0){this.techCall_("setPreload",n),this.options_.preload=n;return}return this.techGet_("preload")},t.autoplay=function(n){if(n===void 0)return this.options_.autoplay||!1;var s;typeof n=="string"&&/(any|play|muted)/.test(n)||n===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=n,this.manualAutoplay_(typeof n=="string"?n:"play"),s=!1):n?this.options_.autoplay=!0:this.options_.autoplay=!1,s=typeof s>"u"?this.options_.autoplay:s,this.tech_&&this.techCall_("setAutoplay",s)},t.playsinline=function(n){return n!==void 0?(this.techCall_("setPlaysinline",n),this.options_.playsinline=n,this):this.techGet_("playsinline")},t.loop=function(n){if(n!==void 0){this.techCall_("setLoop",n),this.options_.loop=n;return}return this.techGet_("loop")},t.poster=function(n){if(n===void 0)return this.poster_;n||(n=""),n!==this.poster_&&(this.poster_=n,this.techCall_("setPoster",n),this.isPosterFromTech_=!1,this.trigger("posterchange"))},t.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var n=this.tech_.poster()||"";n!==this.poster_&&(this.poster_=n,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},t.controls=function(n){if(n===void 0)return!!this.controls_;n=!!n,this.controls_!==n&&(this.controls_=n,this.usingNativeControls()&&this.techCall_("setControls",n),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},t.usingNativeControls=function(n){if(n===void 0)return!!this.usingNativeControls_;n=!!n,this.usingNativeControls_!==n&&(this.usingNativeControls_=n,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},t.error=function(n){var s=this;if(n===void 0)return this.error_||null;if(Rp("beforeerror").forEach(function(c){var h=c(s,n);if(!(Ef(h)&&!Array.isArray(h)||typeof h=="string"||typeof h=="number"||h===null)){s.log.error("please return a value that MediaError expects in beforeerror hooks");return}n=h}),this.options_.suppressNotSupportedError&&n&&n.code===4){var a=function(){this.error(n)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],a),this.one("loadstart",function(){this.off(["click","touchstart"],a)});return}if(n===null){this.error_=n,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new vl(n),this.addClass("vjs-error"),qn.error("(CODE:"+this.error_.code+" "+vl.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error"),Rp("error").forEach(function(c){return c(s,s.error_)})},t.reportUserActivity=function(n){this.userActivity_=!0},t.userActive=function(n){if(n===void 0)return this.userActive_;if(n=!!n,n!==this.userActive_){if(this.userActive_=n,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(s){s.stopPropagation(),s.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},t.listenForUserActivity_=function(){var n,s,a,c=ys(this,this.reportUserActivity),h=function(B){(B.screenX!==s||B.screenY!==a)&&(s=B.screenX,a=B.screenY,c())},m=function(){c(),this.clearInterval(n),n=this.setInterval(c,250)},v=function(B){c(),this.clearInterval(n)};this.on("mousedown",m),this.on("mousemove",h),this.on("mouseup",v),this.on("mouseleave",v);var b=this.getChild("controlBar");b&&!yl&&!Pf&&(b.on("mouseenter",function(C){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),b.on("mouseleave",function(C){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",c),this.on("keyup",c);var x;this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(x);var C=this.options_.inactivityTimeout;C<=0||(x=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},C))}},250)},t.playbackRate=function(n){if(n!==void 0){this.techCall_("setPlaybackRate",n);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1},t.defaultPlaybackRate=function(n){return n!==void 0?this.techCall_("setDefaultPlaybackRate",n):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},t.isAudio=function(n){if(n!==void 0){this.isAudio_=!!n;return}return!!this.isAudio_},t.enableAudioOnlyUI_=function(){var n=this;this.addClass("vjs-audio-only-mode");var s=this.children(),a=this.getChild("ControlBar"),c=a&&a.currentHeight();s.forEach(function(h){h!==a&&h.el_&&!h.hasClass("vjs-hidden")&&(h.hide(),n.audioOnlyCache_.hiddenChildren.push(h))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(c),this.trigger("audioonlymodechange")},t.disableAudioOnlyUI_=function(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach(function(n){return n.show()}),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")},t.audioOnlyMode=function(n){var s=this;if(typeof n!="boolean"||n===this.audioOnlyMode_)return this.audioOnlyMode_;this.audioOnlyMode_=n;var a=this.options_.Promise||Z.Promise;if(a){if(n){var c=[];return this.isInPictureInPicture()&&c.push(this.exitPictureInPicture()),this.isFullscreen()&&c.push(this.exitFullscreen()),this.audioPosterMode()&&c.push(this.audioPosterMode(!1)),a.all(c).then(function(){return s.enableAudioOnlyUI_()})}return a.resolve().then(function(){return s.disableAudioOnlyUI_()})}n?(this.isInPictureInPicture()&&this.exitPictureInPicture(),this.isFullscreen()&&this.exitFullscreen(),this.enableAudioOnlyUI_()):this.disableAudioOnlyUI_()},t.enablePosterModeUI_=function(){var n=this.tech_&&this.tech_;n.hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")},t.disablePosterModeUI_=function(){var n=this.tech_&&this.tech_;n.show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")},t.audioPosterMode=function(n){var s=this;if(typeof n!="boolean"||n===this.audioPosterMode_)return this.audioPosterMode_;this.audioPosterMode_=n;var a=this.options_.Promise||Z.Promise;if(a){if(n){if(this.audioOnlyMode()){var c=this.audioOnlyMode(!1);return c.then(function(){s.enablePosterModeUI_()})}return a.resolve().then(function(){s.enablePosterModeUI_()})}return a.resolve().then(function(){s.disablePosterModeUI_()})}if(n){this.audioOnlyMode()&&this.audioOnlyMode(!1),this.enablePosterModeUI_();return}this.disablePosterModeUI_()},t.addTextTrack=function(n,s,a){if(this.tech_)return this.tech_.addTextTrack(n,s,a)},t.addRemoteTextTrack=function(n,s){if(this.tech_)return this.tech_.addRemoteTextTrack(n,s)},t.removeRemoteTextTrack=function(n){n===void 0&&(n={});var s=n,a=s.track;if(a||(a=n),this.tech_)return this.tech_.removeRemoteTextTrack(a)},t.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},t.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},t.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},t.language=function(n){if(n===void 0)return this.language_;this.language_!==String(n).toLowerCase()&&(this.language_=String(n).toLowerCase(),Af(this)&&this.trigger("languagechange"))},t.languages=function(){return vs(e.prototype.options_.languages,this.languages_)},t.toJSON=function(){var n=vs(this.options_),s=n.tracks;n.tracks=[];for(var a=0;a<s.length;a++){var c=s[a];c=vs(c),c.player=void 0,n.tracks[a]=c}return n},t.createModal=function(n,s){var a=this;s=s||{},s.content=n||"";var c=new dv(this,s);return this.addChild(c),c.on("dispose",function(){a.removeChild(c)}),c.open(),c},t.updateCurrentBreakpoint_=function(){if(this.responsive())for(var n=this.currentBreakpoint(),s=this.currentWidth(),a=0;a<qE.length;a++){var c=qE[a],h=this.breakpoints_[c];if(s<=h){if(n===c)return;n&&this.removeClass(CT[n]),this.addClass(CT[c]),this.breakpoint_=c;break}}},t.removeCurrentBreakpoint_=function(){var n=this.currentBreakpointClass();this.breakpoint_="",n&&this.removeClass(n)},t.breakpoints=function(n){return n===void 0?Ks(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Ks({},RW,n),this.updateCurrentBreakpoint_(),Ks(this.breakpoints_))},t.responsive=function(n){if(n===void 0)return this.responsive_;n=!!n;var s=this.responsive_;if(n!==s)return this.responsive_=n,n?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),n},t.currentBreakpoint=function(){return this.breakpoint_},t.currentBreakpointClass=function(){return CT[this.breakpoint_]||""},t.loadMedia=function(n,s){var a=this;if(!(!n||typeof n!="object")){this.reset(),this.cache_.media=vs(n);var c=this.cache_.media,h=c.artwork,m=c.poster,v=c.src,b=c.textTracks;!h&&m&&(this.cache_.media.artwork=[{src:m,type:Dx(m)}]),v&&this.src(v),m&&this.poster(m),Array.isArray(b)&&b.forEach(function(x){return a.addRemoteTextTrack(x,!1)}),this.ready(s)}},t.getMedia=function(){if(!this.cache_.media){var n=this.poster(),s=this.currentSources(),a=Array.prototype.map.call(this.remoteTextTracks(),function(h){return{kind:h.kind,label:h.label,language:h.language,src:h.src}}),c={src:s,textTracks:a};return n&&(c.poster=n,c.artwork=[{src:c.poster,type:Dx(c.poster)}]),c}return vs(this.cache_.media)},e.getTagSettings=function(n){var s={sources:[],tracks:[]},a=ff(n),c=a["data-setup"];if(qm(n,"vjs-fill")&&(a.fill=!0),qm(n,"vjs-fluid")&&(a.fluid=!0),c!==null){var h=Sj(c||"{}"),m=h[0],v=h[1];m&&qn.error(m),Ks(a,v)}if(Ks(s,a),n.hasChildNodes())for(var b=n.childNodes,x=0,C=b.length;x<C;x++){var B=b[x],P=B.nodeName.toLowerCase();P==="source"?s.sources.push(ff(B)):P==="track"&&s.tracks.push(ff(B))}return s},t.flexNotSupported_=function(){var n=ot.createElement("i");return!("flexBasis"in n.style||"webkitFlexBasis"in n.style||"mozFlexBasis"in n.style||"msFlexBasis"in n.style||"msFlexOrder"in n.style)},t.debug=function(n){if(n===void 0)return this.debugEnabled_;n?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)},t.playbackRates=function(n){if(n===void 0)return this.cache_.playbackRates;Array.isArray(n)&&n.every(function(s){return typeof s=="number"})&&(this.cache_.playbackRates=n,this.trigger("playbackrateschange"))},e}(ei);dl.names.forEach(function(r){var e=dl[r];Ta.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}});Ta.prototype.crossorigin=Ta.prototype.crossOrigin;Ta.players={};var Wy=Z.navigator;Ta.prototype.options_={techOrder:is.defaultTechOrder_,html5:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Wy&&(Wy.languages&&Wy.languages[0]||Wy.userLanguage||Wy.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1};["ended","seeking","seekable","networkState","readyState"].forEach(function(r){Ta.prototype[r]=function(){return this.techGet_(r)}});XF.forEach(function(r){Ta.prototype["handleTech"+ha(r)+"_"]=function(){return this.trigger(r)}});ei.registerComponent("Player",Ta);var Lx="plugin",A0="activePlugins_",a0={},Rx=function(e){return a0.hasOwnProperty(e)},MT=function(e){return Rx(e)?a0[e]:void 0},YF=function(e,t){e[A0]=e[A0]||{},e[A0][t]=!0},kx=function(e,t,i){var n=(i?"before":"")+"pluginsetup";e.trigger(n,t),e.trigger(n+":"+t.name,t)},kW=function(e,t){var i=function(){kx(this,{name:e,plugin:t,instance:null},!0);var s=t.apply(this,arguments);return YF(this,e),kx(this,{name:e,plugin:t,instance:s}),s};return Object.keys(t).forEach(function(n){i[n]=t[n]}),i},nP=function(e,t){return t.prototype.name=e,function(){kx(this,{name:e,plugin:t,instance:null},!0);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];var a=C4(t,[this].concat(n));return this[e]=function(){return a},kx(this,a.getEventHash()),a}},Sh=function(){function r(t){if(this.constructor===r)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t,this.log||(this.log=this.player.log.createLogger(this.name)),kC(this),delete this.trigger,vF(this,this.constructor.defaultState),YF(t,this.name),this.dispose=this.dispose.bind(this),t.on("dispose",this.dispose)}var e=r.prototype;return e.version=function(){return this.constructor.VERSION},e.getEventHash=function(i){return i===void 0&&(i={}),i.name=this.name,i.plugin=this.constructor,i.instance=this,i},e.trigger=function(i,n){return n===void 0&&(n={}),cv(this.eventBusEl_,i,this.getEventHash(n))},e.handleStateChanged=function(i){},e.dispose=function(){var i=this.name,n=this.player;this.trigger("dispose"),this.off(),n.off("dispose",this.dispose),n[A0][i]=!1,this.player=this.state=null,n[i]=nP(i,a0[i])},r.isBasic=function(i){var n=typeof i=="string"?MT(i):i;return typeof n=="function"&&!r.prototype.isPrototypeOf(n.prototype)},r.registerPlugin=function(i,n){if(typeof i!="string")throw new Error('Illegal plugin name, "'+i+'", must be a string, was '+typeof i+".");if(Rx(i))qn.warn('A plugin named "'+i+'" already exists. You may want to avoid re-registering plugins!');else if(Ta.prototype.hasOwnProperty(i))throw new Error('Illegal plugin name, "'+i+'", cannot share a name with an existing player method!');if(typeof n!="function")throw new Error('Illegal plugin for "'+i+'", must be a function, was '+typeof n+".");return a0[i]=n,i!==Lx&&(r.isBasic(n)?Ta.prototype[i]=kW(i,n):Ta.prototype[i]=nP(i,n)),n},r.deregisterPlugin=function(i){if(i===Lx)throw new Error("Cannot de-register base plugin.");Rx(i)&&(delete a0[i],delete Ta.prototype[i])},r.getPlugins=function(i){i===void 0&&(i=Object.keys(a0));var n;return i.forEach(function(s){var a=MT(s);a&&(n=n||{},n[s]=a)}),n},r.getPluginVersion=function(i){var n=MT(i);return n&&n.VERSION||""},r}();Sh.getPlugin=MT;Sh.BASE_PLUGIN_NAME=Lx;Sh.registerPlugin(Lx,Sh);Ta.prototype.usingPlugin=function(r){return!!this[A0]&&this[A0][r]===!0};Ta.prototype.hasPlugin=function(r){return!!Rx(r)};var rP=!1,OW=function(e,t){t===void 0&&(t={}),rP||(qn.warn("videojs.extend is deprecated as of Video.js 7.22.0 and will be removed in Video.js 8.0.0"),rP=!0);var i=function(){e.apply(this,arguments)},n={};typeof t=="object"?(t.constructor!==Object.prototype.constructor&&(i=t.constructor),n=t):typeof t=="function"&&(i=t),Cj(i,e),e&&(i.super_=e);for(var s in n)n.hasOwnProperty(s)&&(i.prototype[s]=n[s]);return i},QF=function(e){return e.indexOf("#")===0?e.slice(1):e};function rt(r,e,t){var i=rt.getPlayer(r);if(i)return e&&qn.warn('Player "'+r+'" is already initialised. Options will not be applied.'),t&&i.ready(t),i;var n=typeof r=="string"?kp("#"+QF(r)):r;if(!uv(n))throw new TypeError("The element or ID supplied is not valid. (videojs)");(!n.ownerDocument.defaultView||!n.ownerDocument.body.contains(n))&&qn.warn("The element supplied is not included in the DOM"),e=e||{},e.restoreEl===!0&&(e.restoreEl=(n.parentNode&&n.parentNode.hasAttribute("data-vjs-player")?n.parentNode:n).cloneNode(!0)),Rp("beforesetup").forEach(function(a){var c=a(n,vs(e));if(!Ef(c)||Array.isArray(c)){qn.error("please return an object in beforesetup hooks");return}e=vs(e,c)});var s=ei.getComponent("Player");return i=new s(n,e,t),Rp("setup").forEach(function(a){return a(i)}),i}rt.hooks_=yf;rt.hooks=Rp;rt.hook=l$;rt.hookOnce=u$;rt.removeHook=H4;if(Z.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&lv()){var oT=kp(".vjs-styles-defaults");if(!oT){oT=dF("vjs-styles-defaults");var Nw=kp("head");Nw&&Nw.insertBefore(oT,Nw.firstChild),hF(oT,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}zE(1,rt);rt.VERSION=z4;rt.options=Ta.prototype.options_;rt.getPlayers=function(){return Ta.players};rt.getPlayer=function(r){var e=Ta.players,t;if(typeof r=="string"){var i=QF(r),n=e[i];if(n)return n;t=kp("#"+i)}else t=r;if(uv(t)){var s=t,a=s.player,c=s.playerId;if(a||e[c])return a||e[c]}};rt.getAllPlayers=function(){return Object.keys(Ta.players).map(function(r){return Ta.players[r]}).filter(Boolean)};rt.players=Ta.players;rt.getComponent=ei.getComponent;rt.registerComponent=function(r,e){is.isTech(e)&&qn.warn("The "+r+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),ei.registerComponent.call(ei,r,e)};rt.getTech=is.getTech;rt.registerTech=is.registerTech;rt.use=$$;Object.defineProperty(rt,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(rt.middleware,"TERMINATOR",{value:Mx,writeable:!1,enumerable:!0});rt.browser=m$;rt.TOUCH_ENABLED=$0;rt.extend=OW;rt.mergeOptions=vs;rt.bind=ys;rt.registerPlugin=Sh.registerPlugin;rt.deregisterPlugin=Sh.deregisterPlugin;rt.plugin=function(r,e){return qn.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Sh.registerPlugin(r,e)};rt.getPlugins=Sh.getPlugins;rt.getPlugin=Sh.getPlugin;rt.getPluginVersion=Sh.getPluginVersion;rt.addLanguage=function(r,e){var t;return r=(""+r).toLowerCase(),rt.options.languages=vs(rt.options.languages,(t={},t[r]=e,t)),rt.options.languages[r]};rt.log=qn;rt.createLogger=G4;rt.createTimeRange=rt.createTimeRanges=Xm;rt.formatTime=Q0;rt.setFormatTime=cW;rt.resetFormatTime=dW;rt.parseUrl=FC;rt.isCrossOrigin=SS;rt.EventTarget=to;rt.on=Xu;rt.one=TS;rt.off=Uo;rt.trigger=cv;rt.xhr=w4;rt.TextTrack=J_;rt.AudioTrack=TF;rt.VideoTrack=xF;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(r){rt[r]=function(){return qn.warn("videojs."+r+"() is deprecated; use videojs.dom."+r+"() instead"),uF[r].apply(null,arguments)}});rt.computedStyle=R_;rt.dom=uF;rt.url=z$;rt.defineLazyProperty=tM;rt.addLanguage("en",{"Non-Fullscreen":"Exit Fullscreen"});/*! @name @videojs/http-streaming @version 2.16.3 @license Apache-2.0 */var qc=fS,Ox=function(e,t,i){return e&&i&&i.responseURL&&t!==i.responseURL?i.responseURL:t},td=function(e){return rt.log.debug?rt.log.debug.bind(rt,"VHS:",e+" >"):function(){}},Op=1/30,ph=Op*3,KF=function(e,t){var i=[],n;if(e&&e.length)for(n=0;n<e.length;n++)t(e.start(n),e.end(n))&&i.push([e.start(n),e.end(n)]);return rt.createTimeRanges(i)},o0=function(e,t){return KF(e,function(i,n){return i-ph<=t&&n+ph>=t})},lT=function(e,t){return KF(e,function(i){return i-Op>=t})},FW=function(e){if(e.length<2)return rt.createTimeRanges();for(var t=[],i=1;i<e.length;i++){var n=e.end(i-1),s=e.start(i);t.push([n,s])}return rt.createTimeRanges(t)},BW=function(e,t){var i=null,n=null,s=0,a=[],c=[];if(!e||!e.length||!t||!t.length)return rt.createTimeRange();for(var h=e.length;h--;)a.push({time:e.start(h),type:"start"}),a.push({time:e.end(h),type:"end"});for(h=t.length;h--;)a.push({time:t.start(h),type:"start"}),a.push({time:t.end(h),type:"end"});for(a.sort(function(m,v){return m.time-v.time}),h=0;h<a.length;h++)a[h].type==="start"?(s++,s===2&&(i=a[h].time)):a[h].type==="end"&&(s--,s===1&&(n=a[h].time)),i!==null&&n!==null&&(c.push([i,n]),i=null,n=null);return rt.createTimeRanges(c)},ZF=function(e){var t=[];if(!e||!e.length)return"";for(var i=0;i<e.length;i++)t.push(e.start(i)+" => "+e.end(i));return t.join(", ")},NW=function(e,t,i){i===void 0&&(i=1);var n=e.length?e.end(e.length-1):0;return(n-t)/i},Nm=function(e){for(var t=[],i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t},UW=function(e,t){if(e===t)return!1;if(!e&&t||!t&&e||e.length!==t.length)return!0;for(var i=0;i<e.length;i++)if(e.start(i)!==t.start(i)||e.end(i)!==t.end(i))return!0;return!1},sP=function(e){if(!(!e||!e.length||!e.end))return e.end(e.length-1)},iM=function(e,t){var i=0;if(!e||!e.length)return i;for(var n=0;n<e.length;n++){var s=e.start(n),a=e.end(n);if(!(t>a)){if(t>s&&t<=a){i+=a-t;continue}i+=a-s}}return i},aP=rt.createTimeRange,nM=function(e,t){if(!t.preload)return t.duration;var i=0;return(t.parts||[]).forEach(function(n){i+=n.duration}),(t.preloadHints||[]).forEach(function(n){n.type==="PART"&&(i+=e.partTargetDuration)}),i},XE=function(e){return(e.segments||[]).reduce(function(t,i,n){return i.parts?i.parts.forEach(function(s,a){t.push({duration:s.duration,segmentIndex:n,partIndex:a,part:s,segment:i})}):t.push({duration:i.duration,segmentIndex:n,partIndex:null,segment:i,part:null}),t},[])},JF=function(e){var t=e.segments&&e.segments.length&&e.segments[e.segments.length-1];return t&&t.parts||[]},eB=function(e){var t=e.preloadSegment;if(t){var i=t.parts,n=t.preloadHints,s=(n||[]).reduce(function(a,c){return a+(c.type==="PART"?1:0)},0);return s+=i&&i.length?i.length:0,s}},tB=function(e,t){if(t.endList)return 0;if(e&&e.suggestedPresentationDelay)return e.suggestedPresentationDelay;var i=JF(t).length>0;return i&&t.serverControl&&t.serverControl.partHoldBack?t.serverControl.partHoldBack:i&&t.partTargetDuration?t.partTargetDuration*3:t.serverControl&&t.serverControl.holdBack?t.serverControl.holdBack:t.targetDuration?t.targetDuration*3:0},VW=function(e,t){var i=0,n=t-e.mediaSequence,s=e.segments[n];if(s){if(typeof s.start<"u")return{result:s.start,precise:!0};if(typeof s.end<"u")return{result:s.end-s.duration,precise:!0}}for(;n--;){if(s=e.segments[n],typeof s.end<"u")return{result:i+s.end,precise:!0};if(i+=nM(e,s),typeof s.start<"u")return{result:i+s.start,precise:!0}}return{result:i,precise:!1}},zW=function(e,t){for(var i=0,n,s=t-e.mediaSequence;s<e.segments.length;s++){if(n=e.segments[s],typeof n.start<"u")return{result:n.start-i,precise:!0};if(i+=nM(e,n),typeof n.end<"u")return{result:n.end-i,precise:!0}}return{result:-1,precise:!1}},iB=function(e,t,i){if(typeof t>"u"&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence)return 0;var n=VW(e,t);if(n.precise)return n.result;var s=zW(e,t);return s.precise?s.result:n.result+i},nB=function(e,t,i){if(!e)return 0;if(typeof i!="number"&&(i=0),typeof t>"u"){if(e.totalDuration)return e.totalDuration;if(!e.endList)return Z.Infinity}return iB(e,t,i)},g_=function(e){var t=e.defaultDuration,i=e.durationList,n=e.startIndex,s=e.endIndex,a=0;if(n>s){var c=[s,n];n=c[0],s=c[1]}if(n<0){for(var h=n;h<Math.min(0,s);h++)a+=t;n=0}for(var m=n;m<s;m++)a+=i[m].duration;return a},rB=function(e,t,i,n){if(!e||!e.segments)return null;if(e.endList)return nB(e);if(t===null)return null;t=t||0;var s=iB(e,e.mediaSequence+e.segments.length,t);return i&&(n=typeof n=="number"?n:tB(null,e),s-=n),Math.max(0,s)},HW=function(e,t,i){var n=!0,s=t||0,a=rB(e,t,n,i);return a===null?aP():aP(s,a)},jW=function(e){for(var t=e.playlist,i=e.currentTime,n=e.startingSegmentIndex,s=e.startingPartIndex,a=e.startTime,c=e.experimentalExactManifestTimings,h=i-a,m=XE(t),v=0,b=0;b<m.length;b++){var x=m[b];if(n===x.segmentIndex&&!(typeof s=="number"&&typeof x.partIndex=="number"&&s!==x.partIndex)){v=b;break}}if(h<0){if(v>0)for(var C=v-1;C>=0;C--){var B=m[C];if(h+=B.duration,c){if(h<0)continue}else if(h+Op<=0)continue;return{partIndex:B.partIndex,segmentIndex:B.segmentIndex,startTime:a-g_({defaultDuration:t.targetDuration,durationList:m,startIndex:v,endIndex:C})}}return{partIndex:m[0]&&m[0].partIndex||null,segmentIndex:m[0]&&m[0].segmentIndex||0,startTime:i}}if(v<0){for(var P=v;P<0;P++)if(h-=t.targetDuration,h<0)return{partIndex:m[0]&&m[0].partIndex||null,segmentIndex:m[0]&&m[0].segmentIndex||0,startTime:i};v=0}for(var N=v;N<m.length;N++){var ae=m[N];if(h-=ae.duration,c){if(h>0)continue}else if(h-Op>=0)continue;return{partIndex:ae.partIndex,segmentIndex:ae.segmentIndex,startTime:a+g_({defaultDuration:t.targetDuration,durationList:m,startIndex:v,endIndex:N})}}return{segmentIndex:m[m.length-1].segmentIndex,partIndex:m[m.length-1].partIndex,startTime:i}},sB=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()},rM=function(e){return e.excludeUntil&&e.excludeUntil===1/0},CS=function(e){var t=sB(e);return!e.disabled&&!t},GW=function(e){return e.disabled},$W=function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},aB=function(e,t){return t.attributes&&t.attributes[e]},WW=function(e,t,i,n){if(n===void 0&&(n=0),!aB("BANDWIDTH",i))return NaN;var s=e*i.attributes.BANDWIDTH;return(s-n*8)/t},YE=function(e,t){if(e.playlists.length===1)return!0;var i=t.attributes.BANDWIDTH||Number.MAX_VALUE;return e.playlists.filter(function(n){return CS(n)?(n.attributes.BANDWIDTH||0)<i:!1}).length===0},sM=function(e,t){return!e&&!t||!e&&t||e&&!t?!1:!!(e===t||e.id&&t.id&&e.id===t.id||e.resolvedUri&&t.resolvedUri&&e.resolvedUri===t.resolvedUri||e.uri&&t.uri&&e.uri===t.uri)},oP=function(e,t){var i=e&&e.mediaGroups&&e.mediaGroups.AUDIO||{},n=!1;for(var s in i){for(var a in i[s])if(n=t(i[s][a]),n)break;if(n)break}return!!n},ib=function(e){if(!e||!e.playlists||!e.playlists.length){var t=oP(e,function(a){return a.playlists&&a.playlists.length||a.uri});return t}for(var i=function(c){var h=e.playlists[c],m=h.attributes&&h.attributes.CODECS;if(m&&m.split(",").every(function(b){return I4(b)}))return"continue";var v=oP(e,function(b){return sM(h,b)});return v?"continue":{v:!1}},n=0;n<e.playlists.length;n++){var s=i(n);if(s!=="continue"&&typeof s=="object")return s.v}return!0},eu={liveEdgeDelay:tB,duration:nB,seekable:HW,getMediaInfoForTime:jW,isEnabled:CS,isDisabled:GW,isBlacklisted:sB,isIncompatible:rM,playlistEnd:rB,isAes:$W,hasAttribute:aB,estimateSegmentRequestTime:WW,isLowestEnabledRendition:YE,isAudioOnly:ib,playlistMatch:sM,segmentDurationWithParts:nM},oB=rt.log,aM=function(e,t){return e+"-"+t},qW=function(e,t,i){return"placeholder-uri-"+e+"-"+t+"-"+i},XW=function(e){var t=e.onwarn,i=e.oninfo,n=e.manifestString,s=e.customTagParsers,a=s===void 0?[]:s,c=e.customTagMappers,h=c===void 0?[]:c,m=e.experimentalLLHLS,v=new Fj;t&&v.on("warn",t),i&&v.on("info",i),a.forEach(function(P){return v.addParser(P)}),h.forEach(function(P){return v.addTagMapper(P)}),v.push(n),v.end();var b=v.manifest;if(m||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(P){b.hasOwnProperty(P)&&delete b[P]}),b.segments&&b.segments.forEach(function(P){["parts","preloadHints"].forEach(function(N){P.hasOwnProperty(N)&&delete P[N]})})),!b.targetDuration){var x=10;b.segments&&b.segments.length&&(x=b.segments.reduce(function(P,N){return Math.max(P,N.duration)},0)),t&&t("manifest has no targetDuration defaulting to "+x),b.targetDuration=x}var C=JF(b);if(C.length&&!b.partTargetDuration){var B=C.reduce(function(P,N){return Math.max(P,N.duration)},0);t&&(t("manifest has no partTargetDuration defaulting to "+B),oB.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),b.partTargetDuration=B}return b},mv=function(e,t){e.mediaGroups&&["AUDIO","SUBTITLES"].forEach(function(i){if(e.mediaGroups[i])for(var n in e.mediaGroups[i])for(var s in e.mediaGroups[i][n]){var a=e.mediaGroups[i][n][s];t(a,i,n,s)}})},lB=function(e){var t=e.playlist,i=e.uri,n=e.id;t.id=n,t.playlistErrors_=0,i&&(t.uri=i),t.attributes=t.attributes||{}},YW=function(e){for(var t=e.playlists.length;t--;){var i=e.playlists[t];lB({playlist:i,id:aM(t,i.uri)}),i.resolvedUri=qc(e.uri,i.uri),e.playlists[i.id]=i,e.playlists[i.uri]=i,i.attributes.BANDWIDTH||oB.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},QW=function(e){mv(e,function(t){t.uri&&(t.resolvedUri=qc(e.uri,t.uri))})},KW=function(e,t){var i=aM(0,t),n={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:Z.location.href,resolvedUri:Z.location.href,playlists:[{uri:t,id:i,resolvedUri:t,attributes:{}}]};return n.playlists[i]=n.playlists[0],n.playlists[t]=n.playlists[0],n},uB=function(e,t,i){i===void 0&&(i=qW),e.uri=t;for(var n=0;n<e.playlists.length;n++)if(!e.playlists[n].uri){var s="placeholder-uri-"+n;e.playlists[n].uri=s}var a=ib(e);mv(e,function(c,h,m,v){if(!c.playlists||!c.playlists.length){if(a&&h==="AUDIO"&&!c.uri)for(var b=0;b<e.playlists.length;b++){var x=e.playlists[b];if(x.attributes&&x.attributes.AUDIO&&x.attributes.AUDIO===m)return}c.playlists=[zr({},c)]}c.playlists.forEach(function(C,B){var P=i(h,m,v,C),N=aM(B,P);C.uri?C.resolvedUri=C.resolvedUri||qc(e.uri,C.uri):(C.uri=B===0?P:N,C.resolvedUri=C.uri),C.id=C.id||N,C.attributes=C.attributes||{},e.playlists[C.id]=C,e.playlists[C.uri]=C})}),YW(e),QW(e)},Fx=rt.mergeOptions,ZW=rt.EventTarget,JW=function(e,t){if(t.endList||!t.serverControl)return e;var i={};if(t.serverControl.canBlockReload){var n=t.preloadSegment,s=t.mediaSequence+t.segments.length;if(n){var a=n.parts||[],c=eB(t)-1;c>-1&&c!==a.length-1&&(i._HLS_part=c),(c>-1||a.length)&&s--}i._HLS_msn=s}if(t.serverControl&&t.serverControl.canSkipUntil&&(i._HLS_skip=t.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(i).length){var h=new Z.URL(e);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(m){i.hasOwnProperty(m)&&h.searchParams.set(m,i[m])}),e=h.toString()}return e},eq=function(e,t){if(!e)return t;var i=Fx(e,t);if(e.preloadHints&&!t.preloadHints&&delete i.preloadHints,e.parts&&!t.parts)delete i.parts;else if(e.parts&&t.parts)for(var n=0;n<t.parts.length;n++)e.parts&&e.parts[n]&&(i.parts[n]=Fx(e.parts[n],t.parts[n]));return!e.skipped&&t.skipped&&(i.skipped=!1),e.preload&&!t.preload&&(i.preload=!1),i},tq=function(e,t,i){var n=e.slice(),s=t.slice();i=i||0;for(var a=[],c,h=0;h<s.length;h++){var m=n[h+i],v=s[h];m?(c=m.map||c,a.push(eq(m,v))):(c&&!v.map&&(v.map=c),a.push(v))}return a},cB=function(e,t){!e.resolvedUri&&e.uri&&(e.resolvedUri=qc(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=qc(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=qc(t,e.map.uri)),e.map&&e.map.key&&!e.map.key.resolvedUri&&(e.map.key.resolvedUri=qc(t,e.map.key.uri)),e.parts&&e.parts.length&&e.parts.forEach(function(i){i.resolvedUri||(i.resolvedUri=qc(t,i.uri))}),e.preloadHints&&e.preloadHints.length&&e.preloadHints.forEach(function(i){i.resolvedUri||(i.resolvedUri=qc(t,i.uri))})},dB=function(e){var t=e.segments||[],i=e.preloadSegment;if(i&&i.parts&&i.parts.length){if(i.preloadHints){for(var n=0;n<i.preloadHints.length;n++)if(i.preloadHints[n].type==="MAP")return t}i.duration=e.targetDuration,i.preload=!0,t.push(i)}return t},hB=function(e,t){return e===t||e.segments&&t.segments&&e.segments.length===t.segments.length&&e.endList===t.endList&&e.mediaSequence===t.mediaSequence&&e.preloadSegment===t.preloadSegment},QE=function(e,t,i){i===void 0&&(i=hB);var n=Fx(e,{}),s=n.playlists[t.id];if(!s||i(s,t))return null;t.segments=dB(t);var a=Fx(s,t);if(a.preloadSegment&&!t.preloadSegment&&delete a.preloadSegment,s.segments){if(t.skip){t.segments=t.segments||[];for(var c=0;c<t.skip.skippedSegments;c++)t.segments.unshift({skipped:!0})}a.segments=tq(s.segments,t.segments,t.mediaSequence-s.mediaSequence)}a.segments.forEach(function(m){cB(m,a.resolvedUri)});for(var h=0;h<n.playlists.length;h++)n.playlists[h].id===t.id&&(n.playlists[h]=a);return n.playlists[t.id]=a,n.playlists[t.uri]=a,mv(e,function(m,v,b,x){if(m.playlists)for(var C=0;C<m.playlists.length;C++)t.id===m.playlists[C].id&&(m.playlists[C]=a)}),n},KE=function(e,t){var i=e.segments||[],n=i[i.length-1],s=n&&n.parts&&n.parts[n.parts.length-1],a=s&&s.duration||n&&n.duration;return t&&a?a*1e3:(e.partTargetDuration||e.targetDuration||10)*500},l0=function(r){mi(e,r);function e(i,n,s){var a;if(s===void 0&&(s={}),a=r.call(this)||this,!i)throw new Error("A non-empty playlist URL or object is required");a.logger_=td("PlaylistLoader");var c=s,h=c.withCredentials,m=h===void 0?!1:h,v=c.handleManifestRedirects,b=v===void 0?!1:v;a.src=i,a.vhs_=n,a.withCredentials=m,a.handleManifestRedirects=b;var x=n.options_;return a.customTagParsers=x&&x.customTagParsers||[],a.customTagMappers=x&&x.customTagMappers||[],a.experimentalLLHLS=x&&x.experimentalLLHLS||!1,rt.browser.IE_VERSION&&(a.experimentalLLHLS=!1),a.state="HAVE_NOTHING",a.handleMediaupdatetimeout_=a.handleMediaupdatetimeout_.bind(Tn(a)),a.on("mediaupdatetimeout",a.handleMediaupdatetimeout_),a}var t=e.prototype;return t.handleMediaupdatetimeout_=function(){var n=this;if(this.state==="HAVE_METADATA"){var s=this.media(),a=qc(this.master.uri,s.uri);this.experimentalLLHLS&&(a=JW(a,s)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:a,withCredentials:this.withCredentials},function(c,h){if(n.request){if(c)return n.playlistRequestError(n.request,n.media(),"HAVE_METADATA");n.haveMetadata({playlistString:n.request.responseText,url:n.media().uri,id:n.media().id})}})}},t.playlistRequestError=function(n,s,a){var c=s.uri,h=s.id;this.request=null,a&&(this.state=a),this.error={playlist:this.master.playlists[h],status:n.status,message:"HLS playlist request error at URL: "+c+".",responseText:n.responseText,code:n.status>=500?4:2},this.trigger("error")},t.parseManifest_=function(n){var s=this,a=n.url,c=n.manifestString;return XW({onwarn:function(m){var v=m.message;return s.logger_("m3u8-parser warn for "+a+": "+v)},oninfo:function(m){var v=m.message;return s.logger_("m3u8-parser info for "+a+": "+v)},manifestString:c,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,experimentalLLHLS:this.experimentalLLHLS})},t.haveMetadata=function(n){var s=n.playlistString,a=n.playlistObject,c=n.url,h=n.id;this.request=null,this.state="HAVE_METADATA";var m=a||this.parseManifest_({url:c,manifestString:s});m.lastRequest=Date.now(),lB({playlist:m,uri:c,id:h});var v=QE(this.master,m);this.targetDuration=m.partTargetDuration||m.targetDuration,this.pendingMedia_=null,v?(this.master=v,this.media_=this.master.playlists[h]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(KE(this.media(),!!v)),this.trigger("loadedplaylist")},t.dispose=function(){this.trigger("dispose"),this.stopRequest(),Z.clearTimeout(this.mediaUpdateTimeout),Z.clearTimeout(this.finalRenditionTimeout),this.off()},t.stopRequest=function(){if(this.request){var n=this.request;this.request=null,n.onreadystatechange=null,n.abort()}},t.media=function(n,s){var a=this;if(!n)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof n=="string"){if(!this.master.playlists[n])throw new Error("Unknown playlist URI: "+n);n=this.master.playlists[n]}if(Z.clearTimeout(this.finalRenditionTimeout),s){var c=(n.partTargetDuration||n.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=Z.setTimeout(this.media.bind(this,n,!1),c);return}var h=this.state,m=!this.media_||n.id!==this.media_.id,v=this.master.playlists[n.id];if(v&&v.endList||n.endList&&n.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=n,m&&(this.trigger("mediachanging"),h==="HAVE_MASTER"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(KE(n,!0)),!!m){if(this.state="SWITCHING_MEDIA",this.request){if(n.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=n,this.request=this.vhs_.xhr({uri:n.resolvedUri,withCredentials:this.withCredentials},function(b,x){if(a.request){if(n.lastRequest=Date.now(),n.resolvedUri=Ox(a.handleManifestRedirects,n.resolvedUri,x),b)return a.playlistRequestError(a.request,n,h);a.haveMetadata({playlistString:x.responseText,url:n.uri,id:n.id}),h==="HAVE_MASTER"?a.trigger("loadedmetadata"):a.trigger("mediachange")}})}},t.pause=function(){this.mediaUpdateTimeout&&(Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")},t.load=function(n){var s=this;this.mediaUpdateTimeout&&(Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);var a=this.media();if(n){var c=a?(a.partTargetDuration||a.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=Z.setTimeout(function(){s.mediaUpdateTimeout=null,s.load()},c);return}if(!this.started){this.start();return}a&&!a.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")},t.updateMediaUpdateTimeout_=function(n){var s=this;this.mediaUpdateTimeout&&(Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=Z.setTimeout(function(){s.mediaUpdateTimeout=null,s.trigger("mediaupdatetimeout"),s.updateMediaUpdateTimeout_(n)},n))},t.start=function(){var n=this;if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=Z.location.href),this.src.resolvedUri=this.src.uri,setTimeout(function(){n.setupInitialPlaylist(n.src)},0);return}this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},function(s,a){if(n.request){if(n.request=null,s)return n.error={status:a.status,message:"HLS playlist request error at URL: "+n.src+".",responseText:a.responseText,code:2},n.state==="HAVE_NOTHING"&&(n.started=!1),n.trigger("error");n.src=Ox(n.handleManifestRedirects,n.src,a);var c=n.parseManifest_({manifestString:a.responseText,url:n.src});n.setupInitialPlaylist(c)}})},t.srcUri=function(){return typeof this.src=="string"?this.src:this.src.uri},t.setupInitialPlaylist=function(n){if(this.state="HAVE_MASTER",n.playlists){this.master=n,uB(this.master,this.srcUri()),n.playlists.forEach(function(a){a.segments=dB(a),a.segments.forEach(function(c){cB(c,a.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.master.playlists[0]);return}var s=this.srcUri()||Z.location.href;this.master=KW(n,s),this.haveMetadata({playlistObject:n,url:s,id:this.master.playlists[0].id}),this.trigger("loadedmetadata")},e}(ZW),iq=rt.xhr,nq=rt.mergeOptions,ZE=function(e,t,i,n){var s=e.responseType==="arraybuffer"?e.response:e.responseText;!t&&s&&(e.responseTime=Date.now(),e.roundTripTime=e.responseTime-e.requestTime,e.bytesReceived=s.byteLength||s.length,e.bandwidth||(e.bandwidth=Math.floor(e.bytesReceived/e.roundTripTime*8*1e3))),i.headers&&(e.responseHeaders=i.headers),t&&t.code==="ETIMEDOUT"&&(e.timedout=!0),!t&&!e.aborted&&i.statusCode!==200&&i.statusCode!==206&&i.statusCode!==0&&(t=new Error("XHR Failed with a response of: "+(e&&(s||e.responseText)))),n(t,e)},fB=function(){var e=function t(i,n){i=nq({timeout:45e3},i);var s=t.beforeRequest||rt.Vhs.xhr.beforeRequest;if(s&&typeof s=="function"){var a=s(i);a&&(i=a)}var c=rt.Vhs.xhr.original===!0?iq:rt.Vhs.xhr,h=c(i,function(v,b){return ZE(h,v,b,n)}),m=h.abort;return h.abort=function(){return h.aborted=!0,m.apply(h,arguments)},h.uri=i.uri,h.requestTime=Date.now(),h};return e.original=!0,e},rq=function(e){var t,i=e.offset;return typeof e.offset=="bigint"||typeof e.length=="bigint"?t=Z.BigInt(e.offset)+Z.BigInt(e.length)-Z.BigInt(1):t=e.offset+e.length-1,"bytes="+i+"-"+t},JE=function(e){var t={};return e.byterange&&(t.Range=rq(e.byterange)),t},sq=function(e,t){return e.start(t)+"-"+e.end(t)},aq=function(e,t){var i=e.toString(16);return"00".substring(0,2-i.length)+i+(t%2?" ":"")},oq=function(e){return e>=32&&e<126?String.fromCharCode(e):"."},pB=function(e){var t={};return Object.keys(e).forEach(function(i){var n=e[i];L4(n)?t[i]={bytes:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength}:t[i]=n}),t},Bx=function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")},mB=function(e){return e.resolvedUri},gB=function(e){for(var t=Array.prototype.slice.call(e),i=16,n="",s,a,c=0;c<t.length/i;c++)s=t.slice(c*i,c*i+i).map(aq).join(""),a=t.slice(c*i,c*i+i).map(oq).join(""),n+=s+" "+a+`
`;return n},lq=function(e){var t=e.bytes;return gB(t)},uq=function(e){var t="",i;for(i=0;i<e.length;i++)t+=sq(e,i)+" ";return t},cq=Object.freeze({__proto__:null,createTransferableMessage:pB,initSegmentId:Bx,segmentKeyId:mB,hexDump:gB,tagDump:lq,textRanges:uq}),vB=.25,dq=function(e,t){if(!t.dateTimeObject)return null;var i=t.videoTimingInfo.transmuxerPrependedSeconds,n=t.videoTimingInfo.transmuxedPresentationStart,s=n+i,a=e-s;return new Date(t.dateTimeObject.getTime()+a*1e3)},hq=function(e){return e.transmuxedPresentationEnd-e.transmuxedPresentationStart-e.transmuxerPrependedSeconds},fq=function(e,t){var i;try{i=new Date(e)}catch{return null}if(!t||!t.segments||t.segments.length===0)return null;var n=t.segments[0];if(i<n.dateTimeObject)return null;for(var s=0;s<t.segments.length-1;s++){n=t.segments[s];var a=t.segments[s+1].dateTimeObject;if(i<a)break}var c=t.segments[t.segments.length-1],h=c.dateTimeObject,m=c.videoTimingInfo?hq(c.videoTimingInfo):c.duration+c.duration*vB,v=new Date(h.getTime()+m*1e3);return i>v?null:(i>h&&(n=c),{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:eu.duration(t,t.mediaSequence+t.segments.indexOf(n)),type:n.videoTimingInfo?"accurate":"estimate"})},pq=function(e,t){if(!t||!t.segments||t.segments.length===0)return null;for(var i=0,n,s=0;s<t.segments.length&&(n=t.segments[s],i=n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationEnd:i+n.duration,!(e<=i));s++);var a=t.segments[t.segments.length-1];if(a.videoTimingInfo&&a.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(e>i){if(e>i+a.duration*vB)return null;n=a}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:i-n.duration,type:n.videoTimingInfo?"accurate":"estimate"}},mq=function(e,t){var i,n;try{i=new Date(e),n=new Date(t)}catch{}var s=i.getTime(),a=n.getTime();return(a-s)/1e3},gq=function(e){if(!e.segments||e.segments.length===0)return!1;for(var t=0;t<e.segments.length;t++){var i=e.segments[t];if(!i.dateTimeObject)return!1}return!0},vq=function(e){var t=e.playlist,i=e.time,n=i===void 0?void 0:i,s=e.callback;if(!s)throw new Error("getProgramTime: callback must be provided");if(!t||n===void 0)return s({message:"getProgramTime: playlist and time must be provided"});var a=pq(n,t);if(!a)return s({message:"valid programTime was not found"});if(a.type==="estimate")return s({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var c={mediaSeconds:n},h=dq(n,a.segment);return h&&(c.programDateTime=h.toISOString()),s(null,c)},yq=function r(e){var t=e.programTime,i=e.playlist,n=e.retryCount,s=n===void 0?2:n,a=e.seekTo,c=e.pauseAfterSeek,h=c===void 0?!0:c,m=e.tech,v=e.callback;if(!v)throw new Error("seekToProgramTime: callback must be provided");if(typeof t>"u"||!i||!a)return v({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!i.endList&&!m.hasStarted_)return v({message:"player must be playing a live stream to start buffering"});if(!gq(i))return v({message:"programDateTime tags must be provided in the manifest "+i.resolvedUri});var b=fq(t,i);if(!b)return v({message:t+" was not found in the stream"});var x=b.segment,C=mq(x.dateTimeObject,t);if(b.type==="estimate"){if(s===0)return v({message:t+" is not buffered yet. Try again"});a(b.estimatedStart+C),m.one("seeked",function(){r({programTime:t,playlist:i,retryCount:s-1,seekTo:a,pauseAfterSeek:h,tech:m,callback:v})});return}var B=x.start+C,P=function(){return v(null,m.currentTime())};m.one("seeked",P),h&&m.pause(),a(B)},Uw=function(e,t){if(e.readyState===4)return t()},_q=function(e,t,i){var n=[],s,a=!1,c=function(x,C,B,P){return C.abort(),a=!0,i(x,C,B,P)},h=function(x,C){if(!a){if(x)return c(x,C,"",n);var B=C.responseText.substring(n&&n.byteLength||0,C.responseText.length);if(n=Xj(n,R4(B,!0)),s=s||i_(n),n.length<10||s&&n.length<s+2)return Uw(C,function(){return c(x,C,"",n)});var P=EC(n);return P==="ts"&&n.length<188?Uw(C,function(){return c(x,C,"",n)}):!P&&n.length<376?Uw(C,function(){return c(x,C,"",n)}):c(null,C,P,n)}},m={uri:e,beforeSend:function(x){x.overrideMimeType("text/plain; charset=x-user-defined"),x.addEventListener("progress",function(C){return C.total,C.loaded,ZE(x,null,{statusCode:x.status},h)})}},v=t(m,function(b,x){return ZE(v,b,x,h)});return v},bq=rt.EventTarget,yB=rt.mergeOptions,lP=function(e,t){if(!hB(e,t)||e.sidx&&t.sidx&&(e.sidx.offset!==t.sidx.offset||e.sidx.length!==t.sidx.length))return!1;if(!e.sidx&&t.sidx||e.sidx&&!t.sidx||e.segments&&!t.segments||!e.segments&&t.segments)return!1;if(!e.segments&&!t.segments)return!0;for(var i=0;i<e.segments.length;i++){var n=e.segments[i],s=t.segments[i];if(n.uri!==s.uri)return!1;if(!(!n.byterange&&!s.byterange)){var a=n.byterange,c=s.byterange;if(a&&!c||!a&&c||a.offset!==c.offset||a.length!==c.length)return!1}}return!0},Tq=function(e,t,i,n){var s=n.attributes.NAME||i;return"placeholder-uri-"+e+"-"+t+"-"+s},xq=function(e){var t=e.masterXml,i=e.srcUrl,n=e.clientOffset,s=e.sidxMapping,a=e.previousManifest,c=UG(t,{manifestUri:i,clientOffset:n,sidxMapping:s,previousManifest:a});return uB(c,i,Tq),c},Sq=function(e,t){mv(e,function(i,n,s,a){a in t.mediaGroups[n][s]||delete e.mediaGroups[n][s][a]})},Aq=function(e,t,i){for(var n=!0,s=yB(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod,timelineStarts:t.timelineStarts}),a=0;a<t.playlists.length;a++){var c=t.playlists[a];if(c.sidx){var h=mS(c.sidx);i&&i[h]&&i[h].sidx&&xC(c,i[h].sidx,c.sidx.resolvedUri)}var m=QE(s,c,lP);m&&(s=m,n=!1)}return mv(t,function(v,b,x,C){if(v.playlists&&v.playlists.length){var B=v.playlists[0].id,P=QE(s,v.playlists[0],lP);P&&(s=P,C in s.mediaGroups[b][x]||(s.mediaGroups[b][x][C]=v),s.mediaGroups[b][x][C].playlists[0]=s.playlists[B],n=!1)}}),Sq(s,t),t.minimumUpdatePeriod!==e.minimumUpdatePeriod&&(n=!1),n?null:s},wq=function(e,t){var i=!e.map&&!t.map,n=i||!!(e.map&&t.map&&e.map.byterange.offset===t.map.byterange.offset&&e.map.byterange.length===t.map.byterange.length);return n&&e.uri===t.uri&&e.byterange.offset===t.byterange.offset&&e.byterange.length===t.byterange.length},uP=function(e,t){var i={};for(var n in e){var s=e[n],a=s.sidx;if(a){var c=mS(a);if(!t[c])break;var h=t[c].sidxInfo;wq(h,a)&&(i[c]=t[c])}}return i},Eq=function(e,t){var i=uP(e.playlists,t),n=i;return mv(e,function(s,a,c,h){if(s.playlists&&s.playlists.length){var m=s.playlists;n=yB(n,uP(m,t))}}),n},e2=function(r){mi(e,r);function e(i,n,s,a){var c;s===void 0&&(s={}),c=r.call(this)||this,c.masterPlaylistLoader_=a||Tn(c),a||(c.isMaster_=!0);var h=s,m=h.withCredentials,v=m===void 0?!1:m,b=h.handleManifestRedirects,x=b===void 0?!1:b;if(c.vhs_=n,c.withCredentials=v,c.handleManifestRedirects=x,!i)throw new Error("A non-empty playlist URL or object is required");return c.on("minimumUpdatePeriod",function(){c.refreshXml_()}),c.on("mediaupdatetimeout",function(){c.refreshMedia_(c.media().id)}),c.state="HAVE_NOTHING",c.loadedPlaylists_={},c.logger_=td("DashPlaylistLoader"),c.isMaster_?(c.masterPlaylistLoader_.srcUrl=i,c.masterPlaylistLoader_.sidxMapping_={}):c.childPlaylist_=i,c}var t=e.prototype;return t.requestErrored_=function(n,s,a){if(!this.request)return!0;if(this.request=null,n)return this.error=typeof n=="object"&&!(n instanceof Error)?n:{status:s.status,message:"DASH request error at URL: "+s.uri,response:s.response,code:2},a&&(this.state=a),this.trigger("error"),!0},t.addSidxSegments_=function(n,s,a){var c=this,h=n.sidx&&mS(n.sidx);if(!n.sidx||!h||this.masterPlaylistLoader_.sidxMapping_[h]){this.mediaRequest_=Z.setTimeout(function(){return a(!1)},0);return}var m=Ox(this.handleManifestRedirects,n.sidx.resolvedUri),v=function(x,C){if(!c.requestErrored_(x,C,s)){var B=c.masterPlaylistLoader_.sidxMapping_,P;try{P=GG(tn(C.response).subarray(8))}catch(N){c.requestErrored_(N,C,s);return}return B[h]={sidxInfo:n.sidx,sidx:P},xC(n,P,n.sidx.resolvedUri),a(!0)}};this.request=_q(m,this.vhs_.xhr,function(b,x,C,B){if(b)return v(b,x);if(!C||C!=="mp4")return v({status:x.status,message:"Unsupported "+(C||"unknown")+" container type for sidx segment at URL: "+m,response:"",playlist:n,internal:!0,blacklistDuration:1/0,code:2},x);var P=n.sidx.byterange,N=P.offset,ae=P.length;if(B.length>=ae+N)return v(b,{response:B.subarray(N,N+ae),status:x.status,uri:x.uri});c.request=c.vhs_.xhr({uri:m,responseType:"arraybuffer",headers:JE({byterange:n.sidx.byterange})},v)})},t.dispose=function(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},Z.clearTimeout(this.minimumUpdatePeriodTimeout_),Z.clearTimeout(this.mediaRequest_),Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.masterPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_),this.masterPlaylistLoader_.createMupOnMedia_=null),this.off()},t.hasPendingRequest=function(){return this.request||this.mediaRequest_},t.stopRequest=function(){if(this.request){var n=this.request;this.request=null,n.onreadystatechange=null,n.abort()}},t.media=function(n){var s=this;if(!n)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);var a=this.state;if(typeof n=="string"){if(!this.masterPlaylistLoader_.master.playlists[n])throw new Error("Unknown playlist URI: "+n);n=this.masterPlaylistLoader_.master.playlists[n]}var c=!this.media_||n.id!==this.media_.id;if(c&&this.loadedPlaylists_[n.id]&&this.loadedPlaylists_[n.id].endList){this.state="HAVE_METADATA",this.media_=n,c&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}c&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(n,a,function(h){s.haveMetadata({startingState:a,playlist:n})}))},t.haveMetadata=function(n){var s=n.startingState,a=n.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[a.id]=a,this.mediaRequest_=null,this.refreshMedia_(a.id),s==="HAVE_MASTER"?this.trigger("loadedmetadata"):this.trigger("mediachange")},t.pause=function(){this.masterPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_),this.masterPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMaster_&&(Z.clearTimeout(this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_),this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)},t.load=function(n){var s=this;Z.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;var a=this.media();if(n){var c=a?a.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=Z.setTimeout(function(){return s.load()},c);return}if(!this.started){this.start();return}a&&!a.endList?(this.isMaster_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")},t.start=function(){var n=this;if(this.started=!0,!this.isMaster_){this.mediaRequest_=Z.setTimeout(function(){return n.haveMaster_()},0);return}this.requestMaster_(function(s,a){n.haveMaster_(),!n.hasPendingRequest()&&!n.media_&&n.media(n.masterPlaylistLoader_.master.playlists[0])})},t.requestMaster_=function(n){var s=this;this.request=this.vhs_.xhr({uri:this.masterPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},function(a,c){if(s.requestErrored_(a,c)){s.state==="HAVE_NOTHING"&&(s.started=!1);return}var h=c.responseText!==s.masterPlaylistLoader_.masterXml_;if(s.masterPlaylistLoader_.masterXml_=c.responseText,c.responseHeaders&&c.responseHeaders.date?s.masterLoaded_=Date.parse(c.responseHeaders.date):s.masterLoaded_=Date.now(),s.masterPlaylistLoader_.srcUrl=Ox(s.handleManifestRedirects,s.masterPlaylistLoader_.srcUrl,c),h){s.handleMaster_(),s.syncClientServerClock_(function(){return n(c,h)});return}return n(c,h)})},t.syncClientServerClock_=function(n){var s=this,a=VG(this.masterPlaylistLoader_.masterXml_);if(a===null)return this.masterPlaylistLoader_.clientOffset_=this.masterLoaded_-Date.now(),n();if(a.method==="DIRECT")return this.masterPlaylistLoader_.clientOffset_=a.value-Date.now(),n();this.request=this.vhs_.xhr({uri:qc(this.masterPlaylistLoader_.srcUrl,a.value),method:a.method,withCredentials:this.withCredentials},function(c,h){if(s.request){if(c)return s.masterPlaylistLoader_.clientOffset_=s.masterLoaded_-Date.now(),n();var m;a.method==="HEAD"?!h.responseHeaders||!h.responseHeaders.date?m=s.masterLoaded_:m=Date.parse(h.responseHeaders.date):m=Date.parse(h.responseText),s.masterPlaylistLoader_.clientOffset_=m-Date.now(),n()}})},t.haveMaster_=function(){this.state="HAVE_MASTER",this.isMaster_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)},t.handleMaster_=function(){this.mediaRequest_=null;var n=this.masterPlaylistLoader_.master,s=xq({masterXml:this.masterPlaylistLoader_.masterXml_,srcUrl:this.masterPlaylistLoader_.srcUrl,clientOffset:this.masterPlaylistLoader_.clientOffset_,sidxMapping:this.masterPlaylistLoader_.sidxMapping_,previousManifest:n});n&&(s=Aq(n,s,this.masterPlaylistLoader_.sidxMapping_)),this.masterPlaylistLoader_.master=s||n;var a=this.masterPlaylistLoader_.master.locations&&this.masterPlaylistLoader_.master.locations[0];return a&&a!==this.masterPlaylistLoader_.srcUrl&&(this.masterPlaylistLoader_.srcUrl=a),(!n||s&&s.minimumUpdatePeriod!==n.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),!!s},t.updateMinimumUpdatePeriodTimeout_=function(){var n=this.masterPlaylistLoader_;n.createMupOnMedia_&&(n.off("loadedmetadata",n.createMupOnMedia_),n.createMupOnMedia_=null),n.minimumUpdatePeriodTimeout_&&(Z.clearTimeout(n.minimumUpdatePeriodTimeout_),n.minimumUpdatePeriodTimeout_=null);var s=n.master&&n.master.minimumUpdatePeriod;if(s===0&&(n.media()?s=n.media().targetDuration*1e3:(n.createMupOnMedia_=n.updateMinimumUpdatePeriodTimeout_,n.one("loadedmetadata",n.createMupOnMedia_))),typeof s!="number"||s<=0){s<0&&this.logger_("found invalid minimumUpdatePeriod of "+s+", not setting a timeout");return}this.createMUPTimeout_(s)},t.createMUPTimeout_=function(n){var s=this.masterPlaylistLoader_;s.minimumUpdatePeriodTimeout_=Z.setTimeout(function(){s.minimumUpdatePeriodTimeout_=null,s.trigger("minimumUpdatePeriod"),s.createMUPTimeout_(n)},n)},t.refreshXml_=function(){var n=this;this.requestMaster_(function(s,a){a&&(n.media_&&(n.media_=n.masterPlaylistLoader_.master.playlists[n.media_.id]),n.masterPlaylistLoader_.sidxMapping_=Eq(n.masterPlaylistLoader_.master,n.masterPlaylistLoader_.sidxMapping_),n.addSidxSegments_(n.media(),n.state,function(c){n.refreshMedia_(n.media().id)}))})},t.refreshMedia_=function(n){var s=this;if(!n)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMaster_&&this.handleMaster_();var a=this.masterPlaylistLoader_.master.playlists,c=!this.media_||this.media_!==a[n];if(c?this.media_=a[n]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){var h=function m(){s.media().endList||(s.mediaUpdateTimeout=Z.setTimeout(function(){s.trigger("mediaupdatetimeout"),m()},KE(s.media(),!!c)))};h()}this.trigger("loadedplaylist")},e}(bq),Ka={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30},Cq=function(e){for(var t=new Uint8Array(new ArrayBuffer(e.length)),i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t.buffer},_B=function(e){return e.on=e.addEventListener,e.off=e.removeEventListener,e},Mq=function(e){try{return URL.createObjectURL(new Blob([e],{type:"application/javascript"}))}catch{var t=new BlobBuilder;return t.append(e),URL.createObjectURL(t.getBlob())}},bB=function(e){return function(){var t=Mq(e),i=_B(new Worker(t));i.objURL=t;var n=i.terminate;return i.on=i.addEventListener,i.off=i.removeEventListener,i.terminate=function(){return URL.revokeObjectURL(t),n.call(this)},i}},TB=function(e){return"var browserWorkerPolyFill = "+_B.toString()+`;
browserWorkerPolyFill(self);
`+e},xB=function(e){return e.toString().replace(/^function.+?{/,"").slice(0,-1)},Dq=TB(xB(function(){var r=function(){this.init=function(){var E={};this.on=function(F,R){E[F]||(E[F]=[]),E[F]=E[F].concat(R)},this.off=function(F,R){var V;return E[F]?(V=E[F].indexOf(R),E[F]=E[F].slice(),E[F].splice(V,1),V>-1):!1},this.trigger=function(F){var R,V,Q,ee;if(R=E[F],!!R)if(arguments.length===2)for(Q=R.length,V=0;V<Q;++V)R[V].call(this,arguments[1]);else{for(ee=[],V=arguments.length,V=1;V<arguments.length;++V)ee.push(arguments[V]);for(Q=R.length,V=0;V<Q;++V)R[V].apply(this,ee)}},this.dispose=function(){E={}}}};r.prototype.pipe=function(le){return this.on("data",function(E){le.push(E)}),this.on("done",function(E){le.flush(E)}),this.on("partialdone",function(E){le.partialFlush(E)}),this.on("endedtimeline",function(E){le.endTimeline(E)}),this.on("reset",function(E){le.reset(E)}),le},r.prototype.push=function(le){this.trigger("data",le)},r.prototype.flush=function(le){this.trigger("done",le)},r.prototype.partialFlush=function(le){this.trigger("partialdone",le)},r.prototype.endTimeline=function(le){this.trigger("endedtimeline",le)},r.prototype.reset=function(le){this.trigger("reset",le)};var e=r,t=Math.pow(2,32),i=function(E){var F=new DataView(E.buffer,E.byteOffset,E.byteLength),R;return F.getBigUint64?(R=F.getBigUint64(0),R<Number.MAX_SAFE_INTEGER?Number(R):R):F.getUint32(0)*t+F.getUint32(4)},n={getUint64:i,MAX_UINT32:t},s=n.MAX_UINT32,a,c,h,m,v,b,x,C,B,P,N,ae,X,de,ge,ue,be,fe,ve,ie,re,Ne,De,ke,ut,_t,vt,tt,je,it,Xe,Se,ct,xt,ii,Re;(function(){var le;if(De={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(le in De)De.hasOwnProperty(le)&&(De[le]=[le.charCodeAt(0),le.charCodeAt(1),le.charCodeAt(2),le.charCodeAt(3)]);ke=new Uint8Array([105,115,111,109]),_t=new Uint8Array([97,118,99,49]),ut=new Uint8Array([0,0,0,1]),vt=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),tt=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),je={video:vt,audio:tt},Se=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Xe=new Uint8Array([0,0,0,0,0,0,0,0]),ct=new Uint8Array([0,0,0,0,0,0,0,0]),xt=ct,ii=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Re=ct,it=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),a=function(E){var F=[],R=0,V,Q,ee;for(V=1;V<arguments.length;V++)F.push(arguments[V]);for(V=F.length;V--;)R+=F[V].byteLength;for(Q=new Uint8Array(R+8),ee=new DataView(Q.buffer,Q.byteOffset,Q.byteLength),ee.setUint32(0,Q.byteLength),Q.set(E,4),V=0,R=8;V<F.length;V++)Q.set(F[V],R),R+=F[V].byteLength;return Q},c=function(){return a(De.dinf,a(De.dref,Se))},h=function(E){return a(De.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,E.audioobjecttype<<3|E.samplingfrequencyindex>>>1,E.samplingfrequencyindex<<7|E.channelcount<<3,6,1,2]))},m=function(){return a(De.ftyp,ke,ut,ke,_t)},ue=function(E){return a(De.hdlr,je[E])},v=function(E){return a(De.mdat,E)},ge=function(E){var F=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,E.duration>>>24&255,E.duration>>>16&255,E.duration>>>8&255,E.duration&255,85,196,0,0]);return E.samplerate&&(F[12]=E.samplerate>>>24&255,F[13]=E.samplerate>>>16&255,F[14]=E.samplerate>>>8&255,F[15]=E.samplerate&255),a(De.mdhd,F)},de=function(E){return a(De.mdia,ge(E),ue(E.type),x(E))},b=function(E){return a(De.mfhd,new Uint8Array([0,0,0,0,(E&4278190080)>>24,(E&16711680)>>16,(E&65280)>>8,E&255]))},x=function(E){return a(De.minf,E.type==="video"?a(De.vmhd,it):a(De.smhd,Xe),c(),fe(E))},C=function(E,F){for(var R=[],V=F.length;V--;)R[V]=ie(F[V]);return a.apply(null,[De.moof,b(E)].concat(R))},B=function(E){for(var F=E.length,R=[];F--;)R[F]=ae(E[F]);return a.apply(null,[De.moov,N(4294967295)].concat(R).concat(P(E)))},P=function(E){for(var F=E.length,R=[];F--;)R[F]=re(E[F]);return a.apply(null,[De.mvex].concat(R))},N=function(E){var F=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(E&4278190080)>>24,(E&16711680)>>16,(E&65280)>>8,E&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return a(De.mvhd,F)},be=function(E){var F=E.samples||[],R=new Uint8Array(4+F.length),V,Q;for(Q=0;Q<F.length;Q++)V=F[Q].flags,R[Q+4]=V.dependsOn<<4|V.isDependedOn<<2|V.hasRedundancy;return a(De.sdtp,R)},fe=function(E){return a(De.stbl,ve(E),a(De.stts,Re),a(De.stsc,xt),a(De.stsz,ii),a(De.stco,ct))},function(){var le,E;ve=function(R){return a(De.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),R.type==="video"?le(R):E(R))},le=function(R){var V=R.sps||[],Q=R.pps||[],ee=[],_e=[],Ce,Ve;for(Ce=0;Ce<V.length;Ce++)ee.push((V[Ce].byteLength&65280)>>>8),ee.push(V[Ce].byteLength&255),ee=ee.concat(Array.prototype.slice.call(V[Ce]));for(Ce=0;Ce<Q.length;Ce++)_e.push((Q[Ce].byteLength&65280)>>>8),_e.push(Q[Ce].byteLength&255),_e=_e.concat(Array.prototype.slice.call(Q[Ce]));if(Ve=[De.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(R.width&65280)>>8,R.width&255,(R.height&65280)>>8,R.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a(De.avcC,new Uint8Array([1,R.profileIdc,R.profileCompatibility,R.levelIdc,255].concat([V.length],ee,[Q.length],_e))),a(De.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],R.sarRatio){var Oe=R.sarRatio[0],Qe=R.sarRatio[1];Ve.push(a(De.pasp,new Uint8Array([(Oe&4278190080)>>24,(Oe&16711680)>>16,(Oe&65280)>>8,Oe&255,(Qe&4278190080)>>24,(Qe&16711680)>>16,(Qe&65280)>>8,Qe&255])))}return a.apply(null,Ve)},E=function(R){return a(De.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(R.channelcount&65280)>>8,R.channelcount&255,(R.samplesize&65280)>>8,R.samplesize&255,0,0,0,0,(R.samplerate&65280)>>8,R.samplerate&255,0,0]),h(R))}}(),X=function(E){var F=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(E.id&4278190080)>>24,(E.id&16711680)>>16,(E.id&65280)>>8,E.id&255,0,0,0,0,(E.duration&4278190080)>>24,(E.duration&16711680)>>16,(E.duration&65280)>>8,E.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(E.width&65280)>>8,E.width&255,0,0,(E.height&65280)>>8,E.height&255,0,0]);return a(De.tkhd,F)},ie=function(E){var F,R,V,Q,ee,_e,Ce;return F=a(De.tfhd,new Uint8Array([0,0,0,58,(E.id&4278190080)>>24,(E.id&16711680)>>16,(E.id&65280)>>8,E.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),_e=Math.floor(E.baseMediaDecodeTime/s),Ce=Math.floor(E.baseMediaDecodeTime%s),R=a(De.tfdt,new Uint8Array([1,0,0,0,_e>>>24&255,_e>>>16&255,_e>>>8&255,_e&255,Ce>>>24&255,Ce>>>16&255,Ce>>>8&255,Ce&255])),ee=92,E.type==="audio"?(V=Ne(E,ee),a(De.traf,F,R,V)):(Q=be(E),V=Ne(E,Q.length+ee),a(De.traf,F,R,V,Q))},ae=function(E){return E.duration=E.duration||4294967295,a(De.trak,X(E),de(E))},re=function(E){var F=new Uint8Array([0,0,0,0,(E.id&4278190080)>>24,(E.id&16711680)>>16,(E.id&65280)>>8,E.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return E.type!=="video"&&(F[F.length-1]=0),a(De.trex,F)},function(){var le,E,F;F=function(V,Q){var ee=0,_e=0,Ce=0,Ve=0;return V.length&&(V[0].duration!==void 0&&(ee=1),V[0].size!==void 0&&(_e=2),V[0].flags!==void 0&&(Ce=4),V[0].compositionTimeOffset!==void 0&&(Ve=8)),[0,0,ee|_e|Ce|Ve,1,(V.length&4278190080)>>>24,(V.length&16711680)>>>16,(V.length&65280)>>>8,V.length&255,(Q&4278190080)>>>24,(Q&16711680)>>>16,(Q&65280)>>>8,Q&255]},E=function(V,Q){var ee,_e,Ce,Ve,Oe,Qe;for(Ve=V.samples||[],Q+=20+16*Ve.length,Ce=F(Ve,Q),_e=new Uint8Array(Ce.length+Ve.length*16),_e.set(Ce),ee=Ce.length,Qe=0;Qe<Ve.length;Qe++)Oe=Ve[Qe],_e[ee++]=(Oe.duration&4278190080)>>>24,_e[ee++]=(Oe.duration&16711680)>>>16,_e[ee++]=(Oe.duration&65280)>>>8,_e[ee++]=Oe.duration&255,_e[ee++]=(Oe.size&4278190080)>>>24,_e[ee++]=(Oe.size&16711680)>>>16,_e[ee++]=(Oe.size&65280)>>>8,_e[ee++]=Oe.size&255,_e[ee++]=Oe.flags.isLeading<<2|Oe.flags.dependsOn,_e[ee++]=Oe.flags.isDependedOn<<6|Oe.flags.hasRedundancy<<4|Oe.flags.paddingValue<<1|Oe.flags.isNonSyncSample,_e[ee++]=Oe.flags.degradationPriority&61440,_e[ee++]=Oe.flags.degradationPriority&15,_e[ee++]=(Oe.compositionTimeOffset&4278190080)>>>24,_e[ee++]=(Oe.compositionTimeOffset&16711680)>>>16,_e[ee++]=(Oe.compositionTimeOffset&65280)>>>8,_e[ee++]=Oe.compositionTimeOffset&255;return a(De.trun,_e)},le=function(V,Q){var ee,_e,Ce,Ve,Oe,Qe;for(Ve=V.samples||[],Q+=20+8*Ve.length,Ce=F(Ve,Q),ee=new Uint8Array(Ce.length+Ve.length*8),ee.set(Ce),_e=Ce.length,Qe=0;Qe<Ve.length;Qe++)Oe=Ve[Qe],ee[_e++]=(Oe.duration&4278190080)>>>24,ee[_e++]=(Oe.duration&16711680)>>>16,ee[_e++]=(Oe.duration&65280)>>>8,ee[_e++]=Oe.duration&255,ee[_e++]=(Oe.size&4278190080)>>>24,ee[_e++]=(Oe.size&16711680)>>>16,ee[_e++]=(Oe.size&65280)>>>8,ee[_e++]=Oe.size&255;return a(De.trun,ee)},Ne=function(V,Q){return V.type==="audio"?le(V,Q):E(V,Q)}}();var lt={ftyp:m,mdat:v,moof:C,moov:B,initSegment:function(E){var F=m(),R=B(E),V;return V=new Uint8Array(F.byteLength+R.byteLength),V.set(F),V.set(R,F.byteLength),V}},bt=function(E){var F,R,V=[],Q=[];for(Q.byteLength=0,Q.nalCount=0,Q.duration=0,V.byteLength=0,F=0;F<E.length;F++)R=E[F],R.nalUnitType==="access_unit_delimiter_rbsp"?(V.length&&(V.duration=R.dts-V.dts,Q.byteLength+=V.byteLength,Q.nalCount+=V.length,Q.duration+=V.duration,Q.push(V)),V=[R],V.byteLength=R.data.byteLength,V.pts=R.pts,V.dts=R.dts):(R.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(V.keyFrame=!0),V.duration=R.dts-V.dts,V.byteLength+=R.data.byteLength,V.push(R));return Q.length&&(!V.duration||V.duration<=0)&&(V.duration=Q[Q.length-1].duration),Q.byteLength+=V.byteLength,Q.nalCount+=V.length,Q.duration+=V.duration,Q.push(V),Q},Je=function(E){var F,R,V=[],Q=[];for(V.byteLength=0,V.nalCount=0,V.duration=0,V.pts=E[0].pts,V.dts=E[0].dts,Q.byteLength=0,Q.nalCount=0,Q.duration=0,Q.pts=E[0].pts,Q.dts=E[0].dts,F=0;F<E.length;F++)R=E[F],R.keyFrame?(V.length&&(Q.push(V),Q.byteLength+=V.byteLength,Q.nalCount+=V.nalCount,Q.duration+=V.duration),V=[R],V.nalCount=R.length,V.byteLength=R.byteLength,V.pts=R.pts,V.dts=R.dts,V.duration=R.duration):(V.duration+=R.duration,V.nalCount+=R.length,V.byteLength+=R.byteLength,V.push(R));return Q.length&&V.duration<=0&&(V.duration=Q[Q.length-1].duration),Q.byteLength+=V.byteLength,Q.nalCount+=V.nalCount,Q.duration+=V.duration,Q.push(V),Q},Dt=function(E){var F;return!E[0][0].keyFrame&&E.length>1&&(F=E.shift(),E.byteLength-=F.byteLength,E.nalCount-=F.nalCount,E[0][0].dts=F.dts,E[0][0].pts=F.pts,E[0][0].duration+=F.duration),E},Yt=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},vi=function(E,F){var R=Yt();return R.dataOffset=F,R.compositionTimeOffset=E.pts-E.dts,R.duration=E.duration,R.size=4*E.length,R.size+=E.byteLength,E.keyFrame&&(R.flags.dependsOn=2,R.flags.isNonSyncSample=0),R},xi=function(E,F){var R,V,Q,ee,_e,Ce=F||0,Ve=[];for(R=0;R<E.length;R++)for(ee=E[R],V=0;V<ee.length;V++)_e=ee[V],Q=vi(_e,Ce),Ce+=Q.size,Ve.push(Q);return Ve},Yi=function(E){var F,R,V,Q,ee,_e,Ce=0,Ve=E.byteLength,Oe=E.nalCount,Qe=Ve+4*Oe,kt=new Uint8Array(Qe),ui=new DataView(kt.buffer);for(F=0;F<E.length;F++)for(Q=E[F],R=0;R<Q.length;R++)for(ee=Q[R],V=0;V<ee.length;V++)_e=ee[V],ui.setUint32(Ce,_e.data.byteLength),Ce+=4,kt.set(_e.data,Ce),Ce+=_e.data.byteLength;return kt},Ki=function(E,F){var R,V=F||0,Q=[];return R=vi(E,V),Q.push(R),Q},io=function(E){var F,R,V=0,Q=E.byteLength,ee=E.length,_e=Q+4*ee,Ce=new Uint8Array(_e),Ve=new DataView(Ce.buffer);for(F=0;F<E.length;F++)R=E[F],Ve.setUint32(V,R.data.byteLength),V+=4,Ce.set(R.data,V),V+=R.data.byteLength;return Ce},yr={groupNalsIntoFrames:bt,groupFramesIntoGops:Je,extendFirstKeyFrame:Dt,generateSampleTable:xi,concatenateNalData:Yi,generateSampleTableForFrame:Ki,concatenateNalDataForFrame:io},bs=[33,16,5,32,164,27],cs=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],sn=function(E){for(var F=[];E--;)F.push(0);return F},dn=function(E){return Object.keys(E).reduce(function(F,R){return F[R]=new Uint8Array(E[R].reduce(function(V,Q){return V.concat(Q)},[])),F},{})},gn,Sr=function(){if(!gn){var E={96e3:[bs,[227,64],sn(154),[56]],88200:[bs,[231],sn(170),[56]],64e3:[bs,[248,192],sn(240),[56]],48e3:[bs,[255,192],sn(268),[55,148,128],sn(54),[112]],44100:[bs,[255,192],sn(268),[55,163,128],sn(84),[112]],32e3:[bs,[255,192],sn(268),[55,234],sn(226),[112]],24e3:[bs,[255,192],sn(268),[55,255,128],sn(268),[111,112],sn(126),[224]],16e3:[bs,[255,192],sn(268),[55,255,128],sn(268),[111,255],sn(269),[223,108],sn(195),[1,192]],12e3:[cs,sn(268),[3,127,248],sn(268),[6,255,240],sn(268),[13,255,224],sn(268),[27,253,128],sn(259),[56]],11025:[cs,sn(268),[3,127,248],sn(268),[6,255,240],sn(268),[13,255,224],sn(268),[27,255,192],sn(268),[55,175,128],sn(108),[112]],8e3:[cs,sn(268),[3,121,16],sn(47),[7]]};gn=dn(E)}return gn},fa=9e4,Oa,Js,Sa,ds,js,Vo,Aa;Oa=function(E){return E*fa},Js=function(E,F){return E*F},Sa=function(E){return E/fa},ds=function(E,F){return E/F},js=function(E,F){return Oa(ds(E,F))},Vo=function(E,F){return Js(Sa(E),F)},Aa=function(E,F,R){return Sa(R?E:E-F)};var an={ONE_SECOND_IN_TS:fa,secondsToVideoTs:Oa,secondsToAudioTs:Js,videoTsToSeconds:Sa,audioTsToSeconds:ds,audioTsToVideoTs:js,videoTsToAudioTs:Vo,metadataTsToSeconds:Aa},Ze=function(E){var F,R,V=0;for(F=0;F<E.length;F++)R=E[F],V+=R.data.byteLength;return V},St=function(E,F,R,V){var Q,ee=0,_e=0,Ce=0,Ve=0,Oe,Qe,kt;if(F.length&&(Q=an.audioTsToVideoTs(E.baseMediaDecodeTime,E.samplerate),ee=Math.ceil(an.ONE_SECOND_IN_TS/(E.samplerate/1024)),R&&V&&(_e=Q-Math.max(R,V),Ce=Math.floor(_e/ee),Ve=Ce*ee),!(Ce<1||Ve>an.ONE_SECOND_IN_TS/2))){for(Oe=Sr()[E.samplerate],Oe||(Oe=F[0].data),Qe=0;Qe<Ce;Qe++)kt=F[0],F.splice(0,0,{data:Oe,dts:kt.dts-ee,pts:kt.pts-ee});return E.baseMediaDecodeTime-=Math.floor(an.videoTsToAudioTs(Ve,E.samplerate)),Ve}},Ft=function(E,F,R){return F.minSegmentDts>=R?E:(F.minSegmentDts=1/0,E.filter(function(V){return V.dts>=R?(F.minSegmentDts=Math.min(F.minSegmentDts,V.dts),F.minSegmentPts=F.minSegmentDts,!0):!1}))},di=function(E){var F,R,V=[];for(F=0;F<E.length;F++)R=E[F],V.push({size:R.data.byteLength,duration:1024});return V},Oi=function(E){var F,R,V=0,Q=new Uint8Array(Ze(E));for(F=0;F<E.length;F++)R=E[F],Q.set(R.data,V),V+=R.data.byteLength;return Q},Fn={prefixWithSilence:St,trimAdtsFramesByEarliestDts:Ft,generateSampleTable:di,concatenateFrameData:Oi},Ar=an.ONE_SECOND_IN_TS,Zi=function(E,F){typeof F.pts=="number"&&(E.timelineStartInfo.pts===void 0&&(E.timelineStartInfo.pts=F.pts),E.minSegmentPts===void 0?E.minSegmentPts=F.pts:E.minSegmentPts=Math.min(E.minSegmentPts,F.pts),E.maxSegmentPts===void 0?E.maxSegmentPts=F.pts:E.maxSegmentPts=Math.max(E.maxSegmentPts,F.pts)),typeof F.dts=="number"&&(E.timelineStartInfo.dts===void 0&&(E.timelineStartInfo.dts=F.dts),E.minSegmentDts===void 0?E.minSegmentDts=F.dts:E.minSegmentDts=Math.min(E.minSegmentDts,F.dts),E.maxSegmentDts===void 0?E.maxSegmentDts=F.dts:E.maxSegmentDts=Math.max(E.maxSegmentDts,F.dts))},pi=function(E){delete E.minSegmentDts,delete E.maxSegmentDts,delete E.minSegmentPts,delete E.maxSegmentPts},ne=function(E,F){var R,V,Q=E.minSegmentDts;return F||(Q-=E.timelineStartInfo.dts),R=E.timelineStartInfo.baseMediaDecodeTime,R+=Q,R=Math.max(0,R),E.type==="audio"&&(V=E.samplerate/Ar,R*=V,R=Math.floor(R)),R},oe={clearDtsInfo:pi,calculateTrackBaseMediaDecodeTime:ne,collectDtsInfo:Zi},xe=4,Ye=128,jt=function(E){for(var F=0,R={payloadType:-1,payloadSize:0},V=0,Q=0;F<E.byteLength&&E[F]!==Ye;){for(;E[F]===255;)V+=255,F++;for(V+=E[F++];E[F]===255;)Q+=255,F++;if(Q+=E[F++],!R.payload&&V===xe){var ee=String.fromCharCode(E[F+3],E[F+4],E[F+5],E[F+6]);if(ee==="GA94"){R.payloadType=V,R.payloadSize=Q,R.payload=E.subarray(F,F+Q);break}else R.payload=void 0}F+=Q,V=0,Q=0}return R},bi=function(E){return E.payload[0]!==181||(E.payload[1]<<8|E.payload[2])!==49||String.fromCharCode(E.payload[3],E.payload[4],E.payload[5],E.payload[6])!=="GA94"||E.payload[7]!==3?null:E.payload.subarray(8,E.payload.length-1)},Ui=function(E,F){var R=[],V,Q,ee,_e;if(!(F[0]&64))return R;for(Q=F[0]&31,V=0;V<Q;V++)ee=V*3,_e={type:F[ee+2]&3,pts:E},F[ee+2]&4&&(_e.ccData=F[ee+3]<<8|F[ee+4],R.push(_e));return R},Qr=function(E){for(var F=E.byteLength,R=[],V=1,Q,ee;V<F-2;)E[V]===0&&E[V+1]===0&&E[V+2]===3?(R.push(V+2),V+=2):V++;if(R.length===0)return E;Q=F-R.length,ee=new Uint8Array(Q);var _e=0;for(V=0;V<Q;_e++,V++)_e===R[0]&&(_e++,R.shift()),ee[V]=E[_e];return ee},Kr={parseSei:jt,parseUserData:bi,parseCaptionPackets:Ui,discardEmulationPreventionBytes:Qr,USER_DATA_REGISTERED_ITU_T_T35:xe},ur=function le(E){E=E||{},le.prototype.init.call(this),this.parse708captions_=typeof E.parse708captions=="boolean"?E.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new Lr(0,0),new Lr(0,1),new Lr(1,0),new Lr(1,1)],this.parse708captions_&&(this.cc708Stream_=new ln({captionServices:E.captionServices})),this.reset(),this.ccStreams_.forEach(function(F){F.on("data",this.trigger.bind(this,"data")),F.on("partialdone",this.trigger.bind(this,"partialdone")),F.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};ur.prototype=new e,ur.prototype.push=function(le){var E,F,R;if(le.nalUnitType==="sei_rbsp"&&(E=Kr.parseSei(le.escapedRBSP),!!E.payload&&E.payloadType===Kr.USER_DATA_REGISTERED_ITU_T_T35&&(F=Kr.parseUserData(E),!!F))){if(le.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(le.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}R=Kr.parseCaptionPackets(le.pts,F),this.captionPackets_=this.captionPackets_.concat(R),this.latestDts_!==le.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=le.dts}},ur.prototype.flushCCStreams=function(le){this.ccStreams_.forEach(function(E){return le==="flush"?E.flush():E.partialFlush()},this)},ur.prototype.flushStream=function(le){if(!this.captionPackets_.length){this.flushCCStreams(le);return}this.captionPackets_.forEach(function(E,F){E.presortIndex=F}),this.captionPackets_.sort(function(E,F){return E.pts===F.pts?E.presortIndex-F.presortIndex:E.pts-F.pts}),this.captionPackets_.forEach(function(E){E.type<2?this.dispatchCea608Packet(E):this.dispatchCea708Packet(E)},this),this.captionPackets_.length=0,this.flushCCStreams(le)},ur.prototype.flush=function(){return this.flushStream("flush")},ur.prototype.partialFlush=function(){return this.flushStream("partialFlush")},ur.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(le){le.reset()})},ur.prototype.dispatchCea608Packet=function(le){this.setsTextOrXDSActive(le)?this.activeCea608Channel_[le.type]=null:this.setsChannel1Active(le)?this.activeCea608Channel_[le.type]=0:this.setsChannel2Active(le)&&(this.activeCea608Channel_[le.type]=1),this.activeCea608Channel_[le.type]!==null&&this.ccStreams_[(le.type<<1)+this.activeCea608Channel_[le.type]].push(le)},ur.prototype.setsChannel1Active=function(le){return(le.ccData&30720)===4096},ur.prototype.setsChannel2Active=function(le){return(le.ccData&30720)===6144},ur.prototype.setsTextOrXDSActive=function(le){return(le.ccData&28928)===256||(le.ccData&30974)===4138||(le.ccData&30974)===6186},ur.prototype.dispatchCea708Packet=function(le){this.parse708captions_&&this.cc708Stream_.push(le)};var wa={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},pa=function(E){var F=wa[E]||E;return E&4096&&E===F?"":String.fromCharCode(F)},Ls=function(E){return 32<=E&&E<=127||160<=E&&E<=255},Ir=function(E){this.windowNum=E,this.reset()};Ir.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Ir.prototype.getText=function(){return this.rows.join(`
`)},Ir.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Ir.prototype.newLine=function(le){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(le),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Ir.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},Ir.prototype.addText=function(le){this.rows[this.rowIdx]+=le},Ir.prototype.backspace=function(){if(!this.isEmpty()){var le=this.rows[this.rowIdx];this.rows[this.rowIdx]=le.substr(0,le.length-1)}};var Gn=function(E,F,R){this.serviceNum=E,this.text="",this.currentWindow=new Ir(-1),this.windows=[],this.stream=R,typeof F=="string"&&this.createTextDecoder(F)};Gn.prototype.init=function(le,E){this.startPts=le;for(var F=0;F<8;F++)this.windows[F]=new Ir(F),typeof E=="function"&&(this.windows[F].beforeRowOverflow=E)},Gn.prototype.setCurrentWindow=function(le){this.currentWindow=this.windows[le]},Gn.prototype.createTextDecoder=function(le){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(le)}catch(E){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+le+" encoding. "+E})}};var ln=function le(E){E=E||{},le.prototype.init.call(this);var F=this,R=E.captionServices||{},V={},Q;Object.keys(R).forEach(function(ee){Q=R[ee],/^SERVICE/.test(ee)&&(V[ee]=Q.encoding)}),this.serviceEncodings=V,this.current708Packet=null,this.services={},this.push=function(ee){ee.type===3?(F.new708Packet(),F.add708Bytes(ee)):(F.current708Packet===null&&F.new708Packet(),F.add708Bytes(ee))}};ln.prototype=new e,ln.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},ln.prototype.add708Bytes=function(le){var E=le.ccData,F=E>>>8,R=E&255;this.current708Packet.ptsVals.push(le.pts),this.current708Packet.data.push(F),this.current708Packet.data.push(R)},ln.prototype.push708Packet=function(){var le=this.current708Packet,E=le.data,F=null,R=null,V=0,Q=E[V++];for(le.seq=Q>>6,le.sizeCode=Q&63;V<E.length;V++)Q=E[V++],F=Q>>5,R=Q&31,F===7&&R>0&&(Q=E[V++],F=Q),this.pushServiceBlock(F,V,R),R>0&&(V+=R-1)},ln.prototype.pushServiceBlock=function(le,E,F){var R,V=E,Q=this.current708Packet.data,ee=this.services[le];for(ee||(ee=this.initService(le,V));V<E+F&&V<Q.length;V++)R=Q[V],Ls(R)?V=this.handleText(V,ee):R===24?V=this.multiByteCharacter(V,ee):R===16?V=this.extendedCommands(V,ee):128<=R&&R<=135?V=this.setCurrentWindow(V,ee):152<=R&&R<=159?V=this.defineWindow(V,ee):R===136?V=this.clearWindows(V,ee):R===140?V=this.deleteWindows(V,ee):R===137?V=this.displayWindows(V,ee):R===138?V=this.hideWindows(V,ee):R===139?V=this.toggleWindows(V,ee):R===151?V=this.setWindowAttributes(V,ee):R===144?V=this.setPenAttributes(V,ee):R===145?V=this.setPenColor(V,ee):R===146?V=this.setPenLocation(V,ee):R===143?ee=this.reset(V,ee):R===8?ee.currentWindow.backspace():R===12?ee.currentWindow.clearText():R===13?ee.currentWindow.pendingNewLine=!0:R===14?ee.currentWindow.clearText():R===141&&V++},ln.prototype.extendedCommands=function(le,E){var F=this.current708Packet.data,R=F[++le];return Ls(R)&&(le=this.handleText(le,E,{isExtended:!0})),le},ln.prototype.getPts=function(le){return this.current708Packet.ptsVals[Math.floor(le/2)]},ln.prototype.initService=function(le,E){var R="SERVICE"+le,F=this,R,V;return R in this.serviceEncodings&&(V=this.serviceEncodings[R]),this.services[le]=new Gn(le,V,F),this.services[le].init(this.getPts(E),function(Q){F.flushDisplayed(Q,F.services[le])}),this.services[le]},ln.prototype.handleText=function(le,E,F){var R=F&&F.isExtended,V=F&&F.isMultiByte,Q=this.current708Packet.data,ee=R?4096:0,_e=Q[le],Ce=Q[le+1],Ve=E.currentWindow,Oe,Qe;return E.textDecoder_&&!R?(V?(Qe=[_e,Ce],le++):Qe=[_e],Oe=E.textDecoder_.decode(new Uint8Array(Qe))):Oe=pa(ee|_e),Ve.pendingNewLine&&!Ve.isEmpty()&&Ve.newLine(this.getPts(le)),Ve.pendingNewLine=!1,Ve.addText(Oe),le},ln.prototype.multiByteCharacter=function(le,E){var F=this.current708Packet.data,R=F[le+1],V=F[le+2];return Ls(R)&&Ls(V)&&(le=this.handleText(++le,E,{isMultiByte:!0})),le},ln.prototype.setCurrentWindow=function(le,E){var F=this.current708Packet.data,R=F[le],V=R&7;return E.setCurrentWindow(V),le},ln.prototype.defineWindow=function(le,E){var F=this.current708Packet.data,R=F[le],V=R&7;E.setCurrentWindow(V);var Q=E.currentWindow;return R=F[++le],Q.visible=(R&32)>>5,Q.rowLock=(R&16)>>4,Q.columnLock=(R&8)>>3,Q.priority=R&7,R=F[++le],Q.relativePositioning=(R&128)>>7,Q.anchorVertical=R&127,R=F[++le],Q.anchorHorizontal=R,R=F[++le],Q.anchorPoint=(R&240)>>4,Q.rowCount=R&15,R=F[++le],Q.columnCount=R&63,R=F[++le],Q.windowStyle=(R&56)>>3,Q.penStyle=R&7,Q.virtualRowCount=Q.rowCount+1,le},ln.prototype.setWindowAttributes=function(le,E){var F=this.current708Packet.data,R=F[le],V=E.currentWindow.winAttr;return R=F[++le],V.fillOpacity=(R&192)>>6,V.fillRed=(R&48)>>4,V.fillGreen=(R&12)>>2,V.fillBlue=R&3,R=F[++le],V.borderType=(R&192)>>6,V.borderRed=(R&48)>>4,V.borderGreen=(R&12)>>2,V.borderBlue=R&3,R=F[++le],V.borderType+=(R&128)>>5,V.wordWrap=(R&64)>>6,V.printDirection=(R&48)>>4,V.scrollDirection=(R&12)>>2,V.justify=R&3,R=F[++le],V.effectSpeed=(R&240)>>4,V.effectDirection=(R&12)>>2,V.displayEffect=R&3,le},ln.prototype.flushDisplayed=function(le,E){for(var F=[],R=0;R<8;R++)E.windows[R].visible&&!E.windows[R].isEmpty()&&F.push(E.windows[R].getText());E.endPts=le,E.text=F.join(`

`),this.pushCaption(E),E.startPts=le},ln.prototype.pushCaption=function(le){le.text!==""&&(this.trigger("data",{startPts:le.startPts,endPts:le.endPts,text:le.text,stream:"cc708_"+le.serviceNum}),le.text="",le.startPts=le.endPts)},ln.prototype.displayWindows=function(le,E){var F=this.current708Packet.data,R=F[++le],V=this.getPts(le);this.flushDisplayed(V,E);for(var Q=0;Q<8;Q++)R&1<<Q&&(E.windows[Q].visible=1);return le},ln.prototype.hideWindows=function(le,E){var F=this.current708Packet.data,R=F[++le],V=this.getPts(le);this.flushDisplayed(V,E);for(var Q=0;Q<8;Q++)R&1<<Q&&(E.windows[Q].visible=0);return le},ln.prototype.toggleWindows=function(le,E){var F=this.current708Packet.data,R=F[++le],V=this.getPts(le);this.flushDisplayed(V,E);for(var Q=0;Q<8;Q++)R&1<<Q&&(E.windows[Q].visible^=1);return le},ln.prototype.clearWindows=function(le,E){var F=this.current708Packet.data,R=F[++le],V=this.getPts(le);this.flushDisplayed(V,E);for(var Q=0;Q<8;Q++)R&1<<Q&&E.windows[Q].clearText();return le},ln.prototype.deleteWindows=function(le,E){var F=this.current708Packet.data,R=F[++le],V=this.getPts(le);this.flushDisplayed(V,E);for(var Q=0;Q<8;Q++)R&1<<Q&&E.windows[Q].reset();return le},ln.prototype.setPenAttributes=function(le,E){var F=this.current708Packet.data,R=F[le],V=E.currentWindow.penAttr;return R=F[++le],V.textTag=(R&240)>>4,V.offset=(R&12)>>2,V.penSize=R&3,R=F[++le],V.italics=(R&128)>>7,V.underline=(R&64)>>6,V.edgeType=(R&56)>>3,V.fontStyle=R&7,le},ln.prototype.setPenColor=function(le,E){var F=this.current708Packet.data,R=F[le],V=E.currentWindow.penColor;return R=F[++le],V.fgOpacity=(R&192)>>6,V.fgRed=(R&48)>>4,V.fgGreen=(R&12)>>2,V.fgBlue=R&3,R=F[++le],V.bgOpacity=(R&192)>>6,V.bgRed=(R&48)>>4,V.bgGreen=(R&12)>>2,V.bgBlue=R&3,R=F[++le],V.edgeRed=(R&48)>>4,V.edgeGreen=(R&12)>>2,V.edgeBlue=R&3,le},ln.prototype.setPenLocation=function(le,E){var F=this.current708Packet.data,R=F[le],V=E.currentWindow.penLoc;return E.currentWindow.pendingNewLine=!0,R=F[++le],V.row=R&15,R=F[++le],V.column=R&63,le},ln.prototype.reset=function(le,E){var F=this.getPts(le);return this.flushDisplayed(F,E),this.initService(E.serviceNum,le)};var Fa={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Pr=function(E){return E===null?"":(E=Fa[E]||E,String.fromCharCode(E))},ea=14,no=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],nn=function(){for(var E=[],F=ea+1;F--;)E.push("");return E},Lr=function le(E,F){le.prototype.init.call(this),this.field_=E||0,this.dataChannel_=F||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(R){var V,Q,ee,_e,Ce;if(V=R.ccData&32639,V===this.lastControlCode_){this.lastControlCode_=null;return}if((V&61440)===4096?this.lastControlCode_=V:V!==this.PADDING_&&(this.lastControlCode_=null),ee=V>>>8,_e=V&255,V!==this.PADDING_)if(V===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(V===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(R.pts),this.flushDisplayed(R.pts),Q=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=Q,this.startPts_=R.pts;else if(V===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(R.pts);else if(V===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(R.pts);else if(V===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(R.pts);else if(V===this.CARRIAGE_RETURN_)this.clearFormatting(R.pts),this.flushDisplayed(R.pts),this.shiftRowsUp_(),this.startPts_=R.pts;else if(V===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(V===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(R.pts),this.displayed_=nn();else if(V===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=nn();else if(V===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(R.pts),this.displayed_=nn()),this.mode_="paintOn",this.startPts_=R.pts;else if(this.isSpecialCharacter(ee,_e))ee=(ee&3)<<8,Ce=Pr(ee|_e),this[this.mode_](R.pts,Ce),this.column_++;else if(this.isExtCharacter(ee,_e))this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),ee=(ee&3)<<8,Ce=Pr(ee|_e),this[this.mode_](R.pts,Ce),this.column_++;else if(this.isMidRowCode(ee,_e))this.clearFormatting(R.pts),this[this.mode_](R.pts," "),this.column_++,(_e&14)===14&&this.addFormatting(R.pts,["i"]),(_e&1)===1&&this.addFormatting(R.pts,["u"]);else if(this.isOffsetControlCode(ee,_e))this.column_+=_e&3;else if(this.isPAC(ee,_e)){var Ve=no.indexOf(V&7968);this.mode_==="rollUp"&&(Ve-this.rollUpRows_+1<0&&(Ve=this.rollUpRows_-1),this.setRollUp(R.pts,Ve)),Ve!==this.row_&&(this.clearFormatting(R.pts),this.row_=Ve),_e&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(R.pts,["u"]),(V&16)===16&&(this.column_=((V&14)>>1)*4),this.isColorPAC(_e)&&(_e&14)===14&&this.addFormatting(R.pts,["i"])}else this.isNormalChar(ee)&&(_e===0&&(_e=null),Ce=Pr(ee),Ce+=Pr(_e),this[this.mode_](R.pts,Ce),this.column_+=Ce.length)}};Lr.prototype=new e,Lr.prototype.flushDisplayed=function(le){var E=this.displayed_.map(function(F,R){try{return F.trim()}catch{return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+R+"."}),""}},this).join(`
`).replace(/^\n+|\n+$/g,"");E.length&&this.trigger("data",{startPts:this.startPts_,endPts:le,text:E,stream:this.name_})},Lr.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=nn(),this.nonDisplayed_=nn(),this.lastControlCode_=null,this.column_=0,this.row_=ea,this.rollUpRows_=2,this.formatting_=[]},Lr.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},Lr.prototype.isSpecialCharacter=function(le,E){return le===this.EXT_&&E>=48&&E<=63},Lr.prototype.isExtCharacter=function(le,E){return(le===this.EXT_+1||le===this.EXT_+2)&&E>=32&&E<=63},Lr.prototype.isMidRowCode=function(le,E){return le===this.EXT_&&E>=32&&E<=47},Lr.prototype.isOffsetControlCode=function(le,E){return le===this.OFFSET_&&E>=33&&E<=35},Lr.prototype.isPAC=function(le,E){return le>=this.BASE_&&le<this.BASE_+8&&E>=64&&E<=127},Lr.prototype.isColorPAC=function(le){return le>=64&&le<=79||le>=96&&le<=127},Lr.prototype.isNormalChar=function(le){return le>=32&&le<=127},Lr.prototype.setRollUp=function(le,E){if(this.mode_!=="rollUp"&&(this.row_=ea,this.mode_="rollUp",this.flushDisplayed(le),this.nonDisplayed_=nn(),this.displayed_=nn()),E!==void 0&&E!==this.row_)for(var F=0;F<this.rollUpRows_;F++)this.displayed_[E-F]=this.displayed_[this.row_-F],this.displayed_[this.row_-F]="";E===void 0&&(E=this.row_),this.topRow_=E-this.rollUpRows_+1},Lr.prototype.addFormatting=function(le,E){this.formatting_=this.formatting_.concat(E);var F=E.reduce(function(R,V){return R+"<"+V+">"},"");this[this.mode_](le,F)},Lr.prototype.clearFormatting=function(le){if(this.formatting_.length){var E=this.formatting_.reverse().reduce(function(F,R){return F+"</"+R+">"},"");this.formatting_=[],this[this.mode_](le,E)}},Lr.prototype.popOn=function(le,E){var F=this.nonDisplayed_[this.row_];F+=E,this.nonDisplayed_[this.row_]=F},Lr.prototype.rollUp=function(le,E){var F=this.displayed_[this.row_];F+=E,this.displayed_[this.row_]=F},Lr.prototype.shiftRowsUp_=function(){var le;for(le=0;le<this.topRow_;le++)this.displayed_[le]="";for(le=this.row_+1;le<ea+1;le++)this.displayed_[le]="";for(le=this.topRow_;le<this.row_;le++)this.displayed_[le]=this.displayed_[le+1];this.displayed_[this.row_]=""},Lr.prototype.paintOn=function(le,E){var F=this.displayed_[this.row_];F+=E,this.displayed_[this.row_]=F};var ta={CaptionStream:ur,Cea608Stream:Lr,Cea708Stream:ln},cr={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},kf=8589934592,_l=4294967296,rr="shared",zo=function(E,F){var R=1;for(E>F&&(R=-1);Math.abs(F-E)>_l;)E+=R*kf;return E},xc=function le(E){var F,R;le.prototype.init.call(this),this.type_=E||rr,this.push=function(V){this.type_!==rr&&V.type!==this.type_||(R===void 0&&(R=V.dts),V.dts=zo(V.dts,R),V.pts=zo(V.pts,R),F=V.dts,this.trigger("data",V))},this.flush=function(){R=F,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){R=void 0,F=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};xc.prototype=new e;var Of={TimestampRolloverStream:xc,handleRollover:zo},Gr=function(E,F,R){var V,Q="";for(V=F;V<R;V++)Q+="%"+("00"+E[V].toString(16)).slice(-2);return Q},nd=function(E,F,R){return decodeURIComponent(Gr(E,F,R))},rd=function(E,F,R){return unescape(Gr(E,F,R))},su=function(E){return E[0]<<21|E[1]<<14|E[2]<<7|E[3]},bl={TXXX:function(E){var F;if(E.data[0]===3){for(F=1;F<E.data.length;F++)if(E.data[F]===0){E.description=nd(E.data,1,F),E.value=nd(E.data,F+1,E.data.length).replace(/\0*$/,"");break}E.data=E.value}},WXXX:function(E){var F;if(E.data[0]===3){for(F=1;F<E.data.length;F++)if(E.data[F]===0){E.description=nd(E.data,1,F),E.url=nd(E.data,F+1,E.data.length);break}}},PRIV:function(E){var F;for(F=0;F<E.data.length;F++)if(E.data[F]===0){E.owner=rd(E.data,0,F);break}E.privateData=E.data.subarray(F+1),E.data=E.privateData}},Qu;Qu=function(E){var F={descriptor:E&&E.descriptor},R=0,V=[],Q=0,ee;if(Qu.prototype.init.call(this),this.dispatchType=cr.METADATA_STREAM_TYPE.toString(16),F.descriptor)for(ee=0;ee<F.descriptor.length;ee++)this.dispatchType+=("00"+F.descriptor[ee].toString(16)).slice(-2);this.push=function(_e){var Ce,Ve,Oe,Qe,kt,ui;if(_e.type==="timed-metadata"){if(_e.dataAlignmentIndicator&&(Q=0,V.length=0),V.length===0&&(_e.data.length<10||_e.data[0]!==73||_e.data[1]!==68||_e.data[2]!==51)){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(V.push(_e),Q+=_e.data.byteLength,V.length===1&&(R=su(_e.data.subarray(6,10)),R+=10),!(Q<R)){for(Ce={data:new Uint8Array(R),frames:[],pts:V[0].pts,dts:V[0].dts},kt=0;kt<R;)Ce.data.set(V[0].data.subarray(0,R-kt),kt),kt+=V[0].data.byteLength,Q-=V[0].data.byteLength,V.shift();Ve=10,Ce.data[5]&64&&(Ve+=4,Ve+=su(Ce.data.subarray(10,14)),R-=su(Ce.data.subarray(16,20)));do{if(Oe=su(Ce.data.subarray(Ve+4,Ve+8)),Oe<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping metadata parsing."});return}if(ui=String.fromCharCode(Ce.data[Ve],Ce.data[Ve+1],Ce.data[Ve+2],Ce.data[Ve+3]),Qe={id:ui,data:Ce.data.subarray(Ve+10,Ve+Oe+10)},Qe.key=Qe.id,bl[Qe.id]&&(bl[Qe.id](Qe),Qe.owner==="com.apple.streaming.transportStreamTimestamp")){var yi=Qe.data,si=(yi[3]&1)<<30|yi[4]<<22|yi[5]<<14|yi[6]<<6|yi[7]>>>2;si*=4,si+=yi[7]&3,Qe.timeStamp=si,Ce.pts===void 0&&Ce.dts===void 0&&(Ce.pts=Qe.timeStamp,Ce.dts=Qe.timeStamp),this.trigger("timestamp",Qe)}Ce.frames.push(Qe),Ve+=10,Ve+=Oe}while(Ve<R);this.trigger("data",Ce)}}}},Qu.prototype=new e;var Ah=Qu,Sc=Of.TimestampRolloverStream,Rs,Ho,Gs,ro=188,au=71;Rs=function(){var E=new Uint8Array(ro),F=0;Rs.prototype.init.call(this),this.push=function(R){var V=0,Q=ro,ee;for(F?(ee=new Uint8Array(R.byteLength+F),ee.set(E.subarray(0,F)),ee.set(R,F),F=0):ee=R;Q<ee.byteLength;){if(ee[V]===au&&ee[Q]===au){this.trigger("data",ee.subarray(V,Q)),V+=ro,Q+=ro;continue}V++,Q++}V<ee.byteLength&&(E.set(ee.subarray(V),0),F=ee.byteLength-V)},this.flush=function(){F===ro&&E[0]===au&&(this.trigger("data",E),F=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){F=0,this.trigger("reset")}},Rs.prototype=new e,Ho=function(){var E,F,R,V;Ho.prototype.init.call(this),V=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,E=function(ee,_e){var Ce=0;_e.payloadUnitStartIndicator&&(Ce+=ee[Ce]+1),_e.type==="pat"?F(ee.subarray(Ce),_e):R(ee.subarray(Ce),_e)},F=function(ee,_e){_e.section_number=ee[7],_e.last_section_number=ee[8],V.pmtPid=(ee[10]&31)<<8|ee[11],_e.pmtPid=V.pmtPid},R=function(ee,_e){var Ce,Ve,Oe,Qe;if(ee[5]&1){for(V.programMapTable={video:null,audio:null,"timed-metadata":{}},Ce=(ee[1]&15)<<8|ee[2],Ve=3+Ce-4,Oe=(ee[10]&15)<<8|ee[11],Qe=12+Oe;Qe<Ve;){var kt=ee[Qe],ui=(ee[Qe+1]&31)<<8|ee[Qe+2];kt===cr.H264_STREAM_TYPE&&V.programMapTable.video===null?V.programMapTable.video=ui:kt===cr.ADTS_STREAM_TYPE&&V.programMapTable.audio===null?V.programMapTable.audio=ui:kt===cr.METADATA_STREAM_TYPE&&(V.programMapTable["timed-metadata"][ui]=kt),Qe+=((ee[Qe+3]&15)<<8|ee[Qe+4])+5}_e.programMapTable=V.programMapTable}},this.push=function(Q){var ee={},_e=4;if(ee.payloadUnitStartIndicator=!!(Q[1]&64),ee.pid=Q[1]&31,ee.pid<<=8,ee.pid|=Q[2],(Q[3]&48)>>>4>1&&(_e+=Q[_e]+1),ee.pid===0)ee.type="pat",E(Q.subarray(_e),ee),this.trigger("data",ee);else if(ee.pid===this.pmtPid)for(ee.type="pmt",E(Q.subarray(_e),ee),this.trigger("data",ee);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([Q,_e,ee]):this.processPes_(Q,_e,ee)},this.processPes_=function(Q,ee,_e){_e.pid===this.programMapTable.video?_e.streamType=cr.H264_STREAM_TYPE:_e.pid===this.programMapTable.audio?_e.streamType=cr.ADTS_STREAM_TYPE:_e.streamType=this.programMapTable["timed-metadata"][_e.pid],_e.type="pes",_e.data=Q.subarray(ee),this.trigger("data",_e)}},Ho.prototype=new e,Ho.STREAM_TYPES={h264:27,adts:15},Gs=function(){var E=this,F=!1,R={data:[],size:0},V={data:[],size:0},Q={data:[],size:0},ee,_e=function(Oe,Qe){var kt,ui=Oe[0]<<16|Oe[1]<<8|Oe[2];Qe.data=new Uint8Array,ui===1&&(Qe.packetLength=6+(Oe[4]<<8|Oe[5]),Qe.dataAlignmentIndicator=(Oe[6]&4)!==0,kt=Oe[7],kt&192&&(Qe.pts=(Oe[9]&14)<<27|(Oe[10]&255)<<20|(Oe[11]&254)<<12|(Oe[12]&255)<<5|(Oe[13]&254)>>>3,Qe.pts*=4,Qe.pts+=(Oe[13]&6)>>>1,Qe.dts=Qe.pts,kt&64&&(Qe.dts=(Oe[14]&14)<<27|(Oe[15]&255)<<20|(Oe[16]&254)<<12|(Oe[17]&255)<<5|(Oe[18]&254)>>>3,Qe.dts*=4,Qe.dts+=(Oe[18]&6)>>>1)),Qe.data=Oe.subarray(9+Oe[8]))},Ce=function(Oe,Qe,kt){var ui=new Uint8Array(Oe.size),yi={type:Qe},si=0,qi=0,qr=!1,Li;if(!(!Oe.data.length||Oe.size<9)){for(yi.trackId=Oe.data[0].pid,si=0;si<Oe.data.length;si++)Li=Oe.data[si],ui.set(Li.data,qi),qi+=Li.data.byteLength;_e(ui,yi),qr=Qe==="video"||yi.packetLength<=Oe.size,(kt||qr)&&(Oe.size=0,Oe.data.length=0),qr&&E.trigger("data",yi)}};Gs.prototype.init.call(this),this.push=function(Ve){({pat:function(){},pes:function(){var Qe,kt;switch(Ve.streamType){case cr.H264_STREAM_TYPE:Qe=R,kt="video";break;case cr.ADTS_STREAM_TYPE:Qe=V,kt="audio";break;case cr.METADATA_STREAM_TYPE:Qe=Q,kt="timed-metadata";break;default:return}Ve.payloadUnitStartIndicator&&Ce(Qe,kt,!0),Qe.data.push(Ve),Qe.size+=Ve.data.byteLength},pmt:function(){var Qe={type:"metadata",tracks:[]};ee=Ve.programMapTable,ee.video!==null&&Qe.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+ee.video,codec:"avc",type:"video"}),ee.audio!==null&&Qe.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+ee.audio,codec:"adts",type:"audio"}),F=!0,E.trigger("data",Qe)}})[Ve.type]()},this.reset=function(){R.size=0,R.data.length=0,V.size=0,V.data.length=0,this.trigger("reset")},this.flushStreams_=function(){Ce(R,"video"),Ce(V,"audio"),Ce(Q,"timed-metadata")},this.flush=function(){if(!F&&ee){var Ve={type:"metadata",tracks:[]};ee.video!==null&&Ve.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+ee.video,codec:"avc",type:"video"}),ee.audio!==null&&Ve.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+ee.audio,codec:"adts",type:"audio"}),E.trigger("data",Ve)}F=!1,this.flushStreams_(),this.trigger("done")}},Gs.prototype=new e;var ou={PAT_PID:0,MP2T_PACKET_LENGTH:ro,TransportPacketStream:Rs,TransportParseStream:Ho,ElementaryStream:Gs,TimestampRolloverStream:Sc,CaptionStream:ta.CaptionStream,Cea608Stream:ta.Cea608Stream,Cea708Stream:ta.Cea708Stream,MetadataStream:Ah};for(var so in cr)cr.hasOwnProperty(so)&&(ou[so]=cr[so]);var Ba=ou,Ku=an.ONE_SECOND_IN_TS,lu,Ff=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];lu=function(E){var F,R=0;lu.prototype.init.call(this),this.skipWarn_=function(V,Q){this.trigger("log",{level:"warn",message:"adts skiping bytes "+V+" to "+Q+" in frame "+R+" outside syncword"})},this.push=function(V){var Q=0,ee,_e,Ce,Ve,Oe;if(E||(R=0),V.type==="audio"){F&&F.length?(Ce=F,F=new Uint8Array(Ce.byteLength+V.data.byteLength),F.set(Ce),F.set(V.data,Ce.byteLength)):F=V.data;for(var Qe;Q+7<F.length;){if(F[Q]!==255||(F[Q+1]&246)!==240){typeof Qe!="number"&&(Qe=Q),Q++;continue}if(typeof Qe=="number"&&(this.skipWarn_(Qe,Q),Qe=null),_e=(~F[Q+1]&1)*2,ee=(F[Q+3]&3)<<11|F[Q+4]<<3|(F[Q+5]&224)>>5,Ve=((F[Q+6]&3)+1)*1024,Oe=Ve*Ku/Ff[(F[Q+2]&60)>>>2],F.byteLength-Q<ee)break;this.trigger("data",{pts:V.pts+R*Oe,dts:V.dts+R*Oe,sampleCount:Ve,audioobjecttype:(F[Q+2]>>>6&3)+1,channelcount:(F[Q+2]&1)<<2|(F[Q+3]&192)>>>6,samplerate:Ff[(F[Q+2]&60)>>>2],samplingfrequencyindex:(F[Q+2]&60)>>>2,samplesize:16,data:F.subarray(Q+7+_e,Q+ee)}),R++,Q+=ee}typeof Qe=="number"&&(this.skipWarn_(Qe,Q),Qe=null),F=F.subarray(Q)}},this.flush=function(){R=0,this.trigger("done")},this.reset=function(){F=void 0,this.trigger("reset")},this.endTimeline=function(){F=void 0,this.trigger("endedtimeline")}},lu.prototype=new e;var jo=lu,uu;uu=function(E){var F=E.byteLength,R=0,V=0;this.length=function(){return 8*F},this.bitsAvailable=function(){return 8*F+V},this.loadWord=function(){var Q=E.byteLength-F,ee=new Uint8Array(4),_e=Math.min(4,F);if(_e===0)throw new Error("no bytes available");ee.set(E.subarray(Q,Q+_e)),R=new DataView(ee.buffer).getUint32(0),V=_e*8,F-=_e},this.skipBits=function(Q){var ee;V>Q?(R<<=Q,V-=Q):(Q-=V,ee=Math.floor(Q/8),Q-=ee*8,F-=ee,this.loadWord(),R<<=Q,V-=Q)},this.readBits=function(Q){var ee=Math.min(V,Q),_e=R>>>32-ee;return V-=ee,V>0?R<<=ee:F>0&&this.loadWord(),ee=Q-ee,ee>0?_e<<ee|this.readBits(ee):_e},this.skipLeadingZeros=function(){var Q;for(Q=0;Q<V;++Q)if((R&2147483648>>>Q)!==0)return R<<=Q,V-=Q,Q;return this.loadWord(),Q+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var Q=this.skipLeadingZeros();return this.readBits(Q+1)-1},this.readExpGolomb=function(){var Q=this.readUnsignedExpGolomb();return 1&Q?1+Q>>>1:-1*(Q>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var Bf=uu,Tl,fo,Na;fo=function(){var E=0,F,R;fo.prototype.init.call(this),this.push=function(V){var Q;R?(Q=new Uint8Array(R.byteLength+V.data.byteLength),Q.set(R),Q.set(V.data,R.byteLength),R=Q):R=V.data;for(var ee=R.byteLength;E<ee-3;E++)if(R[E+2]===1){F=E+5;break}for(;F<ee;)switch(R[F]){case 0:if(R[F-1]!==0){F+=2;break}else if(R[F-2]!==0){F++;break}E+3!==F-2&&this.trigger("data",R.subarray(E+3,F-2));do F++;while(R[F]!==1&&F<ee);E=F-2,F+=3;break;case 1:if(R[F-1]!==0||R[F-2]!==0){F+=3;break}this.trigger("data",R.subarray(E+3,F-2)),E=F-2,F+=3;break;default:F+=3;break}R=R.subarray(E),F-=E,E=0},this.reset=function(){R=null,E=0,this.trigger("reset")},this.flush=function(){R&&R.byteLength>3&&this.trigger("data",R.subarray(E+3)),R=null,E=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},fo.prototype=new e,Na={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},Tl=function(){var E=new fo,F,R,V,Q,ee,_e,Ce;Tl.prototype.init.call(this),F=this,this.push=function(Ve){Ve.type==="video"&&(R=Ve.trackId,V=Ve.pts,Q=Ve.dts,E.push(Ve))},E.on("data",function(Ve){var Oe={trackId:R,pts:V,dts:Q,data:Ve,nalUnitTypeCode:Ve[0]&31};switch(Oe.nalUnitTypeCode){case 5:Oe.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:Oe.nalUnitType="sei_rbsp",Oe.escapedRBSP=ee(Ve.subarray(1));break;case 7:Oe.nalUnitType="seq_parameter_set_rbsp",Oe.escapedRBSP=ee(Ve.subarray(1)),Oe.config=_e(Oe.escapedRBSP);break;case 8:Oe.nalUnitType="pic_parameter_set_rbsp";break;case 9:Oe.nalUnitType="access_unit_delimiter_rbsp";break}F.trigger("data",Oe)}),E.on("done",function(){F.trigger("done")}),E.on("partialdone",function(){F.trigger("partialdone")}),E.on("reset",function(){F.trigger("reset")}),E.on("endedtimeline",function(){F.trigger("endedtimeline")}),this.flush=function(){E.flush()},this.partialFlush=function(){E.partialFlush()},this.reset=function(){E.reset()},this.endTimeline=function(){E.endTimeline()},Ce=function(Oe,Qe){var kt=8,ui=8,yi,si;for(yi=0;yi<Oe;yi++)ui!==0&&(si=Qe.readExpGolomb(),ui=(kt+si+256)%256),kt=ui===0?kt:ui},ee=function(Oe){for(var Qe=Oe.byteLength,kt=[],ui=1,yi,si;ui<Qe-2;)Oe[ui]===0&&Oe[ui+1]===0&&Oe[ui+2]===3?(kt.push(ui+2),ui+=2):ui++;if(kt.length===0)return Oe;yi=Qe-kt.length,si=new Uint8Array(yi);var qi=0;for(ui=0;ui<yi;qi++,ui++)qi===kt[0]&&(qi++,kt.shift()),si[ui]=Oe[qi];return si},_e=function(Oe){var Qe=0,kt=0,ui=0,yi=0,si,qi,qr,Li,Ss,Mc,_u,Da,Ia,ma,xo,sr=[1,1],Ol,Fs;if(si=new Bf(Oe),qi=si.readUnsignedByte(),Li=si.readUnsignedByte(),qr=si.readUnsignedByte(),si.skipUnsignedExpGolomb(),Na[qi]&&(Ss=si.readUnsignedExpGolomb(),Ss===3&&si.skipBits(1),si.skipUnsignedExpGolomb(),si.skipUnsignedExpGolomb(),si.skipBits(1),si.readBoolean()))for(xo=Ss!==3?8:12,Fs=0;Fs<xo;Fs++)si.readBoolean()&&(Fs<6?Ce(16,si):Ce(64,si));if(si.skipUnsignedExpGolomb(),Mc=si.readUnsignedExpGolomb(),Mc===0)si.readUnsignedExpGolomb();else if(Mc===1)for(si.skipBits(1),si.skipExpGolomb(),si.skipExpGolomb(),_u=si.readUnsignedExpGolomb(),Fs=0;Fs<_u;Fs++)si.skipExpGolomb();if(si.skipUnsignedExpGolomb(),si.skipBits(1),Da=si.readUnsignedExpGolomb(),Ia=si.readUnsignedExpGolomb(),ma=si.readBits(1),ma===0&&si.skipBits(1),si.skipBits(1),si.readBoolean()&&(Qe=si.readUnsignedExpGolomb(),kt=si.readUnsignedExpGolomb(),ui=si.readUnsignedExpGolomb(),yi=si.readUnsignedExpGolomb()),si.readBoolean()&&si.readBoolean()){switch(Ol=si.readUnsignedByte(),Ol){case 1:sr=[1,1];break;case 2:sr=[12,11];break;case 3:sr=[10,11];break;case 4:sr=[16,11];break;case 5:sr=[40,33];break;case 6:sr=[24,11];break;case 7:sr=[20,11];break;case 8:sr=[32,11];break;case 9:sr=[80,33];break;case 10:sr=[18,11];break;case 11:sr=[15,11];break;case 12:sr=[64,33];break;case 13:sr=[160,99];break;case 14:sr=[4,3];break;case 15:sr=[3,2];break;case 16:sr=[2,1];break;case 255:{sr=[si.readUnsignedByte()<<8|si.readUnsignedByte(),si.readUnsignedByte()<<8|si.readUnsignedByte()];break}}sr&&sr[0]/sr[1]}return{profileIdc:qi,levelIdc:qr,profileCompatibility:Li,width:(Da+1)*16-Qe*2-kt*2,height:(2-ma)*(Ia+1)*16-ui*2-yi*2,sarRatio:sr}}},Tl.prototype=new e;var wh={H264Stream:Tl},Jn=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],cu=function(E,F){var R=E[F+6]<<21|E[F+7]<<14|E[F+8]<<7|E[F+9],V=E[F+5],Q=(V&16)>>4;return R=R>=0?R:0,Q?R+20:R+10},Ac=function le(E,F){return E.length-F<10||E[F]!==73||E[F+1]!==68||E[F+2]!==51?F:(F+=cu(E,F),le(E,F))},xl=function(E){var F=Ac(E,0);return E.length>=F+2&&(E[F]&255)===255&&(E[F+1]&240)===240&&(E[F+1]&22)===16},wc=function(E){return E[0]<<21|E[1]<<14|E[2]<<7|E[3]},Eh=function(E,F,R){var V,Q="";for(V=F;V<R;V++)Q+="%"+("00"+E[V].toString(16)).slice(-2);return Q},sd=function(E,F,R){return unescape(Eh(E,F,R))},Ch=function(E,F){var R=(E[F+5]&224)>>5,V=E[F+4]<<3,Q=E[F+3]&6144;return Q|V|R},ad=function(E,F){return E[F]===73&&E[F+1]===68&&E[F+2]===51?"timed-metadata":E[F]&!0&&(E[F+1]&240)===240?"audio":null},Sl=function(E){for(var F=0;F+5<E.length;){if(E[F]!==255||(E[F+1]&246)!==240){F++;continue}return Jn[(E[F+2]&60)>>>2]}return null},ao=function(E){var F,R,V,Q;F=10,E[5]&64&&(F+=4,F+=wc(E.subarray(10,14)));do{if(R=wc(E.subarray(F+4,F+8)),R<1)return null;if(Q=String.fromCharCode(E[F],E[F+1],E[F+2],E[F+3]),Q==="PRIV"){V=E.subarray(F+10,F+R+10);for(var ee=0;ee<V.byteLength;ee++)if(V[ee]===0){var _e=sd(V,0,ee);if(_e==="com.apple.streaming.transportStreamTimestamp"){var Ce=V.subarray(ee+1),Ve=(Ce[3]&1)<<30|Ce[4]<<22|Ce[5]<<14|Ce[6]<<6|Ce[7]>>>2;return Ve*=4,Ve+=Ce[7]&3,Ve}break}}F+=10,F+=R}while(F<E.byteLength);return null},Ua={isLikelyAacData:xl,parseId3TagSize:cu,parseAdtsSize:Ch,parseType:ad,parseSampleRate:Sl,parseAacTimestamp:ao},Al;Al=function(){var E=new Uint8Array,F=0;Al.prototype.init.call(this),this.setTimestamp=function(R){F=R},this.push=function(R){var V=0,Q=0,ee,_e,Ce,Ve;for(E.length?(Ve=E.length,E=new Uint8Array(R.byteLength+Ve),E.set(E.subarray(0,Ve)),E.set(R,Ve)):E=R;E.length-Q>=3;){if(E[Q]===73&&E[Q+1]===68&&E[Q+2]===51){if(E.length-Q<10||(V=Ua.parseId3TagSize(E,Q),Q+V>E.length))break;_e={type:"timed-metadata",data:E.subarray(Q,Q+V)},this.trigger("data",_e),Q+=V;continue}else if((E[Q]&255)===255&&(E[Q+1]&240)===240){if(E.length-Q<7||(V=Ua.parseAdtsSize(E,Q),Q+V>E.length))break;Ce={type:"audio",data:E.subarray(Q,Q+V),pts:F,dts:F},this.trigger("data",Ce),Q+=V;continue}Q++}ee=E.length-Q,ee>0?E=E.subarray(Q):E=new Uint8Array},this.reset=function(){E=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){E=new Uint8Array,this.trigger("endedtimeline")}},Al.prototype=new e;var Zu=Al,wl=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Mh=wl,Nf=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],Go=Nf,od=wh.H264Stream,Dh=Ua.isLikelyAacData,ld=an.ONE_SECOND_IN_TS,El,$o,oo,$s,Va=function(E,F){F.stream=E,this.trigger("log",F)},Cl=function(E,F){for(var R=Object.keys(F),V=0;V<R.length;V++){var Q=R[V];Q==="headOfPipeline"||!F[Q].on||F[Q].on("log",Va.bind(E,Q))}},ud=function(E,F){var R;if(E.length!==F.length)return!1;for(R=0;R<E.length;R++)if(E[R]!==F[R])return!1;return!0},Ih=function(E,F,R,V,Q,ee){var _e=R-F,Ce=V-F,Ve=Q-R;return{start:{dts:E,pts:E+_e},end:{dts:E+Ce,pts:E+Ve},prependedContentDuration:ee,baseMediaDecodeTime:E}};$o=function(E,F){var R=[],V,Q=0,ee=0,_e=1/0;F=F||{},V=F.firstSequenceNumber||0,$o.prototype.init.call(this),this.push=function(Ce){oe.collectDtsInfo(E,Ce),E&&Mh.forEach(function(Ve){E[Ve]=Ce[Ve]}),R.push(Ce)},this.setEarliestDts=function(Ce){Q=Ce},this.setVideoBaseMediaDecodeTime=function(Ce){_e=Ce},this.setAudioAppendStart=function(Ce){ee=Ce},this.flush=function(){var Ce,Ve,Oe,Qe,kt,ui,yi;if(R.length===0){this.trigger("done","AudioSegmentStream");return}Ce=Fn.trimAdtsFramesByEarliestDts(R,E,Q),E.baseMediaDecodeTime=oe.calculateTrackBaseMediaDecodeTime(E,F.keepOriginalTimestamps),yi=Fn.prefixWithSilence(E,Ce,ee,_e),E.samples=Fn.generateSampleTable(Ce),Oe=lt.mdat(Fn.concatenateFrameData(Ce)),R=[],Ve=lt.moof(V,[E]),Qe=new Uint8Array(Ve.byteLength+Oe.byteLength),V++,Qe.set(Ve),Qe.set(Oe,Ve.byteLength),oe.clearDtsInfo(E),kt=Math.ceil(ld*1024/E.samplerate),Ce.length&&(ui=Ce.length*kt,this.trigger("segmentTimingInfo",Ih(an.audioTsToVideoTs(E.baseMediaDecodeTime,E.samplerate),Ce[0].dts,Ce[0].pts,Ce[0].dts+ui,Ce[0].pts+ui,yi||0)),this.trigger("timingInfo",{start:Ce[0].pts,end:Ce[0].pts+ui})),this.trigger("data",{track:E,boxes:Qe}),this.trigger("done","AudioSegmentStream")},this.reset=function(){oe.clearDtsInfo(E),R=[],this.trigger("reset")}},$o.prototype=new e,El=function(E,F){var R,V=[],Q=[],ee,_e;F=F||{},R=F.firstSequenceNumber||0,El.prototype.init.call(this),delete E.minPTS,this.gopCache_=[],this.push=function(Ce){oe.collectDtsInfo(E,Ce),Ce.nalUnitType==="seq_parameter_set_rbsp"&&!ee&&(ee=Ce.config,E.sps=[Ce.data],Go.forEach(function(Ve){E[Ve]=ee[Ve]},this)),Ce.nalUnitType==="pic_parameter_set_rbsp"&&!_e&&(_e=Ce.data,E.pps=[Ce.data]),V.push(Ce)},this.flush=function(){for(var Ce,Ve,Oe,Qe,kt,ui,yi=0,si,qi;V.length&&V[0].nalUnitType!=="access_unit_delimiter_rbsp";)V.shift();if(V.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(Ce=yr.groupNalsIntoFrames(V),Oe=yr.groupFramesIntoGops(Ce),Oe[0][0].keyFrame||(Ve=this.getGopForFusion_(V[0],E),Ve?(yi=Ve.duration,Oe.unshift(Ve),Oe.byteLength+=Ve.byteLength,Oe.nalCount+=Ve.nalCount,Oe.pts=Ve.pts,Oe.dts=Ve.dts,Oe.duration+=Ve.duration):Oe=yr.extendFirstKeyFrame(Oe)),Q.length){var qr;if(F.alignGopsAtEnd?qr=this.alignGopsAtEnd_(Oe):qr=this.alignGopsAtStart_(Oe),!qr){this.gopCache_.unshift({gop:Oe.pop(),pps:E.pps,sps:E.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),V=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}oe.clearDtsInfo(E),Oe=qr}oe.collectDtsInfo(E,Oe),E.samples=yr.generateSampleTable(Oe),kt=lt.mdat(yr.concatenateNalData(Oe)),E.baseMediaDecodeTime=oe.calculateTrackBaseMediaDecodeTime(E,F.keepOriginalTimestamps),this.trigger("processedGopsInfo",Oe.map(function(Li){return{pts:Li.pts,dts:Li.dts,byteLength:Li.byteLength}})),si=Oe[0],qi=Oe[Oe.length-1],this.trigger("segmentTimingInfo",Ih(E.baseMediaDecodeTime,si.dts,si.pts,qi.dts+qi.duration,qi.pts+qi.duration,yi)),this.trigger("timingInfo",{start:Oe[0].pts,end:Oe[Oe.length-1].pts+Oe[Oe.length-1].duration}),this.gopCache_.unshift({gop:Oe.pop(),pps:E.pps,sps:E.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),V=[],this.trigger("baseMediaDecodeTime",E.baseMediaDecodeTime),this.trigger("timelineStartInfo",E.timelineStartInfo),Qe=lt.moof(R,[E]),ui=new Uint8Array(Qe.byteLength+kt.byteLength),R++,ui.set(Qe),ui.set(kt,Qe.byteLength),this.trigger("data",{track:E,boxes:ui}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),V=[],this.gopCache_.length=0,Q.length=0,this.trigger("reset")},this.resetStream_=function(){oe.clearDtsInfo(E),ee=void 0,_e=void 0},this.getGopForFusion_=function(Ce){var Ve=45e3,Oe=1/0,Qe,kt,ui,yi,si;for(si=0;si<this.gopCache_.length;si++)yi=this.gopCache_[si],ui=yi.gop,!(!(E.pps&&ud(E.pps[0],yi.pps[0]))||!(E.sps&&ud(E.sps[0],yi.sps[0])))&&(ui.dts<E.timelineStartInfo.dts||(Qe=Ce.dts-ui.dts-ui.duration,Qe>=-1e4&&Qe<=Ve&&(!kt||Oe>Qe)&&(kt=yi,Oe=Qe)));return kt?kt.gop:null},this.alignGopsAtStart_=function(Ce){var Ve,Oe,Qe,kt,ui,yi,si,qi;for(ui=Ce.byteLength,yi=Ce.nalCount,si=Ce.duration,Ve=Oe=0;Ve<Q.length&&Oe<Ce.length&&(Qe=Q[Ve],kt=Ce[Oe],Qe.pts!==kt.pts);){if(kt.pts>Qe.pts){Ve++;continue}Oe++,ui-=kt.byteLength,yi-=kt.nalCount,si-=kt.duration}return Oe===0?Ce:Oe===Ce.length?null:(qi=Ce.slice(Oe),qi.byteLength=ui,qi.duration=si,qi.nalCount=yi,qi.pts=qi[0].pts,qi.dts=qi[0].dts,qi)},this.alignGopsAtEnd_=function(Ce){var Ve,Oe,Qe,kt,ui,yi;for(Ve=Q.length-1,Oe=Ce.length-1,ui=null,yi=!1;Ve>=0&&Oe>=0;){if(Qe=Q[Ve],kt=Ce[Oe],Qe.pts===kt.pts){yi=!0;break}if(Qe.pts>kt.pts){Ve--;continue}Ve===Q.length-1&&(ui=Oe),Oe--}if(!yi&&ui===null)return null;var si;if(yi?si=Oe:si=ui,si===0)return Ce;var qi=Ce.slice(si),qr=qi.reduce(function(Li,Ss){return Li.byteLength+=Ss.byteLength,Li.duration+=Ss.duration,Li.nalCount+=Ss.nalCount,Li},{byteLength:0,duration:0,nalCount:0});return qi.byteLength=qr.byteLength,qi.duration=qr.duration,qi.nalCount=qr.nalCount,qi.pts=qi[0].pts,qi.dts=qi[0].dts,qi},this.alignGopsWith=function(Ce){Q=Ce}},El.prototype=new e,$s=function(E,F){this.numberOfTracks=0,this.metadataStream=F,E=E||{},typeof E.remux<"u"?this.remuxTracks=!!E.remux:this.remuxTracks=!0,typeof E.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=E.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,$s.prototype.init.call(this),this.push=function(R){if(R.text)return this.pendingCaptions.push(R);if(R.frames)return this.pendingMetadata.push(R);this.pendingTracks.push(R.track),this.pendingBytes+=R.boxes.byteLength,R.track.type==="video"&&(this.videoTrack=R.track,this.pendingBoxes.push(R.boxes)),R.track.type==="audio"&&(this.audioTrack=R.track,this.pendingBoxes.unshift(R.boxes))}},$s.prototype=new e,$s.prototype.flush=function(le){var E=0,F={captions:[],captionStreams:{},metadata:[],info:{}},R,V,Q,ee=0,_e;if(this.pendingTracks.length<this.numberOfTracks){if(le!=="VideoSegmentStream"&&le!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(ee=this.videoTrack.timelineStartInfo.pts,Go.forEach(function(Ce){F.info[Ce]=this.videoTrack[Ce]},this)):this.audioTrack&&(ee=this.audioTrack.timelineStartInfo.pts,Mh.forEach(function(Ce){F.info[Ce]=this.audioTrack[Ce]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?F.type=this.pendingTracks[0].type:F.type="combined",this.emittedTracks+=this.pendingTracks.length,Q=lt.initSegment(this.pendingTracks),F.initSegment=new Uint8Array(Q.byteLength),F.initSegment.set(Q),F.data=new Uint8Array(this.pendingBytes),_e=0;_e<this.pendingBoxes.length;_e++)F.data.set(this.pendingBoxes[_e],E),E+=this.pendingBoxes[_e].byteLength;for(_e=0;_e<this.pendingCaptions.length;_e++)R=this.pendingCaptions[_e],R.startTime=an.metadataTsToSeconds(R.startPts,ee,this.keepOriginalTimestamps),R.endTime=an.metadataTsToSeconds(R.endPts,ee,this.keepOriginalTimestamps),F.captionStreams[R.stream]=!0,F.captions.push(R);for(_e=0;_e<this.pendingMetadata.length;_e++)V=this.pendingMetadata[_e],V.cueTime=an.metadataTsToSeconds(V.pts,ee,this.keepOriginalTimestamps),F.metadata.push(V);for(F.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",F),_e=0;_e<F.captions.length;_e++)R=F.captions[_e],this.trigger("caption",R);for(_e=0;_e<F.metadata.length;_e++)V=F.metadata[_e],this.trigger("id3Frame",V)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},$s.prototype.setRemux=function(le){this.remuxTracks=le},oo=function(E){var F=this,R=!0,V,Q;oo.prototype.init.call(this),E=E||{},this.baseMediaDecodeTime=E.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var ee={};this.transmuxPipeline_=ee,ee.type="aac",ee.metadataStream=new Ba.MetadataStream,ee.aacStream=new Zu,ee.audioTimestampRolloverStream=new Ba.TimestampRolloverStream("audio"),ee.timedMetadataTimestampRolloverStream=new Ba.TimestampRolloverStream("timed-metadata"),ee.adtsStream=new jo,ee.coalesceStream=new $s(E,ee.metadataStream),ee.headOfPipeline=ee.aacStream,ee.aacStream.pipe(ee.audioTimestampRolloverStream).pipe(ee.adtsStream),ee.aacStream.pipe(ee.timedMetadataTimestampRolloverStream).pipe(ee.metadataStream).pipe(ee.coalesceStream),ee.metadataStream.on("timestamp",function(_e){ee.aacStream.setTimestamp(_e.timeStamp)}),ee.aacStream.on("data",function(_e){_e.type!=="timed-metadata"&&_e.type!=="audio"||ee.audioSegmentStream||(Q=Q||{timelineStartInfo:{baseMediaDecodeTime:F.baseMediaDecodeTime},codec:"adts",type:"audio"},ee.coalesceStream.numberOfTracks++,ee.audioSegmentStream=new $o(Q,E),ee.audioSegmentStream.on("log",F.getLogTrigger_("audioSegmentStream")),ee.audioSegmentStream.on("timingInfo",F.trigger.bind(F,"audioTimingInfo")),ee.adtsStream.pipe(ee.audioSegmentStream).pipe(ee.coalesceStream),F.trigger("trackinfo",{hasAudio:!!Q,hasVideo:!!V}))}),ee.coalesceStream.on("data",this.trigger.bind(this,"data")),ee.coalesceStream.on("done",this.trigger.bind(this,"done")),Cl(this,ee)},this.setupTsPipeline=function(){var ee={};this.transmuxPipeline_=ee,ee.type="ts",ee.metadataStream=new Ba.MetadataStream,ee.packetStream=new Ba.TransportPacketStream,ee.parseStream=new Ba.TransportParseStream,ee.elementaryStream=new Ba.ElementaryStream,ee.timestampRolloverStream=new Ba.TimestampRolloverStream,ee.adtsStream=new jo,ee.h264Stream=new od,ee.captionStream=new Ba.CaptionStream(E),ee.coalesceStream=new $s(E,ee.metadataStream),ee.headOfPipeline=ee.packetStream,ee.packetStream.pipe(ee.parseStream).pipe(ee.elementaryStream).pipe(ee.timestampRolloverStream),ee.timestampRolloverStream.pipe(ee.h264Stream),ee.timestampRolloverStream.pipe(ee.adtsStream),ee.timestampRolloverStream.pipe(ee.metadataStream).pipe(ee.coalesceStream),ee.h264Stream.pipe(ee.captionStream).pipe(ee.coalesceStream),ee.elementaryStream.on("data",function(_e){var Ce;if(_e.type==="metadata"){for(Ce=_e.tracks.length;Ce--;)!V&&_e.tracks[Ce].type==="video"?(V=_e.tracks[Ce],V.timelineStartInfo.baseMediaDecodeTime=F.baseMediaDecodeTime):!Q&&_e.tracks[Ce].type==="audio"&&(Q=_e.tracks[Ce],Q.timelineStartInfo.baseMediaDecodeTime=F.baseMediaDecodeTime);V&&!ee.videoSegmentStream&&(ee.coalesceStream.numberOfTracks++,ee.videoSegmentStream=new El(V,E),ee.videoSegmentStream.on("log",F.getLogTrigger_("videoSegmentStream")),ee.videoSegmentStream.on("timelineStartInfo",function(Ve){Q&&!E.keepOriginalTimestamps&&(Q.timelineStartInfo=Ve,ee.audioSegmentStream.setEarliestDts(Ve.dts-F.baseMediaDecodeTime))}),ee.videoSegmentStream.on("processedGopsInfo",F.trigger.bind(F,"gopInfo")),ee.videoSegmentStream.on("segmentTimingInfo",F.trigger.bind(F,"videoSegmentTimingInfo")),ee.videoSegmentStream.on("baseMediaDecodeTime",function(Ve){Q&&ee.audioSegmentStream.setVideoBaseMediaDecodeTime(Ve)}),ee.videoSegmentStream.on("timingInfo",F.trigger.bind(F,"videoTimingInfo")),ee.h264Stream.pipe(ee.videoSegmentStream).pipe(ee.coalesceStream)),Q&&!ee.audioSegmentStream&&(ee.coalesceStream.numberOfTracks++,ee.audioSegmentStream=new $o(Q,E),ee.audioSegmentStream.on("log",F.getLogTrigger_("audioSegmentStream")),ee.audioSegmentStream.on("timingInfo",F.trigger.bind(F,"audioTimingInfo")),ee.audioSegmentStream.on("segmentTimingInfo",F.trigger.bind(F,"audioSegmentTimingInfo")),ee.adtsStream.pipe(ee.audioSegmentStream).pipe(ee.coalesceStream)),F.trigger("trackinfo",{hasAudio:!!Q,hasVideo:!!V})}}),ee.coalesceStream.on("data",this.trigger.bind(this,"data")),ee.coalesceStream.on("id3Frame",function(_e){_e.dispatchType=ee.metadataStream.dispatchType,F.trigger("id3Frame",_e)}),ee.coalesceStream.on("caption",this.trigger.bind(this,"caption")),ee.coalesceStream.on("done",this.trigger.bind(this,"done")),Cl(this,ee)},this.setBaseMediaDecodeTime=function(ee){var _e=this.transmuxPipeline_;E.keepOriginalTimestamps||(this.baseMediaDecodeTime=ee),Q&&(Q.timelineStartInfo.dts=void 0,Q.timelineStartInfo.pts=void 0,oe.clearDtsInfo(Q),_e.audioTimestampRolloverStream&&_e.audioTimestampRolloverStream.discontinuity()),V&&(_e.videoSegmentStream&&(_e.videoSegmentStream.gopCache_=[]),V.timelineStartInfo.dts=void 0,V.timelineStartInfo.pts=void 0,oe.clearDtsInfo(V),_e.captionStream.reset()),_e.timestampRolloverStream&&_e.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(ee){Q&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(ee)},this.setRemux=function(ee){var _e=this.transmuxPipeline_;E.remux=ee,_e&&_e.coalesceStream&&_e.coalesceStream.setRemux(ee)},this.alignGopsWith=function(ee){V&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(ee)},this.getLogTrigger_=function(ee){var _e=this;return function(Ce){Ce.stream=ee,_e.trigger("log",Ce)}},this.push=function(ee){if(R){var _e=Dh(ee);_e&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!_e&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),R=!1}this.transmuxPipeline_.headOfPipeline.push(ee)},this.flush=function(){R=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},oo.prototype=new e;var Ph={Transmuxer:oo},Ml=function(E){return E>>>0},cd=function(E){return("00"+E.toString(16)).slice(-2)},du={toUnsigned:Ml,toHexString:cd},Dl=function(E){var F="";return F+=String.fromCharCode(E[0]),F+=String.fromCharCode(E[1]),F+=String.fromCharCode(E[2]),F+=String.fromCharCode(E[3]),F},po=Dl,hu=du.toUnsigned,Uf=function le(E,F){var R=[],V,Q,ee,_e,Ce;if(!F.length)return null;for(V=0;V<E.byteLength;)Q=hu(E[V]<<24|E[V+1]<<16|E[V+2]<<8|E[V+3]),ee=po(E.subarray(V+4,V+8)),_e=Q>1?V+Q:E.byteLength,ee===F[0]&&(F.length===1?R.push(E.subarray(V+8,_e)):(Ce=le(E.subarray(V+8,_e),F.slice(1)),Ce.length&&(R=R.concat(Ce)))),V=_e;return R},_r=Uf,dd=du.toUnsigned,Vf=n.getUint64,Ts=function(E){var F={version:E[0],flags:new Uint8Array(E.subarray(1,4))};return F.version===1?F.baseMediaDecodeTime=Vf(E.subarray(4)):F.baseMediaDecodeTime=dd(E[4]<<24|E[5]<<16|E[6]<<8|E[7]),F},mo=Ts,Wo=function(E){return{isLeading:(E[0]&12)>>>2,dependsOn:E[0]&3,isDependedOn:(E[1]&192)>>>6,hasRedundancy:(E[1]&48)>>>4,paddingValue:(E[1]&14)>>>1,isNonSyncSample:E[1]&1,degradationPriority:E[2]<<8|E[3]}},go=Wo,fu=function(E){var F={version:E[0],flags:new Uint8Array(E.subarray(1,4)),samples:[]},R=new DataView(E.buffer,E.byteOffset,E.byteLength),V=F.flags[2]&1,Q=F.flags[2]&4,ee=F.flags[1]&1,_e=F.flags[1]&2,Ce=F.flags[1]&4,Ve=F.flags[1]&8,Oe=R.getUint32(4),Qe=8,kt;for(V&&(F.dataOffset=R.getInt32(Qe),Qe+=4),Q&&Oe&&(kt={flags:go(E.subarray(Qe,Qe+4))},Qe+=4,ee&&(kt.duration=R.getUint32(Qe),Qe+=4),_e&&(kt.size=R.getUint32(Qe),Qe+=4),Ve&&(F.version===1?kt.compositionTimeOffset=R.getInt32(Qe):kt.compositionTimeOffset=R.getUint32(Qe),Qe+=4),F.samples.push(kt),Oe--);Oe--;)kt={},ee&&(kt.duration=R.getUint32(Qe),Qe+=4),_e&&(kt.size=R.getUint32(Qe),Qe+=4),Ce&&(kt.flags=go(E.subarray(Qe,Qe+4)),Qe+=4),Ve&&(F.version===1?kt.compositionTimeOffset=R.getInt32(Qe):kt.compositionTimeOffset=R.getUint32(Qe),Qe+=4),F.samples.push(kt);return F},xs=fu,za=function(E){var F=new DataView(E.buffer,E.byteOffset,E.byteLength),R={version:E[0],flags:new Uint8Array(E.subarray(1,4)),trackId:F.getUint32(4)},V=R.flags[2]&1,Q=R.flags[2]&2,ee=R.flags[2]&8,_e=R.flags[2]&16,Ce=R.flags[2]&32,Ve=R.flags[0]&65536,Oe=R.flags[0]&131072,Qe;return Qe=8,V&&(Qe+=4,R.baseDataOffset=F.getUint32(12),Qe+=4),Q&&(R.sampleDescriptionIndex=F.getUint32(Qe),Qe+=4),ee&&(R.defaultSampleDuration=F.getUint32(Qe),Qe+=4),_e&&(R.defaultSampleSize=F.getUint32(Qe),Qe+=4),Ce&&(R.defaultSampleFlags=F.getUint32(Qe)),Ve&&(R.durationIsEmpty=!0),!V&&Oe&&(R.baseDataOffsetIsMoof=!0),R},ks=za,$r=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},qo;typeof window<"u"?qo=window:typeof $r<"u"?qo=$r:typeof self<"u"?qo=self:qo={};var Gi=qo,At=Kr.discardEmulationPreventionBytes,Os=ta.CaptionStream,Xo=function(E,F){for(var R=E,V=0;V<F.length;V++){var Q=F[V];if(R<Q.size)return Q;R-=Q.size}return null},pu=function(E,F,R){var V=new DataView(E.buffer,E.byteOffset,E.byteLength),Q={logs:[],seiNals:[]},ee,_e,Ce,Ve;for(_e=0;_e+4<E.length;_e+=Ce)if(Ce=V.getUint32(_e),_e+=4,!(Ce<=0))switch(E[_e]&31){case 6:var Oe=E.subarray(_e+1,_e+1+Ce),Qe=Xo(_e,F);if(ee={nalUnitType:"sei_rbsp",size:Ce,data:Oe,escapedRBSP:At(Oe),trackId:R},Qe)ee.pts=Qe.pts,ee.dts=Qe.dts,Ve=Qe;else if(Ve)ee.pts=Ve.pts,ee.dts=Ve.dts;else{Q.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+_e+" for trackId "+R+". See mux.js#223."});break}Q.seiNals.push(ee);break}return Q},hd=function(E,F,R){var V=F,Q=R.defaultSampleDuration||0,ee=R.defaultSampleSize||0,_e=R.trackId,Ce=[];return E.forEach(function(Ve){var Oe=xs(Ve),Qe=Oe.samples;Qe.forEach(function(kt){kt.duration===void 0&&(kt.duration=Q),kt.size===void 0&&(kt.size=ee),kt.trackId=_e,kt.dts=V,kt.compositionTimeOffset===void 0&&(kt.compositionTimeOffset=0),typeof V=="bigint"?(kt.pts=V+Gi.BigInt(kt.compositionTimeOffset),V+=Gi.BigInt(kt.duration)):(kt.pts=V+kt.compositionTimeOffset,V+=kt.duration)}),Ce=Ce.concat(Qe)}),Ce},dr=function(E,F){var R=_r(E,["moof","traf"]),V=_r(E,["mdat"]),Q={},ee=[];return V.forEach(function(_e,Ce){var Ve=R[Ce];ee.push({mdat:_e,traf:Ve})}),ee.forEach(function(_e){var Ce=_e.mdat,Ve=_e.traf,Oe=_r(Ve,["tfhd"]),Qe=ks(Oe[0]),kt=Qe.trackId,ui=_r(Ve,["tfdt"]),yi=ui.length>0?mo(ui[0]).baseMediaDecodeTime:0,si=_r(Ve,["trun"]),qi,qr;F===kt&&si.length>0&&(qi=hd(si,yi,Qe),qr=pu(Ce,qi,kt),Q[kt]||(Q[kt]={seiNals:[],logs:[]}),Q[kt].seiNals=Q[kt].seiNals.concat(qr.seiNals),Q[kt].logs=Q[kt].logs.concat(qr.logs))}),Q},Ju=function(E,F,R){var V;if(F===null)return null;V=dr(E,F);var Q=V[F]||{};return{seiNals:Q.seiNals,logs:Q.logs,timescale:R}},Yn=function(){var E=!1,F,R,V,Q,ee,_e;this.isInitialized=function(){return E},this.init=function(Ce){F=new Os,E=!0,_e=Ce?Ce.isPartial:!1,F.on("data",function(Ve){Ve.startTime=Ve.startPts/Q,Ve.endTime=Ve.endPts/Q,ee.captions.push(Ve),ee.captionStreams[Ve.stream]=!0}),F.on("log",function(Ve){ee.logs.push(Ve)})},this.isNewInit=function(Ce,Ve){return Ce&&Ce.length===0||Ve&&typeof Ve=="object"&&Object.keys(Ve).length===0?!1:V!==Ce[0]||Q!==Ve[V]},this.parse=function(Ce,Ve,Oe){var Qe;if(this.isInitialized()){if(!Ve||!Oe)return null;if(this.isNewInit(Ve,Oe))V=Ve[0],Q=Oe[V];else if(V===null||!Q)return R.push(Ce),null}else return null;for(;R.length>0;){var kt=R.shift();this.parse(kt,Ve,Oe)}return Qe=Ju(Ce,V,Q),Qe&&Qe.logs&&(ee.logs=ee.logs.concat(Qe.logs)),Qe===null||!Qe.seiNals?ee.logs.length?{logs:ee.logs,captions:[],captionStreams:[]}:null:(this.pushNals(Qe.seiNals),this.flushStream(),ee)},this.pushNals=function(Ce){if(!this.isInitialized()||!Ce||Ce.length===0)return null;Ce.forEach(function(Ve){F.push(Ve)})},this.flushStream=function(){if(!this.isInitialized())return null;_e?F.partialFlush():F.flush()},this.clearParsedCaptions=function(){ee.captions=[],ee.captionStreams={},ee.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;F.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){R=[],V=null,Q=null,ee?this.clearParsedCaptions():ee={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},ec=Yn,Wr=du.toUnsigned,Be=du.toHexString,fd=n.getUint64,Lh,vo,pd,Ea,tc,mu;Lh=function(E){var F={},R=_r(E,["moov","trak"]);return R.reduce(function(V,Q){var ee,_e,Ce,Ve,Oe;return ee=_r(Q,["tkhd"])[0],!ee||(_e=ee[0],Ce=_e===0?12:20,Ve=Wr(ee[Ce]<<24|ee[Ce+1]<<16|ee[Ce+2]<<8|ee[Ce+3]),Oe=_r(Q,["mdia","mdhd"])[0],!Oe)?null:(_e=Oe[0],Ce=_e===0?12:20,V[Ve]=Wr(Oe[Ce]<<24|Oe[Ce+1]<<16|Oe[Ce+2]<<8|Oe[Ce+3]),V)},F)},vo=function(E,F){var R;R=_r(F,["moof","traf"]);var V=R.reduce(function(Q,ee){var _e=_r(ee,["tfhd"])[0],Ce=Wr(_e[4]<<24|_e[5]<<16|_e[6]<<8|_e[7]),Ve=E[Ce]||9e4,Oe=_r(ee,["tfdt"])[0],Qe=new DataView(Oe.buffer,Oe.byteOffset,Oe.byteLength),kt;Oe[0]===1?kt=fd(Oe.subarray(4,12)):kt=Qe.getUint32(4);var ui;return typeof kt=="bigint"?ui=kt/Gi.BigInt(Ve):typeof kt=="number"&&!isNaN(kt)&&(ui=kt/Ve),ui<Number.MAX_SAFE_INTEGER&&(ui=Number(ui)),ui<Q&&(Q=ui),Q},1/0);return typeof V=="bigint"||isFinite(V)?V:0},pd=function(E,F){var R=_r(F,["moof","traf"]),V=0,Q=0,ee;if(R&&R.length){var _e=_r(R[0],["tfhd"])[0],Ce=_r(R[0],["trun"])[0],Ve=_r(R[0],["tfdt"])[0];if(_e){var Oe=ks(_e);ee=Oe.trackId}if(Ve){var Qe=mo(Ve);V=Qe.baseMediaDecodeTime}if(Ce){var kt=xs(Ce);kt.samples&&kt.samples.length&&(Q=kt.samples[0].compositionTimeOffset||0)}}var ui=E[ee]||9e4;typeof V=="bigint"&&(Q=Gi.BigInt(Q),ui=Gi.BigInt(ui));var yi=(V+Q)/ui;return typeof yi=="bigint"&&yi<Number.MAX_SAFE_INTEGER&&(yi=Number(yi)),yi},Ea=function(E){var F=_r(E,["moov","trak"]),R=[];return F.forEach(function(V){var Q=_r(V,["mdia","hdlr"]),ee=_r(V,["tkhd"]);Q.forEach(function(_e,Ce){var Ve=po(_e.subarray(8,12)),Oe=ee[Ce],Qe,kt,ui;Ve==="vide"&&(Qe=new DataView(Oe.buffer,Oe.byteOffset,Oe.byteLength),kt=Qe.getUint8(0),ui=kt===0?Qe.getUint32(12):Qe.getUint32(20),R.push(ui))})}),R},mu=function(E){var F=E[0],R=F===0?12:20;return Wr(E[R]<<24|E[R+1]<<16|E[R+2]<<8|E[R+3])},tc=function(E){var F=_r(E,["moov","trak"]),R=[];return F.forEach(function(V){var Q={},ee=_r(V,["tkhd"])[0],_e,Ce;ee&&(_e=new DataView(ee.buffer,ee.byteOffset,ee.byteLength),Ce=_e.getUint8(0),Q.id=Ce===0?_e.getUint32(12):_e.getUint32(20));var Ve=_r(V,["mdia","hdlr"])[0];if(Ve){var Oe=po(Ve.subarray(8,12));Oe==="vide"?Q.type="video":Oe==="soun"?Q.type="audio":Q.type=Oe}var Qe=_r(V,["mdia","minf","stbl","stsd"])[0];if(Qe){var kt=Qe.subarray(8);Q.codec=po(kt.subarray(4,8));var ui=_r(kt,[Q.codec])[0],yi,si;ui&&(/^[asm]vc[1-9]$/i.test(Q.codec)?(yi=ui.subarray(78),si=po(yi.subarray(4,8)),si==="avcC"&&yi.length>11?(Q.codec+=".",Q.codec+=Be(yi[9]),Q.codec+=Be(yi[10]),Q.codec+=Be(yi[11])):Q.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(Q.codec)?(yi=ui.subarray(28),si=po(yi.subarray(4,8)),si==="esds"&&yi.length>20&&yi[19]!==0?(Q.codec+="."+Be(yi[19]),Q.codec+="."+Be(yi[20]>>>2&63).replace(/^0/,"")):Q.codec="mp4a.40.2"):Q.codec=Q.codec.toLowerCase())}var qi=_r(V,["mdia","mdhd"])[0];qi&&(Q.timescale=mu(qi)),R.push(Q)}),R};var gu={findBox:_r,parseType:po,timescale:Lh,startTime:vo,compositionStartTime:pd,videoTrackIds:Ea,tracks:tc,getTimescaleFromMediaHeader:mu},vu=function(E){var F=E[1]&31;return F<<=8,F|=E[2],F},yo=function(E){return!!(E[1]&64)},Ca=function(E){var F=0;return(E[3]&48)>>>4>1&&(F+=E[4]+1),F},Il=function(E,F){var R=vu(E);return R===0?"pat":R===F?"pmt":F?"pes":null},yu=function(E){var F=yo(E),R=4+Ca(E);return F&&(R+=E[R]+1),(E[R+10]&31)<<8|E[R+11]},Ec=function(E){var F={},R=yo(E),V=4+Ca(E);if(R&&(V+=E[V]+1),!!(E[V+5]&1)){var Q,ee,_e;Q=(E[V+1]&15)<<8|E[V+2],ee=3+Q-4,_e=(E[V+10]&15)<<8|E[V+11];for(var Ce=12+_e;Ce<ee;){var Ve=V+Ce;F[(E[Ve+1]&31)<<8|E[Ve+2]]=E[Ve],Ce+=((E[Ve+3]&15)<<8|E[Ve+4])+5}return F}},Pl=function(E,F){var R=vu(E),V=F[R];switch(V){case cr.H264_STREAM_TYPE:return"video";case cr.ADTS_STREAM_TYPE:return"audio";case cr.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},Ll=function(E){var F=yo(E);if(!F)return null;var R=4+Ca(E);if(R>=E.byteLength)return null;var V=null,Q;return Q=E[R+7],Q&192&&(V={},V.pts=(E[R+9]&14)<<27|(E[R+10]&255)<<20|(E[R+11]&254)<<12|(E[R+12]&255)<<5|(E[R+13]&254)>>>3,V.pts*=4,V.pts+=(E[R+13]&6)>>>1,V.dts=V.pts,Q&64&&(V.dts=(E[R+14]&14)<<27|(E[R+15]&255)<<20|(E[R+16]&254)<<12|(E[R+17]&255)<<5|(E[R+18]&254)>>>3,V.dts*=4,V.dts+=(E[R+18]&6)>>>1)),V},_o=function(E){switch(E){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},zf=function(E){for(var F=4+Ca(E),R=E.subarray(F),V=0,Q=0,ee=!1,_e;Q<R.byteLength-3;Q++)if(R[Q+2]===1){V=Q+5;break}for(;V<R.byteLength;)switch(R[V]){case 0:if(R[V-1]!==0){V+=2;break}else if(R[V-2]!==0){V++;break}Q+3!==V-2&&(_e=_o(R[Q+3]&31),_e==="slice_layer_without_partitioning_rbsp_idr"&&(ee=!0));do V++;while(R[V]!==1&&V<R.length);Q=V-2,V+=3;break;case 1:if(R[V-1]!==0||R[V-2]!==0){V+=3;break}_e=_o(R[Q+3]&31),_e==="slice_layer_without_partitioning_rbsp_idr"&&(ee=!0),Q=V-2,V+=3;break;default:V+=3;break}return R=R.subarray(Q),V-=Q,Q=0,R&&R.byteLength>3&&(_e=_o(R[Q+3]&31),_e==="slice_layer_without_partitioning_rbsp_idr"&&(ee=!0)),ee},Rl={parseType:Il,parsePat:yu,parsePmt:Ec,parsePayloadUnitStartIndicator:yo,parsePesType:Pl,parsePesTime:Ll,videoPacketContainsKeyFrame:zf},Ws=Of.handleRollover,er={};er.ts=Rl,er.aac=Ua;var Ha=an.ONE_SECOND_IN_TS,br=188,Ma=71,md=function(E,F){for(var R=0,V=br,Q,ee;V<E.byteLength;){if(E[R]===Ma&&E[V]===Ma){switch(Q=E.subarray(R,V),ee=er.ts.parseType(Q,F.pid),ee){case"pat":F.pid=er.ts.parsePat(Q);break;case"pmt":var _e=er.ts.parsePmt(Q);F.table=F.table||{},Object.keys(_e).forEach(function(Ce){F.table[Ce]=_e[Ce]});break}R+=br,V+=br;continue}R++,V++}},gd=function(E,F,R){for(var V=0,Q=br,ee,_e,Ce,Ve,Oe,Qe=!1;Q<=E.byteLength;){if(E[V]===Ma&&(E[Q]===Ma||Q===E.byteLength)){switch(ee=E.subarray(V,Q),_e=er.ts.parseType(ee,F.pid),_e){case"pes":Ce=er.ts.parsePesType(ee,F.table),Ve=er.ts.parsePayloadUnitStartIndicator(ee),Ce==="audio"&&Ve&&(Oe=er.ts.parsePesTime(ee),Oe&&(Oe.type="audio",R.audio.push(Oe),Qe=!0));break}if(Qe)break;V+=br,Q+=br;continue}V++,Q++}for(Q=E.byteLength,V=Q-br,Qe=!1;V>=0;){if(E[V]===Ma&&(E[Q]===Ma||Q===E.byteLength)){switch(ee=E.subarray(V,Q),_e=er.ts.parseType(ee,F.pid),_e){case"pes":Ce=er.ts.parsePesType(ee,F.table),Ve=er.ts.parsePayloadUnitStartIndicator(ee),Ce==="audio"&&Ve&&(Oe=er.ts.parsePesTime(ee),Oe&&(Oe.type="audio",R.audio.push(Oe),Qe=!0));break}if(Qe)break;V-=br,Q-=br;continue}V--,Q--}},Yo=function(E,F,R){for(var V=0,Q=br,ee,_e,Ce,Ve,Oe,Qe,kt,ui,yi=!1,si={data:[],size:0};Q<E.byteLength;){if(E[V]===Ma&&E[Q]===Ma){switch(ee=E.subarray(V,Q),_e=er.ts.parseType(ee,F.pid),_e){case"pes":if(Ce=er.ts.parsePesType(ee,F.table),Ve=er.ts.parsePayloadUnitStartIndicator(ee),Ce==="video"&&(Ve&&!yi&&(Oe=er.ts.parsePesTime(ee),Oe&&(Oe.type="video",R.video.push(Oe),yi=!0)),!R.firstKeyFrame)){if(Ve&&si.size!==0){for(Qe=new Uint8Array(si.size),kt=0;si.data.length;)ui=si.data.shift(),Qe.set(ui,kt),kt+=ui.byteLength;if(er.ts.videoPacketContainsKeyFrame(Qe)){var qi=er.ts.parsePesTime(Qe);qi?(R.firstKeyFrame=qi,R.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}si.size=0}si.data.push(ee),si.size+=ee.byteLength}break}if(yi&&R.firstKeyFrame)break;V+=br,Q+=br;continue}V++,Q++}for(Q=E.byteLength,V=Q-br,yi=!1;V>=0;){if(E[V]===Ma&&E[Q]===Ma){switch(ee=E.subarray(V,Q),_e=er.ts.parseType(ee,F.pid),_e){case"pes":Ce=er.ts.parsePesType(ee,F.table),Ve=er.ts.parsePayloadUnitStartIndicator(ee),Ce==="video"&&Ve&&(Oe=er.ts.parsePesTime(ee),Oe&&(Oe.type="video",R.video.push(Oe),yi=!0));break}if(yi)break;V-=br,Q-=br;continue}V--,Q--}},fn=function(E,F){if(E.audio&&E.audio.length){var R=F;(typeof R>"u"||isNaN(R))&&(R=E.audio[0].dts),E.audio.forEach(function(ee){ee.dts=Ws(ee.dts,R),ee.pts=Ws(ee.pts,R),ee.dtsTime=ee.dts/Ha,ee.ptsTime=ee.pts/Ha})}if(E.video&&E.video.length){var V=F;if((typeof V>"u"||isNaN(V))&&(V=E.video[0].dts),E.video.forEach(function(ee){ee.dts=Ws(ee.dts,V),ee.pts=Ws(ee.pts,V),ee.dtsTime=ee.dts/Ha,ee.ptsTime=ee.pts/Ha}),E.firstKeyFrame){var Q=E.firstKeyFrame;Q.dts=Ws(Q.dts,V),Q.pts=Ws(Q.pts,V),Q.dtsTime=Q.dts/Ha,Q.ptsTime=Q.pts/Ha}}},bo=function(E){for(var F=!1,R=0,V=null,Q=null,ee=0,_e=0,Ce;E.length-_e>=3;){var Ve=er.aac.parseType(E,_e);switch(Ve){case"timed-metadata":if(E.length-_e<10){F=!0;break}if(ee=er.aac.parseId3TagSize(E,_e),ee>E.length){F=!0;break}Q===null&&(Ce=E.subarray(_e,_e+ee),Q=er.aac.parseAacTimestamp(Ce)),_e+=ee;break;case"audio":if(E.length-_e<7){F=!0;break}if(ee=er.aac.parseAdtsSize(E,_e),ee>E.length){F=!0;break}V===null&&(Ce=E.subarray(_e,_e+ee),V=er.aac.parseSampleRate(Ce)),R++,_e+=ee;break;default:_e++;break}if(F)return null}if(V===null||Q===null)return null;var Oe=Ha/V,Qe={audio:[{type:"audio",dts:Q,pts:Q},{type:"audio",dts:Q+R*1024*Oe,pts:Q+R*1024*Oe}]};return Qe},ia=function(E){var F={pid:null,table:null},R={};md(E,F);for(var V in F.table)if(F.table.hasOwnProperty(V)){var Q=F.table[V];switch(Q){case cr.H264_STREAM_TYPE:R.video=[],Yo(E,F,R),R.video.length===0&&delete R.video;break;case cr.ADTS_STREAM_TYPE:R.audio=[],gd(E,F,R),R.audio.length===0&&delete R.audio;break}}return R},Vp=function(E,F){var R=er.aac.isLikelyAacData(E),V;return R?V=bo(E):V=ia(E),!V||!V.audio&&!V.video?null:(fn(V,F),V)},Cc={inspect:Vp,parseAudioPes_:gd},kl=function(E,F){F.on("data",function(R){var V=R.initSegment;R.initSegment={data:V.buffer,byteOffset:V.byteOffset,byteLength:V.byteLength};var Q=R.data;R.data=Q.buffer,E.postMessage({action:"data",segment:R,byteOffset:Q.byteOffset,byteLength:Q.byteLength},[R.data])}),F.on("done",function(R){E.postMessage({action:"done"})}),F.on("gopInfo",function(R){E.postMessage({action:"gopInfo",gopInfo:R})}),F.on("videoSegmentTimingInfo",function(R){var V={start:{decode:an.videoTsToSeconds(R.start.dts),presentation:an.videoTsToSeconds(R.start.pts)},end:{decode:an.videoTsToSeconds(R.end.dts),presentation:an.videoTsToSeconds(R.end.pts)},baseMediaDecodeTime:an.videoTsToSeconds(R.baseMediaDecodeTime)};R.prependedContentDuration&&(V.prependedContentDuration=an.videoTsToSeconds(R.prependedContentDuration)),E.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:V})}),F.on("audioSegmentTimingInfo",function(R){var V={start:{decode:an.videoTsToSeconds(R.start.dts),presentation:an.videoTsToSeconds(R.start.pts)},end:{decode:an.videoTsToSeconds(R.end.dts),presentation:an.videoTsToSeconds(R.end.pts)},baseMediaDecodeTime:an.videoTsToSeconds(R.baseMediaDecodeTime)};R.prependedContentDuration&&(V.prependedContentDuration=an.videoTsToSeconds(R.prependedContentDuration)),E.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:V})}),F.on("id3Frame",function(R){E.postMessage({action:"id3Frame",id3Frame:R})}),F.on("caption",function(R){E.postMessage({action:"caption",caption:R})}),F.on("trackinfo",function(R){E.postMessage({action:"trackinfo",trackInfo:R})}),F.on("audioTimingInfo",function(R){E.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:an.videoTsToSeconds(R.start),end:an.videoTsToSeconds(R.end)}})}),F.on("videoTimingInfo",function(R){E.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:an.videoTsToSeconds(R.start),end:an.videoTsToSeconds(R.end)}})}),F.on("log",function(R){E.postMessage({action:"log",log:R})})},To=function(){function le(F,R){this.options=R||{},this.self=F,this.init()}var E=le.prototype;return E.init=function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new Ph.Transmuxer(this.options),kl(this.self,this.transmuxer)},E.pushMp4Captions=function(R){this.captionParser||(this.captionParser=new ec,this.captionParser.init());var V=new Uint8Array(R.data,R.byteOffset,R.byteLength),Q=this.captionParser.parse(V,R.trackIds,R.timescales);this.self.postMessage({action:"mp4Captions",captions:Q&&Q.captions||[],logs:Q&&Q.logs||[],data:V.buffer},[V.buffer])},E.probeMp4StartTime=function(R){var V=R.timescales,Q=R.data,ee=gu.startTime(V,Q);this.self.postMessage({action:"probeMp4StartTime",startTime:ee,data:Q},[Q.buffer])},E.probeMp4Tracks=function(R){var V=R.data,Q=gu.tracks(V);this.self.postMessage({action:"probeMp4Tracks",tracks:Q,data:V},[V.buffer])},E.probeTs=function(R){var V=R.data,Q=R.baseStartTime,ee=typeof Q=="number"&&!isNaN(Q)?Q*an.ONE_SECOND_IN_TS:void 0,_e=Cc.inspect(V,ee),Ce=null;_e&&(Ce={hasVideo:_e.video&&_e.video.length===2||!1,hasAudio:_e.audio&&_e.audio.length===2||!1},Ce.hasVideo&&(Ce.videoStart=_e.video[0].ptsTime),Ce.hasAudio&&(Ce.audioStart=_e.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:Ce,data:V},[V.buffer])},E.clearAllMp4Captions=function(){this.captionParser&&this.captionParser.clearAllCaptions()},E.clearParsedMp4Captions=function(){this.captionParser&&this.captionParser.clearParsedCaptions()},E.push=function(R){var V=new Uint8Array(R.data,R.byteOffset,R.byteLength);this.transmuxer.push(V)},E.reset=function(){this.transmuxer.reset()},E.setTimestampOffset=function(R){var V=R.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(an.secondsToVideoTs(V)))},E.setAudioAppendStart=function(R){this.transmuxer.setAudioAppendStart(Math.ceil(an.secondsToVideoTs(R.appendStart)))},E.setRemux=function(R){this.transmuxer.setRemux(R.remux)},E.flush=function(R){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})},E.endTimeline=function(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})},E.alignGopsWith=function(R){this.transmuxer.alignGopsWith(R.gopsToAlignWith.slice())},le}();self.onmessage=function(le){if(le.data.action==="init"&&le.data.options){this.messageHandlers=new To(self,le.data.options);return}this.messageHandlers||(this.messageHandlers=new To(self)),le.data&&le.data.action&&le.data.action!=="init"&&this.messageHandlers[le.data.action]&&this.messageHandlers[le.data.action](le.data)}})),Iq=bB(Dq),Pq=function(e,t,i){var n=e.data.segment,s=n.type,a=n.initSegment,c=n.captions,h=n.captionStreams,m=n.metadata,v=n.videoFrameDtsTime,b=n.videoFramePtsTime;t.buffer.push({captions:c,captionStreams:h,metadata:m});var x=e.data.segment.boxes||{data:e.data.segment.data},C={type:s,data:new Uint8Array(x.data,x.data.byteOffset,x.data.byteLength),initSegment:new Uint8Array(a.data,a.byteOffset,a.byteLength)};typeof v<"u"&&(C.videoFrameDtsTime=v),typeof b<"u"&&(C.videoFramePtsTime=b),i(C)},Lq=function(e){var t=e.transmuxedData,i=e.callback;t.buffer=[],i(t)},Rq=function(e,t){t.gopInfo=e.data.gopInfo},SB=function(e){var t=e.transmuxer,i=e.bytes,n=e.audioAppendStart,s=e.gopsToAlignWith,a=e.remux,c=e.onData,h=e.onTrackInfo,m=e.onAudioTimingInfo,v=e.onVideoTimingInfo,b=e.onVideoSegmentTimingInfo,x=e.onAudioSegmentTimingInfo,C=e.onId3,B=e.onCaptions,P=e.onDone,N=e.onEndedTimeline,ae=e.onTransmuxerLog,X=e.isEndOfTimeline,de={buffer:[]},ge=X,ue=function(ie){t.currentTransmux===e&&(ie.data.action==="data"&&Pq(ie,de,c),ie.data.action==="trackinfo"&&h(ie.data.trackInfo),ie.data.action==="gopInfo"&&Rq(ie,de),ie.data.action==="audioTimingInfo"&&m(ie.data.audioTimingInfo),ie.data.action==="videoTimingInfo"&&v(ie.data.videoTimingInfo),ie.data.action==="videoSegmentTimingInfo"&&b(ie.data.videoSegmentTimingInfo),ie.data.action==="audioSegmentTimingInfo"&&x(ie.data.audioSegmentTimingInfo),ie.data.action==="id3Frame"&&C([ie.data.id3Frame],ie.data.id3Frame.dispatchType),ie.data.action==="caption"&&B(ie.data.caption),ie.data.action==="endedtimeline"&&(ge=!1,N()),ie.data.action==="log"&&ae(ie.data.log),ie.data.type==="transmuxed"&&(ge||(t.onmessage=null,Lq({transmuxedData:de,callback:P}),AB(t))))};if(t.onmessage=ue,n&&t.postMessage({action:"setAudioAppendStart",appendStart:n}),Array.isArray(s)&&t.postMessage({action:"alignGopsWith",gopsToAlignWith:s}),typeof a<"u"&&t.postMessage({action:"setRemux",remux:a}),i.byteLength){var be=i instanceof ArrayBuffer?i:i.buffer,fe=i instanceof ArrayBuffer?0:i.byteOffset;t.postMessage({action:"push",data:be,byteOffset:fe,byteLength:i.byteLength},[be])}X&&t.postMessage({action:"endTimeline"}),t.postMessage({action:"flush"})},AB=function(e){e.currentTransmux=null,e.transmuxQueue.length&&(e.currentTransmux=e.transmuxQueue.shift(),typeof e.currentTransmux=="function"?e.currentTransmux():SB(e.currentTransmux))},cP=function(e,t){e.postMessage({action:t}),AB(e)},wB=function(e,t){if(!t.currentTransmux){t.currentTransmux=e,cP(t,e);return}t.transmuxQueue.push(cP.bind(null,t,e))},kq=function(e){wB("reset",e)},Oq=function(e){wB("endTimeline",e)},EB=function(e){if(!e.transmuxer.currentTransmux){e.transmuxer.currentTransmux=e,SB(e);return}e.transmuxer.transmuxQueue.push(e)},Fq=function(e){var t=new Iq;t.currentTransmux=null,t.transmuxQueue=[];var i=t.terminate;return t.terminate=function(){return t.currentTransmux=null,t.transmuxQueue.length=0,i.call(t)},t.postMessage({action:"init",options:e}),t},Vw={reset:kq,endTimeline:Oq,transmux:EB,createTransmuxer:Fq},Nx=function(e){var t=e.transmuxer,i=e.endAction||e.action,n=e.callback,s=zr({},e,{endAction:null,transmuxer:null,callback:null}),a=function m(v){v.data.action===i&&(t.removeEventListener("message",m),v.data.data&&(v.data.data=new Uint8Array(v.data.data,e.byteOffset||0,e.byteLength||v.data.data.byteLength),e.data&&(e.data=v.data.data)),n(v.data))};if(t.addEventListener("message",a),e.data){var c=e.data instanceof ArrayBuffer;s.byteOffset=c?0:e.data.byteOffset,s.byteLength=e.data.byteLength;var h=[c?e.data:e.data.buffer];t.postMessage(s,h)}else t.postMessage(s)},mh={FAILURE:2,TIMEOUT:-101,ABORTED:-102},t2=function(e){e.forEach(function(t){t.abort()})},Bq=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}},Nq=function(e){var t=e.target,i=Date.now()-t.requestTime,n={bandwidth:1/0,bytesReceived:0,roundTripTime:i||0};return n.bytesReceived=e.loaded,n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3),n},oM=function(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:mh.TIMEOUT,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:mh.ABORTED,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:mh.FAILURE,xhr:t}:t.responseType==="arraybuffer"&&t.response.byteLength===0?{status:t.status,message:"Empty HLS response at URL: "+t.uri,code:mh.FAILURE,xhr:t}:null},dP=function(e,t,i){return function(n,s){var a=s.response,c=oM(n,s);if(c)return i(c,e);if(a.byteLength!==16)return i({status:s.status,message:"Invalid HLS key at URL: "+s.uri,code:mh.FAILURE,xhr:s},e);for(var h=new DataView(a),m=new Uint32Array([h.getUint32(0),h.getUint32(4),h.getUint32(8),h.getUint32(12)]),v=0;v<t.length;v++)t[v].bytes=m;return i(null,e)}},CB=function(e,t){var i=EC(e.map.bytes);if(i!=="mp4"){var n=e.map.resolvedUri||e.map.uri;return t({internal:!0,message:"Found unsupported "+(i||"unknown")+" container for initialization segment at URL: "+n,code:mh.FAILURE})}Nx({action:"probeMp4Tracks",data:e.map.bytes,transmuxer:e.transmuxer,callback:function(a){var c=a.tracks,h=a.data;return e.map.bytes=h,c.forEach(function(m){e.map.tracks=e.map.tracks||{},!e.map.tracks[m.type]&&(e.map.tracks[m.type]=m,typeof m.id=="number"&&m.timescale&&(e.map.timescales=e.map.timescales||{},e.map.timescales[m.id]=m.timescale))}),t(null)}})},Uq=function(e){var t=e.segment,i=e.finishProcessingFn;return function(n,s){var a=oM(n,s);if(a)return i(a,t);var c=new Uint8Array(s.response);if(t.map.key)return t.map.encryptedBytes=c,i(null,t);t.map.bytes=c,CB(t,function(h){if(h)return h.xhr=s,h.status=s.status,i(h,t);i(null,t)})}},Vq=function(e){var t=e.segment,i=e.finishProcessingFn,n=e.responseType;return function(s,a){var c=oM(s,a);if(c)return i(c,t);var h=n==="arraybuffer"||!a.responseText?a.response:Cq(a.responseText.substring(t.lastReachedChar||0));return t.stats=Bq(a),t.key?t.encryptedBytes=new Uint8Array(h):t.bytes=new Uint8Array(h),i(null,t)}},zq=function(e){var t=e.segment,i=e.bytes,n=e.trackInfoFn,s=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,c=e.audioSegmentTimingInfoFn,h=e.id3Fn,m=e.captionsFn,v=e.isEndOfTimeline,b=e.endedTimelineFn,x=e.dataFn,C=e.doneFn,B=e.onTransmuxerLog,P=t.map&&t.map.tracks||{},N=!!(P.audio&&P.video),ae=s.bind(null,t,"audio","start"),X=s.bind(null,t,"audio","end"),de=s.bind(null,t,"video","start"),ge=s.bind(null,t,"video","end"),ue=function(){return EB({bytes:i,transmuxer:t.transmuxer,audioAppendStart:t.audioAppendStart,gopsToAlignWith:t.gopsToAlignWith,remux:N,onData:function(ve){ve.type=ve.type==="combined"?"video":ve.type,x(t,ve)},onTrackInfo:function(ve){n&&(N&&(ve.isMuxed=!0),n(t,ve))},onAudioTimingInfo:function(ve){ae&&typeof ve.start<"u"&&(ae(ve.start),ae=null),X&&typeof ve.end<"u"&&X(ve.end)},onVideoTimingInfo:function(ve){de&&typeof ve.start<"u"&&(de(ve.start),de=null),ge&&typeof ve.end<"u"&&ge(ve.end)},onVideoSegmentTimingInfo:function(ve){a(ve)},onAudioSegmentTimingInfo:function(ve){c(ve)},onId3:function(ve,ie){h(t,ve,ie)},onCaptions:function(ve){m(t,[ve])},isEndOfTimeline:v,onEndedTimeline:function(){b()},onTransmuxerLog:B,onDone:function(ve){C&&(ve.type=ve.type==="combined"?"video":ve.type,C(null,t,ve))}})};Nx({action:"probeTs",transmuxer:t.transmuxer,data:i,baseStartTime:t.baseStartTime,callback:function(fe){t.bytes=i=fe.data;var ve=fe.result;ve&&(n(t,{hasAudio:ve.hasAudio,hasVideo:ve.hasVideo,isMuxed:N}),n=null,ve.hasAudio&&!N&&ae(ve.audioStart),ve.hasVideo&&de(ve.videoStart),ae=null,de=null),ue()}})},MB=function(e){var t=e.segment,i=e.bytes,n=e.trackInfoFn,s=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,c=e.audioSegmentTimingInfoFn,h=e.id3Fn,m=e.captionsFn,v=e.isEndOfTimeline,b=e.endedTimelineFn,x=e.dataFn,C=e.doneFn,B=e.onTransmuxerLog,P=new Uint8Array(i);if(s$(P)){t.isFmp4=!0;var N=t.map.tracks,ae={isFmp4:!0,hasVideo:!!N.video,hasAudio:!!N.audio};N.audio&&N.audio.codec&&N.audio.codec!=="enca"&&(ae.audioCodec=N.audio.codec),N.video&&N.video.codec&&N.video.codec!=="encv"&&(ae.videoCodec=N.video.codec),N.video&&N.audio&&(ae.isMuxed=!0),n(t,ae);var X=function(ge){x(t,{data:P,type:ae.hasAudio&&!ae.isMuxed?"audio":"video"}),ge&&ge.length&&m(t,ge),C(null,t,{})};Nx({action:"probeMp4StartTime",timescales:t.map.timescales,data:P,transmuxer:t.transmuxer,callback:function(ge){var ue=ge.data,be=ge.startTime;if(i=ue.buffer,t.bytes=P=ue,ae.hasAudio&&!ae.isMuxed&&s(t,"audio","start",be),ae.hasVideo&&s(t,"video","start",be),!N.video||!ue.byteLength||!t.transmuxer){X();return}Nx({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:t.transmuxer,data:P,timescales:t.map.timescales,trackIds:[N.video.id],callback:function(ve){i=ve.data.buffer,t.bytes=P=ve.data,ve.logs.forEach(function(ie){B(rt.mergeOptions(ie,{stream:"mp4CaptionParser"}))}),X(ve.captions)}})}});return}if(!t.transmuxer){C(null,t,{});return}if(typeof t.container>"u"&&(t.container=EC(P)),t.container!=="ts"&&t.container!=="aac"){n(t,{hasAudio:!1,hasVideo:!1}),C(null,t,{});return}zq({segment:t,bytes:i,trackInfoFn:n,timingInfoFn:s,videoSegmentTimingInfoFn:a,audioSegmentTimingInfoFn:c,id3Fn:h,captionsFn:m,isEndOfTimeline:v,endedTimelineFn:b,dataFn:x,doneFn:C,onTransmuxerLog:B})},DB=function(e,t){var i=e.id,n=e.key,s=e.encryptedBytes,a=e.decryptionWorker,c=function m(v){if(v.data.source===i){a.removeEventListener("message",m);var b=v.data.decrypted;t(new Uint8Array(b.bytes,b.byteOffset,b.byteLength))}};a.addEventListener("message",c);var h;n.bytes.slice?h=n.bytes.slice():h=new Uint32Array(Array.prototype.slice.call(n.bytes)),a.postMessage(pB({source:i,encrypted:s,key:h,iv:n.iv}),[s.buffer,h.buffer])},Hq=function(e){var t=e.decryptionWorker,i=e.segment,n=e.trackInfoFn,s=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,c=e.audioSegmentTimingInfoFn,h=e.id3Fn,m=e.captionsFn,v=e.isEndOfTimeline,b=e.endedTimelineFn,x=e.dataFn,C=e.doneFn,B=e.onTransmuxerLog;DB({id:i.requestId,key:i.key,encryptedBytes:i.encryptedBytes,decryptionWorker:t},function(P){i.bytes=P,MB({segment:i,bytes:i.bytes,trackInfoFn:n,timingInfoFn:s,videoSegmentTimingInfoFn:a,audioSegmentTimingInfoFn:c,id3Fn:h,captionsFn:m,isEndOfTimeline:v,endedTimelineFn:b,dataFn:x,doneFn:C,onTransmuxerLog:B})})},jq=function(e){var t=e.activeXhrs,i=e.decryptionWorker,n=e.trackInfoFn,s=e.timingInfoFn,a=e.videoSegmentTimingInfoFn,c=e.audioSegmentTimingInfoFn,h=e.id3Fn,m=e.captionsFn,v=e.isEndOfTimeline,b=e.endedTimelineFn,x=e.dataFn,C=e.doneFn,B=e.onTransmuxerLog,P=0,N=!1;return function(ae,X){if(!N){if(ae)return N=!0,t2(t),C(ae,X);if(P+=1,P===t.length){var de=function(){if(X.encryptedBytes)return Hq({decryptionWorker:i,segment:X,trackInfoFn:n,timingInfoFn:s,videoSegmentTimingInfoFn:a,audioSegmentTimingInfoFn:c,id3Fn:h,captionsFn:m,isEndOfTimeline:v,endedTimelineFn:b,dataFn:x,doneFn:C,onTransmuxerLog:B});MB({segment:X,bytes:X.bytes,trackInfoFn:n,timingInfoFn:s,videoSegmentTimingInfoFn:a,audioSegmentTimingInfoFn:c,id3Fn:h,captionsFn:m,isEndOfTimeline:v,endedTimelineFn:b,dataFn:x,doneFn:C,onTransmuxerLog:B})};if(X.endOfAllRequests=Date.now(),X.map&&X.map.encryptedBytes&&!X.map.bytes)return DB({decryptionWorker:i,id:X.requestId+"-init",encryptedBytes:X.map.encryptedBytes,key:X.map.key},function(ge){X.map.bytes=ge,CB(X,function(ue){if(ue)return t2(t),C(ue,X);de()})});de()}}}},Gq=function(e){var t=e.loadendState,i=e.abortFn;return function(n){var s=n.target;s.aborted&&i&&!t.calledAbortFn&&(i(),t.calledAbortFn=!0)}},$q=function(e){var t=e.segment,i=e.progressFn;return function(n){var s=n.target;if(!s.aborted)return t.stats=rt.mergeOptions(t.stats,Nq(n)),!t.stats.firstBytesReceivedAt&&t.stats.bytesReceived&&(t.stats.firstBytesReceivedAt=Date.now()),i(n,t)}},Wq=function(e){var t=e.xhr,i=e.xhrOptions,n=e.decryptionWorker,s=e.segment,a=e.abortFn,c=e.progressFn,h=e.trackInfoFn,m=e.timingInfoFn,v=e.videoSegmentTimingInfoFn,b=e.audioSegmentTimingInfoFn,x=e.id3Fn,C=e.captionsFn,B=e.isEndOfTimeline,P=e.endedTimelineFn,N=e.dataFn,ae=e.doneFn,X=e.onTransmuxerLog,de=[],ge=jq({activeXhrs:de,decryptionWorker:n,trackInfoFn:h,timingInfoFn:m,videoSegmentTimingInfoFn:v,audioSegmentTimingInfoFn:b,id3Fn:x,captionsFn:C,isEndOfTimeline:B,endedTimelineFn:P,dataFn:N,doneFn:ae,onTransmuxerLog:X});if(s.key&&!s.key.bytes){var ue=[s.key];s.map&&!s.map.bytes&&s.map.key&&s.map.key.resolvedUri===s.key.resolvedUri&&ue.push(s.map.key);var be=rt.mergeOptions(i,{uri:s.key.resolvedUri,responseType:"arraybuffer"}),fe=dP(s,ue,ge),ve=t(be,fe);de.push(ve)}if(s.map&&!s.map.bytes){var ie=s.map.key&&(!s.key||s.key.resolvedUri!==s.map.key.resolvedUri);if(ie){var re=rt.mergeOptions(i,{uri:s.map.key.resolvedUri,responseType:"arraybuffer"}),Ne=dP(s,[s.map.key],ge),De=t(re,Ne);de.push(De)}var ke=rt.mergeOptions(i,{uri:s.map.resolvedUri,responseType:"arraybuffer",headers:JE(s.map)}),ut=Uq({segment:s,finishProcessingFn:ge}),_t=t(ke,ut);de.push(_t)}var vt=rt.mergeOptions(i,{uri:s.part&&s.part.resolvedUri||s.resolvedUri,responseType:"arraybuffer",headers:JE(s)}),tt=Vq({segment:s,finishProcessingFn:ge,responseType:vt.responseType}),je=t(vt,tt);je.addEventListener("progress",$q({segment:s,progressFn:c})),de.push(je);var it={};return de.forEach(function(Xe){Xe.addEventListener("loadend",Gq({loadendState:it,abortFn:a}))}),function(){return t2(de)}},qq=td("CodecUtils"),Xq=function(e){var t=e.attributes||{};if(t.CODECS)return Zd(t.CODECS)},IB=function(e,t){var i=t.attributes||{};return e&&e.mediaGroups&&e.mediaGroups.AUDIO&&i.AUDIO&&e.mediaGroups.AUDIO[i.AUDIO]},Yq=function(e,t){if(!IB(e,t))return!0;var i=t.attributes||{},n=e.mediaGroups.AUDIO[i.AUDIO];for(var s in n)if(!n[s].uri&&!n[s].playlists)return!0;return!1},Ux=function(e){var t={};return e.forEach(function(i){var n=i.mediaType,s=i.type,a=i.details;t[n]=t[n]||[],t[n].push(D4(""+s+a))}),Object.keys(t).forEach(function(i){if(t[i].length>1){qq("multiple "+i+" codecs found as attributes: "+t[i].join(", ")+". Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs."),t[i]=null;return}t[i]=t[i][0]}),t},hP=function(e){var t=0;return e.audio&&t++,e.video&&t++,t},v_=function(e,t){var i=t.attributes||{},n=Ux(Xq(t)||[]);if(IB(e,t)&&!n.audio&&!Yq(e,t)){var s=Ux(Nj(e,i.AUDIO)||[]);s.audio&&(n.audio=s.audio)}return n},uT=td("PlaylistSelector"),fP=function(e){if(!(!e||!e.playlist)){var t=e.playlist;return JSON.stringify({id:t.id,bandwidth:e.bandwidth,width:e.width,height:e.height,codecs:t.attributes&&t.attributes.CODECS||""})}},Vx=function(e,t){if(!e)return"";var i=Z.getComputedStyle(e);return i?i[t]:""},w0=function(e,t){var i=e.slice();e.sort(function(n,s){var a=t(n,s);return a===0?i.indexOf(n)-i.indexOf(s):a})},lM=function(e,t){var i,n;return e.attributes.BANDWIDTH&&(i=e.attributes.BANDWIDTH),i=i||Z.Number.MAX_VALUE,t.attributes.BANDWIDTH&&(n=t.attributes.BANDWIDTH),n=n||Z.Number.MAX_VALUE,i-n},Qq=function(e,t){var i,n;return e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(i=e.attributes.RESOLUTION.width),i=i||Z.Number.MAX_VALUE,t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(n=t.attributes.RESOLUTION.width),n=n||Z.Number.MAX_VALUE,i===n&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?e.attributes.BANDWIDTH-t.attributes.BANDWIDTH:i-n},PB=function(e,t,i,n,s,a){if(e){var c={bandwidth:t,width:i,height:n,limitRenditionByPlayerDimensions:s},h=e.playlists;eu.isAudioOnly(e)&&(h=a.getAudioTrackPlaylists_(),c.audioOnly=!0);var m=h.map(function(re){var Ne,De=re.attributes&&re.attributes.RESOLUTION&&re.attributes.RESOLUTION.width,ke=re.attributes&&re.attributes.RESOLUTION&&re.attributes.RESOLUTION.height;return Ne=re.attributes&&re.attributes.BANDWIDTH,Ne=Ne||Z.Number.MAX_VALUE,{bandwidth:Ne,width:De,height:ke,playlist:re}});w0(m,function(re,Ne){return re.bandwidth-Ne.bandwidth}),m=m.filter(function(re){return!eu.isIncompatible(re.playlist)});var v=m.filter(function(re){return eu.isEnabled(re.playlist)});v.length||(v=m.filter(function(re){return!eu.isDisabled(re.playlist)}));var b=v.filter(function(re){return re.bandwidth*Ka.BANDWIDTH_VARIANCE<t}),x=b[b.length-1],C=b.filter(function(re){return re.bandwidth===x.bandwidth})[0];if(s===!1){var B=C||v[0]||m[0];if(B&&B.playlist){var P="sortedPlaylistReps";return C&&(P="bandwidthBestRep"),v[0]&&(P="enabledPlaylistReps"),uT("choosing "+fP(B)+" using "+P+" with options",c),B.playlist}return uT("could not choose a playlist with options",c),null}var N=b.filter(function(re){return re.width&&re.height});w0(N,function(re,Ne){return re.width-Ne.width});var ae=N.filter(function(re){return re.width===i&&re.height===n});x=ae[ae.length-1];var X=ae.filter(function(re){return re.bandwidth===x.bandwidth})[0],de,ge,ue;X||(de=N.filter(function(re){return re.width>i||re.height>n}),ge=de.filter(function(re){return re.width===de[0].width&&re.height===de[0].height}),x=ge[ge.length-1],ue=ge.filter(function(re){return re.bandwidth===x.bandwidth})[0]);var be;if(a.experimentalLeastPixelDiffSelector){var fe=N.map(function(re){return re.pixelDiff=Math.abs(re.width-i)+Math.abs(re.height-n),re});w0(fe,function(re,Ne){return re.pixelDiff===Ne.pixelDiff?Ne.bandwidth-re.bandwidth:re.pixelDiff-Ne.pixelDiff}),be=fe[0]}var ve=be||ue||X||C||v[0]||m[0];if(ve&&ve.playlist){var ie="sortedPlaylistReps";return be?ie="leastPixelDiffRep":ue?ie="resolutionPlusOneRep":X?ie="resolutionBestRep":C?ie="bandwidthBestRep":v[0]&&(ie="enabledPlaylistReps"),uT("choosing "+fP(ve)+" using "+ie+" with options",c),ve.playlist}return uT("could not choose a playlist with options",c),null}},pP=function(){var e=this.useDevicePixelRatio&&Z.devicePixelRatio||1;return PB(this.playlists.master,this.systemBandwidth,parseInt(Vx(this.tech_.el(),"width"),10)*e,parseInt(Vx(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)},Kq=function(e){var t=-1,i=-1;if(e<0||e>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){var n=this.useDevicePixelRatio&&Z.devicePixelRatio||1;return t<0&&(t=this.systemBandwidth,i=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==i&&(t=e*this.systemBandwidth+(1-e)*t,i=this.systemBandwidth),PB(this.playlists.master,t,parseInt(Vx(this.tech_.el(),"width"),10)*n,parseInt(Vx(this.tech_.el(),"height"),10)*n,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)}},Zq=function(e){var t=e.master,i=e.currentTime,n=e.bandwidth,s=e.duration,a=e.segmentDuration,c=e.timeUntilRebuffer,h=e.currentTimeline,m=e.syncController,v=t.playlists.filter(function(P){return!eu.isIncompatible(P)}),b=v.filter(eu.isEnabled);b.length||(b=v.filter(function(P){return!eu.isDisabled(P)}));var x=b.filter(eu.hasAttribute.bind(null,"BANDWIDTH")),C=x.map(function(P){var N=m.getSyncPoint(P,s,h,i),ae=N?1:2,X=eu.estimateSegmentRequestTime(a,n,P),de=X*ae-c;return{playlist:P,rebufferingImpact:de}}),B=C.filter(function(P){return P.rebufferingImpact<=0});return w0(B,function(P,N){return lM(N.playlist,P.playlist)}),B.length?B[0]:(w0(C,function(P,N){return P.rebufferingImpact-N.rebufferingImpact}),C[0]||null)},Jq=function(){var e=this,t=this.playlists.master.playlists.filter(eu.isEnabled);w0(t,function(n,s){return lM(n,s)});var i=t.filter(function(n){return!!v_(e.playlists.master,n).video});return i[0]||null},eX=function(e){var t=0,i;return e.bytes&&(i=new Uint8Array(e.bytes),e.segments.forEach(function(n){i.set(n,t),t+=n.byteLength})),i},tX=function(e,t,i){if(!e[i]){t.trigger({type:"usage",name:"vhs-608"}),t.trigger({type:"usage",name:"hls-608"});var n=i;/^cc708_/.test(i)&&(n="SERVICE"+i.split("_")[1]);var s=t.textTracks().getTrackById(n);if(s)e[i]=s;else{var a=t.options_.vhs&&t.options_.vhs.captionServices||{},c=i,h=i,m=!1,v=a[n];v&&(c=v.label,h=v.language,m=v.default),e[i]=t.addRemoteTextTrack({kind:"captions",id:n,default:m,label:c,language:h},!1).track}}},iX=function(e){var t=e.inbandTextTracks,i=e.captionArray,n=e.timestampOffset;if(i){var s=Z.WebKitDataCue||Z.VTTCue;i.forEach(function(a){var c=a.stream;t[c].addCue(new s(a.startTime+n,a.endTime+n,a.text))})}},nX=function(e){Object.defineProperties(e.frame,{id:{get:function(){return rt.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return rt.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return rt.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})},rX=function(e){var t=e.inbandTextTracks,i=e.metadataArray,n=e.timestampOffset,s=e.videoDuration;if(i){var a=Z.WebKitDataCue||Z.VTTCue,c=t.metadataTrack_;if(c&&(i.forEach(function(C){var B=C.cueTime+n;typeof B!="number"||Z.isNaN(B)||B<0||!(B<1/0)||C.frames.forEach(function(P){var N=new a(B,B,P.value||P.url||P.data||"");N.frame=P,N.value=P,nX(N),c.addCue(N)})}),!(!c.cues||!c.cues.length))){for(var h=c.cues,m=[],v=0;v<h.length;v++)h[v]&&m.push(h[v]);var b=m.reduce(function(C,B){var P=C[B.startTime]||[];return P.push(B),C[B.startTime]=P,C},{}),x=Object.keys(b).sort(function(C,B){return Number(C)-Number(B)});x.forEach(function(C,B){var P=b[C],N=Number(x[B+1])||s;P.forEach(function(ae){ae.endTime=N})})}}},sX=function(e,t,i){e.metadataTrack_||(e.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=t)},r_=function(e,t,i){var n,s;if(i&&i.cues)for(n=i.cues.length;n--;)s=i.cues[n],s.startTime>=e&&s.endTime<=t&&i.removeCue(s)},aX=function(e){var t=e.cues;if(t)for(var i=0;i<t.length;i++){for(var n=[],s=0,a=0;a<t.length;a++)t[i].startTime===t[a].startTime&&t[i].endTime===t[a].endTime&&t[i].text===t[a].text&&(s++,s>1&&n.push(t[a]));n.length&&n.forEach(function(c){return e.removeCue(c)})}},oX=function(e,t,i){if(typeof t>"u"||t===null||!e.length)return[];var n=Math.ceil((t-i+3)*wx.ONE_SECOND_IN_TS),s;for(s=0;s<e.length&&!(e[s].pts>n);s++);return e.slice(s)},lX=function(e,t,i){if(!t.length)return e;if(i)return t.slice();var n=t[0].pts,s=0;for(s;s<e.length&&!(e[s].pts>=n);s++);return e.slice(0,s).concat(t)},uX=function(e,t,i,n){for(var s=Math.ceil((t-n)*wx.ONE_SECOND_IN_TS),a=Math.ceil((i-n)*wx.ONE_SECOND_IN_TS),c=e.slice(),h=e.length;h--&&!(e[h].pts<=a););if(h===-1)return c;for(var m=h+1;m--&&!(e[m].pts<=s););return m=Math.max(m,0),c.splice(m,h-m+1),c},cX=function(e,t){if(!e&&!t||!e&&t||e&&!t)return!1;if(e===t)return!0;var i=Object.keys(e).sort(),n=Object.keys(t).sort();if(i.length!==n.length)return!1;for(var s=0;s<i.length;s++){var a=i[s];if(a!==n[s]||e[a]!==t[a])return!1}return!0},LB=22,dX=function(e,t,i){t=t||[];for(var n=[],s=0,a=0;a<t.length;a++){var c=t[a];if(e===c.timeline&&(n.push(a),s+=c.duration,s>i))return a}return n.length===0?0:n[n.length-1]},qy=1,hX=500,mP=function(e){return typeof e=="number"&&isFinite(e)},cT=1/60,fX=function(e,t,i){return e!=="main"||!t||!i?null:!i.hasAudio&&!i.hasVideo?"Neither audio nor video found in segment.":t.hasVideo&&!i.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.hasVideo&&i.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null},pX=function(e,t,i){var n=t-Ka.BACK_BUFFER_LENGTH;e.length&&(n=Math.max(n,e.start(0)));var s=t-i;return Math.min(s,n)},qg=function(e){var t=e.startOfSegment,i=e.duration,n=e.segment,s=e.part,a=e.playlist,c=a.mediaSequence,h=a.id,m=a.segments,v=m===void 0?[]:m,b=e.mediaIndex,x=e.partIndex,C=e.timeline,B=v.length-1,P="mediaIndex/partIndex increment";e.getMediaInfoForTime?P="getMediaInfoForTime ("+e.getMediaInfoForTime+")":e.isSyncRequest&&(P="getSyncSegmentCandidate (isSyncRequest)"),e.independent&&(P+=" with independent "+e.independent);var N=typeof x=="number",ae=e.segment.uri?"segment":"pre-segment",X=N?eB({preloadSegment:n})-1:0;return ae+" ["+(c+b)+"/"+(c+B)+"]"+(N?" part ["+x+"/"+X+"]":"")+(" segment start/end ["+n.start+" => "+n.end+"]")+(N?" part start/end ["+s.start+" => "+s.end+"]":"")+(" startOfSegment ["+t+"]")+(" duration ["+i+"]")+(" timeline ["+C+"]")+(" selected by ["+P+"]")+(" playlist ["+h+"]")},gP=function(e){return e+"TimingInfo"},mX=function(e){var t=e.segmentTimeline,i=e.currentTimeline,n=e.startOfSegment,s=e.buffered,a=e.overrideCheck;return!a&&t===i?null:t<i?n:s.length?s.end(s.length-1):n},vP=function(e){var t=e.timelineChangeController,i=e.currentTimeline,n=e.segmentTimeline,s=e.loaderType,a=e.audioDisabled;if(i===n)return!1;if(s==="audio"){var c=t.lastTimelineChange({type:"main"});return!c||c.to!==n}if(s==="main"&&a){var h=t.pendingTimelineChange({type:"audio"});return!(h&&h.to===n)}return!1},gX=function(e){var t=0;return["video","audio"].forEach(function(i){var n=e[i+"TimingInfo"];if(n){var s=n.start,a=n.end,c;typeof s=="bigint"||typeof a=="bigint"?c=Z.BigInt(a)-Z.BigInt(s):typeof s=="number"&&typeof a=="number"&&(c=a-s),typeof c<"u"&&c>t&&(t=c)}}),typeof t=="bigint"&&t<Number.MAX_SAFE_INTEGER&&(t=Number(t)),t},yP=function(e){var t=e.segmentDuration,i=e.maxDuration;return t?Math.round(t)>i+Op:!1},vX=function(e,t){if(t!=="hls")return null;var i=gX({audioTimingInfo:e.audioTimingInfo,videoTimingInfo:e.videoTimingInfo});if(!i)return null;var n=e.playlist.targetDuration,s=yP({segmentDuration:i,maxDuration:n*2}),a=yP({segmentDuration:i,maxDuration:n}),c="Segment with index "+e.mediaIndex+" "+("from playlist "+e.playlist.id+" ")+("has a duration of "+i+" ")+("when the reported duration is "+e.duration+" ")+("and the target duration is "+n+". ")+"For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1";return s||a?{severity:s?"warn":"info",message:c}:null},i2=function(r){mi(e,r);function e(i,n){var s;if(s=r.call(this)||this,!i)throw new TypeError("Initialization settings are required");if(typeof i.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!i.mediaSource)throw new TypeError("No MediaSource specified");return s.bandwidth=i.bandwidth,s.throughput={rate:0,count:0},s.roundTrip=NaN,s.resetStats_(),s.mediaIndex=null,s.partIndex=null,s.hasPlayed_=i.hasPlayed,s.currentTime_=i.currentTime,s.seekable_=i.seekable,s.seeking_=i.seeking,s.duration_=i.duration,s.mediaSource_=i.mediaSource,s.vhs_=i.vhs,s.loaderType_=i.loaderType,s.currentMediaInfo_=void 0,s.startingMediaInfo_=void 0,s.segmentMetadataTrack_=i.segmentMetadataTrack,s.goalBufferLength_=i.goalBufferLength,s.sourceType_=i.sourceType,s.sourceUpdater_=i.sourceUpdater,s.inbandTextTracks_=i.inbandTextTracks,s.state_="INIT",s.timelineChangeController_=i.timelineChangeController,s.shouldSaveSegmentTimingInfo_=!0,s.parse708captions_=i.parse708captions,s.useDtsForTimestampOffset_=i.useDtsForTimestampOffset,s.captionServices_=i.captionServices,s.experimentalExactManifestTimings=i.experimentalExactManifestTimings,s.checkBufferTimeout_=null,s.error_=void 0,s.currentTimeline_=-1,s.pendingSegment_=null,s.xhrOptions_=null,s.pendingSegments_=[],s.audioDisabled_=!1,s.isPendingTimestampOffset_=!1,s.gopBuffer_=[],s.timeMapping_=0,s.safeAppend_=rt.browser.IE_VERSION>=11,s.appendInitSegment_={audio:!0,video:!0},s.playlistOfLastInitSegment_={audio:null,video:null},s.callQueue_=[],s.loadQueue_=[],s.metadataQueue_={id3:[],caption:[]},s.waitingOnRemove_=!1,s.quotaExceededErrorRetryTimeout_=null,s.activeInitSegmentId_=null,s.initSegments_={},s.cacheEncryptionKeys_=i.cacheEncryptionKeys,s.keyCache_={},s.decrypter_=i.decrypter,s.syncController_=i.syncController,s.syncPoint_={segmentIndex:0,time:0},s.transmuxer_=s.createTransmuxer_(),s.triggerSyncInfoUpdate_=function(){return s.trigger("syncinfoupdate")},s.syncController_.on("syncinfoupdate",s.triggerSyncInfoUpdate_),s.mediaSource_.addEventListener("sourceopen",function(){s.isEndOfStream_()||(s.ended_=!1)}),s.fetchAtBuffer_=!1,s.logger_=td("SegmentLoader["+s.loaderType_+"]"),Object.defineProperty(Tn(s),"state",{get:function(){return this.state_},set:function(c){c!==this.state_&&(this.logger_(this.state_+" -> "+c),this.state_=c,this.trigger("statechange"))}}),s.sourceUpdater_.on("ready",function(){s.hasEnoughInfoToAppend_()&&s.processCallQueue_()}),s.loaderType_==="main"&&s.timelineChangeController_.on("pendingtimelinechange",function(){s.hasEnoughInfoToAppend_()&&s.processCallQueue_()}),s.loaderType_==="audio"&&s.timelineChangeController_.on("timelinechange",function(){s.hasEnoughInfoToLoad_()&&s.processLoadQueue_(),s.hasEnoughInfoToAppend_()&&s.processCallQueue_()}),s}var t=e.prototype;return t.createTransmuxer_=function(){return Vw.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})},t.resetStats_=function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0},t.dispose=function(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&Z.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()},t.setAudio=function(n){this.audioDisabled_=!n,n?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())},t.abort=function(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()},t.abort_=function(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,Z.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null},t.checkForAbort_=function(n){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==n},t.error=function(n){return typeof n<"u"&&(this.logger_("error occurred:",n),this.error_=n),this.pendingSegment_=null,this.error_},t.endOfStream=function(){this.ended_=!0,this.transmuxer_&&Vw.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")},t.buffered_=function(){var n=this.getMediaInfo_();if(!this.sourceUpdater_||!n)return rt.createTimeRanges();if(this.loaderType_==="main"){var s=n.hasAudio,a=n.hasVideo,c=n.isMuxed;if(a&&s&&!this.audioDisabled_&&!c)return this.sourceUpdater_.buffered();if(a)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()},t.initSegmentForMap=function(n,s){if(s===void 0&&(s=!1),!n)return null;var a=Bx(n),c=this.initSegments_[a];return s&&!c&&n.bytes&&(this.initSegments_[a]=c={resolvedUri:n.resolvedUri,byterange:n.byterange,bytes:n.bytes,tracks:n.tracks,timescales:n.timescales}),c||n},t.segmentKey=function(n,s){if(s===void 0&&(s=!1),!n)return null;var a=mB(n),c=this.keyCache_[a];this.cacheEncryptionKeys_&&s&&!c&&n.bytes&&(this.keyCache_[a]=c={resolvedUri:n.resolvedUri,bytes:n.bytes});var h={resolvedUri:(c||n).resolvedUri};return c&&(h.bytes=c.bytes),h},t.couldBeginLoading_=function(){return this.playlist_&&!this.paused()},t.load=function(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}},t.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},t.playlist=function(n,s){if(s===void 0&&(s={}),!!n){var a=this.playlist_,c=this.pendingSegment_;this.playlist_=n,this.xhrOptions_=s,this.state==="INIT"&&(n.syncInfo={mediaSequence:n.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(n));var h=null;if(a&&(a.id?h=a.id:a.uri&&(h=a.uri)),this.logger_("playlist update ["+h+" => "+(n.id||n.uri)+"]"),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!a||a.uri!==n.uri){this.mediaIndex!==null&&(n.endList?this.resyncLoader():this.resetLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}var m=n.mediaSequence-a.mediaSequence;if(this.logger_("live window shift ["+m+"]"),this.mediaIndex!==null)if(this.mediaIndex-=m,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{var v=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!v.parts||!v.parts.length||!v.parts[this.partIndex])){var b=this.mediaIndex;this.logger_("currently processing part (index "+this.partIndex+") no longer exists."),this.resetLoader(),this.mediaIndex=b}}c&&(c.mediaIndex-=m,c.mediaIndex<0?(c.mediaIndex=null,c.partIndex=null):(c.mediaIndex>=0&&(c.segment=n.segments[c.mediaIndex]),c.partIndex>=0&&c.segment.parts&&(c.part=c.segment.parts[c.partIndex]))),this.syncController_.saveExpiredSegmentInfo(a,n)}},t.pause=function(){this.checkBufferTimeout_&&(Z.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)},t.paused=function(){return this.checkBufferTimeout_===null},t.resetEverything=function(n){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,n),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))},t.resetLoader=function(){this.fetchAtBuffer_=!1,this.resyncLoader()},t.resyncLoader=function(){this.transmuxer_&&Vw.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})},t.remove=function(n,s,a,c){if(a===void 0&&(a=function(){}),c===void 0&&(c=!1),s===1/0&&(s=this.duration_()),s<=n){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}var h=1,m=function(){h--,h===0&&a()};(c||!this.audioDisabled_)&&(h++,this.sourceUpdater_.removeAudio(n,s,m)),(c||this.loaderType_==="main")&&(this.gopBuffer_=uX(this.gopBuffer_,n,s,this.timeMapping_),h++,this.sourceUpdater_.removeVideo(n,s,m));for(var v in this.inbandTextTracks_)r_(n,s,this.inbandTextTracks_[v]);r_(n,s,this.segmentMetadataTrack_),m()},t.monitorBuffer_=function(){this.checkBufferTimeout_&&Z.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=Z.setTimeout(this.monitorBufferTick_.bind(this),1)},t.monitorBufferTick_=function(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&Z.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=Z.setTimeout(this.monitorBufferTick_.bind(this),hX)},t.fillBuffer_=function(){if(!this.sourceUpdater_.updating()){var n=this.chooseNextRequest_();n&&(typeof n.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:n.timeline})),this.loadSegment_(n))}},t.isEndOfStream_=function(n,s,a){if(n===void 0&&(n=this.mediaIndex),s===void 0&&(s=this.playlist_),a===void 0&&(a=this.partIndex),!s||!this.mediaSource_)return!1;var c=typeof n=="number"&&s.segments[n],h=n+1===s.segments.length,m=!c||!c.parts||a+1===c.parts.length;return s.endList&&this.mediaSource_.readyState==="open"&&h&&m},t.chooseNextRequest_=function(){var n=this.buffered_(),s=sP(n)||0,a=iM(n,this.currentTime_()),c=!this.hasPlayed_()&&a>=1,h=a>=this.goalBufferLength_(),m=this.playlist_.segments;if(!m.length||c||h)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());var v={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:!this.syncPoint_};if(v.isSyncRequest)v.mediaIndex=dX(this.currentTimeline_,m,s);else if(this.mediaIndex!==null){var b=m[this.mediaIndex],x=typeof this.partIndex=="number"?this.partIndex:-1;v.startOfSegment=b.end?b.end:s,b.parts&&b.parts[x+1]?(v.mediaIndex=this.mediaIndex,v.partIndex=x+1):v.mediaIndex=this.mediaIndex+1}else{var C=eu.getMediaInfoForTime({experimentalExactManifestTimings:this.experimentalExactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?s:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time}),B=C.segmentIndex,P=C.startTime,N=C.partIndex;v.getMediaInfoForTime=this.fetchAtBuffer_?"bufferedEnd "+s:"currentTime "+this.currentTime_(),v.mediaIndex=B,v.startOfSegment=P,v.partIndex=N}var ae=m[v.mediaIndex],X=ae&&typeof v.partIndex=="number"&&ae.parts&&ae.parts[v.partIndex];if(!ae||typeof v.partIndex=="number"&&!X)return null;if(typeof v.partIndex!="number"&&ae.parts&&(v.partIndex=0,X=ae.parts[0]),!a&&X&&!X.independent)if(v.partIndex===0){var de=m[v.mediaIndex-1],ge=de.parts&&de.parts.length&&de.parts[de.parts.length-1];ge&&ge.independent&&(v.mediaIndex-=1,v.partIndex=de.parts.length-1,v.independent="previous segment")}else ae.parts[v.partIndex-1].independent&&(v.partIndex-=1,v.independent="previous part");var ue=this.mediaSource_&&this.mediaSource_.readyState==="ended";return v.mediaIndex>=m.length-1&&ue&&!this.seeking_()?null:this.generateSegmentInfo_(v)},t.generateSegmentInfo_=function(n){var s=n.independent,a=n.playlist,c=n.mediaIndex,h=n.startOfSegment,m=n.isSyncRequest,v=n.partIndex,b=n.forceTimestampOffset,x=n.getMediaInfoForTime,C=a.segments[c],B=typeof v=="number"&&C.parts[v],P={requestId:"segment-loader-"+Math.random(),uri:B&&B.resolvedUri||C.resolvedUri,mediaIndex:c,partIndex:B?v:null,isSyncRequest:m,startOfSegment:h,playlist:a,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:C.timeline,duration:B&&B.duration||C.duration,segment:C,part:B,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:x,independent:s},N=typeof b<"u"?b:this.isPendingTimestampOffset_;P.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:C.timeline,currentTimeline:this.currentTimeline_,startOfSegment:h,buffered:this.buffered_(),overrideCheck:N});var ae=sP(this.sourceUpdater_.audioBuffered());return typeof ae=="number"&&(P.audioAppendStart=ae-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(P.gopsToAlignWith=oX(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),P},t.timestampOffsetForSegment_=function(n){return mX(n)},t.earlyAbortWhenNeeded_=function(n){if(!(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)&&!(Date.now()-(n.firstBytesReceivedAt||Date.now())<1e3)){var s=this.currentTime_(),a=n.bandwidth,c=this.pendingSegment_.duration,h=eu.estimateSegmentRequestTime(c,a,this.playlist_,n.bytesReceived),m=NW(this.buffered_(),s,this.vhs_.tech_.playbackRate())-1;if(!(h<=m)){var v=Zq({master:this.vhs_.playlists.master,currentTime:s,bandwidth:a,duration:this.duration_(),segmentDuration:c,timeUntilRebuffer:m,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(v){var b=h-m,x=b-v.rebufferingImpact,C=.5;m<=Op&&(C=1),!(!v.playlist||v.playlist.uri===this.playlist_.uri||x<C)&&(this.bandwidth=v.playlist.attributes.BANDWIDTH*Ka.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}}}},t.handleAbort_=function(n){this.logger_("Aborting "+qg(n)),this.mediaRequestsAborted+=1},t.handleProgress_=function(n,s){this.earlyAbortWhenNeeded_(s.stats),!this.checkForAbort_(s.requestId)&&this.trigger("progress")},t.handleTrackInfo_=function(n,s){this.earlyAbortWhenNeeded_(n.stats),!this.checkForAbort_(n.requestId)&&(this.checkForIllegalMediaSwitch(s)||(s=s||{},cX(this.currentMediaInfo_,s)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=s,this.currentMediaInfo_=s,this.logger_("trackinfo update",s),this.trigger("trackinfo")),!this.checkForAbort_(n.requestId)&&(this.pendingSegment_.trackInfo=s,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())))},t.handleTimingInfo_=function(n,s,a,c){if(this.earlyAbortWhenNeeded_(n.stats),!this.checkForAbort_(n.requestId)){var h=this.pendingSegment_,m=gP(s);h[m]=h[m]||{},h[m][a]=c,this.logger_("timinginfo: "+s+" - "+a+" - "+c),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}},t.handleCaptions_=function(n,s){var a=this;if(this.earlyAbortWhenNeeded_(n.stats),!this.checkForAbort_(n.requestId)){if(s.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}var c=this.pendingSegment_;if(!c.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,n,s));return}var h=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),m={};s.forEach(function(v){m[v.stream]=m[v.stream]||{startTime:1/0,captions:[],endTime:0};var b=m[v.stream];b.startTime=Math.min(b.startTime,v.startTime+h),b.endTime=Math.max(b.endTime,v.endTime+h),b.captions.push(v)}),Object.keys(m).forEach(function(v){var b=m[v],x=b.startTime,C=b.endTime,B=b.captions,P=a.inbandTextTracks_;a.logger_("adding cues from "+x+" -> "+C+" for "+v),tX(P,a.vhs_.tech_,v),r_(x,C,P[v]),iX({captionArray:B,inbandTextTracks:P,timestampOffset:h})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}},t.handleId3_=function(n,s,a){if(this.earlyAbortWhenNeeded_(n.stats),!this.checkForAbort_(n.requestId)){var c=this.pendingSegment_;if(!c.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,n,s,a));return}var h=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();sX(this.inbandTextTracks_,a,this.vhs_.tech_),rX({inbandTextTracks:this.inbandTextTracks_,metadataArray:s,timestampOffset:h,videoDuration:this.duration_()})}},t.processMetadataQueue_=function(){this.metadataQueue_.id3.forEach(function(n){return n()}),this.metadataQueue_.caption.forEach(function(n){return n()}),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]},t.processCallQueue_=function(){var n=this.callQueue_;this.callQueue_=[],n.forEach(function(s){return s()})},t.processLoadQueue_=function(){var n=this.loadQueue_;this.loadQueue_=[],n.forEach(function(s){return s()})},t.hasEnoughInfoToLoad_=function(){if(this.loaderType_!=="audio")return!0;var n=this.pendingSegment_;return n?this.getCurrentMediaInfo_()?!vP({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:n.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1},t.getCurrentMediaInfo_=function(n){return n===void 0&&(n=this.pendingSegment_),n&&n.trackInfo||this.currentMediaInfo_},t.getMediaInfo_=function(n){return n===void 0&&(n=this.pendingSegment_),this.getCurrentMediaInfo_(n)||this.startingMediaInfo_},t.getPendingSegmentPlaylist=function(){return this.pendingSegment_?this.pendingSegment_.playlist:null},t.hasEnoughInfoToAppend_=function(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;var n=this.pendingSegment_,s=this.getCurrentMediaInfo_();if(!n||!s)return!1;var a=s.hasAudio,c=s.hasVideo,h=s.isMuxed;return!(c&&!n.videoTimingInfo||a&&!this.audioDisabled_&&!h&&!n.audioTimingInfo||vP({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:n.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))},t.handleData_=function(n,s){if(this.earlyAbortWhenNeeded_(n.stats),!this.checkForAbort_(n.requestId)){if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,n,s));return}var a=this.pendingSegment_;if(this.setTimeMapping_(a.timeline),this.updateMediaSecondsLoaded_(a.part||a.segment),this.mediaSource_.readyState!=="closed"){if(n.map&&(n.map=this.initSegmentForMap(n.map,!0),a.segment.map=n.map),n.key&&this.segmentKey(n.key,!0),a.isFmp4=n.isFmp4,a.timingInfo=a.timingInfo||{},a.isFmp4)this.trigger("fmp4"),a.timingInfo.start=a[gP(s.type)].start;else{var c=this.getCurrentMediaInfo_(),h=this.loaderType_==="main"&&c&&c.hasVideo,m;h&&(m=a.videoTimingInfo.start),a.timingInfo.start=this.trueSegmentStart_({currentStart:a.timingInfo.start,playlist:a.playlist,mediaIndex:a.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:h,firstVideoFrameTimeForData:m,videoTimingInfo:a.videoTimingInfo,audioTimingInfo:a.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(a,s.type),this.updateSourceBufferTimestampOffset_(a),a.isSyncRequest){this.updateTimingInfoEnd_(a),this.syncController_.saveSegmentTimingInfo({segmentInfo:a,shouldSaveTimelineMapping:this.loaderType_==="main"});var v=this.chooseNextRequest_();if(v.mediaIndex!==a.mediaIndex||v.partIndex!==a.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}a.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(a,s)}}},t.updateAppendInitSegmentStatus=function(n,s){this.loaderType_==="main"&&typeof n.timestampOffset=="number"&&!n.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[s]!==n.playlist&&(this.appendInitSegment_[s]=!0)},t.getInitSegmentAndUpdateState_=function(n){var s=n.type,a=n.initSegment,c=n.map,h=n.playlist;if(c){var m=Bx(c);if(this.activeInitSegmentId_===m)return null;a=this.initSegmentForMap(c,!0).bytes,this.activeInitSegmentId_=m}return a&&this.appendInitSegment_[s]?(this.playlistOfLastInitSegment_[s]=h,this.appendInitSegment_[s]=!1,this.activeInitSegmentId_=null,a):null},t.handleQuotaExceededError_=function(n,s){var a=this,c=n.segmentInfo,h=n.type,m=n.bytes,v=this.sourceUpdater_.audioBuffered(),b=this.sourceUpdater_.videoBuffered();v.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+Nm(v).join(", ")),b.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+Nm(b).join(", "));var x=v.length?v.start(0):0,C=v.length?v.end(v.length-1):0,B=b.length?b.start(0):0,P=b.length?b.end(b.length-1):0;if(C-x<=qy&&P-B<=qy){this.logger_("On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. "+("Appended byte length: "+m.byteLength+", ")+("audio buffer: "+Nm(v).join(", ")+", ")+("video buffer: "+Nm(b).join(", ")+", ")),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:c,type:h,bytes:m}));var N=this.currentTime_(),ae=N-qy;this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to "+ae),this.remove(0,ae,function(){a.logger_("On QUOTA_EXCEEDED_ERR, retrying append in "+qy+"s"),a.waitingOnRemove_=!1,a.quotaExceededErrorRetryTimeout_=Z.setTimeout(function(){a.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),a.quotaExceededErrorRetryTimeout_=null,a.processCallQueue_()},qy*1e3)},!0)},t.handleAppendError_=function(n,s){var a=n.segmentInfo,c=n.type,h=n.bytes;if(s){if(s.code===LB){this.handleQuotaExceededError_({segmentInfo:a,type:c,bytes:h});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",s),this.error(c+" append of "+h.length+"b failed for segment "+("#"+a.mediaIndex+" in playlist "+a.playlist.id)),this.trigger("appenderror")}},t.appendToSourceBuffer_=function(n){var s=n.segmentInfo,a=n.type,c=n.initSegment,h=n.data,m=n.bytes;if(!m){var v=[h],b=h.byteLength;c&&(v.unshift(c),b+=c.byteLength),m=eX({bytes:b,segments:v})}this.sourceUpdater_.appendBuffer({segmentInfo:s,type:a,bytes:m},this.handleAppendError_.bind(this,{segmentInfo:s,type:a,bytes:m}))},t.handleSegmentTimingInfo_=function(n,s,a){if(!(!this.pendingSegment_||s!==this.pendingSegment_.requestId)){var c=this.pendingSegment_.segment,h=n+"TimingInfo";c[h]||(c[h]={}),c[h].transmuxerPrependedSeconds=a.prependedContentDuration||0,c[h].transmuxedPresentationStart=a.start.presentation,c[h].transmuxedDecodeStart=a.start.decode,c[h].transmuxedPresentationEnd=a.end.presentation,c[h].transmuxedDecodeEnd=a.end.decode,c[h].baseMediaDecodeTime=a.baseMediaDecodeTime}},t.appendData_=function(n,s){var a=s.type,c=s.data;if(!(!c||!c.byteLength)&&!(a==="audio"&&this.audioDisabled_)){var h=this.getInitSegmentAndUpdateState_({type:a,initSegment:s.initSegment,playlist:n.playlist,map:n.isFmp4?n.segment.map:null});this.appendToSourceBuffer_({segmentInfo:n,type:a,initSegment:h,data:c})}},t.loadSegment_=function(n){var s=this;if(this.state="WAITING",this.pendingSegment_=n,this.trimBackBuffer_(n),typeof n.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){this.loadQueue_.push(function(){var a=zr({},n,{forceTimestampOffset:!0});zr(n,s.generateSegmentInfo_(a)),s.isPendingTimestampOffset_=!1,s.updateTransmuxerAndRequestSegment_(n)});return}this.updateTransmuxerAndRequestSegment_(n)},t.updateTransmuxerAndRequestSegment_=function(n){var s=this;this.shouldUpdateTransmuxerTimestampOffset_(n.timestampOffset)&&(this.gopBuffer_.length=0,n.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:n.timestampOffset}));var a=this.createSimplifiedSegmentObj_(n),c=this.isEndOfStream_(n.mediaIndex,n.playlist,n.partIndex),h=this.mediaIndex!==null,m=n.timeline!==this.currentTimeline_&&n.timeline>0,v=c||h&&m;this.logger_("Requesting "+qg(n)),a.map&&!a.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),n.abortRequests=Wq({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:a,abortFn:this.handleAbort_.bind(this,n),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",n.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",n.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:v,endedTimelineFn:function(){s.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:function(x){var C=x.message,B=x.level,P=x.stream;s.logger_(qg(n)+" logged from transmuxer stream "+P+" as a "+B+": "+C)}})},t.trimBackBuffer_=function(n){var s=pX(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);s>0&&this.remove(0,s)},t.createSimplifiedSegmentObj_=function(n){var s=n.segment,a=n.part,c={resolvedUri:a?a.resolvedUri:s.resolvedUri,byterange:a?a.byterange:s.byterange,requestId:n.requestId,transmuxer:n.transmuxer,audioAppendStart:n.audioAppendStart,gopsToAlignWith:n.gopsToAlignWith,part:n.part},h=n.playlist.segments[n.mediaIndex-1];if(h&&h.timeline===s.timeline&&(h.videoTimingInfo?c.baseStartTime=h.videoTimingInfo.transmuxedDecodeEnd:h.audioTimingInfo&&(c.baseStartTime=h.audioTimingInfo.transmuxedDecodeEnd)),s.key){var m=s.key.iv||new Uint32Array([0,0,0,n.mediaIndex+n.playlist.mediaSequence]);c.key=this.segmentKey(s.key),c.key.iv=m}return s.map&&(c.map=this.initSegmentForMap(s.map)),c},t.saveTransferStats_=function(n){this.mediaRequests+=1,n&&(this.mediaBytesTransferred+=n.bytesReceived,this.mediaTransferDuration+=n.roundTripTime)},t.saveBandwidthRelatedStats_=function(n,s){if(this.pendingSegment_.byteLength=s.bytesReceived,n<cT){this.logger_("Ignoring segment's bandwidth because its duration of "+n+(" is less than the min to record "+cT));return}this.bandwidth=s.bandwidth,this.roundTrip=s.roundTripTime},t.handleTimeout_=function(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")},t.segmentRequestFinished_=function(n,s,a){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,n,s,a));return}if(this.saveTransferStats_(s.stats),!!this.pendingSegment_&&s.requestId===this.pendingSegment_.requestId){if(n){if(this.pendingSegment_=null,this.state="READY",n.code===mh.ABORTED)return;if(this.pause(),n.code===mh.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(n),this.trigger("error");return}var c=this.pendingSegment_;this.saveBandwidthRelatedStats_(c.duration,s.stats),c.endOfAllRequests=s.endOfAllRequests,a.gopInfo&&(this.gopBuffer_=lX(this.gopBuffer_,a.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(c)}},t.setTimeMapping_=function(n){var s=this.syncController_.mappingForTimeline(n);s!==null&&(this.timeMapping_=s)},t.updateMediaSecondsLoaded_=function(n){typeof n.start=="number"&&typeof n.end=="number"?this.mediaSecondsLoaded+=n.end-n.start:this.mediaSecondsLoaded+=n.duration},t.shouldUpdateTransmuxerTimestampOffset_=function(n){return n===null?!1:this.loaderType_==="main"&&n!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&n!==this.sourceUpdater_.audioTimestampOffset()},t.trueSegmentStart_=function(n){var s=n.currentStart,a=n.playlist,c=n.mediaIndex,h=n.firstVideoFrameTimeForData,m=n.currentVideoTimestampOffset,v=n.useVideoTimingInfo,b=n.videoTimingInfo,x=n.audioTimingInfo;if(typeof s<"u")return s;if(!v)return x.start;var C=a.segments[c-1];return c===0||!C||typeof C.start>"u"||C.end!==h+m?h:b.start},t.waitForAppendsToComplete_=function(n){var s=this.getCurrentMediaInfo_(n);if(!s){this.error({message:"No starting media returned, likely due to an unsupported media format.",blacklistDuration:1/0}),this.trigger("error");return}var a=s.hasAudio,c=s.hasVideo,h=s.isMuxed,m=this.loaderType_==="main"&&c,v=!this.audioDisabled_&&a&&!h;if(n.waitingOnAppends=0,!n.hasAppendedData_){!n.timingInfo&&typeof n.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),n.timingInfo={start:0},n.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(n),this.processMetadataQueue_()),this.checkAppendsDone_(n);return}m&&n.waitingOnAppends++,v&&n.waitingOnAppends++,m&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,n)),v&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,n))},t.checkAppendsDone_=function(n){this.checkForAbort_(n.requestId)||(n.waitingOnAppends--,n.waitingOnAppends===0&&this.handleAppendsDone_())},t.checkForIllegalMediaSwitch=function(n){var s=fX(this.loaderType_,this.getCurrentMediaInfo_(),n);return s?(this.error({message:s,blacklistDuration:1/0}),this.trigger("error"),!0):!1},t.updateSourceBufferTimestampOffset_=function(n){if(!(n.timestampOffset===null||typeof n.timingInfo.start!="number"||n.changedTimestampOffset||this.loaderType_!=="main")){var s=!1;n.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:n.segment.videoTimingInfo,audioTimingInfo:n.segment.audioTimingInfo,timingInfo:n.timingInfo}),n.changedTimestampOffset=!0,n.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(n.timestampOffset),s=!0),n.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(n.timestampOffset),s=!0),s&&this.trigger("timestampoffset")}},t.getSegmentStartTimeForTimestampOffsetCalculation_=function(n){var s=n.videoTimingInfo,a=n.audioTimingInfo,c=n.timingInfo;return this.useDtsForTimestampOffset_?s&&typeof s.transmuxedDecodeStart=="number"?s.transmuxedDecodeStart:a&&typeof a.transmuxedDecodeStart=="number"?a.transmuxedDecodeStart:c.start:c.start},t.updateTimingInfoEnd_=function(n){n.timingInfo=n.timingInfo||{};var s=this.getMediaInfo_(),a=this.loaderType_==="main"&&s&&s.hasVideo,c=a&&n.videoTimingInfo?n.videoTimingInfo:n.audioTimingInfo;c&&(n.timingInfo.end=typeof c.end=="number"?c.end:c.start+n.duration)},t.handleAppendsDone_=function(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}var n=this.pendingSegment_;this.updateTimingInfoEnd_(n),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:n,shouldSaveTimelineMapping:this.loaderType_==="main"});var s=vX(n,this.sourceType_);if(s&&(s.severity==="warn"?rt.log.warn(s.message):this.logger_(s.message)),this.recordThroughput_(n),this.pendingSegment_=null,this.state="READY",n.isSyncRequest&&(this.trigger("syncinfoupdate"),!n.hasAppendedData_)){this.logger_("Throwing away un-appended sync request "+qg(n));return}this.logger_("Appended "+qg(n)),this.addSegmentMetadataCue_(n),this.fetchAtBuffer_=!0,this.currentTimeline_!==n.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:n.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:n.timeline})),this.currentTimeline_=n.timeline,this.trigger("syncinfoupdate");var a=n.segment,c=n.part,h=a.end&&this.currentTime_()-a.end>n.playlist.targetDuration*3,m=c&&c.end&&this.currentTime_()-c.end>n.playlist.partTargetDuration*3;if(h||m){this.logger_("bad "+(h?"segment":"part")+" "+qg(n)),this.resetEverything();return}var v=this.mediaIndex!==null;v&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=n.mediaIndex,this.partIndex=n.partIndex,this.isEndOfStream_(n.mediaIndex,n.playlist,n.partIndex)&&this.endOfStream(),this.trigger("appended"),n.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()},t.recordThroughput_=function(n){if(n.duration<cT){this.logger_("Ignoring segment's throughput because its duration of "+n.duration+(" is less than the min to record "+cT));return}var s=this.throughput.rate,a=Date.now()-n.endOfAllRequests+1,c=Math.floor(n.byteLength/a*8*1e3);this.throughput.rate+=(c-s)/++this.throughput.count},t.addSegmentMetadataCue_=function(n){if(this.segmentMetadataTrack_){var s=n.segment,a=s.start,c=s.end;if(!(!mP(a)||!mP(c))){r_(a,c,this.segmentMetadataTrack_);var h=Z.WebKitDataCue||Z.VTTCue,m={custom:s.custom,dateTimeObject:s.dateTimeObject,dateTimeString:s.dateTimeString,bandwidth:n.playlist.attributes.BANDWIDTH,resolution:n.playlist.attributes.RESOLUTION,codecs:n.playlist.attributes.CODECS,byteLength:n.byteLength,uri:n.uri,timeline:n.timeline,playlist:n.playlist.id,start:a,end:c},v=JSON.stringify(m),b=new h(a,c,v);b.value=m,this.segmentMetadataTrack_.addCue(b)}}},e}(rt.EventTarget);function _f(){}var RB=function(e){return typeof e!="string"?e:e.replace(/./,function(t){return t.toUpperCase()})},yX=["video","audio"],n2=function(e,t){var i=t[e+"Buffer"];return i&&i.updating||t.queuePending[e]},_X=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];if(n.type==="mediaSource")return null;if(n.type===e)return i}return null},uM=function r(e,t){if(t.queue.length!==0){var i=0,n=t.queue[i];if(n.type==="mediaSource"){!t.updating()&&t.mediaSource.readyState!=="closed"&&(t.queue.shift(),n.action(t),n.doneFn&&n.doneFn(),r("audio",t),r("video",t));return}if(e!=="mediaSource"&&!(!t.ready()||t.mediaSource.readyState==="closed"||n2(e,t))){if(n.type!==e){if(i=_X(e,t.queue),i===null)return;n=t.queue[i]}if(t.queue.splice(i,1),t.queuePending[e]=n,n.action(e,t),!n.doneFn){t.queuePending[e]=null,r(e,t);return}}}},kB=function(e,t){var i=t[e+"Buffer"],n=RB(e);i&&(i.removeEventListener("updateend",t["on"+n+"UpdateEnd_"]),i.removeEventListener("error",t["on"+n+"Error_"]),t.codecs[e]=null,t[e+"Buffer"]=null)},eh=function(e,t){return e&&t&&Array.prototype.indexOf.call(e.sourceBuffers,t)!==-1},Fu={appendBuffer:function(e,t,i){return function(n,s){var a=s[n+"Buffer"];if(eh(s.mediaSource,a)){s.logger_("Appending segment "+t.mediaIndex+"'s "+e.length+" bytes to "+n+"Buffer");try{a.appendBuffer(e)}catch(c){s.logger_("Error with code "+c.code+" "+(c.code===LB?"(QUOTA_EXCEEDED_ERR) ":"")+("when appending segment "+t.mediaIndex+" to "+n+"Buffer")),s.queuePending[n]=null,i(c)}}}},remove:function(e,t){return function(i,n){var s=n[i+"Buffer"];if(eh(n.mediaSource,s)){n.logger_("Removing "+e+" to "+t+" from "+i+"Buffer");try{s.remove(e,t)}catch{n.logger_("Remove "+e+" to "+t+" from "+i+"Buffer failed")}}}},timestampOffset:function(e){return function(t,i){var n=i[t+"Buffer"];eh(i.mediaSource,n)&&(i.logger_("Setting "+t+"timestampOffset to "+e),n.timestampOffset=e)}},callback:function(e){return function(t,i){e()}},endOfStream:function(e){return function(t){if(t.mediaSource.readyState==="open"){t.logger_("Calling mediaSource endOfStream("+(e||"")+")");try{t.mediaSource.endOfStream(e)}catch(i){rt.log.warn("Failed to call media source endOfStream",i)}}}},duration:function(e){return function(t){t.logger_("Setting mediaSource duration to "+e);try{t.mediaSource.duration=e}catch(i){rt.log.warn("Failed to set media source duration",i)}}},abort:function(){return function(e,t){if(t.mediaSource.readyState==="open"){var i=t[e+"Buffer"];if(eh(t.mediaSource,i)){t.logger_("calling abort on "+e+"Buffer");try{i.abort()}catch(n){rt.log.warn("Failed to abort on "+e+"Buffer",n)}}}}},addSourceBuffer:function(e,t){return function(i){var n=RB(e),s=I_(t);i.logger_("Adding "+e+"Buffer with codec "+t+" to mediaSource");var a=i.mediaSource.addSourceBuffer(s);a.addEventListener("updateend",i["on"+n+"UpdateEnd_"]),a.addEventListener("error",i["on"+n+"Error_"]),i.codecs[e]=t,i[e+"Buffer"]=a}},removeSourceBuffer:function(e){return function(t){var i=t[e+"Buffer"];if(kB(e,t),!!eh(t.mediaSource,i)){t.logger_("Removing "+e+"Buffer with codec "+t.codecs[e]+" from mediaSource");try{t.mediaSource.removeSourceBuffer(i)}catch(n){rt.log.warn("Failed to removeSourceBuffer "+e+"Buffer",n)}}}},changeType:function(e){return function(t,i){var n=i[t+"Buffer"],s=I_(e);if(eh(i.mediaSource,n)&&i.codecs[t]!==e){i.logger_("changing "+t+"Buffer codec from "+i.codecs[t]+" to "+e);try{n.changeType(s),i.codecs[t]=e}catch(a){rt.log.warn("Failed to changeType on "+t+"Buffer",a)}}}}},Bu=function(e){var t=e.type,i=e.sourceUpdater,n=e.action,s=e.doneFn,a=e.name;i.queue.push({type:t,action:n,doneFn:s,name:a}),uM(t,i)},_P=function(e,t){return function(i){if(t.queuePending[e]){var n=t.queuePending[e].doneFn;t.queuePending[e]=null,n&&n(t[e+"Error_"])}uM(e,t)}},OB=function(r){mi(e,r);function e(i){var n;return n=r.call(this)||this,n.mediaSource=i,n.sourceopenListener_=function(){return uM("mediaSource",Tn(n))},n.mediaSource.addEventListener("sourceopen",n.sourceopenListener_),n.logger_=td("SourceUpdater"),n.audioTimestampOffset_=0,n.videoTimestampOffset_=0,n.queue=[],n.queuePending={audio:null,video:null},n.delayedAudioAppendQueue_=[],n.videoAppendQueued_=!1,n.codecs={},n.onVideoUpdateEnd_=_P("video",Tn(n)),n.onAudioUpdateEnd_=_P("audio",Tn(n)),n.onVideoError_=function(s){n.videoError_=s},n.onAudioError_=function(s){n.audioError_=s},n.createdSourceBuffers_=!1,n.initializedEme_=!1,n.triggeredReady_=!1,n}var t=e.prototype;return t.initializedEme=function(){this.initializedEme_=!0,this.triggerReady()},t.hasCreatedSourceBuffers=function(){return this.createdSourceBuffers_},t.hasInitializedAnyEme=function(){return this.initializedEme_},t.ready=function(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()},t.createSourceBuffers=function(n){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(n),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())},t.triggerReady=function(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))},t.addSourceBuffer=function(n,s){Bu({type:"mediaSource",sourceUpdater:this,action:Fu.addSourceBuffer(n,s),name:"addSourceBuffer"})},t.abort=function(n){Bu({type:n,sourceUpdater:this,action:Fu.abort(n),name:"abort"})},t.removeSourceBuffer=function(n){if(!this.canRemoveSourceBuffer()){rt.log.error("removeSourceBuffer is not supported!");return}Bu({type:"mediaSource",sourceUpdater:this,action:Fu.removeSourceBuffer(n),name:"removeSourceBuffer"})},t.canRemoveSourceBuffer=function(){return!rt.browser.IE_VERSION&&!rt.browser.IS_FIREFOX&&Z.MediaSource&&Z.MediaSource.prototype&&typeof Z.MediaSource.prototype.removeSourceBuffer=="function"},e.canChangeType=function(){return Z.SourceBuffer&&Z.SourceBuffer.prototype&&typeof Z.SourceBuffer.prototype.changeType=="function"},t.canChangeType=function(){return this.constructor.canChangeType()},t.changeType=function(n,s){if(!this.canChangeType()){rt.log.error("changeType is not supported!");return}Bu({type:n,sourceUpdater:this,action:Fu.changeType(s),name:"changeType"})},t.addOrChangeSourceBuffers=function(n){var s=this;if(!n||typeof n!="object"||Object.keys(n).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(n).forEach(function(a){var c=n[a];if(!s.hasCreatedSourceBuffers())return s.addSourceBuffer(a,c);s.canChangeType()&&s.changeType(a,c)})},t.appendBuffer=function(n,s){var a=this,c=n.segmentInfo,h=n.type,m=n.bytes;if(this.processedAppend_=!0,h==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([n,s]),this.logger_("delayed audio append of "+m.length+" until video append");return}var v=s;if(Bu({type:h,sourceUpdater:this,action:Fu.appendBuffer(m,c||{mediaIndex:-1},v),doneFn:s,name:"appendBuffer"}),h==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;var b=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio "+b.length+" appendBuffers"),this.delayedAudioAppendQueue_.length=0,b.forEach(function(x){a.appendBuffer.apply(a,x)})}},t.audioBuffered=function(){return eh(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:rt.createTimeRange()},t.videoBuffered=function(){return eh(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:rt.createTimeRange()},t.buffered=function(){var n=eh(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,s=eh(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return s&&!n?this.audioBuffered():n&&!s?this.videoBuffered():BW(this.audioBuffered(),this.videoBuffered())},t.setDuration=function(n,s){s===void 0&&(s=_f),Bu({type:"mediaSource",sourceUpdater:this,action:Fu.duration(n),name:"duration",doneFn:s})},t.endOfStream=function(n,s){n===void 0&&(n=null),s===void 0&&(s=_f),typeof n!="string"&&(n=void 0),Bu({type:"mediaSource",sourceUpdater:this,action:Fu.endOfStream(n),name:"endOfStream",doneFn:s})},t.removeAudio=function(n,s,a){if(a===void 0&&(a=_f),!this.audioBuffered().length||this.audioBuffered().end(0)===0){a();return}Bu({type:"audio",sourceUpdater:this,action:Fu.remove(n,s),doneFn:a,name:"remove"})},t.removeVideo=function(n,s,a){if(a===void 0&&(a=_f),!this.videoBuffered().length||this.videoBuffered().end(0)===0){a();return}Bu({type:"video",sourceUpdater:this,action:Fu.remove(n,s),doneFn:a,name:"remove"})},t.updating=function(){return!!(n2("audio",this)||n2("video",this))},t.audioTimestampOffset=function(n){return typeof n<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==n&&(Bu({type:"audio",sourceUpdater:this,action:Fu.timestampOffset(n),name:"timestampOffset"}),this.audioTimestampOffset_=n),this.audioTimestampOffset_},t.videoTimestampOffset=function(n){return typeof n<"u"&&this.videoBuffer&&this.videoTimestampOffset!==n&&(Bu({type:"video",sourceUpdater:this,action:Fu.timestampOffset(n),name:"timestampOffset"}),this.videoTimestampOffset_=n),this.videoTimestampOffset_},t.audioQueueCallback=function(n){this.audioBuffer&&Bu({type:"audio",sourceUpdater:this,action:Fu.callback(n),name:"callback"})},t.videoQueueCallback=function(n){this.videoBuffer&&Bu({type:"video",sourceUpdater:this,action:Fu.callback(n),name:"callback"})},t.dispose=function(){var n=this;this.trigger("dispose"),yX.forEach(function(s){n.abort(s),n.canRemoveSourceBuffer()?n.removeSourceBuffer(s):n[s+"QueueCallback"](function(){return kB(s,n)})}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()},e}(rt.EventTarget),bP=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))},TP=new Uint8Array(`

`.split("").map(function(r){return r.charCodeAt(0)})),bX=function(r){mi(e,r);function e(){return r.call(this,"Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")||this}return e}(NE(Error)),TX=function(r){mi(e,r);function e(i,n){var s;return n===void 0&&(n={}),s=r.call(this,i,n)||this,s.mediaSource_=null,s.subtitlesTrack_=null,s.loaderType_="subtitle",s.featuresNativeTextTracks_=i.featuresNativeTextTracks,s.loadVttJs=i.loadVttJs,s.shouldSaveSegmentTimingInfo_=!1,s}var t=e.prototype;return t.createTransmuxer_=function(){return null},t.buffered_=function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return rt.createTimeRanges();var n=this.subtitlesTrack_.cues,s=n[0].startTime,a=n[n.length-1].startTime;return rt.createTimeRanges([[s,a]])},t.initSegmentForMap=function(n,s){if(s===void 0&&(s=!1),!n)return null;var a=Bx(n),c=this.initSegments_[a];if(s&&!c&&n.bytes){var h=TP.byteLength+n.bytes.byteLength,m=new Uint8Array(h);m.set(n.bytes),m.set(TP,n.bytes.byteLength),this.initSegments_[a]=c={resolvedUri:n.resolvedUri,byterange:n.byterange,bytes:m}}return c||n},t.couldBeginLoading_=function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()},t.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},t.track=function(n){return typeof n>"u"?this.subtitlesTrack_:(this.subtitlesTrack_=n,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)},t.remove=function(n,s){r_(n,s,this.subtitlesTrack_)},t.fillBuffer_=function(){var n=this,s=this.chooseNextRequest_();if(s){if(this.syncController_.timestampOffsetForTimeline(s.timeline)===null){var a=function(){n.state="READY",n.paused()||n.monitorBuffer_()};this.syncController_.one("timestampoffset",a),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(s)}},t.timestampOffsetForSegment_=function(){return null},t.chooseNextRequest_=function(){return this.skipEmptySegments_(r.prototype.chooseNextRequest_.call(this))},t.skipEmptySegments_=function(n){for(;n&&n.segment.empty;){if(n.mediaIndex+1>=n.playlist.segments.length){n=null;break}n=this.generateSegmentInfo_({playlist:n.playlist,mediaIndex:n.mediaIndex+1,startOfSegment:n.startOfSegment+n.duration,isSyncRequest:n.isSyncRequest})}return n},t.stopForError=function(n){this.error(n),this.state="READY",this.pause(),this.trigger("error")},t.segmentRequestFinished_=function(n,s,a){var c=this;if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(s.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(n){n.code===mh.TIMEOUT&&this.handleTimeout_(),n.code===mh.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(n);return}var h=this.pendingSegment_;this.saveBandwidthRelatedStats_(h.duration,s.stats),s.key&&this.segmentKey(s.key,!0),this.state="APPENDING",this.trigger("appending");var m=h.segment;if(m.map&&(m.map.bytes=s.map.bytes),h.bytes=s.bytes,typeof Z.WebVTT!="function"&&typeof this.loadVttJs=="function"){this.state="WAITING_ON_VTTJS",this.loadVttJs().then(function(){return c.segmentRequestFinished_(n,s,a)},function(){return c.stopForError({message:"Error loading vtt.js"})});return}m.requested=!0;try{this.parseVTTCues_(h)}catch(v){this.stopForError({message:v.message});return}if(this.updateTimeMapping_(h,this.syncController_.timelines[h.timeline],this.playlist_),h.cues.length?h.timingInfo={start:h.cues[0].startTime,end:h.cues[h.cues.length-1].endTime}:h.timingInfo={start:h.startOfSegment,end:h.startOfSegment+h.duration},h.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}h.byteLength=h.bytes.byteLength,this.mediaSecondsLoaded+=m.duration,h.cues.forEach(function(v){c.subtitlesTrack_.addCue(c.featuresNativeTextTracks_?new Z.VTTCue(v.startTime,v.endTime,v.text):v)}),aX(this.subtitlesTrack_),this.handleAppendsDone_()},t.handleData_=function(){},t.updateTimingInfoEnd_=function(){},t.parseVTTCues_=function(n){var s,a=!1;if(typeof Z.WebVTT!="function")throw new bX;typeof Z.TextDecoder=="function"?s=new Z.TextDecoder("utf8"):(s=Z.WebVTT.StringDecoder(),a=!0);var c=new Z.WebVTT.Parser(Z,Z.vttjs,s);if(n.cues=[],n.timestampmap={MPEGTS:0,LOCAL:0},c.oncue=n.cues.push.bind(n.cues),c.ontimestampmap=function(v){n.timestampmap=v},c.onparsingerror=function(v){rt.log.warn("Error encountered when parsing cues: "+v.message)},n.segment.map){var h=n.segment.map.bytes;a&&(h=bP(h)),c.parse(h)}var m=n.bytes;a&&(m=bP(m)),c.parse(m),c.flush()},t.updateTimeMapping_=function(n,s,a){var c=n.segment;if(s){if(!n.cues.length){c.empty=!0;return}var h=n.timestampmap,m=h.MPEGTS/wx.ONE_SECOND_IN_TS-h.LOCAL+s.mapping;if(n.cues.forEach(function(x){x.startTime+=m,x.endTime+=m}),!a.syncInfo){var v=n.cues[0].startTime,b=n.cues[n.cues.length-1].startTime;a.syncInfo={mediaSequence:a.mediaSequence+n.mediaIndex,time:Math.min(v,b-c.duration)}}}},e}(i2),xX=function(e,t){for(var i=e.cues,n=0;n<i.length;n++){var s=i[n];if(t>=s.adStartTime&&t<=s.adEndTime)return s}return null},SX=function(e,t,i){if(i===void 0&&(i=0),!!e.segments)for(var n=i,s,a=0;a<e.segments.length;a++){var c=e.segments[a];if(s||(s=xX(t,n+c.duration/2)),s){if("cueIn"in c){s.endTime=n,s.adEndTime=n,n+=c.duration,s=null;continue}if(n<s.endTime){n+=c.duration;continue}s.endTime+=c.duration}else if("cueOut"in c&&(s=new Z.VTTCue(n,n+c.duration,c.cueOut),s.adStartTime=n,s.adEndTime=n+parseFloat(c.cueOut),t.addCue(s)),"cueOutCont"in c){var h=c.cueOutCont.split("/").map(parseFloat),m=h[0],v=h[1];s=new Z.VTTCue(n,n+c.duration,""),s.adStartTime=n-m,s.adEndTime=s.adStartTime+v,t.addCue(s)}n+=c.duration}},AX=86400,xP=[{name:"VOD",run:function(e,t,i,n,s){if(i!==1/0){var a={time:0,segmentIndex:0,partIndex:null};return a}return null}},{name:"ProgramDateTime",run:function(e,t,i,n,s){if(!Object.keys(e.timelineToDatetimeMappings).length)return null;var a=null,c=null,h=XE(t);s=s||0;for(var m=0;m<h.length;m++){var v=t.endList||s===0?m:h.length-(m+1),b=h[v],x=b.segment,C=e.timelineToDatetimeMappings[x.timeline];if(!(!C||!x.dateTimeObject)){var B=x.dateTimeObject.getTime()/1e3,P=B+C;if(x.parts&&typeof b.partIndex=="number")for(var N=0;N<b.partIndex;N++)P+=x.parts[N].duration;var ae=Math.abs(s-P);if(c!==null&&(ae===0||c<ae))break;c=ae,a={time:P,segmentIndex:b.segmentIndex,partIndex:b.partIndex}}}return a}},{name:"Segment",run:function(e,t,i,n,s){var a=null,c=null;s=s||0;for(var h=XE(t),m=0;m<h.length;m++){var v=t.endList||s===0?m:h.length-(m+1),b=h[v],x=b.segment,C=b.part&&b.part.start||x&&x.start;if(x.timeline===n&&typeof C<"u"){var B=Math.abs(s-C);if(c!==null&&c<B)break;(!a||c===null||c>=B)&&(c=B,a={time:C,segmentIndex:b.segmentIndex,partIndex:b.partIndex})}}return a}},{name:"Discontinuity",run:function(e,t,i,n,s){var a=null;if(s=s||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var c=null,h=0;h<t.discontinuityStarts.length;h++){var m=t.discontinuityStarts[h],v=t.discontinuitySequence+h+1,b=e.discontinuities[v];if(b){var x=Math.abs(s-b.time);if(c!==null&&c<x)break;(!a||c===null||c>=x)&&(c=x,a={time:b.time,segmentIndex:m,partIndex:null})}}return a}},{name:"Playlist",run:function(e,t,i,n,s){if(t.syncInfo){var a={time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence,partIndex:null};return a}return null}}],wX=function(r){mi(e,r);function e(i){var n;return n=r.call(this)||this,n.timelines=[],n.discontinuities=[],n.timelineToDatetimeMappings={},n.logger_=td("SyncController"),n}var t=e.prototype;return t.getSyncPoint=function(n,s,a,c){var h=this.runStrategies_(n,s,a,c);return h.length?this.selectSyncPoint_(h,{key:"time",value:c}):null},t.getExpiredTime=function(n,s){if(!n||!n.segments)return null;var a=this.runStrategies_(n,s,n.discontinuitySequence,0);if(!a.length)return null;var c=this.selectSyncPoint_(a,{key:"segmentIndex",value:0});return c.segmentIndex>0&&(c.time*=-1),Math.abs(c.time+g_({defaultDuration:n.targetDuration,durationList:n.segments,startIndex:c.segmentIndex,endIndex:0}))},t.runStrategies_=function(n,s,a,c){for(var h=[],m=0;m<xP.length;m++){var v=xP[m],b=v.run(this,n,s,a,c);b&&(b.strategy=v.name,h.push({strategy:v.name,syncPoint:b}))}return h},t.selectSyncPoint_=function(n,s){for(var a=n[0].syncPoint,c=Math.abs(n[0].syncPoint[s.key]-s.value),h=n[0].strategy,m=1;m<n.length;m++){var v=Math.abs(n[m].syncPoint[s.key]-s.value);v<c&&(c=v,a=n[m].syncPoint,h=n[m].strategy)}return this.logger_("syncPoint for ["+s.key+": "+s.value+"] chosen with strategy"+(" ["+h+"]: [time:"+a.time+",")+(" segmentIndex:"+a.segmentIndex)+(typeof a.partIndex=="number"?",partIndex:"+a.partIndex:"")+"]"),a},t.saveExpiredSegmentInfo=function(n,s){var a=s.mediaSequence-n.mediaSequence;if(a>AX){rt.log.warn("Not saving expired segment info. Media sequence gap "+a+" is too large.");return}for(var c=a-1;c>=0;c--){var h=n.segments[c];if(h&&typeof h.start<"u"){s.syncInfo={mediaSequence:n.mediaSequence+c,time:h.start},this.logger_("playlist refresh sync: [time:"+s.syncInfo.time+","+(" mediaSequence: "+s.syncInfo.mediaSequence+"]")),this.trigger("syncinfoupdate");break}}},t.setDateTimeMappingForStart=function(n){if(this.timelineToDatetimeMappings={},n.segments&&n.segments.length&&n.segments[0].dateTimeObject){var s=n.segments[0],a=s.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[s.timeline]=-a}},t.saveSegmentTimingInfo=function(n){var s=n.segmentInfo,a=n.shouldSaveTimelineMapping,c=this.calculateSegmentTimeMapping_(s,s.timingInfo,a),h=s.segment;c&&(this.saveDiscontinuitySyncInfo_(s),s.playlist.syncInfo||(s.playlist.syncInfo={mediaSequence:s.playlist.mediaSequence+s.mediaIndex,time:h.start}));var m=h.dateTimeObject;h.discontinuity&&a&&m&&(this.timelineToDatetimeMappings[h.timeline]=-(m.getTime()/1e3))},t.timestampOffsetForTimeline=function(n){return typeof this.timelines[n]>"u"?null:this.timelines[n].time},t.mappingForTimeline=function(n){return typeof this.timelines[n]>"u"?null:this.timelines[n].mapping},t.calculateSegmentTimeMapping_=function(n,s,a){var c=n.segment,h=n.part,m=this.timelines[n.timeline],v,b;if(typeof n.timestampOffset=="number")m={time:n.startOfSegment,mapping:n.startOfSegment-s.start},a&&(this.timelines[n.timeline]=m,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+n.timeline+": "+("[time: "+m.time+"] [mapping: "+m.mapping+"]"))),v=n.startOfSegment,b=s.end+m.mapping;else if(m)v=s.start+m.mapping,b=s.end+m.mapping;else return!1;return h&&(h.start=v,h.end=b),(!c.start||v<c.start)&&(c.start=v),c.end=b,!0},t.saveDiscontinuitySyncInfo_=function(n){var s=n.playlist,a=n.segment;if(a.discontinuity)this.discontinuities[a.timeline]={time:a.start,accuracy:0};else if(s.discontinuityStarts&&s.discontinuityStarts.length)for(var c=0;c<s.discontinuityStarts.length;c++){var h=s.discontinuityStarts[c],m=s.discontinuitySequence+c+1,v=h-n.mediaIndex,b=Math.abs(v);if(!this.discontinuities[m]||this.discontinuities[m].accuracy>b){var x=void 0;v<0?x=a.start-g_({defaultDuration:s.targetDuration,durationList:s.segments,startIndex:n.mediaIndex,endIndex:h}):x=a.end+g_({defaultDuration:s.targetDuration,durationList:s.segments,startIndex:n.mediaIndex+1,endIndex:h}),this.discontinuities[m]={time:x,accuracy:b}}}},t.dispose=function(){this.trigger("dispose"),this.off()},e}(rt.EventTarget),EX=function(r){mi(e,r);function e(){var i;return i=r.call(this)||this,i.pendingTimelineChanges_={},i.lastTimelineChanges_={},i}var t=e.prototype;return t.clearPendingTimelineChange=function(n){this.pendingTimelineChanges_[n]=null,this.trigger("pendingtimelinechange")},t.pendingTimelineChange=function(n){var s=n.type,a=n.from,c=n.to;return typeof a=="number"&&typeof c=="number"&&(this.pendingTimelineChanges_[s]={type:s,from:a,to:c},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[s]},t.lastTimelineChange=function(n){var s=n.type,a=n.from,c=n.to;return typeof a=="number"&&typeof c=="number"&&(this.lastTimelineChanges_[s]={type:s,from:a,to:c},delete this.pendingTimelineChanges_[s],this.trigger("timelinechange")),this.lastTimelineChanges_[s]},t.dispose=function(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()},e}(rt.EventTarget),CX=TB(xB(function(){var r=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function e(ge,ue,be){return be={path:ue,exports:{},require:function(ve,ie){return t(ve,ie??be.path)}},ge(be,be.exports),be.exports}function t(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var i=e(function(ge){function ue(fe,ve){for(var ie=0;ie<ve.length;ie++){var re=ve[ie];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(fe,re.key,re)}}function be(fe,ve,ie){return ve&&ue(fe.prototype,ve),ie&&ue(fe,ie),fe}ge.exports=be,ge.exports.default=ge.exports,ge.exports.__esModule=!0}),n=e(function(ge){function ue(be,fe){return ge.exports=ue=Object.setPrototypeOf||function(ie,re){return ie.__proto__=re,ie},ge.exports.default=ge.exports,ge.exports.__esModule=!0,ue(be,fe)}ge.exports=ue,ge.exports.default=ge.exports,ge.exports.__esModule=!0}),s=e(function(ge){function ue(be,fe){be.prototype=Object.create(fe.prototype),be.prototype.constructor=be,n(be,fe)}ge.exports=ue,ge.exports.default=ge.exports,ge.exports.__esModule=!0}),a=function(){function ge(){this.listeners={}}var ue=ge.prototype;return ue.on=function(fe,ve){this.listeners[fe]||(this.listeners[fe]=[]),this.listeners[fe].push(ve)},ue.off=function(fe,ve){if(!this.listeners[fe])return!1;var ie=this.listeners[fe].indexOf(ve);return this.listeners[fe]=this.listeners[fe].slice(0),this.listeners[fe].splice(ie,1),ie>-1},ue.trigger=function(fe){var ve=this.listeners[fe];if(ve)if(arguments.length===2)for(var ie=ve.length,re=0;re<ie;++re)ve[re].call(this,arguments[1]);else for(var Ne=Array.prototype.slice.call(arguments,1),De=ve.length,ke=0;ke<De;++ke)ve[ke].apply(this,Ne)},ue.dispose=function(){this.listeners={}},ue.pipe=function(fe){this.on("data",function(ve){fe.push(ve)})},ge}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function c(ge){return ge.subarray(0,ge.byteLength-ge[ge.byteLength-1])}/*! @name aes-decrypter @version 3.1.3 @license Apache-2.0 */var h=function(){var ue=[[[],[],[],[],[]],[[],[],[],[],[]]],be=ue[0],fe=ue[1],ve=be[4],ie=fe[4],re,Ne,De,ke=[],ut=[],_t,vt,tt,je,it,Xe;for(re=0;re<256;re++)ut[(ke[re]=re<<1^(re>>7)*283)^re]=re;for(Ne=De=0;!ve[Ne];Ne^=_t||1,De=ut[De]||1)for(je=De^De<<1^De<<2^De<<3^De<<4,je=je>>8^je&255^99,ve[Ne]=je,ie[je]=Ne,tt=ke[vt=ke[_t=ke[Ne]]],Xe=tt*16843009^vt*65537^_t*257^Ne*16843008,it=ke[je]*257^je*16843008,re=0;re<4;re++)be[re][Ne]=it=it<<24^it>>>8,fe[re][je]=Xe=Xe<<24^Xe>>>8;for(re=0;re<5;re++)be[re]=be[re].slice(0),fe[re]=fe[re].slice(0);return ue},m=null,v=function(){function ge(be){m||(m=h()),this._tables=[[m[0][0].slice(),m[0][1].slice(),m[0][2].slice(),m[0][3].slice(),m[0][4].slice()],[m[1][0].slice(),m[1][1].slice(),m[1][2].slice(),m[1][3].slice(),m[1][4].slice()]];var fe,ve,ie,re=this._tables[0][4],Ne=this._tables[1],De=be.length,ke=1;if(De!==4&&De!==6&&De!==8)throw new Error("Invalid aes key size");var ut=be.slice(0),_t=[];for(this._key=[ut,_t],fe=De;fe<4*De+28;fe++)ie=ut[fe-1],(fe%De===0||De===8&&fe%De===4)&&(ie=re[ie>>>24]<<24^re[ie>>16&255]<<16^re[ie>>8&255]<<8^re[ie&255],fe%De===0&&(ie=ie<<8^ie>>>24^ke<<24,ke=ke<<1^(ke>>7)*283)),ut[fe]=ut[fe-De]^ie;for(ve=0;fe;ve++,fe--)ie=ut[ve&3?fe:fe-4],fe<=4||ve<4?_t[ve]=ie:_t[ve]=Ne[0][re[ie>>>24]]^Ne[1][re[ie>>16&255]]^Ne[2][re[ie>>8&255]]^Ne[3][re[ie&255]]}var ue=ge.prototype;return ue.decrypt=function(fe,ve,ie,re,Ne,De){var ke=this._key[1],ut=fe^ke[0],_t=re^ke[1],vt=ie^ke[2],tt=ve^ke[3],je,it,Xe,Se=ke.length/4-2,ct,xt=4,ii=this._tables[1],Re=ii[0],lt=ii[1],bt=ii[2],Je=ii[3],Dt=ii[4];for(ct=0;ct<Se;ct++)je=Re[ut>>>24]^lt[_t>>16&255]^bt[vt>>8&255]^Je[tt&255]^ke[xt],it=Re[_t>>>24]^lt[vt>>16&255]^bt[tt>>8&255]^Je[ut&255]^ke[xt+1],Xe=Re[vt>>>24]^lt[tt>>16&255]^bt[ut>>8&255]^Je[_t&255]^ke[xt+2],tt=Re[tt>>>24]^lt[ut>>16&255]^bt[_t>>8&255]^Je[vt&255]^ke[xt+3],xt+=4,ut=je,_t=it,vt=Xe;for(ct=0;ct<4;ct++)Ne[(3&-ct)+De]=Dt[ut>>>24]<<24^Dt[_t>>16&255]<<16^Dt[vt>>8&255]<<8^Dt[tt&255]^ke[xt++],je=ut,ut=_t,_t=vt,vt=tt,tt=je},ge}(),b=function(ge){s(ue,ge);function ue(){var fe;return fe=ge.call(this,a)||this,fe.jobs=[],fe.delay=1,fe.timeout_=null,fe}var be=ue.prototype;return be.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},be.push=function(ve){this.jobs.push(ve),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},ue}(a),x=function(ue){return ue<<24|(ue&65280)<<8|(ue&16711680)>>8|ue>>>24},C=function(ue,be,fe){var ve=new Int32Array(ue.buffer,ue.byteOffset,ue.byteLength>>2),ie=new v(Array.prototype.slice.call(be)),re=new Uint8Array(ue.byteLength),Ne=new Int32Array(re.buffer),De,ke,ut,_t,vt,tt,je,it,Xe;for(De=fe[0],ke=fe[1],ut=fe[2],_t=fe[3],Xe=0;Xe<ve.length;Xe+=4)vt=x(ve[Xe]),tt=x(ve[Xe+1]),je=x(ve[Xe+2]),it=x(ve[Xe+3]),ie.decrypt(vt,tt,je,it,Ne,Xe),Ne[Xe]=x(Ne[Xe]^De),Ne[Xe+1]=x(Ne[Xe+1]^ke),Ne[Xe+2]=x(Ne[Xe+2]^ut),Ne[Xe+3]=x(Ne[Xe+3]^_t),De=vt,ke=tt,ut=je,_t=it;return re},B=function(){function ge(be,fe,ve,ie){var re=ge.STEP,Ne=new Int32Array(be.buffer),De=new Uint8Array(be.byteLength),ke=0;for(this.asyncStream_=new b,this.asyncStream_.push(this.decryptChunk_(Ne.subarray(ke,ke+re),fe,ve,De)),ke=re;ke<Ne.length;ke+=re)ve=new Uint32Array([x(Ne[ke-4]),x(Ne[ke-3]),x(Ne[ke-2]),x(Ne[ke-1])]),this.asyncStream_.push(this.decryptChunk_(Ne.subarray(ke,ke+re),fe,ve,De));this.asyncStream_.push(function(){ie(null,c(De))})}var ue=ge.prototype;return ue.decryptChunk_=function(fe,ve,ie,re){return function(){var Ne=C(fe,ve,ie);re.set(Ne,fe.byteOffset)}},i(ge,null,[{key:"STEP",get:function(){return 32e3}}]),ge}(),P;typeof window<"u"?P=window:typeof r<"u"?P=r:typeof self<"u"?P=self:P={};var N=P,ae=function(ue){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(ue):ue&&ue.buffer instanceof ArrayBuffer},X=N.BigInt||Number;X("0x1"),X("0x100"),X("0x10000"),X("0x1000000"),X("0x100000000"),X("0x10000000000"),X("0x1000000000000"),X("0x100000000000000"),X("0x10000000000000000");var de=function(ue){var be={};return Object.keys(ue).forEach(function(fe){var ve=ue[fe];ae(ve)?be[fe]={bytes:ve.buffer,byteOffset:ve.byteOffset,byteLength:ve.byteLength}:be[fe]=ve}),be};self.onmessage=function(ge){var ue=ge.data,be=new Uint8Array(ue.encrypted.bytes,ue.encrypted.byteOffset,ue.encrypted.byteLength),fe=new Uint32Array(ue.key.bytes,ue.key.byteOffset,ue.key.byteLength/4),ve=new Uint32Array(ue.iv.bytes,ue.iv.byteOffset,ue.iv.byteLength/4);new B(be,fe,ve,function(ie,re){self.postMessage(de({source:ue.source,decrypted:re}),[re.buffer])})}})),MX=bB(CX),DX=function(e){var t=e.default?"main":"alternative";return e.characteristics&&e.characteristics.indexOf("public.accessibility.describes-video")>=0&&(t="main-desc"),t},zx=function(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)},r2=function(e,t){t.activePlaylistLoader=e,e.load()},IX=function(e,t){return function(){var i=t.segmentLoaders,n=i[e],s=i.main,a=t.mediaTypes[e],c=a.activeTrack(),h=a.getActiveGroup(),m=a.activePlaylistLoader,v=a.lastGroup_;if(!(h&&v&&h.id===v.id)&&(a.lastGroup_=h,a.lastTrack_=c,zx(n,a),!(!h||h.isMasterPlaylist))){if(!h.playlistLoader){m&&s.resetEverything();return}n.resyncLoader(),r2(h.playlistLoader,a)}}},PX=function(e,t){return function(){var i=t.segmentLoaders[e],n=t.mediaTypes[e];n.lastGroup_=null,i.abort(),i.pause()}},LX=function(e,t){return function(){var i=t.masterPlaylistLoader,n=t.segmentLoaders,s=n[e],a=n.main,c=t.mediaTypes[e],h=c.activeTrack(),m=c.getActiveGroup(),v=c.activePlaylistLoader,b=c.lastTrack_;if(!(b&&h&&b.id===h.id)&&(c.lastGroup_=m,c.lastTrack_=h,zx(s,c),!!m)){if(m.isMasterPlaylist){if(!h||!b||h.id===b.id)return;var x=t.vhs.masterPlaylistController_,C=x.selectPlaylist();if(x.media()===C)return;c.logger_("track change. Switching master audio from "+b.id+" to "+h.id),i.pause(),a.resetEverything(),x.fastQualityChange_(C);return}if(e==="AUDIO"){if(!m.playlistLoader){a.setAudio(!0),a.resetEverything();return}s.setAudio(!0),a.setAudio(!1)}if(v===m.playlistLoader){r2(m.playlistLoader,c);return}s.track&&s.track(h),s.resetEverything(),r2(m.playlistLoader,c)}}},Hx={AUDIO:function(e,t){return function(){var i=t.segmentLoaders[e],n=t.mediaTypes[e],s=t.blacklistCurrentPlaylist;zx(i,n);var a=n.activeTrack(),c=n.activeGroup(),h=(c.filter(function(b){return b.default})[0]||c[0]).id,m=n.tracks[h];if(a===m){s({message:"Problem encountered loading the default audio track."});return}rt.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(var v in n.tracks)n.tracks[v].enabled=n.tracks[v]===m;n.onTrackChanged()}},SUBTITLES:function(e,t){return function(){var i=t.segmentLoaders[e],n=t.mediaTypes[e];rt.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),zx(i,n);var s=n.activeTrack();s&&(s.mode="disabled"),n.onTrackChanged()}}},SP={AUDIO:function(e,t,i){if(t){var n=i.tech,s=i.requestOptions,a=i.segmentLoaders[e];t.on("loadedmetadata",function(){var c=t.media();a.playlist(c,s),(!n.paused()||c.endList&&n.preload()!=="none")&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),s),n.paused()||a.load()}),t.on("error",Hx[e](e,i))}},SUBTITLES:function(e,t,i){var n=i.tech,s=i.requestOptions,a=i.segmentLoaders[e],c=i.mediaTypes[e];t.on("loadedmetadata",function(){var h=t.media();a.playlist(h,s),a.track(c.activeTrack()),(!n.paused()||h.endList&&n.preload()!=="none")&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),s),n.paused()||a.load()}),t.on("error",Hx[e](e,i))}},RX={AUDIO:function(e,t){var i=t.vhs,n=t.sourceType,s=t.segmentLoaders[e],a=t.requestOptions,c=t.master.mediaGroups,h=t.mediaTypes[e],m=h.groups,v=h.tracks,b=h.logger_,x=t.masterPlaylistLoader,C=ib(x.master);(!c[e]||Object.keys(c[e]).length===0)&&(c[e]={main:{default:{default:!0}}},C&&(c[e].main.default.playlists=x.master.playlists));for(var B in c[e]){m[B]||(m[B]=[]);for(var P in c[e][B]){var N=c[e][B][P],ae=void 0;if(C?(b("AUDIO group '"+B+"' label '"+P+"' is a master playlist"),N.isMasterPlaylist=!0,ae=null):n==="vhs-json"&&N.playlists?ae=new l0(N.playlists[0],i,a):N.resolvedUri?ae=new l0(N.resolvedUri,i,a):N.playlists&&n==="dash"?ae=new e2(N.playlists[0],i,a,x):ae=null,N=rt.mergeOptions({id:P,playlistLoader:ae},N),SP[e](e,N.playlistLoader,t),m[B].push(N),typeof v[P]>"u"){var X=new rt.AudioTrack({id:P,kind:DX(N),enabled:!1,language:N.language,default:N.default,label:P});v[P]=X}}}s.on("error",Hx[e](e,t))},SUBTITLES:function(e,t){var i=t.tech,n=t.vhs,s=t.sourceType,a=t.segmentLoaders[e],c=t.requestOptions,h=t.master.mediaGroups,m=t.mediaTypes[e],v=m.groups,b=m.tracks,x=t.masterPlaylistLoader;for(var C in h[e]){v[C]||(v[C]=[]);for(var B in h[e][C])if(!h[e][C][B].forced){var P=h[e][C][B],N=void 0;if(s==="hls")N=new l0(P.resolvedUri,n,c);else if(s==="dash"){var ae=P.playlists.filter(function(de){return de.excludeUntil!==1/0});if(!ae.length)return;N=new e2(P.playlists[0],n,c,x)}else s==="vhs-json"&&(N=new l0(P.playlists?P.playlists[0]:P.resolvedUri,n,c));if(P=rt.mergeOptions({id:B,playlistLoader:N},P),SP[e](e,P.playlistLoader,t),v[C].push(P),typeof b[B]>"u"){var X=i.addRemoteTextTrack({id:B,kind:"subtitles",default:P.default&&P.autoselect,language:P.language,label:B},!1).track;b[B]=X}}}a.on("error",Hx[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var i=t.tech,n=t.master.mediaGroups,s=t.mediaTypes[e],a=s.groups,c=s.tracks;for(var h in n[e]){a[h]||(a[h]=[]);for(var m in n[e][h]){var v=n[e][h][m];if(/^(?:CC|SERVICE)/.test(v.instreamId)){var b=i.options_.vhs&&i.options_.vhs.captionServices||{},x={label:m,language:v.language,instreamId:v.instreamId,default:v.default&&v.autoselect};if(b[x.instreamId]&&(x=rt.mergeOptions(x,b[x.instreamId])),x.default===void 0&&delete x.default,a[h].push(rt.mergeOptions({id:m},v)),typeof c[m]>"u"){var C=i.addRemoteTextTrack({id:x.instreamId,kind:"captions",default:x.default,language:x.language,label:x.label},!1).track;c[m]=C}}}}}},kX=function r(e,t){for(var i=0;i<e.length;i++)if(sM(t,e[i])||e[i].playlists&&r(e[i].playlists,t))return!0;return!1},OX=function(e,t){return function(i){var n=t.masterPlaylistLoader,s=t.mediaTypes[e].groups,a=n.media();if(!a)return null;var c=null;a.attributes[e]&&(c=s[a.attributes[e]]);var h=Object.keys(s);if(!c)if(e==="AUDIO"&&h.length>1&&ib(t.master))for(var m=0;m<h.length;m++){var v=s[h[m]];if(kX(v,a)){c=v;break}}else s.main?c=s.main:h.length===1&&(c=s[h[0]]);return typeof i>"u"?c:i===null||!c?null:c.filter(function(b){return b.id===i.id})[0]||null}},FX={AUDIO:function(e,t){return function(){var i=t.mediaTypes[e].tracks;for(var n in i)if(i[n].enabled)return i[n];return null}},SUBTITLES:function(e,t){return function(){var i=t.mediaTypes[e].tracks;for(var n in i)if(i[n].mode==="showing"||i[n].mode==="hidden")return i[n];return null}}},BX=function(e,t){var i=t.mediaTypes;return function(){var n=i[e].activeTrack();return n?i[e].activeGroup(n):null}},NX=function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(B){RX[B](B,e)});var t=e.mediaTypes,i=e.masterPlaylistLoader,n=e.tech,s=e.vhs,a=e.segmentLoaders,c=a.AUDIO,h=a.main;["AUDIO","SUBTITLES"].forEach(function(B){t[B].activeGroup=OX(B,e),t[B].activeTrack=FX[B](B,e),t[B].onGroupChanged=IX(B,e),t[B].onGroupChanging=PX(B,e),t[B].onTrackChanged=LX(B,e),t[B].getActiveGroup=BX(B,e)});var m=t.AUDIO.activeGroup();if(m){var v=(m.filter(function(B){return B.default})[0]||m[0]).id;t.AUDIO.tracks[v].enabled=!0,t.AUDIO.onGroupChanged(),t.AUDIO.onTrackChanged();var b=t.AUDIO.getActiveGroup();b.playlistLoader?(h.setAudio(!1),c.setAudio(!0)):h.setAudio(!0)}i.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(B){return t[B].onGroupChanged()})}),i.on("mediachanging",function(){["AUDIO","SUBTITLES"].forEach(function(B){return t[B].onGroupChanging()})});var x=function(){t.AUDIO.onTrackChanged(),n.trigger({type:"usage",name:"vhs-audio-change"}),n.trigger({type:"usage",name:"hls-audio-change"})};n.audioTracks().addEventListener("change",x),n.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged),s.on("dispose",function(){n.audioTracks().removeEventListener("change",x),n.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)}),n.clearTracks("audio");for(var C in t.AUDIO.tracks)n.audioTracks().addTrack(t.AUDIO.tracks[C])},UX=function(){var e={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){e[t]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:_f,activeTrack:_f,getActiveGroup:_f,onGroupChanged:_f,onTrackChanged:_f,lastTrack_:null,logger_:td("MediaGroups["+t+"]")}}),e},VX=60*2,of,zX=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],HX=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]},jX=function(e){var t=e.currentPlaylist,i=e.buffered,n=e.currentTime,s=e.nextPlaylist,a=e.bufferLowWaterLine,c=e.bufferHighWaterLine,h=e.duration,m=e.experimentalBufferBasedABR,v=e.log;if(!s)return rt.log.warn("We received no playlist to switch to. Please check your stream."),!1;var b="allowing switch "+(t&&t.id||"null")+" -> "+s.id;if(!t)return v(b+" as current playlist is not set"),!0;if(s.id===t.id)return!1;var x=!!o0(i,n).length;if(!t.endList)return!x&&typeof t.partTargetDuration=="number"?(v("not "+b+" as current playlist is live llhls, but currentTime isn't in buffered."),!1):(v(b+" as current playlist is live"),!0);var C=iM(i,n),B=m?Ka.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Ka.MAX_BUFFER_LOW_WATER_LINE;if(h<B)return v(b+" as duration < max low water line ("+h+" < "+B+")"),!0;var P=s.attributes.BANDWIDTH,N=t.attributes.BANDWIDTH;if(P<N&&(!m||C<c)){var ae=b+" as next bandwidth < current bandwidth ("+P+" < "+N+")";return m&&(ae+=" and forwardBuffer < bufferHighWaterLine ("+C+" < "+c+")"),v(ae),!0}if((!m||P>N)&&C>=a){var X=b+" as forwardBuffer >= bufferLowWaterLine ("+C+" >= "+a+")";return m&&(X+=" and next bandwidth > current bandwidth ("+P+" > "+N+")"),v(X),!0}return v("not "+b+" as no switching criteria met"),!1},GX=function(r){mi(e,r);function e(i){var n;n=r.call(this)||this;var s=i.src,a=i.handleManifestRedirects,c=i.withCredentials,h=i.tech,m=i.bandwidth,v=i.externVhs,b=i.useCueTags,x=i.blacklistDuration,C=i.enableLowInitialPlaylist,B=i.sourceType,P=i.cacheEncryptionKeys,N=i.experimentalBufferBasedABR,ae=i.experimentalLeastPixelDiffSelector,X=i.captionServices;if(!s)throw new Error("A non-empty playlist URL or JSON manifest string is required");var de=i.maxPlaylistRetries;(de===null||typeof de>"u")&&(de=1/0),of=v,n.experimentalBufferBasedABR=!!N,n.experimentalLeastPixelDiffSelector=!!ae,n.withCredentials=c,n.tech_=h,n.vhs_=h.vhs,n.sourceType_=B,n.useCueTags_=b,n.blacklistDuration=x,n.maxPlaylistRetries=de,n.enableLowInitialPlaylist=C,n.useCueTags_&&(n.cueTagsTrack_=n.tech_.addTextTrack("metadata","ad-cues"),n.cueTagsTrack_.inBandMetadataTrackDispatchType=""),n.requestOptions_={withCredentials:c,handleManifestRedirects:a,maxPlaylistRetries:de,timeout:null},n.on("error",n.pauseLoading),n.mediaTypes_=UX(),n.mediaSource=new Z.MediaSource,n.handleDurationChange_=n.handleDurationChange_.bind(Tn(n)),n.handleSourceOpen_=n.handleSourceOpen_.bind(Tn(n)),n.handleSourceEnded_=n.handleSourceEnded_.bind(Tn(n)),n.mediaSource.addEventListener("durationchange",n.handleDurationChange_),n.mediaSource.addEventListener("sourceopen",n.handleSourceOpen_),n.mediaSource.addEventListener("sourceended",n.handleSourceEnded_),n.seekable_=rt.createTimeRanges(),n.hasPlayed_=!1,n.syncController_=new wX(i),n.segmentMetadataTrack_=h.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,n.decrypter_=new MX,n.sourceUpdater_=new OB(n.mediaSource),n.inbandTextTracks_={},n.timelineChangeController_=new EX;var ge={vhs:n.vhs_,parse708captions:i.parse708captions,useDtsForTimestampOffset:i.useDtsForTimestampOffset,captionServices:X,mediaSource:n.mediaSource,currentTime:n.tech_.currentTime.bind(n.tech_),seekable:function(){return n.seekable()},seeking:function(){return n.tech_.seeking()},duration:function(){return n.duration()},hasPlayed:function(){return n.hasPlayed_},goalBufferLength:function(){return n.goalBufferLength()},bandwidth:m,syncController:n.syncController_,decrypter:n.decrypter_,sourceType:n.sourceType_,inbandTextTracks:n.inbandTextTracks_,cacheEncryptionKeys:P,sourceUpdater:n.sourceUpdater_,timelineChangeController:n.timelineChangeController_,experimentalExactManifestTimings:i.experimentalExactManifestTimings};n.masterPlaylistLoader_=n.sourceType_==="dash"?new e2(s,n.vhs_,n.requestOptions_):new l0(s,n.vhs_,n.requestOptions_),n.setupMasterPlaylistLoaderListeners_(),n.mainSegmentLoader_=new i2(rt.mergeOptions(ge,{segmentMetadataTrack:n.segmentMetadataTrack_,loaderType:"main"}),i),n.audioSegmentLoader_=new i2(rt.mergeOptions(ge,{loaderType:"audio"}),i),n.subtitleSegmentLoader_=new TX(rt.mergeOptions(ge,{loaderType:"vtt",featuresNativeTextTracks:n.tech_.featuresNativeTextTracks,loadVttJs:function(){return new Promise(function(fe,ve){function ie(){h.off("vttjserror",re),fe()}function re(){h.off("vttjsloaded",ie),ve()}h.one("vttjsloaded",ie),h.one("vttjserror",re),h.addWebVttScript_()})}}),i),n.setupSegmentLoaderListeners_(),n.experimentalBufferBasedABR&&(n.masterPlaylistLoader_.one("loadedplaylist",function(){return n.startABRTimer_()}),n.tech_.on("pause",function(){return n.stopABRTimer_()}),n.tech_.on("play",function(){return n.startABRTimer_()})),zX.forEach(function(be){n[be+"_"]=HX.bind(Tn(n),be)}),n.logger_=td("MPC"),n.triggeredFmp4Usage=!1,n.tech_.preload()==="none"?(n.loadOnPlay_=function(){n.loadOnPlay_=null,n.masterPlaylistLoader_.load()},n.tech_.one("play",n.loadOnPlay_)):n.masterPlaylistLoader_.load(),n.timeToLoadedData__=-1,n.mainAppendsToLoadedData__=-1,n.audioAppendsToLoadedData__=-1;var ue=n.tech_.preload()==="none"?"play":"loadstart";return n.tech_.one(ue,function(){var be=Date.now();n.tech_.one("loadeddata",function(){n.timeToLoadedData__=Date.now()-be,n.mainAppendsToLoadedData__=n.mainSegmentLoader_.mediaAppends,n.audioAppendsToLoadedData__=n.audioSegmentLoader_.mediaAppends})}),n}var t=e.prototype;return t.mainAppendsToLoadedData_=function(){return this.mainAppendsToLoadedData__},t.audioAppendsToLoadedData_=function(){return this.audioAppendsToLoadedData__},t.appendsToLoadedData_=function(){var n=this.mainAppendsToLoadedData_(),s=this.audioAppendsToLoadedData_();return n===-1||s===-1?-1:n+s},t.timeToLoadedData_=function(){return this.timeToLoadedData__},t.checkABR_=function(n){n===void 0&&(n="abr");var s=this.selectPlaylist();s&&this.shouldSwitchToMedia_(s)&&this.switchMedia_(s,n)},t.switchMedia_=function(n,s,a){var c=this.media(),h=c&&(c.id||c.uri),m=n.id||n.uri;h&&h!==m&&(this.logger_("switch media "+h+" -> "+m+" from "+s),this.tech_.trigger({type:"usage",name:"vhs-rendition-change-"+s})),this.masterPlaylistLoader_.media(n,a)},t.startABRTimer_=function(){var n=this;this.stopABRTimer_(),this.abrTimer_=Z.setInterval(function(){return n.checkABR_()},250)},t.stopABRTimer_=function(){this.tech_.scrubbing&&this.tech_.scrubbing()||(Z.clearInterval(this.abrTimer_),this.abrTimer_=null)},t.getAudioTrackPlaylists_=function(){var n=this.master(),s=n&&n.playlists||[];if(!n||!n.mediaGroups||!n.mediaGroups.AUDIO)return s;var a=n.mediaGroups.AUDIO,c=Object.keys(a),h;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)h=this.mediaTypes_.AUDIO.activeTrack();else{var m=a.main||c.length&&a[c[0]];for(var v in m)if(m[v].default){h={label:v};break}}if(!h)return s;var b=[];for(var x in a)if(a[x][h.label]){var C=a[x][h.label];if(C.playlists&&C.playlists.length)b.push.apply(b,C.playlists);else if(C.uri)b.push(C);else if(n.playlists.length)for(var B=0;B<n.playlists.length;B++){var P=n.playlists[B];P.attributes&&P.attributes.AUDIO&&P.attributes.AUDIO===x&&b.push(P)}}return b.length?b:s},t.setupMasterPlaylistLoaderListeners_=function(){var n=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var s=n.masterPlaylistLoader_.media(),a=s.targetDuration*1.5*1e3;YE(n.masterPlaylistLoader_.master,n.masterPlaylistLoader_.media())?n.requestOptions_.timeout=0:n.requestOptions_.timeout=a,s.endList&&n.tech_.preload()!=="none"&&(n.mainSegmentLoader_.playlist(s,n.requestOptions_),n.mainSegmentLoader_.load()),NX({sourceType:n.sourceType_,segmentLoaders:{AUDIO:n.audioSegmentLoader_,SUBTITLES:n.subtitleSegmentLoader_,main:n.mainSegmentLoader_},tech:n.tech_,requestOptions:n.requestOptions_,masterPlaylistLoader:n.masterPlaylistLoader_,vhs:n.vhs_,master:n.master(),mediaTypes:n.mediaTypes_,blacklistCurrentPlaylist:n.blacklistCurrentPlaylist.bind(n)}),n.triggerPresenceUsage_(n.master(),s),n.setupFirstPlay(),!n.mediaTypes_.AUDIO.activePlaylistLoader||n.mediaTypes_.AUDIO.activePlaylistLoader.media()?n.trigger("selectedinitialmedia"):n.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){n.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){n.loadOnPlay_&&n.tech_.off("play",n.loadOnPlay_);var s=n.masterPlaylistLoader_.media();if(!s){n.excludeUnsupportedVariants_();var a;if(n.enableLowInitialPlaylist&&(a=n.selectInitialPlaylist()),a||(a=n.selectPlaylist()),!a||!n.shouldSwitchToMedia_(a))return;n.initialMedia_=a,n.switchMedia_(n.initialMedia_,"initial");var c=n.sourceType_==="vhs-json"&&n.initialMedia_.segments;if(!c)return;s=n.initialMedia_}n.handleUpdatedMediaPlaylist(s)}),this.masterPlaylistLoader_.on("error",function(){n.blacklistCurrentPlaylist(n.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){n.mainSegmentLoader_.abort(),n.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var s=n.masterPlaylistLoader_.media(),a=s.targetDuration*1.5*1e3;YE(n.masterPlaylistLoader_.master,n.masterPlaylistLoader_.media())?n.requestOptions_.timeout=0:n.requestOptions_.timeout=a,n.masterPlaylistLoader_.load(),n.mainSegmentLoader_.playlist(s,n.requestOptions_),n.mainSegmentLoader_.load(),n.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var s=n.masterPlaylistLoader_.media();if(s.lastExcludeReason_!=="playlist-unchanged"){var a=n.stuckAtPlaylistEnd_(s);a&&(n.blacklistCurrentPlaylist({message:"Playlist no longer updating.",reason:"playlist-unchanged"}),n.tech_.trigger("playliststuck"))}}),this.masterPlaylistLoader_.on("renditiondisabled",function(){n.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"}),n.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){n.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"}),n.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})},t.handleUpdatedMediaPlaylist=function(n){this.useCueTags_&&this.updateAdCues_(n),this.mainSegmentLoader_.playlist(n,this.requestOptions_),this.updateDuration(!n.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())},t.triggerPresenceUsage_=function(n,s){var a=n.mediaGroups||{},c=!0,h=Object.keys(a.AUDIO);for(var m in a.AUDIO)for(var v in a.AUDIO[m]){var b=a.AUDIO[m][v];b.uri||(c=!1)}c&&(this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),this.tech_.trigger({type:"usage",name:"hls-demuxed"})),Object.keys(a.SUBTITLES).length&&(this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),this.tech_.trigger({type:"usage",name:"hls-webvtt"})),of.Playlist.isAes(s)&&(this.tech_.trigger({type:"usage",name:"vhs-aes"}),this.tech_.trigger({type:"usage",name:"hls-aes"})),h.length&&Object.keys(a.AUDIO[h[0]]).length>1&&(this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})),this.useCueTags_&&(this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"}),this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"}))},t.shouldSwitchToMedia_=function(n){var s=this.masterPlaylistLoader_.media()||this.masterPlaylistLoader_.pendingMedia_,a=this.tech_.currentTime(),c=this.bufferLowWaterLine(),h=this.bufferHighWaterLine(),m=this.tech_.buffered();return jX({buffered:m,currentTime:a,currentPlaylist:s,nextPlaylist:n,bufferLowWaterLine:c,bufferHighWaterLine:h,duration:this.duration(),experimentalBufferBasedABR:this.experimentalBufferBasedABR,log:this.logger_})},t.setupSegmentLoaderListeners_=function(){var n=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){n.checkABR_("bandwidthupdate"),n.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",function(){n.experimentalBufferBasedABR&&n.mainSegmentLoader_.load()}),this.experimentalBufferBasedABR||this.mainSegmentLoader_.on("progress",function(){n.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){n.blacklistCurrentPlaylist(n.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("appenderror",function(){n.error=n.mainSegmentLoader_.error_,n.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",function(){n.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){n.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"}),n.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){n.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",function(){n.error=n.audioSegmentLoader_.error_,n.trigger("error")}),this.mainSegmentLoader_.on("ended",function(){n.logger_("main segment loader ended"),n.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(a){n.experimentalBufferBasedABR||(n.delegateLoaders_("all",["abort"]),n.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},VX))});var s=function(){if(!n.sourceUpdater_.hasCreatedSourceBuffers())return n.tryToCreateSourceBuffers_();var c=n.getCodecsOrExclude_();c&&n.sourceUpdater_.addOrChangeSourceBuffers(c)};this.mainSegmentLoader_.on("trackinfo",s),this.audioSegmentLoader_.on("trackinfo",s),this.mainSegmentLoader_.on("fmp4",function(){n.triggeredFmp4Usage||(n.tech_.trigger({type:"usage",name:"vhs-fmp4"}),n.tech_.trigger({type:"usage",name:"hls-fmp4"}),n.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",function(){n.triggeredFmp4Usage||(n.tech_.trigger({type:"usage",name:"vhs-fmp4"}),n.tech_.trigger({type:"usage",name:"hls-fmp4"}),n.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",function(){n.logger_("audioSegmentLoader ended"),n.onEndOfStream()})},t.mediaSecondsLoaded_=function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)},t.load=function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()},t.smoothQualityChange_=function(n){n===void 0&&(n=this.selectPlaylist()),this.fastQualityChange_(n)},t.fastQualityChange_=function(n){var s=this;if(n===void 0&&(n=this.selectPlaylist()),n===this.masterPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(n,"fast-quality"),this.mainSegmentLoader_.resetEverything(function(){rt.browser.IE_VERSION||rt.browser.IS_EDGE?s.tech_.setCurrentTime(s.tech_.currentTime()+.04):s.tech_.setCurrentTime(s.tech_.currentTime())})},t.play=function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var n=this.tech_.seekable();if(this.tech_.duration()===1/0&&this.tech_.currentTime()<n.start(0))return this.tech_.setCurrentTime(n.end(n.length-1))}},t.setupFirstPlay=function(){var n=this,s=this.masterPlaylistLoader_.media();if(!s||this.tech_.paused()||this.hasPlayed_)return!1;if(!s.endList){var a=this.seekable();if(!a.length)return!1;if(rt.browser.IE_VERSION&&this.tech_.readyState()===0)return this.tech_.one("loadedmetadata",function(){n.trigger("firstplay"),n.tech_.setCurrentTime(a.end(0)),n.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(a.end(0))}return this.hasPlayed_=!0,this.load(),!0},t.handleSourceOpen_=function(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){var n=this.tech_.play();typeof n<"u"&&typeof n.then=="function"&&n.then(null,function(s){})}this.trigger("sourceopen")},t.handleSourceEnded_=function(){if(this.inbandTextTracks_.metadataTrack_){var n=this.inbandTextTracks_.metadataTrack_.cues;if(!(!n||!n.length)){var s=this.duration();n[n.length-1].endTime=isNaN(s)||Math.abs(s)===1/0?Number.MAX_VALUE:s}}},t.handleDurationChange_=function(){this.tech_.trigger("durationchange")},t.onEndOfStream=function(){var n=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){var s=this.mainSegmentLoader_.getCurrentMediaInfo_();!s||s.hasVideo?n=n&&this.audioSegmentLoader_.ended_:n=this.audioSegmentLoader_.ended_}n&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())},t.stuckAtPlaylistEnd_=function(n){var s=this.seekable();if(!s.length)return!1;var a=this.syncController_.getExpiredTime(n,this.duration());if(a===null)return!1;var c=of.Playlist.playlistEnd(n,a),h=this.tech_.currentTime(),m=this.tech_.buffered();if(!m.length)return c-h<=ph;var v=m.end(m.length-1);return v-h<=ph&&c-v<=ph},t.blacklistCurrentPlaylist=function(n,s){n===void 0&&(n={});var a=n.playlist||this.masterPlaylistLoader_.media();if(s=s||n.blacklistDuration||this.blacklistDuration,!a){this.error=n,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}a.playlistErrors_++;var c=this.masterPlaylistLoader_.master.playlists,h=c.filter(CS),m=h.length===1&&h[0]===a;if(c.length===1&&s!==1/0)return rt.log.warn("Problem encountered with playlist "+a.id+". Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(m);if(m){var v=!1;c.forEach(function(ae){if(ae!==a){var X=ae.excludeUntil;typeof X<"u"&&X!==1/0&&(v=!0,delete ae.excludeUntil)}}),v&&(rt.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}var b;a.playlistErrors_>this.maxPlaylistRetries?b=1/0:b=Date.now()+s*1e3,a.excludeUntil=b,n.reason&&(a.lastExcludeReason_=n.reason),this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-blacklisted"}),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});var x=this.selectPlaylist();if(!x){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}var C=n.internal?this.logger_:rt.log.warn,B=n.message?" "+n.message:"";C((n.internal?"Internal problem":"Problem")+" encountered with playlist "+a.id+"."+(B+" Switching to playlist "+x.id+".")),x.attributes.AUDIO!==a.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),x.attributes.SUBTITLES!==a.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);var P=x.targetDuration/2*1e3||5*1e3,N=typeof x.lastRequest=="number"&&Date.now()-x.lastRequest<=P;return this.switchMedia_(x,"exclude",m||N)},t.pauseLoading=function(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()},t.delegateLoaders_=function(n,s){var a=this,c=[],h=n==="all";(h||n==="main")&&c.push(this.masterPlaylistLoader_);var m=[];(h||n==="audio")&&m.push("AUDIO"),(h||n==="subtitle")&&(m.push("CLOSED-CAPTIONS"),m.push("SUBTITLES")),m.forEach(function(v){var b=a.mediaTypes_[v]&&a.mediaTypes_[v].activePlaylistLoader;b&&c.push(b)}),["main","audio","subtitle"].forEach(function(v){var b=a[v+"SegmentLoader_"];b&&(n===v||n==="all")&&c.push(b)}),c.forEach(function(v){return s.forEach(function(b){typeof v[b]=="function"&&v[b]()})})},t.setCurrentTime=function(n){var s=o0(this.tech_.buffered(),n);if(!(this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media())||!this.masterPlaylistLoader_.media().segments)return 0;if(s&&s.length)return n;this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),this.load()},t.duration=function(){if(!this.masterPlaylistLoader_)return 0;var n=this.masterPlaylistLoader_.media();return n?n.endList?this.mediaSource?this.mediaSource.duration:of.Playlist.duration(n):1/0:0},t.seekable=function(){return this.seekable_},t.onSyncInfoUpdate_=function(){var n;if(this.masterPlaylistLoader_){var s=this.masterPlaylistLoader_.media();if(s){var a=this.syncController_.getExpiredTime(s,this.duration());if(a!==null){var c=this.masterPlaylistLoader_.master,h=of.Playlist.seekable(s,a,of.Playlist.liveEdgeDelay(c,s));if(h.length!==0&&!(this.mediaTypes_.AUDIO.activePlaylistLoader&&(s=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),a=this.syncController_.getExpiredTime(s,this.duration()),a===null||(n=of.Playlist.seekable(s,a,of.Playlist.liveEdgeDelay(c,s)),n.length===0)))){var m,v;this.seekable_&&this.seekable_.length&&(m=this.seekable_.end(0),v=this.seekable_.start(0)),n?n.start(0)>h.end(0)||h.start(0)>n.end(0)?this.seekable_=h:this.seekable_=rt.createTimeRanges([[n.start(0)>h.start(0)?n.start(0):h.start(0),n.end(0)<h.end(0)?n.end(0):h.end(0)]]):this.seekable_=h,!(this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===m&&this.seekable_.start(0)===v)&&(this.logger_("seekable updated ["+ZF(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},t.updateDuration=function(n){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,n),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(n){var s=this.seekable();if(!s.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<s.end(s.length-1))&&this.sourceUpdater_.setDuration(s.end(s.length-1));return}var a=this.tech_.buffered(),c=of.Playlist.duration(this.masterPlaylistLoader_.media());a.length>0&&(c=Math.max(c,a.end(a.length-1))),this.mediaSource.duration!==c&&this.sourceUpdater_.setDuration(c)},t.dispose=function(){var n=this;this.trigger("dispose"),this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(function(s){var a=n.mediaTypes_[s].groups;for(var c in a)a[c].forEach(function(h){h.playlistLoader&&h.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()},t.master=function(){return this.masterPlaylistLoader_.master},t.media=function(){return this.masterPlaylistLoader_.media()||this.initialMedia_},t.areMediaTypesKnown_=function(){var n=!!this.mediaTypes_.AUDIO.activePlaylistLoader,s=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),a=n?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!s||!a)},t.getCodecsOrExclude_=function(){var n=this,s={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},a=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();s.video=s.main;var c=v_(this.master(),a),h={},m=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(s.main.hasVideo&&(h.video=c.video||s.main.videoCodec||Vj),s.main.isMuxed&&(h.video+=","+(c.audio||s.main.audioCodec||y3)),(s.main.hasAudio&&!s.main.isMuxed||s.audio.hasAudio||m)&&(h.audio=c.audio||s.main.audioCodec||s.audio.audioCodec||y3,s.audio.isFmp4=s.main.hasAudio&&!s.main.isMuxed?s.main.isFmp4:s.audio.isFmp4),!h.audio&&!h.video){this.blacklistCurrentPlaylist({playlist:a,message:"Could not determine codecs for playlist.",blacklistDuration:1/0});return}var v=function(ae,X){return ae?AT(X):bw(X)},b={},x;if(["video","audio"].forEach(function(N){if(h.hasOwnProperty(N)&&!v(s[N].isFmp4,h[N])){var ae=s[N].isFmp4?"browser":"muxer";b[ae]=b[ae]||[],b[ae].push(h[N]),N==="audio"&&(x=ae)}}),m&&x&&a.attributes.AUDIO){var C=a.attributes.AUDIO;this.master().playlists.forEach(function(N){var ae=N.attributes&&N.attributes.AUDIO;ae===C&&N!==a&&(N.excludeUntil=1/0)}),this.logger_("excluding audio group "+C+" as "+x+' does not support codec(s): "'+h.audio+'"')}if(Object.keys(b).length){var B=Object.keys(b).reduce(function(N,ae){return N&&(N+=", "),N+=ae+' does not support codec(s): "'+b[ae].join(",")+'"',N},"")+".";this.blacklistCurrentPlaylist({playlist:a,internal:!0,message:B,blacklistDuration:1/0});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){var P=[];if(["video","audio"].forEach(function(N){var ae=(Zd(n.sourceUpdater_.codecs[N]||"")[0]||{}).type,X=(Zd(h[N]||"")[0]||{}).type;ae&&X&&ae.toLowerCase()!==X.toLowerCase()&&P.push('"'+n.sourceUpdater_.codecs[N]+'" -> "'+h[N]+'"')}),P.length){this.blacklistCurrentPlaylist({playlist:a,message:"Codec switching not supported: "+P.join(", ")+".",blacklistDuration:1/0,internal:!0});return}}return h},t.tryToCreateSourceBuffers_=function(){if(!(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers())&&this.areMediaTypesKnown_()){var n=this.getCodecsOrExclude_();if(n){this.sourceUpdater_.createSourceBuffers(n);var s=[n.video,n.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(s)}}},t.excludeUnsupportedVariants_=function(){var n=this,s=this.master().playlists,a=[];Object.keys(s).forEach(function(c){var h=s[c];if(a.indexOf(h.id)===-1){a.push(h.id);var m=v_(n.master,h),v=[];m.audio&&!bw(m.audio)&&!AT(m.audio)&&v.push("audio codec "+m.audio),m.video&&!bw(m.video)&&!AT(m.video)&&v.push("video codec "+m.video),m.text&&m.text==="stpp.ttml.im1t"&&v.push("text codec "+m.text),v.length&&(h.excludeUntil=1/0,n.logger_("excluding "+h.id+" for unsupported: "+v.join(", ")))}})},t.excludeIncompatibleVariants_=function(n){var s=this,a=[],c=this.master().playlists,h=Ux(Zd(n)),m=hP(h),v=h.video&&Zd(h.video)[0]||null,b=h.audio&&Zd(h.audio)[0]||null;Object.keys(c).forEach(function(x){var C=c[x];if(!(a.indexOf(C.id)!==-1||C.excludeUntil===1/0)){a.push(C.id);var B=[],P=v_(s.masterPlaylistLoader_.master,C),N=hP(P);if(!(!P.audio&&!P.video)){if(N!==m&&B.push('codec count "'+N+'" !== "'+m+'"'),!s.sourceUpdater_.canChangeType()){var ae=P.video&&Zd(P.video)[0]||null,X=P.audio&&Zd(P.audio)[0]||null;ae&&v&&ae.type.toLowerCase()!==v.type.toLowerCase()&&B.push('video codec "'+ae.type+'" !== "'+v.type+'"'),X&&b&&X.type.toLowerCase()!==b.type.toLowerCase()&&B.push('audio codec "'+X.type+'" !== "'+b.type+'"')}B.length&&(C.excludeUntil=1/0,s.logger_("blacklisting "+C.id+": "+B.join(" && ")))}}})},t.updateAdCues_=function(n){var s=0,a=this.seekable();a.length&&(s=a.start(0)),SX(n,this.cueTagsTrack_,s)},t.goalBufferLength=function(){var n=this.tech_.currentTime(),s=Ka.GOAL_BUFFER_LENGTH,a=Ka.GOAL_BUFFER_LENGTH_RATE,c=Math.max(s,Ka.MAX_GOAL_BUFFER_LENGTH);return Math.min(s+n*a,c)},t.bufferLowWaterLine=function(){var n=this.tech_.currentTime(),s=Ka.BUFFER_LOW_WATER_LINE,a=Ka.BUFFER_LOW_WATER_LINE_RATE,c=Math.max(s,Ka.MAX_BUFFER_LOW_WATER_LINE),h=Math.max(s,Ka.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(s+n*a,this.experimentalBufferBasedABR?h:c)},t.bufferHighWaterLine=function(){return Ka.BUFFER_HIGH_WATER_LINE},e}(rt.EventTarget),$X=function(e,t,i){return function(n){var s=e.master.playlists[t],a=rM(s),c=CS(s);return typeof n>"u"?c:(n?delete s.disabled:s.disabled=!0,n!==c&&!a&&(i(),n?e.trigger("renditionenabled"):e.trigger("renditiondisabled")),n)}},WX=function(e,t,i){var n=e.masterPlaylistController_,s=e.options_.smoothQualityChange,a=s?"smooth":"fast",c=n[a+"QualityChange_"].bind(n);if(t.attributes){var h=t.attributes.RESOLUTION;this.width=h&&h.width,this.height=h&&h.height,this.bandwidth=t.attributes.BANDWIDTH,this.frameRate=t.attributes["FRAME-RATE"]}this.codecs=v_(n.master(),t),this.playlist=t,this.id=i,this.enabled=$X(e.playlists,t.id,c)},qX=function(e){e.representations=function(){var t=e.masterPlaylistController_.master(),i=ib(t)?e.masterPlaylistController_.getAudioTrackPlaylists_():t.playlists;return i?i.filter(function(n){return!rM(n)}).map(function(n,s){return new WX(e,n,n.id)}):[]}},AP=["seeking","seeked","pause","playing","error"],XX=function(){function r(t){var i=this;this.masterPlaylistController_=t.masterPlaylistController,this.tech_=t.tech,this.seekable=t.seekable,this.allowSeeksWithinUnsafeLiveWindow=t.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=t.liveRangeSafeTimeDelta,this.media=t.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=td("PlaybackWatcher"),this.logger_("initialize");var n=function(){return i.monitorCurrentTime_()},s=function(){return i.monitorCurrentTime_()},a=function(){return i.techWaiting_()},c=function(){return i.cancelTimer_()},h=this.masterPlaylistController_,m=["main","subtitle","audio"],v={};m.forEach(function(x){v[x]={reset:function(){return i.resetSegmentDownloads_(x)},updateend:function(){return i.checkSegmentDownloads_(x)}},h[x+"SegmentLoader_"].on("appendsdone",v[x].updateend),h[x+"SegmentLoader_"].on("playlistupdate",v[x].reset),i.tech_.on(["seeked","seeking"],v[x].reset)});var b=function(C){["main","audio"].forEach(function(B){h[B+"SegmentLoader_"][C]("appended",i.seekingAppendCheck_)})};this.seekingAppendCheck_=function(){i.fixesBadSeeks_()&&(i.consecutiveUpdates=0,i.lastRecordedTime=i.tech_.currentTime(),b("off"))},this.clearSeekingAppendCheck_=function(){return b("off")},this.watchForBadSeeking_=function(){i.clearSeekingAppendCheck_(),b("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",a),this.tech_.on(AP,c),this.tech_.on("canplay",s),this.tech_.one("play",n),this.dispose=function(){i.clearSeekingAppendCheck_(),i.logger_("dispose"),i.tech_.off("waiting",a),i.tech_.off(AP,c),i.tech_.off("canplay",s),i.tech_.off("play",n),i.tech_.off("seeking",i.watchForBadSeeking_),i.tech_.off("seeked",i.clearSeekingAppendCheck_),m.forEach(function(x){h[x+"SegmentLoader_"].off("appendsdone",v[x].updateend),h[x+"SegmentLoader_"].off("playlistupdate",v[x].reset),i.tech_.off(["seeked","seeking"],v[x].reset)}),i.checkCurrentTimeTimeout_&&Z.clearTimeout(i.checkCurrentTimeTimeout_),i.cancelTimer_()}}var e=r.prototype;return e.monitorCurrentTime_=function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&Z.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=Z.setTimeout(this.monitorCurrentTime_.bind(this),250)},e.resetSegmentDownloads_=function(i){var n=this.masterPlaylistController_[i+"SegmentLoader_"];this[i+"StalledDownloads_"]>0&&this.logger_("resetting possible stalled download count for "+i+" loader"),this[i+"StalledDownloads_"]=0,this[i+"Buffered_"]=n.buffered_()},e.checkSegmentDownloads_=function(i){var n=this.masterPlaylistController_,s=n[i+"SegmentLoader_"],a=s.buffered_(),c=UW(this[i+"Buffered_"],a);if(this[i+"Buffered_"]=a,c){this.resetSegmentDownloads_(i);return}this[i+"StalledDownloads_"]++,this.logger_("found #"+this[i+"StalledDownloads_"]+" "+i+" appends that did not increase buffer (possible stalled download)",{playlistId:s.playlist_&&s.playlist_.id,buffered:Nm(a)}),!(this[i+"StalledDownloads_"]<10)&&(this.logger_(i+" loader stalled download exclusion"),this.resetSegmentDownloads_(i),this.tech_.trigger({type:"usage",name:"vhs-"+i+"-download-exclusion"}),i!=="subtitle"&&n.blacklistCurrentPlaylist({message:"Excessive "+i+" segment downloading detected."},1/0))},e.checkCurrentTime_=function(){if(!(this.tech_.paused()||this.tech_.seeking())){var i=this.tech_.currentTime(),n=this.tech_.buffered();if(this.lastRecordedTime===i&&(!n.length||i+ph>=n.end(n.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&i===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):i===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=i)}},e.cancelTimer_=function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null},e.fixesBadSeeks_=function(){var i=this.tech_.seeking();if(!i)return!1;var n=this.seekable(),s=this.tech_.currentTime(),a=this.afterSeekableWindow_(n,s,this.media(),this.allowSeeksWithinUnsafeLiveWindow),c;if(a){var h=n.end(n.length-1);c=h}if(this.beforeSeekableWindow_(n,s)){var m=n.start(0);c=m+(m===n.end(0)?0:ph)}if(typeof c<"u")return this.logger_("Trying to seek outside of seekable at time "+s+" with "+("seekable range "+ZF(n)+". Seeking to ")+(c+".")),this.tech_.setCurrentTime(c),!0;for(var v=this.masterPlaylistController_.sourceUpdater_,b=this.tech_.buffered(),x=v.audioBuffer?v.audioBuffered():null,C=v.videoBuffer?v.videoBuffered():null,B=this.media(),P=B.partTargetDuration?B.partTargetDuration:(B.targetDuration-Op)*2,N=[x,C],ae=0;ae<N.length;ae++)if(N[ae]){var X=iM(N[ae],s);if(X<P)return!1}var de=lT(b,s);return de.length===0?!1:(c=de.start(0)+ph,this.logger_("Buffered region starts ("+de.start(0)+") "+(" just beyond seek point ("+s+"). Seeking to "+c+".")),this.tech_.setCurrentTime(c),!0)},e.waiting_=function(){if(!this.techWaiting_()){var i=this.tech_.currentTime(),n=this.tech_.buffered(),s=o0(n,i);if(s.length&&i+3<=s.end(0)){this.cancelTimer_(),this.tech_.setCurrentTime(i),this.logger_("Stopped at "+i+" while inside a buffered region "+("["+s.start(0)+" -> "+s.end(0)+"]. Attempting to resume ")+"playback by seeking to the current time."),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"}),this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"});return}}},e.techWaiting_=function(){var i=this.seekable(),n=this.tech_.currentTime();if(this.tech_.seeking()||this.timer_!==null)return!0;if(this.beforeSeekableWindow_(i,n)){var s=i.end(i.length-1);return this.logger_("Fell out of live window at time "+n+". Seeking to "+("live point (seekable end) "+s)),this.cancelTimer_(),this.tech_.setCurrentTime(s),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var a=this.tech_.vhs.masterPlaylistController_.sourceUpdater_,c=this.tech_.buffered(),h=this.videoUnderflow_({audioBuffered:a.audioBuffered(),videoBuffered:a.videoBuffered(),currentTime:n});if(h)return this.cancelTimer_(),this.tech_.setCurrentTime(n),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;var m=lT(c,n);if(m.length>0){var v=m.start(0)-n;return this.logger_("Stopped at "+n+", setting timer for "+v+", seeking "+("to "+m.start(0))),this.cancelTimer_(),this.timer_=setTimeout(this.skipTheGap_.bind(this),v*1e3,n),!0}return!1},e.afterSeekableWindow_=function(i,n,s,a){if(a===void 0&&(a=!1),!i.length)return!1;var c=i.end(i.length-1)+ph,h=!s.endList;return h&&a&&(c=i.end(i.length-1)+s.targetDuration*3),n>c},e.beforeSeekableWindow_=function(i,n){return!!(i.length&&i.start(0)>0&&n<i.start(0)-this.liveRangeSafeTimeDelta)},e.videoUnderflow_=function(i){var n=i.videoBuffered,s=i.audioBuffered,a=i.currentTime;if(n){var c;if(n.length&&s.length){var h=o0(n,a-3),m=o0(n,a),v=o0(s,a);v.length&&!m.length&&h.length&&(c={start:h.end(0),end:v.end(0)})}else{var b=lT(n,a);b.length||(c=this.gapFromVideoUnderflow_(n,a))}return c?(this.logger_("Encountered a gap in video from "+c.start+" to "+c.end+". "+("Seeking to current time "+a)),!0):!1}},e.skipTheGap_=function(i){var n=this.tech_.buffered(),s=this.tech_.currentTime(),a=lT(n,s);this.cancelTimer_(),!(a.length===0||s!==i)&&(this.logger_("skipTheGap_:","currentTime:",s,"scheduled currentTime:",i,"nextRange start:",a.start(0)),this.tech_.setCurrentTime(a.start(0)+Op),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))},e.gapFromVideoUnderflow_=function(i,n){for(var s=FW(i),a=0;a<s.length;a++){var c=s.start(a),h=s.end(a);if(n-c<4&&n-c>2)return{start:c,end:h}}return null},r}(),YX={errorInterval:30,getSource:function(e){var t=this.tech({IWillNotUseThisInPlugins:!0}),i=t.currentSource_||this.currentSource();return e(i)}},QX=function r(e,t){var i=0,n=0,s=rt.mergeOptions(YX,t);e.ready(function(){e.trigger({type:"usage",name:"vhs-error-reload-initialized"}),e.trigger({type:"usage",name:"hls-error-reload-initialized"})});var a=function(){n&&e.currentTime(n)},c=function(x){x!=null&&(n=e.duration()!==1/0&&e.currentTime()||0,e.one("loadedmetadata",a),e.src(x),e.trigger({type:"usage",name:"vhs-error-reload"}),e.trigger({type:"usage",name:"hls-error-reload"}),e.play())},h=function(){if(Date.now()-i<s.errorInterval*1e3){e.trigger({type:"usage",name:"vhs-error-reload-canceled"}),e.trigger({type:"usage",name:"hls-error-reload-canceled"});return}if(!s.getSource||typeof s.getSource!="function"){rt.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return i=Date.now(),s.getSource.call(e,c)},m=function b(){e.off("loadedmetadata",a),e.off("error",h),e.off("dispose",b)},v=function(x){m(),r(e,x)};e.on("error",h),e.on("dispose",m),e.reloadSourceOnError=v},KX=function(e){QX(this,e)},FB="2.16.3",ZX="6.0.1",JX="0.22.1",eY="4.8.0",tY="3.1.3",ho={PlaylistLoader:l0,Playlist:eu,utils:cq,STANDARD_PLAYLIST_SELECTOR:pP,INITIAL_PLAYLIST_SELECTOR:Jq,lastBandwidthSelector:pP,movingAverageBandwidthSelector:Kq,comparePlaylistBandwidth:lM,comparePlaylistResolution:Qq,xhr:fB()};Object.keys(Ka).forEach(function(r){Object.defineProperty(ho,r,{get:function(){return rt.log.warn("using Vhs."+r+" is UNSAFE be sure you know what you are doing"),Ka[r]},set:function(t){if(rt.log.warn("using Vhs."+r+" is UNSAFE be sure you know what you are doing"),typeof t!="number"||t<0){rt.log.warn("value of Vhs."+r+" must be greater than or equal to 0");return}Ka[r]=t}})});var BB="videojs-vhs",NB=function(e,t){for(var i=t.media(),n=-1,s=0;s<e.length;s++)if(e[s].id===i.id){n=s;break}e.selectedIndex_=n,e.trigger({selectedIndex:n,type:"change"})},iY=function(e,t){t.representations().forEach(function(i){e.addQualityLevel(i)}),NB(e,t.playlists)};ho.canPlaySource=function(){return rt.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var nY=function(e,t,i){if(!e)return e;var n={};t&&t.attributes&&t.attributes.CODECS&&(n=Ux(Zd(t.attributes.CODECS))),i&&i.attributes&&i.attributes.CODECS&&(n.audio=i.attributes.CODECS);var s=I_(n.video),a=I_(n.audio),c={};for(var h in e)c[h]={},a&&(c[h].audioContentType=a),s&&(c[h].videoContentType=s),t.contentProtection&&t.contentProtection[h]&&t.contentProtection[h].pssh&&(c[h].pssh=t.contentProtection[h].pssh),typeof e[h]=="string"&&(c[h].url=e[h]);return rt.mergeOptions(e,c)},rY=function(e,t){return e.reduce(function(i,n){if(!n.contentProtection)return i;var s=t.reduce(function(a,c){var h=n.contentProtection[c];return h&&h.pssh&&(a[c]={pssh:h.pssh}),a},{});return Object.keys(s).length&&i.push(s),i},[])},sY=function(e){var t=e.player,i=e.sourceKeySystems,n=e.audioMedia,s=e.mainPlaylists;if(!t.eme.initializeMediaKeys)return Promise.resolve();var a=n?s.concat([n]):s,c=rY(a,Object.keys(i)),h=[],m=[];return c.forEach(function(v){m.push(new Promise(function(b,x){t.tech_.one("keysessioncreated",b)})),h.push(new Promise(function(b,x){t.eme.initializeMediaKeys({keySystems:v},function(C){if(C){x(C);return}b()})}))}),Promise.race([Promise.all(h),Promise.race(m)])},aY=function(e){var t=e.player,i=e.sourceKeySystems,n=e.media,s=e.audioMedia,a=nY(i,n,s);return a?(t.currentSource().keySystems=a,a&&!t.eme?(rt.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},UB=function(){if(!Z.localStorage)return null;var e=Z.localStorage.getItem(BB);if(!e)return null;try{return JSON.parse(e)}catch{return null}},oY=function(e){if(!Z.localStorage)return!1;var t=UB();t=t?rt.mergeOptions(t,e):e;try{Z.localStorage.setItem(BB,JSON.stringify(t))}catch{return!1}return t},lY=function(e){return e.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(e.substring(e.indexOf(",")+1)):e};ho.supportsNativeHls=function(){if(!ot||!ot.createElement)return!1;var r=ot.createElement("video");if(!rt.getTech("Html5").isSupported())return!1;var e=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];return e.some(function(t){return/maybe|probably/i.test(r.canPlayType(t))})}();ho.supportsNativeDash=function(){return!ot||!ot.createElement||!rt.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(ot.createElement("video").canPlayType("application/dash+xml"))}();ho.supportsTypeNatively=function(r){return r==="hls"?ho.supportsNativeHls:r==="dash"?ho.supportsNativeDash:!1};ho.isSupported=function(){return rt.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var uY=rt.getComponent("Component"),cM=function(r){mi(e,r);function e(i,n,s){var a;if(a=r.call(this,n,rt.mergeOptions(s.hls,s.vhs))||this,s.hls&&Object.keys(s.hls).length&&rt.log.warn("Using hls options is deprecated. Please rename `hls` to `vhs` in your options object."),typeof s.initialBandwidth=="number"&&(a.options_.bandwidth=s.initialBandwidth),a.logger_=td("VhsHandler"),n.options_&&n.options_.playerId){var c=rt(n.options_.playerId);c.hasOwnProperty("hls")||Object.defineProperty(c,"hls",{get:function(){return rt.log.warn("player.hls is deprecated. Use player.tech().vhs instead."),n.trigger({type:"usage",name:"hls-player-access"}),Tn(a)},configurable:!0}),c.hasOwnProperty("vhs")||Object.defineProperty(c,"vhs",{get:function(){return rt.log.warn("player.vhs is deprecated. Use player.tech().vhs instead."),n.trigger({type:"usage",name:"vhs-player-access"}),Tn(a)},configurable:!0}),c.hasOwnProperty("dash")||Object.defineProperty(c,"dash",{get:function(){return rt.log.warn("player.dash is deprecated. Use player.tech().vhs instead."),Tn(a)},configurable:!0}),a.player_=c}if(a.tech_=n,a.source_=i,a.stats={},a.ignoreNextSeekingEvent_=!1,a.setOptions_(),a.options_.overrideNative&&n.overrideNativeAudioTracks&&n.overrideNativeVideoTracks)n.overrideNativeAudioTracks(!0),n.overrideNativeVideoTracks(!0);else if(a.options_.overrideNative&&(n.featuresNativeVideoTracks||n.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return a.on(ot,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(h){var m=ot.fullscreenElement||ot.webkitFullscreenElement||ot.mozFullScreenElement||ot.msFullscreenElement;m&&m.contains(a.tech_.el())?a.masterPlaylistController_.fastQualityChange_():a.masterPlaylistController_.checkABR_()}),a.on(a.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),a.on(a.tech_,"error",function(){this.tech_.error()&&this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),a.on(a.tech_,"play",a.play),a}var t=e.prototype;return t.setOptions_=function(){var n=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=this.options_.handleManifestRedirects!==!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,typeof this.options_.blacklistDuration!="number"&&(this.options_.blacklistDuration=5*60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){var s=UB();s&&s.bandwidth&&(this.options_.bandwidth=s.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),s&&s.throughput&&(this.options_.throughput=s.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=Ka.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Ka.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","experimentalBufferBasedABR","liveRangeSafeTimeDelta","experimentalLLHLS","useNetworkInformationApi","useDtsForTimestampOffset","experimentalExactManifestTimings","experimentalLeastPixelDiffSelector"].forEach(function(a){typeof n.source_[a]<"u"&&(n.options_[a]=n.source_[a])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio},t.src=function(n,s){var a=this;if(n){this.setOptions_(),this.options_.src=lY(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=ho,this.options_.sourceType=P4(s),this.options_.seekTo=function(m){a.tech_.setCurrentTime(m)},this.options_.smoothQualityChange&&rt.log.warn("smoothQualityChange is deprecated and will be removed in the next major version"),this.masterPlaylistController_=new GX(this.options_);var c=rt.mergeOptions({liveRangeSafeTimeDelta:ph},this.options_,{seekable:function(){return a.seekable()},media:function(){return a.masterPlaylistController_.media()},masterPlaylistController:this.masterPlaylistController_});this.playbackWatcher_=new XX(c),this.masterPlaylistController_.on("error",function(){var m=rt.players[a.tech_.options_.playerId],v=a.masterPlaylistController_.error;typeof v=="object"&&!v.code?v.code=3:typeof v=="string"&&(v={message:v,code:3}),m.error(v)});var h=this.options_.experimentalBufferBasedABR?ho.movingAverageBandwidthSelector(.55):ho.STANDARD_PLAYLIST_SELECTOR;this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):h.bind(this),this.masterPlaylistController_.selectInitialPlaylist=ho.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(v){this.masterPlaylistController_.selectPlaylist=v.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(v){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=v,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){var v=this.masterPlaylistController_.mainSegmentLoader_.bandwidth,b=Z.navigator.connection||Z.navigator.mozConnection||Z.navigator.webkitConnection,x=1e7;if(this.options_.useNetworkInformationApi&&b){var C=b.downlink*1e3*1e3;C>=x&&v>=x?v=Math.max(v,C):v=C}return v},set:function(v){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=v,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var v=1/(this.bandwidth||1),b;this.throughput>0?b=1/this.throughput:b=0;var x=Math.floor(1/(v+b));return x},set:function(){rt.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return a.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return a.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return a.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return a.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return a.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return a.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return a.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return a.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},mediaAppends:{get:function(){return a.masterPlaylistController_.mediaAppends_()||0},enumerable:!0},mainAppendsToLoadedData:{get:function(){return a.masterPlaylistController_.mainAppendsToLoadedData_()||0},enumerable:!0},audioAppendsToLoadedData:{get:function(){return a.masterPlaylistController_.audioAppendsToLoadedData_()||0},enumerable:!0},appendsToLoadedData:{get:function(){return a.masterPlaylistController_.appendsToLoadedData_()||0},enumerable:!0},timeToLoadedData:{get:function(){return a.masterPlaylistController_.timeToLoadedData_()||0},enumerable:!0},buffered:{get:function(){return Nm(a.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return a.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return a.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return a.tech_.name_},enumerable:!0},duration:{get:function(){return a.tech_.duration()},enumerable:!0},master:{get:function(){return a.playlists.master},enumerable:!0},playerDimensions:{get:function(){return a.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Nm(a.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return a.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){a.options_.useBandwidthFromLocalStorage&&oY({bandwidth:a.bandwidth,throughput:Math.round(a.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){qX(a)}),this.masterPlaylistController_.sourceUpdater_.on("createdsourcebuffers",function(){a.setupEme_()}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=Z.URL.createObjectURL(this.masterPlaylistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}},t.createKeySessions_=function(){var n=this,s=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),sY({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:s&&s.media(),mainPlaylists:this.playlists.master.playlists}).then(function(){n.logger_("created EME key session"),n.masterPlaylistController_.sourceUpdater_.initializedEme()}).catch(function(a){n.logger_("error while creating EME key session",a),n.player_.error({message:"Failed to initialize media keys for EME",code:3})})},t.handleWaitingForKey_=function(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()},t.setupEme_=function(){var n=this,s=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader,a=aY({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:s&&s.media()});if(this.player_.tech_.on("keystatuschange",function(c){if(c.status==="output-restricted"){var h=n.masterPlaylistController_.master();if(!(!h||!h.playlists)){var m=[];if(h.playlists.forEach(function(b){b&&b.attributes&&b.attributes.RESOLUTION&&b.attributes.RESOLUTION.height>=720&&(!b.excludeUntil||b.excludeUntil<1/0)&&(b.excludeUntil=1/0,m.push(b))}),m.length){var v;(v=rt.log).warn.apply(v,['DRM keystatus changed to "output-restricted." Removing the following HD playlists that will most likely fail to play and clearing the buffer. This may be due to HDCP restrictions on the stream and the capabilities of the current device.'].concat(m)),n.masterPlaylistController_.fastQualityChange_()}}}}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),rt.browser.IE_VERSION===11||!a){this.masterPlaylistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()},t.setupQualityLevels_=function(){var n=this,s=rt.players[this.tech_.options_.playerId];!s||!s.qualityLevels||this.qualityLevels_||(this.qualityLevels_=s.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){iY(n.qualityLevels_,n)}),this.playlists.on("mediachange",function(){NB(n.qualityLevels_,n.playlists)}))},e.version=function(){return{"@videojs/http-streaming":FB,"mux.js":ZX,"mpd-parser":JX,"m3u8-parser":eY,"aes-decrypter":tY}},t.version=function(){return this.constructor.version()},t.canChangeType=function(){return OB.canChangeType()},t.play=function(){this.masterPlaylistController_.play()},t.setCurrentTime=function(n){this.masterPlaylistController_.setCurrentTime(n)},t.duration=function(){return this.masterPlaylistController_.duration()},t.seekable=function(){return this.masterPlaylistController_.seekable()},t.dispose=function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.tech_&&delete this.tech_.hls,this.mediaSourceUrl_&&Z.URL.revokeObjectURL&&(Z.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),r.prototype.dispose.call(this)},t.convertToProgramTime=function(n,s){return vq({playlist:this.masterPlaylistController_.media(),time:n,callback:s})},t.seekToProgramTime=function(n,s,a,c){return a===void 0&&(a=!0),c===void 0&&(c=2),yq({programTime:n,playlist:this.masterPlaylistController_.media(),retryCount:c,pauseAfterSeek:a,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:s})},e}(uY),F_={name:"videojs-http-streaming",VERSION:FB,canHandleSource:function(e,t){t===void 0&&(t={});var i=rt.mergeOptions(rt.options,t);return F_.canPlayType(e.type,i)},handleSource:function(e,t,i){i===void 0&&(i={});var n=rt.mergeOptions(rt.options,i);return t.vhs=new cM(e,t,n),rt.hasOwnProperty("hls")||Object.defineProperty(t,"hls",{get:function(){return rt.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead."),t.vhs},configurable:!0}),t.vhs.xhr=fB(),t.vhs.src(e.src,e.type),t.vhs},canPlayType:function(e,t){var i=P4(e);if(!i)return"";var n=F_.getOverrideNative(t),s=ho.supportsTypeNatively(i),a=!s||n;return a?"maybe":""},getOverrideNative:function(e){e===void 0&&(e={});var t=e,i=t.vhs,n=i===void 0?{}:i,s=t.hls,a=s===void 0?{}:s,c=!(rt.browser.IS_ANY_SAFARI||rt.browser.IS_IOS),h=n.overrideNative,m=h===void 0?c:h,v=a.overrideNative,b=v===void 0?!1:v;return b||m}},cY=function(){return AT("avc1.4d400d,mp4a.40.2")};cY()&&rt.getTech("Html5").registerSourceHandler(F_,0);rt.VhsHandler=cM;Object.defineProperty(rt,"HlsHandler",{get:function(){return rt.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead."),cM},configurable:!0});rt.VhsSourceHandler=F_;Object.defineProperty(rt,"HlsSourceHandler",{get:function(){return rt.log.warn("videojs.HlsSourceHandler is deprecated. Use videojs.VhsSourceHandler instead."),F_},configurable:!0});rt.Vhs=ho;Object.defineProperty(rt,"Hls",{get:function(){return rt.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead."),ho},configurable:!0});rt.use||(rt.registerComponent("Hls",ho),rt.registerComponent("Vhs",ho));rt.options.vhs=rt.options.vhs||{};rt.options.hls=rt.options.hls||{};if(!rt.getPlugin||!rt.getPlugin("reloadSourceOnError")){var dY=rt.registerPlugin||rt.plugin;dY("reloadSourceOnError",KX)}const hY=Object.freeze(Object.defineProperty({__proto__:null,default:rt},Symbol.toStringTag,{value:"Module"})),fY=s2(hY);/*! @name videojs-vr @version 2.0.0 @license MIT */var pY=ST.exports,wP;function mY(){return wP||(wP=1,function(r,e){(function(t,i){r.exports=i(fY)})(pY,function(t){function i(l){return l&&typeof l=="object"&&"default"in l?l:{default:l}}var n=i(t),s="2.0.0";const a=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},c=function(l,o){for(var u=0,f=l.length;u<f;u++)o[u]=l[u]},h=function(l,o){for(var u in o)o.hasOwnProperty(u)&&(l[u]=o[u]);return l};var m=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Ap<"u"?Ap:typeof self<"u"?self:{};function v(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var b={exports:{}};/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(l,o){/**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(u,f){l.exports=f()})(m,function(){var u=function(H,q){if(!(H instanceof q))throw new TypeError("Cannot call a class as a function")},f=function(){function H(q,se){for(var he=0;he<se.length;he++){var Ee=se[he];Ee.enumerable=Ee.enumerable||!1,Ee.configurable=!0,"value"in Ee&&(Ee.writable=!0),Object.defineProperty(q,Ee.key,Ee)}}return function(q,se,he){return se&&H(q.prototype,se),he&&H(q,he),q}}(),g=function(){function H(q,se){var he=[],Ee=!0,qe=!1,dt=void 0;try{for(var ri=q[Symbol.iterator](),Zt;!(Ee=(Zt=ri.next()).done)&&(he.push(Zt.value),!(se&&he.length===se));Ee=!0);}catch(Tt){qe=!0,dt=Tt}finally{try{!Ee&&ri.return&&ri.return()}finally{if(qe)throw dt}}return he}return function(q,se){if(Array.isArray(q))return q;if(Symbol.iterator in Object(q))return H(q,se);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),y=.001,T=1,w=function(q,se){return"data:"+q+","+encodeURIComponent(se)},M=function(q,se,he){return q+(se-q)*he},I=function(){var H=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return H}}(),z=function(){var H=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return H}}(),U=function(){var H=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return H}}(),G=function(){var H=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return H}}(),W=function(){var H=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),q=H?parseInt(H[1],10):null;return function(){return q}}(),J=function(){var H=!1;return H=I()&&U()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return H}}(),me=function(){var H=!1;if(W()===65){var q=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(q){var se=q[1].split("."),he=g(se,4);he[0],he[1];var Ee=he[2],qe=he[3];H=parseInt(Ee,10)===3325&&parseInt(qe,10)<148}}return function(){return H}}(),pe=function(){var H=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return H}}(),te=function(){var q=window.orientation==90||window.orientation==-90;return pe()?!q:q},K=function(q){return!(isNaN(q)||q<=y||q>T)},He=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},$e=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},Ue=function(q){if(z())return!1;if(q.requestFullscreen)q.requestFullscreen();else if(q.webkitRequestFullscreen)q.webkitRequestFullscreen();else if(q.mozRequestFullScreen)q.mozRequestFullScreen();else if(q.msRequestFullscreen)q.msRequestFullscreen();else return!1;return!0},Ae=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},at=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},Ht=function(q,se,he,Ee){var qe=q.createShader(q.VERTEX_SHADER);q.shaderSource(qe,se),q.compileShader(qe);var dt=q.createShader(q.FRAGMENT_SHADER);q.shaderSource(dt,he),q.compileShader(dt);var ri=q.createProgram();q.attachShader(ri,qe),q.attachShader(ri,dt);for(var Zt in Ee)q.bindAttribLocation(ri,Ee[Zt],Zt);return q.linkProgram(ri),q.deleteShader(qe),q.deleteShader(dt),ri},wt=function(q,se){for(var he={},Ee=q.getProgramParameter(se,q.ACTIVE_UNIFORMS),qe="",dt=0;dt<Ee;dt++){var ri=q.getActiveUniform(se,dt);qe=ri.name.replace("[0]",""),he[qe]=q.getUniformLocation(se,qe)}return he},It=function(q,se,he,Ee,qe,dt,ri){var Zt=1/(se-he),Tt=1/(Ee-qe),Bt=1/(dt-ri);return q[0]=-2*Zt,q[1]=0,q[2]=0,q[3]=0,q[4]=0,q[5]=-2*Tt,q[6]=0,q[7]=0,q[8]=0,q[9]=0,q[10]=2*Bt,q[11]=0,q[12]=(se+he)*Zt,q[13]=(qe+Ee)*Tt,q[14]=(ri+dt)*Bt,q[15]=1,q},Pt=function(){var q=!1;return function(se){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(se)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(se.substr(0,4)))&&(q=!0)}(navigator.userAgent||navigator.vendor||window.opera),q},Nt=function(q,se){for(var he in se)se.hasOwnProperty(he)&&(q[he]=se[he]);return q},nt=function(q){if(I()){var se=q.style.width,he=q.style.height;q.style.width=parseInt(se)+1+"px",q.style.height=parseInt(he)+"px",setTimeout(function(){q.style.width=se,q.style.height=he},100)}window.canvas=q},Ke=function(){var H=Math.PI/180,q=Math.PI*.25;function se(Tt,Bt,fi,Hi){var rn=Math.tan(Bt?Bt.upDegrees*H:q),_n=Math.tan(Bt?Bt.downDegrees*H:q),mr=Math.tan(Bt?Bt.leftDegrees*H:q),Hn=Math.tan(Bt?Bt.rightDegrees*H:q),Bn=2/(mr+Hn),gs=2/(rn+_n);return Tt[0]=Bn,Tt[1]=0,Tt[2]=0,Tt[3]=0,Tt[4]=0,Tt[5]=gs,Tt[6]=0,Tt[7]=0,Tt[8]=-((mr-Hn)*Bn*.5),Tt[9]=(rn-_n)*gs*.5,Tt[10]=Hi/(fi-Hi),Tt[11]=-1,Tt[12]=0,Tt[13]=0,Tt[14]=Hi*fi/(fi-Hi),Tt[15]=0,Tt}function he(Tt,Bt,fi){var Hi=Bt[0],rn=Bt[1],_n=Bt[2],mr=Bt[3],Hn=Hi+Hi,Bn=rn+rn,gs=_n+_n,_a=Hi*Hn,Xa=Hi*Bn,Qs=Hi*gs,Ro=rn*Bn,Iu=rn*gs,Pu=_n*gs,Lu=mr*Hn,Ru=mr*Bn,pp=mr*gs;return Tt[0]=1-(Ro+Pu),Tt[1]=Xa+pp,Tt[2]=Qs-Ru,Tt[3]=0,Tt[4]=Xa-pp,Tt[5]=1-(_a+Pu),Tt[6]=Iu+Lu,Tt[7]=0,Tt[8]=Qs+Ru,Tt[9]=Iu-Lu,Tt[10]=1-(_a+Ro),Tt[11]=0,Tt[12]=fi[0],Tt[13]=fi[1],Tt[14]=fi[2],Tt[15]=1,Tt}function Ee(Tt,Bt,fi){var Hi=fi[0],rn=fi[1],_n=fi[2],mr,Hn,Bn,gs,_a,Xa,Qs,Ro,Iu,Pu,Lu,Ru;return Bt===Tt?(Tt[12]=Bt[0]*Hi+Bt[4]*rn+Bt[8]*_n+Bt[12],Tt[13]=Bt[1]*Hi+Bt[5]*rn+Bt[9]*_n+Bt[13],Tt[14]=Bt[2]*Hi+Bt[6]*rn+Bt[10]*_n+Bt[14],Tt[15]=Bt[3]*Hi+Bt[7]*rn+Bt[11]*_n+Bt[15]):(mr=Bt[0],Hn=Bt[1],Bn=Bt[2],gs=Bt[3],_a=Bt[4],Xa=Bt[5],Qs=Bt[6],Ro=Bt[7],Iu=Bt[8],Pu=Bt[9],Lu=Bt[10],Ru=Bt[11],Tt[0]=mr,Tt[1]=Hn,Tt[2]=Bn,Tt[3]=gs,Tt[4]=_a,Tt[5]=Xa,Tt[6]=Qs,Tt[7]=Ro,Tt[8]=Iu,Tt[9]=Pu,Tt[10]=Lu,Tt[11]=Ru,Tt[12]=mr*Hi+_a*rn+Iu*_n+Bt[12],Tt[13]=Hn*Hi+Xa*rn+Pu*_n+Bt[13],Tt[14]=Bn*Hi+Qs*rn+Lu*_n+Bt[14],Tt[15]=gs*Hi+Ro*rn+Ru*_n+Bt[15]),Tt}function qe(Tt,Bt){var fi=Bt[0],Hi=Bt[1],rn=Bt[2],_n=Bt[3],mr=Bt[4],Hn=Bt[5],Bn=Bt[6],gs=Bt[7],_a=Bt[8],Xa=Bt[9],Qs=Bt[10],Ro=Bt[11],Iu=Bt[12],Pu=Bt[13],Lu=Bt[14],Ru=Bt[15],pp=fi*Hn-Hi*mr,Cy=fi*Bn-rn*mr,My=fi*gs-_n*mr,Dy=Hi*Bn-rn*Hn,Iy=Hi*gs-_n*Hn,Py=rn*gs-_n*Bn,Ly=_a*Pu-Xa*Iu,Ry=_a*Lu-Qs*Iu,ky=_a*Ru-Ro*Iu,Oy=Xa*Lu-Qs*Pu,Fy=Xa*Ru-Ro*Pu,By=Qs*Ru-Ro*Lu,La=pp*By-Cy*Fy+My*Oy+Dy*ky-Iy*Ry+Py*Ly;return La?(La=1/La,Tt[0]=(Hn*By-Bn*Fy+gs*Oy)*La,Tt[1]=(rn*Fy-Hi*By-_n*Oy)*La,Tt[2]=(Pu*Py-Lu*Iy+Ru*Dy)*La,Tt[3]=(Qs*Iy-Xa*Py-Ro*Dy)*La,Tt[4]=(Bn*ky-mr*By-gs*Ry)*La,Tt[5]=(fi*By-rn*ky+_n*Ry)*La,Tt[6]=(Lu*My-Iu*Py-Ru*Cy)*La,Tt[7]=(_a*Py-Qs*My+Ro*Cy)*La,Tt[8]=(mr*Fy-Hn*ky+gs*Ly)*La,Tt[9]=(Hi*ky-fi*Fy-_n*Ly)*La,Tt[10]=(Iu*Iy-Pu*My+Ru*pp)*La,Tt[11]=(Xa*My-_a*Iy-Ro*pp)*La,Tt[12]=(Hn*Ry-mr*Oy-Bn*Ly)*La,Tt[13]=(fi*Oy-Hi*Ry+rn*Ly)*La,Tt[14]=(Pu*Cy-Iu*Dy-Lu*pp)*La,Tt[15]=(_a*Dy-Xa*Cy+Qs*pp)*La,Tt):null}var dt=new Float32Array([0,0,0,1]),ri=new Float32Array([0,0,0]);function Zt(Tt,Bt,fi,Hi,rn,_n){se(Tt,Hi||null,_n.depthNear,_n.depthFar);var mr=fi.orientation||dt,Hn=fi.position||ri;he(Bt,mr,Hn),rn&&Ee(Bt,Bt,rn),qe(Bt,Bt)}return function(Tt,Bt,fi){return!Tt||!Bt?!1:(Tt.pose=Bt,Tt.timestamp=Bt.timestamp,Zt(Tt.leftProjectionMatrix,Tt.leftViewMatrix,Bt,fi._getFieldOfView("left"),fi._getEyeOffset("left"),fi),Zt(Tt.rightProjectionMatrix,Tt.rightViewMatrix,Bt,fi._getFieldOfView("right"),fi._getEyeOffset("right"),fi),!0)}}(),st=function(){var q=window.self!==window.top,se=Ct(document.referrer),he=Ct(window.location.href);return q&&se!==he},Ct=function(q){var se,he=q.indexOf("://");he!==-1?se=he+3:se=0;var Ee=q.indexOf("/",se);return Ee===-1&&(Ee=q.length),q.substring(0,Ee)},Xt=function(q){if(q.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var se=2*Math.acos(q.w);return se},ti=function(){var H={};return function(q,se){H[q]===void 0&&(console.warn("webvr-polyfill: "+se),H[q]=!0)}}(),ni=function(q,se){var he=se?"Please use "+se+" instead.":"";ti(q,q+" has been deprecated. This may not work on native WebVR displays. "+he)};function Ai(H,q,se){if(!q){se(H);return}for(var he=[],Ee=null,qe=0;qe<q.length;++qe){var dt=q[qe];switch(dt){case H.TEXTURE_BINDING_2D:case H.TEXTURE_BINDING_CUBE_MAP:var ri=q[++qe];if(ri<H.TEXTURE0||ri>H.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),he.push(null,null);break}Ee||(Ee=H.getParameter(H.ACTIVE_TEXTURE)),H.activeTexture(ri),he.push(H.getParameter(dt),null);break;case H.ACTIVE_TEXTURE:Ee=H.getParameter(H.ACTIVE_TEXTURE),he.push(null);break;default:he.push(H.getParameter(dt));break}}se(H);for(var qe=0;qe<q.length;++qe){var dt=q[qe],Zt=he[qe];switch(dt){case H.ACTIVE_TEXTURE:break;case H.ARRAY_BUFFER_BINDING:H.bindBuffer(H.ARRAY_BUFFER,Zt);break;case H.COLOR_CLEAR_VALUE:H.clearColor(Zt[0],Zt[1],Zt[2],Zt[3]);break;case H.COLOR_WRITEMASK:H.colorMask(Zt[0],Zt[1],Zt[2],Zt[3]);break;case H.CURRENT_PROGRAM:H.useProgram(Zt);break;case H.ELEMENT_ARRAY_BUFFER_BINDING:H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,Zt);break;case H.FRAMEBUFFER_BINDING:H.bindFramebuffer(H.FRAMEBUFFER,Zt);break;case H.RENDERBUFFER_BINDING:H.bindRenderbuffer(H.RENDERBUFFER,Zt);break;case H.TEXTURE_BINDING_2D:var ri=q[++qe];if(ri<H.TEXTURE0||ri>H.TEXTURE31)break;H.activeTexture(ri),H.bindTexture(H.TEXTURE_2D,Zt);break;case H.TEXTURE_BINDING_CUBE_MAP:var ri=q[++qe];if(ri<H.TEXTURE0||ri>H.TEXTURE31)break;H.activeTexture(ri),H.bindTexture(H.TEXTURE_CUBE_MAP,Zt);break;case H.VIEWPORT:H.viewport(Zt[0],Zt[1],Zt[2],Zt[3]);break;case H.BLEND:case H.CULL_FACE:case H.DEPTH_TEST:case H.SCISSOR_TEST:case H.STENCIL_TEST:Zt?H.enable(dt):H.disable(dt);break;default:console.log("No GL restore behavior for 0x"+dt.toString(16));break}Ee&&H.activeTexture(Ee)}}var _i=Ai,on=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),vn=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function Pn(H,q,se,he){this.gl=H,this.cardboardUI=q,this.bufferScale=se,this.dirtySubmitFrameBindings=he,this.ctxAttribs=H.getContextAttributes(),this.instanceExt=H.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=H.drawingBufferWidth,this.bufferHeight=H.drawingBufferHeight,this.realBindFramebuffer=H.bindFramebuffer,this.realEnable=H.enable,this.realDisable=H.disable,this.realColorMask=H.colorMask,this.realClearColor=H.clearColor,this.realViewport=H.viewport,I()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(H.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(H.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=Ht(H,on,vn,this.attribs),this.uniforms=wt(H,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=H.createBuffer(),this.indexBuffer=H.createBuffer(),this.indexCount=0,this.renderTarget=H.createTexture(),this.framebuffer=H.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=H.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=H.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=H.createRenderbuffer()),this.patch(),this.onResize()}Pn.prototype.destroy=function(){var H=this.gl;this.unpatch(),H.deleteProgram(this.program),H.deleteBuffer(this.vertexBuffer),H.deleteBuffer(this.indexBuffer),H.deleteTexture(this.renderTarget),H.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&H.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&H.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&H.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},Pn.prototype.onResize=function(){var H=this.gl,q=this,se=[H.RENDERBUFFER_BINDING,H.TEXTURE_BINDING_2D,H.TEXTURE0];_i(H,se,function(he){q.realBindFramebuffer.call(he,he.FRAMEBUFFER,null),q.scissorTest&&q.realDisable.call(he,he.SCISSOR_TEST),q.realColorMask.call(he,!0,!0,!0,!0),q.realViewport.call(he,0,0,he.drawingBufferWidth,he.drawingBufferHeight),q.realClearColor.call(he,0,0,0,1),he.clear(he.COLOR_BUFFER_BIT),q.realBindFramebuffer.call(he,he.FRAMEBUFFER,q.framebuffer),he.bindTexture(he.TEXTURE_2D,q.renderTarget),he.texImage2D(he.TEXTURE_2D,0,q.ctxAttribs.alpha?he.RGBA:he.RGB,q.bufferWidth,q.bufferHeight,0,q.ctxAttribs.alpha?he.RGBA:he.RGB,he.UNSIGNED_BYTE,null),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_MAG_FILTER,he.LINEAR),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_MIN_FILTER,he.LINEAR),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE),he.framebufferTexture2D(he.FRAMEBUFFER,he.COLOR_ATTACHMENT0,he.TEXTURE_2D,q.renderTarget,0),q.ctxAttribs.depth&&q.ctxAttribs.stencil?(he.bindRenderbuffer(he.RENDERBUFFER,q.depthStencilBuffer),he.renderbufferStorage(he.RENDERBUFFER,he.DEPTH_STENCIL,q.bufferWidth,q.bufferHeight),he.framebufferRenderbuffer(he.FRAMEBUFFER,he.DEPTH_STENCIL_ATTACHMENT,he.RENDERBUFFER,q.depthStencilBuffer)):q.ctxAttribs.depth?(he.bindRenderbuffer(he.RENDERBUFFER,q.depthBuffer),he.renderbufferStorage(he.RENDERBUFFER,he.DEPTH_COMPONENT16,q.bufferWidth,q.bufferHeight),he.framebufferRenderbuffer(he.FRAMEBUFFER,he.DEPTH_ATTACHMENT,he.RENDERBUFFER,q.depthBuffer)):q.ctxAttribs.stencil&&(he.bindRenderbuffer(he.RENDERBUFFER,q.stencilBuffer),he.renderbufferStorage(he.RENDERBUFFER,he.STENCIL_INDEX8,q.bufferWidth,q.bufferHeight),he.framebufferRenderbuffer(he.FRAMEBUFFER,he.STENCIL_ATTACHMENT,he.RENDERBUFFER,q.stencilBuffer)),!he.checkFramebufferStatus(he.FRAMEBUFFER)===he.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),q.realBindFramebuffer.call(he,he.FRAMEBUFFER,q.lastBoundFramebuffer),q.scissorTest&&q.realEnable.call(he,he.SCISSOR_TEST),q.realColorMask.apply(he,q.colorMask),q.realViewport.apply(he,q.viewport),q.realClearColor.apply(he,q.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},Pn.prototype.patch=function(){if(!this.isPatched){var H=this,q=this.gl.canvas,se=this.gl;I()||(q.width=He()*this.bufferScale,q.height=$e()*this.bufferScale,Object.defineProperty(q,"width",{configurable:!0,enumerable:!0,get:function(){return H.bufferWidth},set:function(Ee){H.bufferWidth=Ee,H.realCanvasWidth.set.call(q,Ee),H.onResize()}}),Object.defineProperty(q,"height",{configurable:!0,enumerable:!0,get:function(){return H.bufferHeight},set:function(Ee){H.bufferHeight=Ee,H.realCanvasHeight.set.call(q,Ee),H.onResize()}})),this.lastBoundFramebuffer=se.getParameter(se.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(se.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(he,Ee){H.lastBoundFramebuffer=Ee||H.framebuffer,H.realBindFramebuffer.call(se,he,H.lastBoundFramebuffer)},this.cullFace=se.getParameter(se.CULL_FACE),this.depthTest=se.getParameter(se.DEPTH_TEST),this.blend=se.getParameter(se.BLEND),this.scissorTest=se.getParameter(se.SCISSOR_TEST),this.stencilTest=se.getParameter(se.STENCIL_TEST),se.enable=function(he){switch(he){case se.CULL_FACE:H.cullFace=!0;break;case se.DEPTH_TEST:H.depthTest=!0;break;case se.BLEND:H.blend=!0;break;case se.SCISSOR_TEST:H.scissorTest=!0;break;case se.STENCIL_TEST:H.stencilTest=!0;break}H.realEnable.call(se,he)},se.disable=function(he){switch(he){case se.CULL_FACE:H.cullFace=!1;break;case se.DEPTH_TEST:H.depthTest=!1;break;case se.BLEND:H.blend=!1;break;case se.SCISSOR_TEST:H.scissorTest=!1;break;case se.STENCIL_TEST:H.stencilTest=!1;break}H.realDisable.call(se,he)},this.colorMask=se.getParameter(se.COLOR_WRITEMASK),se.colorMask=function(he,Ee,qe,dt){H.colorMask[0]=he,H.colorMask[1]=Ee,H.colorMask[2]=qe,H.colorMask[3]=dt,H.realColorMask.call(se,he,Ee,qe,dt)},this.clearColor=se.getParameter(se.COLOR_CLEAR_VALUE),se.clearColor=function(he,Ee,qe,dt){H.clearColor[0]=he,H.clearColor[1]=Ee,H.clearColor[2]=qe,H.clearColor[3]=dt,H.realClearColor.call(se,he,Ee,qe,dt)},this.viewport=se.getParameter(se.VIEWPORT),se.viewport=function(he,Ee,qe,dt){H.viewport[0]=he,H.viewport[1]=Ee,H.viewport[2]=qe,H.viewport[3]=dt,H.realViewport.call(se,he,Ee,qe,dt)},this.isPatched=!0,nt(q)}},Pn.prototype.unpatch=function(){if(this.isPatched){var H=this.gl,q=this.gl.canvas;I()||(Object.defineProperty(q,"width",this.realCanvasWidth),Object.defineProperty(q,"height",this.realCanvasHeight)),q.width=this.bufferWidth,q.height=this.bufferHeight,H.bindFramebuffer=this.realBindFramebuffer,H.enable=this.realEnable,H.disable=this.realDisable,H.colorMask=this.realColorMask,H.clearColor=this.realClearColor,H.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&H.bindFramebuffer(H.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){nt(q)},1)}},Pn.prototype.setTextureBounds=function(H,q){H||(H=[0,0,.5,1]),q||(q=[.5,0,.5,1]),this.viewportOffsetScale[0]=H[0],this.viewportOffsetScale[1]=H[1],this.viewportOffsetScale[2]=H[2],this.viewportOffsetScale[3]=H[3],this.viewportOffsetScale[4]=q[0],this.viewportOffsetScale[5]=q[1],this.viewportOffsetScale[6]=q[2],this.viewportOffsetScale[7]=q[3]},Pn.prototype.submitFrame=function(){var H=this.gl,q=this,se=[];if(this.dirtySubmitFrameBindings||se.push(H.CURRENT_PROGRAM,H.ARRAY_BUFFER_BINDING,H.ELEMENT_ARRAY_BUFFER_BINDING,H.TEXTURE_BINDING_2D,H.TEXTURE0),_i(H,se,function(Ee){q.realBindFramebuffer.call(Ee,Ee.FRAMEBUFFER,null);var qe=0,dt=0;q.instanceExt&&(qe=Ee.getVertexAttrib(q.attribs.position,q.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),dt=Ee.getVertexAttrib(q.attribs.texCoord,q.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),q.cullFace&&q.realDisable.call(Ee,Ee.CULL_FACE),q.depthTest&&q.realDisable.call(Ee,Ee.DEPTH_TEST),q.blend&&q.realDisable.call(Ee,Ee.BLEND),q.scissorTest&&q.realDisable.call(Ee,Ee.SCISSOR_TEST),q.stencilTest&&q.realDisable.call(Ee,Ee.STENCIL_TEST),q.realColorMask.call(Ee,!0,!0,!0,!0),q.realViewport.call(Ee,0,0,Ee.drawingBufferWidth,Ee.drawingBufferHeight),(q.ctxAttribs.alpha||I())&&(q.realClearColor.call(Ee,0,0,0,1),Ee.clear(Ee.COLOR_BUFFER_BIT)),Ee.useProgram(q.program),Ee.bindBuffer(Ee.ELEMENT_ARRAY_BUFFER,q.indexBuffer),Ee.bindBuffer(Ee.ARRAY_BUFFER,q.vertexBuffer),Ee.enableVertexAttribArray(q.attribs.position),Ee.enableVertexAttribArray(q.attribs.texCoord),Ee.vertexAttribPointer(q.attribs.position,2,Ee.FLOAT,!1,20,0),Ee.vertexAttribPointer(q.attribs.texCoord,3,Ee.FLOAT,!1,20,8),q.instanceExt&&(qe!=0&&q.instanceExt.vertexAttribDivisorANGLE(q.attribs.position,0),dt!=0&&q.instanceExt.vertexAttribDivisorANGLE(q.attribs.texCoord,0)),Ee.activeTexture(Ee.TEXTURE0),Ee.uniform1i(q.uniforms.diffuse,0),Ee.bindTexture(Ee.TEXTURE_2D,q.renderTarget),Ee.uniform4fv(q.uniforms.viewportOffsetScale,q.viewportOffsetScale),Ee.drawElements(Ee.TRIANGLES,q.indexCount,Ee.UNSIGNED_SHORT,0),q.cardboardUI&&q.cardboardUI.renderNoState(),q.realBindFramebuffer.call(q.gl,Ee.FRAMEBUFFER,q.framebuffer),q.ctxAttribs.preserveDrawingBuffer||(q.realClearColor.call(Ee,0,0,0,0),Ee.clear(Ee.COLOR_BUFFER_BIT)),q.dirtySubmitFrameBindings||q.realBindFramebuffer.call(Ee,Ee.FRAMEBUFFER,q.lastBoundFramebuffer),q.cullFace&&q.realEnable.call(Ee,Ee.CULL_FACE),q.depthTest&&q.realEnable.call(Ee,Ee.DEPTH_TEST),q.blend&&q.realEnable.call(Ee,Ee.BLEND),q.scissorTest&&q.realEnable.call(Ee,Ee.SCISSOR_TEST),q.stencilTest&&q.realEnable.call(Ee,Ee.STENCIL_TEST),q.realColorMask.apply(Ee,q.colorMask),q.realViewport.apply(Ee,q.viewport),(q.ctxAttribs.alpha||!q.ctxAttribs.preserveDrawingBuffer)&&q.realClearColor.apply(Ee,q.clearColor),q.instanceExt&&(qe!=0&&q.instanceExt.vertexAttribDivisorANGLE(q.attribs.position,qe),dt!=0&&q.instanceExt.vertexAttribDivisorANGLE(q.attribs.texCoord,dt))}),I()){var he=H.canvas;(he.width!=q.bufferWidth||he.height!=q.bufferHeight)&&(q.bufferWidth=he.width,q.bufferHeight=he.height,q.onResize())}},Pn.prototype.updateDeviceInfo=function(H){var q=this.gl,se=this,he=[q.ARRAY_BUFFER_BINDING,q.ELEMENT_ARRAY_BUFFER_BINDING];_i(q,he,function(Ee){var qe=se.computeMeshVertices_(se.meshWidth,se.meshHeight,H);if(Ee.bindBuffer(Ee.ARRAY_BUFFER,se.vertexBuffer),Ee.bufferData(Ee.ARRAY_BUFFER,qe,Ee.STATIC_DRAW),!se.indexCount){var dt=se.computeMeshIndices_(se.meshWidth,se.meshHeight);Ee.bindBuffer(Ee.ELEMENT_ARRAY_BUFFER,se.indexBuffer),Ee.bufferData(Ee.ELEMENT_ARRAY_BUFFER,dt,Ee.STATIC_DRAW),se.indexCount=dt.length}})},Pn.prototype.computeMeshVertices_=function(H,q,se){for(var he=new Float32Array(2*H*q*5),Ee=se.getLeftEyeVisibleTanAngles(),qe=se.getLeftEyeNoLensTanAngles(),dt=se.getLeftEyeVisibleScreenRect(qe),ri=0,Zt=0;Zt<2;Zt++){for(var Tt=0;Tt<q;Tt++)for(var Bt=0;Bt<H;Bt++,ri++){var fi=Bt/(H-1),Hi=Tt/(q-1),rn=fi,_n=Hi,mr=M(Ee[0],Ee[2],fi),Hn=M(Ee[3],Ee[1],Hi),Bn=Math.sqrt(mr*mr+Hn*Hn),gs=se.distortion.distortInverse(Bn),_a=mr*gs/Bn,Xa=Hn*gs/Bn;fi=(_a-qe[0])/(qe[2]-qe[0]),Hi=(Xa-qe[3])/(qe[1]-qe[3]),fi=(dt.x+fi*dt.width-.5)*2,Hi=(dt.y+Hi*dt.height-.5)*2,he[ri*5+0]=fi,he[ri*5+1]=Hi,he[ri*5+2]=rn,he[ri*5+3]=_n,he[ri*5+4]=Zt}var Qs=Ee[2]-Ee[0];Ee[0]=-(Qs+Ee[0]),Ee[2]=Qs-Ee[2],Qs=qe[2]-qe[0],qe[0]=-(Qs+qe[0]),qe[2]=Qs-qe[2],dt.x=1-(dt.x+dt.width)}return he},Pn.prototype.computeMeshIndices_=function(H,q){for(var se=new Uint16Array(2*(H-1)*(q-1)*6),he=H/2,Ee=q/2,qe=0,dt=0,ri=0;ri<2;ri++)for(var Zt=0;Zt<q;Zt++)for(var Tt=0;Tt<H;Tt++,qe++)Tt==0||Zt==0||(Tt<=he==Zt<=Ee?(se[dt++]=qe,se[dt++]=qe-H-1,se[dt++]=qe-H,se[dt++]=qe-H-1,se[dt++]=qe,se[dt++]=qe-1):(se[dt++]=qe-1,se[dt++]=qe-H,se[dt++]=qe,se[dt++]=qe-H,se[dt++]=qe-1,se[dt++]=qe-H-1));return se},Pn.prototype.getOwnPropertyDescriptor_=function(H,q){var se=Object.getOwnPropertyDescriptor(H,q);return(se.get===void 0||se.set===void 0)&&(se.configurable=!0,se.enumerable=!0,se.get=function(){return this.getAttribute(q)},se.set=function(he){this.setAttribute(q,he)}),se};var Kt=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),ua=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),mn=Math.PI/180,Wn=60,yn=12,pr=20,Sn=1,li=.75,gi=.3125,Ti=4,mt=28,oi=1.5;function Ie(H){this.gl=H,this.attribs={position:0},this.program=Ht(H,Kt,ua,this.attribs),this.uniforms=wt(H,this.program),this.vertexBuffer=H.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}Ie.prototype.destroy=function(){var H=this.gl;this.listener&&H.canvas.removeEventListener("click",this.listener,!1),H.deleteProgram(this.program),H.deleteBuffer(this.vertexBuffer)},Ie.prototype.listen=function(H,q){var se=this.gl.canvas;this.listener=function(he){var Ee=se.clientWidth/2,qe=mt*oi;he.clientX>Ee-qe&&he.clientX<Ee+qe&&he.clientY>se.clientHeight-qe?H(he):he.clientX<qe&&he.clientY<qe&&q(he)},se.addEventListener("click",this.listener,!1)},Ie.prototype.onResize=function(){var H=this.gl,q=this,se=[H.ARRAY_BUFFER_BINDING];_i(H,se,function(he){var Ee=[],qe=he.drawingBufferWidth/2,dt=Math.max(screen.width,screen.height)*window.devicePixelRatio,ri=he.drawingBufferWidth/dt,Zt=ri*window.devicePixelRatio,Tt=Ti*Zt/2,Bt=mt*oi*Zt,fi=mt*Zt/2,Hi=(mt*oi-mt)*Zt;Ee.push(qe-Tt,Bt),Ee.push(qe-Tt,he.drawingBufferHeight),Ee.push(qe+Tt,Bt),Ee.push(qe+Tt,he.drawingBufferHeight),q.gearOffset=Ee.length/2;function rn(gs,_a){var Xa=(90-gs)*mn,Qs=Math.cos(Xa),Ro=Math.sin(Xa);Ee.push(gi*Qs*fi+qe,gi*Ro*fi+fi),Ee.push(_a*Qs*fi+qe,_a*Ro*fi+fi)}for(var _n=0;_n<=6;_n++){var mr=_n*Wn;rn(mr,Sn),rn(mr+yn,Sn),rn(mr+pr,li),rn(mr+(Wn-pr),li),rn(mr+(Wn-yn),Sn)}q.gearVertexCount=Ee.length/2-q.gearOffset,q.arrowOffset=Ee.length/2;function Hn(gs,_a){Ee.push(Hi+gs,he.drawingBufferHeight-Hi-_a)}var Bn=Tt/Math.sin(45*mn);Hn(0,fi),Hn(fi,0),Hn(fi+Bn,Bn),Hn(Bn,fi+Bn),Hn(Bn,fi-Bn),Hn(0,fi),Hn(fi,fi*2),Hn(fi+Bn,fi*2-Bn),Hn(Bn,fi-Bn),Hn(0,fi),Hn(Bn,fi-Tt),Hn(mt*Zt,fi-Tt),Hn(Bn,fi+Tt),Hn(mt*Zt,fi+Tt),q.arrowVertexCount=Ee.length/2-q.arrowOffset,he.bindBuffer(he.ARRAY_BUFFER,q.vertexBuffer),he.bufferData(he.ARRAY_BUFFER,new Float32Array(Ee),he.STATIC_DRAW)})},Ie.prototype.render=function(){var H=this.gl,q=this,se=[H.CULL_FACE,H.DEPTH_TEST,H.BLEND,H.SCISSOR_TEST,H.STENCIL_TEST,H.COLOR_WRITEMASK,H.VIEWPORT,H.CURRENT_PROGRAM,H.ARRAY_BUFFER_BINDING];_i(H,se,function(he){he.disable(he.CULL_FACE),he.disable(he.DEPTH_TEST),he.disable(he.BLEND),he.disable(he.SCISSOR_TEST),he.disable(he.STENCIL_TEST),he.colorMask(!0,!0,!0,!0),he.viewport(0,0,he.drawingBufferWidth,he.drawingBufferHeight),q.renderNoState()})},Ie.prototype.renderNoState=function(){var H=this.gl;H.useProgram(this.program),H.bindBuffer(H.ARRAY_BUFFER,this.vertexBuffer),H.enableVertexAttribArray(this.attribs.position),H.vertexAttribPointer(this.attribs.position,2,H.FLOAT,!1,8,0),H.uniform4f(this.uniforms.color,1,1,1,1),It(this.projMat,0,H.drawingBufferWidth,0,H.drawingBufferHeight,.1,1024),H.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),H.drawArrays(H.TRIANGLE_STRIP,0,4),H.drawArrays(H.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),H.drawArrays(H.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function we(H){this.coefficients=H}we.prototype.distortInverse=function(H){for(var q=0,se=1,he=H-this.distort(q);Math.abs(se-q)>1e-4;){var Ee=H-this.distort(se),qe=se-Ee*((se-q)/(Ee-he));q=se,se=qe,he=Ee}return se},we.prototype.distort=function(H){for(var q=H*H,se=0,he=0;he<this.coefficients.length;he++)se=q*(se+this.coefficients[he]);return(se+1)*H};var qt=Math.PI/180,$t=180/Math.PI,We=function(q,se,he){this.x=q||0,this.y=se||0,this.z=he||0};We.prototype={constructor:We,set:function(q,se,he){return this.x=q,this.y=se,this.z=he,this},copy:function(q){return this.x=q.x,this.y=q.y,this.z=q.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var q=this.length();if(q!==0){var se=1/q;this.multiplyScalar(se)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(q){this.x*=q,this.y*=q,this.z*=q},applyQuaternion:function(q){var se=this.x,he=this.y,Ee=this.z,qe=q.x,dt=q.y,ri=q.z,Zt=q.w,Tt=Zt*se+dt*Ee-ri*he,Bt=Zt*he+ri*se-qe*Ee,fi=Zt*Ee+qe*he-dt*se,Hi=-qe*se-dt*he-ri*Ee;return this.x=Tt*Zt+Hi*-qe+Bt*-ri-fi*-dt,this.y=Bt*Zt+Hi*-dt+fi*-qe-Tt*-ri,this.z=fi*Zt+Hi*-ri+Tt*-dt-Bt*-qe,this},dot:function(q){return this.x*q.x+this.y*q.y+this.z*q.z},crossVectors:function(q,se){var he=q.x,Ee=q.y,qe=q.z,dt=se.x,ri=se.y,Zt=se.z;return this.x=Ee*Zt-qe*ri,this.y=qe*dt-he*Zt,this.z=he*ri-Ee*dt,this}};var zt=function(q,se,he,Ee){this.x=q||0,this.y=se||0,this.z=he||0,this.w=Ee!==void 0?Ee:1};zt.prototype={constructor:zt,set:function(q,se,he,Ee){return this.x=q,this.y=se,this.z=he,this.w=Ee,this},copy:function(q){return this.x=q.x,this.y=q.y,this.z=q.z,this.w=q.w,this},setFromEulerXYZ:function(q,se,he){var Ee=Math.cos(q/2),qe=Math.cos(se/2),dt=Math.cos(he/2),ri=Math.sin(q/2),Zt=Math.sin(se/2),Tt=Math.sin(he/2);return this.x=ri*qe*dt+Ee*Zt*Tt,this.y=Ee*Zt*dt-ri*qe*Tt,this.z=Ee*qe*Tt+ri*Zt*dt,this.w=Ee*qe*dt-ri*Zt*Tt,this},setFromEulerYXZ:function(q,se,he){var Ee=Math.cos(q/2),qe=Math.cos(se/2),dt=Math.cos(he/2),ri=Math.sin(q/2),Zt=Math.sin(se/2),Tt=Math.sin(he/2);return this.x=ri*qe*dt+Ee*Zt*Tt,this.y=Ee*Zt*dt-ri*qe*Tt,this.z=Ee*qe*Tt-ri*Zt*dt,this.w=Ee*qe*dt+ri*Zt*Tt,this},setFromAxisAngle:function(q,se){var he=se/2,Ee=Math.sin(he);return this.x=q.x*Ee,this.y=q.y*Ee,this.z=q.z*Ee,this.w=Math.cos(he),this},multiply:function(q){return this.multiplyQuaternions(this,q)},multiplyQuaternions:function(q,se){var he=q.x,Ee=q.y,qe=q.z,dt=q.w,ri=se.x,Zt=se.y,Tt=se.z,Bt=se.w;return this.x=he*Bt+dt*ri+Ee*Tt-qe*Zt,this.y=Ee*Bt+dt*Zt+qe*ri-he*Tt,this.z=qe*Bt+dt*Tt+he*Zt-Ee*ri,this.w=dt*Bt-he*ri-Ee*Zt-qe*Tt,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var q=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return q===0?(this.x=0,this.y=0,this.z=0,this.w=1):(q=1/q,this.x=this.x*q,this.y=this.y*q,this.z=this.z*q,this.w=this.w*q),this},slerp:function(q,se){if(se===0)return this;if(se===1)return this.copy(q);var he=this.x,Ee=this.y,qe=this.z,dt=this.w,ri=dt*q.w+he*q.x+Ee*q.y+qe*q.z;if(ri<0?(this.w=-q.w,this.x=-q.x,this.y=-q.y,this.z=-q.z,ri=-ri):this.copy(q),ri>=1)return this.w=dt,this.x=he,this.y=Ee,this.z=qe,this;var Zt=Math.acos(ri),Tt=Math.sqrt(1-ri*ri);if(Math.abs(Tt)<.001)return this.w=.5*(dt+this.w),this.x=.5*(he+this.x),this.y=.5*(Ee+this.y),this.z=.5*(qe+this.z),this;var Bt=Math.sin((1-se)*Zt)/Tt,fi=Math.sin(se*Zt)/Tt;return this.w=dt*Bt+this.w*fi,this.x=he*Bt+this.x*fi,this.y=Ee*Bt+this.y*fi,this.z=qe*Bt+this.z*fi,this},setFromUnitVectors:function(){var H,q,se=1e-6;return function(he,Ee){return H===void 0&&(H=new We),q=he.dot(Ee)+1,q<se?(q=0,Math.abs(he.x)>Math.abs(he.z)?H.set(-he.y,he.x,0):H.set(0,-he.z,he.y)):H.crossVectors(he,Ee),this.x=H.x,this.y=H.y,this.z=H.z,this.w=q,this.normalize(),this}}()};function Ei(H){this.width=H.width||He(),this.height=H.height||$e(),this.widthMeters=H.widthMeters,this.heightMeters=H.heightMeters,this.bevelMeters=H.bevelMeters}var ji=new Ei({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),Si=new Ei({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),Vi={CardboardV1:new An({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new An({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function Ii(H,q){this.viewer=Vi.CardboardV2,this.updateDeviceParams(H),this.distortion=new we(this.viewer.distortionCoefficients);for(var se=0;se<q.length;se++){var he=q[se];Vi[he.id]=new An(he)}}Ii.prototype.updateDeviceParams=function(H){this.device=this.determineDevice_(H)||this.device},Ii.prototype.getDevice=function(){return this.device},Ii.prototype.setViewer=function(H){this.viewer=H,this.distortion=new we(this.viewer.distortionCoefficients)},Ii.prototype.determineDevice_=function(H){if(!H)return I()?(console.warn("Using fallback iOS device measurements."),Si):(console.warn("Using fallback Android device measurements."),ji);var q=.0254,se=q/H.xdpi,he=q/H.ydpi,Ee=He(),qe=$e();return new Ei({widthMeters:se*Ee,heightMeters:he*qe,bevelMeters:H.bevelMm*.001})},Ii.prototype.getDistortedFieldOfViewLeftEye=function(){var H=this.viewer,q=this.device,se=this.distortion,he=H.screenLensDistance,Ee=(q.widthMeters-H.interLensDistance)/2,qe=H.interLensDistance/2,dt=H.baselineLensDistance-q.bevelMeters,ri=q.heightMeters-dt,Zt=$t*Math.atan(se.distort(Ee/he)),Tt=$t*Math.atan(se.distort(qe/he)),Bt=$t*Math.atan(se.distort(dt/he)),fi=$t*Math.atan(se.distort(ri/he));return{leftDegrees:Math.min(Zt,H.fov),rightDegrees:Math.min(Tt,H.fov),downDegrees:Math.min(Bt,H.fov),upDegrees:Math.min(fi,H.fov)}},Ii.prototype.getLeftEyeVisibleTanAngles=function(){var H=this.viewer,q=this.device,se=this.distortion,he=Math.tan(-qt*H.fov),Ee=Math.tan(qt*H.fov),qe=Math.tan(qt*H.fov),dt=Math.tan(-qt*H.fov),ri=q.widthMeters/4,Zt=q.heightMeters/2,Tt=H.baselineLensDistance-q.bevelMeters-Zt,Bt=H.interLensDistance/2-ri,fi=-Tt,Hi=H.screenLensDistance,rn=se.distort((Bt-ri)/Hi),_n=se.distort((fi+Zt)/Hi),mr=se.distort((Bt+ri)/Hi),Hn=se.distort((fi-Zt)/Hi),Bn=new Float32Array(4);return Bn[0]=Math.max(he,rn),Bn[1]=Math.min(Ee,_n),Bn[2]=Math.min(qe,mr),Bn[3]=Math.max(dt,Hn),Bn},Ii.prototype.getLeftEyeNoLensTanAngles=function(){var H=this.viewer,q=this.device,se=this.distortion,he=new Float32Array(4),Ee=se.distortInverse(Math.tan(-qt*H.fov)),qe=se.distortInverse(Math.tan(qt*H.fov)),dt=se.distortInverse(Math.tan(qt*H.fov)),ri=se.distortInverse(Math.tan(-qt*H.fov)),Zt=q.widthMeters/4,Tt=q.heightMeters/2,Bt=H.baselineLensDistance-q.bevelMeters-Tt,fi=H.interLensDistance/2-Zt,Hi=-Bt,rn=H.screenLensDistance,_n=(fi-Zt)/rn,mr=(Hi+Tt)/rn,Hn=(fi+Zt)/rn,Bn=(Hi-Tt)/rn;return he[0]=Math.max(Ee,_n),he[1]=Math.min(qe,mr),he[2]=Math.min(dt,Hn),he[3]=Math.max(ri,Bn),he},Ii.prototype.getLeftEyeVisibleScreenRect=function(H){var q=this.viewer,se=this.device,he=q.screenLensDistance,Ee=(se.widthMeters-q.interLensDistance)/2,qe=q.baselineLensDistance-se.bevelMeters,dt=(H[0]*he+Ee)/se.widthMeters,ri=(H[1]*he+qe)/se.heightMeters,Zt=(H[2]*he+Ee)/se.widthMeters,Tt=(H[3]*he+qe)/se.heightMeters;return{x:dt,y:Tt,width:Zt-dt,height:ri-Tt}},Ii.prototype.getFieldOfViewLeftEye=function(H){return H?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},Ii.prototype.getFieldOfViewRightEye=function(H){var q=this.getFieldOfViewLeftEye(H);return{leftDegrees:q.rightDegrees,rightDegrees:q.leftDegrees,upDegrees:q.upDegrees,downDegrees:q.downDegrees}},Ii.prototype.getUndistortedFieldOfViewLeftEye=function(){var H=this.getUndistortedParams_();return{leftDegrees:$t*Math.atan(H.outerDist),rightDegrees:$t*Math.atan(H.innerDist),downDegrees:$t*Math.atan(H.bottomDist),upDegrees:$t*Math.atan(H.topDist)}},Ii.prototype.getUndistortedViewportLeftEye=function(){var H=this.getUndistortedParams_(),q=this.viewer,se=this.device,he=q.screenLensDistance,Ee=se.widthMeters/he,qe=se.heightMeters/he,dt=se.width/Ee,ri=se.height/qe,Zt=Math.round((H.eyePosX-H.outerDist)*dt),Tt=Math.round((H.eyePosY-H.bottomDist)*ri);return{x:Zt,y:Tt,width:Math.round((H.eyePosX+H.innerDist)*dt)-Zt,height:Math.round((H.eyePosY+H.topDist)*ri)-Tt}},Ii.prototype.getUndistortedParams_=function(){var H=this.viewer,q=this.device,se=this.distortion,he=H.screenLensDistance,Ee=H.interLensDistance/2/he,qe=q.widthMeters/he,dt=q.heightMeters/he,ri=qe/2-Ee,Zt=(H.baselineLensDistance-q.bevelMeters)/he,Tt=H.fov,Bt=se.distortInverse(Math.tan(qt*Tt)),fi=Math.min(ri,Bt),Hi=Math.min(Ee,Bt),rn=Math.min(Zt,Bt),_n=Math.min(dt-Zt,Bt);return{outerDist:fi,innerDist:Hi,topDist:_n,bottomDist:rn,eyePosX:ri,eyePosY:Zt}};function An(H){this.id=H.id,this.label=H.label,this.fov=H.fov,this.interLensDistance=H.interLensDistance,this.baselineLensDistance=H.baselineLensDistance,this.screenLensDistance=H.screenLensDistance,this.distortionCoefficients=H.distortionCoefficients,this.inverseCoefficients=H.inverseCoefficients}Ii.Viewers=Vi;var zi=1,hn="2019-11-09T17:36:14Z",ms=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],Lo={format:zi,last_updated:hn,devices:ms};function dp(H,q){if(this.dpdb=Lo,this.recalculateDeviceParams_(),H){this.onDeviceParamsUpdated=q;var se=new XMLHttpRequest,he=this;se.open("GET",H,!0),se.addEventListener("load",function(){he.loading=!1,se.status>=200&&se.status<=299?(he.dpdb=JSON.parse(se.response),he.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),se.send()}}dp.prototype.getDeviceParams=function(){return this.deviceParams},dp.prototype.recalculateDeviceParams_=function(){var H=this.calcDeviceParams_();H?(this.deviceParams=H,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},dp.prototype.calcDeviceParams_=function(){var H=this.dpdb;if(!H)return console.error("DPDB not available."),null;if(H.format!=1)return console.error("DPDB has unexpected format version."),null;if(!H.devices||!H.devices.length)return console.error("DPDB does not have a devices section."),null;var q=navigator.userAgent||navigator.vendor||window.opera,se=He(),he=$e();if(!H.devices)return console.error("DPDB has no devices section."),null;for(var Ee=0;Ee<H.devices.length;Ee++){var qe=H.devices[Ee];if(!qe.rules){console.warn("Device["+Ee+"] has no rules section.");continue}if(qe.type!="ios"&&qe.type!="android"){console.warn("Device["+Ee+"] has invalid type.");continue}if(I()==(qe.type=="ios")){for(var dt=!1,ri=0;ri<qe.rules.length;ri++){var Zt=qe.rules[ri];if(this.ruleMatches_(Zt,q,se,he)){dt=!0;break}}if(dt){var Tt=qe.dpi[0]||qe.dpi,Bt=qe.dpi[1]||qe.dpi;return new vA({xdpi:Tt,ydpi:Bt,bevelMm:qe.bw})}}}return console.warn("No DPDB device match."),null},dp.prototype.ruleMatches_=function(H,q,se,he){if(!H.ua&&!H.res||(H.ua&&H.ua.substring(0,2)==="SM"&&(H.ua=H.ua.substring(0,7)),H.ua&&q.indexOf(H.ua)<0))return!1;if(H.res){if(!H.res[0]||!H.res[1])return!1;var Ee=H.res[0],qe=H.res[1];if(Math.min(se,he)!=Math.min(Ee,qe)||Math.max(se,he)!=Math.max(Ee,qe))return!1}return!0};function vA(H){this.xdpi=H.xdpi,this.ydpi=H.ydpi,this.bevelMm=H.bevelMm}function hp(H,q){this.set(H,q)}hp.prototype.set=function(H,q){this.sample=H,this.timestampS=q},hp.prototype.copy=function(H){this.set(H.sample,H.timestampS)};function rf(H,q){this.kFilter=H,this.isDebug=q,this.currentAccelMeasurement=new hp,this.currentGyroMeasurement=new hp,this.previousGyroMeasurement=new hp,I()?this.filterQ=new zt(-1,0,0,1):this.filterQ=new zt(1,0,0,1),this.previousFilterQ=new zt,this.previousFilterQ.copy(this.filterQ),this.accelQ=new zt,this.isOrientationInitialized=!1,this.estimatedGravity=new We,this.measuredGravity=new We,this.gyroIntegralQ=new zt}rf.prototype.addAccelMeasurement=function(H,q){this.currentAccelMeasurement.set(H,q)},rf.prototype.addGyroMeasurement=function(H,q){this.currentGyroMeasurement.set(H,q);var se=q-this.previousGyroMeasurement.timestampS;K(se)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},rf.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var H=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,q=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,H);this.gyroIntegralQ.multiply(q),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(q);var se=new zt;se.copy(this.filterQ),se.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(se),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var he=new zt;he.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),he.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",$t*Xt(he),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var Ee=new zt;Ee.copy(this.filterQ),Ee.multiply(he),this.filterQ.slerp(Ee,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},rf.prototype.getOrientation=function(){return this.filterQ},rf.prototype.accelToQuaternion_=function(H){var q=new We;q.copy(H),q.normalize();var se=new zt;return se.setFromUnitVectors(new We(0,0,-1),q),se.inverse(),se},rf.prototype.gyroToQuaternionDelta_=function(H,q){var se=new zt,he=new We;return he.copy(H),he.normalize(),se.setFromAxisAngle(he,H.length()*q),se};function Ng(H,q){this.predictionTimeS=H,this.isDebug=q,this.previousQ=new zt,this.previousTimestampS=null,this.deltaQ=new zt,this.outQ=new zt}Ng.prototype.getPrediction=function(H,q,se){if(!this.previousTimestampS)return this.previousQ.copy(H),this.previousTimestampS=se,H;var he=new We;he.copy(q),he.normalize();var Ee=q.length();if(Ee<qt*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",($t*Ee).toFixed(1)),this.outQ.copy(H),this.previousQ.copy(H),this.outQ;var qe=Ee*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(he,qe),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(H),this.previousTimestampS=se,this.outQ};function Hl(H,q,se,he){this.yawOnly=se,this.accelerometer=new We,this.gyroscope=new We,this.filter=new rf(H,he),this.posePredictor=new Ng(q,he),this.isFirefoxAndroid=G(),this.isIOS=I();var Ee=W();this.isDeviceMotionInRadians=!this.isIOS&&Ee&&Ee<66,this.isWithoutDeviceMotion=me()||J(),this.filterToWorldQ=new zt,I()?this.filterToWorldQ.setFromAxisAngle(new We(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new We(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new zt,this.worldToScreenQ=new zt,this.originalPoseAdjustQ=new zt,this.originalPoseAdjustQ.setFromAxisAngle(new We(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),te()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new zt,this.orientationOut_=new Float32Array(4),this.start()}Hl.prototype.getPosition=function(){return null},Hl.prototype.getOrientation=function(){var H=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var Ee=new zt().setFromAxisAngle(new We(0,0,-1),0),qe=new zt;return window.orientation===-90?qe.setFromAxisAngle(new We(0,1,0),Math.PI/-2):qe.setFromAxisAngle(new We(0,1,0),Math.PI/2),Ee.multiply(qe)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var Ee=new zt;return Ee.setFromAxisAngle(new We(1,0,0),-Math.PI/2),Ee}(),H=this._deviceOrientationQ;var se=new zt;return se.copy(H),se.multiply(this.deviceOrientationFilterToWorldQ),se.multiply(this.resetQ),se.multiply(this.worldToScreenQ),se.multiplyQuaternions(this.deviceOrientationFixQ,se),this.yawOnly&&(se.x=0,se.z=0,se.normalize()),this.orientationOut_[0]=se.x,this.orientationOut_[1]=se.y,this.orientationOut_[2]=se.z,this.orientationOut_[3]=se.w,this.orientationOut_}else{var q=this.filter.getOrientation();H=this.posePredictor.getPrediction(q,this.gyroscope,this.previousTimestampS)}var se=new zt;return se.copy(this.filterToWorldQ),se.multiply(this.resetQ),se.multiply(H),se.multiply(this.worldToScreenQ),this.yawOnly&&(se.x=0,se.z=0,se.normalize()),this.orientationOut_[0]=se.x,this.orientationOut_[1]=se.y,this.orientationOut_[2]=se.z,this.orientationOut_[3]=se.w,this.orientationOut_},Hl.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),te()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},Hl.prototype.onDeviceOrientation_=function(H){this._deviceOrientationQ=this._deviceOrientationQ||new zt;var q=H.alpha,se=H.beta,he=H.gamma;q=(q||0)*Math.PI/180,se=(se||0)*Math.PI/180,he=(he||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(se,q,-he)},Hl.prototype.onDeviceMotion_=function(H){this.updateDeviceMotion_(H)},Hl.prototype.updateDeviceMotion_=function(H){var q=H.accelerationIncludingGravity,se=H.rotationRate,he=H.timeStamp/1e3,Ee=he-this.previousTimestampS;if(Ee<0){ti("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=he;return}else if(Ee<=y||Ee>T){ti("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=he;return}this.accelerometer.set(-q.x,-q.y,-q.z),se&&(pe()?this.gyroscope.set(-se.beta,se.alpha,se.gamma):this.gyroscope.set(se.alpha,se.beta,se.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,he)),this.filter.addAccelMeasurement(this.accelerometer,he),this.previousTimestampS=he},Hl.prototype.onOrientationChange_=function(H){this.setScreenTransform_()},Hl.prototype.onMessage_=function(H){var q=H.data;if(!(!q||!q.type)){var se=q.type.toLowerCase();se==="devicemotion"&&this.updateDeviceMotion_(q.deviceMotionEvent)}},Hl.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new We(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new We(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},Hl.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),I()&&st()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},Hl.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var vm=60,V1=new We(1,0,0),z1=new We(0,0,1),Ug=new zt;Ug.setFromAxisAngle(V1,-Math.PI/2),Ug.multiply(new zt().setFromAxisAngle(z1,Math.PI/2));var Vc=function(){function H(q){u(this,H),this.config=q,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new zt,this._outQ=new zt,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return f(H,[{key:"init",value:function(){var se=null;try{se=new RelativeOrientationSensor({frequency:vm,referenceFrame:"screen"}),se.addEventListener("error",this._onSensorError)}catch(he){this.errors.push(he),he.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):he.name==="ReferenceError"?this.useDeviceMotion():console.error(he)}se&&(this.api="sensor",this.sensor=se,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new Hl(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var se=this.sensor.quaternion;this._sensorQ.set(se[0],se[1],se[2],se[3]);var he=this._outQ;return he.copy(Ug),he.multiply(this._sensorQ),this.config.YAW_ONLY&&(he.x=he.z=0,he.normalize()),this._out[0]=he.x,this._out[1]=he.y,this._out[2]=he.z,this._out[3]=he.w,this._out}},{key:"_onSensorError",value:function(se){this.errors.push(se.error),se.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):se.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(se.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),H}(),H1="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function sf(){this.loadIcon_();var H=document.createElement("div"),dt=H.style;dt.position="fixed",dt.top=0,dt.right=0,dt.bottom=0,dt.left=0,dt.backgroundColor="gray",dt.fontFamily="sans-serif",dt.zIndex=1e6;var q=document.createElement("img");q.src=this.icon;var dt=q.style;dt.marginLeft="25%",dt.marginTop="25%",dt.width="50%",H.appendChild(q);var se=document.createElement("div"),dt=se.style;dt.textAlign="center",dt.fontSize="16px",dt.lineHeight="24px",dt.margin="24px 25%",dt.width="50%",se.innerHTML="Place your phone into your Cardboard viewer.",H.appendChild(se);var he=document.createElement("div"),dt=he.style;dt.backgroundColor="#CFD8DC",dt.position="fixed",dt.bottom=0,dt.width="100%",dt.height="48px",dt.padding="14px 24px",dt.boxSizing="border-box",dt.color="#656A6B",H.appendChild(he);var Ee=document.createElement("div");Ee.style.float="left",Ee.innerHTML="No Cardboard viewer?";var qe=document.createElement("a");qe.href="https://www.google.com/get/cardboard/get-cardboard/",qe.innerHTML="get one",qe.target="_blank";var dt=qe.style;dt.float="right",dt.fontWeight=600,dt.textTransform="uppercase",dt.borderLeft="1px solid gray",dt.paddingLeft="24px",dt.textDecoration="none",dt.color="#656A6B",he.appendChild(Ee),he.appendChild(qe),this.overlay=H,this.text=se,this.hide()}sf.prototype.show=function(H){!H&&!this.overlay.parentElement?document.body.appendChild(this.overlay):H&&(this.overlay.parentElement&&this.overlay.parentElement!=H&&this.overlay.parentElement.removeChild(this.overlay),H.appendChild(this.overlay)),this.overlay.style.display="block";var q=this.overlay.querySelector("img"),se=q.style;te()?(se.width="20%",se.marginLeft="40%",se.marginTop="3%"):(se.width="50%",se.marginLeft="25%",se.marginTop="25%")},sf.prototype.hide=function(){this.overlay.style.display="none"},sf.prototype.showTemporarily=function(H,q){this.show(q),this.timer=setTimeout(this.hide.bind(this),H)},sf.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},sf.prototype.update=function(){this.disableShowTemporarily(),!te()&&Pt()?this.show():this.hide()},sf.prototype.loadIcon_=function(){this.icon=w("image/svg+xml",H1)};var yA="CardboardV1",Pe="WEBVR_CARDBOARD_VIEWER",Ut="webvr-polyfill-viewer-selector";function Mt(H){try{this.selectedKey=localStorage.getItem(Pe)}catch(q){console.error("Failed to load viewer profile: %s",q)}this.selectedKey||(this.selectedKey=H||yA),this.dialog=this.createDialog_(Ii.Viewers),this.root=null,this.onChangeCallbacks_=[]}Mt.prototype.show=function(H){this.root=H,H.appendChild(this.dialog);var q=this.dialog.querySelector("#"+this.selectedKey);q.checked=!0,this.dialog.style.display="block"},Mt.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},Mt.prototype.getCurrentViewer=function(){return Ii.Viewers[this.selectedKey]},Mt.prototype.getSelectedKey_=function(){var H=this.dialog.querySelector("input[name=field]:checked");return H?H.id:null},Mt.prototype.onChange=function(H){this.onChangeCallbacks_.push(H)},Mt.prototype.fireOnChange_=function(H){for(var q=0;q<this.onChangeCallbacks_.length;q++)this.onChangeCallbacks_[q](H)},Mt.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!Ii.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(Ii.Viewers[this.selectedKey]);try{localStorage.setItem(Pe,this.selectedKey)}catch(H){console.error("Failed to save viewer profile: %s",H)}this.hide()},Mt.prototype.createDialog_=function(H){var q=document.createElement("div");q.classList.add(Ut),q.style.display="none";var se=document.createElement("div"),qe=se.style;qe.position="fixed",qe.left=0,qe.top=0,qe.width="100%",qe.height="100%",qe.background="rgba(0, 0, 0, 0.3)",se.addEventListener("click",this.hide.bind(this));var he=280,Ee=document.createElement("div"),qe=Ee.style;qe.boxSizing="border-box",qe.position="fixed",qe.top="24px",qe.left="50%",qe.marginLeft=-he/2+"px",qe.width=he+"px",qe.padding="24px",qe.overflow="hidden",qe.background="#fafafa",qe.fontFamily="'Roboto', sans-serif",qe.boxShadow="0px 5px 20px #666",Ee.appendChild(this.createH1_("Select your viewer"));for(var dt in H)Ee.appendChild(this.createChoice_(dt,H[dt].label));return Ee.appendChild(this.createButton_("Save",this.onSave_.bind(this))),q.appendChild(se),q.appendChild(Ee),q},Mt.prototype.createH1_=function(H){var q=document.createElement("h1"),se=q.style;return se.color="black",se.fontSize="20px",se.fontWeight="bold",se.marginTop=0,se.marginBottom="24px",q.innerHTML=H,q},Mt.prototype.createChoice_=function(H,q){var se=document.createElement("div");se.style.marginTop="8px",se.style.color="black";var he=document.createElement("input");he.style.fontSize="30px",he.setAttribute("id",H),he.setAttribute("type","radio"),he.setAttribute("value",H),he.setAttribute("name","field");var Ee=document.createElement("label");return Ee.style.marginLeft="4px",Ee.setAttribute("for",H),Ee.innerHTML=q,se.appendChild(he),se.appendChild(Ee),se},Mt.prototype.createButton_=function(H,q){var se=document.createElement("button");se.innerHTML=H;var he=se.style;return he.float="right",he.textTransform="uppercase",he.color="#1094f7",he.fontSize="14px",he.letterSpacing=0,he.border=0,he.background="none",he.marginTop="16px",se.addEventListener("click",q),se};var Wt=typeof window<"u"?window:typeof m<"u"?m:typeof self<"u"?self:{};function Di(H){return H&&H.__esModule&&Object.prototype.hasOwnProperty.call(H,"default")?H.default:H}function ir(H,q){return q={exports:{}},H(q,q.exports),q.exports}var Vn=ir(function(H,q){(function(he,Ee){H.exports=Ee()})(Wt,function(){return function(se){var he={};function Ee(qe){if(he[qe])return he[qe].exports;var dt=he[qe]={i:qe,l:!1,exports:{}};return se[qe].call(dt.exports,dt,dt.exports,Ee),dt.l=!0,dt.exports}return Ee.m=se,Ee.c=he,Ee.d=function(qe,dt,ri){Ee.o(qe,dt)||Object.defineProperty(qe,dt,{configurable:!1,enumerable:!0,get:ri})},Ee.n=function(qe){var dt=qe&&qe.__esModule?function(){return qe.default}:function(){return qe};return Ee.d(dt,"a",dt),dt},Ee.o=function(qe,dt){return Object.prototype.hasOwnProperty.call(qe,dt)},Ee.p="",Ee(Ee.s=0)}([function(se,he,Ee){var qe=function(){function Bt(fi,Hi){for(var rn=0;rn<Hi.length;rn++){var _n=Hi[rn];_n.enumerable=_n.enumerable||!1,_n.configurable=!0,"value"in _n&&(_n.writable=!0),Object.defineProperty(fi,_n.key,_n)}}return function(fi,Hi,rn){return Hi&&Bt(fi.prototype,Hi),rn&&Bt(fi,rn),fi}}();function dt(Bt,fi){if(!(Bt instanceof fi))throw new TypeError("Cannot call a class as a function")}var ri=Ee(1),Zt=typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,Tt=function(){function Bt(){dt(this,Bt),Zt?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",ri),this.noSleepVideo.addEventListener("timeupdate",(function(fi){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}).bind(this)))}return qe(Bt,[{key:"enable",value:function(){Zt?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){Zt?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),Bt}();se.exports=Tt},function(se,he,Ee){se.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),lr=Di(Vn),zn=1e3,Ys=[0,0,.5,1],Ns=[.5,0,.5,1],Ln=window.requestAnimationFrame,Or=window.cancelAnimationFrame;function zc(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function Jr(H){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:H.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:H.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:H.canPresent},maxLayers:{writable:!1,enumerable:!0,value:H.maxLayers},hasOrientation:{enumerable:!0,get:function(){return ni("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),H.hasOrientation}}})}function Cr(H){H=H||{};var q="wakelock"in H?H.wakelock:!0;this.isPolyfilled=!0,this.displayId=zn++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return ni("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new Jr({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,q&&Pt()&&(this.wakelock_=new lr)}Cr.prototype.getFrameData=function(H){return Ke(H,this._getPose(),this)},Cr.prototype.getPose=function(){return ni("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Cr.prototype.resetPose=function(){return ni("VRDisplay.prototype.resetPose"),this._resetPose()},Cr.prototype.getImmediatePose=function(){return ni("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Cr.prototype.requestAnimationFrame=function(H){return Ln(H)},Cr.prototype.cancelAnimationFrame=function(H){return Or(H)},Cr.prototype.wrapForFullscreen=function(H){if(I())return H;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var q=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",q.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==H)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=H,this.originalParent_=H.parentElement,this.originalParent_||document.body.appendChild(H),!this.fullscreenWrapper_.parentElement){var se=this.fullscreenElement_.parentElement;se.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),se.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var he=this;function Ee(){if(he.fullscreenElement_){var qe=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];he.fullscreenElement_.setAttribute("style",qe.join("; ")+";")}}return Ee(),this.fullscreenWrapper_},Cr.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var H=this.fullscreenElement_;this.fullscreenElementCachedStyle_?H.setAttribute("style",this.fullscreenElementCachedStyle_):H.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var q=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(H),this.originalParent_===q?q.insertBefore(H,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(H),q.removeChild(this.fullscreenWrapper_),H}},Cr.prototype.requestPresent=function(H){var q=this.isPresenting,se=this;return H instanceof Array||(ni("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),H=[H]),new Promise(function(he,Ee){if(!se.capabilities.canPresent){Ee(new Error("VRDisplay is not capable of presenting."));return}if(H.length==0||H.length>se.capabilities.maxLayers){Ee(new Error("Invalid number of layers."));return}var qe=H[0];if(!qe.source){he();return}var dt=qe.leftBounds||Ys,ri=qe.rightBounds||Ns;if(q){var Zt=se.layer_;Zt.source!==qe.source&&(Zt.source=qe.source);for(var Tt=0;Tt<4;Tt++)Zt.leftBounds[Tt]=dt[Tt],Zt.rightBounds[Tt]=ri[Tt];se.wrapForFullscreen(se.layer_.source),se.updatePresent_(),he();return}if(se.layer_={predistorted:qe.predistorted,source:qe.source,leftBounds:dt.slice(0),rightBounds:ri.slice(0)},se.waitingForPresent_=!1,se.layer_&&se.layer_.source){var Bt=se.wrapForFullscreen(se.layer_.source),fi=function(){var _n=at();se.isPresenting=Bt===_n,se.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(mr){console.error("screen.orientation.lock() failed due to",mr.message)}),se.waitingForPresent_=!1,se.beginPresent_(),he()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),se.removeFullscreenWrapper(),se.disableWakeLock(),se.endPresent_(),se.removeFullscreenListeners_()),se.fireVRDisplayPresentChange_()},Hi=function(){se.waitingForPresent_&&(se.removeFullscreenWrapper(),se.removeFullscreenListeners_(),se.disableWakeLock(),se.waitingForPresent_=!1,se.isPresenting=!1,Ee(new Error("Unable to present.")))};se.addFullscreenListeners_(Bt,fi,Hi),Ue(Bt)?(se.enableWakeLock(),se.waitingForPresent_=!0):(I()||z())&&(se.enableWakeLock(),se.isPresenting=!0,se.beginPresent_(),se.fireVRDisplayPresentChange_(),he())}!se.waitingForPresent_&&!I()&&(Ae(),Ee(new Error("Unable to present.")))})},Cr.prototype.exitPresent=function(){var H=this.isPresenting,q=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(se,he){H?(!Ae()&&I()&&(q.endPresent_(),q.fireVRDisplayPresentChange_()),z()&&(q.removeFullscreenWrapper(),q.removeFullscreenListeners_(),q.endPresent_(),q.fireVRDisplayPresentChange_()),se()):he(new Error("Was not presenting to VRDisplay."))})},Cr.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Cr.prototype.fireVRDisplayPresentChange_=function(){var H=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(H)},Cr.prototype.fireVRDisplayConnect_=function(){var H=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(H)},Cr.prototype.addFullscreenListeners_=function(H,q,se){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=H,this.fullscreenChangeHandler_=q,this.fullscreenErrorHandler_=se,q&&(document.fullscreenEnabled?H.addEventListener("fullscreenchange",q,!1):document.webkitFullscreenEnabled?H.addEventListener("webkitfullscreenchange",q,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",q,!1):document.msFullscreenEnabled&&H.addEventListener("msfullscreenchange",q,!1)),se&&(document.fullscreenEnabled?H.addEventListener("fullscreenerror",se,!1):document.webkitFullscreenEnabled?H.addEventListener("webkitfullscreenerror",se,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",se,!1):document.msFullscreenEnabled&&H.addEventListener("msfullscreenerror",se,!1))},Cr.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var H=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var q=this.fullscreenChangeHandler_;H.removeEventListener("fullscreenchange",q,!1),H.removeEventListener("webkitfullscreenchange",q,!1),document.removeEventListener("mozfullscreenchange",q,!1),H.removeEventListener("msfullscreenchange",q,!1)}if(this.fullscreenErrorHandler_){var se=this.fullscreenErrorHandler_;H.removeEventListener("fullscreenerror",se,!1),H.removeEventListener("webkitfullscreenerror",se,!1),document.removeEventListener("mozfullscreenerror",se,!1),H.removeEventListener("msfullscreenerror",se,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Cr.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Cr.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Cr.prototype.beginPresent_=function(){},Cr.prototype.endPresent_=function(){},Cr.prototype.submitFrame=function(H){},Cr.prototype.getEyeParameters=function(H){return null};var ya={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},fp={LEFT:"left",RIGHT:"right"};function Tr(H){var q=Nt({},ya);H=Nt(q,H||{}),Cr.call(this,{wakelock:H.MOBILE_WAKE_LOCK}),this.config=H,this.displayName="Cardboard VRDisplay",this.capabilities=new Jr({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new Vc(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new dp(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new Ii(this.dpdb_.getDeviceParams(),H.ADDITIONAL_VIEWERS),this.viewerSelector_=new Mt(H.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new sf),I()&&window.addEventListener("resize",this.onResize_.bind(this))}return Tr.prototype=Object.create(Cr.prototype),Tr.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},Tr.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},Tr.prototype._getFieldOfView=function(H){var q;if(H==fp.LEFT)q=this.deviceInfo_.getFieldOfViewLeftEye();else if(H==fp.RIGHT)q=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",H),null;return q},Tr.prototype._getEyeOffset=function(H){var q;if(H==fp.LEFT)q=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(H==fp.RIGHT)q=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",H),null;return q},Tr.prototype.getEyeParameters=function(H){var q=this._getEyeOffset(H),se=this._getFieldOfView(H),he={offset:q,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(he,"fieldOfView",{enumerable:!0,get:function(){return ni("VRFieldOfView","VRFrameData's projection matrices"),se}}),he},Tr.prototype.onDeviceParamsUpdated_=function(H){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(H),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},Tr.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},Tr.prototype.beginPresent_=function(){var H=this.layer_.source.getContext("webgl");H||(H=this.layer_.source.getContext("experimental-webgl")),H||(H=this.layer_.source.getContext("webgl2")),H&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(H.canvas.width=He()*this.bufferScale_,H.canvas.height=$e()*this.bufferScale_,this.cardboardUI_=new Ie(H)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new Ie(H)),this.distorter_=new Pn(H,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen((function(q){this.viewerSelector_.show(this.layer_.source.parentElement),q.stopPropagation(),q.preventDefault()}).bind(this),(function(q){this.exitPresent(),q.stopPropagation(),q.preventDefault()}).bind(this)),this.rotateInstructions_&&(te()&&Pt()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},Tr.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},Tr.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},Tr.prototype.submitFrame=function(H){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var q=this.layer_.source.getContext("webgl");q||(q=this.layer_.source.getContext("experimental-webgl")),q||(q=this.layer_.source.getContext("webgl2"));var se=q.canvas;(se.width!=this.lastWidth||se.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=se.width,this.lastHeight=se.height,this.cardboardUI_.render()}},Tr.prototype.onOrientationChange_=function(H){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},Tr.prototype.onResize_=function(H){if(this.layer_){var q=this.layer_.source.getContext("webgl");q||(q=this.layer_.source.getContext("experimental-webgl")),q||(q=this.layer_.source.getContext("webgl2"));var se=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];q.canvas.setAttribute("style",se.join("; ")+";"),nt(q.canvas)}},Tr.prototype.onViewerChanged_=function(H){this.deviceInfo_.setViewer(H),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},Tr.prototype.fireVRDisplayDeviceParamsChange_=function(){var H=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(H)},Tr.VRFrameData=zc,Tr.VRDisplay=Cr,Tr})})(b);var x=v(b.exports),C="0.10.12",B={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function P(l){this.config=h(h({},B),l),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&a())&&(this.enable(),this.getVRDisplays().then(function(o){o&&o[0]&&o[0].fireVRDisplayConnect_&&o[0].fireVRDisplayConnect_()}))}P.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(a()){var l=new x({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(l)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},P.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var l=this.native.VRFrameData,o=new this.native.VRFrameData,u=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(f){if(f instanceof l){u.call(this,f);return}u.call(this,o),f.pose=o.pose,c(o.leftProjectionMatrix,f.leftProjectionMatrix),c(o.rightProjectionMatrix,f.rightProjectionMatrix),c(o.leftViewMatrix,f.leftViewMatrix),c(o.rightViewMatrix,f.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=x.VRDisplay,window.VRFrameData=x.VRFrameData},P.prototype.getVRDisplays=function(){return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(l=>l.length>0?l:this.getPolyfillDisplays()):Promise.resolve(this.getPolyfillDisplays())},P.version=C,P.VRFrameData=x.VRFrameData,P.VRDisplay=x.VRDisplay;function N(l,o,u,f,g,y,T){try{var w=l[y](T),M=w.value}catch(I){u(I);return}w.done?o(M):Promise.resolve(M).then(f,g)}function ae(l){return function(){var o=this,u=arguments;return new Promise(function(f,g){var y=l.apply(o,u);function T(M){N(y,f,g,T,w,"next",M)}function w(M){N(y,f,g,T,w,"throw",M)}T(void 0)})}}function X(){return X=Object.assign?Object.assign.bind():function(l){for(var o=1;o<arguments.length;o++){var u=arguments[o];for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(l[f]=u[f])}return l},X.apply(this,arguments)}const de="125",ge={LEFT:0,MIDDLE:1,RIGHT:2},ue=0,be=1,fe=2,ve=1,ie=2,re=3,Ne=0,De=1,ke=2,ut=1,_t=0,vt=1,tt=2,je=3,it=4,Xe=5,Se=100,ct=101,xt=102,ii=103,Re=104,lt=200,bt=201,Je=202,Dt=203,Yt=204,vi=205,xi=206,Yi=207,Ki=208,io=209,yr=210,bs=0,cs=1,sn=2,dn=3,gn=4,Sr=5,fa=6,Oa=7,Js=0,Sa=1,ds=2,js=0,Vo=1,Aa=2,an=3,Ze=4,St=5,Ft=300,di=301,Oi=302,Fn=303,Ar=304,Zi=306,pi=307,ne=1e3,oe=1001,xe=1002,Ye=1003,jt=1004,bi=1005,Ui=1006,Qr=1007,Kr=1008,ur=1009,wa=1010,pa=1011,Ls=1012,Ir=1013,Gn=1014,ln=1015,Fa=1016,Pr=1017,ea=1018,no=1019,nn=1020,Lr=1021,ta=1022,cr=1023,kf=1024,_l=1025,rr=1026,zo=1027,xc=1028,Of=1029,Gr=1030,nd=1031,rd=1032,su=1033,bl=33776,Qu=33777,Ah=33778,Sc=33779,Rs=35840,Ho=35841,Gs=35842,ro=35843,au=36196,ou=37492,so=37496,Ba=37808,Ku=37809,lu=37810,Ff=37811,jo=37812,uu=37813,Bf=37814,Tl=37815,fo=37816,Na=37817,wh=37818,Jn=37819,cu=37820,Ac=37821,xl=36492,wc=37840,Eh=37841,sd=37842,Ch=37843,ad=37844,Sl=37845,ao=37846,Ua=37847,Al=37848,Zu=37849,wl=37850,Mh=37851,Nf=37852,Go=37853,od=2200,Dh=2201,ld=2202,El=2300,$o=2301,oo=2302,$s=2400,Va=2401,Cl=2402,ud=2500,Ih=2501,Ph=0,Ml=3e3,cd=3001,du=3007,Dl=3002,po=3003,hu=3004,Uf=3005,_r=3006,dd=3200,Vf=3201,Ts=0,mo=1,Wo=7680,go=519,fu=35044,xs=35048,za="300 es";function ks(){}X(ks.prototype,{addEventListener:function(l,o){this._listeners===void 0&&(this._listeners={});const u=this._listeners;u[l]===void 0&&(u[l]=[]),u[l].indexOf(o)===-1&&u[l].push(o)},hasEventListener:function(l,o){if(this._listeners===void 0)return!1;const u=this._listeners;return u[l]!==void 0&&u[l].indexOf(o)!==-1},removeEventListener:function(l,o){if(this._listeners===void 0)return;const f=this._listeners[l];if(f!==void 0){const g=f.indexOf(o);g!==-1&&f.splice(g,1)}},dispatchEvent:function(l){if(this._listeners===void 0)return;const u=this._listeners[l.type];if(u!==void 0){l.target=this;const f=u.slice(0);for(let g=0,y=f.length;g<y;g++)f[g].call(this,l)}}});const $r=[];for(let l=0;l<256;l++)$r[l]=(l<16?"0":"")+l.toString(16);let qo=1234567;const Gi={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const l=Math.random()*4294967295|0,o=Math.random()*4294967295|0,u=Math.random()*4294967295|0,f=Math.random()*4294967295|0;return($r[l&255]+$r[l>>8&255]+$r[l>>16&255]+$r[l>>24&255]+"-"+$r[o&255]+$r[o>>8&255]+"-"+$r[o>>16&15|64]+$r[o>>24&255]+"-"+$r[u&63|128]+$r[u>>8&255]+"-"+$r[u>>16&255]+$r[u>>24&255]+$r[f&255]+$r[f>>8&255]+$r[f>>16&255]+$r[f>>24&255]).toUpperCase()},clamp:function(l,o,u){return Math.max(o,Math.min(u,l))},euclideanModulo:function(l,o){return(l%o+o)%o},mapLinear:function(l,o,u,f,g){return f+(l-o)*(g-f)/(u-o)},lerp:function(l,o,u){return(1-u)*l+u*o},damp:function(l,o,u,f){return Gi.lerp(l,o,1-Math.exp(-u*f))},pingpong:function(l,o=1){return o-Math.abs(Gi.euclideanModulo(l,o*2)-o)},smoothstep:function(l,o,u){return l<=o?0:l>=u?1:(l=(l-o)/(u-o),l*l*(3-2*l))},smootherstep:function(l,o,u){return l<=o?0:l>=u?1:(l=(l-o)/(u-o),l*l*l*(l*(l*6-15)+10))},randInt:function(l,o){return l+Math.floor(Math.random()*(o-l+1))},randFloat:function(l,o){return l+Math.random()*(o-l)},randFloatSpread:function(l){return l*(.5-Math.random())},seededRandom:function(l){return l!==void 0&&(qo=l%2147483647),qo=qo*16807%2147483647,(qo-1)/2147483646},degToRad:function(l){return l*Gi.DEG2RAD},radToDeg:function(l){return l*Gi.RAD2DEG},isPowerOfTwo:function(l){return(l&l-1)===0&&l!==0},ceilPowerOfTwo:function(l){return Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},floorPowerOfTwo:function(l){return Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},setQuaternionFromProperEuler:function(l,o,u,f,g){const y=Math.cos,T=Math.sin,w=y(u/2),M=T(u/2),I=y((o+f)/2),z=T((o+f)/2),U=y((o-f)/2),G=T((o-f)/2),W=y((f-o)/2),J=T((f-o)/2);switch(g){case"XYX":l.set(w*z,M*U,M*G,w*I);break;case"YZY":l.set(M*G,w*z,M*U,w*I);break;case"ZXZ":l.set(M*U,M*G,w*z,w*I);break;case"XZX":l.set(w*z,M*J,M*W,w*I);break;case"YXY":l.set(M*W,w*z,M*J,w*I);break;case"ZYZ":l.set(M*J,M*W,w*z,w*I);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+g)}}};class At{constructor(o=0,u=0){Object.defineProperty(this,"isVector2",{value:!0}),this.x=o,this.y=u}get width(){return this.x}set width(o){this.x=o}get height(){return this.y}set height(o){this.y=o}set(o,u){return this.x=o,this.y=u,this}setScalar(o){return this.x=o,this.y=o,this}setX(o){return this.x=o,this}setY(o){return this.y=o,this}setComponent(o,u){switch(o){case 0:this.x=u;break;case 1:this.y=u;break;default:throw new Error("index is out of range: "+o)}return this}getComponent(o){switch(o){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+o)}}clone(){return new this.constructor(this.x,this.y)}copy(o){return this.x=o.x,this.y=o.y,this}add(o,u){return u!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(o,u)):(this.x+=o.x,this.y+=o.y,this)}addScalar(o){return this.x+=o,this.y+=o,this}addVectors(o,u){return this.x=o.x+u.x,this.y=o.y+u.y,this}addScaledVector(o,u){return this.x+=o.x*u,this.y+=o.y*u,this}sub(o,u){return u!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(o,u)):(this.x-=o.x,this.y-=o.y,this)}subScalar(o){return this.x-=o,this.y-=o,this}subVectors(o,u){return this.x=o.x-u.x,this.y=o.y-u.y,this}multiply(o){return this.x*=o.x,this.y*=o.y,this}multiplyScalar(o){return this.x*=o,this.y*=o,this}divide(o){return this.x/=o.x,this.y/=o.y,this}divideScalar(o){return this.multiplyScalar(1/o)}applyMatrix3(o){const u=this.x,f=this.y,g=o.elements;return this.x=g[0]*u+g[3]*f+g[6],this.y=g[1]*u+g[4]*f+g[7],this}min(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this}max(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this}clamp(o,u){return this.x=Math.max(o.x,Math.min(u.x,this.x)),this.y=Math.max(o.y,Math.min(u.y,this.y)),this}clampScalar(o,u){return this.x=Math.max(o,Math.min(u,this.x)),this.y=Math.max(o,Math.min(u,this.y)),this}clampLength(o,u){const f=this.length();return this.divideScalar(f||1).multiplyScalar(Math.max(o,Math.min(u,f)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(o){return this.x*o.x+this.y*o.y}cross(o){return this.x*o.y-this.y*o.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(o){return Math.sqrt(this.distanceToSquared(o))}distanceToSquared(o){const u=this.x-o.x,f=this.y-o.y;return u*u+f*f}manhattanDistanceTo(o){return Math.abs(this.x-o.x)+Math.abs(this.y-o.y)}setLength(o){return this.normalize().multiplyScalar(o)}lerp(o,u){return this.x+=(o.x-this.x)*u,this.y+=(o.y-this.y)*u,this}lerpVectors(o,u,f){return this.x=o.x+(u.x-o.x)*f,this.y=o.y+(u.y-o.y)*f,this}equals(o){return o.x===this.x&&o.y===this.y}fromArray(o,u=0){return this.x=o[u],this.y=o[u+1],this}toArray(o=[],u=0){return o[u]=this.x,o[u+1]=this.y,o}fromBufferAttribute(o,u,f){return f!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=o.getX(u),this.y=o.getY(u),this}rotateAround(o,u){const f=Math.cos(u),g=Math.sin(u),y=this.x-o.x,T=this.y-o.y;return this.x=y*f-T*g+o.x,this.y=y*g+T*f+o.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}class Os{constructor(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(o,u,f,g,y,T,w,M,I){const z=this.elements;return z[0]=o,z[1]=g,z[2]=w,z[3]=u,z[4]=y,z[5]=M,z[6]=f,z[7]=T,z[8]=I,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}clone(){return new this.constructor().fromArray(this.elements)}copy(o){const u=this.elements,f=o.elements;return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5],u[6]=f[6],u[7]=f[7],u[8]=f[8],this}extractBasis(o,u,f){return o.setFromMatrix3Column(this,0),u.setFromMatrix3Column(this,1),f.setFromMatrix3Column(this,2),this}setFromMatrix4(o){const u=o.elements;return this.set(u[0],u[4],u[8],u[1],u[5],u[9],u[2],u[6],u[10]),this}multiply(o){return this.multiplyMatrices(this,o)}premultiply(o){return this.multiplyMatrices(o,this)}multiplyMatrices(o,u){const f=o.elements,g=u.elements,y=this.elements,T=f[0],w=f[3],M=f[6],I=f[1],z=f[4],U=f[7],G=f[2],W=f[5],J=f[8],me=g[0],pe=g[3],te=g[6],K=g[1],He=g[4],$e=g[7],Ue=g[2],Ae=g[5],at=g[8];return y[0]=T*me+w*K+M*Ue,y[3]=T*pe+w*He+M*Ae,y[6]=T*te+w*$e+M*at,y[1]=I*me+z*K+U*Ue,y[4]=I*pe+z*He+U*Ae,y[7]=I*te+z*$e+U*at,y[2]=G*me+W*K+J*Ue,y[5]=G*pe+W*He+J*Ae,y[8]=G*te+W*$e+J*at,this}multiplyScalar(o){const u=this.elements;return u[0]*=o,u[3]*=o,u[6]*=o,u[1]*=o,u[4]*=o,u[7]*=o,u[2]*=o,u[5]*=o,u[8]*=o,this}determinant(){const o=this.elements,u=o[0],f=o[1],g=o[2],y=o[3],T=o[4],w=o[5],M=o[6],I=o[7],z=o[8];return u*T*z-u*w*I-f*y*z+f*w*M+g*y*I-g*T*M}invert(){const o=this.elements,u=o[0],f=o[1],g=o[2],y=o[3],T=o[4],w=o[5],M=o[6],I=o[7],z=o[8],U=z*T-w*I,G=w*M-z*y,W=I*y-T*M,J=u*U+f*G+g*W;if(J===0)return this.set(0,0,0,0,0,0,0,0,0);const me=1/J;return o[0]=U*me,o[1]=(g*I-z*f)*me,o[2]=(w*f-g*T)*me,o[3]=G*me,o[4]=(z*u-g*M)*me,o[5]=(g*y-w*u)*me,o[6]=W*me,o[7]=(f*M-I*u)*me,o[8]=(T*u-f*y)*me,this}transpose(){let o;const u=this.elements;return o=u[1],u[1]=u[3],u[3]=o,o=u[2],u[2]=u[6],u[6]=o,o=u[5],u[5]=u[7],u[7]=o,this}getNormalMatrix(o){return this.setFromMatrix4(o).copy(this).invert().transpose()}transposeIntoArray(o){const u=this.elements;return o[0]=u[0],o[1]=u[3],o[2]=u[6],o[3]=u[1],o[4]=u[4],o[5]=u[7],o[6]=u[2],o[7]=u[5],o[8]=u[8],this}setUvTransform(o,u,f,g,y,T,w){const M=Math.cos(y),I=Math.sin(y);return this.set(f*M,f*I,-f*(M*T+I*w)+T+o,-g*I,g*M,-g*(-I*T+M*w)+w+u,0,0,1),this}scale(o,u){const f=this.elements;return f[0]*=o,f[3]*=o,f[6]*=o,f[1]*=u,f[4]*=u,f[7]*=u,this}rotate(o){const u=Math.cos(o),f=Math.sin(o),g=this.elements,y=g[0],T=g[3],w=g[6],M=g[1],I=g[4],z=g[7];return g[0]=u*y+f*M,g[3]=u*T+f*I,g[6]=u*w+f*z,g[1]=-f*y+u*M,g[4]=-f*T+u*I,g[7]=-f*w+u*z,this}translate(o,u){const f=this.elements;return f[0]+=o*f[2],f[3]+=o*f[5],f[6]+=o*f[8],f[1]+=u*f[2],f[4]+=u*f[5],f[7]+=u*f[8],this}equals(o){const u=this.elements,f=o.elements;for(let g=0;g<9;g++)if(u[g]!==f[g])return!1;return!0}fromArray(o,u=0){for(let f=0;f<9;f++)this.elements[f]=o[f+u];return this}toArray(o=[],u=0){const f=this.elements;return o[u]=f[0],o[u+1]=f[1],o[u+2]=f[2],o[u+3]=f[3],o[u+4]=f[4],o[u+5]=f[5],o[u+6]=f[6],o[u+7]=f[7],o[u+8]=f[8],o}}let Xo;const pu={getDataURL:function(l){if(/^data:/i.test(l.src)||typeof HTMLCanvasElement>"u")return l.src;let o;if(l instanceof HTMLCanvasElement)o=l;else{Xo===void 0&&(Xo=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Xo.width=l.width,Xo.height=l.height;const u=Xo.getContext("2d");l instanceof ImageData?u.putImageData(l,0,0):u.drawImage(l,0,0,l.width,l.height),o=Xo}return o.width>2048||o.height>2048?o.toDataURL("image/jpeg",.6):o.toDataURL("image/png")}};let hd=0;function dr(l=dr.DEFAULT_IMAGE,o=dr.DEFAULT_MAPPING,u=oe,f=oe,g=Ui,y=Kr,T=cr,w=ur,M=1,I=Ml){Object.defineProperty(this,"id",{value:hd++}),this.uuid=Gi.generateUUID(),this.name="",this.image=l,this.mipmaps=[],this.mapping=o,this.wrapS=u,this.wrapT=f,this.magFilter=g,this.minFilter=y,this.anisotropy=M,this.format=T,this.internalFormat=null,this.type=w,this.offset=new At(0,0),this.repeat=new At(1,1),this.center=new At(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Os,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=I,this.version=0,this.onUpdate=null}dr.DEFAULT_IMAGE=void 0,dr.DEFAULT_MAPPING=Ft,dr.prototype=X(Object.create(ks.prototype),{constructor:dr,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(l){return this.name=l.name,this.image=l.image,this.mipmaps=l.mipmaps.slice(0),this.mapping=l.mapping,this.wrapS=l.wrapS,this.wrapT=l.wrapT,this.magFilter=l.magFilter,this.minFilter=l.minFilter,this.anisotropy=l.anisotropy,this.format=l.format,this.internalFormat=l.internalFormat,this.type=l.type,this.offset.copy(l.offset),this.repeat.copy(l.repeat),this.center.copy(l.center),this.rotation=l.rotation,this.matrixAutoUpdate=l.matrixAutoUpdate,this.matrix.copy(l.matrix),this.generateMipmaps=l.generateMipmaps,this.premultiplyAlpha=l.premultiplyAlpha,this.flipY=l.flipY,this.unpackAlignment=l.unpackAlignment,this.encoding=l.encoding,this},toJSON:function(l){const o=l===void 0||typeof l=="string";if(!o&&l.textures[this.uuid]!==void 0)return l.textures[this.uuid];const u={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const f=this.image;if(f.uuid===void 0&&(f.uuid=Gi.generateUUID()),!o&&l.images[f.uuid]===void 0){let g;if(Array.isArray(f)){g=[];for(let y=0,T=f.length;y<T;y++)f[y].isDataTexture?g.push(Ju(f[y].image)):g.push(Ju(f[y]))}else g=Ju(f);l.images[f.uuid]={uuid:f.uuid,url:g}}u.image=f.uuid}return o||(l.textures[this.uuid]=u),u},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(l){if(this.mapping!==Ft)return l;if(l.applyMatrix3(this.matrix),l.x<0||l.x>1)switch(this.wrapS){case ne:l.x=l.x-Math.floor(l.x);break;case oe:l.x=l.x<0?0:1;break;case xe:Math.abs(Math.floor(l.x)%2)===1?l.x=Math.ceil(l.x)-l.x:l.x=l.x-Math.floor(l.x);break}if(l.y<0||l.y>1)switch(this.wrapT){case ne:l.y=l.y-Math.floor(l.y);break;case oe:l.y=l.y<0?0:1;break;case xe:Math.abs(Math.floor(l.y)%2)===1?l.y=Math.ceil(l.y)-l.y:l.y=l.y-Math.floor(l.y);break}return this.flipY&&(l.y=1-l.y),l}}),Object.defineProperty(dr.prototype,"needsUpdate",{set:function(l){l===!0&&this.version++}});function Ju(l){return typeof HTMLImageElement<"u"&&l instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&l instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&l instanceof ImageBitmap?pu.getDataURL(l):l.data?{data:Array.prototype.slice.call(l.data),width:l.width,height:l.height,type:l.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}class Yn{constructor(o=0,u=0,f=0,g=1){Object.defineProperty(this,"isVector4",{value:!0}),this.x=o,this.y=u,this.z=f,this.w=g}get width(){return this.z}set width(o){this.z=o}get height(){return this.w}set height(o){this.w=o}set(o,u,f,g){return this.x=o,this.y=u,this.z=f,this.w=g,this}setScalar(o){return this.x=o,this.y=o,this.z=o,this.w=o,this}setX(o){return this.x=o,this}setY(o){return this.y=o,this}setZ(o){return this.z=o,this}setW(o){return this.w=o,this}setComponent(o,u){switch(o){case 0:this.x=u;break;case 1:this.y=u;break;case 2:this.z=u;break;case 3:this.w=u;break;default:throw new Error("index is out of range: "+o)}return this}getComponent(o){switch(o){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+o)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(o){return this.x=o.x,this.y=o.y,this.z=o.z,this.w=o.w!==void 0?o.w:1,this}add(o,u){return u!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(o,u)):(this.x+=o.x,this.y+=o.y,this.z+=o.z,this.w+=o.w,this)}addScalar(o){return this.x+=o,this.y+=o,this.z+=o,this.w+=o,this}addVectors(o,u){return this.x=o.x+u.x,this.y=o.y+u.y,this.z=o.z+u.z,this.w=o.w+u.w,this}addScaledVector(o,u){return this.x+=o.x*u,this.y+=o.y*u,this.z+=o.z*u,this.w+=o.w*u,this}sub(o,u){return u!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(o,u)):(this.x-=o.x,this.y-=o.y,this.z-=o.z,this.w-=o.w,this)}subScalar(o){return this.x-=o,this.y-=o,this.z-=o,this.w-=o,this}subVectors(o,u){return this.x=o.x-u.x,this.y=o.y-u.y,this.z=o.z-u.z,this.w=o.w-u.w,this}multiply(o){return this.x*=o.x,this.y*=o.y,this.z*=o.z,this.w*=o.w,this}multiplyScalar(o){return this.x*=o,this.y*=o,this.z*=o,this.w*=o,this}applyMatrix4(o){const u=this.x,f=this.y,g=this.z,y=this.w,T=o.elements;return this.x=T[0]*u+T[4]*f+T[8]*g+T[12]*y,this.y=T[1]*u+T[5]*f+T[9]*g+T[13]*y,this.z=T[2]*u+T[6]*f+T[10]*g+T[14]*y,this.w=T[3]*u+T[7]*f+T[11]*g+T[15]*y,this}divideScalar(o){return this.multiplyScalar(1/o)}setAxisAngleFromQuaternion(o){this.w=2*Math.acos(o.w);const u=Math.sqrt(1-o.w*o.w);return u<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=o.x/u,this.y=o.y/u,this.z=o.z/u),this}setAxisAngleFromRotationMatrix(o){let u,f,g,y;const M=o.elements,I=M[0],z=M[4],U=M[8],G=M[1],W=M[5],J=M[9],me=M[2],pe=M[6],te=M[10];if(Math.abs(z-G)<.01&&Math.abs(U-me)<.01&&Math.abs(J-pe)<.01){if(Math.abs(z+G)<.1&&Math.abs(U+me)<.1&&Math.abs(J+pe)<.1&&Math.abs(I+W+te-3)<.1)return this.set(1,0,0,0),this;u=Math.PI;const He=(I+1)/2,$e=(W+1)/2,Ue=(te+1)/2,Ae=(z+G)/4,at=(U+me)/4,Ht=(J+pe)/4;return He>$e&&He>Ue?He<.01?(f=0,g=.707106781,y=.707106781):(f=Math.sqrt(He),g=Ae/f,y=at/f):$e>Ue?$e<.01?(f=.707106781,g=0,y=.707106781):(g=Math.sqrt($e),f=Ae/g,y=Ht/g):Ue<.01?(f=.707106781,g=.707106781,y=0):(y=Math.sqrt(Ue),f=at/y,g=Ht/y),this.set(f,g,y,u),this}let K=Math.sqrt((pe-J)*(pe-J)+(U-me)*(U-me)+(G-z)*(G-z));return Math.abs(K)<.001&&(K=1),this.x=(pe-J)/K,this.y=(U-me)/K,this.z=(G-z)/K,this.w=Math.acos((I+W+te-1)/2),this}min(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this.z=Math.min(this.z,o.z),this.w=Math.min(this.w,o.w),this}max(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this.z=Math.max(this.z,o.z),this.w=Math.max(this.w,o.w),this}clamp(o,u){return this.x=Math.max(o.x,Math.min(u.x,this.x)),this.y=Math.max(o.y,Math.min(u.y,this.y)),this.z=Math.max(o.z,Math.min(u.z,this.z)),this.w=Math.max(o.w,Math.min(u.w,this.w)),this}clampScalar(o,u){return this.x=Math.max(o,Math.min(u,this.x)),this.y=Math.max(o,Math.min(u,this.y)),this.z=Math.max(o,Math.min(u,this.z)),this.w=Math.max(o,Math.min(u,this.w)),this}clampLength(o,u){const f=this.length();return this.divideScalar(f||1).multiplyScalar(Math.max(o,Math.min(u,f)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(o){return this.x*o.x+this.y*o.y+this.z*o.z+this.w*o.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(o){return this.normalize().multiplyScalar(o)}lerp(o,u){return this.x+=(o.x-this.x)*u,this.y+=(o.y-this.y)*u,this.z+=(o.z-this.z)*u,this.w+=(o.w-this.w)*u,this}lerpVectors(o,u,f){return this.x=o.x+(u.x-o.x)*f,this.y=o.y+(u.y-o.y)*f,this.z=o.z+(u.z-o.z)*f,this.w=o.w+(u.w-o.w)*f,this}equals(o){return o.x===this.x&&o.y===this.y&&o.z===this.z&&o.w===this.w}fromArray(o,u=0){return this.x=o[u],this.y=o[u+1],this.z=o[u+2],this.w=o[u+3],this}toArray(o=[],u=0){return o[u]=this.x,o[u+1]=this.y,o[u+2]=this.z,o[u+3]=this.w,o}fromBufferAttribute(o,u,f){return f!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=o.getX(u),this.y=o.getY(u),this.z=o.getZ(u),this.w=o.getW(u),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}class ec extends ks{constructor(o,u,f){super(),Object.defineProperty(this,"isWebGLRenderTarget",{value:!0}),this.width=o,this.height=u,this.scissor=new Yn(0,0,o,u),this.scissorTest=!1,this.viewport=new Yn(0,0,o,u),f=f||{},this.texture=new dr(void 0,f.mapping,f.wrapS,f.wrapT,f.magFilter,f.minFilter,f.format,f.type,f.anisotropy,f.encoding),this.texture.image={},this.texture.image.width=o,this.texture.image.height=u,this.texture.generateMipmaps=f.generateMipmaps!==void 0?f.generateMipmaps:!1,this.texture.minFilter=f.minFilter!==void 0?f.minFilter:Ui,this.depthBuffer=f.depthBuffer!==void 0?f.depthBuffer:!0,this.stencilBuffer=f.stencilBuffer!==void 0?f.stencilBuffer:!1,this.depthTexture=f.depthTexture!==void 0?f.depthTexture:null}setSize(o,u){(this.width!==o||this.height!==u)&&(this.width=o,this.height=u,this.texture.image.width=o,this.texture.image.height=u,this.dispose()),this.viewport.set(0,0,o,u),this.scissor.set(0,0,o,u)}clone(){return new this.constructor().copy(this)}copy(o){return this.width=o.width,this.height=o.height,this.viewport.copy(o.viewport),this.texture=o.texture.clone(),this.depthBuffer=o.depthBuffer,this.stencilBuffer=o.stencilBuffer,this.depthTexture=o.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Wr{constructor(o=0,u=0,f=0,g=1){Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=o,this._y=u,this._z=f,this._w=g}static slerp(o,u,f,g){return f.copy(o).slerp(u,g)}static slerpFlat(o,u,f,g,y,T,w){let M=f[g+0],I=f[g+1],z=f[g+2],U=f[g+3];const G=y[T+0],W=y[T+1],J=y[T+2],me=y[T+3];if(U!==me||M!==G||I!==W||z!==J){let pe=1-w;const te=M*G+I*W+z*J+U*me,K=te>=0?1:-1,He=1-te*te;if(He>Number.EPSILON){const Ue=Math.sqrt(He),Ae=Math.atan2(Ue,te*K);pe=Math.sin(pe*Ae)/Ue,w=Math.sin(w*Ae)/Ue}const $e=w*K;if(M=M*pe+G*$e,I=I*pe+W*$e,z=z*pe+J*$e,U=U*pe+me*$e,pe===1-w){const Ue=1/Math.sqrt(M*M+I*I+z*z+U*U);M*=Ue,I*=Ue,z*=Ue,U*=Ue}}o[u]=M,o[u+1]=I,o[u+2]=z,o[u+3]=U}static multiplyQuaternionsFlat(o,u,f,g,y,T){const w=f[g],M=f[g+1],I=f[g+2],z=f[g+3],U=y[T],G=y[T+1],W=y[T+2],J=y[T+3];return o[u]=w*J+z*U+M*W-I*G,o[u+1]=M*J+z*G+I*U-w*W,o[u+2]=I*J+z*W+w*G-M*U,o[u+3]=z*J-w*U-M*G-I*W,o}get x(){return this._x}set x(o){this._x=o,this._onChangeCallback()}get y(){return this._y}set y(o){this._y=o,this._onChangeCallback()}get z(){return this._z}set z(o){this._z=o,this._onChangeCallback()}get w(){return this._w}set w(o){this._w=o,this._onChangeCallback()}set(o,u,f,g){return this._x=o,this._y=u,this._z=f,this._w=g,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(o){return this._x=o.x,this._y=o.y,this._z=o.z,this._w=o.w,this._onChangeCallback(),this}setFromEuler(o,u){if(!(o&&o.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const f=o._x,g=o._y,y=o._z,T=o._order,w=Math.cos,M=Math.sin,I=w(f/2),z=w(g/2),U=w(y/2),G=M(f/2),W=M(g/2),J=M(y/2);switch(T){case"XYZ":this._x=G*z*U+I*W*J,this._y=I*W*U-G*z*J,this._z=I*z*J+G*W*U,this._w=I*z*U-G*W*J;break;case"YXZ":this._x=G*z*U+I*W*J,this._y=I*W*U-G*z*J,this._z=I*z*J-G*W*U,this._w=I*z*U+G*W*J;break;case"ZXY":this._x=G*z*U-I*W*J,this._y=I*W*U+G*z*J,this._z=I*z*J+G*W*U,this._w=I*z*U-G*W*J;break;case"ZYX":this._x=G*z*U-I*W*J,this._y=I*W*U+G*z*J,this._z=I*z*J-G*W*U,this._w=I*z*U+G*W*J;break;case"YZX":this._x=G*z*U+I*W*J,this._y=I*W*U+G*z*J,this._z=I*z*J-G*W*U,this._w=I*z*U-G*W*J;break;case"XZY":this._x=G*z*U-I*W*J,this._y=I*W*U-G*z*J,this._z=I*z*J+G*W*U,this._w=I*z*U+G*W*J;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+T)}return u!==!1&&this._onChangeCallback(),this}setFromAxisAngle(o,u){const f=u/2,g=Math.sin(f);return this._x=o.x*g,this._y=o.y*g,this._z=o.z*g,this._w=Math.cos(f),this._onChangeCallback(),this}setFromRotationMatrix(o){const u=o.elements,f=u[0],g=u[4],y=u[8],T=u[1],w=u[5],M=u[9],I=u[2],z=u[6],U=u[10],G=f+w+U;if(G>0){const W=.5/Math.sqrt(G+1);this._w=.25/W,this._x=(z-M)*W,this._y=(y-I)*W,this._z=(T-g)*W}else if(f>w&&f>U){const W=2*Math.sqrt(1+f-w-U);this._w=(z-M)/W,this._x=.25*W,this._y=(g+T)/W,this._z=(y+I)/W}else if(w>U){const W=2*Math.sqrt(1+w-f-U);this._w=(y-I)/W,this._x=(g+T)/W,this._y=.25*W,this._z=(M+z)/W}else{const W=2*Math.sqrt(1+U-f-w);this._w=(T-g)/W,this._x=(y+I)/W,this._y=(M+z)/W,this._z=.25*W}return this._onChangeCallback(),this}setFromUnitVectors(o,u){let g=o.dot(u)+1;return g<1e-6?(g=0,Math.abs(o.x)>Math.abs(o.z)?(this._x=-o.y,this._y=o.x,this._z=0,this._w=g):(this._x=0,this._y=-o.z,this._z=o.y,this._w=g)):(this._x=o.y*u.z-o.z*u.y,this._y=o.z*u.x-o.x*u.z,this._z=o.x*u.y-o.y*u.x,this._w=g),this.normalize()}angleTo(o){return 2*Math.acos(Math.abs(Gi.clamp(this.dot(o),-1,1)))}rotateTowards(o,u){const f=this.angleTo(o);if(f===0)return this;const g=Math.min(1,u/f);return this.slerp(o,g),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(o){return this._x*o._x+this._y*o._y+this._z*o._z+this._w*o._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let o=this.length();return o===0?(this._x=0,this._y=0,this._z=0,this._w=1):(o=1/o,this._x=this._x*o,this._y=this._y*o,this._z=this._z*o,this._w=this._w*o),this._onChangeCallback(),this}multiply(o,u){return u!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(o,u)):this.multiplyQuaternions(this,o)}premultiply(o){return this.multiplyQuaternions(o,this)}multiplyQuaternions(o,u){const f=o._x,g=o._y,y=o._z,T=o._w,w=u._x,M=u._y,I=u._z,z=u._w;return this._x=f*z+T*w+g*I-y*M,this._y=g*z+T*M+y*w-f*I,this._z=y*z+T*I+f*M-g*w,this._w=T*z-f*w-g*M-y*I,this._onChangeCallback(),this}slerp(o,u){if(u===0)return this;if(u===1)return this.copy(o);const f=this._x,g=this._y,y=this._z,T=this._w;let w=T*o._w+f*o._x+g*o._y+y*o._z;if(w<0?(this._w=-o._w,this._x=-o._x,this._y=-o._y,this._z=-o._z,w=-w):this.copy(o),w>=1)return this._w=T,this._x=f,this._y=g,this._z=y,this;const M=1-w*w;if(M<=Number.EPSILON){const W=1-u;return this._w=W*T+u*this._w,this._x=W*f+u*this._x,this._y=W*g+u*this._y,this._z=W*y+u*this._z,this.normalize(),this._onChangeCallback(),this}const I=Math.sqrt(M),z=Math.atan2(I,w),U=Math.sin((1-u)*z)/I,G=Math.sin(u*z)/I;return this._w=T*U+this._w*G,this._x=f*U+this._x*G,this._y=g*U+this._y*G,this._z=y*U+this._z*G,this._onChangeCallback(),this}equals(o){return o._x===this._x&&o._y===this._y&&o._z===this._z&&o._w===this._w}fromArray(o,u=0){return this._x=o[u],this._y=o[u+1],this._z=o[u+2],this._w=o[u+3],this._onChangeCallback(),this}toArray(o=[],u=0){return o[u]=this._x,o[u+1]=this._y,o[u+2]=this._z,o[u+3]=this._w,o}fromBufferAttribute(o,u){return this._x=o.getX(u),this._y=o.getY(u),this._z=o.getZ(u),this._w=o.getW(u),this}_onChange(o){return this._onChangeCallback=o,this}_onChangeCallback(){}}class Be{constructor(o=0,u=0,f=0){Object.defineProperty(this,"isVector3",{value:!0}),this.x=o,this.y=u,this.z=f}set(o,u,f){return f===void 0&&(f=this.z),this.x=o,this.y=u,this.z=f,this}setScalar(o){return this.x=o,this.y=o,this.z=o,this}setX(o){return this.x=o,this}setY(o){return this.y=o,this}setZ(o){return this.z=o,this}setComponent(o,u){switch(o){case 0:this.x=u;break;case 1:this.y=u;break;case 2:this.z=u;break;default:throw new Error("index is out of range: "+o)}return this}getComponent(o){switch(o){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+o)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(o){return this.x=o.x,this.y=o.y,this.z=o.z,this}add(o,u){return u!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(o,u)):(this.x+=o.x,this.y+=o.y,this.z+=o.z,this)}addScalar(o){return this.x+=o,this.y+=o,this.z+=o,this}addVectors(o,u){return this.x=o.x+u.x,this.y=o.y+u.y,this.z=o.z+u.z,this}addScaledVector(o,u){return this.x+=o.x*u,this.y+=o.y*u,this.z+=o.z*u,this}sub(o,u){return u!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(o,u)):(this.x-=o.x,this.y-=o.y,this.z-=o.z,this)}subScalar(o){return this.x-=o,this.y-=o,this.z-=o,this}subVectors(o,u){return this.x=o.x-u.x,this.y=o.y-u.y,this.z=o.z-u.z,this}multiply(o,u){return u!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(o,u)):(this.x*=o.x,this.y*=o.y,this.z*=o.z,this)}multiplyScalar(o){return this.x*=o,this.y*=o,this.z*=o,this}multiplyVectors(o,u){return this.x=o.x*u.x,this.y=o.y*u.y,this.z=o.z*u.z,this}applyEuler(o){return o&&o.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Lh.setFromEuler(o))}applyAxisAngle(o,u){return this.applyQuaternion(Lh.setFromAxisAngle(o,u))}applyMatrix3(o){const u=this.x,f=this.y,g=this.z,y=o.elements;return this.x=y[0]*u+y[3]*f+y[6]*g,this.y=y[1]*u+y[4]*f+y[7]*g,this.z=y[2]*u+y[5]*f+y[8]*g,this}applyNormalMatrix(o){return this.applyMatrix3(o).normalize()}applyMatrix4(o){const u=this.x,f=this.y,g=this.z,y=o.elements,T=1/(y[3]*u+y[7]*f+y[11]*g+y[15]);return this.x=(y[0]*u+y[4]*f+y[8]*g+y[12])*T,this.y=(y[1]*u+y[5]*f+y[9]*g+y[13])*T,this.z=(y[2]*u+y[6]*f+y[10]*g+y[14])*T,this}applyQuaternion(o){const u=this.x,f=this.y,g=this.z,y=o.x,T=o.y,w=o.z,M=o.w,I=M*u+T*g-w*f,z=M*f+w*u-y*g,U=M*g+y*f-T*u,G=-y*u-T*f-w*g;return this.x=I*M+G*-y+z*-w-U*-T,this.y=z*M+G*-T+U*-y-I*-w,this.z=U*M+G*-w+I*-T-z*-y,this}project(o){return this.applyMatrix4(o.matrixWorldInverse).applyMatrix4(o.projectionMatrix)}unproject(o){return this.applyMatrix4(o.projectionMatrixInverse).applyMatrix4(o.matrixWorld)}transformDirection(o){const u=this.x,f=this.y,g=this.z,y=o.elements;return this.x=y[0]*u+y[4]*f+y[8]*g,this.y=y[1]*u+y[5]*f+y[9]*g,this.z=y[2]*u+y[6]*f+y[10]*g,this.normalize()}divide(o){return this.x/=o.x,this.y/=o.y,this.z/=o.z,this}divideScalar(o){return this.multiplyScalar(1/o)}min(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this.z=Math.min(this.z,o.z),this}max(o){return this.x=Math.max(this.x,o.x),this.y=Math.max(this.y,o.y),this.z=Math.max(this.z,o.z),this}clamp(o,u){return this.x=Math.max(o.x,Math.min(u.x,this.x)),this.y=Math.max(o.y,Math.min(u.y,this.y)),this.z=Math.max(o.z,Math.min(u.z,this.z)),this}clampScalar(o,u){return this.x=Math.max(o,Math.min(u,this.x)),this.y=Math.max(o,Math.min(u,this.y)),this.z=Math.max(o,Math.min(u,this.z)),this}clampLength(o,u){const f=this.length();return this.divideScalar(f||1).multiplyScalar(Math.max(o,Math.min(u,f)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(o){return this.x*o.x+this.y*o.y+this.z*o.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(o){return this.normalize().multiplyScalar(o)}lerp(o,u){return this.x+=(o.x-this.x)*u,this.y+=(o.y-this.y)*u,this.z+=(o.z-this.z)*u,this}lerpVectors(o,u,f){return this.x=o.x+(u.x-o.x)*f,this.y=o.y+(u.y-o.y)*f,this.z=o.z+(u.z-o.z)*f,this}cross(o,u){return u!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(o,u)):this.crossVectors(this,o)}crossVectors(o,u){const f=o.x,g=o.y,y=o.z,T=u.x,w=u.y,M=u.z;return this.x=g*M-y*w,this.y=y*T-f*M,this.z=f*w-g*T,this}projectOnVector(o){const u=o.lengthSq();if(u===0)return this.set(0,0,0);const f=o.dot(this)/u;return this.copy(o).multiplyScalar(f)}projectOnPlane(o){return fd.copy(this).projectOnVector(o),this.sub(fd)}reflect(o){return this.sub(fd.copy(o).multiplyScalar(2*this.dot(o)))}angleTo(o){const u=Math.sqrt(this.lengthSq()*o.lengthSq());if(u===0)return Math.PI/2;const f=this.dot(o)/u;return Math.acos(Gi.clamp(f,-1,1))}distanceTo(o){return Math.sqrt(this.distanceToSquared(o))}distanceToSquared(o){const u=this.x-o.x,f=this.y-o.y,g=this.z-o.z;return u*u+f*f+g*g}manhattanDistanceTo(o){return Math.abs(this.x-o.x)+Math.abs(this.y-o.y)+Math.abs(this.z-o.z)}setFromSpherical(o){return this.setFromSphericalCoords(o.radius,o.phi,o.theta)}setFromSphericalCoords(o,u,f){const g=Math.sin(u)*o;return this.x=g*Math.sin(f),this.y=Math.cos(u)*o,this.z=g*Math.cos(f),this}setFromCylindrical(o){return this.setFromCylindricalCoords(o.radius,o.theta,o.y)}setFromCylindricalCoords(o,u,f){return this.x=o*Math.sin(u),this.y=f,this.z=o*Math.cos(u),this}setFromMatrixPosition(o){const u=o.elements;return this.x=u[12],this.y=u[13],this.z=u[14],this}setFromMatrixScale(o){const u=this.setFromMatrixColumn(o,0).length(),f=this.setFromMatrixColumn(o,1).length(),g=this.setFromMatrixColumn(o,2).length();return this.x=u,this.y=f,this.z=g,this}setFromMatrixColumn(o,u){return this.fromArray(o.elements,u*4)}setFromMatrix3Column(o,u){return this.fromArray(o.elements,u*3)}equals(o){return o.x===this.x&&o.y===this.y&&o.z===this.z}fromArray(o,u=0){return this.x=o[u],this.y=o[u+1],this.z=o[u+2],this}toArray(o=[],u=0){return o[u]=this.x,o[u+1]=this.y,o[u+2]=this.z,o}fromBufferAttribute(o,u,f){return f!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=o.getX(u),this.y=o.getY(u),this.z=o.getZ(u),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}const fd=new Be,Lh=new Wr;class vo{constructor(o,u){Object.defineProperty(this,"isBox3",{value:!0}),this.min=o!==void 0?o:new Be(1/0,1/0,1/0),this.max=u!==void 0?u:new Be(-1/0,-1/0,-1/0)}set(o,u){return this.min.copy(o),this.max.copy(u),this}setFromArray(o){let u=1/0,f=1/0,g=1/0,y=-1/0,T=-1/0,w=-1/0;for(let M=0,I=o.length;M<I;M+=3){const z=o[M],U=o[M+1],G=o[M+2];z<u&&(u=z),U<f&&(f=U),G<g&&(g=G),z>y&&(y=z),U>T&&(T=U),G>w&&(w=G)}return this.min.set(u,f,g),this.max.set(y,T,w),this}setFromBufferAttribute(o){let u=1/0,f=1/0,g=1/0,y=-1/0,T=-1/0,w=-1/0;for(let M=0,I=o.count;M<I;M++){const z=o.getX(M),U=o.getY(M),G=o.getZ(M);z<u&&(u=z),U<f&&(f=U),G<g&&(g=G),z>y&&(y=z),U>T&&(T=U),G>w&&(w=G)}return this.min.set(u,f,g),this.max.set(y,T,w),this}setFromPoints(o){this.makeEmpty();for(let u=0,f=o.length;u<f;u++)this.expandByPoint(o[u]);return this}setFromCenterAndSize(o,u){const f=tc.copy(u).multiplyScalar(.5);return this.min.copy(o).sub(f),this.max.copy(o).add(f),this}setFromObject(o){return this.makeEmpty(),this.expandByObject(o)}clone(){return new this.constructor().copy(this)}copy(o){return this.min.copy(o.min),this.max.copy(o.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(o){return o===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),o=new Be),this.isEmpty()?o.set(0,0,0):o.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(o){return o===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),o=new Be),this.isEmpty()?o.set(0,0,0):o.subVectors(this.max,this.min)}expandByPoint(o){return this.min.min(o),this.max.max(o),this}expandByVector(o){return this.min.sub(o),this.max.add(o),this}expandByScalar(o){return this.min.addScalar(-o),this.max.addScalar(o),this}expandByObject(o){o.updateWorldMatrix(!1,!1);const u=o.geometry;u!==void 0&&(u.boundingBox===null&&u.computeBoundingBox(),mu.copy(u.boundingBox),mu.applyMatrix4(o.matrixWorld),this.union(mu));const f=o.children;for(let g=0,y=f.length;g<y;g++)this.expandByObject(f[g]);return this}containsPoint(o){return!(o.x<this.min.x||o.x>this.max.x||o.y<this.min.y||o.y>this.max.y||o.z<this.min.z||o.z>this.max.z)}containsBox(o){return this.min.x<=o.min.x&&o.max.x<=this.max.x&&this.min.y<=o.min.y&&o.max.y<=this.max.y&&this.min.z<=o.min.z&&o.max.z<=this.max.z}getParameter(o,u){return u===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),u=new Be),u.set((o.x-this.min.x)/(this.max.x-this.min.x),(o.y-this.min.y)/(this.max.y-this.min.y),(o.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(o){return!(o.max.x<this.min.x||o.min.x>this.max.x||o.max.y<this.min.y||o.min.y>this.max.y||o.max.z<this.min.z||o.min.z>this.max.z)}intersectsSphere(o){return this.clampPoint(o.center,tc),tc.distanceToSquared(o.center)<=o.radius*o.radius}intersectsPlane(o){let u,f;return o.normal.x>0?(u=o.normal.x*this.min.x,f=o.normal.x*this.max.x):(u=o.normal.x*this.max.x,f=o.normal.x*this.min.x),o.normal.y>0?(u+=o.normal.y*this.min.y,f+=o.normal.y*this.max.y):(u+=o.normal.y*this.max.y,f+=o.normal.y*this.min.y),o.normal.z>0?(u+=o.normal.z*this.min.z,f+=o.normal.z*this.max.z):(u+=o.normal.z*this.max.z,f+=o.normal.z*this.min.z),u<=-o.constant&&f>=-o.constant}intersectsTriangle(o){if(this.isEmpty())return!1;this.getCenter(Ec),Pl.subVectors(this.max,Ec),gu.subVectors(o.a,Ec),vu.subVectors(o.b,Ec),yo.subVectors(o.c,Ec),Ca.subVectors(vu,gu),Il.subVectors(yo,vu),yu.subVectors(gu,yo);let u=[0,-Ca.z,Ca.y,0,-Il.z,Il.y,0,-yu.z,yu.y,Ca.z,0,-Ca.x,Il.z,0,-Il.x,yu.z,0,-yu.x,-Ca.y,Ca.x,0,-Il.y,Il.x,0,-yu.y,yu.x,0];return!pd(u,gu,vu,yo,Pl)||(u=[1,0,0,0,1,0,0,0,1],!pd(u,gu,vu,yo,Pl))?!1:(Ll.crossVectors(Ca,Il),u=[Ll.x,Ll.y,Ll.z],pd(u,gu,vu,yo,Pl))}clampPoint(o,u){return u===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),u=new Be),u.copy(o).clamp(this.min,this.max)}distanceToPoint(o){return tc.copy(o).clamp(this.min,this.max).sub(o).length()}getBoundingSphere(o){return o===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(o.center),o.radius=this.getSize(tc).length()*.5,o}intersect(o){return this.min.max(o.min),this.max.min(o.max),this.isEmpty()&&this.makeEmpty(),this}union(o){return this.min.min(o.min),this.max.max(o.max),this}applyMatrix4(o){return this.isEmpty()?this:(Ea[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(o),Ea[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(o),Ea[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(o),Ea[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(o),Ea[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(o),Ea[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(o),Ea[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(o),Ea[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(o),this.setFromPoints(Ea),this)}translate(o){return this.min.add(o),this.max.add(o),this}equals(o){return o.min.equals(this.min)&&o.max.equals(this.max)}}function pd(l,o,u,f,g){for(let y=0,T=l.length-3;y<=T;y+=3){_o.fromArray(l,y);const w=g.x*Math.abs(_o.x)+g.y*Math.abs(_o.y)+g.z*Math.abs(_o.z),M=o.dot(_o),I=u.dot(_o),z=f.dot(_o);if(Math.max(-Math.max(M,I,z),Math.min(M,I,z))>w)return!1}return!0}const Ea=[new Be,new Be,new Be,new Be,new Be,new Be,new Be,new Be],tc=new Be,mu=new vo,gu=new Be,vu=new Be,yo=new Be,Ca=new Be,Il=new Be,yu=new Be,Ec=new Be,Pl=new Be,Ll=new Be,_o=new Be,zf=new vo;class Rl{constructor(o,u){this.center=o!==void 0?o:new Be,this.radius=u!==void 0?u:-1}set(o,u){return this.center.copy(o),this.radius=u,this}setFromPoints(o,u){const f=this.center;u!==void 0?f.copy(u):zf.setFromPoints(o).getCenter(f);let g=0;for(let y=0,T=o.length;y<T;y++)g=Math.max(g,f.distanceToSquared(o[y]));return this.radius=Math.sqrt(g),this}clone(){return new this.constructor().copy(this)}copy(o){return this.center.copy(o.center),this.radius=o.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(o){return o.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(o){return o.distanceTo(this.center)-this.radius}intersectsSphere(o){const u=this.radius+o.radius;return o.center.distanceToSquared(this.center)<=u*u}intersectsBox(o){return o.intersectsSphere(this)}intersectsPlane(o){return Math.abs(o.distanceToPoint(this.center))<=this.radius}clampPoint(o,u){const f=this.center.distanceToSquared(o);return u===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),u=new Be),u.copy(o),f>this.radius*this.radius&&(u.sub(this.center).normalize(),u.multiplyScalar(this.radius).add(this.center)),u}getBoundingBox(o){return o===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),o=new vo),this.isEmpty()?(o.makeEmpty(),o):(o.set(this.center,this.center),o.expandByScalar(this.radius),o)}applyMatrix4(o){return this.center.applyMatrix4(o),this.radius=this.radius*o.getMaxScaleOnAxis(),this}translate(o){return this.center.add(o),this}equals(o){return o.center.equals(this.center)&&o.radius===this.radius}}const Ws=new Be,er=new Be,Ha=new Be,br=new Be,Ma=new Be,md=new Be,gd=new Be;class Yo{constructor(o,u){this.origin=o!==void 0?o:new Be,this.direction=u!==void 0?u:new Be(0,0,-1)}set(o,u){return this.origin.copy(o),this.direction.copy(u),this}clone(){return new this.constructor().copy(this)}copy(o){return this.origin.copy(o.origin),this.direction.copy(o.direction),this}at(o,u){return u===void 0&&(console.warn("THREE.Ray: .at() target is now required"),u=new Be),u.copy(this.direction).multiplyScalar(o).add(this.origin)}lookAt(o){return this.direction.copy(o).sub(this.origin).normalize(),this}recast(o){return this.origin.copy(this.at(o,Ws)),this}closestPointToPoint(o,u){u===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),u=new Be),u.subVectors(o,this.origin);const f=u.dot(this.direction);return f<0?u.copy(this.origin):u.copy(this.direction).multiplyScalar(f).add(this.origin)}distanceToPoint(o){return Math.sqrt(this.distanceSqToPoint(o))}distanceSqToPoint(o){const u=Ws.subVectors(o,this.origin).dot(this.direction);return u<0?this.origin.distanceToSquared(o):(Ws.copy(this.direction).multiplyScalar(u).add(this.origin),Ws.distanceToSquared(o))}distanceSqToSegment(o,u,f,g){er.copy(o).add(u).multiplyScalar(.5),Ha.copy(u).sub(o).normalize(),br.copy(this.origin).sub(er);const y=o.distanceTo(u)*.5,T=-this.direction.dot(Ha),w=br.dot(this.direction),M=-br.dot(Ha),I=br.lengthSq(),z=Math.abs(1-T*T);let U,G,W,J;if(z>0)if(U=T*M-w,G=T*w-M,J=y*z,U>=0)if(G>=-J)if(G<=J){const me=1/z;U*=me,G*=me,W=U*(U+T*G+2*w)+G*(T*U+G+2*M)+I}else G=y,U=Math.max(0,-(T*G+w)),W=-U*U+G*(G+2*M)+I;else G=-y,U=Math.max(0,-(T*G+w)),W=-U*U+G*(G+2*M)+I;else G<=-J?(U=Math.max(0,-(-T*y+w)),G=U>0?-y:Math.min(Math.max(-y,-M),y),W=-U*U+G*(G+2*M)+I):G<=J?(U=0,G=Math.min(Math.max(-y,-M),y),W=G*(G+2*M)+I):(U=Math.max(0,-(T*y+w)),G=U>0?y:Math.min(Math.max(-y,-M),y),W=-U*U+G*(G+2*M)+I);else G=T>0?-y:y,U=Math.max(0,-(T*G+w)),W=-U*U+G*(G+2*M)+I;return f&&f.copy(this.direction).multiplyScalar(U).add(this.origin),g&&g.copy(Ha).multiplyScalar(G).add(er),W}intersectSphere(o,u){Ws.subVectors(o.center,this.origin);const f=Ws.dot(this.direction),g=Ws.dot(Ws)-f*f,y=o.radius*o.radius;if(g>y)return null;const T=Math.sqrt(y-g),w=f-T,M=f+T;return w<0&&M<0?null:w<0?this.at(M,u):this.at(w,u)}intersectsSphere(o){return this.distanceSqToPoint(o.center)<=o.radius*o.radius}distanceToPlane(o){const u=o.normal.dot(this.direction);if(u===0)return o.distanceToPoint(this.origin)===0?0:null;const f=-(this.origin.dot(o.normal)+o.constant)/u;return f>=0?f:null}intersectPlane(o,u){const f=this.distanceToPlane(o);return f===null?null:this.at(f,u)}intersectsPlane(o){const u=o.distanceToPoint(this.origin);return u===0||o.normal.dot(this.direction)*u<0}intersectBox(o,u){let f,g,y,T,w,M;const I=1/this.direction.x,z=1/this.direction.y,U=1/this.direction.z,G=this.origin;return I>=0?(f=(o.min.x-G.x)*I,g=(o.max.x-G.x)*I):(f=(o.max.x-G.x)*I,g=(o.min.x-G.x)*I),z>=0?(y=(o.min.y-G.y)*z,T=(o.max.y-G.y)*z):(y=(o.max.y-G.y)*z,T=(o.min.y-G.y)*z),f>T||y>g||((y>f||f!==f)&&(f=y),(T<g||g!==g)&&(g=T),U>=0?(w=(o.min.z-G.z)*U,M=(o.max.z-G.z)*U):(w=(o.max.z-G.z)*U,M=(o.min.z-G.z)*U),f>M||w>g)||((w>f||f!==f)&&(f=w),(M<g||g!==g)&&(g=M),g<0)?null:this.at(f>=0?f:g,u)}intersectsBox(o){return this.intersectBox(o,Ws)!==null}intersectTriangle(o,u,f,g,y){Ma.subVectors(u,o),md.subVectors(f,o),gd.crossVectors(Ma,md);let T=this.direction.dot(gd),w;if(T>0){if(g)return null;w=1}else if(T<0)w=-1,T=-T;else return null;br.subVectors(this.origin,o);const M=w*this.direction.dot(md.crossVectors(br,md));if(M<0)return null;const I=w*this.direction.dot(Ma.cross(br));if(I<0||M+I>T)return null;const z=-w*br.dot(gd);return z<0?null:this.at(z/T,y)}applyMatrix4(o){return this.origin.applyMatrix4(o),this.direction.transformDirection(o),this}equals(o){return o.origin.equals(this.origin)&&o.direction.equals(this.direction)}}class fn{constructor(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(o,u,f,g,y,T,w,M,I,z,U,G,W,J,me,pe){const te=this.elements;return te[0]=o,te[4]=u,te[8]=f,te[12]=g,te[1]=y,te[5]=T,te[9]=w,te[13]=M,te[2]=I,te[6]=z,te[10]=U,te[14]=G,te[3]=W,te[7]=J,te[11]=me,te[15]=pe,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new fn().fromArray(this.elements)}copy(o){const u=this.elements,f=o.elements;return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5],u[6]=f[6],u[7]=f[7],u[8]=f[8],u[9]=f[9],u[10]=f[10],u[11]=f[11],u[12]=f[12],u[13]=f[13],u[14]=f[14],u[15]=f[15],this}copyPosition(o){const u=this.elements,f=o.elements;return u[12]=f[12],u[13]=f[13],u[14]=f[14],this}setFromMatrix3(o){const u=o.elements;return this.set(u[0],u[3],u[6],0,u[1],u[4],u[7],0,u[2],u[5],u[8],0,0,0,0,1),this}extractBasis(o,u,f){return o.setFromMatrixColumn(this,0),u.setFromMatrixColumn(this,1),f.setFromMatrixColumn(this,2),this}makeBasis(o,u,f){return this.set(o.x,u.x,f.x,0,o.y,u.y,f.y,0,o.z,u.z,f.z,0,0,0,0,1),this}extractRotation(o){const u=this.elements,f=o.elements,g=1/bo.setFromMatrixColumn(o,0).length(),y=1/bo.setFromMatrixColumn(o,1).length(),T=1/bo.setFromMatrixColumn(o,2).length();return u[0]=f[0]*g,u[1]=f[1]*g,u[2]=f[2]*g,u[3]=0,u[4]=f[4]*y,u[5]=f[5]*y,u[6]=f[6]*y,u[7]=0,u[8]=f[8]*T,u[9]=f[9]*T,u[10]=f[10]*T,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,this}makeRotationFromEuler(o){o&&o.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const u=this.elements,f=o.x,g=o.y,y=o.z,T=Math.cos(f),w=Math.sin(f),M=Math.cos(g),I=Math.sin(g),z=Math.cos(y),U=Math.sin(y);if(o.order==="XYZ"){const G=T*z,W=T*U,J=w*z,me=w*U;u[0]=M*z,u[4]=-M*U,u[8]=I,u[1]=W+J*I,u[5]=G-me*I,u[9]=-w*M,u[2]=me-G*I,u[6]=J+W*I,u[10]=T*M}else if(o.order==="YXZ"){const G=M*z,W=M*U,J=I*z,me=I*U;u[0]=G+me*w,u[4]=J*w-W,u[8]=T*I,u[1]=T*U,u[5]=T*z,u[9]=-w,u[2]=W*w-J,u[6]=me+G*w,u[10]=T*M}else if(o.order==="ZXY"){const G=M*z,W=M*U,J=I*z,me=I*U;u[0]=G-me*w,u[4]=-T*U,u[8]=J+W*w,u[1]=W+J*w,u[5]=T*z,u[9]=me-G*w,u[2]=-T*I,u[6]=w,u[10]=T*M}else if(o.order==="ZYX"){const G=T*z,W=T*U,J=w*z,me=w*U;u[0]=M*z,u[4]=J*I-W,u[8]=G*I+me,u[1]=M*U,u[5]=me*I+G,u[9]=W*I-J,u[2]=-I,u[6]=w*M,u[10]=T*M}else if(o.order==="YZX"){const G=T*M,W=T*I,J=w*M,me=w*I;u[0]=M*z,u[4]=me-G*U,u[8]=J*U+W,u[1]=U,u[5]=T*z,u[9]=-w*z,u[2]=-I*z,u[6]=W*U+J,u[10]=G-me*U}else if(o.order==="XZY"){const G=T*M,W=T*I,J=w*M,me=w*I;u[0]=M*z,u[4]=-U,u[8]=I*z,u[1]=G*U+me,u[5]=T*z,u[9]=W*U-J,u[2]=J*U-W,u[6]=w*z,u[10]=me*U+G}return u[3]=0,u[7]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,this}makeRotationFromQuaternion(o){return this.compose(Vp,o,Cc)}lookAt(o,u,f){const g=this.elements;return le.subVectors(o,u),le.lengthSq()===0&&(le.z=1),le.normalize(),kl.crossVectors(f,le),kl.lengthSq()===0&&(Math.abs(f.z)===1?le.x+=1e-4:le.z+=1e-4,le.normalize(),kl.crossVectors(f,le)),kl.normalize(),To.crossVectors(le,kl),g[0]=kl.x,g[4]=To.x,g[8]=le.x,g[1]=kl.y,g[5]=To.y,g[9]=le.y,g[2]=kl.z,g[6]=To.z,g[10]=le.z,this}multiply(o,u){return u!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(o,u)):this.multiplyMatrices(this,o)}premultiply(o){return this.multiplyMatrices(o,this)}multiplyMatrices(o,u){const f=o.elements,g=u.elements,y=this.elements,T=f[0],w=f[4],M=f[8],I=f[12],z=f[1],U=f[5],G=f[9],W=f[13],J=f[2],me=f[6],pe=f[10],te=f[14],K=f[3],He=f[7],$e=f[11],Ue=f[15],Ae=g[0],at=g[4],Ht=g[8],wt=g[12],It=g[1],Pt=g[5],Nt=g[9],nt=g[13],Ke=g[2],st=g[6],Ct=g[10],Xt=g[14],ti=g[3],ni=g[7],Ai=g[11],_i=g[15];return y[0]=T*Ae+w*It+M*Ke+I*ti,y[4]=T*at+w*Pt+M*st+I*ni,y[8]=T*Ht+w*Nt+M*Ct+I*Ai,y[12]=T*wt+w*nt+M*Xt+I*_i,y[1]=z*Ae+U*It+G*Ke+W*ti,y[5]=z*at+U*Pt+G*st+W*ni,y[9]=z*Ht+U*Nt+G*Ct+W*Ai,y[13]=z*wt+U*nt+G*Xt+W*_i,y[2]=J*Ae+me*It+pe*Ke+te*ti,y[6]=J*at+me*Pt+pe*st+te*ni,y[10]=J*Ht+me*Nt+pe*Ct+te*Ai,y[14]=J*wt+me*nt+pe*Xt+te*_i,y[3]=K*Ae+He*It+$e*Ke+Ue*ti,y[7]=K*at+He*Pt+$e*st+Ue*ni,y[11]=K*Ht+He*Nt+$e*Ct+Ue*Ai,y[15]=K*wt+He*nt+$e*Xt+Ue*_i,this}multiplyScalar(o){const u=this.elements;return u[0]*=o,u[4]*=o,u[8]*=o,u[12]*=o,u[1]*=o,u[5]*=o,u[9]*=o,u[13]*=o,u[2]*=o,u[6]*=o,u[10]*=o,u[14]*=o,u[3]*=o,u[7]*=o,u[11]*=o,u[15]*=o,this}determinant(){const o=this.elements,u=o[0],f=o[4],g=o[8],y=o[12],T=o[1],w=o[5],M=o[9],I=o[13],z=o[2],U=o[6],G=o[10],W=o[14],J=o[3],me=o[7],pe=o[11],te=o[15];return J*(+y*M*U-g*I*U-y*w*G+f*I*G+g*w*W-f*M*W)+me*(+u*M*W-u*I*G+y*T*G-g*T*W+g*I*z-y*M*z)+pe*(+u*I*U-u*w*W-y*T*U+f*T*W+y*w*z-f*I*z)+te*(-g*w*z-u*M*U+u*w*G+g*T*U-f*T*G+f*M*z)}transpose(){const o=this.elements;let u;return u=o[1],o[1]=o[4],o[4]=u,u=o[2],o[2]=o[8],o[8]=u,u=o[6],o[6]=o[9],o[9]=u,u=o[3],o[3]=o[12],o[12]=u,u=o[7],o[7]=o[13],o[13]=u,u=o[11],o[11]=o[14],o[14]=u,this}setPosition(o,u,f){const g=this.elements;return o.isVector3?(g[12]=o.x,g[13]=o.y,g[14]=o.z):(g[12]=o,g[13]=u,g[14]=f),this}invert(){const o=this.elements,u=o[0],f=o[1],g=o[2],y=o[3],T=o[4],w=o[5],M=o[6],I=o[7],z=o[8],U=o[9],G=o[10],W=o[11],J=o[12],me=o[13],pe=o[14],te=o[15],K=U*pe*I-me*G*I+me*M*W-w*pe*W-U*M*te+w*G*te,He=J*G*I-z*pe*I-J*M*W+T*pe*W+z*M*te-T*G*te,$e=z*me*I-J*U*I+J*w*W-T*me*W-z*w*te+T*U*te,Ue=J*U*M-z*me*M-J*w*G+T*me*G+z*w*pe-T*U*pe,Ae=u*K+f*He+g*$e+y*Ue;if(Ae===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const at=1/Ae;return o[0]=K*at,o[1]=(me*G*y-U*pe*y-me*g*W+f*pe*W+U*g*te-f*G*te)*at,o[2]=(w*pe*y-me*M*y+me*g*I-f*pe*I-w*g*te+f*M*te)*at,o[3]=(U*M*y-w*G*y-U*g*I+f*G*I+w*g*W-f*M*W)*at,o[4]=He*at,o[5]=(z*pe*y-J*G*y+J*g*W-u*pe*W-z*g*te+u*G*te)*at,o[6]=(J*M*y-T*pe*y-J*g*I+u*pe*I+T*g*te-u*M*te)*at,o[7]=(T*G*y-z*M*y+z*g*I-u*G*I-T*g*W+u*M*W)*at,o[8]=$e*at,o[9]=(J*U*y-z*me*y-J*f*W+u*me*W+z*f*te-u*U*te)*at,o[10]=(T*me*y-J*w*y+J*f*I-u*me*I-T*f*te+u*w*te)*at,o[11]=(z*w*y-T*U*y-z*f*I+u*U*I+T*f*W-u*w*W)*at,o[12]=Ue*at,o[13]=(z*me*g-J*U*g+J*f*G-u*me*G-z*f*pe+u*U*pe)*at,o[14]=(J*w*g-T*me*g-J*f*M+u*me*M+T*f*pe-u*w*pe)*at,o[15]=(T*U*g-z*w*g+z*f*M-u*U*M-T*f*G+u*w*G)*at,this}scale(o){const u=this.elements,f=o.x,g=o.y,y=o.z;return u[0]*=f,u[4]*=g,u[8]*=y,u[1]*=f,u[5]*=g,u[9]*=y,u[2]*=f,u[6]*=g,u[10]*=y,u[3]*=f,u[7]*=g,u[11]*=y,this}getMaxScaleOnAxis(){const o=this.elements,u=o[0]*o[0]+o[1]*o[1]+o[2]*o[2],f=o[4]*o[4]+o[5]*o[5]+o[6]*o[6],g=o[8]*o[8]+o[9]*o[9]+o[10]*o[10];return Math.sqrt(Math.max(u,f,g))}makeTranslation(o,u,f){return this.set(1,0,0,o,0,1,0,u,0,0,1,f,0,0,0,1),this}makeRotationX(o){const u=Math.cos(o),f=Math.sin(o);return this.set(1,0,0,0,0,u,-f,0,0,f,u,0,0,0,0,1),this}makeRotationY(o){const u=Math.cos(o),f=Math.sin(o);return this.set(u,0,f,0,0,1,0,0,-f,0,u,0,0,0,0,1),this}makeRotationZ(o){const u=Math.cos(o),f=Math.sin(o);return this.set(u,-f,0,0,f,u,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(o,u){const f=Math.cos(u),g=Math.sin(u),y=1-f,T=o.x,w=o.y,M=o.z,I=y*T,z=y*w;return this.set(I*T+f,I*w-g*M,I*M+g*w,0,I*w+g*M,z*w+f,z*M-g*T,0,I*M-g*w,z*M+g*T,y*M*M+f,0,0,0,0,1),this}makeScale(o,u,f){return this.set(o,0,0,0,0,u,0,0,0,0,f,0,0,0,0,1),this}makeShear(o,u,f){return this.set(1,u,f,0,o,1,f,0,o,u,1,0,0,0,0,1),this}compose(o,u,f){const g=this.elements,y=u._x,T=u._y,w=u._z,M=u._w,I=y+y,z=T+T,U=w+w,G=y*I,W=y*z,J=y*U,me=T*z,pe=T*U,te=w*U,K=M*I,He=M*z,$e=M*U,Ue=f.x,Ae=f.y,at=f.z;return g[0]=(1-(me+te))*Ue,g[1]=(W+$e)*Ue,g[2]=(J-He)*Ue,g[3]=0,g[4]=(W-$e)*Ae,g[5]=(1-(G+te))*Ae,g[6]=(pe+K)*Ae,g[7]=0,g[8]=(J+He)*at,g[9]=(pe-K)*at,g[10]=(1-(G+me))*at,g[11]=0,g[12]=o.x,g[13]=o.y,g[14]=o.z,g[15]=1,this}decompose(o,u,f){const g=this.elements;let y=bo.set(g[0],g[1],g[2]).length();const T=bo.set(g[4],g[5],g[6]).length(),w=bo.set(g[8],g[9],g[10]).length();this.determinant()<0&&(y=-y),o.x=g[12],o.y=g[13],o.z=g[14],ia.copy(this);const I=1/y,z=1/T,U=1/w;return ia.elements[0]*=I,ia.elements[1]*=I,ia.elements[2]*=I,ia.elements[4]*=z,ia.elements[5]*=z,ia.elements[6]*=z,ia.elements[8]*=U,ia.elements[9]*=U,ia.elements[10]*=U,u.setFromRotationMatrix(ia),f.x=y,f.y=T,f.z=w,this}makePerspective(o,u,f,g,y,T){T===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const w=this.elements,M=2*y/(u-o),I=2*y/(f-g),z=(u+o)/(u-o),U=(f+g)/(f-g),G=-(T+y)/(T-y),W=-2*T*y/(T-y);return w[0]=M,w[4]=0,w[8]=z,w[12]=0,w[1]=0,w[5]=I,w[9]=U,w[13]=0,w[2]=0,w[6]=0,w[10]=G,w[14]=W,w[3]=0,w[7]=0,w[11]=-1,w[15]=0,this}makeOrthographic(o,u,f,g,y,T){const w=this.elements,M=1/(u-o),I=1/(f-g),z=1/(T-y),U=(u+o)*M,G=(f+g)*I,W=(T+y)*z;return w[0]=2*M,w[4]=0,w[8]=0,w[12]=-U,w[1]=0,w[5]=2*I,w[9]=0,w[13]=-G,w[2]=0,w[6]=0,w[10]=-2*z,w[14]=-W,w[3]=0,w[7]=0,w[11]=0,w[15]=1,this}equals(o){const u=this.elements,f=o.elements;for(let g=0;g<16;g++)if(u[g]!==f[g])return!1;return!0}fromArray(o,u=0){for(let f=0;f<16;f++)this.elements[f]=o[f+u];return this}toArray(o=[],u=0){const f=this.elements;return o[u]=f[0],o[u+1]=f[1],o[u+2]=f[2],o[u+3]=f[3],o[u+4]=f[4],o[u+5]=f[5],o[u+6]=f[6],o[u+7]=f[7],o[u+8]=f[8],o[u+9]=f[9],o[u+10]=f[10],o[u+11]=f[11],o[u+12]=f[12],o[u+13]=f[13],o[u+14]=f[14],o[u+15]=f[15],o}}const bo=new Be,ia=new fn,Vp=new Be(0,0,0),Cc=new Be(1,1,1),kl=new Be,To=new Be,le=new Be;class E{constructor(o=0,u=0,f=0,g=E.DefaultOrder){Object.defineProperty(this,"isEuler",{value:!0}),this._x=o,this._y=u,this._z=f,this._order=g}get x(){return this._x}set x(o){this._x=o,this._onChangeCallback()}get y(){return this._y}set y(o){this._y=o,this._onChangeCallback()}get z(){return this._z}set z(o){this._z=o,this._onChangeCallback()}get order(){return this._order}set order(o){this._order=o,this._onChangeCallback()}set(o,u,f,g){return this._x=o,this._y=u,this._z=f,this._order=g||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(o){return this._x=o._x,this._y=o._y,this._z=o._z,this._order=o._order,this._onChangeCallback(),this}setFromRotationMatrix(o,u,f){const g=Gi.clamp,y=o.elements,T=y[0],w=y[4],M=y[8],I=y[1],z=y[5],U=y[9],G=y[2],W=y[6],J=y[10];switch(u=u||this._order,u){case"XYZ":this._y=Math.asin(g(M,-1,1)),Math.abs(M)<.9999999?(this._x=Math.atan2(-U,J),this._z=Math.atan2(-w,T)):(this._x=Math.atan2(W,z),this._z=0);break;case"YXZ":this._x=Math.asin(-g(U,-1,1)),Math.abs(U)<.9999999?(this._y=Math.atan2(M,J),this._z=Math.atan2(I,z)):(this._y=Math.atan2(-G,T),this._z=0);break;case"ZXY":this._x=Math.asin(g(W,-1,1)),Math.abs(W)<.9999999?(this._y=Math.atan2(-G,J),this._z=Math.atan2(-w,z)):(this._y=0,this._z=Math.atan2(I,T));break;case"ZYX":this._y=Math.asin(-g(G,-1,1)),Math.abs(G)<.9999999?(this._x=Math.atan2(W,J),this._z=Math.atan2(I,T)):(this._x=0,this._z=Math.atan2(-w,z));break;case"YZX":this._z=Math.asin(g(I,-1,1)),Math.abs(I)<.9999999?(this._x=Math.atan2(-U,z),this._y=Math.atan2(-G,T)):(this._x=0,this._y=Math.atan2(M,J));break;case"XZY":this._z=Math.asin(-g(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(W,z),this._y=Math.atan2(M,T)):(this._x=Math.atan2(-U,J),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+u)}return this._order=u,f!==!1&&this._onChangeCallback(),this}setFromQuaternion(o,u,f){return F.makeRotationFromQuaternion(o),this.setFromRotationMatrix(F,u,f)}setFromVector3(o,u){return this.set(o.x,o.y,o.z,u||this._order)}reorder(o){return R.setFromEuler(this),this.setFromQuaternion(R,o)}equals(o){return o._x===this._x&&o._y===this._y&&o._z===this._z&&o._order===this._order}fromArray(o){return this._x=o[0],this._y=o[1],this._z=o[2],o[3]!==void 0&&(this._order=o[3]),this._onChangeCallback(),this}toArray(o=[],u=0){return o[u]=this._x,o[u+1]=this._y,o[u+2]=this._z,o[u+3]=this._order,o}toVector3(o){return o?o.set(this._x,this._y,this._z):new Be(this._x,this._y,this._z)}_onChange(o){return this._onChangeCallback=o,this}_onChangeCallback(){}}E.DefaultOrder="XYZ",E.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];const F=new fn,R=new Wr;class V{constructor(){this.mask=1}set(o){this.mask=1<<o|0}enable(o){this.mask|=1<<o|0}enableAll(){this.mask=-1}toggle(o){this.mask^=1<<o|0}disable(o){this.mask&=~(1<<o|0)}disableAll(){this.mask=0}test(o){return(this.mask&o.mask)!==0}}let Q=0;const ee=new Be,_e=new Wr,Ce=new fn,Ve=new Be,Oe=new Be,Qe=new Be,kt=new Wr,ui=new Be(1,0,0),yi=new Be(0,1,0),si=new Be(0,0,1),qi={type:"added"},qr={type:"removed"};function Li(){Object.defineProperty(this,"id",{value:Q++}),this.uuid=Gi.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Li.DefaultUp.clone();const l=new Be,o=new E,u=new Wr,f=new Be(1,1,1);function g(){u.setFromEuler(o,!1)}function y(){o.setFromQuaternion(u,void 0,!1)}o._onChange(g),u._onChange(y),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:l},rotation:{configurable:!0,enumerable:!0,value:o},quaternion:{configurable:!0,enumerable:!0,value:u},scale:{configurable:!0,enumerable:!0,value:f},modelViewMatrix:{value:new fn},normalMatrix:{value:new Os}}),this.matrix=new fn,this.matrixWorld=new fn,this.matrixAutoUpdate=Li.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new V,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}Li.DefaultUp=new Be(0,1,0),Li.DefaultMatrixAutoUpdate=!0,Li.prototype=X(Object.create(ks.prototype),{constructor:Li,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(l){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(l),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(l){return this.quaternion.premultiply(l),this},setRotationFromAxisAngle:function(l,o){this.quaternion.setFromAxisAngle(l,o)},setRotationFromEuler:function(l){this.quaternion.setFromEuler(l,!0)},setRotationFromMatrix:function(l){this.quaternion.setFromRotationMatrix(l)},setRotationFromQuaternion:function(l){this.quaternion.copy(l)},rotateOnAxis:function(l,o){return _e.setFromAxisAngle(l,o),this.quaternion.multiply(_e),this},rotateOnWorldAxis:function(l,o){return _e.setFromAxisAngle(l,o),this.quaternion.premultiply(_e),this},rotateX:function(l){return this.rotateOnAxis(ui,l)},rotateY:function(l){return this.rotateOnAxis(yi,l)},rotateZ:function(l){return this.rotateOnAxis(si,l)},translateOnAxis:function(l,o){return ee.copy(l).applyQuaternion(this.quaternion),this.position.add(ee.multiplyScalar(o)),this},translateX:function(l){return this.translateOnAxis(ui,l)},translateY:function(l){return this.translateOnAxis(yi,l)},translateZ:function(l){return this.translateOnAxis(si,l)},localToWorld:function(l){return l.applyMatrix4(this.matrixWorld)},worldToLocal:function(l){return l.applyMatrix4(Ce.copy(this.matrixWorld).invert())},lookAt:function(l,o,u){l.isVector3?Ve.copy(l):Ve.set(l,o,u);const f=this.parent;this.updateWorldMatrix(!0,!1),Oe.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ce.lookAt(Oe,Ve,this.up):Ce.lookAt(Ve,Oe,this.up),this.quaternion.setFromRotationMatrix(Ce),f&&(Ce.extractRotation(f.matrixWorld),_e.setFromRotationMatrix(Ce),this.quaternion.premultiply(_e.invert()))},add:function(l){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.add(arguments[o]);return this}return l===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",l),this):(l&&l.isObject3D?(l.parent!==null&&l.parent.remove(l),l.parent=this,this.children.push(l),l.dispatchEvent(qi)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",l),this)},remove:function(l){if(arguments.length>1){for(let u=0;u<arguments.length;u++)this.remove(arguments[u]);return this}const o=this.children.indexOf(l);return o!==-1&&(l.parent=null,this.children.splice(o,1),l.dispatchEvent(qr)),this},clear:function(){for(let l=0;l<this.children.length;l++){const o=this.children[l];o.parent=null,o.dispatchEvent(qr)}return this.children.length=0,this},attach:function(l){return this.updateWorldMatrix(!0,!1),Ce.copy(this.matrixWorld).invert(),l.parent!==null&&(l.parent.updateWorldMatrix(!0,!1),Ce.multiply(l.parent.matrixWorld)),l.applyMatrix4(Ce),l.updateWorldMatrix(!1,!1),this.add(l),this},getObjectById:function(l){return this.getObjectByProperty("id",l)},getObjectByName:function(l){return this.getObjectByProperty("name",l)},getObjectByProperty:function(l,o){if(this[l]===o)return this;for(let u=0,f=this.children.length;u<f;u++){const y=this.children[u].getObjectByProperty(l,o);if(y!==void 0)return y}},getWorldPosition:function(l){return l===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),l=new Be),this.updateWorldMatrix(!0,!1),l.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(l){return l===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),l=new Wr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Oe,l,Qe),l},getWorldScale:function(l){return l===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),l=new Be),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Oe,kt,l),l},getWorldDirection:function(l){l===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),l=new Be),this.updateWorldMatrix(!0,!1);const o=this.matrixWorld.elements;return l.set(o[8],o[9],o[10]).normalize()},raycast:function(){},traverse:function(l){l(this);const o=this.children;for(let u=0,f=o.length;u<f;u++)o[u].traverse(l)},traverseVisible:function(l){if(this.visible===!1)return;l(this);const o=this.children;for(let u=0,f=o.length;u<f;u++)o[u].traverseVisible(l)},traverseAncestors:function(l){const o=this.parent;o!==null&&(l(o),o.traverseAncestors(l))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(l){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||l)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,l=!0);const o=this.children;for(let u=0,f=o.length;u<f;u++)o[u].updateMatrixWorld(l)},updateWorldMatrix:function(l,o){const u=this.parent;if(l===!0&&u!==null&&u.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),o===!0){const f=this.children;for(let g=0,y=f.length;g<y;g++)f[g].updateWorldMatrix(!1,!0)}},toJSON:function(l){const o=l===void 0||typeof l=="string",u={};o&&(l={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},u.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const f={};f.uuid=this.uuid,f.type=this.type,this.name!==""&&(f.name=this.name),this.castShadow===!0&&(f.castShadow=!0),this.receiveShadow===!0&&(f.receiveShadow=!0),this.visible===!1&&(f.visible=!1),this.frustumCulled===!1&&(f.frustumCulled=!1),this.renderOrder!==0&&(f.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(f.userData=this.userData),f.layers=this.layers.mask,f.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(f.matrixAutoUpdate=!1),this.isInstancedMesh&&(f.type="InstancedMesh",f.count=this.count,f.instanceMatrix=this.instanceMatrix.toJSON());function g(T,w){return T[w.uuid]===void 0&&(T[w.uuid]=w.toJSON(l)),w.uuid}if(this.isMesh||this.isLine||this.isPoints){f.geometry=g(l.geometries,this.geometry);const T=this.geometry.parameters;if(T!==void 0&&T.shapes!==void 0){const w=T.shapes;if(Array.isArray(w))for(let M=0,I=w.length;M<I;M++){const z=w[M];g(l.shapes,z)}else g(l.shapes,w)}}if(this.isSkinnedMesh&&(f.bindMode=this.bindMode,f.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(g(l.skeletons,this.skeleton),f.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const T=[];for(let w=0,M=this.material.length;w<M;w++)T.push(g(l.materials,this.material[w]));f.material=T}else f.material=g(l.materials,this.material);if(this.children.length>0){f.children=[];for(let T=0;T<this.children.length;T++)f.children.push(this.children[T].toJSON(l).object)}if(this.animations.length>0){f.animations=[];for(let T=0;T<this.animations.length;T++){const w=this.animations[T];f.animations.push(g(l.animations,w))}}if(o){const T=y(l.geometries),w=y(l.materials),M=y(l.textures),I=y(l.images),z=y(l.shapes),U=y(l.skeletons),G=y(l.animations);T.length>0&&(u.geometries=T),w.length>0&&(u.materials=w),M.length>0&&(u.textures=M),I.length>0&&(u.images=I),z.length>0&&(u.shapes=z),U.length>0&&(u.skeletons=U),G.length>0&&(u.animations=G)}return u.object=f,u;function y(T){const w=[];for(const M in T){const I=T[M];delete I.metadata,w.push(I)}return w}},clone:function(l){return new this.constructor().copy(this,l)},copy:function(l,o=!0){if(this.name=l.name,this.up.copy(l.up),this.position.copy(l.position),this.rotation.order=l.rotation.order,this.quaternion.copy(l.quaternion),this.scale.copy(l.scale),this.matrix.copy(l.matrix),this.matrixWorld.copy(l.matrixWorld),this.matrixAutoUpdate=l.matrixAutoUpdate,this.matrixWorldNeedsUpdate=l.matrixWorldNeedsUpdate,this.layers.mask=l.layers.mask,this.visible=l.visible,this.castShadow=l.castShadow,this.receiveShadow=l.receiveShadow,this.frustumCulled=l.frustumCulled,this.renderOrder=l.renderOrder,this.userData=JSON.parse(JSON.stringify(l.userData)),o===!0)for(let u=0;u<l.children.length;u++){const f=l.children[u];this.add(f.clone())}return this}});const Ss=new Be,Mc=new Be,_u=new Os;class Da{constructor(o,u){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=o!==void 0?o:new Be(1,0,0),this.constant=u!==void 0?u:0}set(o,u){return this.normal.copy(o),this.constant=u,this}setComponents(o,u,f,g){return this.normal.set(o,u,f),this.constant=g,this}setFromNormalAndCoplanarPoint(o,u){return this.normal.copy(o),this.constant=-u.dot(this.normal),this}setFromCoplanarPoints(o,u,f){const g=Ss.subVectors(f,u).cross(Mc.subVectors(o,u)).normalize();return this.setFromNormalAndCoplanarPoint(g,o),this}clone(){return new this.constructor().copy(this)}copy(o){return this.normal.copy(o.normal),this.constant=o.constant,this}normalize(){const o=1/this.normal.length();return this.normal.multiplyScalar(o),this.constant*=o,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(o){return this.normal.dot(o)+this.constant}distanceToSphere(o){return this.distanceToPoint(o.center)-o.radius}projectPoint(o,u){return u===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),u=new Be),u.copy(this.normal).multiplyScalar(-this.distanceToPoint(o)).add(o)}intersectLine(o,u){u===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),u=new Be);const f=o.delta(Ss),g=this.normal.dot(f);if(g===0)return this.distanceToPoint(o.start)===0?u.copy(o.start):void 0;const y=-(o.start.dot(this.normal)+this.constant)/g;if(!(y<0||y>1))return u.copy(f).multiplyScalar(y).add(o.start)}intersectsLine(o){const u=this.distanceToPoint(o.start),f=this.distanceToPoint(o.end);return u<0&&f>0||f<0&&u>0}intersectsBox(o){return o.intersectsPlane(this)}intersectsSphere(o){return o.intersectsPlane(this)}coplanarPoint(o){return o===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),o=new Be),o.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(o,u){const f=u||_u.getNormalMatrix(o),g=this.coplanarPoint(Ss).applyMatrix4(o),y=this.normal.applyMatrix3(f).normalize();return this.constant=-g.dot(y),this}translate(o){return this.constant-=o.dot(this.normal),this}equals(o){return o.normal.equals(this.normal)&&o.constant===this.constant}}const Ia=new Be,ma=new Be,xo=new Be,sr=new Be,Ol=new Be,Fs=new Be,zp=new Be,Hf=new Be,jf=new Be,Gf=new Be;class ga{constructor(o,u,f){this.a=o!==void 0?o:new Be,this.b=u!==void 0?u:new Be,this.c=f!==void 0?f:new Be}static getNormal(o,u,f,g){g===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),g=new Be),g.subVectors(f,u),Ia.subVectors(o,u),g.cross(Ia);const y=g.lengthSq();return y>0?g.multiplyScalar(1/Math.sqrt(y)):g.set(0,0,0)}static getBarycoord(o,u,f,g,y){Ia.subVectors(g,u),ma.subVectors(f,u),xo.subVectors(o,u);const T=Ia.dot(Ia),w=Ia.dot(ma),M=Ia.dot(xo),I=ma.dot(ma),z=ma.dot(xo),U=T*I-w*w;if(y===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),y=new Be),U===0)return y.set(-2,-1,-1);const G=1/U,W=(I*M-w*z)*G,J=(T*z-w*M)*G;return y.set(1-W-J,J,W)}static containsPoint(o,u,f,g){return this.getBarycoord(o,u,f,g,sr),sr.x>=0&&sr.y>=0&&sr.x+sr.y<=1}static getUV(o,u,f,g,y,T,w,M){return this.getBarycoord(o,u,f,g,sr),M.set(0,0),M.addScaledVector(y,sr.x),M.addScaledVector(T,sr.y),M.addScaledVector(w,sr.z),M}static isFrontFacing(o,u,f,g){return Ia.subVectors(f,u),ma.subVectors(o,u),Ia.cross(ma).dot(g)<0}set(o,u,f){return this.a.copy(o),this.b.copy(u),this.c.copy(f),this}setFromPointsAndIndices(o,u,f,g){return this.a.copy(o[u]),this.b.copy(o[f]),this.c.copy(o[g]),this}clone(){return new this.constructor().copy(this)}copy(o){return this.a.copy(o.a),this.b.copy(o.b),this.c.copy(o.c),this}getArea(){return Ia.subVectors(this.c,this.b),ma.subVectors(this.a,this.b),Ia.cross(ma).length()*.5}getMidpoint(o){return o===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),o=new Be),o.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(o){return ga.getNormal(this.a,this.b,this.c,o)}getPlane(o){return o===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),o=new Da),o.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(o,u){return ga.getBarycoord(o,this.a,this.b,this.c,u)}getUV(o,u,f,g,y){return ga.getUV(o,this.a,this.b,this.c,u,f,g,y)}containsPoint(o){return ga.containsPoint(o,this.a,this.b,this.c)}isFrontFacing(o){return ga.isFrontFacing(this.a,this.b,this.c,o)}intersectsBox(o){return o.intersectsTriangle(this)}closestPointToPoint(o,u){u===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),u=new Be);const f=this.a,g=this.b,y=this.c;let T,w;Ol.subVectors(g,f),Fs.subVectors(y,f),Hf.subVectors(o,f);const M=Ol.dot(Hf),I=Fs.dot(Hf);if(M<=0&&I<=0)return u.copy(f);jf.subVectors(o,g);const z=Ol.dot(jf),U=Fs.dot(jf);if(z>=0&&U<=z)return u.copy(g);const G=M*U-z*I;if(G<=0&&M>=0&&z<=0)return T=M/(M-z),u.copy(f).addScaledVector(Ol,T);Gf.subVectors(o,y);const W=Ol.dot(Gf),J=Fs.dot(Gf);if(J>=0&&W<=J)return u.copy(y);const me=W*I-M*J;if(me<=0&&I>=0&&J<=0)return w=I/(I-J),u.copy(f).addScaledVector(Fs,w);const pe=z*J-W*U;if(pe<=0&&U-z>=0&&W-J>=0)return zp.subVectors(y,g),w=(U-z)/(U-z+(W-J)),u.copy(g).addScaledVector(zp,w);const te=1/(pe+me+G);return T=me*te,w=G*te,u.copy(f).addScaledVector(Ol,T).addScaledVector(Fs,w)}equals(o){return o.a.equals(this.a)&&o.b.equals(this.b)&&o.c.equals(this.c)}}const Hp={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},qs={h:0,s:0,l:0},vd={h:0,s:0,l:0};function Rh(l,o,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?l+(o-l)*6*u:u<1/2?o:u<2/3?l+(o-l)*6*(2/3-u):l}function jp(l){return l<.04045?l*.0773993808:Math.pow(l*.9478672986+.0521327014,2.4)}function Gp(l){return l<.0031308?l*12.92:1.055*Math.pow(l,.41666)-.055}class Fi{constructor(o,u,f){return Object.defineProperty(this,"isColor",{value:!0}),u===void 0&&f===void 0?this.set(o):this.setRGB(o,u,f)}set(o){return o&&o.isColor?this.copy(o):typeof o=="number"?this.setHex(o):typeof o=="string"&&this.setStyle(o),this}setScalar(o){return this.r=o,this.g=o,this.b=o,this}setHex(o){return o=Math.floor(o),this.r=(o>>16&255)/255,this.g=(o>>8&255)/255,this.b=(o&255)/255,this}setRGB(o,u,f){return this.r=o,this.g=u,this.b=f,this}setHSL(o,u,f){if(o=Gi.euclideanModulo(o,1),u=Gi.clamp(u,0,1),f=Gi.clamp(f,0,1),u===0)this.r=this.g=this.b=f;else{const g=f<=.5?f*(1+u):f+u-f*u,y=2*f-g;this.r=Rh(y,g,o+1/3),this.g=Rh(y,g,o),this.b=Rh(y,g,o-1/3)}return this}setStyle(o){function u(g){g!==void 0&&parseFloat(g)<1&&console.warn("THREE.Color: Alpha component of "+o+" will be ignored.")}let f;if(f=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(o)){let g;const y=f[1],T=f[2];switch(y){case"rgb":case"rgba":if(g=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(T))return this.r=Math.min(255,parseInt(g[1],10))/255,this.g=Math.min(255,parseInt(g[2],10))/255,this.b=Math.min(255,parseInt(g[3],10))/255,u(g[4]),this;if(g=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(T))return this.r=Math.min(100,parseInt(g[1],10))/100,this.g=Math.min(100,parseInt(g[2],10))/100,this.b=Math.min(100,parseInt(g[3],10))/100,u(g[4]),this;break;case"hsl":case"hsla":if(g=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(T)){const w=parseFloat(g[1])/360,M=parseInt(g[2],10)/100,I=parseInt(g[3],10)/100;return u(g[4]),this.setHSL(w,M,I)}break}}else if(f=/^\#([A-Fa-f\d]+)$/.exec(o)){const g=f[1],y=g.length;if(y===3)return this.r=parseInt(g.charAt(0)+g.charAt(0),16)/255,this.g=parseInt(g.charAt(1)+g.charAt(1),16)/255,this.b=parseInt(g.charAt(2)+g.charAt(2),16)/255,this;if(y===6)return this.r=parseInt(g.charAt(0)+g.charAt(1),16)/255,this.g=parseInt(g.charAt(2)+g.charAt(3),16)/255,this.b=parseInt(g.charAt(4)+g.charAt(5),16)/255,this}return o&&o.length>0?this.setColorName(o):this}setColorName(o){const u=Hp[o];return u!==void 0?this.setHex(u):console.warn("THREE.Color: Unknown color "+o),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(o){return this.r=o.r,this.g=o.g,this.b=o.b,this}copyGammaToLinear(o,u=2){return this.r=Math.pow(o.r,u),this.g=Math.pow(o.g,u),this.b=Math.pow(o.b,u),this}copyLinearToGamma(o,u=2){const f=u>0?1/u:1;return this.r=Math.pow(o.r,f),this.g=Math.pow(o.g,f),this.b=Math.pow(o.b,f),this}convertGammaToLinear(o){return this.copyGammaToLinear(this,o),this}convertLinearToGamma(o){return this.copyLinearToGamma(this,o),this}copySRGBToLinear(o){return this.r=jp(o.r),this.g=jp(o.g),this.b=jp(o.b),this}copyLinearToSRGB(o){return this.r=Gp(o.r),this.g=Gp(o.g),this.b=Gp(o.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(o){o===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),o={h:0,s:0,l:0});const u=this.r,f=this.g,g=this.b,y=Math.max(u,f,g),T=Math.min(u,f,g);let w,M;const I=(T+y)/2;if(T===y)w=0,M=0;else{const z=y-T;switch(M=I<=.5?z/(y+T):z/(2-y-T),y){case u:w=(f-g)/z+(f<g?6:0);break;case f:w=(g-u)/z+2;break;case g:w=(u-f)/z+4;break}w/=6}return o.h=w,o.s=M,o.l=I,o}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(o,u,f){return this.getHSL(qs),qs.h+=o,qs.s+=u,qs.l+=f,this.setHSL(qs.h,qs.s,qs.l),this}add(o){return this.r+=o.r,this.g+=o.g,this.b+=o.b,this}addColors(o,u){return this.r=o.r+u.r,this.g=o.g+u.g,this.b=o.b+u.b,this}addScalar(o){return this.r+=o,this.g+=o,this.b+=o,this}sub(o){return this.r=Math.max(0,this.r-o.r),this.g=Math.max(0,this.g-o.g),this.b=Math.max(0,this.b-o.b),this}multiply(o){return this.r*=o.r,this.g*=o.g,this.b*=o.b,this}multiplyScalar(o){return this.r*=o,this.g*=o,this.b*=o,this}lerp(o,u){return this.r+=(o.r-this.r)*u,this.g+=(o.g-this.g)*u,this.b+=(o.b-this.b)*u,this}lerpColors(o,u,f){return this.r=o.r+(u.r-o.r)*f,this.g=o.g+(u.g-o.g)*f,this.b=o.b+(u.b-o.b)*f,this}lerpHSL(o,u){this.getHSL(qs),o.getHSL(vd);const f=Gi.lerp(qs.h,vd.h,u),g=Gi.lerp(qs.s,vd.s,u),y=Gi.lerp(qs.l,vd.l,u);return this.setHSL(f,g,y),this}equals(o){return o.r===this.r&&o.g===this.g&&o.b===this.b}fromArray(o,u=0){return this.r=o[u],this.g=o[u+1],this.b=o[u+2],this}toArray(o=[],u=0){return o[u]=this.r,o[u+1]=this.g,o[u+2]=this.b,o}fromBufferAttribute(o,u){return this.r=o.getX(u),this.g=o.getY(u),this.b=o.getZ(u),o.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Fi.NAMES=Hp,Fi.prototype.r=1,Fi.prototype.g=1,Fi.prototype.b=1;class gv{constructor(o,u,f,g,y,T=0){this.a=o,this.b=u,this.c=f,this.normal=g&&g.isVector3?g:new Be,this.vertexNormals=Array.isArray(g)?g:[],this.color=y&&y.isColor?y:new Fi,this.vertexColors=Array.isArray(y)?y:[],this.materialIndex=T}clone(){return new this.constructor().copy(this)}copy(o){this.a=o.a,this.b=o.b,this.c=o.c,this.normal.copy(o.normal),this.color.copy(o.color),this.materialIndex=o.materialIndex;for(let u=0,f=o.vertexNormals.length;u<f;u++)this.vertexNormals[u]=o.vertexNormals[u].clone();for(let u=0,f=o.vertexColors.length;u<f;u++)this.vertexColors[u]=o.vertexColors[u].clone();return this}}let ig=0;function Ji(){Object.defineProperty(this,"id",{value:ig++}),this.uuid=Gi.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=vt,this.side=Ne,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Yt,this.blendDst=vi,this.blendEquation=Se,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=dn,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=go,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Wo,this.stencilZFail=Wo,this.stencilZPass=Wo,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Ji.prototype=X(Object.create(ks.prototype),{constructor:Ji,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(l){if(l!==void 0)for(const o in l){const u=l[o];if(u===void 0){console.warn("THREE.Material: '"+o+"' parameter is undefined.");continue}if(o==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=u===ut;continue}const f=this[o];if(f===void 0){console.warn("THREE."+this.type+": '"+o+"' is not a property of this material.");continue}f&&f.isColor?f.set(u):f&&f.isVector3&&u&&u.isVector3?f.copy(u):this[o]=u}},toJSON:function(l){const o=l===void 0||typeof l=="string";o&&(l={textures:{},images:{}});const u={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};u.uuid=this.uuid,u.type=this.type,this.name!==""&&(u.name=this.name),this.color&&this.color.isColor&&(u.color=this.color.getHex()),this.roughness!==void 0&&(u.roughness=this.roughness),this.metalness!==void 0&&(u.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(u.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(u.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(u.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(u.specular=this.specular.getHex()),this.shininess!==void 0&&(u.shininess=this.shininess),this.clearcoat!==void 0&&(u.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(u.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(u.clearcoatMap=this.clearcoatMap.toJSON(l).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(u.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(l).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(u.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(l).uuid,u.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(u.map=this.map.toJSON(l).uuid),this.matcap&&this.matcap.isTexture&&(u.matcap=this.matcap.toJSON(l).uuid),this.alphaMap&&this.alphaMap.isTexture&&(u.alphaMap=this.alphaMap.toJSON(l).uuid),this.lightMap&&this.lightMap.isTexture&&(u.lightMap=this.lightMap.toJSON(l).uuid),this.aoMap&&this.aoMap.isTexture&&(u.aoMap=this.aoMap.toJSON(l).uuid,u.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(u.bumpMap=this.bumpMap.toJSON(l).uuid,u.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(u.normalMap=this.normalMap.toJSON(l).uuid,u.normalMapType=this.normalMapType,u.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(u.displacementMap=this.displacementMap.toJSON(l).uuid,u.displacementScale=this.displacementScale,u.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(u.roughnessMap=this.roughnessMap.toJSON(l).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(u.metalnessMap=this.metalnessMap.toJSON(l).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(u.emissiveMap=this.emissiveMap.toJSON(l).uuid),this.specularMap&&this.specularMap.isTexture&&(u.specularMap=this.specularMap.toJSON(l).uuid),this.envMap&&this.envMap.isTexture&&(u.envMap=this.envMap.toJSON(l).uuid,u.reflectivity=this.reflectivity,u.refractionRatio=this.refractionRatio,this.combine!==void 0&&(u.combine=this.combine),this.envMapIntensity!==void 0&&(u.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(u.gradientMap=this.gradientMap.toJSON(l).uuid),this.size!==void 0&&(u.size=this.size),this.sizeAttenuation!==void 0&&(u.sizeAttenuation=this.sizeAttenuation),this.blending!==vt&&(u.blending=this.blending),this.flatShading===!0&&(u.flatShading=this.flatShading),this.side!==Ne&&(u.side=this.side),this.vertexColors&&(u.vertexColors=!0),this.opacity<1&&(u.opacity=this.opacity),this.transparent===!0&&(u.transparent=this.transparent),u.depthFunc=this.depthFunc,u.depthTest=this.depthTest,u.depthWrite=this.depthWrite,u.stencilWrite=this.stencilWrite,u.stencilWriteMask=this.stencilWriteMask,u.stencilFunc=this.stencilFunc,u.stencilRef=this.stencilRef,u.stencilFuncMask=this.stencilFuncMask,u.stencilFail=this.stencilFail,u.stencilZFail=this.stencilZFail,u.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(u.rotation=this.rotation),this.polygonOffset===!0&&(u.polygonOffset=!0),this.polygonOffsetFactor!==0&&(u.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(u.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(u.linewidth=this.linewidth),this.dashSize!==void 0&&(u.dashSize=this.dashSize),this.gapSize!==void 0&&(u.gapSize=this.gapSize),this.scale!==void 0&&(u.scale=this.scale),this.dithering===!0&&(u.dithering=!0),this.alphaTest>0&&(u.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(u.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(u.wireframe=this.wireframe),this.wireframeLinewidth>1&&(u.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(u.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(u.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(u.morphTargets=!0),this.morphNormals===!0&&(u.morphNormals=!0),this.skinning===!0&&(u.skinning=!0),this.visible===!1&&(u.visible=!1),this.toneMapped===!1&&(u.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(u.userData=this.userData);function f(g){const y=[];for(const T in g){const w=g[T];delete w.metadata,y.push(w)}return y}if(o){const g=f(l.textures),y=f(l.images);g.length>0&&(u.textures=g),y.length>0&&(u.images=y)}return u},clone:function(){return new this.constructor().copy(this)},copy:function(l){this.name=l.name,this.fog=l.fog,this.blending=l.blending,this.side=l.side,this.flatShading=l.flatShading,this.vertexColors=l.vertexColors,this.opacity=l.opacity,this.transparent=l.transparent,this.blendSrc=l.blendSrc,this.blendDst=l.blendDst,this.blendEquation=l.blendEquation,this.blendSrcAlpha=l.blendSrcAlpha,this.blendDstAlpha=l.blendDstAlpha,this.blendEquationAlpha=l.blendEquationAlpha,this.depthFunc=l.depthFunc,this.depthTest=l.depthTest,this.depthWrite=l.depthWrite,this.stencilWriteMask=l.stencilWriteMask,this.stencilFunc=l.stencilFunc,this.stencilRef=l.stencilRef,this.stencilFuncMask=l.stencilFuncMask,this.stencilFail=l.stencilFail,this.stencilZFail=l.stencilZFail,this.stencilZPass=l.stencilZPass,this.stencilWrite=l.stencilWrite;const o=l.clippingPlanes;let u=null;if(o!==null){const f=o.length;u=new Array(f);for(let g=0;g!==f;++g)u[g]=o[g].clone()}return this.clippingPlanes=u,this.clipIntersection=l.clipIntersection,this.clipShadows=l.clipShadows,this.shadowSide=l.shadowSide,this.colorWrite=l.colorWrite,this.precision=l.precision,this.polygonOffset=l.polygonOffset,this.polygonOffsetFactor=l.polygonOffsetFactor,this.polygonOffsetUnits=l.polygonOffsetUnits,this.dithering=l.dithering,this.alphaTest=l.alphaTest,this.premultipliedAlpha=l.premultipliedAlpha,this.visible=l.visible,this.toneMapped=l.toneMapped,this.userData=JSON.parse(JSON.stringify(l.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Ji.prototype,"needsUpdate",{set:function(l){l===!0&&this.version++}});function Un(l){Ji.call(this),this.type="MeshBasicMaterial",this.color=new Fi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Js,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(l)}Un.prototype=Object.create(Ji.prototype),Un.prototype.constructor=Un,Un.prototype.isMeshBasicMaterial=!0,Un.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.color.copy(l.color),this.map=l.map,this.lightMap=l.lightMap,this.lightMapIntensity=l.lightMapIntensity,this.aoMap=l.aoMap,this.aoMapIntensity=l.aoMapIntensity,this.specularMap=l.specularMap,this.alphaMap=l.alphaMap,this.envMap=l.envMap,this.combine=l.combine,this.reflectivity=l.reflectivity,this.refractionRatio=l.refractionRatio,this.wireframe=l.wireframe,this.wireframeLinewidth=l.wireframeLinewidth,this.wireframeLinecap=l.wireframeLinecap,this.wireframeLinejoin=l.wireframeLinejoin,this.skinning=l.skinning,this.morphTargets=l.morphTargets,this};const wr=new Be,bu=new At;function pn(l,o,u){if(Array.isArray(l))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=l,this.itemSize=o,this.count=l!==void 0?l.length/o:0,this.normalized=u===!0,this.usage=fu,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(pn.prototype,"needsUpdate",{set:function(l){l===!0&&this.version++}}),X(pn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(l){return this.usage=l,this},copy:function(l){return this.name=l.name,this.array=new l.array.constructor(l.array),this.itemSize=l.itemSize,this.count=l.count,this.normalized=l.normalized,this.usage=l.usage,this},copyAt:function(l,o,u){l*=this.itemSize,u*=o.itemSize;for(let f=0,g=this.itemSize;f<g;f++)this.array[l+f]=o.array[u+f];return this},copyArray:function(l){return this.array.set(l),this},copyColorsArray:function(l){const o=this.array;let u=0;for(let f=0,g=l.length;f<g;f++){let y=l[f];y===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",f),y=new Fi),o[u++]=y.r,o[u++]=y.g,o[u++]=y.b}return this},copyVector2sArray:function(l){const o=this.array;let u=0;for(let f=0,g=l.length;f<g;f++){let y=l[f];y===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",f),y=new At),o[u++]=y.x,o[u++]=y.y}return this},copyVector3sArray:function(l){const o=this.array;let u=0;for(let f=0,g=l.length;f<g;f++){let y=l[f];y===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",f),y=new Be),o[u++]=y.x,o[u++]=y.y,o[u++]=y.z}return this},copyVector4sArray:function(l){const o=this.array;let u=0;for(let f=0,g=l.length;f<g;f++){let y=l[f];y===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",f),y=new Yn),o[u++]=y.x,o[u++]=y.y,o[u++]=y.z,o[u++]=y.w}return this},applyMatrix3:function(l){if(this.itemSize===2)for(let o=0,u=this.count;o<u;o++)bu.fromBufferAttribute(this,o),bu.applyMatrix3(l),this.setXY(o,bu.x,bu.y);else if(this.itemSize===3)for(let o=0,u=this.count;o<u;o++)wr.fromBufferAttribute(this,o),wr.applyMatrix3(l),this.setXYZ(o,wr.x,wr.y,wr.z);return this},applyMatrix4:function(l){for(let o=0,u=this.count;o<u;o++)wr.x=this.getX(o),wr.y=this.getY(o),wr.z=this.getZ(o),wr.applyMatrix4(l),this.setXYZ(o,wr.x,wr.y,wr.z);return this},applyNormalMatrix:function(l){for(let o=0,u=this.count;o<u;o++)wr.x=this.getX(o),wr.y=this.getY(o),wr.z=this.getZ(o),wr.applyNormalMatrix(l),this.setXYZ(o,wr.x,wr.y,wr.z);return this},transformDirection:function(l){for(let o=0,u=this.count;o<u;o++)wr.x=this.getX(o),wr.y=this.getY(o),wr.z=this.getZ(o),wr.transformDirection(l),this.setXYZ(o,wr.x,wr.y,wr.z);return this},set:function(l,o=0){return this.array.set(l,o),this},getX:function(l){return this.array[l*this.itemSize]},setX:function(l,o){return this.array[l*this.itemSize]=o,this},getY:function(l){return this.array[l*this.itemSize+1]},setY:function(l,o){return this.array[l*this.itemSize+1]=o,this},getZ:function(l){return this.array[l*this.itemSize+2]},setZ:function(l,o){return this.array[l*this.itemSize+2]=o,this},getW:function(l){return this.array[l*this.itemSize+3]},setW:function(l,o){return this.array[l*this.itemSize+3]=o,this},setXY:function(l,o,u){return l*=this.itemSize,this.array[l+0]=o,this.array[l+1]=u,this},setXYZ:function(l,o,u,f){return l*=this.itemSize,this.array[l+0]=o,this.array[l+1]=u,this.array[l+2]=f,this},setXYZW:function(l,o,u,f,g){return l*=this.itemSize,this.array[l+0]=o,this.array[l+1]=u,this.array[l+2]=f,this.array[l+3]=g,this},onUpload:function(l){return this.onUploadCallback=l,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function Dc(l,o,u){pn.call(this,new Int8Array(l),o,u)}Dc.prototype=Object.create(pn.prototype),Dc.prototype.constructor=Dc;function ic(l,o,u){pn.call(this,new Uint8Array(l),o,u)}ic.prototype=Object.create(pn.prototype),ic.prototype.constructor=ic;function Ic(l,o,u){pn.call(this,new Uint8ClampedArray(l),o,u)}Ic.prototype=Object.create(pn.prototype),Ic.prototype.constructor=Ic;function yd(l,o,u){pn.call(this,new Int16Array(l),o,u)}yd.prototype=Object.create(pn.prototype),yd.prototype.constructor=yd;function Fl(l,o,u){pn.call(this,new Uint16Array(l),o,u)}Fl.prototype=Object.create(pn.prototype),Fl.prototype.constructor=Fl;function $f(l,o,u){pn.call(this,new Int32Array(l),o,u)}$f.prototype=Object.create(pn.prototype),$f.prototype.constructor=$f;function kh(l,o,u){pn.call(this,new Uint32Array(l),o,u)}kh.prototype=Object.create(pn.prototype),kh.prototype.constructor=kh;function _d(l,o,u){pn.call(this,new Uint16Array(l),o,u)}_d.prototype=Object.create(pn.prototype),_d.prototype.constructor=_d,_d.prototype.isFloat16BufferAttribute=!0;function Xr(l,o,u){pn.call(this,new Float32Array(l),o,u)}Xr.prototype=Object.create(pn.prototype),Xr.prototype.constructor=Xr;function bd(l,o,u){pn.call(this,new Float64Array(l),o,u)}bd.prototype=Object.create(pn.prototype),bd.prototype.constructor=bd;function Td(l){if(l.length===0)return-1/0;let o=l[0];for(let u=1,f=l.length;u<f;++u)l[u]>o&&(o=l[u]);return o}const nc={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function tr(l,o){return new nc[l](o)}let Tu=0;const Rr=new fn,So=new Li,Pc=new Be,ja=new vo,Oh=new vo,As=new Be;function $n(){Object.defineProperty(this,"id",{value:Tu++}),this.uuid=Gi.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}$n.prototype=X(Object.create(ks.prototype),{constructor:$n,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(l){return Array.isArray(l)?this.index=new(Td(l)>65535?kh:Fl)(l,1):this.index=l,this},getAttribute:function(l){return this.attributes[l]},setAttribute:function(l,o){return this.attributes[l]=o,this},deleteAttribute:function(l){return delete this.attributes[l],this},hasAttribute:function(l){return this.attributes[l]!==void 0},addGroup:function(l,o,u=0){this.groups.push({start:l,count:o,materialIndex:u})},clearGroups:function(){this.groups=[]},setDrawRange:function(l,o){this.drawRange.start=l,this.drawRange.count=o},applyMatrix4:function(l){const o=this.attributes.position;o!==void 0&&(o.applyMatrix4(l),o.needsUpdate=!0);const u=this.attributes.normal;if(u!==void 0){const g=new Os().getNormalMatrix(l);u.applyNormalMatrix(g),u.needsUpdate=!0}const f=this.attributes.tangent;return f!==void 0&&(f.transformDirection(l),f.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(l){return Rr.makeRotationX(l),this.applyMatrix4(Rr),this},rotateY:function(l){return Rr.makeRotationY(l),this.applyMatrix4(Rr),this},rotateZ:function(l){return Rr.makeRotationZ(l),this.applyMatrix4(Rr),this},translate:function(l,o,u){return Rr.makeTranslation(l,o,u),this.applyMatrix4(Rr),this},scale:function(l,o,u){return Rr.makeScale(l,o,u),this.applyMatrix4(Rr),this},lookAt:function(l){return So.lookAt(l),So.updateMatrix(),this.applyMatrix4(So.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Pc).negate(),this.translate(Pc.x,Pc.y,Pc.z),this},setFromPoints:function(l){const o=[];for(let u=0,f=l.length;u<f;u++){const g=l[u];o.push(g.x,g.y,g.z||0)}return this.setAttribute("position",new Xr(o,3)),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new vo);const l=this.attributes.position,o=this.morphAttributes.position;if(l&&l.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Be(-1/0,-1/0,-1/0),new Be(1/0,1/0,1/0));return}if(l!==void 0){if(this.boundingBox.setFromBufferAttribute(l),o)for(let u=0,f=o.length;u<f;u++){const g=o[u];ja.setFromBufferAttribute(g),this.morphTargetsRelative?(As.addVectors(this.boundingBox.min,ja.min),this.boundingBox.expandByPoint(As),As.addVectors(this.boundingBox.max,ja.max),this.boundingBox.expandByPoint(As)):(this.boundingBox.expandByPoint(ja.min),this.boundingBox.expandByPoint(ja.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Rl);const l=this.attributes.position,o=this.morphAttributes.position;if(l&&l.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Be,1/0);return}if(l){const u=this.boundingSphere.center;if(ja.setFromBufferAttribute(l),o)for(let g=0,y=o.length;g<y;g++){const T=o[g];Oh.setFromBufferAttribute(T),this.morphTargetsRelative?(As.addVectors(ja.min,Oh.min),ja.expandByPoint(As),As.addVectors(ja.max,Oh.max),ja.expandByPoint(As)):(ja.expandByPoint(Oh.min),ja.expandByPoint(Oh.max))}ja.getCenter(u);let f=0;for(let g=0,y=l.count;g<y;g++)As.fromBufferAttribute(l,g),f=Math.max(f,u.distanceToSquared(As));if(o)for(let g=0,y=o.length;g<y;g++){const T=o[g],w=this.morphTargetsRelative;for(let M=0,I=T.count;M<I;M++)As.fromBufferAttribute(T,M),w&&(Pc.fromBufferAttribute(l,M),As.add(Pc)),f=Math.max(f,u.distanceToSquared(As))}this.boundingSphere.radius=Math.sqrt(f),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){const l=this.index,o=this.attributes;if(l===null||o.position===void 0||o.normal===void 0||o.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const u=l.array,f=o.position.array,g=o.normal.array,y=o.uv.array,T=f.length/3;o.tangent===void 0&&this.setAttribute("tangent",new pn(new Float32Array(4*T),4));const w=o.tangent.array,M=[],I=[];for(let wt=0;wt<T;wt++)M[wt]=new Be,I[wt]=new Be;const z=new Be,U=new Be,G=new Be,W=new At,J=new At,me=new At,pe=new Be,te=new Be;function K(wt,It,Pt){z.fromArray(f,wt*3),U.fromArray(f,It*3),G.fromArray(f,Pt*3),W.fromArray(y,wt*2),J.fromArray(y,It*2),me.fromArray(y,Pt*2),U.sub(z),G.sub(z),J.sub(W),me.sub(W);const Nt=1/(J.x*me.y-me.x*J.y);isFinite(Nt)&&(pe.copy(U).multiplyScalar(me.y).addScaledVector(G,-J.y).multiplyScalar(Nt),te.copy(G).multiplyScalar(J.x).addScaledVector(U,-me.x).multiplyScalar(Nt),M[wt].add(pe),M[It].add(pe),M[Pt].add(pe),I[wt].add(te),I[It].add(te),I[Pt].add(te))}let He=this.groups;He.length===0&&(He=[{start:0,count:u.length}]);for(let wt=0,It=He.length;wt<It;++wt){const Pt=He[wt],Nt=Pt.start,nt=Pt.count;for(let Ke=Nt,st=Nt+nt;Ke<st;Ke+=3)K(u[Ke+0],u[Ke+1],u[Ke+2])}const $e=new Be,Ue=new Be,Ae=new Be,at=new Be;function Ht(wt){Ae.fromArray(g,wt*3),at.copy(Ae);const It=M[wt];$e.copy(It),$e.sub(Ae.multiplyScalar(Ae.dot(It))).normalize(),Ue.crossVectors(at,It);const Nt=Ue.dot(I[wt])<0?-1:1;w[wt*4]=$e.x,w[wt*4+1]=$e.y,w[wt*4+2]=$e.z,w[wt*4+3]=Nt}for(let wt=0,It=He.length;wt<It;++wt){const Pt=He[wt],Nt=Pt.start,nt=Pt.count;for(let Ke=Nt,st=Nt+nt;Ke<st;Ke+=3)Ht(u[Ke+0]),Ht(u[Ke+1]),Ht(u[Ke+2])}},computeVertexNormals:function(){const l=this.index,o=this.getAttribute("position");if(o!==void 0){let u=this.getAttribute("normal");if(u===void 0)u=new pn(new Float32Array(o.count*3),3),this.setAttribute("normal",u);else for(let U=0,G=u.count;U<G;U++)u.setXYZ(U,0,0,0);const f=new Be,g=new Be,y=new Be,T=new Be,w=new Be,M=new Be,I=new Be,z=new Be;if(l)for(let U=0,G=l.count;U<G;U+=3){const W=l.getX(U+0),J=l.getX(U+1),me=l.getX(U+2);f.fromBufferAttribute(o,W),g.fromBufferAttribute(o,J),y.fromBufferAttribute(o,me),I.subVectors(y,g),z.subVectors(f,g),I.cross(z),T.fromBufferAttribute(u,W),w.fromBufferAttribute(u,J),M.fromBufferAttribute(u,me),T.add(I),w.add(I),M.add(I),u.setXYZ(W,T.x,T.y,T.z),u.setXYZ(J,w.x,w.y,w.z),u.setXYZ(me,M.x,M.y,M.z)}else for(let U=0,G=o.count;U<G;U+=3)f.fromBufferAttribute(o,U+0),g.fromBufferAttribute(o,U+1),y.fromBufferAttribute(o,U+2),I.subVectors(y,g),z.subVectors(f,g),I.cross(z),u.setXYZ(U+0,I.x,I.y,I.z),u.setXYZ(U+1,I.x,I.y,I.z),u.setXYZ(U+2,I.x,I.y,I.z);this.normalizeNormals(),u.needsUpdate=!0}},merge:function(l,o){if(!(l&&l.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",l);return}o===void 0&&(o=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const u=this.attributes;for(const f in u){if(l.attributes[f]===void 0)continue;const y=u[f].array,T=l.attributes[f],w=T.array,M=T.itemSize*o,I=Math.min(w.length,y.length-M);for(let z=0,U=M;z<I;z++,U++)y[U]=w[z]}return this},normalizeNormals:function(){const l=this.attributes.normal;for(let o=0,u=l.count;o<u;o++)As.fromBufferAttribute(l,o),As.normalize(),l.setXYZ(o,As.x,As.y,As.z)},toNonIndexed:function(){function l(T,w){const M=T.array,I=T.itemSize,z=T.normalized,U=new M.constructor(w.length*I);let G=0,W=0;for(let J=0,me=w.length;J<me;J++){G=w[J]*I;for(let pe=0;pe<I;pe++)U[W++]=M[G++]}return new pn(U,I,z)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const o=new $n,u=this.index.array,f=this.attributes;for(const T in f){const w=f[T],M=l(w,u);o.setAttribute(T,M)}const g=this.morphAttributes;for(const T in g){const w=[],M=g[T];for(let I=0,z=M.length;I<z;I++){const U=M[I],G=l(U,u);w.push(G)}o.morphAttributes[T]=w}o.morphTargetsRelative=this.morphTargetsRelative;const y=this.groups;for(let T=0,w=y.length;T<w;T++){const M=y[T];o.addGroup(M.start,M.count,M.materialIndex)}return o},toJSON:function(){const l={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(l.uuid=this.uuid,l.type=this.type,this.name!==""&&(l.name=this.name),Object.keys(this.userData).length>0&&(l.userData=this.userData),this.parameters!==void 0){const w=this.parameters;for(const M in w)w[M]!==void 0&&(l[M]=w[M]);return l}l.data={attributes:{}};const o=this.index;o!==null&&(l.data.index={type:o.array.constructor.name,array:Array.prototype.slice.call(o.array)});const u=this.attributes;for(const w in u){const M=u[w],I=M.toJSON(l.data);M.name!==""&&(I.name=M.name),l.data.attributes[w]=I}const f={};let g=!1;for(const w in this.morphAttributes){const M=this.morphAttributes[w],I=[];for(let z=0,U=M.length;z<U;z++){const G=M[z],W=G.toJSON(l.data);G.name!==""&&(W.name=G.name),I.push(W)}I.length>0&&(f[w]=I,g=!0)}g&&(l.data.morphAttributes=f,l.data.morphTargetsRelative=this.morphTargetsRelative);const y=this.groups;y.length>0&&(l.data.groups=JSON.parse(JSON.stringify(y)));const T=this.boundingSphere;return T!==null&&(l.data.boundingSphere={center:T.center.toArray(),radius:T.radius}),l},clone:function(){return new $n().copy(this)},copy:function(l){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const o={};this.name=l.name;const u=l.index;u!==null&&this.setIndex(u.clone(o));const f=l.attributes;for(const M in f){const I=f[M];this.setAttribute(M,I.clone(o))}const g=l.morphAttributes;for(const M in g){const I=[],z=g[M];for(let U=0,G=z.length;U<G;U++)I.push(z[U].clone(o));this.morphAttributes[M]=I}this.morphTargetsRelative=l.morphTargetsRelative;const y=l.groups;for(let M=0,I=y.length;M<I;M++){const z=y[M];this.addGroup(z.start,z.count,z.materialIndex)}const T=l.boundingBox;T!==null&&(this.boundingBox=T.clone());const w=l.boundingSphere;return w!==null&&(this.boundingSphere=w.clone()),this.drawRange.start=l.drawRange.start,this.drawRange.count=l.drawRange.count,this.userData=l.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const $p=new fn,Qo=new Yo,Ao=new Rl,wo=new Be,na=new Be,S=new Be,D=new Be,k=new Be,L=new Be,j=new Be,Y=new Be,ye=new Be,Te=new At,Me=new At,Le=new At,Ge=new Be,pt=new Be;function Gt(l=new $n,o=new Un){Li.call(this),this.type="Mesh",this.geometry=l,this.material=o,this.updateMorphTargets()}Gt.prototype=X(Object.create(Li.prototype),{constructor:Gt,isMesh:!0,copy:function(l){return Li.prototype.copy.call(this,l),l.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=l.morphTargetInfluences.slice()),l.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=X({},l.morphTargetDictionary)),this.material=l.material,this.geometry=l.geometry,this},updateMorphTargets:function(){const l=this.geometry;if(l.isBufferGeometry){const o=l.morphAttributes,u=Object.keys(o);if(u.length>0){const f=o[u[0]];if(f!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let g=0,y=f.length;g<y;g++){const T=f[g].name||String(g);this.morphTargetInfluences.push(0),this.morphTargetDictionary[T]=g}}}}else{const o=l.morphTargets;o!==void 0&&o.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(l,o){const u=this.geometry,f=this.material,g=this.matrixWorld;if(f===void 0||(u.boundingSphere===null&&u.computeBoundingSphere(),Ao.copy(u.boundingSphere),Ao.applyMatrix4(g),l.ray.intersectsSphere(Ao)===!1)||($p.copy(g).invert(),Qo.copy(l.ray).applyMatrix4($p),u.boundingBox!==null&&Qo.intersectsBox(u.boundingBox)===!1))return;let y;if(u.isBufferGeometry){const T=u.index,w=u.attributes.position,M=u.morphAttributes.position,I=u.morphTargetsRelative,z=u.attributes.uv,U=u.attributes.uv2,G=u.groups,W=u.drawRange;if(T!==null)if(Array.isArray(f))for(let J=0,me=G.length;J<me;J++){const pe=G[J],te=f[pe.materialIndex],K=Math.max(pe.start,W.start),He=Math.min(pe.start+pe.count,W.start+W.count);for(let $e=K,Ue=He;$e<Ue;$e+=3){const Ae=T.getX($e),at=T.getX($e+1),Ht=T.getX($e+2);y=Mi(this,te,l,Qo,w,M,I,z,U,Ae,at,Ht),y&&(y.faceIndex=Math.floor($e/3),y.face.materialIndex=pe.materialIndex,o.push(y))}}else{const J=Math.max(0,W.start),me=Math.min(T.count,W.start+W.count);for(let pe=J,te=me;pe<te;pe+=3){const K=T.getX(pe),He=T.getX(pe+1),$e=T.getX(pe+2);y=Mi(this,f,l,Qo,w,M,I,z,U,K,He,$e),y&&(y.faceIndex=Math.floor(pe/3),o.push(y))}}else if(w!==void 0)if(Array.isArray(f))for(let J=0,me=G.length;J<me;J++){const pe=G[J],te=f[pe.materialIndex],K=Math.max(pe.start,W.start),He=Math.min(pe.start+pe.count,W.start+W.count);for(let $e=K,Ue=He;$e<Ue;$e+=3){const Ae=$e,at=$e+1,Ht=$e+2;y=Mi(this,te,l,Qo,w,M,I,z,U,Ae,at,Ht),y&&(y.faceIndex=Math.floor($e/3),y.face.materialIndex=pe.materialIndex,o.push(y))}}else{const J=Math.max(0,W.start),me=Math.min(w.count,W.start+W.count);for(let pe=J,te=me;pe<te;pe+=3){const K=pe,He=pe+1,$e=pe+2;y=Mi(this,f,l,Qo,w,M,I,z,U,K,He,$e),y&&(y.faceIndex=Math.floor(pe/3),o.push(y))}}}else u.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}});function Rt(l,o,u,f,g,y,T,w){let M;if(o.side===De?M=f.intersectTriangle(T,y,g,!0,w):M=f.intersectTriangle(g,y,T,o.side!==ke,w),M===null)return null;pt.copy(w),pt.applyMatrix4(l.matrixWorld);const I=u.ray.origin.distanceTo(pt);return I<u.near||I>u.far?null:{distance:I,point:pt.clone(),object:l}}function Mi(l,o,u,f,g,y,T,w,M,I,z,U){wo.fromBufferAttribute(g,I),na.fromBufferAttribute(g,z),S.fromBufferAttribute(g,U);const G=l.morphTargetInfluences;if(o.morphTargets&&y&&G){j.set(0,0,0),Y.set(0,0,0),ye.set(0,0,0);for(let J=0,me=y.length;J<me;J++){const pe=G[J],te=y[J];pe!==0&&(D.fromBufferAttribute(te,I),k.fromBufferAttribute(te,z),L.fromBufferAttribute(te,U),T?(j.addScaledVector(D,pe),Y.addScaledVector(k,pe),ye.addScaledVector(L,pe)):(j.addScaledVector(D.sub(wo),pe),Y.addScaledVector(k.sub(na),pe),ye.addScaledVector(L.sub(S),pe)))}wo.add(j),na.add(Y),S.add(ye)}l.isSkinnedMesh&&(l.boneTransform(I,wo),l.boneTransform(z,na),l.boneTransform(U,S));const W=Rt(l,o,u,f,wo,na,S,Ge);if(W){w&&(Te.fromBufferAttribute(w,I),Me.fromBufferAttribute(w,z),Le.fromBufferAttribute(w,U),W.uv=ga.getUV(Ge,wo,na,S,Te,Me,Le,new At)),M&&(Te.fromBufferAttribute(M,I),Me.fromBufferAttribute(M,z),Le.fromBufferAttribute(M,U),W.uv2=ga.getUV(Ge,wo,na,S,Te,Me,Le,new At));const J=new gv(I,z,U);ga.getNormal(wo,na,S,J.normal),W.face=J}return W}class Xi extends $n{constructor(o=1,u=1,f=1,g=1,y=1,T=1){super(),this.type="BoxGeometry",this.parameters={width:o,height:u,depth:f,widthSegments:g,heightSegments:y,depthSegments:T};const w=this;g=Math.floor(g),y=Math.floor(y),T=Math.floor(T);const M=[],I=[],z=[],U=[];let G=0,W=0;J("z","y","x",-1,-1,f,u,o,T,y,0),J("z","y","x",1,-1,f,u,-o,T,y,1),J("x","z","y",1,1,o,f,u,g,T,2),J("x","z","y",1,-1,o,f,-u,g,T,3),J("x","y","z",1,-1,o,u,f,g,y,4),J("x","y","z",-1,-1,o,u,-f,g,y,5),this.setIndex(M),this.setAttribute("position",new Xr(I,3)),this.setAttribute("normal",new Xr(z,3)),this.setAttribute("uv",new Xr(U,2));function J(me,pe,te,K,He,$e,Ue,Ae,at,Ht,wt){const It=$e/at,Pt=Ue/Ht,Nt=$e/2,nt=Ue/2,Ke=Ae/2,st=at+1,Ct=Ht+1;let Xt=0,ti=0;const ni=new Be;for(let Ai=0;Ai<Ct;Ai++){const _i=Ai*Pt-nt;for(let on=0;on<st;on++){const vn=on*It-Nt;ni[me]=vn*K,ni[pe]=_i*He,ni[te]=Ke,I.push(ni.x,ni.y,ni.z),ni[me]=0,ni[pe]=0,ni[te]=Ae>0?1:-1,z.push(ni.x,ni.y,ni.z),U.push(on/at),U.push(1-Ai/Ht),Xt+=1}}for(let Ai=0;Ai<Ht;Ai++)for(let _i=0;_i<at;_i++){const on=G+_i+st*Ai,vn=G+_i+st*(Ai+1),Pn=G+(_i+1)+st*(Ai+1),Kt=G+(_i+1)+st*Ai;M.push(on,vn,Kt),M.push(vn,Pn,Kt),ti+=6}w.addGroup(W,ti,wt),W+=ti,G+=Xt}}}function Er(l){const o={};for(const u in l){o[u]={};for(const f in l[u]){const g=l[u][f];g&&(g.isColor||g.isMatrix3||g.isMatrix4||g.isVector2||g.isVector3||g.isVector4||g.isTexture)?o[u][f]=g.clone():Array.isArray(g)?o[u][f]=g.slice():o[u][f]=g}}return o}function xn(l){const o={};for(let u=0;u<l.length;u++){const f=Er(l[u]);for(const g in f)o[g]=f[g]}return o}const Ko={clone:Er,merge:xn};var xd=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Sd=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function rs(l){Ji.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=xd,this.fragmentShader=Sd,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,l!==void 0&&(l.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(l))}rs.prototype=Object.create(Ji.prototype),rs.prototype.constructor=rs,rs.prototype.isShaderMaterial=!0,rs.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.fragmentShader=l.fragmentShader,this.vertexShader=l.vertexShader,this.uniforms=Er(l.uniforms),this.defines=X({},l.defines),this.wireframe=l.wireframe,this.wireframeLinewidth=l.wireframeLinewidth,this.lights=l.lights,this.clipping=l.clipping,this.skinning=l.skinning,this.morphTargets=l.morphTargets,this.morphNormals=l.morphNormals,this.extensions=X({},l.extensions),this.glslVersion=l.glslVersion,this},rs.prototype.toJSON=function(l){const o=Ji.prototype.toJSON.call(this,l);o.glslVersion=this.glslVersion,o.uniforms={};for(const f in this.uniforms){const y=this.uniforms[f].value;y&&y.isTexture?o.uniforms[f]={type:"t",value:y.toJSON(l).uuid}:y&&y.isColor?o.uniforms[f]={type:"c",value:y.getHex()}:y&&y.isVector2?o.uniforms[f]={type:"v2",value:y.toArray()}:y&&y.isVector3?o.uniforms[f]={type:"v3",value:y.toArray()}:y&&y.isVector4?o.uniforms[f]={type:"v4",value:y.toArray()}:y&&y.isMatrix3?o.uniforms[f]={type:"m3",value:y.toArray()}:y&&y.isMatrix4?o.uniforms[f]={type:"m4",value:y.toArray()}:o.uniforms[f]={value:y}}Object.keys(this.defines).length>0&&(o.defines=this.defines),o.vertexShader=this.vertexShader,o.fragmentShader=this.fragmentShader;const u={};for(const f in this.extensions)this.extensions[f]===!0&&(u[f]=!0);return Object.keys(u).length>0&&(o.extensions=u),o};function lo(){Li.call(this),this.type="Camera",this.matrixWorldInverse=new fn,this.projectionMatrix=new fn,this.projectionMatrixInverse=new fn}lo.prototype=X(Object.create(Li.prototype),{constructor:lo,isCamera:!0,copy:function(l,o){return Li.prototype.copy.call(this,l,o),this.matrixWorldInverse.copy(l.matrixWorldInverse),this.projectionMatrix.copy(l.projectionMatrix),this.projectionMatrixInverse.copy(l.projectionMatrixInverse),this},getWorldDirection:function(l){l===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),l=new Be),this.updateWorldMatrix(!0,!1);const o=this.matrixWorld.elements;return l.set(-o[8],-o[9],-o[10]).normalize()},updateMatrixWorld:function(l){Li.prototype.updateMatrixWorld.call(this,l),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(l,o){Li.prototype.updateWorldMatrix.call(this,l,o),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return new this.constructor().copy(this)}});function fr(l=50,o=1,u=.1,f=2e3){lo.call(this),this.type="PerspectiveCamera",this.fov=l,this.zoom=1,this.near=u,this.far=f,this.focus=10,this.aspect=o,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}fr.prototype=X(Object.create(lo.prototype),{constructor:fr,isPerspectiveCamera:!0,copy:function(l,o){return lo.prototype.copy.call(this,l,o),this.fov=l.fov,this.zoom=l.zoom,this.near=l.near,this.far=l.far,this.focus=l.focus,this.aspect=l.aspect,this.view=l.view===null?null:X({},l.view),this.filmGauge=l.filmGauge,this.filmOffset=l.filmOffset,this},setFocalLength:function(l){const o=.5*this.getFilmHeight()/l;this.fov=Gi.RAD2DEG*2*Math.atan(o),this.updateProjectionMatrix()},getFocalLength:function(){const l=Math.tan(Gi.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/l},getEffectiveFOV:function(){return Gi.RAD2DEG*2*Math.atan(Math.tan(Gi.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(l,o,u,f,g,y){this.aspect=l/o,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=l,this.view.fullHeight=o,this.view.offsetX=u,this.view.offsetY=f,this.view.width=g,this.view.height=y,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const l=this.near;let o=l*Math.tan(Gi.DEG2RAD*.5*this.fov)/this.zoom,u=2*o,f=this.aspect*u,g=-.5*f;const y=this.view;if(this.view!==null&&this.view.enabled){const w=y.fullWidth,M=y.fullHeight;g+=y.offsetX*f/w,o-=y.offsetY*u/M,f*=y.width/w,u*=y.height/M}const T=this.filmOffset;T!==0&&(g+=l*T/this.getFilmWidth()),this.projectionMatrix.makePerspective(g,g+f,o,o-u,l,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(l){const o=Li.prototype.toJSON.call(this,l);return o.object.fov=this.fov,o.object.zoom=this.zoom,o.object.near=this.near,o.object.far=this.far,o.object.focus=this.focus,o.object.aspect=this.aspect,this.view!==null&&(o.object.view=X({},this.view)),o.object.filmGauge=this.filmGauge,o.object.filmOffset=this.filmOffset,o}});const ar=90,Eo=1;function ra(l,o,u){if(Li.call(this),this.type="CubeCamera",u.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=u;const f=new fr(ar,Eo,l,o);f.layers=this.layers,f.up.set(0,-1,0),f.lookAt(new Be(1,0,0)),this.add(f);const g=new fr(ar,Eo,l,o);g.layers=this.layers,g.up.set(0,-1,0),g.lookAt(new Be(-1,0,0)),this.add(g);const y=new fr(ar,Eo,l,o);y.layers=this.layers,y.up.set(0,0,1),y.lookAt(new Be(0,1,0)),this.add(y);const T=new fr(ar,Eo,l,o);T.layers=this.layers,T.up.set(0,0,-1),T.lookAt(new Be(0,-1,0)),this.add(T);const w=new fr(ar,Eo,l,o);w.layers=this.layers,w.up.set(0,-1,0),w.lookAt(new Be(0,0,1)),this.add(w);const M=new fr(ar,Eo,l,o);M.layers=this.layers,M.up.set(0,-1,0),M.lookAt(new Be(0,0,-1)),this.add(M),this.update=function(I,z){this.parent===null&&this.updateMatrixWorld();const U=I.xr.enabled,G=I.getRenderTarget();I.xr.enabled=!1;const W=u.texture.generateMipmaps;u.texture.generateMipmaps=!1,I.setRenderTarget(u,0),I.render(z,f),I.setRenderTarget(u,1),I.render(z,g),I.setRenderTarget(u,2),I.render(z,y),I.setRenderTarget(u,3),I.render(z,T),I.setRenderTarget(u,4),I.render(z,w),u.texture.generateMipmaps=W,I.setRenderTarget(u,5),I.render(z,M),I.setRenderTarget(G),I.xr.enabled=U}}ra.prototype=Object.create(Li.prototype),ra.prototype.constructor=ra;function Ad(l,o,u,f,g,y,T,w,M,I){l=l!==void 0?l:[],o=o!==void 0?o:di,T=T!==void 0?T:ta,dr.call(this,l,o,u,f,g,y,T,w,M,I),this.flipY=!1,this._needsFlipEnvMap=!0}Ad.prototype=Object.create(dr.prototype),Ad.prototype.constructor=Ad,Ad.prototype.isCubeTexture=!0,Object.defineProperty(Ad.prototype,"images",{get:function(){return this.image},set:function(l){this.image=l}});class wd extends ec{constructor(o,u,f){Number.isInteger(u)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),u=f),super(o,o,u),Object.defineProperty(this,"isWebGLCubeRenderTarget",{value:!0}),u=u||{},this.texture=new Ad(void 0,u.mapping,u.wrapS,u.wrapT,u.magFilter,u.minFilter,u.format,u.type,u.anisotropy,u.encoding),this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(o,u){this.texture.type=u.type,this.texture.format=cr,this.texture.encoding=u.encoding,this.texture.generateMipmaps=u.generateMipmaps,this.texture.minFilter=u.minFilter,this.texture.magFilter=u.magFilter;const f={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},g=new Xi(5,5,5),y=new rs({name:"CubemapFromEquirect",uniforms:Er(f.uniforms),vertexShader:f.vertexShader,fragmentShader:f.fragmentShader,side:De,blending:_t});y.uniforms.tEquirect.value=u;const T=new Gt(g,y),w=u.minFilter;return u.minFilter===Kr&&(u.minFilter=Ui),new ra(1,10,this).update(o,T),u.minFilter=w,T.geometry.dispose(),T.material.dispose(),this}clear(o,u,f,g){const y=o.getRenderTarget();for(let T=0;T<6;T++)o.setRenderTarget(this,T),o.clear(u,f,g);o.setRenderTarget(y)}}function xu(l,o,u,f,g,y,T,w,M,I,z,U){dr.call(this,null,y,T,w,M,I,f,g,z,U),this.image={data:l||null,width:o||1,height:u||1},this.magFilter=M!==void 0?M:Ye,this.minFilter=I!==void 0?I:Ye,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}xu.prototype=Object.create(dr.prototype),xu.prototype.constructor=xu,xu.prototype.isDataTexture=!0;const Su=new Rl,Fh=new Be;class Bh{constructor(o,u,f,g,y,T){this.planes=[o!==void 0?o:new Da,u!==void 0?u:new Da,f!==void 0?f:new Da,g!==void 0?g:new Da,y!==void 0?y:new Da,T!==void 0?T:new Da]}set(o,u,f,g,y,T){const w=this.planes;return w[0].copy(o),w[1].copy(u),w[2].copy(f),w[3].copy(g),w[4].copy(y),w[5].copy(T),this}clone(){return new this.constructor().copy(this)}copy(o){const u=this.planes;for(let f=0;f<6;f++)u[f].copy(o.planes[f]);return this}setFromProjectionMatrix(o){const u=this.planes,f=o.elements,g=f[0],y=f[1],T=f[2],w=f[3],M=f[4],I=f[5],z=f[6],U=f[7],G=f[8],W=f[9],J=f[10],me=f[11],pe=f[12],te=f[13],K=f[14],He=f[15];return u[0].setComponents(w-g,U-M,me-G,He-pe).normalize(),u[1].setComponents(w+g,U+M,me+G,He+pe).normalize(),u[2].setComponents(w+y,U+I,me+W,He+te).normalize(),u[3].setComponents(w-y,U-I,me-W,He-te).normalize(),u[4].setComponents(w-T,U-z,me-J,He-K).normalize(),u[5].setComponents(w+T,U+z,me+J,He+K).normalize(),this}intersectsObject(o){const u=o.geometry;return u.boundingSphere===null&&u.computeBoundingSphere(),Su.copy(u.boundingSphere).applyMatrix4(o.matrixWorld),this.intersectsSphere(Su)}intersectsSprite(o){return Su.center.set(0,0,0),Su.radius=.7071067811865476,Su.applyMatrix4(o.matrixWorld),this.intersectsSphere(Su)}intersectsSphere(o){const u=this.planes,f=o.center,g=-o.radius;for(let y=0;y<6;y++)if(u[y].distanceToPoint(f)<g)return!1;return!0}intersectsBox(o){const u=this.planes;for(let f=0;f<6;f++){const g=u[f];if(Fh.x=g.normal.x>0?o.max.x:o.min.x,Fh.y=g.normal.y>0?o.max.y:o.min.y,Fh.z=g.normal.z>0?o.max.z:o.min.z,g.distanceToPoint(Fh)<0)return!1}return!0}containsPoint(o){const u=this.planes;for(let f=0;f<6;f++)if(u[f].distanceToPoint(o)<0)return!1;return!0}}function Zo(){let l=null,o=!1,u=null,f=null;function g(y,T){u(y,T),f=l.requestAnimationFrame(g)}return{start:function(){o!==!0&&u!==null&&(f=l.requestAnimationFrame(g),o=!0)},stop:function(){l.cancelAnimationFrame(f),o=!1},setAnimationLoop:function(y){u=y},setContext:function(y){l=y}}}function Bl(l,o){const u=o.isWebGL2,f=new WeakMap;function g(I,z){const U=I.array,G=I.usage,W=l.createBuffer();l.bindBuffer(z,W),l.bufferData(z,U,G),I.onUploadCallback();let J=5126;return U instanceof Float32Array?J=5126:U instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):U instanceof Uint16Array?I.isFloat16BufferAttribute?u?J=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):J=5123:U instanceof Int16Array?J=5122:U instanceof Uint32Array?J=5125:U instanceof Int32Array?J=5124:U instanceof Int8Array?J=5120:U instanceof Uint8Array&&(J=5121),{buffer:W,type:J,bytesPerElement:U.BYTES_PER_ELEMENT,version:I.version}}function y(I,z,U){const G=z.array,W=z.updateRange;l.bindBuffer(U,I),W.count===-1?l.bufferSubData(U,0,G):(u?l.bufferSubData(U,W.offset*G.BYTES_PER_ELEMENT,G,W.offset,W.count):l.bufferSubData(U,W.offset*G.BYTES_PER_ELEMENT,G.subarray(W.offset,W.offset+W.count)),W.count=-1)}function T(I){return I.isInterleavedBufferAttribute&&(I=I.data),f.get(I)}function w(I){I.isInterleavedBufferAttribute&&(I=I.data);const z=f.get(I);z&&(l.deleteBuffer(z.buffer),f.delete(I))}function M(I,z){if(I.isGLBufferAttribute){const G=f.get(I);(!G||G.version<I.version)&&f.set(I,{buffer:I.buffer,type:I.type,bytesPerElement:I.elementSize,version:I.version});return}I.isInterleavedBufferAttribute&&(I=I.data);const U=f.get(I);U===void 0?f.set(I,g(I,z)):U.version<I.version&&(y(U.buffer,I,z),U.version=I.version)}return{get:T,remove:w,update:M}}class Nh extends $n{constructor(o=1,u=1,f=1,g=1){super(),this.type="PlaneGeometry",this.parameters={width:o,height:u,widthSegments:f,heightSegments:g};const y=o/2,T=u/2,w=Math.floor(f),M=Math.floor(g),I=w+1,z=M+1,U=o/w,G=u/M,W=[],J=[],me=[],pe=[];for(let te=0;te<z;te++){const K=te*G-T;for(let He=0;He<I;He++){const $e=He*U-y;J.push($e,-K,0),me.push(0,0,1),pe.push(He/w),pe.push(1-te/M)}}for(let te=0;te<M;te++)for(let K=0;K<w;K++){const He=K+I*te,$e=K+I*(te+1),Ue=K+1+I*(te+1),Ae=K+1+I*te;W.push(He,$e,Ae),W.push($e,Ue,Ae)}this.setIndex(W),this.setAttribute("position",new Xr(J,3)),this.setAttribute("normal",new Xr(me,3)),this.setAttribute("uv",new Xr(pe,2))}}var Lc=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,Rc=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Uh=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,sb=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,vv=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,yv="vec3 transformed = vec3( position );",Jo=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,el=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,ss=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Au=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,ab=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,ob=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,_v=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,bv=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,lb=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,ng=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,ub=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Wf=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Tv=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,IS=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Wp=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,rg=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,cb=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,db=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,qf="gl_FragColor = linearToOutputTexel( gl_FragColor );",hb=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,sg=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,ag=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Xf=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,xv=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Sv=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Av=`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,wv=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,Yf=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Nl=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Vh=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,Ev=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,fb=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,kc=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,Ed=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,Cv=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,pb=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Oc=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,Cd=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,og=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,mb=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lg=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,gb=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,qp=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,rc=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Xp=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Yp=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,zh=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Mv=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Qf=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,vb=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Dv=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,hs=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ug=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Iv=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Pv=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,cg=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,Lv=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,Hh=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,fs=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,sa=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,va=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,dg=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,Qp=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Kp=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,PS=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Ga=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Rv=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,kv=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Ov=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,sc=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Ul=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Zp=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Fv=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,Bv=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,yb=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,_b=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,bb=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Tb=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,xb=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Sb=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Ab=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,wb=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Jp=`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,Eb=`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,hg=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,fg=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,Cb=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,Nv=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Mb=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,Db=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,Ib=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Pb=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Uv=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Lb=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Rb=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,kb=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,LS=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Ob=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,RS=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,kS=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Fb=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Bb=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Nb=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,pg=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,OS=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,FS=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,BS=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,wu=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vv=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,mg=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ub=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Vb=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zb=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zv=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Kf=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Hv=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,jv=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,NS=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Hb=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,jb=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Gb=`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$b=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Wb=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`;const Qn={alphamap_fragment:Lc,alphamap_pars_fragment:Rc,alphatest_fragment:Uh,aomap_fragment:sb,aomap_pars_fragment:vv,begin_vertex:yv,beginnormal_vertex:Jo,bsdfs:el,bumpmap_pars_fragment:ss,clipping_planes_fragment:Au,clipping_planes_pars_fragment:ab,clipping_planes_pars_vertex:ob,clipping_planes_vertex:_v,color_fragment:bv,color_pars_fragment:lb,color_pars_vertex:ng,color_vertex:ub,common:Wf,cube_uv_reflection_fragment:Tv,defaultnormal_vertex:IS,displacementmap_pars_vertex:Wp,displacementmap_vertex:rg,emissivemap_fragment:cb,emissivemap_pars_fragment:db,encodings_fragment:qf,encodings_pars_fragment:hb,envmap_fragment:sg,envmap_common_pars_fragment:ag,envmap_pars_fragment:Xf,envmap_pars_vertex:xv,envmap_physical_pars_fragment:Cv,envmap_vertex:Sv,fog_vertex:Av,fog_pars_vertex:wv,fog_fragment:Yf,fog_pars_fragment:Nl,gradientmap_pars_fragment:Vh,lightmap_fragment:Ev,lightmap_pars_fragment:fb,lights_lambert_vertex:kc,lights_pars_begin:Ed,lights_toon_fragment:pb,lights_toon_pars_fragment:Oc,lights_phong_fragment:Cd,lights_phong_pars_fragment:og,lights_physical_fragment:mb,lights_physical_pars_fragment:lg,lights_fragment_begin:gb,lights_fragment_maps:qp,lights_fragment_end:rc,logdepthbuf_fragment:Xp,logdepthbuf_pars_fragment:Yp,logdepthbuf_pars_vertex:zh,logdepthbuf_vertex:Mv,map_fragment:Qf,map_pars_fragment:vb,map_particle_fragment:Dv,map_particle_pars_fragment:hs,metalnessmap_fragment:ug,metalnessmap_pars_fragment:Iv,morphnormal_vertex:Pv,morphtarget_pars_vertex:cg,morphtarget_vertex:Lv,normal_fragment_begin:Hh,normal_fragment_maps:fs,normalmap_pars_fragment:sa,clearcoat_normal_fragment_begin:va,clearcoat_normal_fragment_maps:dg,clearcoat_pars_fragment:Qp,packing:Kp,premultiplied_alpha_fragment:PS,project_vertex:Ga,dithering_fragment:Rv,dithering_pars_fragment:kv,roughnessmap_fragment:Ov,roughnessmap_pars_fragment:sc,shadowmap_pars_fragment:Ul,shadowmap_pars_vertex:Zp,shadowmap_vertex:Fv,shadowmask_pars_fragment:Bv,skinbase_vertex:yb,skinning_pars_vertex:_b,skinning_vertex:bb,skinnormal_vertex:Tb,specularmap_fragment:xb,specularmap_pars_fragment:Sb,tonemapping_fragment:Ab,tonemapping_pars_fragment:wb,transmissionmap_fragment:Jp,transmissionmap_pars_fragment:Eb,uv_pars_fragment:hg,uv_pars_vertex:fg,uv_vertex:Cb,uv2_pars_fragment:Nv,uv2_pars_vertex:Mb,uv2_vertex:Db,worldpos_vertex:Ib,background_frag:Pb,background_vert:Uv,cube_frag:Lb,cube_vert:Rb,depth_frag:kb,depth_vert:LS,distanceRGBA_frag:Ob,distanceRGBA_vert:RS,equirect_frag:kS,equirect_vert:Fb,linedashed_frag:Bb,linedashed_vert:Nb,meshbasic_frag:pg,meshbasic_vert:OS,meshlambert_frag:FS,meshlambert_vert:BS,meshmatcap_frag:wu,meshmatcap_vert:Vv,meshtoon_frag:mg,meshtoon_vert:Ub,meshphong_frag:Vb,meshphong_vert:zb,meshphysical_frag:zv,meshphysical_vert:Kf,normal_frag:Hv,normal_vert:jv,points_frag:NS,points_vert:Hb,shadow_frag:jb,shadow_vert:Gb,sprite_frag:$b,sprite_vert:Wb},hi={common:{diffuse:{value:new Fi(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Os},uv2Transform:{value:new Os},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new At(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Fi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Fi(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Os}},sprite:{diffuse:{value:new Fi(15658734)},opacity:{value:1},center:{value:new At(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Os}}},as={basic:{uniforms:xn([hi.common,hi.specularmap,hi.envmap,hi.aomap,hi.lightmap,hi.fog]),vertexShader:Qn.meshbasic_vert,fragmentShader:Qn.meshbasic_frag},lambert:{uniforms:xn([hi.common,hi.specularmap,hi.envmap,hi.aomap,hi.lightmap,hi.emissivemap,hi.fog,hi.lights,{emissive:{value:new Fi(0)}}]),vertexShader:Qn.meshlambert_vert,fragmentShader:Qn.meshlambert_frag},phong:{uniforms:xn([hi.common,hi.specularmap,hi.envmap,hi.aomap,hi.lightmap,hi.emissivemap,hi.bumpmap,hi.normalmap,hi.displacementmap,hi.fog,hi.lights,{emissive:{value:new Fi(0)},specular:{value:new Fi(1118481)},shininess:{value:30}}]),vertexShader:Qn.meshphong_vert,fragmentShader:Qn.meshphong_frag},standard:{uniforms:xn([hi.common,hi.envmap,hi.aomap,hi.lightmap,hi.emissivemap,hi.bumpmap,hi.normalmap,hi.displacementmap,hi.roughnessmap,hi.metalnessmap,hi.fog,hi.lights,{emissive:{value:new Fi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Qn.meshphysical_vert,fragmentShader:Qn.meshphysical_frag},toon:{uniforms:xn([hi.common,hi.aomap,hi.lightmap,hi.emissivemap,hi.bumpmap,hi.normalmap,hi.displacementmap,hi.gradientmap,hi.fog,hi.lights,{emissive:{value:new Fi(0)}}]),vertexShader:Qn.meshtoon_vert,fragmentShader:Qn.meshtoon_frag},matcap:{uniforms:xn([hi.common,hi.bumpmap,hi.normalmap,hi.displacementmap,hi.fog,{matcap:{value:null}}]),vertexShader:Qn.meshmatcap_vert,fragmentShader:Qn.meshmatcap_frag},points:{uniforms:xn([hi.points,hi.fog]),vertexShader:Qn.points_vert,fragmentShader:Qn.points_frag},dashed:{uniforms:xn([hi.common,hi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qn.linedashed_vert,fragmentShader:Qn.linedashed_frag},depth:{uniforms:xn([hi.common,hi.displacementmap]),vertexShader:Qn.depth_vert,fragmentShader:Qn.depth_frag},normal:{uniforms:xn([hi.common,hi.bumpmap,hi.normalmap,hi.displacementmap,{opacity:{value:1}}]),vertexShader:Qn.normal_vert,fragmentShader:Qn.normal_frag},sprite:{uniforms:xn([hi.sprite,hi.fog]),vertexShader:Qn.sprite_vert,fragmentShader:Qn.sprite_frag},background:{uniforms:{uvTransform:{value:new Os},t2D:{value:null}},vertexShader:Qn.background_vert,fragmentShader:Qn.background_frag},cube:{uniforms:xn([hi.envmap,{opacity:{value:1}}]),vertexShader:Qn.cube_vert,fragmentShader:Qn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Qn.equirect_vert,fragmentShader:Qn.equirect_frag},distanceRGBA:{uniforms:xn([hi.common,hi.displacementmap,{referencePosition:{value:new Be},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Qn.distanceRGBA_vert,fragmentShader:Qn.distanceRGBA_frag},shadow:{uniforms:xn([hi.lights,hi.fog,{color:{value:new Fi(0)},opacity:{value:1}}]),vertexShader:Qn.shadow_vert,fragmentShader:Qn.shadow_frag}};as.physical={uniforms:xn([as.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new At(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Fi(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Qn.meshphysical_vert,fragmentShader:Qn.meshphysical_frag};function qb(l,o,u,f,g){const y=new Fi(0);let T=0,w,M,I=null,z=0,U=null;function G(J,me,pe,te){let K=me.isScene===!0?me.background:null;K&&K.isTexture&&(K=o.get(K));const He=l.xr,$e=He.getSession&&He.getSession();$e&&$e.environmentBlendMode==="additive"&&(K=null),K===null?W(y,T):K&&K.isColor&&(W(K,1),te=!0),(l.autoClear||te)&&l.clear(l.autoClearColor,l.autoClearDepth,l.autoClearStencil),K&&(K.isCubeTexture||K.isWebGLCubeRenderTarget||K.mapping===Zi)?(M===void 0&&(M=new Gt(new Xi(1,1,1),new rs({name:"BackgroundCubeMaterial",uniforms:Er(as.cube.uniforms),vertexShader:as.cube.vertexShader,fragmentShader:as.cube.fragmentShader,side:De,depthTest:!1,depthWrite:!1,fog:!1})),M.geometry.deleteAttribute("normal"),M.geometry.deleteAttribute("uv"),M.onBeforeRender=function(Ue,Ae,at){this.matrixWorld.copyPosition(at.matrixWorld)},Object.defineProperty(M.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),f.update(M)),K.isWebGLCubeRenderTarget&&(K=K.texture),M.material.uniforms.envMap.value=K,M.material.uniforms.flipEnvMap.value=K.isCubeTexture&&K._needsFlipEnvMap?-1:1,(I!==K||z!==K.version||U!==l.toneMapping)&&(M.material.needsUpdate=!0,I=K,z=K.version,U=l.toneMapping),J.unshift(M,M.geometry,M.material,0,0,null)):K&&K.isTexture&&(w===void 0&&(w=new Gt(new Nh(2,2),new rs({name:"BackgroundMaterial",uniforms:Er(as.background.uniforms),vertexShader:as.background.vertexShader,fragmentShader:as.background.fragmentShader,side:Ne,depthTest:!1,depthWrite:!1,fog:!1})),w.geometry.deleteAttribute("normal"),Object.defineProperty(w.material,"map",{get:function(){return this.uniforms.t2D.value}}),f.update(w)),w.material.uniforms.t2D.value=K,K.matrixAutoUpdate===!0&&K.updateMatrix(),w.material.uniforms.uvTransform.value.copy(K.matrix),(I!==K||z!==K.version||U!==l.toneMapping)&&(w.material.needsUpdate=!0,I=K,z=K.version,U=l.toneMapping),J.unshift(w,w.geometry,w.material,0,0,null))}function W(J,me){u.buffers.color.setClear(J.r,J.g,J.b,me,g)}return{getClearColor:function(){return y},setClearColor:function(J,me=1){y.set(J),T=me,W(y,T)},getClearAlpha:function(){return T},setClearAlpha:function(J){T=J,W(y,T)},render:G}}function Xb(l,o,u,f){const g=l.getParameter(34921),y=f.isWebGL2?null:o.get("OES_vertex_array_object"),T=f.isWebGL2||y!==null,w={},M=me(null);let I=M;function z(nt,Ke,st,Ct,Xt){let ti=!1;if(T){const ni=J(Ct,st,Ke);I!==ni&&(I=ni,G(I.object)),ti=pe(Ct,Xt),ti&&te(Ct,Xt)}else{const ni=Ke.wireframe===!0;(I.geometry!==Ct.id||I.program!==st.id||I.wireframe!==ni)&&(I.geometry=Ct.id,I.program=st.id,I.wireframe=ni,ti=!0)}nt.isInstancedMesh===!0&&(ti=!0),Xt!==null&&u.update(Xt,34963),ti&&(at(nt,Ke,st,Ct),Xt!==null&&l.bindBuffer(34963,u.get(Xt).buffer))}function U(){return f.isWebGL2?l.createVertexArray():y.createVertexArrayOES()}function G(nt){return f.isWebGL2?l.bindVertexArray(nt):y.bindVertexArrayOES(nt)}function W(nt){return f.isWebGL2?l.deleteVertexArray(nt):y.deleteVertexArrayOES(nt)}function J(nt,Ke,st){const Ct=st.wireframe===!0;let Xt=w[nt.id];Xt===void 0&&(Xt={},w[nt.id]=Xt);let ti=Xt[Ke.id];ti===void 0&&(ti={},Xt[Ke.id]=ti);let ni=ti[Ct];return ni===void 0&&(ni=me(U()),ti[Ct]=ni),ni}function me(nt){const Ke=[],st=[],Ct=[];for(let Xt=0;Xt<g;Xt++)Ke[Xt]=0,st[Xt]=0,Ct[Xt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ke,enabledAttributes:st,attributeDivisors:Ct,object:nt,attributes:{},index:null}}function pe(nt,Ke){const st=I.attributes,Ct=nt.attributes;let Xt=0;for(const ti in Ct){const ni=st[ti],Ai=Ct[ti];if(ni===void 0||ni.attribute!==Ai||ni.data!==Ai.data)return!0;Xt++}return I.attributesNum!==Xt||I.index!==Ke}function te(nt,Ke){const st={},Ct=nt.attributes;let Xt=0;for(const ti in Ct){const ni=Ct[ti],Ai={};Ai.attribute=ni,ni.data&&(Ai.data=ni.data),st[ti]=Ai,Xt++}I.attributes=st,I.attributesNum=Xt,I.index=Ke}function K(){const nt=I.newAttributes;for(let Ke=0,st=nt.length;Ke<st;Ke++)nt[Ke]=0}function He(nt){$e(nt,0)}function $e(nt,Ke){const st=I.newAttributes,Ct=I.enabledAttributes,Xt=I.attributeDivisors;st[nt]=1,Ct[nt]===0&&(l.enableVertexAttribArray(nt),Ct[nt]=1),Xt[nt]!==Ke&&((f.isWebGL2?l:o.get("ANGLE_instanced_arrays"))[f.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](nt,Ke),Xt[nt]=Ke)}function Ue(){const nt=I.newAttributes,Ke=I.enabledAttributes;for(let st=0,Ct=Ke.length;st<Ct;st++)Ke[st]!==nt[st]&&(l.disableVertexAttribArray(st),Ke[st]=0)}function Ae(nt,Ke,st,Ct,Xt,ti){f.isWebGL2===!0&&(st===5124||st===5125)?l.vertexAttribIPointer(nt,Ke,st,Xt,ti):l.vertexAttribPointer(nt,Ke,st,Ct,Xt,ti)}function at(nt,Ke,st,Ct){if(f.isWebGL2===!1&&(nt.isInstancedMesh||Ct.isInstancedBufferGeometry)&&o.get("ANGLE_instanced_arrays")===null)return;K();const Xt=Ct.attributes,ti=st.getAttributes(),ni=Ke.defaultAttributeValues;for(const Ai in ti){const _i=ti[Ai];if(_i>=0){const on=Xt[Ai];if(on!==void 0){const vn=on.normalized,Pn=on.itemSize,Kt=u.get(on);if(Kt===void 0)continue;const ua=Kt.buffer,mn=Kt.type,Wn=Kt.bytesPerElement;if(on.isInterleavedBufferAttribute){const yn=on.data,pr=yn.stride,Sn=on.offset;yn&&yn.isInstancedInterleavedBuffer?($e(_i,yn.meshPerAttribute),Ct._maxInstanceCount===void 0&&(Ct._maxInstanceCount=yn.meshPerAttribute*yn.count)):He(_i),l.bindBuffer(34962,ua),Ae(_i,Pn,mn,vn,pr*Wn,Sn*Wn)}else on.isInstancedBufferAttribute?($e(_i,on.meshPerAttribute),Ct._maxInstanceCount===void 0&&(Ct._maxInstanceCount=on.meshPerAttribute*on.count)):He(_i),l.bindBuffer(34962,ua),Ae(_i,Pn,mn,vn,0,0)}else if(Ai==="instanceMatrix"){const vn=u.get(nt.instanceMatrix);if(vn===void 0)continue;const Pn=vn.buffer,Kt=vn.type;$e(_i+0,1),$e(_i+1,1),$e(_i+2,1),$e(_i+3,1),l.bindBuffer(34962,Pn),l.vertexAttribPointer(_i+0,4,Kt,!1,64,0),l.vertexAttribPointer(_i+1,4,Kt,!1,64,16),l.vertexAttribPointer(_i+2,4,Kt,!1,64,32),l.vertexAttribPointer(_i+3,4,Kt,!1,64,48)}else if(Ai==="instanceColor"){const vn=u.get(nt.instanceColor);if(vn===void 0)continue;const Pn=vn.buffer,Kt=vn.type;$e(_i,1),l.bindBuffer(34962,Pn),l.vertexAttribPointer(_i,3,Kt,!1,12,0)}else if(ni!==void 0){const vn=ni[Ai];if(vn!==void 0)switch(vn.length){case 2:l.vertexAttrib2fv(_i,vn);break;case 3:l.vertexAttrib3fv(_i,vn);break;case 4:l.vertexAttrib4fv(_i,vn);break;default:l.vertexAttrib1fv(_i,vn)}}}}Ue()}function Ht(){Pt();for(const nt in w){const Ke=w[nt];for(const st in Ke){const Ct=Ke[st];for(const Xt in Ct)W(Ct[Xt].object),delete Ct[Xt];delete Ke[st]}delete w[nt]}}function wt(nt){if(w[nt.id]===void 0)return;const Ke=w[nt.id];for(const st in Ke){const Ct=Ke[st];for(const Xt in Ct)W(Ct[Xt].object),delete Ct[Xt];delete Ke[st]}delete w[nt.id]}function It(nt){for(const Ke in w){const st=w[Ke];if(st[nt.id]===void 0)continue;const Ct=st[nt.id];for(const Xt in Ct)W(Ct[Xt].object),delete Ct[Xt];delete st[nt.id]}}function Pt(){Nt(),I!==M&&(I=M,G(I.object))}function Nt(){M.geometry=null,M.program=null,M.wireframe=!1}return{setup:z,reset:Pt,resetDefaultState:Nt,dispose:Ht,releaseStatesOfGeometry:wt,releaseStatesOfProgram:It,initAttributes:K,enableAttribute:He,disableUnusedAttributes:Ue}}function Yb(l,o,u,f){const g=f.isWebGL2;let y;function T(I){y=I}function w(I,z){l.drawArrays(y,I,z),u.update(z,y,1)}function M(I,z,U){if(U===0)return;let G,W;if(g)G=l,W="drawArraysInstanced";else if(G=o.get("ANGLE_instanced_arrays"),W="drawArraysInstancedANGLE",G===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}G[W](y,I,z,U),u.update(z,y,U)}this.setMode=T,this.render=w,this.renderInstances=M}function Qb(l,o,u){let f;function g(){if(f!==void 0)return f;const Ae=o.get("EXT_texture_filter_anisotropic");return Ae!==null?f=l.getParameter(Ae.MAX_TEXTURE_MAX_ANISOTROPY_EXT):f=0,f}function y(Ae){if(Ae==="highp"){if(l.getShaderPrecisionFormat(35633,36338).precision>0&&l.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";Ae="mediump"}return Ae==="mediump"&&l.getShaderPrecisionFormat(35633,36337).precision>0&&l.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const T=typeof WebGL2RenderingContext<"u"&&l instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&l instanceof WebGL2ComputeRenderingContext;let w=u.precision!==void 0?u.precision:"highp";const M=y(w);M!==w&&(console.warn("THREE.WebGLRenderer:",w,"not supported, using",M,"instead."),w=M);const I=u.logarithmicDepthBuffer===!0,z=l.getParameter(34930),U=l.getParameter(35660),G=l.getParameter(3379),W=l.getParameter(34076),J=l.getParameter(34921),me=l.getParameter(36347),pe=l.getParameter(36348),te=l.getParameter(36349),K=U>0,He=T||!!o.get("OES_texture_float"),$e=K&&He,Ue=T?l.getParameter(36183):0;return{isWebGL2:T,getMaxAnisotropy:g,getMaxPrecision:y,precision:w,logarithmicDepthBuffer:I,maxTextures:z,maxVertexTextures:U,maxTextureSize:G,maxCubemapSize:W,maxAttributes:J,maxVertexUniforms:me,maxVaryings:pe,maxFragmentUniforms:te,vertexTextures:K,floatFragmentTextures:He,floatVertexTextures:$e,maxSamples:Ue}}function Kb(l){const o=this;let u=null,f=0,g=!1,y=!1;const T=new Da,w=new Os,M={value:null,needsUpdate:!1};this.uniform=M,this.numPlanes=0,this.numIntersection=0,this.init=function(U,G,W){const J=U.length!==0||G||f!==0||g;return g=G,u=z(U,W,0),f=U.length,J},this.beginShadows=function(){y=!0,z(null)},this.endShadows=function(){y=!1,I()},this.setState=function(U,G,W){const J=U.clippingPlanes,me=U.clipIntersection,pe=U.clipShadows,te=l.get(U);if(!g||J===null||J.length===0||y&&!pe)y?z(null):I();else{const K=y?0:f,He=K*4;let $e=te.clippingState||null;M.value=$e,$e=z(J,G,He,W);for(let Ue=0;Ue!==He;++Ue)$e[Ue]=u[Ue];te.clippingState=$e,this.numIntersection=me?this.numPlanes:0,this.numPlanes+=K}};function I(){M.value!==u&&(M.value=u,M.needsUpdate=f>0),o.numPlanes=f,o.numIntersection=0}function z(U,G,W,J){const me=U!==null?U.length:0;let pe=null;if(me!==0){if(pe=M.value,J!==!0||pe===null){const te=W+me*4,K=G.matrixWorldInverse;w.getNormalMatrix(K),(pe===null||pe.length<te)&&(pe=new Float32Array(te));for(let He=0,$e=W;He!==me;++He,$e+=4)T.copy(U[He]).applyMatrix4(K,w),T.normal.toArray(pe,$e),pe[$e+3]=T.constant}M.value=pe,M.needsUpdate=!0}return o.numPlanes=me,o.numIntersection=0,pe}}function Gv(l){let o=new WeakMap;function u(T,w){return w===Fn?T.mapping=di:w===Ar&&(T.mapping=Oi),T}function f(T){if(T&&T.isTexture){const w=T.mapping;if(w===Fn||w===Ar)if(o.has(T)){const M=o.get(T).texture;return u(M,T.mapping)}else{const M=T.image;if(M&&M.height>0){const I=l.getRenderList(),z=l.getRenderTarget(),U=new wd(M.height/2);return U.fromEquirectangularTexture(l,T),o.set(T,U),l.setRenderTarget(z),l.setRenderList(I),T.addEventListener("dispose",g),u(U.texture,T.mapping)}else return null}}return T}function g(T){const w=T.target;w.removeEventListener("dispose",g);const M=o.get(w);M!==void 0&&(o.delete(w),M.dispose())}function y(){o=new WeakMap}return{get:f,dispose:y}}function Zb(l){const o={};function u(f){if(o[f]!==void 0)return o[f];let g;switch(f){case"WEBGL_depth_texture":g=l.getExtension("WEBGL_depth_texture")||l.getExtension("MOZ_WEBGL_depth_texture")||l.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":g=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":g=l.getExtension("WEBGL_compressed_texture_s3tc")||l.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":g=l.getExtension("WEBGL_compressed_texture_pvrtc")||l.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:g=l.getExtension(f)}return o[f]=g,g}return{has:function(f){return u(f)!==null},init:function(f){f.isWebGL2?u("EXT_color_buffer_float"):(u("WEBGL_depth_texture"),u("OES_texture_float"),u("OES_texture_half_float"),u("OES_texture_half_float_linear"),u("OES_standard_derivatives"),u("OES_element_index_uint"),u("OES_vertex_array_object"),u("ANGLE_instanced_arrays")),u("OES_texture_float_linear"),u("EXT_color_buffer_half_float")},get:function(f){const g=u(f);return g===null&&console.warn("THREE.WebGLRenderer: "+f+" extension not supported."),g}}}function $v(l,o,u,f){const g={},y=new WeakMap;function T(U){const G=U.target;G.index!==null&&o.remove(G.index);for(const J in G.attributes)o.remove(G.attributes[J]);G.removeEventListener("dispose",T),delete g[G.id];const W=y.get(G);W&&(o.remove(W),y.delete(G)),f.releaseStatesOfGeometry(G),G.isInstancedBufferGeometry===!0&&delete G._maxInstanceCount,u.memory.geometries--}function w(U,G){return g[G.id]===!0||(G.addEventListener("dispose",T),g[G.id]=!0,u.memory.geometries++),G}function M(U){const G=U.attributes;for(const J in G)o.update(G[J],34962);const W=U.morphAttributes;for(const J in W){const me=W[J];for(let pe=0,te=me.length;pe<te;pe++)o.update(me[pe],34962)}}function I(U){const G=[],W=U.index,J=U.attributes.position;let me=0;if(W!==null){const K=W.array;me=W.version;for(let He=0,$e=K.length;He<$e;He+=3){const Ue=K[He+0],Ae=K[He+1],at=K[He+2];G.push(Ue,Ae,Ae,at,at,Ue)}}else{const K=J.array;me=J.version;for(let He=0,$e=K.length/3-1;He<$e;He+=3){const Ue=He+0,Ae=He+1,at=He+2;G.push(Ue,Ae,Ae,at,at,Ue)}}const pe=new(Td(G)>65535?kh:Fl)(G,1);pe.version=me;const te=y.get(U);te&&o.remove(te),y.set(U,pe)}function z(U){const G=y.get(U);if(G){const W=U.index;W!==null&&G.version<W.version&&I(U)}else I(U);return y.get(U)}return{get:w,update:M,getWireframeAttribute:z}}function Jb(l,o,u,f){const g=f.isWebGL2;let y;function T(G){y=G}let w,M;function I(G){w=G.type,M=G.bytesPerElement}function z(G,W){l.drawElements(y,W,w,G*M),u.update(W,y,1)}function U(G,W,J){if(J===0)return;let me,pe;if(g)me=l,pe="drawElementsInstanced";else if(me=o.get("ANGLE_instanced_arrays"),pe="drawElementsInstancedANGLE",me===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}me[pe](y,W,w,G*M,J),u.update(W,y,J)}this.setMode=T,this.setIndex=I,this.render=z,this.renderInstances=U}function e1(l){const o={geometries:0,textures:0},u={frame:0,calls:0,triangles:0,points:0,lines:0};function f(y,T,w){switch(u.calls++,T){case 4:u.triangles+=w*(y/3);break;case 1:u.lines+=w*(y/2);break;case 3:u.lines+=w*(y-1);break;case 2:u.lines+=w*y;break;case 0:u.points+=w*y;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",T);break}}function g(){u.frame++,u.calls=0,u.triangles=0,u.points=0,u.lines=0}return{memory:o,render:u,programs:null,autoReset:!0,reset:g,update:f}}function Wv(l,o){return l[0]-o[0]}function qv(l,o){return Math.abs(o[1])-Math.abs(l[1])}function t1(l){const o={},u=new Float32Array(8),f=[];for(let y=0;y<8;y++)f[y]=[y,0];function g(y,T,w,M){const I=y.morphTargetInfluences,z=I===void 0?0:I.length;let U=o[T.id];if(U===void 0){U=[];for(let pe=0;pe<z;pe++)U[pe]=[pe,0];o[T.id]=U}for(let pe=0;pe<z;pe++){const te=U[pe];te[0]=pe,te[1]=I[pe]}U.sort(qv);for(let pe=0;pe<8;pe++)pe<z&&U[pe][1]?(f[pe][0]=U[pe][0],f[pe][1]=U[pe][1]):(f[pe][0]=Number.MAX_SAFE_INTEGER,f[pe][1]=0);f.sort(Wv);const G=w.morphTargets&&T.morphAttributes.position,W=w.morphNormals&&T.morphAttributes.normal;let J=0;for(let pe=0;pe<8;pe++){const te=f[pe],K=te[0],He=te[1];K!==Number.MAX_SAFE_INTEGER&&He?(G&&T.getAttribute("morphTarget"+pe)!==G[K]&&T.setAttribute("morphTarget"+pe,G[K]),W&&T.getAttribute("morphNormal"+pe)!==W[K]&&T.setAttribute("morphNormal"+pe,W[K]),u[pe]=He,J+=He):(G&&T.hasAttribute("morphTarget"+pe)===!0&&T.deleteAttribute("morphTarget"+pe),W&&T.hasAttribute("morphNormal"+pe)===!0&&T.deleteAttribute("morphNormal"+pe),u[pe]=0)}const me=T.morphTargetsRelative?1:1-J;M.getUniforms().setValue(l,"morphTargetBaseInfluence",me),M.getUniforms().setValue(l,"morphTargetInfluences",u)}return{update:g}}function Xv(l,o,u,f){let g=new WeakMap;function y(M){const I=f.render.frame,z=M.geometry,U=o.get(M,z);return g.get(U)!==I&&(o.update(U),g.set(U,I)),M.isInstancedMesh&&(M.hasEventListener("dispose",w)===!1&&M.addEventListener("dispose",w),u.update(M.instanceMatrix,34962),M.instanceColor!==null&&u.update(M.instanceColor,34962)),U}function T(){g=new WeakMap}function w(M){const I=M.target;I.removeEventListener("dispose",w),u.remove(I.instanceMatrix),I.instanceColor!==null&&u.remove(I.instanceColor)}return{update:y,dispose:T}}function Md(l=null,o=1,u=1,f=1){dr.call(this,null),this.image={data:l,width:o,height:u,depth:f},this.magFilter=Ye,this.minFilter=Ye,this.wrapR=oe,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Md.prototype=Object.create(dr.prototype),Md.prototype.constructor=Md,Md.prototype.isDataTexture2DArray=!0;function em(l=null,o=1,u=1,f=1){dr.call(this,null),this.image={data:l,width:o,height:u,depth:f},this.magFilter=Ye,this.minFilter=Ye,this.wrapR=oe,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}em.prototype=Object.create(dr.prototype),em.prototype.constructor=em,em.prototype.isDataTexture3D=!0;const Yv=new dr,Qv=new Md,i1=new em,tm=new Ad,ac=[],n1=[],Kv=new Float32Array(16),gg=new Float32Array(9),Zv=new Float32Array(4);function jh(l,o,u){const f=l[0];if(f<=0||f>0)return l;const g=o*u;let y=ac[g];if(y===void 0&&(y=new Float32Array(g),ac[g]=y),o!==0){f.toArray(y,0);for(let T=1,w=0;T!==o;++T)w+=u,l[T].toArray(y,w)}return y}function $a(l,o){if(l.length!==o.length)return!1;for(let u=0,f=l.length;u<f;u++)if(l[u]!==o[u])return!1;return!0}function kr(l,o){for(let u=0,f=o.length;u<f;u++)l[u]=o[u]}function r1(l,o){let u=n1[o];u===void 0&&(u=new Int32Array(o),n1[o]=u);for(let f=0;f!==o;++f)u[f]=l.allocateTextureUnit();return u}function US(l,o){const u=this.cache;u[0]!==o&&(l.uniform1f(this.addr,o),u[0]=o)}function vg(l,o){const u=this.cache;if(o.x!==void 0)(u[0]!==o.x||u[1]!==o.y)&&(l.uniform2f(this.addr,o.x,o.y),u[0]=o.x,u[1]=o.y);else{if($a(u,o))return;l.uniform2fv(this.addr,o),kr(u,o)}}function Wa(l,o){const u=this.cache;if(o.x!==void 0)(u[0]!==o.x||u[1]!==o.y||u[2]!==o.z)&&(l.uniform3f(this.addr,o.x,o.y,o.z),u[0]=o.x,u[1]=o.y,u[2]=o.z);else if(o.r!==void 0)(u[0]!==o.r||u[1]!==o.g||u[2]!==o.b)&&(l.uniform3f(this.addr,o.r,o.g,o.b),u[0]=o.r,u[1]=o.g,u[2]=o.b);else{if($a(u,o))return;l.uniform3fv(this.addr,o),kr(u,o)}}function VS(l,o){const u=this.cache;if(o.x!==void 0)(u[0]!==o.x||u[1]!==o.y||u[2]!==o.z||u[3]!==o.w)&&(l.uniform4f(this.addr,o.x,o.y,o.z,o.w),u[0]=o.x,u[1]=o.y,u[2]=o.z,u[3]=o.w);else{if($a(u,o))return;l.uniform4fv(this.addr,o),kr(u,o)}}function Ri(l,o){const u=this.cache,f=o.elements;if(f===void 0){if($a(u,o))return;l.uniformMatrix2fv(this.addr,!1,o),kr(u,o)}else{if($a(u,f))return;Zv.set(f),l.uniformMatrix2fv(this.addr,!1,Zv),kr(u,f)}}function Zf(l,o){const u=this.cache,f=o.elements;if(f===void 0){if($a(u,o))return;l.uniformMatrix3fv(this.addr,!1,o),kr(u,o)}else{if($a(u,f))return;gg.set(f),l.uniformMatrix3fv(this.addr,!1,gg),kr(u,f)}}function Jv(l,o){const u=this.cache,f=o.elements;if(f===void 0){if($a(u,o))return;l.uniformMatrix4fv(this.addr,!1,o),kr(u,o)}else{if($a(u,f))return;Kv.set(f),l.uniformMatrix4fv(this.addr,!1,Kv),kr(u,f)}}function s1(l,o,u){const f=this.cache,g=u.allocateTextureUnit();f[0]!==g&&(l.uniform1i(this.addr,g),f[0]=g),u.safeSetTexture2D(o||Yv,g)}function zS(l,o,u){const f=this.cache,g=u.allocateTextureUnit();f[0]!==g&&(l.uniform1i(this.addr,g),f[0]=g),u.setTexture2DArray(o||Qv,g)}function im(l,o,u){const f=this.cache,g=u.allocateTextureUnit();f[0]!==g&&(l.uniform1i(this.addr,g),f[0]=g),u.setTexture3D(o||i1,g)}function yg(l,o,u){const f=this.cache,g=u.allocateTextureUnit();f[0]!==g&&(l.uniform1i(this.addr,g),f[0]=g),u.safeSetTextureCube(o||tm,g)}function ey(l,o){const u=this.cache;u[0]!==o&&(l.uniform1i(this.addr,o),u[0]=o)}function a1(l,o){const u=this.cache;$a(u,o)||(l.uniform2iv(this.addr,o),kr(u,o))}function o1(l,o){const u=this.cache;$a(u,o)||(l.uniform3iv(this.addr,o),kr(u,o))}function l1(l,o){const u=this.cache;$a(u,o)||(l.uniform4iv(this.addr,o),kr(u,o))}function ty(l,o){const u=this.cache;u[0]!==o&&(l.uniform1ui(this.addr,o),u[0]=o)}function iy(l){switch(l){case 5126:return US;case 35664:return vg;case 35665:return Wa;case 35666:return VS;case 35674:return Ri;case 35675:return Zf;case 35676:return Jv;case 5124:case 35670:return ey;case 35667:case 35671:return a1;case 35668:case 35672:return o1;case 35669:case 35673:return l1;case 5125:return ty;case 35678:case 36198:case 36298:case 36306:case 35682:return s1;case 35679:case 36299:case 36307:return im;case 35680:case 36300:case 36308:case 36293:return yg;case 36289:case 36303:case 36311:case 36292:return zS}}function Pa(l,o){l.uniform1fv(this.addr,o)}function Eu(l,o){l.uniform1iv(this.addr,o)}function Dd(l,o){l.uniform2iv(this.addr,o)}function u1(l,o){l.uniform3iv(this.addr,o)}function c1(l,o){l.uniform4iv(this.addr,o)}function Cu(l,o){const u=jh(o,this.size,2);l.uniform2fv(this.addr,u)}function d1(l,o){const u=jh(o,this.size,3);l.uniform3fv(this.addr,u)}function oc(l,o){const u=jh(o,this.size,4);l.uniform4fv(this.addr,u)}function HS(l,o){const u=jh(o,this.size,4);l.uniformMatrix2fv(this.addr,!1,u)}function h1(l,o){const u=jh(o,this.size,9);l.uniformMatrix3fv(this.addr,!1,u)}function f1(l,o){const u=jh(o,this.size,16);l.uniformMatrix4fv(this.addr,!1,u)}function p1(l,o,u){const f=o.length,g=r1(u,f);l.uniform1iv(this.addr,g);for(let y=0;y!==f;++y)u.safeSetTexture2D(o[y]||Yv,g[y])}function m1(l,o,u){const f=o.length,g=r1(u,f);l.uniform1iv(this.addr,g);for(let y=0;y!==f;++y)u.safeSetTextureCube(o[y]||tm,g[y])}function jS(l){switch(l){case 5126:return Pa;case 35664:return Cu;case 35665:return d1;case 35666:return oc;case 35674:return HS;case 35675:return h1;case 35676:return f1;case 5124:case 35670:return Eu;case 35667:case 35671:return Dd;case 35668:case 35672:return u1;case 35669:case 35673:return c1;case 35678:case 36198:case 36298:case 36306:case 35682:return p1;case 35680:case 36300:case 36308:case 36293:return m1}}function _g(l,o,u){this.id=l,this.addr=u,this.cache=[],this.setValue=iy(o.type)}function bg(l,o,u){this.id=l,this.addr=u,this.cache=[],this.size=o.size,this.setValue=jS(o.type)}bg.prototype.updateCache=function(l){const o=this.cache;l instanceof Float32Array&&o.length!==l.length&&(this.cache=new Float32Array(l.length)),kr(o,l)};function tl(l){this.id=l,this.seq=[],this.map={}}tl.prototype.setValue=function(l,o,u){const f=this.seq;for(let g=0,y=f.length;g!==y;++g){const T=f[g];T.setValue(l,o[T.id],u)}};const or=/(\w+)(\])?(\[|\.)?/g;function aa(l,o){l.seq.push(o),l.map[o.id]=o}function Xs(l,o,u){const f=l.name,g=f.length;for(or.lastIndex=0;;){const y=or.exec(f),T=or.lastIndex;let w=y[1];const M=y[2]==="]",I=y[3];if(M&&(w=w|0),I===void 0||I==="["&&T+2===g){aa(u,I===void 0?new _g(w,l,o):new bg(w,l,o));break}else{let U=u.map[w];U===void 0&&(U=new tl(w),aa(u,U)),u=U}}}function os(l,o){this.seq=[],this.map={};const u=l.getProgramParameter(o,35718);for(let f=0;f<u;++f){const g=l.getActiveUniform(o,f),y=l.getUniformLocation(o,g.name);Xs(g,y,this)}}os.prototype.setValue=function(l,o,u,f){const g=this.map[o];g!==void 0&&g.setValue(l,u,f)},os.prototype.setOptional=function(l,o,u){const f=o[u];f!==void 0&&this.setValue(l,u,f)},os.upload=function(l,o,u,f){for(let g=0,y=o.length;g!==y;++g){const T=o[g],w=u[T.id];w.needsUpdate!==!1&&T.setValue(l,w.value,f)}},os.seqWithValue=function(l,o){const u=[];for(let f=0,g=l.length;f!==g;++f){const y=l[f];y.id in o&&u.push(y)}return u};function Co(l,o,u){const f=l.createShader(o);return l.shaderSource(f,u),l.compileShader(f),f}let Jf=0;function oa(l){const o=l.split(`
`);for(let u=0;u<o.length;u++)o[u]=u+1+": "+o[u];return o.join(`
`)}function ep(l){switch(l){case Ml:return["Linear","( value )"];case cd:return["sRGB","( value )"];case Dl:return["RGBE","( value )"];case hu:return["RGBM","( value, 7.0 )"];case Uf:return["RGBM","( value, 16.0 )"];case _r:return["RGBD","( value, 256.0 )"];case du:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case po:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",l),["Linear","( value )"]}}function Id(l,o,u){const f=l.getShaderParameter(o,35713),g=l.getShaderInfoLog(o).trim();if(f&&g==="")return"";const y=l.getShaderSource(o);return"THREE.WebGLShader: gl.getShaderInfoLog() "+u+`
`+g+oa(y)}function Pd(l,o){const u=ep(o);return"vec4 "+l+"( vec4 value ) { return "+u[0]+"ToLinear"+u[1]+"; }"}function ny(l,o){const u=ep(o);return"vec4 "+l+"( vec4 value ) { return LinearTo"+u[0]+u[1]+"; }"}function nm(l,o){let u;switch(o){case Vo:u="Linear";break;case Aa:u="Reinhard";break;case an:u="OptimizedCineon";break;case Ze:u="ACESFilmic";break;case St:u="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",o),u="Linear"}return"vec3 "+l+"( vec3 color ) { return "+u+"ToneMapping( color ); }"}function Mo(l){return[l.extensionDerivatives||l.envMapCubeUV||l.bumpMap||l.tangentSpaceNormalMap||l.clearcoatNormalMap||l.flatShading||l.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(l.extensionFragDepth||l.logarithmicDepthBuffer)&&l.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",l.extensionDrawBuffers&&l.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(l.extensionShaderTextureLOD||l.envMap)&&l.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(il).join(`
`)}function ry(l){const o=[];for(const u in l){const f=l[u];f!==!1&&o.push("#define "+u+" "+f)}return o.join(`
`)}function tp(l,o){const u={},f=l.getProgramParameter(o,35721);for(let g=0;g<f;g++){const T=l.getActiveAttrib(o,g).name;u[T]=l.getAttribLocation(o,T)}return u}function il(l){return l!==""}function rm(l,o){return l.replace(/NUM_DIR_LIGHTS/g,o.numDirLights).replace(/NUM_SPOT_LIGHTS/g,o.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,o.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,o.numPointLights).replace(/NUM_HEMI_LIGHTS/g,o.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,o.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,o.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,o.numPointLightShadows)}function Tg(l,o){return l.replace(/NUM_CLIPPING_PLANES/g,o.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,o.numClippingPlanes-o.numClipIntersection)}const Ld=/^[ \t]*#include +<([\w\d./]+)>/gm;function ip(l){return l.replace(Ld,Rd)}function Rd(l,o){const u=Qn[o];if(u===void 0)throw new Error("Can not resolve #include <"+o+">");return ip(u)}const xg=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,sm=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Sg(l){return l.replace(sm,am).replace(xg,Ag)}function Ag(l,o,u,f){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),am(l,o,u,f)}function am(l,o,u,f){let g="";for(let y=parseInt(o);y<parseInt(u);y++)g+=f.replace(/\[\s*i\s*\]/g,"[ "+y+" ]").replace(/UNROLLED_LOOP_INDEX/g,y);return g}function qa(l){let o="precision "+l.precision+` float;
precision `+l.precision+" int;";return l.precision==="highp"?o+=`
#define HIGH_PRECISION`:l.precision==="mediump"?o+=`
#define MEDIUM_PRECISION`:l.precision==="lowp"&&(o+=`
#define LOW_PRECISION`),o}function kd(l){let o="SHADOWMAP_TYPE_BASIC";return l.shadowMapType===ve?o="SHADOWMAP_TYPE_PCF":l.shadowMapType===ie?o="SHADOWMAP_TYPE_PCF_SOFT":l.shadowMapType===re&&(o="SHADOWMAP_TYPE_VSM"),o}function Mu(l){let o="ENVMAP_TYPE_CUBE";if(l.envMap)switch(l.envMapMode){case di:case Oi:o="ENVMAP_TYPE_CUBE";break;case Zi:case pi:o="ENVMAP_TYPE_CUBE_UV";break}return o}function Do(l){let o="ENVMAP_MODE_REFLECTION";if(l.envMap)switch(l.envMapMode){case Oi:case pi:o="ENVMAP_MODE_REFRACTION";break}return o}function g1(l){let o="ENVMAP_BLENDING_NONE";if(l.envMap)switch(l.combine){case Js:o="ENVMAP_BLENDING_MULTIPLY";break;case Sa:o="ENVMAP_BLENDING_MIX";break;case ds:o="ENVMAP_BLENDING_ADD";break}return o}function sy(l,o,u,f){const g=l.getContext(),y=u.defines;let T=u.vertexShader,w=u.fragmentShader;const M=kd(u),I=Mu(u),z=Do(u),U=g1(u),G=l.gammaFactor>0?l.gammaFactor:1,W=u.isWebGL2?"":Mo(u),J=ry(y),me=g.createProgram();let pe,te,K=u.glslVersion?"#version "+u.glslVersion+`
`:"";u.isRawShaderMaterial?(pe=[J].filter(il).join(`
`),pe.length>0&&(pe+=`
`),te=[W,J].filter(il).join(`
`),te.length>0&&(te+=`
`)):(pe=[qa(u),"#define SHADER_NAME "+u.shaderName,J,u.instancing?"#define USE_INSTANCING":"",u.instancingColor?"#define USE_INSTANCING_COLOR":"",u.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+G,"#define MAX_BONES "+u.maxBones,u.useFog&&u.fog?"#define USE_FOG":"",u.useFog&&u.fogExp2?"#define FOG_EXP2":"",u.map?"#define USE_MAP":"",u.envMap?"#define USE_ENVMAP":"",u.envMap?"#define "+z:"",u.lightMap?"#define USE_LIGHTMAP":"",u.aoMap?"#define USE_AOMAP":"",u.emissiveMap?"#define USE_EMISSIVEMAP":"",u.bumpMap?"#define USE_BUMPMAP":"",u.normalMap?"#define USE_NORMALMAP":"",u.normalMap&&u.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",u.normalMap&&u.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",u.clearcoatMap?"#define USE_CLEARCOATMAP":"",u.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",u.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",u.displacementMap&&u.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",u.specularMap?"#define USE_SPECULARMAP":"",u.roughnessMap?"#define USE_ROUGHNESSMAP":"",u.metalnessMap?"#define USE_METALNESSMAP":"",u.alphaMap?"#define USE_ALPHAMAP":"",u.transmissionMap?"#define USE_TRANSMISSIONMAP":"",u.vertexTangents?"#define USE_TANGENT":"",u.vertexColors?"#define USE_COLOR":"",u.vertexUvs?"#define USE_UV":"",u.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",u.flatShading?"#define FLAT_SHADED":"",u.skinning?"#define USE_SKINNING":"",u.useVertexTexture?"#define BONE_TEXTURE":"",u.morphTargets?"#define USE_MORPHTARGETS":"",u.morphNormals&&u.flatShading===!1?"#define USE_MORPHNORMALS":"",u.doubleSided?"#define DOUBLE_SIDED":"",u.flipSided?"#define FLIP_SIDED":"",u.shadowMapEnabled?"#define USE_SHADOWMAP":"",u.shadowMapEnabled?"#define "+M:"",u.sizeAttenuation?"#define USE_SIZEATTENUATION":"",u.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",u.logarithmicDepthBuffer&&u.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(il).join(`
`),te=[W,qa(u),"#define SHADER_NAME "+u.shaderName,J,u.alphaTest?"#define ALPHATEST "+u.alphaTest+(u.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+G,u.useFog&&u.fog?"#define USE_FOG":"",u.useFog&&u.fogExp2?"#define FOG_EXP2":"",u.map?"#define USE_MAP":"",u.matcap?"#define USE_MATCAP":"",u.envMap?"#define USE_ENVMAP":"",u.envMap?"#define "+I:"",u.envMap?"#define "+z:"",u.envMap?"#define "+U:"",u.lightMap?"#define USE_LIGHTMAP":"",u.aoMap?"#define USE_AOMAP":"",u.emissiveMap?"#define USE_EMISSIVEMAP":"",u.bumpMap?"#define USE_BUMPMAP":"",u.normalMap?"#define USE_NORMALMAP":"",u.normalMap&&u.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",u.normalMap&&u.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",u.clearcoatMap?"#define USE_CLEARCOATMAP":"",u.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",u.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",u.specularMap?"#define USE_SPECULARMAP":"",u.roughnessMap?"#define USE_ROUGHNESSMAP":"",u.metalnessMap?"#define USE_METALNESSMAP":"",u.alphaMap?"#define USE_ALPHAMAP":"",u.sheen?"#define USE_SHEEN":"",u.transmissionMap?"#define USE_TRANSMISSIONMAP":"",u.vertexTangents?"#define USE_TANGENT":"",u.vertexColors||u.instancingColor?"#define USE_COLOR":"",u.vertexUvs?"#define USE_UV":"",u.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",u.gradientMap?"#define USE_GRADIENTMAP":"",u.flatShading?"#define FLAT_SHADED":"",u.doubleSided?"#define DOUBLE_SIDED":"",u.flipSided?"#define FLIP_SIDED":"",u.shadowMapEnabled?"#define USE_SHADOWMAP":"",u.shadowMapEnabled?"#define "+M:"",u.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",u.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",u.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",u.logarithmicDepthBuffer&&u.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(u.extensionShaderTextureLOD||u.envMap)&&u.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",u.toneMapping!==js?"#define TONE_MAPPING":"",u.toneMapping!==js?Qn.tonemapping_pars_fragment:"",u.toneMapping!==js?nm("toneMapping",u.toneMapping):"",u.dithering?"#define DITHERING":"",Qn.encodings_pars_fragment,u.map?Pd("mapTexelToLinear",u.mapEncoding):"",u.matcap?Pd("matcapTexelToLinear",u.matcapEncoding):"",u.envMap?Pd("envMapTexelToLinear",u.envMapEncoding):"",u.emissiveMap?Pd("emissiveMapTexelToLinear",u.emissiveMapEncoding):"",u.lightMap?Pd("lightMapTexelToLinear",u.lightMapEncoding):"",ny("linearToOutputTexel",u.outputEncoding),u.depthPacking?"#define DEPTH_PACKING "+u.depthPacking:"",`
`].filter(il).join(`
`)),T=ip(T),T=rm(T,u),T=Tg(T,u),w=ip(w),w=rm(w,u),w=Tg(w,u),T=Sg(T),w=Sg(w),u.isWebGL2&&u.isRawShaderMaterial!==!0&&(K=`#version 300 es
`,pe=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+pe,te=["#define varying in",u.glslVersion===za?"":"out highp vec4 pc_fragColor;",u.glslVersion===za?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+te);const He=K+pe+T,$e=K+te+w,Ue=Co(g,35633,He),Ae=Co(g,35632,$e);if(g.attachShader(me,Ue),g.attachShader(me,Ae),u.index0AttributeName!==void 0?g.bindAttribLocation(me,0,u.index0AttributeName):u.morphTargets===!0&&g.bindAttribLocation(me,0,"position"),g.linkProgram(me),l.debug.checkShaderErrors){const wt=g.getProgramInfoLog(me).trim(),It=g.getShaderInfoLog(Ue).trim(),Pt=g.getShaderInfoLog(Ae).trim();let Nt=!0,nt=!0;if(g.getProgramParameter(me,35714)===!1){Nt=!1;const Ke=Id(g,Ue,"vertex"),st=Id(g,Ae,"fragment");console.error("THREE.WebGLProgram: shader error: ",g.getError(),"35715",g.getProgramParameter(me,35715),"gl.getProgramInfoLog",wt,Ke,st)}else wt!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",wt):(It===""||Pt==="")&&(nt=!1);nt&&(this.diagnostics={runnable:Nt,programLog:wt,vertexShader:{log:It,prefix:pe},fragmentShader:{log:Pt,prefix:te}})}g.deleteShader(Ue),g.deleteShader(Ae);let at;this.getUniforms=function(){return at===void 0&&(at=new os(g,me)),at};let Ht;return this.getAttributes=function(){return Ht===void 0&&(Ht=tp(g,me)),Ht},this.destroy=function(){f.releaseStatesOfProgram(this),g.deleteProgram(me),this.program=void 0},this.name=u.shaderName,this.id=Jf++,this.cacheKey=o,this.usedTimes=1,this.program=me,this.vertexShader=Ue,this.fragmentShader=Ae,this}function ay(l,o,u,f,g,y){const T=[],w=f.isWebGL2,M=f.logarithmicDepthBuffer,I=f.floatVertexTextures,z=f.maxVertexUniforms,U=f.vertexTextures;let G=f.precision;const W={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},J=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function me(Ae){const Ht=Ae.skeleton.bones;if(I)return 1024;{const It=Math.floor((z-20)/4),Pt=Math.min(It,Ht.length);return Pt<Ht.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Ht.length+" bones. This GPU supports "+Pt+"."),0):Pt}}function pe(Ae){let at;return Ae&&Ae.isTexture?at=Ae.encoding:Ae&&Ae.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),at=Ae.texture.encoding):at=Ml,at}function te(Ae,at,Ht,wt,It){const Pt=wt.fog,Nt=Ae.isMeshStandardMaterial?wt.environment:null,nt=o.get(Ae.envMap||Nt),Ke=W[Ae.type],st=It.isSkinnedMesh?me(It):0;Ae.precision!==null&&(G=f.getMaxPrecision(Ae.precision),G!==Ae.precision&&console.warn("THREE.WebGLProgram.getParameters:",Ae.precision,"not supported, using",G,"instead."));let Ct,Xt;if(Ke){const Ai=as[Ke];Ct=Ai.vertexShader,Xt=Ai.fragmentShader}else Ct=Ae.vertexShader,Xt=Ae.fragmentShader;const ti=l.getRenderTarget();return{isWebGL2:w,shaderID:Ke,shaderName:Ae.type,vertexShader:Ct,fragmentShader:Xt,defines:Ae.defines,isRawShaderMaterial:Ae.isRawShaderMaterial===!0,glslVersion:Ae.glslVersion,precision:G,instancing:It.isInstancedMesh===!0,instancingColor:It.isInstancedMesh===!0&&It.instanceColor!==null,supportsVertexTextures:U,outputEncoding:ti!==null?pe(ti.texture):l.outputEncoding,map:!!Ae.map,mapEncoding:pe(Ae.map),matcap:!!Ae.matcap,matcapEncoding:pe(Ae.matcap),envMap:!!nt,envMapMode:nt&&nt.mapping,envMapEncoding:pe(nt),envMapCubeUV:!!nt&&(nt.mapping===Zi||nt.mapping===pi),lightMap:!!Ae.lightMap,lightMapEncoding:pe(Ae.lightMap),aoMap:!!Ae.aoMap,emissiveMap:!!Ae.emissiveMap,emissiveMapEncoding:pe(Ae.emissiveMap),bumpMap:!!Ae.bumpMap,normalMap:!!Ae.normalMap,objectSpaceNormalMap:Ae.normalMapType===mo,tangentSpaceNormalMap:Ae.normalMapType===Ts,clearcoatMap:!!Ae.clearcoatMap,clearcoatRoughnessMap:!!Ae.clearcoatRoughnessMap,clearcoatNormalMap:!!Ae.clearcoatNormalMap,displacementMap:!!Ae.displacementMap,roughnessMap:!!Ae.roughnessMap,metalnessMap:!!Ae.metalnessMap,specularMap:!!Ae.specularMap,alphaMap:!!Ae.alphaMap,gradientMap:!!Ae.gradientMap,sheen:!!Ae.sheen,transmissionMap:!!Ae.transmissionMap,combine:Ae.combine,vertexTangents:Ae.normalMap&&Ae.vertexTangents,vertexColors:Ae.vertexColors,vertexUvs:!!Ae.map||!!Ae.bumpMap||!!Ae.normalMap||!!Ae.specularMap||!!Ae.alphaMap||!!Ae.emissiveMap||!!Ae.roughnessMap||!!Ae.metalnessMap||!!Ae.clearcoatMap||!!Ae.clearcoatRoughnessMap||!!Ae.clearcoatNormalMap||!!Ae.displacementMap||!!Ae.transmissionMap,uvsVertexOnly:!(Ae.map||Ae.bumpMap||Ae.normalMap||Ae.specularMap||Ae.alphaMap||Ae.emissiveMap||Ae.roughnessMap||Ae.metalnessMap||Ae.clearcoatNormalMap||Ae.transmissionMap)&&!!Ae.displacementMap,fog:!!Pt,useFog:Ae.fog,fogExp2:Pt&&Pt.isFogExp2,flatShading:Ae.flatShading,sizeAttenuation:Ae.sizeAttenuation,logarithmicDepthBuffer:M,skinning:Ae.skinning&&st>0,maxBones:st,useVertexTexture:I,morphTargets:Ae.morphTargets,morphNormals:Ae.morphNormals,maxMorphTargets:l.maxMorphTargets,maxMorphNormals:l.maxMorphNormals,numDirLights:at.directional.length,numPointLights:at.point.length,numSpotLights:at.spot.length,numRectAreaLights:at.rectArea.length,numHemiLights:at.hemi.length,numDirLightShadows:at.directionalShadowMap.length,numPointLightShadows:at.pointShadowMap.length,numSpotLightShadows:at.spotShadowMap.length,numClippingPlanes:y.numPlanes,numClipIntersection:y.numIntersection,dithering:Ae.dithering,shadowMapEnabled:l.shadowMap.enabled&&Ht.length>0,shadowMapType:l.shadowMap.type,toneMapping:Ae.toneMapped?l.toneMapping:js,physicallyCorrectLights:l.physicallyCorrectLights,premultipliedAlpha:Ae.premultipliedAlpha,alphaTest:Ae.alphaTest,doubleSided:Ae.side===ke,flipSided:Ae.side===De,depthPacking:Ae.depthPacking!==void 0?Ae.depthPacking:!1,index0AttributeName:Ae.index0AttributeName,extensionDerivatives:Ae.extensions&&Ae.extensions.derivatives,extensionFragDepth:Ae.extensions&&Ae.extensions.fragDepth,extensionDrawBuffers:Ae.extensions&&Ae.extensions.drawBuffers,extensionShaderTextureLOD:Ae.extensions&&Ae.extensions.shaderTextureLOD,rendererExtensionFragDepth:w||u.has("EXT_frag_depth"),rendererExtensionDrawBuffers:w||u.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:w||u.has("EXT_shader_texture_lod"),customProgramCacheKey:Ae.customProgramCacheKey()}}function K(Ae){const at=[];if(Ae.shaderID?at.push(Ae.shaderID):(at.push(Ae.fragmentShader),at.push(Ae.vertexShader)),Ae.defines!==void 0)for(const Ht in Ae.defines)at.push(Ht),at.push(Ae.defines[Ht]);if(Ae.isRawShaderMaterial===!1){for(let Ht=0;Ht<J.length;Ht++)at.push(Ae[J[Ht]]);at.push(l.outputEncoding),at.push(l.gammaFactor)}return at.push(Ae.customProgramCacheKey),at.join()}function He(Ae){const at=W[Ae.type];let Ht;if(at){const wt=as[at];Ht=Ko.clone(wt.uniforms)}else Ht=Ae.uniforms;return Ht}function $e(Ae,at){let Ht;for(let wt=0,It=T.length;wt<It;wt++){const Pt=T[wt];if(Pt.cacheKey===at){Ht=Pt,++Ht.usedTimes;break}}return Ht===void 0&&(Ht=new sy(l,at,Ae,g),T.push(Ht)),Ht}function Ue(Ae){if(--Ae.usedTimes===0){const at=T.indexOf(Ae);T[at]=T[T.length-1],T.pop(),Ae.destroy()}}return{getParameters:te,getProgramCacheKey:K,getUniforms:He,acquireProgram:$e,releaseProgram:Ue,programs:T}}function GS(){let l=new WeakMap;function o(y){let T=l.get(y);return T===void 0&&(T={},l.set(y,T)),T}function u(y){l.delete(y)}function f(y,T,w){l.get(y)[T]=w}function g(){l=new WeakMap}return{get:o,remove:u,update:f,dispose:g}}function Od(l,o){return l.groupOrder!==o.groupOrder?l.groupOrder-o.groupOrder:l.renderOrder!==o.renderOrder?l.renderOrder-o.renderOrder:l.program!==o.program?l.program.id-o.program.id:l.material.id!==o.material.id?l.material.id-o.material.id:l.z!==o.z?l.z-o.z:l.id-o.id}function v1(l,o){return l.groupOrder!==o.groupOrder?l.groupOrder-o.groupOrder:l.renderOrder!==o.renderOrder?l.renderOrder-o.renderOrder:l.z!==o.z?o.z-l.z:l.id-o.id}function wg(l){const o=[];let u=0;const f=[],g=[],y={id:-1};function T(){u=0,f.length=0,g.length=0}function w(G,W,J,me,pe,te){let K=o[u];const He=l.get(J);return K===void 0?(K={id:G.id,object:G,geometry:W,material:J,program:He.program||y,groupOrder:me,renderOrder:G.renderOrder,z:pe,group:te},o[u]=K):(K.id=G.id,K.object=G,K.geometry=W,K.material=J,K.program=He.program||y,K.groupOrder=me,K.renderOrder=G.renderOrder,K.z=pe,K.group=te),u++,K}function M(G,W,J,me,pe,te){const K=w(G,W,J,me,pe,te);(J.transparent===!0?g:f).push(K)}function I(G,W,J,me,pe,te){const K=w(G,W,J,me,pe,te);(J.transparent===!0?g:f).unshift(K)}function z(G,W){f.length>1&&f.sort(G||Od),g.length>1&&g.sort(W||v1)}function U(){for(let G=u,W=o.length;G<W;G++){const J=o[G];if(J.id===null)break;J.id=null,J.object=null,J.geometry=null,J.material=null,J.program=null,J.group=null}}return{opaque:f,transparent:g,init:T,push:M,unshift:I,finish:U,sort:z}}function Gh(l){let o=new WeakMap;function u(g,y){const T=o.get(g);let w;return T===void 0?(w=new wg(l),o.set(g,new WeakMap),o.get(g).set(y,w)):(w=T.get(y),w===void 0&&(w=new wg(l),T.set(y,w))),w}function f(){o=new WeakMap}return{get:u,dispose:f}}function oy(){const l={};return{get:function(o){if(l[o.id]!==void 0)return l[o.id];let u;switch(o.type){case"DirectionalLight":u={direction:new Be,color:new Fi};break;case"SpotLight":u={position:new Be,direction:new Be,color:new Fi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":u={position:new Be,color:new Fi,distance:0,decay:0};break;case"HemisphereLight":u={direction:new Be,skyColor:new Fi,groundColor:new Fi};break;case"RectAreaLight":u={color:new Fi,position:new Be,halfWidth:new Be,halfHeight:new Be};break}return l[o.id]=u,u}}}function $h(){const l={};return{get:function(o){if(l[o.id]!==void 0)return l[o.id];let u;switch(o.type){case"DirectionalLight":u={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new At};break;case"SpotLight":u={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new At};break;case"PointLight":u={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new At,shadowCameraNear:1,shadowCameraFar:1e3};break}return l[o.id]=u,u}}}let y1=0;function _1(l,o){return(o.castShadow?1:0)-(l.castShadow?1:0)}function ly(l,o){const u=new oy,f=$h(),g={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let z=0;z<9;z++)g.probe.push(new Be);const y=new Be,T=new fn,w=new fn;function M(z){let U=0,G=0,W=0;for(let at=0;at<9;at++)g.probe[at].set(0,0,0);let J=0,me=0,pe=0,te=0,K=0,He=0,$e=0,Ue=0;z.sort(_1);for(let at=0,Ht=z.length;at<Ht;at++){const wt=z[at],It=wt.color,Pt=wt.intensity,Nt=wt.distance,nt=wt.shadow&&wt.shadow.map?wt.shadow.map.texture:null;if(wt.isAmbientLight)U+=It.r*Pt,G+=It.g*Pt,W+=It.b*Pt;else if(wt.isLightProbe)for(let Ke=0;Ke<9;Ke++)g.probe[Ke].addScaledVector(wt.sh.coefficients[Ke],Pt);else if(wt.isDirectionalLight){const Ke=u.get(wt);if(Ke.color.copy(wt.color).multiplyScalar(wt.intensity),wt.castShadow){const st=wt.shadow,Ct=f.get(wt);Ct.shadowBias=st.bias,Ct.shadowNormalBias=st.normalBias,Ct.shadowRadius=st.radius,Ct.shadowMapSize=st.mapSize,g.directionalShadow[J]=Ct,g.directionalShadowMap[J]=nt,g.directionalShadowMatrix[J]=wt.shadow.matrix,He++}g.directional[J]=Ke,J++}else if(wt.isSpotLight){const Ke=u.get(wt);if(Ke.position.setFromMatrixPosition(wt.matrixWorld),Ke.color.copy(It).multiplyScalar(Pt),Ke.distance=Nt,Ke.coneCos=Math.cos(wt.angle),Ke.penumbraCos=Math.cos(wt.angle*(1-wt.penumbra)),Ke.decay=wt.decay,wt.castShadow){const st=wt.shadow,Ct=f.get(wt);Ct.shadowBias=st.bias,Ct.shadowNormalBias=st.normalBias,Ct.shadowRadius=st.radius,Ct.shadowMapSize=st.mapSize,g.spotShadow[pe]=Ct,g.spotShadowMap[pe]=nt,g.spotShadowMatrix[pe]=wt.shadow.matrix,Ue++}g.spot[pe]=Ke,pe++}else if(wt.isRectAreaLight){const Ke=u.get(wt);Ke.color.copy(It).multiplyScalar(Pt),Ke.halfWidth.set(wt.width*.5,0,0),Ke.halfHeight.set(0,wt.height*.5,0),g.rectArea[te]=Ke,te++}else if(wt.isPointLight){const Ke=u.get(wt);if(Ke.color.copy(wt.color).multiplyScalar(wt.intensity),Ke.distance=wt.distance,Ke.decay=wt.decay,wt.castShadow){const st=wt.shadow,Ct=f.get(wt);Ct.shadowBias=st.bias,Ct.shadowNormalBias=st.normalBias,Ct.shadowRadius=st.radius,Ct.shadowMapSize=st.mapSize,Ct.shadowCameraNear=st.camera.near,Ct.shadowCameraFar=st.camera.far,g.pointShadow[me]=Ct,g.pointShadowMap[me]=nt,g.pointShadowMatrix[me]=wt.shadow.matrix,$e++}g.point[me]=Ke,me++}else if(wt.isHemisphereLight){const Ke=u.get(wt);Ke.skyColor.copy(wt.color).multiplyScalar(Pt),Ke.groundColor.copy(wt.groundColor).multiplyScalar(Pt),g.hemi[K]=Ke,K++}}te>0&&(o.isWebGL2||l.has("OES_texture_float_linear")===!0?(g.rectAreaLTC1=hi.LTC_FLOAT_1,g.rectAreaLTC2=hi.LTC_FLOAT_2):l.has("OES_texture_half_float_linear")===!0?(g.rectAreaLTC1=hi.LTC_HALF_1,g.rectAreaLTC2=hi.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),g.ambient[0]=U,g.ambient[1]=G,g.ambient[2]=W;const Ae=g.hash;(Ae.directionalLength!==J||Ae.pointLength!==me||Ae.spotLength!==pe||Ae.rectAreaLength!==te||Ae.hemiLength!==K||Ae.numDirectionalShadows!==He||Ae.numPointShadows!==$e||Ae.numSpotShadows!==Ue)&&(g.directional.length=J,g.spot.length=pe,g.rectArea.length=te,g.point.length=me,g.hemi.length=K,g.directionalShadow.length=He,g.directionalShadowMap.length=He,g.pointShadow.length=$e,g.pointShadowMap.length=$e,g.spotShadow.length=Ue,g.spotShadowMap.length=Ue,g.directionalShadowMatrix.length=He,g.pointShadowMatrix.length=$e,g.spotShadowMatrix.length=Ue,Ae.directionalLength=J,Ae.pointLength=me,Ae.spotLength=pe,Ae.rectAreaLength=te,Ae.hemiLength=K,Ae.numDirectionalShadows=He,Ae.numPointShadows=$e,Ae.numSpotShadows=Ue,g.version=y1++)}function I(z,U){let G=0,W=0,J=0,me=0,pe=0;const te=U.matrixWorldInverse;for(let K=0,He=z.length;K<He;K++){const $e=z[K];if($e.isDirectionalLight){const Ue=g.directional[G];Ue.direction.setFromMatrixPosition($e.matrixWorld),y.setFromMatrixPosition($e.target.matrixWorld),Ue.direction.sub(y),Ue.direction.transformDirection(te),G++}else if($e.isSpotLight){const Ue=g.spot[J];Ue.position.setFromMatrixPosition($e.matrixWorld),Ue.position.applyMatrix4(te),Ue.direction.setFromMatrixPosition($e.matrixWorld),y.setFromMatrixPosition($e.target.matrixWorld),Ue.direction.sub(y),Ue.direction.transformDirection(te),J++}else if($e.isRectAreaLight){const Ue=g.rectArea[me];Ue.position.setFromMatrixPosition($e.matrixWorld),Ue.position.applyMatrix4(te),w.identity(),T.copy($e.matrixWorld),T.premultiply(te),w.extractRotation(T),Ue.halfWidth.set($e.width*.5,0,0),Ue.halfHeight.set(0,$e.height*.5,0),Ue.halfWidth.applyMatrix4(w),Ue.halfHeight.applyMatrix4(w),me++}else if($e.isPointLight){const Ue=g.point[W];Ue.position.setFromMatrixPosition($e.matrixWorld),Ue.position.applyMatrix4(te),W++}else if($e.isHemisphereLight){const Ue=g.hemi[pe];Ue.direction.setFromMatrixPosition($e.matrixWorld),Ue.direction.transformDirection(te),Ue.direction.normalize(),pe++}}}return{setup:M,setupView:I,state:g}}function om(l,o){const u=new ly(l,o),f=[],g=[];function y(){f.length=0,g.length=0}function T(U){f.push(U)}function w(U){g.push(U)}function M(){u.setup(f)}function I(U){u.setupView(f,U)}return{init:y,state:{lightsArray:f,shadowsArray:g,lights:u},setupLights:M,setupLightsView:I,pushLight:T,pushShadow:w}}function $S(l,o){let u=new WeakMap;function f(y,T=0){let w;return u.has(y)===!1?(w=new om(l,o),u.set(y,[]),u.get(y).push(w)):T>=u.get(y).length?(w=new om(l,o),u.get(y).push(w)):w=u.get(y)[T],w}function g(){u=new WeakMap}return{get:f,dispose:g}}function Wh(l){Ji.call(this),this.type="MeshDepthMaterial",this.depthPacking=dd,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(l)}Wh.prototype=Object.create(Ji.prototype),Wh.prototype.constructor=Wh,Wh.prototype.isMeshDepthMaterial=!0,Wh.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.depthPacking=l.depthPacking,this.skinning=l.skinning,this.morphTargets=l.morphTargets,this.map=l.map,this.alphaMap=l.alphaMap,this.displacementMap=l.displacementMap,this.displacementScale=l.displacementScale,this.displacementBias=l.displacementBias,this.wireframe=l.wireframe,this.wireframeLinewidth=l.wireframeLinewidth,this};function Fd(l){Ji.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Be,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(l)}Fd.prototype=Object.create(Ji.prototype),Fd.prototype.constructor=Fd,Fd.prototype.isMeshDistanceMaterial=!0,Fd.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.referencePosition.copy(l.referencePosition),this.nearDistance=l.nearDistance,this.farDistance=l.farDistance,this.skinning=l.skinning,this.morphTargets=l.morphTargets,this.map=l.map,this.alphaMap=l.alphaMap,this.displacementMap=l.displacementMap,this.displacementScale=l.displacementScale,this.displacementBias=l.displacementBias,this};var b1=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,qh=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function T1(l,o,u){let f=new Bh;const g=new At,y=new At,T=new Yn,w=[],M=[],I={},z={0:De,1:Ne,2:ke},U=new rs({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new At},radius:{value:4}},vertexShader:qh,fragmentShader:b1}),G=U.clone();G.defines.HORIZONTAL_PASS=1;const W=new $n;W.setAttribute("position",new pn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const J=new Gt(W,U),me=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ve,this.render=function(Ue,Ae,at){if(me.enabled===!1||me.autoUpdate===!1&&me.needsUpdate===!1||Ue.length===0)return;const Ht=l.getRenderTarget(),wt=l.getActiveCubeFace(),It=l.getActiveMipmapLevel(),Pt=l.state;Pt.setBlending(_t),Pt.buffers.color.setClear(1,1,1,1),Pt.buffers.depth.setTest(!0),Pt.setScissorTest(!1);for(let Nt=0,nt=Ue.length;Nt<nt;Nt++){const Ke=Ue[Nt],st=Ke.shadow;if(st===void 0){console.warn("THREE.WebGLShadowMap:",Ke,"has no shadow.");continue}if(st.autoUpdate===!1&&st.needsUpdate===!1)continue;g.copy(st.mapSize);const Ct=st.getFrameExtents();if(g.multiply(Ct),y.copy(st.mapSize),(g.x>u||g.y>u)&&(g.x>u&&(y.x=Math.floor(u/Ct.x),g.x=y.x*Ct.x,st.mapSize.x=y.x),g.y>u&&(y.y=Math.floor(u/Ct.y),g.y=y.y*Ct.y,st.mapSize.y=y.y)),st.map===null&&!st.isPointLightShadow&&this.type===re){const ti={minFilter:Ui,magFilter:Ui,format:cr};st.map=new ec(g.x,g.y,ti),st.map.texture.name=Ke.name+".shadowMap",st.mapPass=new ec(g.x,g.y,ti),st.camera.updateProjectionMatrix()}if(st.map===null){const ti={minFilter:Ye,magFilter:Ye,format:cr};st.map=new ec(g.x,g.y,ti),st.map.texture.name=Ke.name+".shadowMap",st.camera.updateProjectionMatrix()}l.setRenderTarget(st.map),l.clear();const Xt=st.getViewportCount();for(let ti=0;ti<Xt;ti++){const ni=st.getViewport(ti);T.set(y.x*ni.x,y.y*ni.y,y.x*ni.z,y.y*ni.w),Pt.viewport(T),st.updateMatrices(Ke,ti),f=st.getFrustum(),$e(Ae,at,st.camera,Ke,this.type)}!st.isPointLightShadow&&this.type===re&&pe(st,at),st.needsUpdate=!1}me.needsUpdate=!1,l.setRenderTarget(Ht,wt,It)};function pe(Ue,Ae){const at=o.update(J);U.uniforms.shadow_pass.value=Ue.map.texture,U.uniforms.resolution.value=Ue.mapSize,U.uniforms.radius.value=Ue.radius,l.setRenderTarget(Ue.mapPass),l.clear(),l.renderBufferDirect(Ae,null,at,U,J,null),G.uniforms.shadow_pass.value=Ue.mapPass.texture,G.uniforms.resolution.value=Ue.mapSize,G.uniforms.radius.value=Ue.radius,l.setRenderTarget(Ue.map),l.clear(),l.renderBufferDirect(Ae,null,at,G,J,null)}function te(Ue,Ae,at){const Ht=Ue<<0|Ae<<1|at<<2;let wt=w[Ht];return wt===void 0&&(wt=new Wh({depthPacking:Vf,morphTargets:Ue,skinning:Ae}),w[Ht]=wt),wt}function K(Ue,Ae,at){const Ht=Ue<<0|Ae<<1|at<<2;let wt=M[Ht];return wt===void 0&&(wt=new Fd({morphTargets:Ue,skinning:Ae}),M[Ht]=wt),wt}function He(Ue,Ae,at,Ht,wt,It,Pt){let Nt=null,nt=te,Ke=Ue.customDepthMaterial;if(Ht.isPointLight===!0&&(nt=K,Ke=Ue.customDistanceMaterial),Ke===void 0){let st=!1;at.morphTargets===!0&&(st=Ae.morphAttributes&&Ae.morphAttributes.position&&Ae.morphAttributes.position.length>0);let Ct=!1;Ue.isSkinnedMesh===!0&&(at.skinning===!0?Ct=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",Ue));const Xt=Ue.isInstancedMesh===!0;Nt=nt(st,Ct,Xt)}else Nt=Ke;if(l.localClippingEnabled&&at.clipShadows===!0&&at.clippingPlanes.length!==0){const st=Nt.uuid,Ct=at.uuid;let Xt=I[st];Xt===void 0&&(Xt={},I[st]=Xt);let ti=Xt[Ct];ti===void 0&&(ti=Nt.clone(),Xt[Ct]=ti),Nt=ti}return Nt.visible=at.visible,Nt.wireframe=at.wireframe,Pt===re?Nt.side=at.shadowSide!==null?at.shadowSide:at.side:Nt.side=at.shadowSide!==null?at.shadowSide:z[at.side],Nt.clipShadows=at.clipShadows,Nt.clippingPlanes=at.clippingPlanes,Nt.clipIntersection=at.clipIntersection,Nt.wireframeLinewidth=at.wireframeLinewidth,Nt.linewidth=at.linewidth,Ht.isPointLight===!0&&Nt.isMeshDistanceMaterial===!0&&(Nt.referencePosition.setFromMatrixPosition(Ht.matrixWorld),Nt.nearDistance=wt,Nt.farDistance=It),Nt}function $e(Ue,Ae,at,Ht,wt){if(Ue.visible===!1)return;if(Ue.layers.test(Ae.layers)&&(Ue.isMesh||Ue.isLine||Ue.isPoints)&&(Ue.castShadow||Ue.receiveShadow&&wt===re)&&(!Ue.frustumCulled||f.intersectsObject(Ue))){Ue.modelViewMatrix.multiplyMatrices(at.matrixWorldInverse,Ue.matrixWorld);const Nt=o.update(Ue),nt=Ue.material;if(Array.isArray(nt)){const Ke=Nt.groups;for(let st=0,Ct=Ke.length;st<Ct;st++){const Xt=Ke[st],ti=nt[Xt.materialIndex];if(ti&&ti.visible){const ni=He(Ue,Nt,ti,Ht,at.near,at.far,wt);l.renderBufferDirect(at,null,Nt,ni,Ue,Xt)}}}else if(nt.visible){const Ke=He(Ue,Nt,nt,Ht,at.near,at.far,wt);l.renderBufferDirect(at,null,Nt,Ke,Ue,null)}}const Pt=Ue.children;for(let Nt=0,nt=Pt.length;Nt<nt;Nt++)$e(Pt[Nt],Ae,at,Ht,wt)}}function np(l,o,u){const f=u.isWebGL2;function g(){let We=!1;const zt=new Yn;let Ei=null;const ji=new Yn(0,0,0,0);return{setMask:function(Si){Ei!==Si&&!We&&(l.colorMask(Si,Si,Si,Si),Ei=Si)},setLocked:function(Si){We=Si},setClear:function(Si,Vi,Ii,An,zi){zi===!0&&(Si*=An,Vi*=An,Ii*=An),zt.set(Si,Vi,Ii,An),ji.equals(zt)===!1&&(l.clearColor(Si,Vi,Ii,An),ji.copy(zt))},reset:function(){We=!1,Ei=null,ji.set(-1,0,0,0)}}}function y(){let We=!1,zt=null,Ei=null,ji=null;return{setTest:function(Si){Si?Ai(2929):_i(2929)},setMask:function(Si){zt!==Si&&!We&&(l.depthMask(Si),zt=Si)},setFunc:function(Si){if(Ei!==Si){if(Si)switch(Si){case bs:l.depthFunc(512);break;case cs:l.depthFunc(519);break;case sn:l.depthFunc(513);break;case dn:l.depthFunc(515);break;case gn:l.depthFunc(514);break;case Sr:l.depthFunc(518);break;case fa:l.depthFunc(516);break;case Oa:l.depthFunc(517);break;default:l.depthFunc(515)}else l.depthFunc(515);Ei=Si}},setLocked:function(Si){We=Si},setClear:function(Si){ji!==Si&&(l.clearDepth(Si),ji=Si)},reset:function(){We=!1,zt=null,Ei=null,ji=null}}}function T(){let We=!1,zt=null,Ei=null,ji=null,Si=null,Vi=null,Ii=null,An=null,zi=null;return{setTest:function(hn){We||(hn?Ai(2960):_i(2960))},setMask:function(hn){zt!==hn&&!We&&(l.stencilMask(hn),zt=hn)},setFunc:function(hn,ms,Lo){(Ei!==hn||ji!==ms||Si!==Lo)&&(l.stencilFunc(hn,ms,Lo),Ei=hn,ji=ms,Si=Lo)},setOp:function(hn,ms,Lo){(Vi!==hn||Ii!==ms||An!==Lo)&&(l.stencilOp(hn,ms,Lo),Vi=hn,Ii=ms,An=Lo)},setLocked:function(hn){We=hn},setClear:function(hn){zi!==hn&&(l.clearStencil(hn),zi=hn)},reset:function(){We=!1,zt=null,Ei=null,ji=null,Si=null,Vi=null,Ii=null,An=null,zi=null}}}const w=new g,M=new y,I=new T;let z={},U=null,G=null,W=null,J=null,me=null,pe=null,te=null,K=null,He=null,$e=!1,Ue=null,Ae=null,at=null,Ht=null,wt=null;const It=l.getParameter(35661);let Pt=!1,Nt=0;const nt=l.getParameter(7938);nt.indexOf("WebGL")!==-1?(Nt=parseFloat(/^WebGL (\d)/.exec(nt)[1]),Pt=Nt>=1):nt.indexOf("OpenGL ES")!==-1&&(Nt=parseFloat(/^OpenGL ES (\d)/.exec(nt)[1]),Pt=Nt>=2);let Ke=null,st={};const Ct=new Yn,Xt=new Yn;function ti(We,zt,Ei){const ji=new Uint8Array(4),Si=l.createTexture();l.bindTexture(We,Si),l.texParameteri(We,10241,9728),l.texParameteri(We,10240,9728);for(let Vi=0;Vi<Ei;Vi++)l.texImage2D(zt+Vi,0,6408,1,1,0,6408,5121,ji);return Si}const ni={};ni[3553]=ti(3553,3553,1),ni[34067]=ti(34067,34069,6),w.setClear(0,0,0,1),M.setClear(1),I.setClear(0),Ai(2929),M.setFunc(dn),mn(!1),Wn(be),Ai(2884),Kt(_t);function Ai(We){z[We]!==!0&&(l.enable(We),z[We]=!0)}function _i(We){z[We]!==!1&&(l.disable(We),z[We]=!1)}function on(We){return U!==We?(l.useProgram(We),U=We,!0):!1}const vn={[Se]:32774,[ct]:32778,[xt]:32779};if(f)vn[ii]=32775,vn[Re]=32776;else{const We=o.get("EXT_blend_minmax");We!==null&&(vn[ii]=We.MIN_EXT,vn[Re]=We.MAX_EXT)}const Pn={[lt]:0,[bt]:1,[Je]:768,[Yt]:770,[yr]:776,[Ki]:774,[xi]:772,[Dt]:769,[vi]:771,[io]:775,[Yi]:773};function Kt(We,zt,Ei,ji,Si,Vi,Ii,An){if(We===_t){G&&(_i(3042),G=!1);return}if(G||(Ai(3042),G=!0),We!==Xe){if(We!==W||An!==$e){if((J!==Se||te!==Se)&&(l.blendEquation(32774),J=Se,te=Se),An)switch(We){case vt:l.blendFuncSeparate(1,771,1,771);break;case tt:l.blendFunc(1,1);break;case je:l.blendFuncSeparate(0,0,769,771);break;case it:l.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",We);break}else switch(We){case vt:l.blendFuncSeparate(770,771,1,771);break;case tt:l.blendFunc(770,1);break;case je:l.blendFunc(0,769);break;case it:l.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",We);break}me=null,pe=null,K=null,He=null,W=We,$e=An}return}Si=Si||zt,Vi=Vi||Ei,Ii=Ii||ji,(zt!==J||Si!==te)&&(l.blendEquationSeparate(vn[zt],vn[Si]),J=zt,te=Si),(Ei!==me||ji!==pe||Vi!==K||Ii!==He)&&(l.blendFuncSeparate(Pn[Ei],Pn[ji],Pn[Vi],Pn[Ii]),me=Ei,pe=ji,K=Vi,He=Ii),W=We,$e=null}function ua(We,zt){We.side===ke?_i(2884):Ai(2884);let Ei=We.side===De;zt&&(Ei=!Ei),mn(Ei),We.blending===vt&&We.transparent===!1?Kt(_t):Kt(We.blending,We.blendEquation,We.blendSrc,We.blendDst,We.blendEquationAlpha,We.blendSrcAlpha,We.blendDstAlpha,We.premultipliedAlpha),M.setFunc(We.depthFunc),M.setTest(We.depthTest),M.setMask(We.depthWrite),w.setMask(We.colorWrite);const ji=We.stencilWrite;I.setTest(ji),ji&&(I.setMask(We.stencilWriteMask),I.setFunc(We.stencilFunc,We.stencilRef,We.stencilFuncMask),I.setOp(We.stencilFail,We.stencilZFail,We.stencilZPass)),pr(We.polygonOffset,We.polygonOffsetFactor,We.polygonOffsetUnits)}function mn(We){Ue!==We&&(We?l.frontFace(2304):l.frontFace(2305),Ue=We)}function Wn(We){We!==ue?(Ai(2884),We!==Ae&&(We===be?l.cullFace(1029):We===fe?l.cullFace(1028):l.cullFace(1032))):_i(2884),Ae=We}function yn(We){We!==at&&(Pt&&l.lineWidth(We),at=We)}function pr(We,zt,Ei){We?(Ai(32823),(Ht!==zt||wt!==Ei)&&(l.polygonOffset(zt,Ei),Ht=zt,wt=Ei)):_i(32823)}function Sn(We){We?Ai(3089):_i(3089)}function li(We){We===void 0&&(We=33984+It-1),Ke!==We&&(l.activeTexture(We),Ke=We)}function gi(We,zt){Ke===null&&li();let Ei=st[Ke];Ei===void 0&&(Ei={type:void 0,texture:void 0},st[Ke]=Ei),(Ei.type!==We||Ei.texture!==zt)&&(l.bindTexture(We,zt||ni[We]),Ei.type=We,Ei.texture=zt)}function Ti(){const We=st[Ke];We!==void 0&&We.type!==void 0&&(l.bindTexture(We.type,null),We.type=void 0,We.texture=void 0)}function mt(){try{l.compressedTexImage2D.apply(l,arguments)}catch(We){console.error("THREE.WebGLState:",We)}}function oi(){try{l.texImage2D.apply(l,arguments)}catch(We){console.error("THREE.WebGLState:",We)}}function Ie(){try{l.texImage3D.apply(l,arguments)}catch(We){console.error("THREE.WebGLState:",We)}}function we(We){Ct.equals(We)===!1&&(l.scissor(We.x,We.y,We.z,We.w),Ct.copy(We))}function qt(We){Xt.equals(We)===!1&&(l.viewport(We.x,We.y,We.z,We.w),Xt.copy(We))}function $t(){z={},Ke=null,st={},U=null,G=null,W=null,J=null,me=null,pe=null,te=null,K=null,He=null,$e=!1,Ue=null,Ae=null,at=null,Ht=null,wt=null,w.reset(),M.reset(),I.reset()}return{buffers:{color:w,depth:M,stencil:I},enable:Ai,disable:_i,useProgram:on,setBlending:Kt,setMaterial:ua,setFlipSided:mn,setCullFace:Wn,setLineWidth:yn,setPolygonOffset:pr,setScissorTest:Sn,activeTexture:li,bindTexture:gi,unbindTexture:Ti,compressedTexImage2D:mt,texImage2D:oi,texImage3D:Ie,scissor:we,viewport:qt,reset:$t}}function x1(l,o,u,f,g,y,T){const w=g.isWebGL2,M=g.maxTextures,I=g.maxCubemapSize,z=g.maxTextureSize,U=g.maxSamples,G=new WeakMap;let W,J=!1;try{J=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function me(Ie,we){return J?new OffscreenCanvas(Ie,we):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function pe(Ie,we,qt,$t){let We=1;if((Ie.width>$t||Ie.height>$t)&&(We=$t/Math.max(Ie.width,Ie.height)),We<1||we===!0)if(typeof HTMLImageElement<"u"&&Ie instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ie instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ie instanceof ImageBitmap){const zt=we?Gi.floorPowerOfTwo:Math.floor,Ei=zt(We*Ie.width),ji=zt(We*Ie.height);W===void 0&&(W=me(Ei,ji));const Si=qt?me(Ei,ji):W;return Si.width=Ei,Si.height=ji,Si.getContext("2d").drawImage(Ie,0,0,Ei,ji),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ie.width+"x"+Ie.height+") to ("+Ei+"x"+ji+")."),Si}else return"data"in Ie&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ie.width+"x"+Ie.height+")."),Ie;return Ie}function te(Ie){return Gi.isPowerOfTwo(Ie.width)&&Gi.isPowerOfTwo(Ie.height)}function K(Ie){return w?!1:Ie.wrapS!==oe||Ie.wrapT!==oe||Ie.minFilter!==Ye&&Ie.minFilter!==Ui}function He(Ie,we){return Ie.generateMipmaps&&we&&Ie.minFilter!==Ye&&Ie.minFilter!==Ui}function $e(Ie,we,qt,$t){l.generateMipmap(Ie);const We=f.get(we);We.__maxMipLevel=Math.log(Math.max(qt,$t))*Math.LOG2E}function Ue(Ie,we,qt){if(w===!1)return we;if(Ie!==null){if(l[Ie]!==void 0)return l[Ie];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ie+"'")}let $t=we;return we===6403&&(qt===5126&&($t=33326),qt===5131&&($t=33325),qt===5121&&($t=33321)),we===6407&&(qt===5126&&($t=34837),qt===5131&&($t=34843),qt===5121&&($t=32849)),we===6408&&(qt===5126&&($t=34836),qt===5131&&($t=34842),qt===5121&&($t=32856)),($t===33325||$t===33326||$t===34842||$t===34836)&&o.get("EXT_color_buffer_float"),$t}function Ae(Ie){return Ie===Ye||Ie===jt||Ie===bi?9728:9729}function at(Ie){const we=Ie.target;we.removeEventListener("dispose",at),wt(we),we.isVideoTexture&&G.delete(we),T.memory.textures--}function Ht(Ie){const we=Ie.target;we.removeEventListener("dispose",Ht),It(we),T.memory.textures--}function wt(Ie){const we=f.get(Ie);we.__webglInit!==void 0&&(l.deleteTexture(we.__webglTexture),f.remove(Ie))}function It(Ie){const we=f.get(Ie),qt=f.get(Ie.texture);if(Ie){if(qt.__webglTexture!==void 0&&l.deleteTexture(qt.__webglTexture),Ie.depthTexture&&Ie.depthTexture.dispose(),Ie.isWebGLCubeRenderTarget)for(let $t=0;$t<6;$t++)l.deleteFramebuffer(we.__webglFramebuffer[$t]),we.__webglDepthbuffer&&l.deleteRenderbuffer(we.__webglDepthbuffer[$t]);else l.deleteFramebuffer(we.__webglFramebuffer),we.__webglDepthbuffer&&l.deleteRenderbuffer(we.__webglDepthbuffer),we.__webglMultisampledFramebuffer&&l.deleteFramebuffer(we.__webglMultisampledFramebuffer),we.__webglColorRenderbuffer&&l.deleteRenderbuffer(we.__webglColorRenderbuffer),we.__webglDepthRenderbuffer&&l.deleteRenderbuffer(we.__webglDepthRenderbuffer);f.remove(Ie.texture),f.remove(Ie)}}let Pt=0;function Nt(){Pt=0}function nt(){const Ie=Pt;return Ie>=M&&console.warn("THREE.WebGLTextures: Trying to use "+Ie+" texture units while this GPU supports only "+M),Pt+=1,Ie}function Ke(Ie,we){const qt=f.get(Ie);if(Ie.isVideoTexture&&li(Ie),Ie.version>0&&qt.__version!==Ie.version){const $t=Ie.image;if($t===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if($t.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{on(qt,Ie,we);return}}u.activeTexture(33984+we),u.bindTexture(3553,qt.__webglTexture)}function st(Ie,we){const qt=f.get(Ie);if(Ie.version>0&&qt.__version!==Ie.version){on(qt,Ie,we);return}u.activeTexture(33984+we),u.bindTexture(35866,qt.__webglTexture)}function Ct(Ie,we){const qt=f.get(Ie);if(Ie.version>0&&qt.__version!==Ie.version){on(qt,Ie,we);return}u.activeTexture(33984+we),u.bindTexture(32879,qt.__webglTexture)}function Xt(Ie,we){const qt=f.get(Ie);if(Ie.version>0&&qt.__version!==Ie.version){vn(qt,Ie,we);return}u.activeTexture(33984+we),u.bindTexture(34067,qt.__webglTexture)}const ti={[ne]:10497,[oe]:33071,[xe]:33648},ni={[Ye]:9728,[jt]:9984,[bi]:9986,[Ui]:9729,[Qr]:9985,[Kr]:9987};function Ai(Ie,we,qt){qt?(l.texParameteri(Ie,10242,ti[we.wrapS]),l.texParameteri(Ie,10243,ti[we.wrapT]),(Ie===32879||Ie===35866)&&l.texParameteri(Ie,32882,ti[we.wrapR]),l.texParameteri(Ie,10240,ni[we.magFilter]),l.texParameteri(Ie,10241,ni[we.minFilter])):(l.texParameteri(Ie,10242,33071),l.texParameteri(Ie,10243,33071),(Ie===32879||Ie===35866)&&l.texParameteri(Ie,32882,33071),(we.wrapS!==oe||we.wrapT!==oe)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),l.texParameteri(Ie,10240,Ae(we.magFilter)),l.texParameteri(Ie,10241,Ae(we.minFilter)),we.minFilter!==Ye&&we.minFilter!==Ui&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const $t=o.get("EXT_texture_filter_anisotropic");if($t){if(we.type===ln&&o.get("OES_texture_float_linear")===null||we.type===Fa&&(w||o.get("OES_texture_half_float_linear"))===null)return;(we.anisotropy>1||f.get(we).__currentAnisotropy)&&(l.texParameterf(Ie,$t.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(we.anisotropy,g.getMaxAnisotropy())),f.get(we).__currentAnisotropy=we.anisotropy)}}function _i(Ie,we){Ie.__webglInit===void 0&&(Ie.__webglInit=!0,we.addEventListener("dispose",at),Ie.__webglTexture=l.createTexture(),T.memory.textures++)}function on(Ie,we,qt){let $t=3553;we.isDataTexture2DArray&&($t=35866),we.isDataTexture3D&&($t=32879),_i(Ie,we),u.activeTexture(33984+qt),u.bindTexture($t,Ie.__webglTexture),l.pixelStorei(37440,we.flipY),l.pixelStorei(37441,we.premultiplyAlpha),l.pixelStorei(3317,we.unpackAlignment);const We=K(we)&&te(we.image)===!1,zt=pe(we.image,We,!1,z),Ei=te(zt)||w,ji=y.convert(we.format);let Si=y.convert(we.type),Vi=Ue(we.internalFormat,ji,Si);Ai($t,we,Ei);let Ii;const An=we.mipmaps;if(we.isDepthTexture)Vi=6402,w?we.type===ln?Vi=36012:we.type===Gn?Vi=33190:we.type===nn?Vi=35056:Vi=33189:we.type===ln&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),we.format===rr&&Vi===6402&&we.type!==Ls&&we.type!==Gn&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),we.type=Ls,Si=y.convert(we.type)),we.format===zo&&Vi===6402&&(Vi=34041,we.type!==nn&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),we.type=nn,Si=y.convert(we.type))),u.texImage2D(3553,0,Vi,zt.width,zt.height,0,ji,Si,null);else if(we.isDataTexture)if(An.length>0&&Ei){for(let zi=0,hn=An.length;zi<hn;zi++)Ii=An[zi],u.texImage2D(3553,zi,Vi,Ii.width,Ii.height,0,ji,Si,Ii.data);we.generateMipmaps=!1,Ie.__maxMipLevel=An.length-1}else u.texImage2D(3553,0,Vi,zt.width,zt.height,0,ji,Si,zt.data),Ie.__maxMipLevel=0;else if(we.isCompressedTexture){for(let zi=0,hn=An.length;zi<hn;zi++)Ii=An[zi],we.format!==cr&&we.format!==ta?ji!==null?u.compressedTexImage2D(3553,zi,Vi,Ii.width,Ii.height,0,Ii.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):u.texImage2D(3553,zi,Vi,Ii.width,Ii.height,0,ji,Si,Ii.data);Ie.__maxMipLevel=An.length-1}else if(we.isDataTexture2DArray)u.texImage3D(35866,0,Vi,zt.width,zt.height,zt.depth,0,ji,Si,zt.data),Ie.__maxMipLevel=0;else if(we.isDataTexture3D)u.texImage3D(32879,0,Vi,zt.width,zt.height,zt.depth,0,ji,Si,zt.data),Ie.__maxMipLevel=0;else if(An.length>0&&Ei){for(let zi=0,hn=An.length;zi<hn;zi++)Ii=An[zi],u.texImage2D(3553,zi,Vi,ji,Si,Ii);we.generateMipmaps=!1,Ie.__maxMipLevel=An.length-1}else u.texImage2D(3553,0,Vi,ji,Si,zt),Ie.__maxMipLevel=0;He(we,Ei)&&$e($t,we,zt.width,zt.height),Ie.__version=we.version,we.onUpdate&&we.onUpdate(we)}function vn(Ie,we,qt){if(we.image.length!==6)return;_i(Ie,we),u.activeTexture(33984+qt),u.bindTexture(34067,Ie.__webglTexture),l.pixelStorei(37440,we.flipY),l.pixelStorei(37441,we.premultiplyAlpha),l.pixelStorei(3317,we.unpackAlignment);const $t=we&&(we.isCompressedTexture||we.image[0].isCompressedTexture),We=we.image[0]&&we.image[0].isDataTexture,zt=[];for(let zi=0;zi<6;zi++)!$t&&!We?zt[zi]=pe(we.image[zi],!1,!0,I):zt[zi]=We?we.image[zi].image:we.image[zi];const Ei=zt[0],ji=te(Ei)||w,Si=y.convert(we.format),Vi=y.convert(we.type),Ii=Ue(we.internalFormat,Si,Vi);Ai(34067,we,ji);let An;if($t){for(let zi=0;zi<6;zi++){An=zt[zi].mipmaps;for(let hn=0;hn<An.length;hn++){const ms=An[hn];we.format!==cr&&we.format!==ta?Si!==null?u.compressedTexImage2D(34069+zi,hn,Ii,ms.width,ms.height,0,ms.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):u.texImage2D(34069+zi,hn,Ii,ms.width,ms.height,0,Si,Vi,ms.data)}}Ie.__maxMipLevel=An.length-1}else{An=we.mipmaps;for(let zi=0;zi<6;zi++)if(We){u.texImage2D(34069+zi,0,Ii,zt[zi].width,zt[zi].height,0,Si,Vi,zt[zi].data);for(let hn=0;hn<An.length;hn++){const Lo=An[hn].image[zi].image;u.texImage2D(34069+zi,hn+1,Ii,Lo.width,Lo.height,0,Si,Vi,Lo.data)}}else{u.texImage2D(34069+zi,0,Ii,Si,Vi,zt[zi]);for(let hn=0;hn<An.length;hn++){const ms=An[hn];u.texImage2D(34069+zi,hn+1,Ii,Si,Vi,ms.image[zi])}}Ie.__maxMipLevel=An.length}He(we,ji)&&$e(34067,we,Ei.width,Ei.height),Ie.__version=we.version,we.onUpdate&&we.onUpdate(we)}function Pn(Ie,we,qt,$t){const We=y.convert(we.texture.format),zt=y.convert(we.texture.type),Ei=Ue(we.texture.internalFormat,We,zt);u.texImage2D($t,0,Ei,we.width,we.height,0,We,zt,null),l.bindFramebuffer(36160,Ie),l.framebufferTexture2D(36160,qt,$t,f.get(we.texture).__webglTexture,0),l.bindFramebuffer(36160,null)}function Kt(Ie,we,qt){if(l.bindRenderbuffer(36161,Ie),we.depthBuffer&&!we.stencilBuffer){let $t=33189;if(qt){const We=we.depthTexture;We&&We.isDepthTexture&&(We.type===ln?$t=36012:We.type===Gn&&($t=33190));const zt=Sn(we);l.renderbufferStorageMultisample(36161,zt,$t,we.width,we.height)}else l.renderbufferStorage(36161,$t,we.width,we.height);l.framebufferRenderbuffer(36160,36096,36161,Ie)}else if(we.depthBuffer&&we.stencilBuffer){if(qt){const $t=Sn(we);l.renderbufferStorageMultisample(36161,$t,35056,we.width,we.height)}else l.renderbufferStorage(36161,34041,we.width,we.height);l.framebufferRenderbuffer(36160,33306,36161,Ie)}else{const $t=y.convert(we.texture.format),We=y.convert(we.texture.type),zt=Ue(we.texture.internalFormat,$t,We);if(qt){const Ei=Sn(we);l.renderbufferStorageMultisample(36161,Ei,zt,we.width,we.height)}else l.renderbufferStorage(36161,zt,we.width,we.height)}l.bindRenderbuffer(36161,null)}function ua(Ie,we){if(we&&we.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(l.bindFramebuffer(36160,Ie),!(we.depthTexture&&we.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!f.get(we.depthTexture).__webglTexture||we.depthTexture.image.width!==we.width||we.depthTexture.image.height!==we.height)&&(we.depthTexture.image.width=we.width,we.depthTexture.image.height=we.height,we.depthTexture.needsUpdate=!0),Ke(we.depthTexture,0);const $t=f.get(we.depthTexture).__webglTexture;if(we.depthTexture.format===rr)l.framebufferTexture2D(36160,36096,3553,$t,0);else if(we.depthTexture.format===zo)l.framebufferTexture2D(36160,33306,3553,$t,0);else throw new Error("Unknown depthTexture format")}function mn(Ie){const we=f.get(Ie),qt=Ie.isWebGLCubeRenderTarget===!0;if(Ie.depthTexture){if(qt)throw new Error("target.depthTexture not supported in Cube render targets");ua(we.__webglFramebuffer,Ie)}else if(qt){we.__webglDepthbuffer=[];for(let $t=0;$t<6;$t++)l.bindFramebuffer(36160,we.__webglFramebuffer[$t]),we.__webglDepthbuffer[$t]=l.createRenderbuffer(),Kt(we.__webglDepthbuffer[$t],Ie,!1)}else l.bindFramebuffer(36160,we.__webglFramebuffer),we.__webglDepthbuffer=l.createRenderbuffer(),Kt(we.__webglDepthbuffer,Ie,!1);l.bindFramebuffer(36160,null)}function Wn(Ie){const we=f.get(Ie),qt=f.get(Ie.texture);Ie.addEventListener("dispose",Ht),qt.__webglTexture=l.createTexture(),T.memory.textures++;const $t=Ie.isWebGLCubeRenderTarget===!0,We=Ie.isWebGLMultisampleRenderTarget===!0,zt=te(Ie)||w;if(w&&Ie.texture.format===ta&&(Ie.texture.type===ln||Ie.texture.type===Fa)&&(Ie.texture.format=cr,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),$t){we.__webglFramebuffer=[];for(let Ei=0;Ei<6;Ei++)we.__webglFramebuffer[Ei]=l.createFramebuffer()}else if(we.__webglFramebuffer=l.createFramebuffer(),We)if(w){we.__webglMultisampledFramebuffer=l.createFramebuffer(),we.__webglColorRenderbuffer=l.createRenderbuffer(),l.bindRenderbuffer(36161,we.__webglColorRenderbuffer);const Ei=y.convert(Ie.texture.format),ji=y.convert(Ie.texture.type),Si=Ue(Ie.texture.internalFormat,Ei,ji),Vi=Sn(Ie);l.renderbufferStorageMultisample(36161,Vi,Si,Ie.width,Ie.height),l.bindFramebuffer(36160,we.__webglMultisampledFramebuffer),l.framebufferRenderbuffer(36160,36064,36161,we.__webglColorRenderbuffer),l.bindRenderbuffer(36161,null),Ie.depthBuffer&&(we.__webglDepthRenderbuffer=l.createRenderbuffer(),Kt(we.__webglDepthRenderbuffer,Ie,!0)),l.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if($t){u.bindTexture(34067,qt.__webglTexture),Ai(34067,Ie.texture,zt);for(let Ei=0;Ei<6;Ei++)Pn(we.__webglFramebuffer[Ei],Ie,36064,34069+Ei);He(Ie.texture,zt)&&$e(34067,Ie.texture,Ie.width,Ie.height),u.bindTexture(34067,null)}else u.bindTexture(3553,qt.__webglTexture),Ai(3553,Ie.texture,zt),Pn(we.__webglFramebuffer,Ie,36064,3553),He(Ie.texture,zt)&&$e(3553,Ie.texture,Ie.width,Ie.height),u.bindTexture(3553,null);Ie.depthBuffer&&mn(Ie)}function yn(Ie){const we=Ie.texture,qt=te(Ie)||w;if(He(we,qt)){const $t=Ie.isWebGLCubeRenderTarget?34067:3553,We=f.get(we).__webglTexture;u.bindTexture($t,We),$e($t,we,Ie.width,Ie.height),u.bindTexture($t,null)}}function pr(Ie){if(Ie.isWebGLMultisampleRenderTarget)if(w){const we=f.get(Ie);l.bindFramebuffer(36008,we.__webglMultisampledFramebuffer),l.bindFramebuffer(36009,we.__webglFramebuffer);const qt=Ie.width,$t=Ie.height;let We=16384;Ie.depthBuffer&&(We|=256),Ie.stencilBuffer&&(We|=1024),l.blitFramebuffer(0,0,qt,$t,0,0,qt,$t,We,9728),l.bindFramebuffer(36160,we.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function Sn(Ie){return w&&Ie.isWebGLMultisampleRenderTarget?Math.min(U,Ie.samples):0}function li(Ie){const we=T.render.frame;G.get(Ie)!==we&&(G.set(Ie,we),Ie.update())}let gi=!1,Ti=!1;function mt(Ie,we){Ie&&Ie.isWebGLRenderTarget&&(gi===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),gi=!0),Ie=Ie.texture),Ke(Ie,we)}function oi(Ie,we){Ie&&Ie.isWebGLCubeRenderTarget&&(Ti===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Ti=!0),Ie=Ie.texture),Xt(Ie,we)}this.allocateTextureUnit=nt,this.resetTextureUnits=Nt,this.setTexture2D=Ke,this.setTexture2DArray=st,this.setTexture3D=Ct,this.setTextureCube=Xt,this.setupRenderTarget=Wn,this.updateRenderTargetMipmap=yn,this.updateMultisampleRenderTarget=pr,this.safeSetTexture2D=mt,this.safeSetTextureCube=oi}function ws(l,o,u){const f=u.isWebGL2;function g(y){let T;if(y===ur)return 5121;if(y===Pr)return 32819;if(y===ea)return 32820;if(y===no)return 33635;if(y===wa)return 5120;if(y===pa)return 5122;if(y===Ls)return 5123;if(y===Ir)return 5124;if(y===Gn)return 5125;if(y===ln)return 5126;if(y===Fa)return f?5131:(T=o.get("OES_texture_half_float"),T!==null?T.HALF_FLOAT_OES:null);if(y===Lr)return 6406;if(y===ta)return 6407;if(y===cr)return 6408;if(y===kf)return 6409;if(y===_l)return 6410;if(y===rr)return 6402;if(y===zo)return 34041;if(y===xc)return 6403;if(y===Of)return 36244;if(y===Gr)return 33319;if(y===nd)return 33320;if(y===rd)return 36248;if(y===su)return 36249;if(y===bl||y===Qu||y===Ah||y===Sc)if(T=o.get("WEBGL_compressed_texture_s3tc"),T!==null){if(y===bl)return T.COMPRESSED_RGB_S3TC_DXT1_EXT;if(y===Qu)return T.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(y===Ah)return T.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(y===Sc)return T.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(y===Rs||y===Ho||y===Gs||y===ro)if(T=o.get("WEBGL_compressed_texture_pvrtc"),T!==null){if(y===Rs)return T.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(y===Ho)return T.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(y===Gs)return T.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(y===ro)return T.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(y===au)return T=o.get("WEBGL_compressed_texture_etc1"),T!==null?T.COMPRESSED_RGB_ETC1_WEBGL:null;if((y===ou||y===so)&&(T=o.get("WEBGL_compressed_texture_etc"),T!==null)){if(y===ou)return T.COMPRESSED_RGB8_ETC2;if(y===so)return T.COMPRESSED_RGBA8_ETC2_EAC}if(y===Ba||y===Ku||y===lu||y===Ff||y===jo||y===uu||y===Bf||y===Tl||y===fo||y===Na||y===wh||y===Jn||y===cu||y===Ac||y===wc||y===Eh||y===sd||y===Ch||y===ad||y===Sl||y===ao||y===Ua||y===Al||y===Zu||y===wl||y===Mh||y===Nf||y===Go)return T=o.get("WEBGL_compressed_texture_astc"),T!==null?y:null;if(y===xl)return T=o.get("EXT_texture_compression_bptc"),T!==null?y:null;if(y===nn)return f?34042:(T=o.get("WEBGL_depth_texture"),T!==null?T.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:g}}function uy(l=[]){fr.call(this),this.cameras=l}uy.prototype=X(Object.create(fr.prototype),{constructor:uy,isArrayCamera:!0});function Xh(){Li.call(this),this.type="Group"}Xh.prototype=X(Object.create(Li.prototype),{constructor:Xh,isGroup:!0});function lm(){this._targetRay=null,this._grip=null,this._hand=null}X(lm.prototype,{constructor:lm,getHandSpace:function(){return this._hand===null&&(this._hand=new Xh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Xh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Xh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(l){return this._targetRay!==null&&this._targetRay.dispatchEvent(l),this._grip!==null&&this._grip.dispatchEvent(l),this._hand!==null&&this._hand.dispatchEvent(l),this},disconnect:function(l){return this.dispatchEvent({type:"disconnected",data:l}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(l,o,u){let f=null,g=null,y=null;const T=this._targetRay,w=this._grip,M=this._hand;if(l&&o.session.visibilityState!=="visible-blurred")if(M&&l.hand){y=!0;for(const J of l.hand.values()){const me=o.getJointPose(J,u);if(M.joints[J.jointName]===void 0){const te=new Xh;te.matrixAutoUpdate=!1,te.visible=!1,M.joints[J.jointName]=te,M.add(te)}const pe=M.joints[J.jointName];me!==null&&(pe.matrix.fromArray(me.transform.matrix),pe.matrix.decompose(pe.position,pe.rotation,pe.scale),pe.jointRadius=me.radius),pe.visible=me!==null}const I=M.joints["index-finger-tip"],z=M.joints["thumb-tip"],U=I.position.distanceTo(z.position),G=.02,W=.005;M.inputState.pinching&&U>G+W?(M.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:l.handedness,target:this})):!M.inputState.pinching&&U<=G-W&&(M.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:l.handedness,target:this}))}else T!==null&&(f=o.getPose(l.targetRaySpace,u),f!==null&&(T.matrix.fromArray(f.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale))),w!==null&&l.gripSpace&&(g=o.getPose(l.gripSpace,u),g!==null&&(w.matrix.fromArray(g.transform.matrix),w.matrix.decompose(w.position,w.rotation,w.scale)));return T!==null&&(T.visible=f!==null),w!==null&&(w.visible=g!==null),M!==null&&(M.visible=y!==null),this}});function S1(l,o){const u=this;let f=null,g=1,y=null,T="local-floor",w=null;const M=[],I=new Map,z=new fr;z.layers.enable(1),z.viewport=new Yn;const U=new fr;U.layers.enable(2),U.viewport=new Yn;const G=[z,U],W=new uy;W.layers.enable(1),W.layers.enable(2);let J=null,me=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(It){let Pt=M[It];return Pt===void 0&&(Pt=new lm,M[It]=Pt),Pt.getTargetRaySpace()},this.getControllerGrip=function(It){let Pt=M[It];return Pt===void 0&&(Pt=new lm,M[It]=Pt),Pt.getGripSpace()},this.getHand=function(It){let Pt=M[It];return Pt===void 0&&(Pt=new lm,M[It]=Pt),Pt.getHandSpace()};function pe(It){const Pt=I.get(It.inputSource);Pt&&Pt.dispatchEvent({type:It.type,data:It.inputSource})}function te(){I.forEach(function(It,Pt){It.disconnect(Pt)}),I.clear(),J=null,me=null,l.setFramebuffer(null),l.setRenderTarget(l.getRenderTarget()),wt.stop(),u.isPresenting=!1,u.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(It){g=It,u.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(It){T=It,u.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return y},this.getSession=function(){return f},this.setSession=function(){var It=ae(function*(Pt){if(f=Pt,f!==null){f.addEventListener("select",pe),f.addEventListener("selectstart",pe),f.addEventListener("selectend",pe),f.addEventListener("squeeze",pe),f.addEventListener("squeezestart",pe),f.addEventListener("squeezeend",pe),f.addEventListener("end",te),f.addEventListener("inputsourceschange",K);const Nt=o.getContextAttributes();Nt.xrCompatible!==!0&&(yield o.makeXRCompatible());const nt={antialias:Nt.antialias,alpha:Nt.alpha,depth:Nt.depth,stencil:Nt.stencil,framebufferScaleFactor:g},Ke=new XRWebGLLayer(f,o,nt);f.updateRenderState({baseLayer:Ke}),y=yield f.requestReferenceSpace(T),wt.setContext(f),wt.start(),u.isPresenting=!0,u.dispatchEvent({type:"sessionstart"})}});return function(Pt){return It.apply(this,arguments)}}();function K(It){const Pt=f.inputSources;for(let Nt=0;Nt<M.length;Nt++)I.set(Pt[Nt],M[Nt]);for(let Nt=0;Nt<It.removed.length;Nt++){const nt=It.removed[Nt],Ke=I.get(nt);Ke&&(Ke.dispatchEvent({type:"disconnected",data:nt}),I.delete(nt))}for(let Nt=0;Nt<It.added.length;Nt++){const nt=It.added[Nt],Ke=I.get(nt);Ke&&Ke.dispatchEvent({type:"connected",data:nt})}}const He=new Be,$e=new Be;function Ue(It,Pt,Nt){He.setFromMatrixPosition(Pt.matrixWorld),$e.setFromMatrixPosition(Nt.matrixWorld);const nt=He.distanceTo($e),Ke=Pt.projectionMatrix.elements,st=Nt.projectionMatrix.elements,Ct=Ke[14]/(Ke[10]-1),Xt=Ke[14]/(Ke[10]+1),ti=(Ke[9]+1)/Ke[5],ni=(Ke[9]-1)/Ke[5],Ai=(Ke[8]-1)/Ke[0],_i=(st[8]+1)/st[0],on=Ct*Ai,vn=Ct*_i,Pn=nt/(-Ai+_i),Kt=Pn*-Ai;Pt.matrixWorld.decompose(It.position,It.quaternion,It.scale),It.translateX(Kt),It.translateZ(Pn),It.matrixWorld.compose(It.position,It.quaternion,It.scale),It.matrixWorldInverse.copy(It.matrixWorld).invert();const ua=Ct+Pn,mn=Xt+Pn,Wn=on-Kt,yn=vn+(nt-Kt),pr=ti*Xt/mn*ua,Sn=ni*Xt/mn*ua;It.projectionMatrix.makePerspective(Wn,yn,pr,Sn,ua,mn)}function Ae(It,Pt){Pt===null?It.matrixWorld.copy(It.matrix):It.matrixWorld.multiplyMatrices(Pt.matrixWorld,It.matrix),It.matrixWorldInverse.copy(It.matrixWorld).invert()}this.getCamera=function(It){W.near=U.near=z.near=It.near,W.far=U.far=z.far=It.far,(J!==W.near||me!==W.far)&&(f.updateRenderState({depthNear:W.near,depthFar:W.far}),J=W.near,me=W.far);const Pt=It.parent,Nt=W.cameras;Ae(W,Pt);for(let Ke=0;Ke<Nt.length;Ke++)Ae(Nt[Ke],Pt);It.matrixWorld.copy(W.matrixWorld),It.matrix.copy(W.matrix),It.matrix.decompose(It.position,It.quaternion,It.scale);const nt=It.children;for(let Ke=0,st=nt.length;Ke<st;Ke++)nt[Ke].updateMatrixWorld(!0);return Nt.length===2?Ue(W,z,U):W.projectionMatrix.copy(z.projectionMatrix),W};let at=null;function Ht(It,Pt){if(w=Pt.getViewerPose(y),w!==null){const nt=w.views,Ke=f.renderState.baseLayer;l.setFramebuffer(Ke.framebuffer);let st=!1;nt.length!==W.cameras.length&&(W.cameras.length=0,st=!0);for(let Ct=0;Ct<nt.length;Ct++){const Xt=nt[Ct],ti=Ke.getViewport(Xt),ni=G[Ct];ni.matrix.fromArray(Xt.transform.matrix),ni.projectionMatrix.fromArray(Xt.projectionMatrix),ni.viewport.set(ti.x,ti.y,ti.width,ti.height),Ct===0&&W.matrix.copy(ni.matrix),st===!0&&W.cameras.push(ni)}}const Nt=f.inputSources;for(let nt=0;nt<M.length;nt++){const Ke=M[nt],st=Nt[nt];Ke.update(st,Pt,y)}at&&at(It,Pt)}const wt=new Zo;wt.setAnimationLoop(Ht),this.setAnimationLoop=function(It){at=It},this.dispose=function(){}}X(S1.prototype,ks.prototype);function A1(l){function o(te,K){te.fogColor.value.copy(K.color),K.isFog?(te.fogNear.value=K.near,te.fogFar.value=K.far):K.isFogExp2&&(te.fogDensity.value=K.density)}function u(te,K,He,$e){K.isMeshBasicMaterial?f(te,K):K.isMeshLambertMaterial?(f(te,K),M(te,K)):K.isMeshToonMaterial?(f(te,K),z(te,K)):K.isMeshPhongMaterial?(f(te,K),I(te,K)):K.isMeshStandardMaterial?(f(te,K),K.isMeshPhysicalMaterial?G(te,K):U(te,K)):K.isMeshMatcapMaterial?(f(te,K),W(te,K)):K.isMeshDepthMaterial?(f(te,K),J(te,K)):K.isMeshDistanceMaterial?(f(te,K),me(te,K)):K.isMeshNormalMaterial?(f(te,K),pe(te,K)):K.isLineBasicMaterial?(g(te,K),K.isLineDashedMaterial&&y(te,K)):K.isPointsMaterial?T(te,K,He,$e):K.isSpriteMaterial?w(te,K):K.isShadowMaterial?(te.color.value.copy(K.color),te.opacity.value=K.opacity):K.isShaderMaterial&&(K.uniformsNeedUpdate=!1)}function f(te,K){te.opacity.value=K.opacity,K.color&&te.diffuse.value.copy(K.color),K.emissive&&te.emissive.value.copy(K.emissive).multiplyScalar(K.emissiveIntensity),K.map&&(te.map.value=K.map),K.alphaMap&&(te.alphaMap.value=K.alphaMap),K.specularMap&&(te.specularMap.value=K.specularMap);const He=l.get(K).envMap;if(He){te.envMap.value=He,te.flipEnvMap.value=He.isCubeTexture&&He._needsFlipEnvMap?-1:1,te.reflectivity.value=K.reflectivity,te.refractionRatio.value=K.refractionRatio;const Ae=l.get(He).__maxMipLevel;Ae!==void 0&&(te.maxMipLevel.value=Ae)}K.lightMap&&(te.lightMap.value=K.lightMap,te.lightMapIntensity.value=K.lightMapIntensity),K.aoMap&&(te.aoMap.value=K.aoMap,te.aoMapIntensity.value=K.aoMapIntensity);let $e;K.map?$e=K.map:K.specularMap?$e=K.specularMap:K.displacementMap?$e=K.displacementMap:K.normalMap?$e=K.normalMap:K.bumpMap?$e=K.bumpMap:K.roughnessMap?$e=K.roughnessMap:K.metalnessMap?$e=K.metalnessMap:K.alphaMap?$e=K.alphaMap:K.emissiveMap?$e=K.emissiveMap:K.clearcoatMap?$e=K.clearcoatMap:K.clearcoatNormalMap?$e=K.clearcoatNormalMap:K.clearcoatRoughnessMap&&($e=K.clearcoatRoughnessMap),$e!==void 0&&($e.isWebGLRenderTarget&&($e=$e.texture),$e.matrixAutoUpdate===!0&&$e.updateMatrix(),te.uvTransform.value.copy($e.matrix));let Ue;K.aoMap?Ue=K.aoMap:K.lightMap&&(Ue=K.lightMap),Ue!==void 0&&(Ue.isWebGLRenderTarget&&(Ue=Ue.texture),Ue.matrixAutoUpdate===!0&&Ue.updateMatrix(),te.uv2Transform.value.copy(Ue.matrix))}function g(te,K){te.diffuse.value.copy(K.color),te.opacity.value=K.opacity}function y(te,K){te.dashSize.value=K.dashSize,te.totalSize.value=K.dashSize+K.gapSize,te.scale.value=K.scale}function T(te,K,He,$e){te.diffuse.value.copy(K.color),te.opacity.value=K.opacity,te.size.value=K.size*He,te.scale.value=$e*.5,K.map&&(te.map.value=K.map),K.alphaMap&&(te.alphaMap.value=K.alphaMap);let Ue;K.map?Ue=K.map:K.alphaMap&&(Ue=K.alphaMap),Ue!==void 0&&(Ue.matrixAutoUpdate===!0&&Ue.updateMatrix(),te.uvTransform.value.copy(Ue.matrix))}function w(te,K){te.diffuse.value.copy(K.color),te.opacity.value=K.opacity,te.rotation.value=K.rotation,K.map&&(te.map.value=K.map),K.alphaMap&&(te.alphaMap.value=K.alphaMap);let He;K.map?He=K.map:K.alphaMap&&(He=K.alphaMap),He!==void 0&&(He.matrixAutoUpdate===!0&&He.updateMatrix(),te.uvTransform.value.copy(He.matrix))}function M(te,K){K.emissiveMap&&(te.emissiveMap.value=K.emissiveMap)}function I(te,K){te.specular.value.copy(K.specular),te.shininess.value=Math.max(K.shininess,1e-4),K.emissiveMap&&(te.emissiveMap.value=K.emissiveMap),K.bumpMap&&(te.bumpMap.value=K.bumpMap,te.bumpScale.value=K.bumpScale,K.side===De&&(te.bumpScale.value*=-1)),K.normalMap&&(te.normalMap.value=K.normalMap,te.normalScale.value.copy(K.normalScale),K.side===De&&te.normalScale.value.negate()),K.displacementMap&&(te.displacementMap.value=K.displacementMap,te.displacementScale.value=K.displacementScale,te.displacementBias.value=K.displacementBias)}function z(te,K){K.gradientMap&&(te.gradientMap.value=K.gradientMap),K.emissiveMap&&(te.emissiveMap.value=K.emissiveMap),K.bumpMap&&(te.bumpMap.value=K.bumpMap,te.bumpScale.value=K.bumpScale,K.side===De&&(te.bumpScale.value*=-1)),K.normalMap&&(te.normalMap.value=K.normalMap,te.normalScale.value.copy(K.normalScale),K.side===De&&te.normalScale.value.negate()),K.displacementMap&&(te.displacementMap.value=K.displacementMap,te.displacementScale.value=K.displacementScale,te.displacementBias.value=K.displacementBias)}function U(te,K){te.roughness.value=K.roughness,te.metalness.value=K.metalness,K.roughnessMap&&(te.roughnessMap.value=K.roughnessMap),K.metalnessMap&&(te.metalnessMap.value=K.metalnessMap),K.emissiveMap&&(te.emissiveMap.value=K.emissiveMap),K.bumpMap&&(te.bumpMap.value=K.bumpMap,te.bumpScale.value=K.bumpScale,K.side===De&&(te.bumpScale.value*=-1)),K.normalMap&&(te.normalMap.value=K.normalMap,te.normalScale.value.copy(K.normalScale),K.side===De&&te.normalScale.value.negate()),K.displacementMap&&(te.displacementMap.value=K.displacementMap,te.displacementScale.value=K.displacementScale,te.displacementBias.value=K.displacementBias),l.get(K).envMap&&(te.envMapIntensity.value=K.envMapIntensity)}function G(te,K){U(te,K),te.reflectivity.value=K.reflectivity,te.clearcoat.value=K.clearcoat,te.clearcoatRoughness.value=K.clearcoatRoughness,K.sheen&&te.sheen.value.copy(K.sheen),K.clearcoatMap&&(te.clearcoatMap.value=K.clearcoatMap),K.clearcoatRoughnessMap&&(te.clearcoatRoughnessMap.value=K.clearcoatRoughnessMap),K.clearcoatNormalMap&&(te.clearcoatNormalScale.value.copy(K.clearcoatNormalScale),te.clearcoatNormalMap.value=K.clearcoatNormalMap,K.side===De&&te.clearcoatNormalScale.value.negate()),te.transmission.value=K.transmission,K.transmissionMap&&(te.transmissionMap.value=K.transmissionMap)}function W(te,K){K.matcap&&(te.matcap.value=K.matcap),K.bumpMap&&(te.bumpMap.value=K.bumpMap,te.bumpScale.value=K.bumpScale,K.side===De&&(te.bumpScale.value*=-1)),K.normalMap&&(te.normalMap.value=K.normalMap,te.normalScale.value.copy(K.normalScale),K.side===De&&te.normalScale.value.negate()),K.displacementMap&&(te.displacementMap.value=K.displacementMap,te.displacementScale.value=K.displacementScale,te.displacementBias.value=K.displacementBias)}function J(te,K){K.displacementMap&&(te.displacementMap.value=K.displacementMap,te.displacementScale.value=K.displacementScale,te.displacementBias.value=K.displacementBias)}function me(te,K){K.displacementMap&&(te.displacementMap.value=K.displacementMap,te.displacementScale.value=K.displacementScale,te.displacementBias.value=K.displacementBias),te.referencePosition.value.copy(K.referencePosition),te.nearDistance.value=K.nearDistance,te.farDistance.value=K.farDistance}function pe(te,K){K.bumpMap&&(te.bumpMap.value=K.bumpMap,te.bumpScale.value=K.bumpScale,K.side===De&&(te.bumpScale.value*=-1)),K.normalMap&&(te.normalMap.value=K.normalMap,te.normalScale.value.copy(K.normalScale),K.side===De&&te.normalScale.value.negate()),K.displacementMap&&(te.displacementMap.value=K.displacementMap,te.displacementScale.value=K.displacementScale,te.displacementBias.value=K.displacementBias)}return{refreshFogUniforms:o,refreshMaterialUniforms:u}}function w1(){const l=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return l.style.display="block",l}function um(l){l=l||{};const o=l.canvas!==void 0?l.canvas:w1(),u=l.context!==void 0?l.context:null,f=l.alpha!==void 0?l.alpha:!1,g=l.depth!==void 0?l.depth:!0,y=l.stencil!==void 0?l.stencil:!0,T=l.antialias!==void 0?l.antialias:!1,w=l.premultipliedAlpha!==void 0?l.premultipliedAlpha:!0,M=l.preserveDrawingBuffer!==void 0?l.preserveDrawingBuffer:!1,I=l.powerPreference!==void 0?l.powerPreference:"default",z=l.failIfMajorPerformanceCaveat!==void 0?l.failIfMajorPerformanceCaveat:!1;let U=null,G=null;const W=[];this.domElement=o,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Ml,this.physicallyCorrectLights=!1,this.toneMapping=js,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const J=this;let me=!1,pe=null,te=0,K=0,He=null,$e=null,Ue=-1,Ae=null;const at=new Yn,Ht=new Yn;let wt=null,It=o.width,Pt=o.height,Nt=1,nt=null,Ke=null;const st=new Yn(0,0,It,Pt),Ct=new Yn(0,0,It,Pt);let Xt=!1;const ti=new Bh;let ni=!1,Ai=!1;const _i=new fn,on=new Be,vn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Pn(){return He===null?Nt:1}let Kt=u;function ua(Pe,Ut){for(let Mt=0;Mt<Pe.length;Mt++){const Wt=Pe[Mt],Di=o.getContext(Wt,Ut);if(Di!==null)return Di}return null}try{const Pe={alpha:f,depth:g,stencil:y,antialias:T,premultipliedAlpha:w,preserveDrawingBuffer:M,powerPreference:I,failIfMajorPerformanceCaveat:z};if(o.addEventListener("webglcontextlost",ms,!1),o.addEventListener("webglcontextrestored",Lo,!1),Kt===null){const Ut=["webgl2","webgl","experimental-webgl"];if(J.isWebGL1Renderer===!0&&Ut.shift(),Kt=ua(Ut,Pe),Kt===null)throw ua(Ut)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Kt.getShaderPrecisionFormat===void 0&&(Kt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Pe){throw console.error("THREE.WebGLRenderer: "+Pe.message),Pe}let mn,Wn,yn,pr,Sn,li,gi,Ti,mt,oi,Ie,we,qt,$t,We,zt,Ei,ji,Si,Vi,Ii;function An(){mn=new Zb(Kt),Wn=new Qb(Kt,mn,l),mn.init(Wn),Vi=new ws(Kt,mn,Wn),yn=new np(Kt,mn,Wn),yn.scissor(Ht.copy(Ct).multiplyScalar(Nt).floor()),yn.viewport(at.copy(st).multiplyScalar(Nt).floor()),pr=new e1,Sn=new GS,li=new x1(Kt,mn,yn,Sn,Wn,Vi,pr),gi=new Gv(J),Ti=new Bl(Kt,Wn),Ii=new Xb(Kt,mn,Ti,Wn),mt=new $v(Kt,Ti,pr,Ii),oi=new Xv(Kt,mt,Ti,pr),Ei=new t1(Kt),We=new Kb(Sn),Ie=new ay(J,gi,mn,Wn,Ii,We),we=new A1(Sn),qt=new Gh(Sn),$t=new $S(mn,Wn),zt=new qb(J,gi,yn,oi,w),ji=new Yb(Kt,mn,pr,Wn),Si=new Jb(Kt,mn,pr,Wn),pr.programs=Ie.programs,J.capabilities=Wn,J.extensions=mn,J.properties=Sn,J.renderLists=qt,J.state=yn,J.info=pr}An();const zi=new S1(J,Kt);this.xr=zi;const hn=new T1(J,oi,Wn.maxTextureSize);this.shadowMap=hn,this.getContext=function(){return Kt},this.getContextAttributes=function(){return Kt.getContextAttributes()},this.forceContextLoss=function(){const Pe=mn.get("WEBGL_lose_context");Pe&&Pe.loseContext()},this.forceContextRestore=function(){const Pe=mn.get("WEBGL_lose_context");Pe&&Pe.restoreContext()},this.getPixelRatio=function(){return Nt},this.setPixelRatio=function(Pe){Pe!==void 0&&(Nt=Pe,this.setSize(It,Pt,!1))},this.getSize=function(Pe){return Pe===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),Pe=new At),Pe.set(It,Pt)},this.setSize=function(Pe,Ut,Mt){if(zi.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}It=Pe,Pt=Ut,o.width=Math.floor(Pe*Nt),o.height=Math.floor(Ut*Nt),Mt!==!1&&(o.style.width=Pe+"px",o.style.height=Ut+"px"),this.setViewport(0,0,Pe,Ut)},this.getDrawingBufferSize=function(Pe){return Pe===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),Pe=new At),Pe.set(It*Nt,Pt*Nt).floor()},this.setDrawingBufferSize=function(Pe,Ut,Mt){It=Pe,Pt=Ut,Nt=Mt,o.width=Math.floor(Pe*Mt),o.height=Math.floor(Ut*Mt),this.setViewport(0,0,Pe,Ut)},this.getCurrentViewport=function(Pe){return Pe===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),Pe=new Yn),Pe.copy(at)},this.getViewport=function(Pe){return Pe.copy(st)},this.setViewport=function(Pe,Ut,Mt,Wt){Pe.isVector4?st.set(Pe.x,Pe.y,Pe.z,Pe.w):st.set(Pe,Ut,Mt,Wt),yn.viewport(at.copy(st).multiplyScalar(Nt).floor())},this.getScissor=function(Pe){return Pe.copy(Ct)},this.setScissor=function(Pe,Ut,Mt,Wt){Pe.isVector4?Ct.set(Pe.x,Pe.y,Pe.z,Pe.w):Ct.set(Pe,Ut,Mt,Wt),yn.scissor(Ht.copy(Ct).multiplyScalar(Nt).floor())},this.getScissorTest=function(){return Xt},this.setScissorTest=function(Pe){yn.setScissorTest(Xt=Pe)},this.setOpaqueSort=function(Pe){nt=Pe},this.setTransparentSort=function(Pe){Ke=Pe},this.getClearColor=function(Pe){return Pe===void 0&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),Pe=new Fi),Pe.copy(zt.getClearColor())},this.setClearColor=function(){zt.setClearColor.apply(zt,arguments)},this.getClearAlpha=function(){return zt.getClearAlpha()},this.setClearAlpha=function(){zt.setClearAlpha.apply(zt,arguments)},this.clear=function(Pe,Ut,Mt){let Wt=0;(Pe===void 0||Pe)&&(Wt|=16384),(Ut===void 0||Ut)&&(Wt|=256),(Mt===void 0||Mt)&&(Wt|=1024),Kt.clear(Wt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){o.removeEventListener("webglcontextlost",ms,!1),o.removeEventListener("webglcontextrestored",Lo,!1),qt.dispose(),$t.dispose(),Sn.dispose(),gi.dispose(),oi.dispose(),Ii.dispose(),zi.dispose(),vm.stop()};function ms(Pe){Pe.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),me=!0}function Lo(){console.log("THREE.WebGLRenderer: Context Restored."),me=!1,An()}function dp(Pe){const Ut=Pe.target;Ut.removeEventListener("dispose",dp),vA(Ut)}function vA(Pe){hp(Pe),Sn.remove(Pe)}function hp(Pe){const Ut=Sn.get(Pe).program;Ut!==void 0&&Ie.releaseProgram(Ut)}function rf(Pe,Ut){Pe.render(function(Mt){J.renderBufferImmediate(Mt,Ut)})}this.renderBufferImmediate=function(Pe,Ut){Ii.initAttributes();const Mt=Sn.get(Pe);Pe.hasPositions&&!Mt.position&&(Mt.position=Kt.createBuffer()),Pe.hasNormals&&!Mt.normal&&(Mt.normal=Kt.createBuffer()),Pe.hasUvs&&!Mt.uv&&(Mt.uv=Kt.createBuffer()),Pe.hasColors&&!Mt.color&&(Mt.color=Kt.createBuffer());const Wt=Ut.getAttributes();Pe.hasPositions&&(Kt.bindBuffer(34962,Mt.position),Kt.bufferData(34962,Pe.positionArray,35048),Ii.enableAttribute(Wt.position),Kt.vertexAttribPointer(Wt.position,3,5126,!1,0,0)),Pe.hasNormals&&(Kt.bindBuffer(34962,Mt.normal),Kt.bufferData(34962,Pe.normalArray,35048),Ii.enableAttribute(Wt.normal),Kt.vertexAttribPointer(Wt.normal,3,5126,!1,0,0)),Pe.hasUvs&&(Kt.bindBuffer(34962,Mt.uv),Kt.bufferData(34962,Pe.uvArray,35048),Ii.enableAttribute(Wt.uv),Kt.vertexAttribPointer(Wt.uv,2,5126,!1,0,0)),Pe.hasColors&&(Kt.bindBuffer(34962,Mt.color),Kt.bufferData(34962,Pe.colorArray,35048),Ii.enableAttribute(Wt.color),Kt.vertexAttribPointer(Wt.color,3,5126,!1,0,0)),Ii.disableUnusedAttributes(),Kt.drawArrays(4,0,Pe.count),Pe.count=0},this.renderBufferDirect=function(Pe,Ut,Mt,Wt,Di,ir){Ut===null&&(Ut=vn);const Vn=Di.isMesh&&Di.matrixWorld.determinant()<0,lr=H1(Pe,Ut,Wt,Di);yn.setMaterial(Wt,Vn);let zn=Mt.index;const Ys=Mt.attributes.position;if(zn===null){if(Ys===void 0||Ys.count===0)return}else if(zn.count===0)return;let Ns=1;Wt.wireframe===!0&&(zn=mt.getWireframeAttribute(Mt),Ns=2),(Wt.morphTargets||Wt.morphNormals)&&Ei.update(Di,Mt,Wt,lr),Ii.setup(Di,Wt,lr,Mt,zn);let Ln,Or=ji;zn!==null&&(Ln=Ti.get(zn),Or=Si,Or.setIndex(Ln));const zc=zn!==null?zn.count:Ys.count,Jr=Mt.drawRange.start*Ns,Cr=Mt.drawRange.count*Ns,ya=ir!==null?ir.start*Ns:0,fp=ir!==null?ir.count*Ns:1/0,Tr=Math.max(Jr,ya),H=Math.min(zc,Jr+Cr,ya+fp)-1,q=Math.max(0,H-Tr+1);if(q!==0){if(Di.isMesh)Wt.wireframe===!0?(yn.setLineWidth(Wt.wireframeLinewidth*Pn()),Or.setMode(1)):Or.setMode(4);else if(Di.isLine){let se=Wt.linewidth;se===void 0&&(se=1),yn.setLineWidth(se*Pn()),Di.isLineSegments?Or.setMode(1):Di.isLineLoop?Or.setMode(2):Or.setMode(3)}else Di.isPoints?Or.setMode(0):Di.isSprite&&Or.setMode(4);if(Di.isInstancedMesh)Or.renderInstances(Tr,q,Di.count);else if(Mt.isInstancedBufferGeometry){const se=Math.min(Mt.instanceCount,Mt._maxInstanceCount);Or.renderInstances(Tr,q,se)}else Or.render(Tr,q)}},this.compile=function(Pe,Ut){G=$t.get(Pe),G.init(),Pe.traverseVisible(function(Wt){Wt.isLight&&Wt.layers.test(Ut.layers)&&(G.pushLight(Wt),Wt.castShadow&&G.pushShadow(Wt))}),G.setupLights();const Mt=new WeakMap;Pe.traverse(function(Wt){const Di=Wt.material;if(Di)if(Array.isArray(Di))for(let ir=0;ir<Di.length;ir++){const Vn=Di[ir];Mt.has(Vn)===!1&&(Vc(Vn,Pe,Wt),Mt.set(Vn))}else Mt.has(Di)===!1&&(Vc(Di,Pe,Wt),Mt.set(Di))})};let Ng=null;function Hl(Pe){zi.isPresenting||Ng&&Ng(Pe)}const vm=new Zo;vm.setAnimationLoop(Hl),typeof window<"u"&&vm.setContext(window),this.setAnimationLoop=function(Pe){Ng=Pe,zi.setAnimationLoop(Pe),Pe===null?vm.stop():vm.start()},this.render=function(Pe,Ut){let Mt,Wt;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),Mt=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),Wt=arguments[3]),Ut!==void 0&&Ut.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(me===!0)return;Ii.resetDefaultState(),Ue=-1,Ae=null,Pe.autoUpdate===!0&&Pe.updateMatrixWorld(),Ut.parent===null&&Ut.updateMatrixWorld(),zi.enabled===!0&&zi.isPresenting===!0&&(Ut=zi.getCamera(Ut)),Pe.isScene===!0&&Pe.onBeforeRender(J,Pe,Ut,Mt||He),G=$t.get(Pe,W.length),G.init(),W.push(G),_i.multiplyMatrices(Ut.projectionMatrix,Ut.matrixWorldInverse),ti.setFromProjectionMatrix(_i),Ai=this.localClippingEnabled,ni=We.init(this.clippingPlanes,Ai,Ut),U=qt.get(Pe,Ut),U.init(),V1(Pe,Ut,0,J.sortObjects),U.finish(),J.sortObjects===!0&&U.sort(nt,Ke),ni===!0&&We.beginShadows();const Di=G.state.shadowsArray;hn.render(Di,Pe,Ut),G.setupLights(),G.setupLightsView(Ut),ni===!0&&We.endShadows(),this.info.autoReset===!0&&this.info.reset(),Mt!==void 0&&this.setRenderTarget(Mt),zt.render(U,Pe,Ut,Wt);const ir=U.opaque,Vn=U.transparent;ir.length>0&&z1(ir,Pe,Ut),Vn.length>0&&z1(Vn,Pe,Ut),Pe.isScene===!0&&Pe.onAfterRender(J,Pe,Ut),He!==null&&(li.updateRenderTargetMipmap(He),li.updateMultisampleRenderTarget(He)),yn.buffers.depth.setTest(!0),yn.buffers.depth.setMask(!0),yn.buffers.color.setMask(!0),yn.setPolygonOffset(!1),W.pop(),W.length>0?G=W[W.length-1]:G=null,U=null};function V1(Pe,Ut,Mt,Wt){if(Pe.visible===!1)return;if(Pe.layers.test(Ut.layers)){if(Pe.isGroup)Mt=Pe.renderOrder;else if(Pe.isLOD)Pe.autoUpdate===!0&&Pe.update(Ut);else if(Pe.isLight)G.pushLight(Pe),Pe.castShadow&&G.pushShadow(Pe);else if(Pe.isSprite){if(!Pe.frustumCulled||ti.intersectsSprite(Pe)){Wt&&on.setFromMatrixPosition(Pe.matrixWorld).applyMatrix4(_i);const Vn=oi.update(Pe),lr=Pe.material;lr.visible&&U.push(Pe,Vn,lr,Mt,on.z,null)}}else if(Pe.isImmediateRenderObject)Wt&&on.setFromMatrixPosition(Pe.matrixWorld).applyMatrix4(_i),U.push(Pe,null,Pe.material,Mt,on.z,null);else if((Pe.isMesh||Pe.isLine||Pe.isPoints)&&(Pe.isSkinnedMesh&&Pe.skeleton.frame!==pr.render.frame&&(Pe.skeleton.update(),Pe.skeleton.frame=pr.render.frame),!Pe.frustumCulled||ti.intersectsObject(Pe))){Wt&&on.setFromMatrixPosition(Pe.matrixWorld).applyMatrix4(_i);const Vn=oi.update(Pe),lr=Pe.material;if(Array.isArray(lr)){const zn=Vn.groups;for(let Ys=0,Ns=zn.length;Ys<Ns;Ys++){const Ln=zn[Ys],Or=lr[Ln.materialIndex];Or&&Or.visible&&U.push(Pe,Vn,Or,Mt,on.z,Ln)}}else lr.visible&&U.push(Pe,Vn,lr,Mt,on.z,null)}}const ir=Pe.children;for(let Vn=0,lr=ir.length;Vn<lr;Vn++)V1(ir[Vn],Ut,Mt,Wt)}function z1(Pe,Ut,Mt){const Wt=Ut.isScene===!0?Ut.overrideMaterial:null;for(let Di=0,ir=Pe.length;Di<ir;Di++){const Vn=Pe[Di],lr=Vn.object,zn=Vn.geometry,Ys=Wt===null?Vn.material:Wt,Ns=Vn.group;if(Mt.isArrayCamera){const Ln=Mt.cameras;for(let Or=0,zc=Ln.length;Or<zc;Or++){const Jr=Ln[Or];lr.layers.test(Jr.layers)&&(yn.viewport(at.copy(Jr.viewport)),G.setupLightsView(Jr),Ug(lr,Ut,Jr,zn,Ys,Ns))}}else Ug(lr,Ut,Mt,zn,Ys,Ns)}}function Ug(Pe,Ut,Mt,Wt,Di,ir){if(Pe.onBeforeRender(J,Ut,Mt,Wt,Di,ir),Pe.modelViewMatrix.multiplyMatrices(Mt.matrixWorldInverse,Pe.matrixWorld),Pe.normalMatrix.getNormalMatrix(Pe.modelViewMatrix),Pe.isImmediateRenderObject){const Vn=H1(Mt,Ut,Di,Pe);yn.setMaterial(Di),Ii.reset(),rf(Pe,Vn)}else J.renderBufferDirect(Mt,Ut,Wt,Di,Pe,ir);Pe.onAfterRender(J,Ut,Mt,Wt,Di,ir)}function Vc(Pe,Ut,Mt){Ut.isScene!==!0&&(Ut=vn);const Wt=Sn.get(Pe),Di=G.state.lights,ir=G.state.shadowsArray,Vn=Di.state.version,lr=Ie.getParameters(Pe,Di.state,ir,Ut,Mt),zn=Ie.getProgramCacheKey(lr);let Ys=Wt.program,Ns=!0;if(Wt.environment=Pe.isMeshStandardMaterial?Ut.environment:null,Wt.fog=Ut.fog,Wt.envMap=gi.get(Pe.envMap||Wt.environment),Ys===void 0)Pe.addEventListener("dispose",dp);else if(Ys.cacheKey!==zn)hp(Pe);else if(Wt.lightsStateVersion!==Vn)Ns=!1;else{if(lr.shaderID!==void 0)return;Ns=!1}Ns&&(lr.uniforms=Ie.getUniforms(Pe),Pe.onBeforeCompile(lr,J),Ys=Ie.acquireProgram(lr,zn),Wt.program=Ys,Wt.uniforms=lr.uniforms,Wt.outputEncoding=lr.outputEncoding);const Ln=Wt.uniforms;(!Pe.isShaderMaterial&&!Pe.isRawShaderMaterial||Pe.clipping===!0)&&(Wt.numClippingPlanes=We.numPlanes,Wt.numIntersection=We.numIntersection,Ln.clippingPlanes=We.uniform),Wt.needsLights=yA(Pe),Wt.lightsStateVersion=Vn,Wt.needsLights&&(Ln.ambientLightColor.value=Di.state.ambient,Ln.lightProbe.value=Di.state.probe,Ln.directionalLights.value=Di.state.directional,Ln.directionalLightShadows.value=Di.state.directionalShadow,Ln.spotLights.value=Di.state.spot,Ln.spotLightShadows.value=Di.state.spotShadow,Ln.rectAreaLights.value=Di.state.rectArea,Ln.ltc_1.value=Di.state.rectAreaLTC1,Ln.ltc_2.value=Di.state.rectAreaLTC2,Ln.pointLights.value=Di.state.point,Ln.pointLightShadows.value=Di.state.pointShadow,Ln.hemisphereLights.value=Di.state.hemi,Ln.directionalShadowMap.value=Di.state.directionalShadowMap,Ln.directionalShadowMatrix.value=Di.state.directionalShadowMatrix,Ln.spotShadowMap.value=Di.state.spotShadowMap,Ln.spotShadowMatrix.value=Di.state.spotShadowMatrix,Ln.pointShadowMap.value=Di.state.pointShadowMap,Ln.pointShadowMatrix.value=Di.state.pointShadowMatrix);const Or=Wt.program.getUniforms(),zc=os.seqWithValue(Or.seq,Ln);Wt.uniformsList=zc}function H1(Pe,Ut,Mt,Wt){Ut.isScene!==!0&&(Ut=vn),li.resetTextureUnits();const Di=Ut.fog,ir=Mt.isMeshStandardMaterial?Ut.environment:null,Vn=He===null?J.outputEncoding:He.texture.encoding,lr=gi.get(Mt.envMap||ir),zn=Sn.get(Mt),Ys=G.state.lights;if(ni===!0&&(Ai===!0||Pe!==Ae)){const ya=Pe===Ae&&Mt.id===Ue;We.setState(Mt,Pe,ya)}Mt.version===zn.__version?(Mt.fog&&zn.fog!==Di||zn.environment!==ir||zn.needsLights&&zn.lightsStateVersion!==Ys.state.version||zn.numClippingPlanes!==void 0&&(zn.numClippingPlanes!==We.numPlanes||zn.numIntersection!==We.numIntersection)||zn.outputEncoding!==Vn||zn.envMap!==lr)&&Vc(Mt,Ut,Wt):(Vc(Mt,Ut,Wt),zn.__version=Mt.version);let Ns=!1,Ln=!1,Or=!1;const zc=zn.program,Jr=zc.getUniforms(),Cr=zn.uniforms;if(yn.useProgram(zc.program)&&(Ns=!0,Ln=!0,Or=!0),Mt.id!==Ue&&(Ue=Mt.id,Ln=!0),Ns||Ae!==Pe){if(Jr.setValue(Kt,"projectionMatrix",Pe.projectionMatrix),Wn.logarithmicDepthBuffer&&Jr.setValue(Kt,"logDepthBufFC",2/(Math.log(Pe.far+1)/Math.LN2)),Ae!==Pe&&(Ae=Pe,Ln=!0,Or=!0),Mt.isShaderMaterial||Mt.isMeshPhongMaterial||Mt.isMeshToonMaterial||Mt.isMeshStandardMaterial||Mt.envMap){const ya=Jr.map.cameraPosition;ya!==void 0&&ya.setValue(Kt,on.setFromMatrixPosition(Pe.matrixWorld))}(Mt.isMeshPhongMaterial||Mt.isMeshToonMaterial||Mt.isMeshLambertMaterial||Mt.isMeshBasicMaterial||Mt.isMeshStandardMaterial||Mt.isShaderMaterial)&&Jr.setValue(Kt,"isOrthographic",Pe.isOrthographicCamera===!0),(Mt.isMeshPhongMaterial||Mt.isMeshToonMaterial||Mt.isMeshLambertMaterial||Mt.isMeshBasicMaterial||Mt.isMeshStandardMaterial||Mt.isShaderMaterial||Mt.isShadowMaterial||Mt.skinning)&&Jr.setValue(Kt,"viewMatrix",Pe.matrixWorldInverse)}if(Mt.skinning){Jr.setOptional(Kt,Wt,"bindMatrix"),Jr.setOptional(Kt,Wt,"bindMatrixInverse");const ya=Wt.skeleton;if(ya){const fp=ya.bones;if(Wn.floatVertexTextures){if(ya.boneTexture===null){let Tr=Math.sqrt(fp.length*4);Tr=Gi.ceilPowerOfTwo(Tr),Tr=Math.max(Tr,4);const H=new Float32Array(Tr*Tr*4);H.set(ya.boneMatrices);const q=new xu(H,Tr,Tr,cr,ln);ya.boneMatrices=H,ya.boneTexture=q,ya.boneTextureSize=Tr}Jr.setValue(Kt,"boneTexture",ya.boneTexture,li),Jr.setValue(Kt,"boneTextureSize",ya.boneTextureSize)}else Jr.setOptional(Kt,ya,"boneMatrices")}}return(Ln||zn.receiveShadow!==Wt.receiveShadow)&&(zn.receiveShadow=Wt.receiveShadow,Jr.setValue(Kt,"receiveShadow",Wt.receiveShadow)),Ln&&(Jr.setValue(Kt,"toneMappingExposure",J.toneMappingExposure),zn.needsLights&&sf(Cr,Or),Di&&Mt.fog&&we.refreshFogUniforms(Cr,Di),we.refreshMaterialUniforms(Cr,Mt,Nt,Pt),os.upload(Kt,zn.uniformsList,Cr,li)),Mt.isShaderMaterial&&Mt.uniformsNeedUpdate===!0&&(os.upload(Kt,zn.uniformsList,Cr,li),Mt.uniformsNeedUpdate=!1),Mt.isSpriteMaterial&&Jr.setValue(Kt,"center",Wt.center),Jr.setValue(Kt,"modelViewMatrix",Wt.modelViewMatrix),Jr.setValue(Kt,"normalMatrix",Wt.normalMatrix),Jr.setValue(Kt,"modelMatrix",Wt.matrixWorld),zc}function sf(Pe,Ut){Pe.ambientLightColor.needsUpdate=Ut,Pe.lightProbe.needsUpdate=Ut,Pe.directionalLights.needsUpdate=Ut,Pe.directionalLightShadows.needsUpdate=Ut,Pe.pointLights.needsUpdate=Ut,Pe.pointLightShadows.needsUpdate=Ut,Pe.spotLights.needsUpdate=Ut,Pe.spotLightShadows.needsUpdate=Ut,Pe.rectAreaLights.needsUpdate=Ut,Pe.hemisphereLights.needsUpdate=Ut}function yA(Pe){return Pe.isMeshLambertMaterial||Pe.isMeshToonMaterial||Pe.isMeshPhongMaterial||Pe.isMeshStandardMaterial||Pe.isShadowMaterial||Pe.isShaderMaterial&&Pe.lights===!0}this.setFramebuffer=function(Pe){pe!==Pe&&He===null&&Kt.bindFramebuffer(36160,Pe),pe=Pe},this.getActiveCubeFace=function(){return te},this.getActiveMipmapLevel=function(){return K},this.getRenderList=function(){return U},this.setRenderList=function(Pe){U=Pe},this.getRenderTarget=function(){return He},this.setRenderTarget=function(Pe,Ut=0,Mt=0){He=Pe,te=Ut,K=Mt,Pe&&Sn.get(Pe).__webglFramebuffer===void 0&&li.setupRenderTarget(Pe);let Wt=pe,Di=!1;if(Pe){const ir=Sn.get(Pe).__webglFramebuffer;Pe.isWebGLCubeRenderTarget?(Wt=ir[Ut],Di=!0):Pe.isWebGLMultisampleRenderTarget?Wt=Sn.get(Pe).__webglMultisampledFramebuffer:Wt=ir,at.copy(Pe.viewport),Ht.copy(Pe.scissor),wt=Pe.scissorTest}else at.copy(st).multiplyScalar(Nt).floor(),Ht.copy(Ct).multiplyScalar(Nt).floor(),wt=Xt;if($e!==Wt&&(Kt.bindFramebuffer(36160,Wt),$e=Wt),yn.viewport(at),yn.scissor(Ht),yn.setScissorTest(wt),Di){const ir=Sn.get(Pe.texture);Kt.framebufferTexture2D(36160,36064,34069+Ut,ir.__webglTexture,Mt)}},this.readRenderTargetPixels=function(Pe,Ut,Mt,Wt,Di,ir,Vn){if(!(Pe&&Pe.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let lr=Sn.get(Pe).__webglFramebuffer;if(Pe.isWebGLCubeRenderTarget&&Vn!==void 0&&(lr=lr[Vn]),lr){let zn=!1;lr!==$e&&(Kt.bindFramebuffer(36160,lr),zn=!0);try{const Ys=Pe.texture,Ns=Ys.format,Ln=Ys.type;if(Ns!==cr&&Vi.convert(Ns)!==Kt.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Or=Ln===Fa&&(mn.has("EXT_color_buffer_half_float")||Wn.isWebGL2&&mn.has("EXT_color_buffer_float"));if(Ln!==ur&&Vi.convert(Ln)!==Kt.getParameter(35738)&&!(Ln===ln&&(Wn.isWebGL2||mn.has("OES_texture_float")||mn.has("WEBGL_color_buffer_float")))&&!Or){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Kt.checkFramebufferStatus(36160)===36053?Ut>=0&&Ut<=Pe.width-Wt&&Mt>=0&&Mt<=Pe.height-Di&&Kt.readPixels(Ut,Mt,Wt,Di,Vi.convert(Ns),Vi.convert(Ln),ir):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{zn&&Kt.bindFramebuffer(36160,$e)}}},this.copyFramebufferToTexture=function(Pe,Ut,Mt=0){const Wt=Math.pow(2,-Mt),Di=Math.floor(Ut.image.width*Wt),ir=Math.floor(Ut.image.height*Wt),Vn=Vi.convert(Ut.format);li.setTexture2D(Ut,0),Kt.copyTexImage2D(3553,Mt,Vn,Pe.x,Pe.y,Di,ir,0),yn.unbindTexture()},this.copyTextureToTexture=function(Pe,Ut,Mt,Wt=0){const Di=Ut.image.width,ir=Ut.image.height,Vn=Vi.convert(Mt.format),lr=Vi.convert(Mt.type);li.setTexture2D(Mt,0),Kt.pixelStorei(37440,Mt.flipY),Kt.pixelStorei(37441,Mt.premultiplyAlpha),Kt.pixelStorei(3317,Mt.unpackAlignment),Ut.isDataTexture?Kt.texSubImage2D(3553,Wt,Pe.x,Pe.y,Di,ir,Vn,lr,Ut.image.data):Ut.isCompressedTexture?Kt.compressedTexSubImage2D(3553,Wt,Pe.x,Pe.y,Ut.mipmaps[0].width,Ut.mipmaps[0].height,Vn,Ut.mipmaps[0].data):Kt.texSubImage2D(3553,Wt,Pe.x,Pe.y,Vn,lr,Ut.image),Wt===0&&Mt.generateMipmaps&&Kt.generateMipmap(3553),yn.unbindTexture()},this.initTexture=function(Pe){li.setTexture2D(Pe,0),yn.unbindTexture()},this.resetState=function(){yn.reset(),Ii.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function nl(l){um.call(this,l)}nl.prototype=X(Object.create(um.prototype),{constructor:nl,isWebGL1Renderer:!0});class Eg extends Li{constructor(){super(),Object.defineProperty(this,"isScene",{value:!0}),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(o,u){return super.copy(o,u),o.background!==null&&(this.background=o.background.clone()),o.environment!==null&&(this.environment=o.environment.clone()),o.fog!==null&&(this.fog=o.fog.clone()),o.overrideMaterial!==null&&(this.overrideMaterial=o.overrideMaterial.clone()),this.autoUpdate=o.autoUpdate,this.matrixAutoUpdate=o.matrixAutoUpdate,this}toJSON(o){const u=super.toJSON(o);return this.background!==null&&(u.object.background=this.background.toJSON(o)),this.environment!==null&&(u.object.environment=this.environment.toJSON(o)),this.fog!==null&&(u.object.fog=this.fog.toJSON()),u}}function Vl(l,o){this.array=l,this.stride=o,this.count=l!==void 0?l.length/o:0,this.usage=fu,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Gi.generateUUID()}Object.defineProperty(Vl.prototype,"needsUpdate",{set:function(l){l===!0&&this.version++}}),X(Vl.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(l){return this.usage=l,this},copy:function(l){return this.array=new l.array.constructor(l.array),this.count=l.count,this.stride=l.stride,this.usage=l.usage,this},copyAt:function(l,o,u){l*=this.stride,u*=o.stride;for(let f=0,g=this.stride;f<g;f++)this.array[l+f]=o.array[u+f];return this},set:function(l,o=0){return this.array.set(l,o),this},clone:function(l){l.arrayBuffers===void 0&&(l.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Gi.generateUUID()),l.arrayBuffers[this.array.buffer._uuid]===void 0&&(l.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const o=new this.array.constructor(l.arrayBuffers[this.array.buffer._uuid]),u=new Vl(o,this.stride);return u.setUsage(this.usage),u},onUpload:function(l){return this.onUploadCallback=l,this},toJSON:function(l){return l.arrayBuffers===void 0&&(l.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Gi.generateUUID()),l.arrayBuffers[this.array.buffer._uuid]===void 0&&(l.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const Io=new Be;function lc(l,o,u,f){this.name="",this.data=l,this.itemSize=o,this.offset=u,this.normalized=f===!0}Object.defineProperties(lc.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(l){this.data.needsUpdate=l}}}),X(lc.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(l){for(let o=0,u=this.data.count;o<u;o++)Io.x=this.getX(o),Io.y=this.getY(o),Io.z=this.getZ(o),Io.applyMatrix4(l),this.setXYZ(o,Io.x,Io.y,Io.z);return this},setX:function(l,o){return this.data.array[l*this.data.stride+this.offset]=o,this},setY:function(l,o){return this.data.array[l*this.data.stride+this.offset+1]=o,this},setZ:function(l,o){return this.data.array[l*this.data.stride+this.offset+2]=o,this},setW:function(l,o){return this.data.array[l*this.data.stride+this.offset+3]=o,this},getX:function(l){return this.data.array[l*this.data.stride+this.offset]},getY:function(l){return this.data.array[l*this.data.stride+this.offset+1]},getZ:function(l){return this.data.array[l*this.data.stride+this.offset+2]},getW:function(l){return this.data.array[l*this.data.stride+this.offset+3]},setXY:function(l,o,u){return l=l*this.data.stride+this.offset,this.data.array[l+0]=o,this.data.array[l+1]=u,this},setXYZ:function(l,o,u,f){return l=l*this.data.stride+this.offset,this.data.array[l+0]=o,this.data.array[l+1]=u,this.data.array[l+2]=f,this},setXYZW:function(l,o,u,f,g){return l=l*this.data.stride+this.offset,this.data.array[l+0]=o,this.data.array[l+1]=u,this.data.array[l+2]=f,this.data.array[l+3]=g,this},clone:function(l){if(l===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const o=[];for(let u=0;u<this.count;u++){const f=u*this.data.stride+this.offset;for(let g=0;g<this.itemSize;g++)o.push(this.data.array[f+g])}return new pn(new this.array.constructor(o),this.itemSize,this.normalized)}else return l.interleavedBuffers===void 0&&(l.interleavedBuffers={}),l.interleavedBuffers[this.data.uuid]===void 0&&(l.interleavedBuffers[this.data.uuid]=this.data.clone(l)),new lc(l.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(l){if(l===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const o=[];for(let u=0;u<this.count;u++){const f=u*this.data.stride+this.offset;for(let g=0;g<this.itemSize;g++)o.push(this.data.array[f+g])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:o,normalized:this.normalized}}else return l.interleavedBuffers===void 0&&(l.interleavedBuffers={}),l.interleavedBuffers[this.data.uuid]===void 0&&(l.interleavedBuffers[this.data.uuid]=this.data.toJSON(l)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function rl(l){Ji.call(this),this.type="SpriteMaterial",this.color=new Fi(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(l)}rl.prototype=Object.create(Ji.prototype),rl.prototype.constructor=rl,rl.prototype.isSpriteMaterial=!0,rl.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.color.copy(l.color),this.map=l.map,this.alphaMap=l.alphaMap,this.rotation=l.rotation,this.sizeAttenuation=l.sizeAttenuation,this};let Fc;const Yh=new Be,Bd=new Be,rp=new Be,Nd=new At,cm=new At,cy=new fn,dm=new Be,Ud=new Be,Qh=new Be,dy=new At,hm=new At,E1=new At;function hy(l){if(Li.call(this),this.type="Sprite",Fc===void 0){Fc=new $n;const o=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),u=new Vl(o,5);Fc.setIndex([0,1,2,0,2,3]),Fc.setAttribute("position",new lc(u,3,0,!1)),Fc.setAttribute("uv",new lc(u,2,3,!1))}this.geometry=Fc,this.material=l!==void 0?l:new rl,this.center=new At(.5,.5)}hy.prototype=X(Object.create(Li.prototype),{constructor:hy,isSprite:!0,raycast:function(l,o){l.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Bd.setFromMatrixScale(this.matrixWorld),cy.copy(l.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(l.camera.matrixWorldInverse,this.matrixWorld),rp.setFromMatrixPosition(this.modelViewMatrix),l.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Bd.multiplyScalar(-rp.z);const u=this.material.rotation;let f,g;u!==0&&(g=Math.cos(u),f=Math.sin(u));const y=this.center;sp(dm.set(-.5,-.5,0),rp,y,Bd,f,g),sp(Ud.set(.5,-.5,0),rp,y,Bd,f,g),sp(Qh.set(.5,.5,0),rp,y,Bd,f,g),dy.set(0,0),hm.set(1,0),E1.set(1,1);let T=l.ray.intersectTriangle(dm,Ud,Qh,!1,Yh);if(T===null&&(sp(Ud.set(-.5,.5,0),rp,y,Bd,f,g),hm.set(0,1),T=l.ray.intersectTriangle(dm,Qh,Ud,!1,Yh),T===null))return;const w=l.ray.origin.distanceTo(Yh);w<l.near||w>l.far||o.push({distance:w,point:Yh.clone(),uv:ga.getUV(Yh,dm,Ud,Qh,dy,hm,E1,new At),face:null,object:this})},copy:function(l){return Li.prototype.copy.call(this,l),l.center!==void 0&&this.center.copy(l.center),this.material=l.material,this}});function sp(l,o,u,f,g,y){Nd.subVectors(l,u).addScalar(.5).multiply(f),g!==void 0?(cm.x=y*Nd.x-g*Nd.y,cm.y=g*Nd.x+y*Nd.y):cm.copy(Nd),l.copy(o),l.x+=cm.x,l.y+=cm.y,l.applyMatrix4(cy)}const Kh=new Be,Cg=new Be;function ap(){Li.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}ap.prototype=X(Object.create(Li.prototype),{constructor:ap,isLOD:!0,copy:function(l){Li.prototype.copy.call(this,l,!1);const o=l.levels;for(let u=0,f=o.length;u<f;u++){const g=o[u];this.addLevel(g.object.clone(),g.distance)}return this.autoUpdate=l.autoUpdate,this},addLevel:function(l,o=0){o=Math.abs(o);const u=this.levels;let f;for(f=0;f<u.length&&!(o<u[f].distance);f++);return u.splice(f,0,{distance:o,object:l}),this.add(l),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(l){const o=this.levels;if(o.length>0){let u,f;for(u=1,f=o.length;u<f&&!(l<o[u].distance);u++);return o[u-1].object}return null},raycast:function(l,o){if(this.levels.length>0){Kh.setFromMatrixPosition(this.matrixWorld);const f=l.ray.origin.distanceTo(Kh);this.getObjectForDistance(f).raycast(l,o)}},update:function(l){const o=this.levels;if(o.length>1){Kh.setFromMatrixPosition(l.matrixWorld),Cg.setFromMatrixPosition(this.matrixWorld);const u=Kh.distanceTo(Cg)/l.zoom;o[0].object.visible=!0;let f,g;for(f=1,g=o.length;f<g&&u>=o[f].distance;f++)o[f-1].object.visible=!1,o[f].object.visible=!0;for(this._currentLevel=f-1;f<g;f++)o[f].object.visible=!1}},toJSON:function(l){const o=Li.prototype.toJSON.call(this,l);this.autoUpdate===!1&&(o.object.autoUpdate=!1),o.object.levels=[];const u=this.levels;for(let f=0,g=u.length;f<g;f++){const y=u[f];o.object.levels.push({object:y.object.uuid,distance:y.distance})}return o}});const fy=new Be,C1=new Yn,fm=new Yn,WS=new Be,op=new fn;function py(l,o){l&&l.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Gt.call(this,l,o),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new fn,this.bindMatrixInverse=new fn}py.prototype=X(Object.create(Gt.prototype),{constructor:py,isSkinnedMesh:!0,copy:function(l){return Gt.prototype.copy.call(this,l),this.bindMode=l.bindMode,this.bindMatrix.copy(l.bindMatrix),this.bindMatrixInverse.copy(l.bindMatrixInverse),this.skeleton=l.skeleton,this},bind:function(l,o){this.skeleton=l,o===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),o=this.matrixWorld),this.bindMatrix.copy(o),this.bindMatrixInverse.copy(o).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const l=new Yn,o=this.geometry.attributes.skinWeight;for(let u=0,f=o.count;u<f;u++){l.x=o.getX(u),l.y=o.getY(u),l.z=o.getZ(u),l.w=o.getW(u);const g=1/l.manhattanLength();g!==1/0?l.multiplyScalar(g):l.set(1,0,0,0),o.setXYZW(u,l.x,l.y,l.z,l.w)}},updateMatrixWorld:function(l){Gt.prototype.updateMatrixWorld.call(this,l),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(l,o){const u=this.skeleton,f=this.geometry;C1.fromBufferAttribute(f.attributes.skinIndex,l),fm.fromBufferAttribute(f.attributes.skinWeight,l),fy.fromBufferAttribute(f.attributes.position,l).applyMatrix4(this.bindMatrix),o.set(0,0,0);for(let g=0;g<4;g++){const y=fm.getComponent(g);if(y!==0){const T=C1.getComponent(g);op.multiplyMatrices(u.bones[T].matrixWorld,u.boneInverses[T]),o.addScaledVector(WS.copy(fy).applyMatrix4(op),y)}}return o.applyMatrix4(this.bindMatrixInverse)}});function lp(){Li.call(this),this.type="Bone"}lp.prototype=X(Object.create(Li.prototype),{constructor:lp,isBone:!0});const d=new fn,p=new fn;function _(l=[],o=[]){this.uuid=Gi.generateUUID(),this.bones=l.slice(0),this.boneInverses=o,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}X(_.prototype,{init:function(){const l=this.bones,o=this.boneInverses;if(this.boneMatrices=new Float32Array(l.length*16),o.length===0)this.calculateInverses();else if(l.length!==o.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let u=0,f=this.bones.length;u<f;u++)this.boneInverses.push(new fn)}},calculateInverses:function(){this.boneInverses.length=0;for(let l=0,o=this.bones.length;l<o;l++){const u=new fn;this.bones[l]&&u.copy(this.bones[l].matrixWorld).invert(),this.boneInverses.push(u)}},pose:function(){for(let l=0,o=this.bones.length;l<o;l++){const u=this.bones[l];u&&u.matrixWorld.copy(this.boneInverses[l]).invert()}for(let l=0,o=this.bones.length;l<o;l++){const u=this.bones[l];u&&(u.parent&&u.parent.isBone?(u.matrix.copy(u.parent.matrixWorld).invert(),u.matrix.multiply(u.matrixWorld)):u.matrix.copy(u.matrixWorld),u.matrix.decompose(u.position,u.quaternion,u.scale))}},update:function(){const l=this.bones,o=this.boneInverses,u=this.boneMatrices,f=this.boneTexture;for(let g=0,y=l.length;g<y;g++){const T=l[g]?l[g].matrixWorld:p;d.multiplyMatrices(T,o[g]),d.toArray(u,g*16)}f!==null&&(f.needsUpdate=!0)},clone:function(){return new _(this.bones,this.boneInverses)},getBoneByName:function(l){for(let o=0,u=this.bones.length;o<u;o++){const f=this.bones[o];if(f.name===l)return f}},dispose:function(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(l,o){this.uuid=l.uuid;for(let u=0,f=l.bones.length;u<f;u++){const g=l.bones[u];let y=o[g];y===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",g),y=new lp),this.bones.push(y),this.boneInverses.push(new fn().fromArray(l.boneInverses[u]))}return this.init(),this},toJSON:function(){const l={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};l.uuid=this.uuid;const o=this.bones,u=this.boneInverses;for(let f=0,g=o.length;f<g;f++){const y=o[f];l.bones.push(y.uuid);const T=u[f];l.boneInverses.push(T.toArray())}return l}});const A=new fn,O=new fn,$=[],ce=new Gt;function Fe(l,o,u){Gt.call(this,l,o),this.instanceMatrix=new pn(new Float32Array(u*16),16),this.instanceColor=null,this.count=u,this.frustumCulled=!1}Fe.prototype=X(Object.create(Gt.prototype),{constructor:Fe,isInstancedMesh:!0,copy:function(l){return Gt.prototype.copy.call(this,l),this.instanceMatrix.copy(l.instanceMatrix),l.instanceColor!==null&&(this.instanceColor=l.instanceColor.clone()),this.count=l.count,this},getColorAt:function(l,o){o.fromArray(this.instanceColor.array,l*3)},getMatrixAt:function(l,o){o.fromArray(this.instanceMatrix.array,l*16)},raycast:function(l,o){const u=this.matrixWorld,f=this.count;if(ce.geometry=this.geometry,ce.material=this.material,ce.material!==void 0)for(let g=0;g<f;g++){this.getMatrixAt(g,A),O.multiplyMatrices(u,A),ce.matrixWorld=O,ce.raycast(l,$);for(let y=0,T=$.length;y<T;y++){const w=$[y];w.instanceId=g,w.object=this,o.push(w)}$.length=0}},setColorAt:function(l,o){this.instanceColor===null&&(this.instanceColor=new pn(new Float32Array(this.count*3),3)),o.toArray(this.instanceColor.array,l*3)},setMatrixAt:function(l,o){o.toArray(this.instanceMatrix.array,l*16)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});function ze(l){Ji.call(this),this.type="LineBasicMaterial",this.color=new Fi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(l)}ze.prototype=Object.create(Ji.prototype),ze.prototype.constructor=ze,ze.prototype.isLineBasicMaterial=!0,ze.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.color.copy(l.color),this.linewidth=l.linewidth,this.linecap=l.linecap,this.linejoin=l.linejoin,this.morphTargets=l.morphTargets,this};const Et=new Be,Jt=new Be,ai=new fn,Qt=new Yo,wi=new Rl;function Pi(l=new $n,o=new ze){Li.call(this),this.type="Line",this.geometry=l,this.material=o,this.updateMorphTargets()}Pi.prototype=X(Object.create(Li.prototype),{constructor:Pi,isLine:!0,copy:function(l){return Li.prototype.copy.call(this,l),this.material=l.material,this.geometry=l.geometry,this},computeLineDistances:function(){const l=this.geometry;if(l.isBufferGeometry)if(l.index===null){const o=l.attributes.position,u=[0];for(let f=1,g=o.count;f<g;f++)Et.fromBufferAttribute(o,f-1),Jt.fromBufferAttribute(o,f),u[f]=u[f-1],u[f]+=Et.distanceTo(Jt);l.setAttribute("lineDistance",new Xr(u,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else l.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(l,o){const u=this.geometry,f=this.matrixWorld,g=l.params.Line.threshold;if(u.boundingSphere===null&&u.computeBoundingSphere(),wi.copy(u.boundingSphere),wi.applyMatrix4(f),wi.radius+=g,l.ray.intersectsSphere(wi)===!1)return;ai.copy(f).invert(),Qt.copy(l.ray).applyMatrix4(ai);const y=g/((this.scale.x+this.scale.y+this.scale.z)/3),T=y*y,w=new Be,M=new Be,I=new Be,z=new Be,U=this.isLineSegments?2:1;if(u.isBufferGeometry){const G=u.index,J=u.attributes.position;if(G!==null){const me=G.array;for(let pe=0,te=me.length-1;pe<te;pe+=U){const K=me[pe],He=me[pe+1];if(w.fromBufferAttribute(J,K),M.fromBufferAttribute(J,He),Qt.distanceSqToSegment(w,M,z,I)>T)continue;z.applyMatrix4(this.matrixWorld);const Ue=l.ray.origin.distanceTo(z);Ue<l.near||Ue>l.far||o.push({distance:Ue,point:I.clone().applyMatrix4(this.matrixWorld),index:pe,face:null,faceIndex:null,object:this})}}else for(let me=0,pe=J.count-1;me<pe;me+=U){if(w.fromBufferAttribute(J,me),M.fromBufferAttribute(J,me+1),Qt.distanceSqToSegment(w,M,z,I)>T)continue;z.applyMatrix4(this.matrixWorld);const K=l.ray.origin.distanceTo(z);K<l.near||K>l.far||o.push({distance:K,point:I.clone().applyMatrix4(this.matrixWorld),index:me,face:null,faceIndex:null,object:this})}}else u.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){const l=this.geometry;if(l.isBufferGeometry){const o=l.morphAttributes,u=Object.keys(o);if(u.length>0){const f=o[u[0]];if(f!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let g=0,y=f.length;g<y;g++){const T=f[g].name||String(g);this.morphTargetInfluences.push(0),this.morphTargetDictionary[T]=g}}}}else{const o=l.morphTargets;o!==void 0&&o.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const Bi=new Be,Es=new Be;function gt(l,o){Pi.call(this,l,o),this.type="LineSegments"}gt.prototype=X(Object.create(Pi.prototype),{constructor:gt,isLineSegments:!0,computeLineDistances:function(){const l=this.geometry;if(l.isBufferGeometry)if(l.index===null){const o=l.attributes.position,u=[];for(let f=0,g=o.count;f<g;f+=2)Bi.fromBufferAttribute(o,f),Es.fromBufferAttribute(o,f+1),u[f]=f===0?0:u[f-1],u[f+1]=u[f]+Bi.distanceTo(Es);l.setAttribute("lineDistance",new Xr(u,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else l.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});function et(l,o){Pi.call(this,l,o),this.type="LineLoop"}et.prototype=X(Object.create(Pi.prototype),{constructor:et,isLineLoop:!0});function yt(l){Ji.call(this),this.type="PointsMaterial",this.color=new Fi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(l)}yt.prototype=Object.create(Ji.prototype),yt.prototype.constructor=yt,yt.prototype.isPointsMaterial=!0,yt.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.color.copy(l.color),this.map=l.map,this.alphaMap=l.alphaMap,this.size=l.size,this.sizeAttenuation=l.sizeAttenuation,this.morphTargets=l.morphTargets,this};const ci=new fn,Ni=new Yo,$i=new Rl,Wi=new Be;function un(l=new $n,o=new yt){Li.call(this),this.type="Points",this.geometry=l,this.material=o,this.updateMorphTargets()}un.prototype=X(Object.create(Li.prototype),{constructor:un,isPoints:!0,copy:function(l){return Li.prototype.copy.call(this,l),this.material=l.material,this.geometry=l.geometry,this},raycast:function(l,o){const u=this.geometry,f=this.matrixWorld,g=l.params.Points.threshold;if(u.boundingSphere===null&&u.computeBoundingSphere(),$i.copy(u.boundingSphere),$i.applyMatrix4(f),$i.radius+=g,l.ray.intersectsSphere($i)===!1)return;ci.copy(f).invert(),Ni.copy(l.ray).applyMatrix4(ci);const y=g/((this.scale.x+this.scale.y+this.scale.z)/3),T=y*y;if(u.isBufferGeometry){const w=u.index,I=u.attributes.position;if(w!==null){const z=w.array;for(let U=0,G=z.length;U<G;U++){const W=z[U];Wi.fromBufferAttribute(I,W),la(Wi,W,T,f,l,o,this)}}else for(let z=0,U=I.count;z<U;z++)Wi.fromBufferAttribute(I,z),la(Wi,z,T,f,l,o,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){const l=this.geometry;if(l.isBufferGeometry){const o=l.morphAttributes,u=Object.keys(o);if(u.length>0){const f=o[u[0]];if(f!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let g=0,y=f.length;g<y;g++){const T=f[g].name||String(g);this.morphTargetInfluences.push(0),this.morphTargetDictionary[T]=g}}}}else{const o=l.morphTargets;o!==void 0&&o.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function la(l,o,u,f,g,y,T){const w=Ni.distanceSqToPoint(l);if(w<u){const M=new Be;Ni.closestPointToPoint(l,M),M.applyMatrix4(f);const I=g.ray.origin.distanceTo(M);if(I<g.near||I>g.far)return;y.push({distance:I,distanceToRay:Math.sqrt(w),point:M,index:o,face:null,object:T})}}function hr(l,o,u,f,g,y,T,w,M){dr.call(this,l,o,u,f,g,y,T,w,M),this.format=T!==void 0?T:ta,this.minFilter=y!==void 0?y:Ui,this.magFilter=g!==void 0?g:Ui,this.generateMipmaps=!1;const I=this;function z(){I.needsUpdate=!0,l.requestVideoFrameCallback(z)}"requestVideoFrameCallback"in l&&l.requestVideoFrameCallback(z)}hr.prototype=X(Object.create(dr.prototype),{constructor:hr,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){const l=this.image;"requestVideoFrameCallback"in l===!1&&l.readyState>=l.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function zl(l,o,u,f,g,y,T,w,M,I,z,U){dr.call(this,null,y,T,w,M,I,f,g,z,U),this.image={width:o,height:u},this.mipmaps=l,this.flipY=!1,this.generateMipmaps=!1}zl.prototype=Object.create(dr.prototype),zl.prototype.constructor=zl,zl.prototype.isCompressedTexture=!0;function Mg(l,o,u,f,g,y,T,w,M){dr.call(this,l,o,u,f,g,y,T,w,M),this.needsUpdate=!0}Mg.prototype=Object.create(dr.prototype),Mg.prototype.constructor=Mg,Mg.prototype.isCanvasTexture=!0;function M1(l,o,u,f,g,y,T,w,M,I){if(I=I!==void 0?I:rr,I!==rr&&I!==zo)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");u===void 0&&I===rr&&(u=Ls),u===void 0&&I===zo&&(u=nn),dr.call(this,null,f,g,y,T,w,I,u,M),this.image={width:l,height:o},this.magFilter=T!==void 0?T:Ye,this.minFilter=w!==void 0?w:Ye,this.flipY=!1,this.generateMipmaps=!1}M1.prototype=Object.create(dr.prototype),M1.prototype.constructor=M1,M1.prototype.isDepthTexture=!0,new Be,new Be,new Be,new ga;const YB={triangulate:function(l,o,u){u=u||2;const f=o&&o.length,g=f?o[0]*u:l.length;let y=dM(l,0,g,u,!0);const T=[];if(!y||y.next===y.prev)return T;let w,M,I,z,U,G,W;if(f&&(y=eN(l,o,y,u)),l.length>80*u){w=I=l[0],M=z=l[1];for(let J=u;J<g;J+=u)U=l[J],G=l[J+1],U<w&&(w=U),G<M&&(M=G),U>I&&(I=U),G>z&&(z=G);W=Math.max(I-w,z-M),W=W!==0?1/W:0}return my(y,T,u,w,M,W),T}};function dM(l,o,u,f,g){let y,T;if(g===dN(l,o,u,f)>0)for(y=o;y<u;y+=f)T=pM(y,l[y],l[y+1],T);else for(y=u-f;y>=o;y-=f)T=pM(y,l[y],l[y+1],T);return T&&D1(T,T.next)&&(vy(T),T=T.next),T}function up(l,o){if(!l)return l;o||(o=l);let u=l,f;do if(f=!1,!u.steiner&&(D1(u,u.next)||Bs(u.prev,u,u.next)===0)){if(vy(u),u=o=u.prev,u===u.next)break;f=!0}else u=u.next;while(f||u!==o);return o}function my(l,o,u,f,g,y,T){if(!l)return;!T&&y&&sN(l,f,g,y);let w=l,M,I;for(;l.prev!==l.next;){if(M=l.prev,I=l.next,y?KB(l,f,g,y):QB(l)){o.push(M.i/u),o.push(l.i/u),o.push(I.i/u),vy(l),l=I.next,w=I.next;continue}if(l=I,l===w){T?T===1?(l=ZB(up(l),o,u),my(l,o,u,f,g,y,2)):T===2&&JB(l,o,u,f,g,y):my(up(l),o,u,f,g,y,1);break}}}function QB(l){const o=l.prev,u=l,f=l.next;if(Bs(o,u,f)>=0)return!1;let g=l.next.next;for(;g!==l.prev;){if(Dg(o.x,o.y,u.x,u.y,f.x,f.y,g.x,g.y)&&Bs(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function KB(l,o,u,f){const g=l.prev,y=l,T=l.next;if(Bs(g,y,T)>=0)return!1;const w=g.x<y.x?g.x<T.x?g.x:T.x:y.x<T.x?y.x:T.x,M=g.y<y.y?g.y<T.y?g.y:T.y:y.y<T.y?y.y:T.y,I=g.x>y.x?g.x>T.x?g.x:T.x:y.x>T.x?y.x:T.x,z=g.y>y.y?g.y>T.y?g.y:T.y:y.y>T.y?y.y:T.y,U=qS(w,M,o,u,f),G=qS(I,z,o,u,f);let W=l.prevZ,J=l.nextZ;for(;W&&W.z>=U&&J&&J.z<=G;){if(W!==l.prev&&W!==l.next&&Dg(g.x,g.y,y.x,y.y,T.x,T.y,W.x,W.y)&&Bs(W.prev,W,W.next)>=0||(W=W.prevZ,J!==l.prev&&J!==l.next&&Dg(g.x,g.y,y.x,y.y,T.x,T.y,J.x,J.y)&&Bs(J.prev,J,J.next)>=0))return!1;J=J.nextZ}for(;W&&W.z>=U;){if(W!==l.prev&&W!==l.next&&Dg(g.x,g.y,y.x,y.y,T.x,T.y,W.x,W.y)&&Bs(W.prev,W,W.next)>=0)return!1;W=W.prevZ}for(;J&&J.z<=G;){if(J!==l.prev&&J!==l.next&&Dg(g.x,g.y,y.x,y.y,T.x,T.y,J.x,J.y)&&Bs(J.prev,J,J.next)>=0)return!1;J=J.nextZ}return!0}function ZB(l,o,u){let f=l;do{const g=f.prev,y=f.next.next;!D1(g,y)&&hM(g,f,f.next,y)&&gy(g,y)&&gy(y,g)&&(o.push(g.i/u),o.push(f.i/u),o.push(y.i/u),vy(f),vy(f.next),f=l=y),f=f.next}while(f!==l);return up(f)}function JB(l,o,u,f,g,y){let T=l;do{let w=T.next.next;for(;w!==T.prev;){if(T.i!==w.i&&lN(T,w)){let M=fM(T,w);T=up(T,T.next),M=up(M,M.next),my(T,o,u,f,g,y),my(M,o,u,f,g,y);return}w=w.next}T=T.next}while(T!==l)}function eN(l,o,u,f){const g=[];let y,T,w,M,I;for(y=0,T=o.length;y<T;y++)w=o[y]*f,M=y<T-1?o[y+1]*f:l.length,I=dM(l,w,M,f,!1),I===I.next&&(I.steiner=!0),g.push(oN(I));for(g.sort(tN),y=0;y<g.length;y++)iN(g[y],u),u=up(u,u.next);return u}function tN(l,o){return l.x-o.x}function iN(l,o){if(o=nN(l,o),o){const u=fM(o,l);up(o,o.next),up(u,u.next)}}function nN(l,o){let u=o;const f=l.x,g=l.y;let y=-1/0,T;do{if(g<=u.y&&g>=u.next.y&&u.next.y!==u.y){const G=u.x+(g-u.y)*(u.next.x-u.x)/(u.next.y-u.y);if(G<=f&&G>y){if(y=G,G===f){if(g===u.y)return u;if(g===u.next.y)return u.next}T=u.x<u.next.x?u:u.next}}u=u.next}while(u!==o);if(!T)return null;if(f===y)return T;const w=T,M=T.x,I=T.y;let z=1/0,U;u=T;do f>=u.x&&u.x>=M&&f!==u.x&&Dg(g<I?f:y,g,M,I,g<I?y:f,g,u.x,u.y)&&(U=Math.abs(g-u.y)/(f-u.x),gy(u,l)&&(U<z||U===z&&(u.x>T.x||u.x===T.x&&rN(T,u)))&&(T=u,z=U)),u=u.next;while(u!==w);return T}function rN(l,o){return Bs(l.prev,l,o.prev)<0&&Bs(o.next,l,l.next)<0}function sN(l,o,u,f){let g=l;do g.z===null&&(g.z=qS(g.x,g.y,o,u,f)),g.prevZ=g.prev,g.nextZ=g.next,g=g.next;while(g!==l);g.prevZ.nextZ=null,g.prevZ=null,aN(g)}function aN(l){let o,u,f,g,y,T,w,M,I=1;do{for(u=l,l=null,y=null,T=0;u;){for(T++,f=u,w=0,o=0;o<I&&(w++,f=f.nextZ,!!f);o++);for(M=I;w>0||M>0&&f;)w!==0&&(M===0||!f||u.z<=f.z)?(g=u,u=u.nextZ,w--):(g=f,f=f.nextZ,M--),y?y.nextZ=g:l=g,g.prevZ=y,y=g;u=f}y.nextZ=null,I*=2}while(T>1);return l}function qS(l,o,u,f,g){return l=32767*(l-u)*g,o=32767*(o-f)*g,l=(l|l<<8)&16711935,l=(l|l<<4)&252645135,l=(l|l<<2)&858993459,l=(l|l<<1)&1431655765,o=(o|o<<8)&16711935,o=(o|o<<4)&252645135,o=(o|o<<2)&858993459,o=(o|o<<1)&1431655765,l|o<<1}function oN(l){let o=l,u=l;do(o.x<u.x||o.x===u.x&&o.y<u.y)&&(u=o),o=o.next;while(o!==l);return u}function Dg(l,o,u,f,g,y,T,w){return(g-T)*(o-w)-(l-T)*(y-w)>=0&&(l-T)*(f-w)-(u-T)*(o-w)>=0&&(u-T)*(y-w)-(g-T)*(f-w)>=0}function lN(l,o){return l.next.i!==o.i&&l.prev.i!==o.i&&!uN(l,o)&&(gy(l,o)&&gy(o,l)&&cN(l,o)&&(Bs(l.prev,l,o.prev)||Bs(l,o.prev,o))||D1(l,o)&&Bs(l.prev,l,l.next)>0&&Bs(o.prev,o,o.next)>0)}function Bs(l,o,u){return(o.y-l.y)*(u.x-o.x)-(o.x-l.x)*(u.y-o.y)}function D1(l,o){return l.x===o.x&&l.y===o.y}function hM(l,o,u,f){const g=P1(Bs(l,o,u)),y=P1(Bs(l,o,f)),T=P1(Bs(u,f,l)),w=P1(Bs(u,f,o));return!!(g!==y&&T!==w||g===0&&I1(l,u,o)||y===0&&I1(l,f,o)||T===0&&I1(u,l,f)||w===0&&I1(u,o,f))}function I1(l,o,u){return o.x<=Math.max(l.x,u.x)&&o.x>=Math.min(l.x,u.x)&&o.y<=Math.max(l.y,u.y)&&o.y>=Math.min(l.y,u.y)}function P1(l){return l>0?1:l<0?-1:0}function uN(l,o){let u=l;do{if(u.i!==l.i&&u.next.i!==l.i&&u.i!==o.i&&u.next.i!==o.i&&hM(u,u.next,l,o))return!0;u=u.next}while(u!==l);return!1}function gy(l,o){return Bs(l.prev,l,l.next)<0?Bs(l,o,l.next)>=0&&Bs(l,l.prev,o)>=0:Bs(l,o,l.prev)<0||Bs(l,l.next,o)<0}function cN(l,o){let u=l,f=!1;const g=(l.x+o.x)/2,y=(l.y+o.y)/2;do u.y>y!=u.next.y>y&&u.next.y!==u.y&&g<(u.next.x-u.x)*(y-u.y)/(u.next.y-u.y)+u.x&&(f=!f),u=u.next;while(u!==l);return f}function fM(l,o){const u=new XS(l.i,l.x,l.y),f=new XS(o.i,o.x,o.y),g=l.next,y=o.prev;return l.next=o,o.prev=l,u.next=g,g.prev=u,f.next=u,u.prev=f,y.next=f,f.prev=y,f}function pM(l,o,u,f){const g=new XS(l,o,u);return f?(g.next=f.next,g.prev=f,f.next.prev=g,f.next=g):(g.prev=g,g.next=g),g}function vy(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function XS(l,o,u){this.i=l,this.x=o,this.y=u,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function dN(l,o,u,f){let g=0;for(let y=o,T=u-f;y<u;y+=f)g+=(l[T]-l[y])*(l[y+1]+l[T+1]),T=y;return g}const cp={area:function(l){const o=l.length;let u=0;for(let f=o-1,g=0;g<o;f=g++)u+=l[f].x*l[g].y-l[g].x*l[f].y;return u*.5},isClockWise:function(l){return cp.area(l)<0},triangulateShape:function(l,o){const u=[],f=[],g=[];mM(l),gM(u,l);let y=l.length;o.forEach(mM);for(let w=0;w<o.length;w++)f.push(y),y+=o[w].length,gM(u,o[w]);const T=YB.triangulate(u,f);for(let w=0;w<T.length;w+=3)g.push(T.slice(w,w+3));return g}};function mM(l){const o=l.length;o>2&&l[o-1].equals(l[0])&&l.pop()}function gM(l,o){for(let u=0;u<o.length;u++)l.push(o[u].x),l.push(o[u].y)}class vM extends $n{constructor(o,u){super(),this.type="ExtrudeGeometry",this.parameters={shapes:o,options:u},o=Array.isArray(o)?o:[o];const f=this,g=[],y=[];for(let w=0,M=o.length;w<M;w++){const I=o[w];T(I)}this.setAttribute("position",new Xr(g,3)),this.setAttribute("uv",new Xr(y,2)),this.computeVertexNormals();function T(w){const M=[],I=u.curveSegments!==void 0?u.curveSegments:12,z=u.steps!==void 0?u.steps:1;let U=u.depth!==void 0?u.depth:100,G=u.bevelEnabled!==void 0?u.bevelEnabled:!0,W=u.bevelThickness!==void 0?u.bevelThickness:6,J=u.bevelSize!==void 0?u.bevelSize:W-2,me=u.bevelOffset!==void 0?u.bevelOffset:0,pe=u.bevelSegments!==void 0?u.bevelSegments:3;const te=u.extrudePath,K=u.UVGenerator!==void 0?u.UVGenerator:hN;u.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),U=u.amount);let He,$e=!1,Ue,Ae,at,Ht;te&&(He=te.getSpacedPoints(z),$e=!0,G=!1,Ue=te.computeFrenetFrames(z,!1),Ae=new Be,at=new Be,Ht=new Be),G||(pe=0,W=0,J=0,me=0);const wt=w.extractPoints(I);let It=wt.shape;const Pt=wt.holes;if(!cp.isClockWise(It)){It=It.reverse();for(let li=0,gi=Pt.length;li<gi;li++){const Ti=Pt[li];cp.isClockWise(Ti)&&(Pt[li]=Ti.reverse())}}const nt=cp.triangulateShape(It,Pt),Ke=It;for(let li=0,gi=Pt.length;li<gi;li++){const Ti=Pt[li];It=It.concat(Ti)}function st(li,gi,Ti){return gi||console.error("THREE.ExtrudeGeometry: vec does not exist"),gi.clone().multiplyScalar(Ti).add(li)}const Ct=It.length,Xt=nt.length;function ti(li,gi,Ti){let mt,oi,Ie;const we=li.x-gi.x,qt=li.y-gi.y,$t=Ti.x-li.x,We=Ti.y-li.y,zt=we*we+qt*qt,Ei=we*We-qt*$t;if(Math.abs(Ei)>Number.EPSILON){const ji=Math.sqrt(zt),Si=Math.sqrt($t*$t+We*We),Vi=gi.x-qt/ji,Ii=gi.y+we/ji,An=Ti.x-We/Si,zi=Ti.y+$t/Si,hn=((An-Vi)*We-(zi-Ii)*$t)/(we*We-qt*$t);mt=Vi+we*hn-li.x,oi=Ii+qt*hn-li.y;const ms=mt*mt+oi*oi;if(ms<=2)return new At(mt,oi);Ie=Math.sqrt(ms/2)}else{let ji=!1;we>Number.EPSILON?$t>Number.EPSILON&&(ji=!0):we<-Number.EPSILON?$t<-Number.EPSILON&&(ji=!0):Math.sign(qt)===Math.sign(We)&&(ji=!0),ji?(mt=-qt,oi=we,Ie=Math.sqrt(zt)):(mt=we,oi=qt,Ie=Math.sqrt(zt/2))}return new At(mt/Ie,oi/Ie)}const ni=[];for(let li=0,gi=Ke.length,Ti=gi-1,mt=li+1;li<gi;li++,Ti++,mt++)Ti===gi&&(Ti=0),mt===gi&&(mt=0),ni[li]=ti(Ke[li],Ke[Ti],Ke[mt]);const Ai=[];let _i,on=ni.concat();for(let li=0,gi=Pt.length;li<gi;li++){const Ti=Pt[li];_i=[];for(let mt=0,oi=Ti.length,Ie=oi-1,we=mt+1;mt<oi;mt++,Ie++,we++)Ie===oi&&(Ie=0),we===oi&&(we=0),_i[mt]=ti(Ti[mt],Ti[Ie],Ti[we]);Ai.push(_i),on=on.concat(_i)}for(let li=0;li<pe;li++){const gi=li/pe,Ti=W*Math.cos(gi*Math.PI/2),mt=J*Math.sin(gi*Math.PI/2)+me;for(let oi=0,Ie=Ke.length;oi<Ie;oi++){const we=st(Ke[oi],ni[oi],mt);mn(we.x,we.y,-Ti)}for(let oi=0,Ie=Pt.length;oi<Ie;oi++){const we=Pt[oi];_i=Ai[oi];for(let qt=0,$t=we.length;qt<$t;qt++){const We=st(we[qt],_i[qt],mt);mn(We.x,We.y,-Ti)}}}const vn=J+me;for(let li=0;li<Ct;li++){const gi=G?st(It[li],on[li],vn):It[li];$e?(at.copy(Ue.normals[0]).multiplyScalar(gi.x),Ae.copy(Ue.binormals[0]).multiplyScalar(gi.y),Ht.copy(He[0]).add(at).add(Ae),mn(Ht.x,Ht.y,Ht.z)):mn(gi.x,gi.y,0)}for(let li=1;li<=z;li++)for(let gi=0;gi<Ct;gi++){const Ti=G?st(It[gi],on[gi],vn):It[gi];$e?(at.copy(Ue.normals[li]).multiplyScalar(Ti.x),Ae.copy(Ue.binormals[li]).multiplyScalar(Ti.y),Ht.copy(He[li]).add(at).add(Ae),mn(Ht.x,Ht.y,Ht.z)):mn(Ti.x,Ti.y,U/z*li)}for(let li=pe-1;li>=0;li--){const gi=li/pe,Ti=W*Math.cos(gi*Math.PI/2),mt=J*Math.sin(gi*Math.PI/2)+me;for(let oi=0,Ie=Ke.length;oi<Ie;oi++){const we=st(Ke[oi],ni[oi],mt);mn(we.x,we.y,U+Ti)}for(let oi=0,Ie=Pt.length;oi<Ie;oi++){const we=Pt[oi];_i=Ai[oi];for(let qt=0,$t=we.length;qt<$t;qt++){const We=st(we[qt],_i[qt],mt);$e?mn(We.x,We.y+He[z-1].y,He[z-1].x+Ti):mn(We.x,We.y,U+Ti)}}}Pn(),Kt();function Pn(){const li=g.length/3;if(G){let gi=0,Ti=Ct*gi;for(let mt=0;mt<Xt;mt++){const oi=nt[mt];Wn(oi[2]+Ti,oi[1]+Ti,oi[0]+Ti)}gi=z+pe*2,Ti=Ct*gi;for(let mt=0;mt<Xt;mt++){const oi=nt[mt];Wn(oi[0]+Ti,oi[1]+Ti,oi[2]+Ti)}}else{for(let gi=0;gi<Xt;gi++){const Ti=nt[gi];Wn(Ti[2],Ti[1],Ti[0])}for(let gi=0;gi<Xt;gi++){const Ti=nt[gi];Wn(Ti[0]+Ct*z,Ti[1]+Ct*z,Ti[2]+Ct*z)}}f.addGroup(li,g.length/3-li,0)}function Kt(){const li=g.length/3;let gi=0;ua(Ke,gi),gi+=Ke.length;for(let Ti=0,mt=Pt.length;Ti<mt;Ti++){const oi=Pt[Ti];ua(oi,gi),gi+=oi.length}f.addGroup(li,g.length/3-li,1)}function ua(li,gi){let Ti=li.length;for(;--Ti>=0;){const mt=Ti;let oi=Ti-1;oi<0&&(oi=li.length-1);for(let Ie=0,we=z+pe*2;Ie<we;Ie++){const qt=Ct*Ie,$t=Ct*(Ie+1),We=gi+mt+qt,zt=gi+oi+qt,Ei=gi+oi+$t,ji=gi+mt+$t;yn(We,zt,Ei,ji)}}}function mn(li,gi,Ti){M.push(li),M.push(gi),M.push(Ti)}function Wn(li,gi,Ti){pr(li),pr(gi),pr(Ti);const mt=g.length/3,oi=K.generateTopUV(f,g,mt-3,mt-2,mt-1);Sn(oi[0]),Sn(oi[1]),Sn(oi[2])}function yn(li,gi,Ti,mt){pr(li),pr(gi),pr(mt),pr(gi),pr(Ti),pr(mt);const oi=g.length/3,Ie=K.generateSideWallUV(f,g,oi-6,oi-3,oi-2,oi-1);Sn(Ie[0]),Sn(Ie[1]),Sn(Ie[3]),Sn(Ie[1]),Sn(Ie[2]),Sn(Ie[3])}function pr(li){g.push(M[li*3+0]),g.push(M[li*3+1]),g.push(M[li*3+2])}function Sn(li){y.push(li.x),y.push(li.y)}}}toJSON(){const o=$n.prototype.toJSON.call(this),u=this.parameters.shapes,f=this.parameters.options;return fN(u,f,o)}}const hN={generateTopUV:function(l,o,u,f,g){const y=o[u*3],T=o[u*3+1],w=o[f*3],M=o[f*3+1],I=o[g*3],z=o[g*3+1];return[new At(y,T),new At(w,M),new At(I,z)]},generateSideWallUV:function(l,o,u,f,g,y){const T=o[u*3],w=o[u*3+1],M=o[u*3+2],I=o[f*3],z=o[f*3+1],U=o[f*3+2],G=o[g*3],W=o[g*3+1],J=o[g*3+2],me=o[y*3],pe=o[y*3+1],te=o[y*3+2];return Math.abs(w-z)<.01?[new At(T,1-M),new At(I,1-U),new At(G,1-J),new At(me,1-te)]:[new At(w,1-M),new At(z,1-U),new At(W,1-J),new At(pe,1-te)]}};function fN(l,o,u){if(u.shapes=[],Array.isArray(l))for(let f=0,g=l.length;f<g;f++){const y=l[f];u.shapes.push(y.uuid)}else u.shapes.push(l.uuid);return o.extrudePath!==void 0&&(u.options.extrudePath=o.extrudePath.toJSON()),u}function YS(l,o,u){$n.call(this),this.type="ParametricGeometry",this.parameters={func:l,slices:o,stacks:u};const f=[],g=[],y=[],T=[],w=1e-5,M=new Be,I=new Be,z=new Be,U=new Be,G=new Be;l.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const W=o+1;for(let J=0;J<=u;J++){const me=J/u;for(let pe=0;pe<=o;pe++){const te=pe/o;l(te,me,I),g.push(I.x,I.y,I.z),te-w>=0?(l(te-w,me,z),U.subVectors(I,z)):(l(te+w,me,z),U.subVectors(z,I)),me-w>=0?(l(te,me-w,z),G.subVectors(I,z)):(l(te,me+w,z),G.subVectors(z,I)),M.crossVectors(U,G).normalize(),y.push(M.x,M.y,M.z),T.push(te,me)}}for(let J=0;J<u;J++)for(let me=0;me<o;me++){const pe=J*W+me,te=J*W+me+1,K=(J+1)*W+me+1,He=(J+1)*W+me;f.push(pe,te,He),f.push(te,K,He)}this.setIndex(f),this.setAttribute("position",new Xr(g,3)),this.setAttribute("normal",new Xr(y,3)),this.setAttribute("uv",new Xr(T,2))}YS.prototype=Object.create($n.prototype),YS.prototype.constructor=YS;class pN extends $n{constructor(o,u=12){super(),this.type="ShapeGeometry",this.parameters={shapes:o,curveSegments:u};const f=[],g=[],y=[],T=[];let w=0,M=0;if(Array.isArray(o)===!1)I(o);else for(let z=0;z<o.length;z++)I(o[z]),this.addGroup(w,M,z),w+=M,M=0;this.setIndex(f),this.setAttribute("position",new Xr(g,3)),this.setAttribute("normal",new Xr(y,3)),this.setAttribute("uv",new Xr(T,2));function I(z){const U=g.length/3,G=z.extractPoints(u);let W=G.shape;const J=G.holes;cp.isClockWise(W)===!1&&(W=W.reverse());for(let pe=0,te=J.length;pe<te;pe++){const K=J[pe];cp.isClockWise(K)===!0&&(J[pe]=K.reverse())}const me=cp.triangulateShape(W,J);for(let pe=0,te=J.length;pe<te;pe++){const K=J[pe];W=W.concat(K)}for(let pe=0,te=W.length;pe<te;pe++){const K=W[pe];g.push(K.x,K.y,0),y.push(0,0,1),T.push(K.x,K.y)}for(let pe=0,te=me.length;pe<te;pe++){const K=me[pe],He=K[0]+U,$e=K[1]+U,Ue=K[2]+U;f.push(He,$e,Ue),M+=3}}}toJSON(){const o=$n.prototype.toJSON.call(this),u=this.parameters.shapes;return mN(u,o)}}function mN(l,o){if(o.shapes=[],Array.isArray(l))for(let u=0,f=l.length;u<f;u++){const g=l[u];o.shapes.push(g.uuid)}else o.shapes.push(l.uuid);return o}class yy extends $n{constructor(o=1,u=8,f=6,g=0,y=Math.PI*2,T=0,w=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:o,widthSegments:u,heightSegments:f,phiStart:g,phiLength:y,thetaStart:T,thetaLength:w},u=Math.max(3,Math.floor(u)),f=Math.max(2,Math.floor(f));const M=Math.min(T+w,Math.PI);let I=0;const z=[],U=new Be,G=new Be,W=[],J=[],me=[],pe=[];for(let te=0;te<=f;te++){const K=[],He=te/f;let $e=0;te==0&&T==0?$e=.5/u:te==f&&M==Math.PI&&($e=-.5/u);for(let Ue=0;Ue<=u;Ue++){const Ae=Ue/u;U.x=-o*Math.cos(g+Ae*y)*Math.sin(T+He*w),U.y=o*Math.cos(T+He*w),U.z=o*Math.sin(g+Ae*y)*Math.sin(T+He*w),J.push(U.x,U.y,U.z),G.copy(U).normalize(),me.push(G.x,G.y,G.z),pe.push(Ae+$e,1-He),K.push(I++)}z.push(K)}for(let te=0;te<f;te++)for(let K=0;K<u;K++){const He=z[te][K+1],$e=z[te][K],Ue=z[te+1][K],Ae=z[te+1][K+1];(te!==0||T>0)&&W.push(He,$e,Ae),(te!==f-1||M<Math.PI)&&W.push($e,Ue,Ae)}this.setIndex(W),this.setAttribute("position",new Xr(J,3)),this.setAttribute("normal",new Xr(me,3)),this.setAttribute("uv",new Xr(pe,2))}}function Ig(l){Ji.call(this),this.type="ShadowMaterial",this.color=new Fi(0),this.transparent=!0,this.setValues(l)}Ig.prototype=Object.create(Ji.prototype),Ig.prototype.constructor=Ig,Ig.prototype.isShadowMaterial=!0,Ig.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.color.copy(l.color),this};function _y(l){rs.call(this,l),this.type="RawShaderMaterial"}_y.prototype=Object.create(rs.prototype),_y.prototype.constructor=_y,_y.prototype.isRawShaderMaterial=!0;function Zh(l){Ji.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Fi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ts,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(l)}Zh.prototype=Object.create(Ji.prototype),Zh.prototype.constructor=Zh,Zh.prototype.isMeshStandardMaterial=!0,Zh.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.defines={STANDARD:""},this.color.copy(l.color),this.roughness=l.roughness,this.metalness=l.metalness,this.map=l.map,this.lightMap=l.lightMap,this.lightMapIntensity=l.lightMapIntensity,this.aoMap=l.aoMap,this.aoMapIntensity=l.aoMapIntensity,this.emissive.copy(l.emissive),this.emissiveMap=l.emissiveMap,this.emissiveIntensity=l.emissiveIntensity,this.bumpMap=l.bumpMap,this.bumpScale=l.bumpScale,this.normalMap=l.normalMap,this.normalMapType=l.normalMapType,this.normalScale.copy(l.normalScale),this.displacementMap=l.displacementMap,this.displacementScale=l.displacementScale,this.displacementBias=l.displacementBias,this.roughnessMap=l.roughnessMap,this.metalnessMap=l.metalnessMap,this.alphaMap=l.alphaMap,this.envMap=l.envMap,this.envMapIntensity=l.envMapIntensity,this.refractionRatio=l.refractionRatio,this.wireframe=l.wireframe,this.wireframeLinewidth=l.wireframeLinewidth,this.wireframeLinecap=l.wireframeLinecap,this.wireframeLinejoin=l.wireframeLinejoin,this.skinning=l.skinning,this.morphTargets=l.morphTargets,this.morphNormals=l.morphNormals,this.vertexTangents=l.vertexTangents,this};function pm(l){Zh.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new At(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(o){this.reflectivity=Gi.clamp(2.5*(o-1)/(o+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(l)}pm.prototype=Object.create(Zh.prototype),pm.prototype.constructor=pm,pm.prototype.isMeshPhysicalMaterial=!0,pm.prototype.copy=function(l){return Zh.prototype.copy.call(this,l),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=l.clearcoat,this.clearcoatMap=l.clearcoatMap,this.clearcoatRoughness=l.clearcoatRoughness,this.clearcoatRoughnessMap=l.clearcoatRoughnessMap,this.clearcoatNormalMap=l.clearcoatNormalMap,this.clearcoatNormalScale.copy(l.clearcoatNormalScale),this.reflectivity=l.reflectivity,l.sheen?this.sheen=(this.sheen||new Fi).copy(l.sheen):this.sheen=null,this.transmission=l.transmission,this.transmissionMap=l.transmissionMap,this};function mm(l){Ji.call(this),this.type="MeshPhongMaterial",this.color=new Fi(16777215),this.specular=new Fi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ts,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Js,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(l)}mm.prototype=Object.create(Ji.prototype),mm.prototype.constructor=mm,mm.prototype.isMeshPhongMaterial=!0,mm.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.color.copy(l.color),this.specular.copy(l.specular),this.shininess=l.shininess,this.map=l.map,this.lightMap=l.lightMap,this.lightMapIntensity=l.lightMapIntensity,this.aoMap=l.aoMap,this.aoMapIntensity=l.aoMapIntensity,this.emissive.copy(l.emissive),this.emissiveMap=l.emissiveMap,this.emissiveIntensity=l.emissiveIntensity,this.bumpMap=l.bumpMap,this.bumpScale=l.bumpScale,this.normalMap=l.normalMap,this.normalMapType=l.normalMapType,this.normalScale.copy(l.normalScale),this.displacementMap=l.displacementMap,this.displacementScale=l.displacementScale,this.displacementBias=l.displacementBias,this.specularMap=l.specularMap,this.alphaMap=l.alphaMap,this.envMap=l.envMap,this.combine=l.combine,this.reflectivity=l.reflectivity,this.refractionRatio=l.refractionRatio,this.wireframe=l.wireframe,this.wireframeLinewidth=l.wireframeLinewidth,this.wireframeLinecap=l.wireframeLinecap,this.wireframeLinejoin=l.wireframeLinejoin,this.skinning=l.skinning,this.morphTargets=l.morphTargets,this.morphNormals=l.morphNormals,this};function Pg(l){Ji.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Fi(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ts,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(l)}Pg.prototype=Object.create(Ji.prototype),Pg.prototype.constructor=Pg,Pg.prototype.isMeshToonMaterial=!0,Pg.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.color.copy(l.color),this.map=l.map,this.gradientMap=l.gradientMap,this.lightMap=l.lightMap,this.lightMapIntensity=l.lightMapIntensity,this.aoMap=l.aoMap,this.aoMapIntensity=l.aoMapIntensity,this.emissive.copy(l.emissive),this.emissiveMap=l.emissiveMap,this.emissiveIntensity=l.emissiveIntensity,this.bumpMap=l.bumpMap,this.bumpScale=l.bumpScale,this.normalMap=l.normalMap,this.normalMapType=l.normalMapType,this.normalScale.copy(l.normalScale),this.displacementMap=l.displacementMap,this.displacementScale=l.displacementScale,this.displacementBias=l.displacementBias,this.alphaMap=l.alphaMap,this.wireframe=l.wireframe,this.wireframeLinewidth=l.wireframeLinewidth,this.wireframeLinecap=l.wireframeLinecap,this.wireframeLinejoin=l.wireframeLinejoin,this.skinning=l.skinning,this.morphTargets=l.morphTargets,this.morphNormals=l.morphNormals,this};function Lg(l){Ji.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ts,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(l)}Lg.prototype=Object.create(Ji.prototype),Lg.prototype.constructor=Lg,Lg.prototype.isMeshNormalMaterial=!0,Lg.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.bumpMap=l.bumpMap,this.bumpScale=l.bumpScale,this.normalMap=l.normalMap,this.normalMapType=l.normalMapType,this.normalScale.copy(l.normalScale),this.displacementMap=l.displacementMap,this.displacementScale=l.displacementScale,this.displacementBias=l.displacementBias,this.wireframe=l.wireframe,this.wireframeLinewidth=l.wireframeLinewidth,this.skinning=l.skinning,this.morphTargets=l.morphTargets,this.morphNormals=l.morphNormals,this};function Rg(l){Ji.call(this),this.type="MeshLambertMaterial",this.color=new Fi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Js,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(l)}Rg.prototype=Object.create(Ji.prototype),Rg.prototype.constructor=Rg,Rg.prototype.isMeshLambertMaterial=!0,Rg.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.color.copy(l.color),this.map=l.map,this.lightMap=l.lightMap,this.lightMapIntensity=l.lightMapIntensity,this.aoMap=l.aoMap,this.aoMapIntensity=l.aoMapIntensity,this.emissive.copy(l.emissive),this.emissiveMap=l.emissiveMap,this.emissiveIntensity=l.emissiveIntensity,this.specularMap=l.specularMap,this.alphaMap=l.alphaMap,this.envMap=l.envMap,this.combine=l.combine,this.reflectivity=l.reflectivity,this.refractionRatio=l.refractionRatio,this.wireframe=l.wireframe,this.wireframeLinewidth=l.wireframeLinewidth,this.wireframeLinecap=l.wireframeLinecap,this.wireframeLinejoin=l.wireframeLinejoin,this.skinning=l.skinning,this.morphTargets=l.morphTargets,this.morphNormals=l.morphNormals,this};function kg(l){Ji.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Fi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ts,this.normalScale=new At(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(l)}kg.prototype=Object.create(Ji.prototype),kg.prototype.constructor=kg,kg.prototype.isMeshMatcapMaterial=!0,kg.prototype.copy=function(l){return Ji.prototype.copy.call(this,l),this.defines={MATCAP:""},this.color.copy(l.color),this.matcap=l.matcap,this.map=l.map,this.bumpMap=l.bumpMap,this.bumpScale=l.bumpScale,this.normalMap=l.normalMap,this.normalMapType=l.normalMapType,this.normalScale.copy(l.normalScale),this.displacementMap=l.displacementMap,this.displacementScale=l.displacementScale,this.displacementBias=l.displacementBias,this.alphaMap=l.alphaMap,this.skinning=l.skinning,this.morphTargets=l.morphTargets,this.morphNormals=l.morphNormals,this};function Og(l){ze.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(l)}Og.prototype=Object.create(ze.prototype),Og.prototype.constructor=Og,Og.prototype.isLineDashedMaterial=!0,Og.prototype.copy=function(l){return ze.prototype.copy.call(this,l),this.scale=l.scale,this.dashSize=l.dashSize,this.gapSize=l.gapSize,this};var gN=Object.freeze({__proto__:null,ShadowMaterial:Ig,SpriteMaterial:rl,RawShaderMaterial:_y,ShaderMaterial:rs,PointsMaterial:yt,MeshPhysicalMaterial:pm,MeshStandardMaterial:Zh,MeshPhongMaterial:mm,MeshToonMaterial:Pg,MeshNormalMaterial:Lg,MeshLambertMaterial:Rg,MeshDepthMaterial:Wh,MeshDistanceMaterial:Fd,MeshBasicMaterial:Un,MeshMatcapMaterial:kg,LineDashedMaterial:Og,LineBasicMaterial:ze,Material:Ji});const Cs={arraySlice:function(l,o,u){return Cs.isTypedArray(l)?new l.constructor(l.subarray(o,u!==void 0?u:l.length)):l.slice(o,u)},convertArray:function(l,o,u){return!l||!u&&l.constructor===o?l:typeof o.BYTES_PER_ELEMENT=="number"?new o(l):Array.prototype.slice.call(l)},isTypedArray:function(l){return ArrayBuffer.isView(l)&&!(l instanceof DataView)},getKeyframeOrder:function(l){function o(g,y){return l[g]-l[y]}const u=l.length,f=new Array(u);for(let g=0;g!==u;++g)f[g]=g;return f.sort(o),f},sortedArray:function(l,o,u){const f=l.length,g=new l.constructor(f);for(let y=0,T=0;T!==f;++y){const w=u[y]*o;for(let M=0;M!==o;++M)g[T++]=l[w+M]}return g},flattenJSON:function(l,o,u,f){let g=1,y=l[0];for(;y!==void 0&&y[f]===void 0;)y=l[g++];if(y===void 0)return;let T=y[f];if(T!==void 0)if(Array.isArray(T))do T=y[f],T!==void 0&&(o.push(y.time),u.push.apply(u,T)),y=l[g++];while(y!==void 0);else if(T.toArray!==void 0)do T=y[f],T!==void 0&&(o.push(y.time),T.toArray(u,u.length)),y=l[g++];while(y!==void 0);else do T=y[f],T!==void 0&&(o.push(y.time),u.push(T)),y=l[g++];while(y!==void 0)},subclip:function(l,o,u,f,g=30){const y=l.clone();y.name=o;const T=[];for(let M=0;M<y.tracks.length;++M){const I=y.tracks[M],z=I.getValueSize(),U=[],G=[];for(let W=0;W<I.times.length;++W){const J=I.times[W]*g;if(!(J<u||J>=f)){U.push(I.times[W]);for(let me=0;me<z;++me)G.push(I.values[W*z+me])}}U.length!==0&&(I.times=Cs.convertArray(U,I.times.constructor),I.values=Cs.convertArray(G,I.values.constructor),T.push(I))}y.tracks=T;let w=1/0;for(let M=0;M<y.tracks.length;++M)w>y.tracks[M].times[0]&&(w=y.tracks[M].times[0]);for(let M=0;M<y.tracks.length;++M)y.tracks[M].shift(-1*w);return y.resetDuration(),y},makeClipAdditive:function(l,o=0,u=l,f=30){f<=0&&(f=30);const g=u.tracks.length,y=o/f;for(let T=0;T<g;++T){const w=u.tracks[T],M=w.ValueTypeName;if(M==="bool"||M==="string")continue;const I=l.tracks.find(function(te){return te.name===w.name&&te.ValueTypeName===M});if(I===void 0)continue;let z=0;const U=w.getValueSize();w.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(z=U/3);let G=0;const W=I.getValueSize();I.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(G=W/3);const J=w.times.length-1;let me;if(y<=w.times[0]){const te=z,K=U-z;me=Cs.arraySlice(w.values,te,K)}else if(y>=w.times[J]){const te=J*U+z,K=te+U-z;me=Cs.arraySlice(w.values,te,K)}else{const te=w.createInterpolant(),K=z,He=U-z;te.evaluate(y),me=Cs.arraySlice(te.resultBuffer,K,He)}M==="quaternion"&&new Wr().fromArray(me).normalize().conjugate().toArray(me);const pe=I.times.length;for(let te=0;te<pe;++te){const K=te*W+G;if(M==="quaternion")Wr.multiplyQuaternionsFlat(I.values,K,me,0,I.values,K);else{const He=W-G*2;for(let $e=0;$e<He;++$e)I.values[K+$e]-=me[$e]}}}return l.blendMode=Ih,l}};function uc(l,o,u,f){this.parameterPositions=l,this._cachedIndex=0,this.resultBuffer=f!==void 0?f:new o.constructor(u),this.sampleValues=o,this.valueSize=u}X(uc.prototype,{evaluate:function(l){const o=this.parameterPositions;let u=this._cachedIndex,f=o[u],g=o[u-1];e:{t:{let y;i:{n:if(!(l<f)){for(let T=u+2;;){if(f===void 0){if(l<g)break n;return u=o.length,this._cachedIndex=u,this.afterEnd_(u-1,l,g)}if(u===T)break;if(g=f,f=o[++u],l<f)break t}y=o.length;break i}if(!(l>=g)){const T=o[1];l<T&&(u=2,g=T);for(let w=u-2;;){if(g===void 0)return this._cachedIndex=0,this.beforeStart_(0,l,f);if(u===w)break;if(f=g,g=o[--u-1],l>=g)break t}y=u,u=0;break i}break e}for(;u<y;){const T=u+y>>>1;l<o[T]?y=T:u=T+1}if(f=o[u],g=o[u-1],g===void 0)return this._cachedIndex=0,this.beforeStart_(0,l,f);if(f===void 0)return u=o.length,this._cachedIndex=u,this.afterEnd_(u-1,g,l)}this._cachedIndex=u,this.intervalChanged_(u,g,f)}return this.interpolate_(u,g,l,f)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(l){const o=this.resultBuffer,u=this.sampleValues,f=this.valueSize,g=l*f;for(let y=0;y!==f;++y)o[y]=u[g+y];return o},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),X(uc.prototype,{beforeStart_:uc.prototype.copySampleValue_,afterEnd_:uc.prototype.copySampleValue_});function QS(l,o,u,f){uc.call(this,l,o,u,f),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}QS.prototype=X(Object.create(uc.prototype),{constructor:QS,DefaultSettings_:{endingStart:$s,endingEnd:$s},intervalChanged_:function(l,o,u){const f=this.parameterPositions;let g=l-2,y=l+1,T=f[g],w=f[y];if(T===void 0)switch(this.getSettings_().endingStart){case Va:g=l,T=2*o-u;break;case Cl:g=f.length-2,T=o+f[g]-f[g+1];break;default:g=l,T=u}if(w===void 0)switch(this.getSettings_().endingEnd){case Va:y=l,w=2*u-o;break;case Cl:y=1,w=u+f[1]-f[0];break;default:y=l-1,w=o}const M=(u-o)*.5,I=this.valueSize;this._weightPrev=M/(o-T),this._weightNext=M/(w-u),this._offsetPrev=g*I,this._offsetNext=y*I},interpolate_:function(l,o,u,f){const g=this.resultBuffer,y=this.sampleValues,T=this.valueSize,w=l*T,M=w-T,I=this._offsetPrev,z=this._offsetNext,U=this._weightPrev,G=this._weightNext,W=(u-o)/(f-o),J=W*W,me=J*W,pe=-U*me+2*U*J-U*W,te=(1+U)*me+(-1.5-2*U)*J+(-.5+U)*W+1,K=(-1-G)*me+(1.5+G)*J+.5*W,He=G*me-G*J;for(let $e=0;$e!==T;++$e)g[$e]=pe*y[I+$e]+te*y[M+$e]+K*y[w+$e]+He*y[z+$e];return g}});function L1(l,o,u,f){uc.call(this,l,o,u,f)}L1.prototype=X(Object.create(uc.prototype),{constructor:L1,interpolate_:function(l,o,u,f){const g=this.resultBuffer,y=this.sampleValues,T=this.valueSize,w=l*T,M=w-T,I=(u-o)/(f-o),z=1-I;for(let U=0;U!==T;++U)g[U]=y[M+U]*z+y[w+U]*I;return g}});function KS(l,o,u,f){uc.call(this,l,o,u,f)}KS.prototype=X(Object.create(uc.prototype),{constructor:KS,interpolate_:function(l){return this.copySampleValue_(l-1)}});function Po(l,o,u,f){if(l===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(o===void 0||o.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+l);this.name=l,this.times=Cs.convertArray(o,this.TimeBufferType),this.values=Cs.convertArray(u,this.ValueBufferType),this.setInterpolation(f||this.DefaultInterpolation)}X(Po,{toJSON:function(l){const o=l.constructor;let u;if(o.toJSON!==void 0)u=o.toJSON(l);else{u={name:l.name,times:Cs.convertArray(l.times,Array),values:Cs.convertArray(l.values,Array)};const f=l.getInterpolation();f!==l.DefaultInterpolation&&(u.interpolation=f)}return u.type=l.ValueTypeName,u}}),X(Po.prototype,{constructor:Po,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:$o,InterpolantFactoryMethodDiscrete:function(l){return new KS(this.times,this.values,this.getValueSize(),l)},InterpolantFactoryMethodLinear:function(l){return new L1(this.times,this.values,this.getValueSize(),l)},InterpolantFactoryMethodSmooth:function(l){return new QS(this.times,this.values,this.getValueSize(),l)},setInterpolation:function(l){let o;switch(l){case El:o=this.InterpolantFactoryMethodDiscrete;break;case $o:o=this.InterpolantFactoryMethodLinear;break;case oo:o=this.InterpolantFactoryMethodSmooth;break}if(o===void 0){const u="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(l!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(u);return console.warn("THREE.KeyframeTrack:",u),this}return this.createInterpolant=o,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return El;case this.InterpolantFactoryMethodLinear:return $o;case this.InterpolantFactoryMethodSmooth:return oo}},getValueSize:function(){return this.values.length/this.times.length},shift:function(l){if(l!==0){const o=this.times;for(let u=0,f=o.length;u!==f;++u)o[u]+=l}return this},scale:function(l){if(l!==1){const o=this.times;for(let u=0,f=o.length;u!==f;++u)o[u]*=l}return this},trim:function(l,o){const u=this.times,f=u.length;let g=0,y=f-1;for(;g!==f&&u[g]<l;)++g;for(;y!==-1&&u[y]>o;)--y;if(++y,g!==0||y!==f){g>=y&&(y=Math.max(y,1),g=y-1);const T=this.getValueSize();this.times=Cs.arraySlice(u,g,y),this.values=Cs.arraySlice(this.values,g*T,y*T)}return this},validate:function(){let l=!0;const o=this.getValueSize();o-Math.floor(o)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),l=!1);const u=this.times,f=this.values,g=u.length;g===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),l=!1);let y=null;for(let T=0;T!==g;T++){const w=u[T];if(typeof w=="number"&&isNaN(w)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,T,w),l=!1;break}if(y!==null&&y>w){console.error("THREE.KeyframeTrack: Out of order keys.",this,T,w,y),l=!1;break}y=w}if(f!==void 0&&Cs.isTypedArray(f))for(let T=0,w=f.length;T!==w;++T){const M=f[T];if(isNaN(M)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,T,M),l=!1;break}}return l},optimize:function(){const l=Cs.arraySlice(this.times),o=Cs.arraySlice(this.values),u=this.getValueSize(),f=this.getInterpolation()===oo,g=l.length-1;let y=1;for(let T=1;T<g;++T){let w=!1;const M=l[T],I=l[T+1];if(M!==I&&(T!==1||M!==l[0]))if(f)w=!0;else{const z=T*u,U=z-u,G=z+u;for(let W=0;W!==u;++W){const J=o[z+W];if(J!==o[U+W]||J!==o[G+W]){w=!0;break}}}if(w){if(T!==y){l[y]=l[T];const z=T*u,U=y*u;for(let G=0;G!==u;++G)o[U+G]=o[z+G]}++y}}if(g>0){l[y]=l[g];for(let T=g*u,w=y*u,M=0;M!==u;++M)o[w+M]=o[T+M];++y}return y!==l.length?(this.times=Cs.arraySlice(l,0,y),this.values=Cs.arraySlice(o,0,y*u)):(this.times=l,this.values=o),this},clone:function(){const l=Cs.arraySlice(this.times,0),o=Cs.arraySlice(this.values,0),u=this.constructor,f=new u(this.name,l,o);return f.createInterpolant=this.createInterpolant,f}});function ZS(l,o,u){Po.call(this,l,o,u)}ZS.prototype=X(Object.create(Po.prototype),{constructor:ZS,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:El,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function JS(l,o,u,f){Po.call(this,l,o,u,f)}JS.prototype=X(Object.create(Po.prototype),{constructor:JS,ValueTypeName:"color"});function by(l,o,u,f){Po.call(this,l,o,u,f)}by.prototype=X(Object.create(Po.prototype),{constructor:by,ValueTypeName:"number"});function eA(l,o,u,f){uc.call(this,l,o,u,f)}eA.prototype=X(Object.create(uc.prototype),{constructor:eA,interpolate_:function(l,o,u,f){const g=this.resultBuffer,y=this.sampleValues,T=this.valueSize,w=(u-o)/(f-o);let M=l*T;for(let I=M+T;M!==I;M+=4)Wr.slerpFlat(g,0,y,M-T,y,M,w);return g}});function R1(l,o,u,f){Po.call(this,l,o,u,f)}R1.prototype=X(Object.create(Po.prototype),{constructor:R1,ValueTypeName:"quaternion",DefaultInterpolation:$o,InterpolantFactoryMethodLinear:function(l){return new eA(this.times,this.values,this.getValueSize(),l)},InterpolantFactoryMethodSmooth:void 0});function tA(l,o,u,f){Po.call(this,l,o,u,f)}tA.prototype=X(Object.create(Po.prototype),{constructor:tA,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:El,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Ty(l,o,u,f){Po.call(this,l,o,u,f)}Ty.prototype=X(Object.create(Po.prototype),{constructor:Ty,ValueTypeName:"vector"});function Bc(l,o=-1,u,f=ud){this.name=l,this.tracks=u,this.duration=o,this.blendMode=f,this.uuid=Gi.generateUUID(),this.duration<0&&this.resetDuration()}function vN(l){switch(l.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return by;case"vector":case"vector2":case"vector3":case"vector4":return Ty;case"color":return JS;case"quaternion":return R1;case"bool":case"boolean":return ZS;case"string":return tA}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+l)}function yN(l){if(l.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const o=vN(l.type);if(l.times===void 0){const u=[],f=[];Cs.flattenJSON(l.keys,u,f,"value"),l.times=u,l.values=f}return o.parse!==void 0?o.parse(l):new o(l.name,l.times,l.values,l.interpolation)}X(Bc,{parse:function(l){const o=[],u=l.tracks,f=1/(l.fps||1);for(let y=0,T=u.length;y!==T;++y)o.push(yN(u[y]).scale(f));const g=new Bc(l.name,l.duration,o,l.blendMode);return g.uuid=l.uuid,g},toJSON:function(l){const o=[],u=l.tracks,f={name:l.name,duration:l.duration,tracks:o,uuid:l.uuid,blendMode:l.blendMode};for(let g=0,y=u.length;g!==y;++g)o.push(Po.toJSON(u[g]));return f},CreateFromMorphTargetSequence:function(l,o,u,f){const g=o.length,y=[];for(let T=0;T<g;T++){let w=[],M=[];w.push((T+g-1)%g,T,(T+1)%g),M.push(0,1,0);const I=Cs.getKeyframeOrder(w);w=Cs.sortedArray(w,1,I),M=Cs.sortedArray(M,1,I),!f&&w[0]===0&&(w.push(g),M.push(M[0])),y.push(new by(".morphTargetInfluences["+o[T].name+"]",w,M).scale(1/u))}return new Bc(l,-1,y)},findByName:function(l,o){let u=l;if(!Array.isArray(l)){const f=l;u=f.geometry&&f.geometry.animations||f.animations}for(let f=0;f<u.length;f++)if(u[f].name===o)return u[f];return null},CreateClipsFromMorphTargetSequences:function(l,o,u){const f={},g=/^([\w-]*?)([\d]+)$/;for(let T=0,w=l.length;T<w;T++){const M=l[T],I=M.name.match(g);if(I&&I.length>1){const z=I[1];let U=f[z];U||(f[z]=U=[]),U.push(M)}}const y=[];for(const T in f)y.push(Bc.CreateFromMorphTargetSequence(T,f[T],o,u));return y},parseAnimation:function(l,o){if(!l)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const u=function(z,U,G,W,J){if(G.length!==0){const me=[],pe=[];Cs.flattenJSON(G,me,pe,W),me.length!==0&&J.push(new z(U,me,pe))}},f=[],g=l.name||"default",y=l.fps||30,T=l.blendMode;let w=l.length||-1;const M=l.hierarchy||[];for(let z=0;z<M.length;z++){const U=M[z].keys;if(!(!U||U.length===0))if(U[0].morphTargets){const G={};let W;for(W=0;W<U.length;W++)if(U[W].morphTargets)for(let J=0;J<U[W].morphTargets.length;J++)G[U[W].morphTargets[J]]=-1;for(const J in G){const me=[],pe=[];for(let te=0;te!==U[W].morphTargets.length;++te){const K=U[W];me.push(K.time),pe.push(K.morphTarget===J?1:0)}f.push(new by(".morphTargetInfluence["+J+"]",me,pe))}w=G.length*y}else{const G=".bones["+o[z].name+"]";u(Ty,G+".position",U,"pos",f),u(R1,G+".quaternion",U,"rot",f),u(Ty,G+".scale",U,"scl",f)}}return f.length===0?null:new Bc(g,w,f,T)}}),X(Bc.prototype,{resetDuration:function(){const l=this.tracks;let o=0;for(let u=0,f=l.length;u!==f;++u){const g=this.tracks[u];o=Math.max(o,g.times[g.times.length-1])}return this.duration=o,this},trim:function(){for(let l=0;l<this.tracks.length;l++)this.tracks[l].trim(0,this.duration);return this},validate:function(){let l=!0;for(let o=0;o<this.tracks.length;o++)l=l&&this.tracks[o].validate();return l},optimize:function(){for(let l=0;l<this.tracks.length;l++)this.tracks[l].optimize();return this},clone:function(){const l=[];for(let o=0;o<this.tracks.length;o++)l.push(this.tracks[o].clone());return new Bc(this.name,this.duration,l,this.blendMode)},toJSON:function(){return Bc.toJSON(this)}});const Fg={enabled:!1,files:{},add:function(l,o){this.enabled!==!1&&(this.files[l]=o)},get:function(l){if(this.enabled!==!1)return this.files[l]},remove:function(l){delete this.files[l]},clear:function(){this.files={}}};function _N(l,o,u){const f=this;let g=!1,y=0,T=0,w;const M=[];this.onStart=void 0,this.onLoad=l,this.onProgress=o,this.onError=u,this.itemStart=function(I){T++,g===!1&&f.onStart!==void 0&&f.onStart(I,y,T),g=!0},this.itemEnd=function(I){y++,f.onProgress!==void 0&&f.onProgress(I,y,T),y===T&&(g=!1,f.onLoad!==void 0&&f.onLoad())},this.itemError=function(I){f.onError!==void 0&&f.onError(I)},this.resolveURL=function(I){return w?w(I):I},this.setURLModifier=function(I){return w=I,this},this.addHandler=function(I,z){return M.push(I,z),this},this.removeHandler=function(I){const z=M.indexOf(I);return z!==-1&&M.splice(z,2),this},this.getHandler=function(I){for(let z=0,U=M.length;z<U;z+=2){const G=M[z],W=M[z+1];if(G.global&&(G.lastIndex=0),G.test(I))return W}return null}}const bN=new _N;function Zr(l){this.manager=l!==void 0?l:bN,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}X(Zr.prototype,{load:function(){},loadAsync:function(l,o){const u=this;return new Promise(function(f,g){u.load(l,f,o,g)})},parse:function(){},setCrossOrigin:function(l){return this.crossOrigin=l,this},setWithCredentials:function(l){return this.withCredentials=l,this},setPath:function(l){return this.path=l,this},setResourcePath:function(l){return this.resourcePath=l,this},setRequestHeader:function(l){return this.requestHeader=l,this}});const Nc={};function Jh(l){Zr.call(this,l)}Jh.prototype=X(Object.create(Zr.prototype),{constructor:Jh,load:function(l,o,u,f){l===void 0&&(l=""),this.path!==void 0&&(l=this.path+l),l=this.manager.resolveURL(l);const g=this,y=Fg.get(l);if(y!==void 0)return g.manager.itemStart(l),setTimeout(function(){o&&o(y),g.manager.itemEnd(l)},0),y;if(Nc[l]!==void 0){Nc[l].push({onLoad:o,onProgress:u,onError:f});return}const T=/^data:(.*?)(;base64)?,(.*)$/,w=l.match(T);let M;if(w){const I=w[1],z=!!w[2];let U=w[3];U=decodeURIComponent(U),z&&(U=atob(U));try{let G;const W=(this.responseType||"").toLowerCase();switch(W){case"arraybuffer":case"blob":const J=new Uint8Array(U.length);for(let pe=0;pe<U.length;pe++)J[pe]=U.charCodeAt(pe);W==="blob"?G=new Blob([J.buffer],{type:I}):G=J.buffer;break;case"document":G=new DOMParser().parseFromString(U,I);break;case"json":G=JSON.parse(U);break;default:G=U;break}setTimeout(function(){o&&o(G),g.manager.itemEnd(l)},0)}catch(G){setTimeout(function(){f&&f(G),g.manager.itemError(l),g.manager.itemEnd(l)},0)}}else{Nc[l]=[],Nc[l].push({onLoad:o,onProgress:u,onError:f}),M=new XMLHttpRequest,M.open("GET",l,!0),M.addEventListener("load",function(I){const z=this.response,U=Nc[l];if(delete Nc[l],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Fg.add(l,z);for(let G=0,W=U.length;G<W;G++){const J=U[G];J.onLoad&&J.onLoad(z)}g.manager.itemEnd(l)}else{for(let G=0,W=U.length;G<W;G++){const J=U[G];J.onError&&J.onError(I)}g.manager.itemError(l),g.manager.itemEnd(l)}},!1),M.addEventListener("progress",function(I){const z=Nc[l];for(let U=0,G=z.length;U<G;U++){const W=z[U];W.onProgress&&W.onProgress(I)}},!1),M.addEventListener("error",function(I){const z=Nc[l];delete Nc[l];for(let U=0,G=z.length;U<G;U++){const W=z[U];W.onError&&W.onError(I)}g.manager.itemError(l),g.manager.itemEnd(l)},!1),M.addEventListener("abort",function(I){const z=Nc[l];delete Nc[l];for(let U=0,G=z.length;U<G;U++){const W=z[U];W.onError&&W.onError(I)}g.manager.itemError(l),g.manager.itemEnd(l)},!1),this.responseType!==void 0&&(M.responseType=this.responseType),this.withCredentials!==void 0&&(M.withCredentials=this.withCredentials),M.overrideMimeType&&M.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const I in this.requestHeader)M.setRequestHeader(I,this.requestHeader[I]);M.send(null)}return g.manager.itemStart(l),M},setResponseType:function(l){return this.responseType=l,this},setMimeType:function(l){return this.mimeType=l,this}});function yM(l){Zr.call(this,l)}yM.prototype=X(Object.create(Zr.prototype),{constructor:yM,load:function(l,o,u,f){const g=this,y=new Jh(g.manager);y.setPath(g.path),y.setRequestHeader(g.requestHeader),y.setWithCredentials(g.withCredentials),y.load(l,function(T){try{o(g.parse(JSON.parse(T)))}catch(w){f?f(w):console.error(w),g.manager.itemError(l)}},u,f)},parse:function(l){const o=[];for(let u=0;u<l.length;u++){const f=Bc.parse(l[u]);o.push(f)}return o}});function _M(l){Zr.call(this,l)}_M.prototype=X(Object.create(Zr.prototype),{constructor:_M,load:function(l,o,u,f){const g=this,y=[],T=new zl,w=new Jh(this.manager);w.setPath(this.path),w.setResponseType("arraybuffer"),w.setRequestHeader(this.requestHeader),w.setWithCredentials(g.withCredentials);let M=0;function I(z){w.load(l[z],function(U){const G=g.parse(U,!0);y[z]={width:G.width,height:G.height,format:G.format,mipmaps:G.mipmaps},M+=1,M===6&&(G.mipmapCount===1&&(T.minFilter=Ui),T.image=y,T.format=G.format,T.needsUpdate=!0,o&&o(T))},u,f)}if(Array.isArray(l))for(let z=0,U=l.length;z<U;++z)I(z);else w.load(l,function(z){const U=g.parse(z,!0);if(U.isCubemap){const G=U.mipmaps.length/U.mipmapCount;for(let W=0;W<G;W++){y[W]={mipmaps:[]};for(let J=0;J<U.mipmapCount;J++)y[W].mipmaps.push(U.mipmaps[W*U.mipmapCount+J]),y[W].format=U.format,y[W].width=U.width,y[W].height=U.height}T.image=y}else T.image.width=U.width,T.image.height=U.height,T.mipmaps=U.mipmaps;U.mipmapCount===1&&(T.minFilter=Ui),T.format=U.format,T.needsUpdate=!0,o&&o(T)},u,f);return T}});function k1(l){Zr.call(this,l)}k1.prototype=X(Object.create(Zr.prototype),{constructor:k1,load:function(l,o,u,f){this.path!==void 0&&(l=this.path+l),l=this.manager.resolveURL(l);const g=this,y=Fg.get(l);if(y!==void 0)return g.manager.itemStart(l),setTimeout(function(){o&&o(y),g.manager.itemEnd(l)},0),y;const T=document.createElementNS("http://www.w3.org/1999/xhtml","img");function w(){T.removeEventListener("load",w,!1),T.removeEventListener("error",M,!1),Fg.add(l,this),o&&o(this),g.manager.itemEnd(l)}function M(I){T.removeEventListener("load",w,!1),T.removeEventListener("error",M,!1),f&&f(I),g.manager.itemError(l),g.manager.itemEnd(l)}return T.addEventListener("load",w,!1),T.addEventListener("error",M,!1),l.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(T.crossOrigin=this.crossOrigin),g.manager.itemStart(l),T.src=l,T}});function iA(l){Zr.call(this,l)}iA.prototype=X(Object.create(Zr.prototype),{constructor:iA,load:function(l,o,u,f){const g=new Ad,y=new k1(this.manager);y.setCrossOrigin(this.crossOrigin),y.setPath(this.path);let T=0;function w(M){y.load(l[M],function(I){g.images[M]=I,T++,T===6&&(g.needsUpdate=!0,o&&o(g))},void 0,f)}for(let M=0;M<l.length;++M)w(M);return g}});function bM(l){Zr.call(this,l)}bM.prototype=X(Object.create(Zr.prototype),{constructor:bM,load:function(l,o,u,f){const g=this,y=new xu,T=new Jh(this.manager);return T.setResponseType("arraybuffer"),T.setRequestHeader(this.requestHeader),T.setPath(this.path),T.setWithCredentials(g.withCredentials),T.load(l,function(w){const M=g.parse(w);M&&(M.image!==void 0?y.image=M.image:M.data!==void 0&&(y.image.width=M.width,y.image.height=M.height,y.image.data=M.data),y.wrapS=M.wrapS!==void 0?M.wrapS:oe,y.wrapT=M.wrapT!==void 0?M.wrapT:oe,y.magFilter=M.magFilter!==void 0?M.magFilter:Ui,y.minFilter=M.minFilter!==void 0?M.minFilter:Ui,y.anisotropy=M.anisotropy!==void 0?M.anisotropy:1,M.encoding!==void 0&&(y.encoding=M.encoding),M.flipY!==void 0&&(y.flipY=M.flipY),M.format!==void 0&&(y.format=M.format),M.type!==void 0&&(y.type=M.type),M.mipmaps!==void 0&&(y.mipmaps=M.mipmaps,y.minFilter=Kr),M.mipmapCount===1&&(y.minFilter=Ui),y.needsUpdate=!0,o&&o(y,M))},u,f),y}});function nA(l){Zr.call(this,l)}nA.prototype=X(Object.create(Zr.prototype),{constructor:nA,load:function(l,o,u,f){const g=new dr,y=new k1(this.manager);return y.setCrossOrigin(this.crossOrigin),y.setPath(this.path),y.load(l,function(T){g.image=T;const w=l.search(/\.jpe?g($|\?)/i)>0||l.search(/^data\:image\/jpeg/)===0;g.format=w?ta:cr,g.needsUpdate=!0,o!==void 0&&o(g)},u,f),g}});function Qi(){this.type="Curve",this.arcLengthDivisions=200}X(Qi.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(l,o){const u=this.getUtoTmapping(l);return this.getPoint(u,o)},getPoints:function(l=5){const o=[];for(let u=0;u<=l;u++)o.push(this.getPoint(u/l));return o},getSpacedPoints:function(l=5){const o=[];for(let u=0;u<=l;u++)o.push(this.getPointAt(u/l));return o},getLength:function(){const l=this.getLengths();return l[l.length-1]},getLengths:function(l){if(l===void 0&&(l=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===l+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const o=[];let u,f=this.getPoint(0),g=0;o.push(0);for(let y=1;y<=l;y++)u=this.getPoint(y/l),g+=u.distanceTo(f),o.push(g),f=u;return this.cacheArcLengths=o,o},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(l,o){const u=this.getLengths();let f=0;const g=u.length;let y;o?y=o:y=l*u[g-1];let T=0,w=g-1,M;for(;T<=w;)if(f=Math.floor(T+(w-T)/2),M=u[f]-y,M<0)T=f+1;else if(M>0)w=f-1;else{w=f;break}if(f=w,u[f]===y)return f/(g-1);const I=u[f],U=u[f+1]-I,G=(y-I)/U;return(f+G)/(g-1)},getTangent:function(l,o){let f=l-1e-4,g=l+1e-4;f<0&&(f=0),g>1&&(g=1);const y=this.getPoint(f),T=this.getPoint(g),w=o||(y.isVector2?new At:new Be);return w.copy(T).sub(y).normalize(),w},getTangentAt:function(l,o){const u=this.getUtoTmapping(l);return this.getTangent(u,o)},computeFrenetFrames:function(l,o){const u=new Be,f=[],g=[],y=[],T=new Be,w=new fn;for(let G=0;G<=l;G++){const W=G/l;f[G]=this.getTangentAt(W,new Be),f[G].normalize()}g[0]=new Be,y[0]=new Be;let M=Number.MAX_VALUE;const I=Math.abs(f[0].x),z=Math.abs(f[0].y),U=Math.abs(f[0].z);I<=M&&(M=I,u.set(1,0,0)),z<=M&&(M=z,u.set(0,1,0)),U<=M&&u.set(0,0,1),T.crossVectors(f[0],u).normalize(),g[0].crossVectors(f[0],T),y[0].crossVectors(f[0],g[0]);for(let G=1;G<=l;G++){if(g[G]=g[G-1].clone(),y[G]=y[G-1].clone(),T.crossVectors(f[G-1],f[G]),T.length()>Number.EPSILON){T.normalize();const W=Math.acos(Gi.clamp(f[G-1].dot(f[G]),-1,1));g[G].applyMatrix4(w.makeRotationAxis(T,W))}y[G].crossVectors(f[G],g[G])}if(o===!0){let G=Math.acos(Gi.clamp(g[0].dot(g[l]),-1,1));G/=l,f[0].dot(T.crossVectors(g[0],g[l]))>0&&(G=-G);for(let W=1;W<=l;W++)g[W].applyMatrix4(w.makeRotationAxis(f[W],G*W)),y[W].crossVectors(f[W],g[W])}return{tangents:f,normals:g,binormals:y}},clone:function(){return new this.constructor().copy(this)},copy:function(l){return this.arcLengthDivisions=l.arcLengthDivisions,this},toJSON:function(){const l={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return l.arcLengthDivisions=this.arcLengthDivisions,l.type=this.type,l},fromJSON:function(l){return this.arcLengthDivisions=l.arcLengthDivisions,this}});function cc(l,o,u,f,g,y,T,w){Qi.call(this),this.type="EllipseCurve",this.aX=l||0,this.aY=o||0,this.xRadius=u||1,this.yRadius=f||1,this.aStartAngle=g||0,this.aEndAngle=y||2*Math.PI,this.aClockwise=T||!1,this.aRotation=w||0}cc.prototype=Object.create(Qi.prototype),cc.prototype.constructor=cc,cc.prototype.isEllipseCurve=!0,cc.prototype.getPoint=function(l,o){const u=o||new At,f=Math.PI*2;let g=this.aEndAngle-this.aStartAngle;const y=Math.abs(g)<Number.EPSILON;for(;g<0;)g+=f;for(;g>f;)g-=f;g<Number.EPSILON&&(y?g=0:g=f),this.aClockwise===!0&&!y&&(g===f?g=-f:g=g-f);const T=this.aStartAngle+l*g;let w=this.aX+this.xRadius*Math.cos(T),M=this.aY+this.yRadius*Math.sin(T);if(this.aRotation!==0){const I=Math.cos(this.aRotation),z=Math.sin(this.aRotation),U=w-this.aX,G=M-this.aY;w=U*I-G*z+this.aX,M=U*z+G*I+this.aY}return u.set(w,M)},cc.prototype.copy=function(l){return Qi.prototype.copy.call(this,l),this.aX=l.aX,this.aY=l.aY,this.xRadius=l.xRadius,this.yRadius=l.yRadius,this.aStartAngle=l.aStartAngle,this.aEndAngle=l.aEndAngle,this.aClockwise=l.aClockwise,this.aRotation=l.aRotation,this},cc.prototype.toJSON=function(){const l=Qi.prototype.toJSON.call(this);return l.aX=this.aX,l.aY=this.aY,l.xRadius=this.xRadius,l.yRadius=this.yRadius,l.aStartAngle=this.aStartAngle,l.aEndAngle=this.aEndAngle,l.aClockwise=this.aClockwise,l.aRotation=this.aRotation,l},cc.prototype.fromJSON=function(l){return Qi.prototype.fromJSON.call(this,l),this.aX=l.aX,this.aY=l.aY,this.xRadius=l.xRadius,this.yRadius=l.yRadius,this.aStartAngle=l.aStartAngle,this.aEndAngle=l.aEndAngle,this.aClockwise=l.aClockwise,this.aRotation=l.aRotation,this};function xy(l,o,u,f,g,y){cc.call(this,l,o,u,u,f,g,y),this.type="ArcCurve"}xy.prototype=Object.create(cc.prototype),xy.prototype.constructor=xy,xy.prototype.isArcCurve=!0;function rA(){let l=0,o=0,u=0,f=0;function g(y,T,w,M){l=y,o=w,u=-3*y+3*T-2*w-M,f=2*y-2*T+w+M}return{initCatmullRom:function(y,T,w,M,I){g(T,w,I*(w-y),I*(M-T))},initNonuniformCatmullRom:function(y,T,w,M,I,z,U){let G=(T-y)/I-(w-y)/(I+z)+(w-T)/z,W=(w-T)/z-(M-T)/(z+U)+(M-w)/U;G*=z,W*=z,g(T,w,G,W)},calc:function(y){const T=y*y,w=T*y;return l+o*y+u*T+f*w}}}const O1=new Be,sA=new rA,aA=new rA,oA=new rA;function Uc(l=[],o=!1,u="centripetal",f=.5){Qi.call(this),this.type="CatmullRomCurve3",this.points=l,this.closed=o,this.curveType=u,this.tension=f}Uc.prototype=Object.create(Qi.prototype),Uc.prototype.constructor=Uc,Uc.prototype.isCatmullRomCurve3=!0,Uc.prototype.getPoint=function(l,o=new Be){const u=o,f=this.points,g=f.length,y=(g-(this.closed?0:1))*l;let T=Math.floor(y),w=y-T;this.closed?T+=T>0?0:(Math.floor(Math.abs(T)/g)+1)*g:w===0&&T===g-1&&(T=g-2,w=1);let M,I;this.closed||T>0?M=f[(T-1)%g]:(O1.subVectors(f[0],f[1]).add(f[0]),M=O1);const z=f[T%g],U=f[(T+1)%g];if(this.closed||T+2<g?I=f[(T+2)%g]:(O1.subVectors(f[g-1],f[g-2]).add(f[g-1]),I=O1),this.curveType==="centripetal"||this.curveType==="chordal"){const G=this.curveType==="chordal"?.5:.25;let W=Math.pow(M.distanceToSquared(z),G),J=Math.pow(z.distanceToSquared(U),G),me=Math.pow(U.distanceToSquared(I),G);J<1e-4&&(J=1),W<1e-4&&(W=J),me<1e-4&&(me=J),sA.initNonuniformCatmullRom(M.x,z.x,U.x,I.x,W,J,me),aA.initNonuniformCatmullRom(M.y,z.y,U.y,I.y,W,J,me),oA.initNonuniformCatmullRom(M.z,z.z,U.z,I.z,W,J,me)}else this.curveType==="catmullrom"&&(sA.initCatmullRom(M.x,z.x,U.x,I.x,this.tension),aA.initCatmullRom(M.y,z.y,U.y,I.y,this.tension),oA.initCatmullRom(M.z,z.z,U.z,I.z,this.tension));return u.set(sA.calc(w),aA.calc(w),oA.calc(w)),u},Uc.prototype.copy=function(l){Qi.prototype.copy.call(this,l),this.points=[];for(let o=0,u=l.points.length;o<u;o++){const f=l.points[o];this.points.push(f.clone())}return this.closed=l.closed,this.curveType=l.curveType,this.tension=l.tension,this},Uc.prototype.toJSON=function(){const l=Qi.prototype.toJSON.call(this);l.points=[];for(let o=0,u=this.points.length;o<u;o++){const f=this.points[o];l.points.push(f.toArray())}return l.closed=this.closed,l.curveType=this.curveType,l.tension=this.tension,l},Uc.prototype.fromJSON=function(l){Qi.prototype.fromJSON.call(this,l),this.points=[];for(let o=0,u=l.points.length;o<u;o++){const f=l.points[o];this.points.push(new Be().fromArray(f))}return this.closed=l.closed,this.curveType=l.curveType,this.tension=l.tension,this};function TM(l,o,u,f,g){const y=(f-o)*.5,T=(g-u)*.5,w=l*l,M=l*w;return(2*u-2*f+y+T)*M+(-3*u+3*f-2*y-T)*w+y*l+u}function TN(l,o){const u=1-l;return u*u*o}function xN(l,o){return 2*(1-l)*l*o}function SN(l,o){return l*l*o}function Sy(l,o,u,f){return TN(l,o)+xN(l,u)+SN(l,f)}function AN(l,o){const u=1-l;return u*u*u*o}function wN(l,o){const u=1-l;return 3*u*u*l*o}function EN(l,o){return 3*(1-l)*l*l*o}function CN(l,o){return l*l*l*o}function Ay(l,o,u,f,g){return AN(l,o)+wN(l,u)+EN(l,f)+CN(l,g)}function Vd(l=new At,o=new At,u=new At,f=new At){Qi.call(this),this.type="CubicBezierCurve",this.v0=l,this.v1=o,this.v2=u,this.v3=f}Vd.prototype=Object.create(Qi.prototype),Vd.prototype.constructor=Vd,Vd.prototype.isCubicBezierCurve=!0,Vd.prototype.getPoint=function(l,o=new At){const u=o,f=this.v0,g=this.v1,y=this.v2,T=this.v3;return u.set(Ay(l,f.x,g.x,y.x,T.x),Ay(l,f.y,g.y,y.y,T.y)),u},Vd.prototype.copy=function(l){return Qi.prototype.copy.call(this,l),this.v0.copy(l.v0),this.v1.copy(l.v1),this.v2.copy(l.v2),this.v3.copy(l.v3),this},Vd.prototype.toJSON=function(){const l=Qi.prototype.toJSON.call(this);return l.v0=this.v0.toArray(),l.v1=this.v1.toArray(),l.v2=this.v2.toArray(),l.v3=this.v3.toArray(),l},Vd.prototype.fromJSON=function(l){return Qi.prototype.fromJSON.call(this,l),this.v0.fromArray(l.v0),this.v1.fromArray(l.v1),this.v2.fromArray(l.v2),this.v3.fromArray(l.v3),this};function ef(l=new Be,o=new Be,u=new Be,f=new Be){Qi.call(this),this.type="CubicBezierCurve3",this.v0=l,this.v1=o,this.v2=u,this.v3=f}ef.prototype=Object.create(Qi.prototype),ef.prototype.constructor=ef,ef.prototype.isCubicBezierCurve3=!0,ef.prototype.getPoint=function(l,o=new Be){const u=o,f=this.v0,g=this.v1,y=this.v2,T=this.v3;return u.set(Ay(l,f.x,g.x,y.x,T.x),Ay(l,f.y,g.y,y.y,T.y),Ay(l,f.z,g.z,y.z,T.z)),u},ef.prototype.copy=function(l){return Qi.prototype.copy.call(this,l),this.v0.copy(l.v0),this.v1.copy(l.v1),this.v2.copy(l.v2),this.v3.copy(l.v3),this},ef.prototype.toJSON=function(){const l=Qi.prototype.toJSON.call(this);return l.v0=this.v0.toArray(),l.v1=this.v1.toArray(),l.v2=this.v2.toArray(),l.v3=this.v3.toArray(),l},ef.prototype.fromJSON=function(l){return Qi.prototype.fromJSON.call(this,l),this.v0.fromArray(l.v0),this.v1.fromArray(l.v1),this.v2.fromArray(l.v2),this.v3.fromArray(l.v3),this};function Du(l=new At,o=new At){Qi.call(this),this.type="LineCurve",this.v1=l,this.v2=o}Du.prototype=Object.create(Qi.prototype),Du.prototype.constructor=Du,Du.prototype.isLineCurve=!0,Du.prototype.getPoint=function(l,o=new At){const u=o;return l===1?u.copy(this.v2):(u.copy(this.v2).sub(this.v1),u.multiplyScalar(l).add(this.v1)),u},Du.prototype.getPointAt=function(l,o){return this.getPoint(l,o)},Du.prototype.getTangent=function(l,o){const u=o||new At;return u.copy(this.v2).sub(this.v1).normalize(),u},Du.prototype.copy=function(l){return Qi.prototype.copy.call(this,l),this.v1.copy(l.v1),this.v2.copy(l.v2),this},Du.prototype.toJSON=function(){const l=Qi.prototype.toJSON.call(this);return l.v1=this.v1.toArray(),l.v2=this.v2.toArray(),l},Du.prototype.fromJSON=function(l){return Qi.prototype.fromJSON.call(this,l),this.v1.fromArray(l.v1),this.v2.fromArray(l.v2),this};function zd(l=new Be,o=new Be){Qi.call(this),this.type="LineCurve3",this.v1=l,this.v2=o}zd.prototype=Object.create(Qi.prototype),zd.prototype.constructor=zd,zd.prototype.isLineCurve3=!0,zd.prototype.getPoint=function(l,o=new Be){const u=o;return l===1?u.copy(this.v2):(u.copy(this.v2).sub(this.v1),u.multiplyScalar(l).add(this.v1)),u},zd.prototype.getPointAt=function(l,o){return this.getPoint(l,o)},zd.prototype.copy=function(l){return Qi.prototype.copy.call(this,l),this.v1.copy(l.v1),this.v2.copy(l.v2),this},zd.prototype.toJSON=function(){const l=Qi.prototype.toJSON.call(this);return l.v1=this.v1.toArray(),l.v2=this.v2.toArray(),l},zd.prototype.fromJSON=function(l){return Qi.prototype.fromJSON.call(this,l),this.v1.fromArray(l.v1),this.v2.fromArray(l.v2),this};function Hd(l=new At,o=new At,u=new At){Qi.call(this),this.type="QuadraticBezierCurve",this.v0=l,this.v1=o,this.v2=u}Hd.prototype=Object.create(Qi.prototype),Hd.prototype.constructor=Hd,Hd.prototype.isQuadraticBezierCurve=!0,Hd.prototype.getPoint=function(l,o=new At){const u=o,f=this.v0,g=this.v1,y=this.v2;return u.set(Sy(l,f.x,g.x,y.x),Sy(l,f.y,g.y,y.y)),u},Hd.prototype.copy=function(l){return Qi.prototype.copy.call(this,l),this.v0.copy(l.v0),this.v1.copy(l.v1),this.v2.copy(l.v2),this},Hd.prototype.toJSON=function(){const l=Qi.prototype.toJSON.call(this);return l.v0=this.v0.toArray(),l.v1=this.v1.toArray(),l.v2=this.v2.toArray(),l},Hd.prototype.fromJSON=function(l){return Qi.prototype.fromJSON.call(this,l),this.v0.fromArray(l.v0),this.v1.fromArray(l.v1),this.v2.fromArray(l.v2),this};function tf(l=new Be,o=new Be,u=new Be){Qi.call(this),this.type="QuadraticBezierCurve3",this.v0=l,this.v1=o,this.v2=u}tf.prototype=Object.create(Qi.prototype),tf.prototype.constructor=tf,tf.prototype.isQuadraticBezierCurve3=!0,tf.prototype.getPoint=function(l,o=new Be){const u=o,f=this.v0,g=this.v1,y=this.v2;return u.set(Sy(l,f.x,g.x,y.x),Sy(l,f.y,g.y,y.y),Sy(l,f.z,g.z,y.z)),u},tf.prototype.copy=function(l){return Qi.prototype.copy.call(this,l),this.v0.copy(l.v0),this.v1.copy(l.v1),this.v2.copy(l.v2),this},tf.prototype.toJSON=function(){const l=Qi.prototype.toJSON.call(this);return l.v0=this.v0.toArray(),l.v1=this.v1.toArray(),l.v2=this.v2.toArray(),l},tf.prototype.fromJSON=function(l){return Qi.prototype.fromJSON.call(this,l),this.v0.fromArray(l.v0),this.v1.fromArray(l.v1),this.v2.fromArray(l.v2),this};function jd(l=[]){Qi.call(this),this.type="SplineCurve",this.points=l}jd.prototype=Object.create(Qi.prototype),jd.prototype.constructor=jd,jd.prototype.isSplineCurve=!0,jd.prototype.getPoint=function(l,o=new At){const u=o,f=this.points,g=(f.length-1)*l,y=Math.floor(g),T=g-y,w=f[y===0?y:y-1],M=f[y],I=f[y>f.length-2?f.length-1:y+1],z=f[y>f.length-3?f.length-1:y+2];return u.set(TM(T,w.x,M.x,I.x,z.x),TM(T,w.y,M.y,I.y,z.y)),u},jd.prototype.copy=function(l){Qi.prototype.copy.call(this,l),this.points=[];for(let o=0,u=l.points.length;o<u;o++){const f=l.points[o];this.points.push(f.clone())}return this},jd.prototype.toJSON=function(){const l=Qi.prototype.toJSON.call(this);l.points=[];for(let o=0,u=this.points.length;o<u;o++){const f=this.points[o];l.points.push(f.toArray())}return l},jd.prototype.fromJSON=function(l){Qi.prototype.fromJSON.call(this,l),this.points=[];for(let o=0,u=l.points.length;o<u;o++){const f=l.points[o];this.points.push(new At().fromArray(f))}return this};var MN=Object.freeze({__proto__:null,ArcCurve:xy,CatmullRomCurve3:Uc,CubicBezierCurve:Vd,CubicBezierCurve3:ef,EllipseCurve:cc,LineCurve:Du,LineCurve3:zd,QuadraticBezierCurve:Hd,QuadraticBezierCurve3:tf,SplineCurve:jd});function gm(){Qi.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}gm.prototype=X(Object.create(Qi.prototype),{constructor:gm,add:function(l){this.curves.push(l)},closePath:function(){const l=this.curves[0].getPoint(0),o=this.curves[this.curves.length-1].getPoint(1);l.equals(o)||this.curves.push(new Du(o,l))},getPoint:function(l){const o=l*this.getLength(),u=this.getCurveLengths();let f=0;for(;f<u.length;){if(u[f]>=o){const g=u[f]-o,y=this.curves[f],T=y.getLength(),w=T===0?0:1-g/T;return y.getPointAt(w)}f++}return null},getLength:function(){const l=this.getCurveLengths();return l[l.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const l=[];let o=0;for(let u=0,f=this.curves.length;u<f;u++)o+=this.curves[u].getLength(),l.push(o);return this.cacheLengths=l,l},getSpacedPoints:function(l=40){const o=[];for(let u=0;u<=l;u++)o.push(this.getPoint(u/l));return this.autoClose&&o.push(o[0]),o},getPoints:function(l=12){const o=[];let u;for(let f=0,g=this.curves;f<g.length;f++){const y=g[f],T=y&&y.isEllipseCurve?l*2:y&&(y.isLineCurve||y.isLineCurve3)?1:y&&y.isSplineCurve?l*y.points.length:l,w=y.getPoints(T);for(let M=0;M<w.length;M++){const I=w[M];u&&u.equals(I)||(o.push(I),u=I)}}return this.autoClose&&o.length>1&&!o[o.length-1].equals(o[0])&&o.push(o[0]),o},copy:function(l){Qi.prototype.copy.call(this,l),this.curves=[];for(let o=0,u=l.curves.length;o<u;o++){const f=l.curves[o];this.curves.push(f.clone())}return this.autoClose=l.autoClose,this},toJSON:function(){const l=Qi.prototype.toJSON.call(this);l.autoClose=this.autoClose,l.curves=[];for(let o=0,u=this.curves.length;o<u;o++){const f=this.curves[o];l.curves.push(f.toJSON())}return l},fromJSON:function(l){Qi.prototype.fromJSON.call(this,l),this.autoClose=l.autoClose,this.curves=[];for(let o=0,u=l.curves.length;o<u;o++){const f=l.curves[o];this.curves.push(new MN[f.type]().fromJSON(f))}return this}});function Gd(l){gm.call(this),this.type="Path",this.currentPoint=new At,l&&this.setFromPoints(l)}Gd.prototype=X(Object.create(gm.prototype),{constructor:Gd,setFromPoints:function(l){this.moveTo(l[0].x,l[0].y);for(let o=1,u=l.length;o<u;o++)this.lineTo(l[o].x,l[o].y);return this},moveTo:function(l,o){return this.currentPoint.set(l,o),this},lineTo:function(l,o){const u=new Du(this.currentPoint.clone(),new At(l,o));return this.curves.push(u),this.currentPoint.set(l,o),this},quadraticCurveTo:function(l,o,u,f){const g=new Hd(this.currentPoint.clone(),new At(l,o),new At(u,f));return this.curves.push(g),this.currentPoint.set(u,f),this},bezierCurveTo:function(l,o,u,f,g,y){const T=new Vd(this.currentPoint.clone(),new At(l,o),new At(u,f),new At(g,y));return this.curves.push(T),this.currentPoint.set(g,y),this},splineThru:function(l){const o=[this.currentPoint.clone()].concat(l),u=new jd(o);return this.curves.push(u),this.currentPoint.copy(l[l.length-1]),this},arc:function(l,o,u,f,g,y){const T=this.currentPoint.x,w=this.currentPoint.y;return this.absarc(l+T,o+w,u,f,g,y),this},absarc:function(l,o,u,f,g,y){return this.absellipse(l,o,u,u,f,g,y),this},ellipse:function(l,o,u,f,g,y,T,w){const M=this.currentPoint.x,I=this.currentPoint.y;return this.absellipse(l+M,o+I,u,f,g,y,T,w),this},absellipse:function(l,o,u,f,g,y,T,w){const M=new cc(l,o,u,f,g,y,T,w);if(this.curves.length>0){const z=M.getPoint(0);z.equals(this.currentPoint)||this.lineTo(z.x,z.y)}this.curves.push(M);const I=M.getPoint(1);return this.currentPoint.copy(I),this},copy:function(l){return gm.prototype.copy.call(this,l),this.currentPoint.copy(l.currentPoint),this},toJSON:function(){const l=gm.prototype.toJSON.call(this);return l.currentPoint=this.currentPoint.toArray(),l},fromJSON:function(l){return gm.prototype.fromJSON.call(this,l),this.currentPoint.fromArray(l.currentPoint),this}});function Bg(l){Gd.call(this,l),this.uuid=Gi.generateUUID(),this.type="Shape",this.holes=[]}Bg.prototype=X(Object.create(Gd.prototype),{constructor:Bg,getPointsHoles:function(l){const o=[];for(let u=0,f=this.holes.length;u<f;u++)o[u]=this.holes[u].getPoints(l);return o},extractPoints:function(l){return{shape:this.getPoints(l),holes:this.getPointsHoles(l)}},copy:function(l){Gd.prototype.copy.call(this,l),this.holes=[];for(let o=0,u=l.holes.length;o<u;o++){const f=l.holes[o];this.holes.push(f.clone())}return this},toJSON:function(){const l=Gd.prototype.toJSON.call(this);l.uuid=this.uuid,l.holes=[];for(let o=0,u=this.holes.length;o<u;o++){const f=this.holes[o];l.holes.push(f.toJSON())}return l},fromJSON:function(l){Gd.prototype.fromJSON.call(this,l),this.uuid=l.uuid,this.holes=[];for(let o=0,u=l.holes.length;o<u;o++){const f=l.holes[o];this.holes.push(new Gd().fromJSON(f))}return this}});function ps(l,o=1){Li.call(this),this.type="Light",this.color=new Fi(l),this.intensity=o}ps.prototype=X(Object.create(Li.prototype),{constructor:ps,isLight:!0,copy:function(l){return Li.prototype.copy.call(this,l),this.color.copy(l.color),this.intensity=l.intensity,this},toJSON:function(l){const o=Li.prototype.toJSON.call(this,l);return o.object.color=this.color.getHex(),o.object.intensity=this.intensity,this.groundColor!==void 0&&(o.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(o.object.distance=this.distance),this.angle!==void 0&&(o.object.angle=this.angle),this.decay!==void 0&&(o.object.decay=this.decay),this.penumbra!==void 0&&(o.object.penumbra=this.penumbra),this.shadow!==void 0&&(o.object.shadow=this.shadow.toJSON()),o}});function xM(l,o,u){ps.call(this,l,u),this.type="HemisphereLight",this.position.copy(Li.DefaultUp),this.updateMatrix(),this.groundColor=new Fi(o)}xM.prototype=X(Object.create(ps.prototype),{constructor:xM,isHemisphereLight:!0,copy:function(l){return ps.prototype.copy.call(this,l),this.groundColor.copy(l.groundColor),this}});function nf(l){this.camera=l,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new At(512,512),this.map=null,this.mapPass=null,this.matrix=new fn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Bh,this._frameExtents=new At(1,1),this._viewportCount=1,this._viewports=[new Yn(0,0,1,1)]}X(nf.prototype,{_projScreenMatrix:new fn,_lightPositionWorld:new Be,_lookTarget:new Be,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(l){const o=this.camera,u=this.matrix,f=this._projScreenMatrix,g=this._lookTarget,y=this._lightPositionWorld;y.setFromMatrixPosition(l.matrixWorld),o.position.copy(y),g.setFromMatrixPosition(l.target.matrixWorld),o.lookAt(g),o.updateMatrixWorld(),f.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),this._frustum.setFromProjectionMatrix(f),u.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),u.multiply(o.projectionMatrix),u.multiply(o.matrixWorldInverse)},getViewport:function(l){return this._viewports[l]},getFrameExtents:function(){return this._frameExtents},copy:function(l){return this.camera=l.camera.clone(),this.bias=l.bias,this.radius=l.radius,this.mapSize.copy(l.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const l={};return this.bias!==0&&(l.bias=this.bias),this.normalBias!==0&&(l.normalBias=this.normalBias),this.radius!==1&&(l.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(l.mapSize=this.mapSize.toArray()),l.camera=this.camera.toJSON(!1).object,delete l.camera.matrix,l}});function lA(){nf.call(this,new fr(50,1,.5,500)),this.focus=1}lA.prototype=X(Object.create(nf.prototype),{constructor:lA,isSpotLightShadow:!0,updateMatrices:function(l){const o=this.camera,u=Gi.RAD2DEG*2*l.angle*this.focus,f=this.mapSize.width/this.mapSize.height,g=l.distance||o.far;(u!==o.fov||f!==o.aspect||g!==o.far)&&(o.fov=u,o.aspect=f,o.far=g,o.updateProjectionMatrix()),nf.prototype.updateMatrices.call(this,l)}});function SM(l,o,u,f,g,y){ps.call(this,l,o),this.type="SpotLight",this.position.copy(Li.DefaultUp),this.updateMatrix(),this.target=new Li,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(T){this.intensity=T/Math.PI}}),this.distance=u!==void 0?u:0,this.angle=f!==void 0?f:Math.PI/3,this.penumbra=g!==void 0?g:0,this.decay=y!==void 0?y:1,this.shadow=new lA}SM.prototype=X(Object.create(ps.prototype),{constructor:SM,isSpotLight:!0,copy:function(l){return ps.prototype.copy.call(this,l),this.distance=l.distance,this.angle=l.angle,this.penumbra=l.penumbra,this.decay=l.decay,this.target=l.target.clone(),this.shadow=l.shadow.clone(),this}});function uA(){nf.call(this,new fr(90,1,.5,500)),this._frameExtents=new At(4,2),this._viewportCount=6,this._viewports=[new Yn(2,1,1,1),new Yn(0,1,1,1),new Yn(3,1,1,1),new Yn(1,1,1,1),new Yn(3,0,1,1),new Yn(1,0,1,1)],this._cubeDirections=[new Be(1,0,0),new Be(-1,0,0),new Be(0,0,1),new Be(0,0,-1),new Be(0,1,0),new Be(0,-1,0)],this._cubeUps=[new Be(0,1,0),new Be(0,1,0),new Be(0,1,0),new Be(0,1,0),new Be(0,0,1),new Be(0,0,-1)]}uA.prototype=X(Object.create(nf.prototype),{constructor:uA,isPointLightShadow:!0,updateMatrices:function(l,o=0){const u=this.camera,f=this.matrix,g=this._lightPositionWorld,y=this._lookTarget,T=this._projScreenMatrix;g.setFromMatrixPosition(l.matrixWorld),u.position.copy(g),y.copy(u.position),y.add(this._cubeDirections[o]),u.up.copy(this._cubeUps[o]),u.lookAt(y),u.updateMatrixWorld(),f.makeTranslation(-g.x,-g.y,-g.z),T.multiplyMatrices(u.projectionMatrix,u.matrixWorldInverse),this._frustum.setFromProjectionMatrix(T)}});function AM(l,o,u,f){ps.call(this,l,o),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(g){this.intensity=g/(4*Math.PI)}}),this.distance=u!==void 0?u:0,this.decay=f!==void 0?f:1,this.shadow=new uA}AM.prototype=X(Object.create(ps.prototype),{constructor:AM,isPointLight:!0,copy:function(l){return ps.prototype.copy.call(this,l),this.distance=l.distance,this.decay=l.decay,this.shadow=l.shadow.clone(),this}});function cA(l=-1,o=1,u=1,f=-1,g=.1,y=2e3){lo.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=l,this.right=o,this.top=u,this.bottom=f,this.near=g,this.far=y,this.updateProjectionMatrix()}cA.prototype=X(Object.create(lo.prototype),{constructor:cA,isOrthographicCamera:!0,copy:function(l,o){return lo.prototype.copy.call(this,l,o),this.left=l.left,this.right=l.right,this.top=l.top,this.bottom=l.bottom,this.near=l.near,this.far=l.far,this.zoom=l.zoom,this.view=l.view===null?null:X({},l.view),this},setViewOffset:function(l,o,u,f,g,y){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=l,this.view.fullHeight=o,this.view.offsetX=u,this.view.offsetY=f,this.view.width=g,this.view.height=y,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const l=(this.right-this.left)/(2*this.zoom),o=(this.top-this.bottom)/(2*this.zoom),u=(this.right+this.left)/2,f=(this.top+this.bottom)/2;let g=u-l,y=u+l,T=f+o,w=f-o;if(this.view!==null&&this.view.enabled){const M=(this.right-this.left)/this.view.fullWidth/this.zoom,I=(this.top-this.bottom)/this.view.fullHeight/this.zoom;g+=M*this.view.offsetX,y=g+M*this.view.width,T-=I*this.view.offsetY,w=T-I*this.view.height}this.projectionMatrix.makeOrthographic(g,y,T,w,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(l){const o=Li.prototype.toJSON.call(this,l);return o.object.zoom=this.zoom,o.object.left=this.left,o.object.right=this.right,o.object.top=this.top,o.object.bottom=this.bottom,o.object.near=this.near,o.object.far=this.far,this.view!==null&&(o.object.view=X({},this.view)),o}});function dA(){nf.call(this,new cA(-5,5,5,-5,.5,500))}dA.prototype=X(Object.create(nf.prototype),{constructor:dA,isDirectionalLightShadow:!0,updateMatrices:function(l){nf.prototype.updateMatrices.call(this,l)}});function wM(l,o){ps.call(this,l,o),this.type="DirectionalLight",this.position.copy(Li.DefaultUp),this.updateMatrix(),this.target=new Li,this.shadow=new dA}wM.prototype=X(Object.create(ps.prototype),{constructor:wM,isDirectionalLight:!0,copy:function(l){return ps.prototype.copy.call(this,l),this.target=l.target.clone(),this.shadow=l.shadow.clone(),this}});function EM(l,o){ps.call(this,l,o),this.type="AmbientLight"}EM.prototype=X(Object.create(ps.prototype),{constructor:EM,isAmbientLight:!0});function CM(l,o,u,f){ps.call(this,l,o),this.type="RectAreaLight",this.width=u!==void 0?u:10,this.height=f!==void 0?f:10}CM.prototype=X(Object.create(ps.prototype),{constructor:CM,isRectAreaLight:!0,copy:function(l){return ps.prototype.copy.call(this,l),this.width=l.width,this.height=l.height,this},toJSON:function(l){const o=ps.prototype.toJSON.call(this,l);return o.object.width=this.width,o.object.height=this.height,o}});class DN{constructor(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(let o=0;o<9;o++)this.coefficients.push(new Be)}set(o){for(let u=0;u<9;u++)this.coefficients[u].copy(o[u]);return this}zero(){for(let o=0;o<9;o++)this.coefficients[o].set(0,0,0);return this}getAt(o,u){const f=o.x,g=o.y,y=o.z,T=this.coefficients;return u.copy(T[0]).multiplyScalar(.282095),u.addScaledVector(T[1],.488603*g),u.addScaledVector(T[2],.488603*y),u.addScaledVector(T[3],.488603*f),u.addScaledVector(T[4],1.092548*(f*g)),u.addScaledVector(T[5],1.092548*(g*y)),u.addScaledVector(T[6],.315392*(3*y*y-1)),u.addScaledVector(T[7],1.092548*(f*y)),u.addScaledVector(T[8],.546274*(f*f-g*g)),u}getIrradianceAt(o,u){const f=o.x,g=o.y,y=o.z,T=this.coefficients;return u.copy(T[0]).multiplyScalar(.886227),u.addScaledVector(T[1],2*.511664*g),u.addScaledVector(T[2],2*.511664*y),u.addScaledVector(T[3],2*.511664*f),u.addScaledVector(T[4],2*.429043*f*g),u.addScaledVector(T[5],2*.429043*g*y),u.addScaledVector(T[6],.743125*y*y-.247708),u.addScaledVector(T[7],2*.429043*f*y),u.addScaledVector(T[8],.429043*(f*f-g*g)),u}add(o){for(let u=0;u<9;u++)this.coefficients[u].add(o.coefficients[u]);return this}addScaledSH(o,u){for(let f=0;f<9;f++)this.coefficients[f].addScaledVector(o.coefficients[f],u);return this}scale(o){for(let u=0;u<9;u++)this.coefficients[u].multiplyScalar(o);return this}lerp(o,u){for(let f=0;f<9;f++)this.coefficients[f].lerp(o.coefficients[f],u);return this}equals(o){for(let u=0;u<9;u++)if(!this.coefficients[u].equals(o.coefficients[u]))return!1;return!0}copy(o){return this.set(o.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(o,u=0){const f=this.coefficients;for(let g=0;g<9;g++)f[g].fromArray(o,u+g*3);return this}toArray(o=[],u=0){const f=this.coefficients;for(let g=0;g<9;g++)f[g].toArray(o,u+g*3);return o}static getBasisAt(o,u){const f=o.x,g=o.y,y=o.z;u[0]=.282095,u[1]=.488603*g,u[2]=.488603*y,u[3]=.488603*f,u[4]=1.092548*f*g,u[5]=1.092548*g*y,u[6]=.315392*(3*y*y-1),u[7]=1.092548*f*y,u[8]=.546274*(f*f-g*g)}}function $d(l,o){ps.call(this,void 0,o),this.type="LightProbe",this.sh=l!==void 0?l:new DN}$d.prototype=X(Object.create(ps.prototype),{constructor:$d,isLightProbe:!0,copy:function(l){return ps.prototype.copy.call(this,l),this.sh.copy(l.sh),this},fromJSON:function(l){return this.intensity=l.intensity,this.sh.fromArray(l.sh),this},toJSON:function(l){const o=ps.prototype.toJSON.call(this,l);return o.object.sh=this.sh.toArray(),o}});function MM(l){Zr.call(this,l),this.textures={}}MM.prototype=X(Object.create(Zr.prototype),{constructor:MM,load:function(l,o,u,f){const g=this,y=new Jh(g.manager);y.setPath(g.path),y.setRequestHeader(g.requestHeader),y.setWithCredentials(g.withCredentials),y.load(l,function(T){try{o(g.parse(JSON.parse(T)))}catch(w){f?f(w):console.error(w),g.manager.itemError(l)}},u,f)},parse:function(l){const o=this.textures;function u(g){return o[g]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",g),o[g]}const f=new gN[l.type];if(l.uuid!==void 0&&(f.uuid=l.uuid),l.name!==void 0&&(f.name=l.name),l.color!==void 0&&f.color!==void 0&&f.color.setHex(l.color),l.roughness!==void 0&&(f.roughness=l.roughness),l.metalness!==void 0&&(f.metalness=l.metalness),l.sheen!==void 0&&(f.sheen=new Fi().setHex(l.sheen)),l.emissive!==void 0&&f.emissive!==void 0&&f.emissive.setHex(l.emissive),l.specular!==void 0&&f.specular!==void 0&&f.specular.setHex(l.specular),l.shininess!==void 0&&(f.shininess=l.shininess),l.clearcoat!==void 0&&(f.clearcoat=l.clearcoat),l.clearcoatRoughness!==void 0&&(f.clearcoatRoughness=l.clearcoatRoughness),l.fog!==void 0&&(f.fog=l.fog),l.flatShading!==void 0&&(f.flatShading=l.flatShading),l.blending!==void 0&&(f.blending=l.blending),l.combine!==void 0&&(f.combine=l.combine),l.side!==void 0&&(f.side=l.side),l.opacity!==void 0&&(f.opacity=l.opacity),l.transparent!==void 0&&(f.transparent=l.transparent),l.alphaTest!==void 0&&(f.alphaTest=l.alphaTest),l.depthTest!==void 0&&(f.depthTest=l.depthTest),l.depthWrite!==void 0&&(f.depthWrite=l.depthWrite),l.colorWrite!==void 0&&(f.colorWrite=l.colorWrite),l.stencilWrite!==void 0&&(f.stencilWrite=l.stencilWrite),l.stencilWriteMask!==void 0&&(f.stencilWriteMask=l.stencilWriteMask),l.stencilFunc!==void 0&&(f.stencilFunc=l.stencilFunc),l.stencilRef!==void 0&&(f.stencilRef=l.stencilRef),l.stencilFuncMask!==void 0&&(f.stencilFuncMask=l.stencilFuncMask),l.stencilFail!==void 0&&(f.stencilFail=l.stencilFail),l.stencilZFail!==void 0&&(f.stencilZFail=l.stencilZFail),l.stencilZPass!==void 0&&(f.stencilZPass=l.stencilZPass),l.wireframe!==void 0&&(f.wireframe=l.wireframe),l.wireframeLinewidth!==void 0&&(f.wireframeLinewidth=l.wireframeLinewidth),l.wireframeLinecap!==void 0&&(f.wireframeLinecap=l.wireframeLinecap),l.wireframeLinejoin!==void 0&&(f.wireframeLinejoin=l.wireframeLinejoin),l.rotation!==void 0&&(f.rotation=l.rotation),l.linewidth!==1&&(f.linewidth=l.linewidth),l.dashSize!==void 0&&(f.dashSize=l.dashSize),l.gapSize!==void 0&&(f.gapSize=l.gapSize),l.scale!==void 0&&(f.scale=l.scale),l.polygonOffset!==void 0&&(f.polygonOffset=l.polygonOffset),l.polygonOffsetFactor!==void 0&&(f.polygonOffsetFactor=l.polygonOffsetFactor),l.polygonOffsetUnits!==void 0&&(f.polygonOffsetUnits=l.polygonOffsetUnits),l.skinning!==void 0&&(f.skinning=l.skinning),l.morphTargets!==void 0&&(f.morphTargets=l.morphTargets),l.morphNormals!==void 0&&(f.morphNormals=l.morphNormals),l.dithering!==void 0&&(f.dithering=l.dithering),l.vertexTangents!==void 0&&(f.vertexTangents=l.vertexTangents),l.visible!==void 0&&(f.visible=l.visible),l.toneMapped!==void 0&&(f.toneMapped=l.toneMapped),l.userData!==void 0&&(f.userData=l.userData),l.vertexColors!==void 0&&(typeof l.vertexColors=="number"?f.vertexColors=l.vertexColors>0:f.vertexColors=l.vertexColors),l.uniforms!==void 0)for(const g in l.uniforms){const y=l.uniforms[g];switch(f.uniforms[g]={},y.type){case"t":f.uniforms[g].value=u(y.value);break;case"c":f.uniforms[g].value=new Fi().setHex(y.value);break;case"v2":f.uniforms[g].value=new At().fromArray(y.value);break;case"v3":f.uniforms[g].value=new Be().fromArray(y.value);break;case"v4":f.uniforms[g].value=new Yn().fromArray(y.value);break;case"m3":f.uniforms[g].value=new Os().fromArray(y.value);break;case"m4":f.uniforms[g].value=new fn().fromArray(y.value);break;default:f.uniforms[g].value=y.value}}if(l.defines!==void 0&&(f.defines=l.defines),l.vertexShader!==void 0&&(f.vertexShader=l.vertexShader),l.fragmentShader!==void 0&&(f.fragmentShader=l.fragmentShader),l.extensions!==void 0)for(const g in l.extensions)f.extensions[g]=l.extensions[g];if(l.shading!==void 0&&(f.flatShading=l.shading===1),l.size!==void 0&&(f.size=l.size),l.sizeAttenuation!==void 0&&(f.sizeAttenuation=l.sizeAttenuation),l.map!==void 0&&(f.map=u(l.map)),l.matcap!==void 0&&(f.matcap=u(l.matcap)),l.alphaMap!==void 0&&(f.alphaMap=u(l.alphaMap)),l.bumpMap!==void 0&&(f.bumpMap=u(l.bumpMap)),l.bumpScale!==void 0&&(f.bumpScale=l.bumpScale),l.normalMap!==void 0&&(f.normalMap=u(l.normalMap)),l.normalMapType!==void 0&&(f.normalMapType=l.normalMapType),l.normalScale!==void 0){let g=l.normalScale;Array.isArray(g)===!1&&(g=[g,g]),f.normalScale=new At().fromArray(g)}return l.displacementMap!==void 0&&(f.displacementMap=u(l.displacementMap)),l.displacementScale!==void 0&&(f.displacementScale=l.displacementScale),l.displacementBias!==void 0&&(f.displacementBias=l.displacementBias),l.roughnessMap!==void 0&&(f.roughnessMap=u(l.roughnessMap)),l.metalnessMap!==void 0&&(f.metalnessMap=u(l.metalnessMap)),l.emissiveMap!==void 0&&(f.emissiveMap=u(l.emissiveMap)),l.emissiveIntensity!==void 0&&(f.emissiveIntensity=l.emissiveIntensity),l.specularMap!==void 0&&(f.specularMap=u(l.specularMap)),l.envMap!==void 0&&(f.envMap=u(l.envMap)),l.envMapIntensity!==void 0&&(f.envMapIntensity=l.envMapIntensity),l.reflectivity!==void 0&&(f.reflectivity=l.reflectivity),l.refractionRatio!==void 0&&(f.refractionRatio=l.refractionRatio),l.lightMap!==void 0&&(f.lightMap=u(l.lightMap)),l.lightMapIntensity!==void 0&&(f.lightMapIntensity=l.lightMapIntensity),l.aoMap!==void 0&&(f.aoMap=u(l.aoMap)),l.aoMapIntensity!==void 0&&(f.aoMapIntensity=l.aoMapIntensity),l.gradientMap!==void 0&&(f.gradientMap=u(l.gradientMap)),l.clearcoatMap!==void 0&&(f.clearcoatMap=u(l.clearcoatMap)),l.clearcoatRoughnessMap!==void 0&&(f.clearcoatRoughnessMap=u(l.clearcoatRoughnessMap)),l.clearcoatNormalMap!==void 0&&(f.clearcoatNormalMap=u(l.clearcoatNormalMap)),l.clearcoatNormalScale!==void 0&&(f.clearcoatNormalScale=new At().fromArray(l.clearcoatNormalScale)),l.transmission!==void 0&&(f.transmission=l.transmission),l.transmissionMap!==void 0&&(f.transmissionMap=u(l.transmissionMap)),f},setTextures:function(l){return this.textures=l,this}});const IN={decodeText:function(l){if(typeof TextDecoder<"u")return new TextDecoder().decode(l);let o="";for(let u=0,f=l.length;u<f;u++)o+=String.fromCharCode(l[u]);try{return decodeURIComponent(escape(o))}catch{return o}},extractUrlBase:function(l){const o=l.lastIndexOf("/");return o===-1?"./":l.substr(0,o+1)}};function F1(){$n.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}F1.prototype=X(Object.create($n.prototype),{constructor:F1,isInstancedBufferGeometry:!0,copy:function(l){return $n.prototype.copy.call(this,l),this.instanceCount=l.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const l=$n.prototype.toJSON.call(this);return l.instanceCount=this.instanceCount,l.isInstancedBufferGeometry=!0,l}});function hA(l,o,u,f){typeof u=="number"&&(f=u,u=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),pn.call(this,l,o,u),this.meshPerAttribute=f||1}hA.prototype=X(Object.create(pn.prototype),{constructor:hA,isInstancedBufferAttribute:!0,copy:function(l){return pn.prototype.copy.call(this,l),this.meshPerAttribute=l.meshPerAttribute,this},toJSON:function(){const l=pn.prototype.toJSON.call(this);return l.meshPerAttribute=this.meshPerAttribute,l.isInstancedBufferAttribute=!0,l}});function DM(l){Zr.call(this,l)}DM.prototype=X(Object.create(Zr.prototype),{constructor:DM,load:function(l,o,u,f){const g=this,y=new Jh(g.manager);y.setPath(g.path),y.setRequestHeader(g.requestHeader),y.setWithCredentials(g.withCredentials),y.load(l,function(T){try{o(g.parse(JSON.parse(T)))}catch(w){f?f(w):console.error(w),g.manager.itemError(l)}},u,f)},parse:function(l){const o={},u={};function f(G,W){if(o[W]!==void 0)return o[W];const me=G.interleavedBuffers[W],pe=g(G,me.buffer),te=tr(me.type,pe),K=new Vl(te,me.stride);return K.uuid=me.uuid,o[W]=K,K}function g(G,W){if(u[W]!==void 0)return u[W];const me=G.arrayBuffers[W],pe=new Uint32Array(me).buffer;return u[W]=pe,pe}const y=l.isInstancedBufferGeometry?new F1:new $n,T=l.data.index;if(T!==void 0){const G=tr(T.type,T.array);y.setIndex(new pn(G,1))}const w=l.data.attributes;for(const G in w){const W=w[G];let J;if(W.isInterleavedBufferAttribute){const me=f(l.data,W.data);J=new lc(me,W.itemSize,W.offset,W.normalized)}else{const me=tr(W.type,W.array),pe=W.isInstancedBufferAttribute?hA:pn;J=new pe(me,W.itemSize,W.normalized)}W.name!==void 0&&(J.name=W.name),y.setAttribute(G,J)}const M=l.data.morphAttributes;if(M)for(const G in M){const W=M[G],J=[];for(let me=0,pe=W.length;me<pe;me++){const te=W[me];let K;if(te.isInterleavedBufferAttribute){const He=f(l.data,te.data);K=new lc(He,te.itemSize,te.offset,te.normalized)}else{const He=tr(te.type,te.array);K=new pn(He,te.itemSize,te.normalized)}te.name!==void 0&&(K.name=te.name),J.push(K)}y.morphAttributes[G]=J}l.data.morphTargetsRelative&&(y.morphTargetsRelative=!0);const z=l.data.groups||l.data.drawcalls||l.data.offsets;if(z!==void 0)for(let G=0,W=z.length;G!==W;++G){const J=z[G];y.addGroup(J.start,J.count,J.materialIndex)}const U=l.data.boundingSphere;if(U!==void 0){const G=new Be;U.center!==void 0&&G.fromArray(U.center),y.boundingSphere=new Rl(G,U.radius)}return l.name&&(y.name=l.name),l.userData&&(y.userData=l.userData),y}});function IM(l){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Zr.call(this,l),this.options={premultiplyAlpha:"none"}}IM.prototype=X(Object.create(Zr.prototype),{constructor:IM,isImageBitmapLoader:!0,setOptions:function(o){return this.options=o,this},load:function(l,o,u,f){l===void 0&&(l=""),this.path!==void 0&&(l=this.path+l),l=this.manager.resolveURL(l);const g=this,y=Fg.get(l);if(y!==void 0)return g.manager.itemStart(l),setTimeout(function(){o&&o(y),g.manager.itemEnd(l)},0),y;const T={};T.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(l,T).then(function(w){return w.blob()}).then(function(w){return createImageBitmap(w,g.options)}).then(function(w){Fg.add(l,w),o&&o(w),g.manager.itemEnd(l)}).catch(function(w){f&&f(w),g.manager.itemError(l),g.manager.itemEnd(l)}),g.manager.itemStart(l)}});function PM(){this.type="ShapePath",this.color=new Fi,this.subPaths=[],this.currentPath=null}X(PM.prototype,{moveTo:function(l,o){return this.currentPath=new Gd,this.subPaths.push(this.currentPath),this.currentPath.moveTo(l,o),this},lineTo:function(l,o){return this.currentPath.lineTo(l,o),this},quadraticCurveTo:function(l,o,u,f){return this.currentPath.quadraticCurveTo(l,o,u,f),this},bezierCurveTo:function(l,o,u,f,g,y){return this.currentPath.bezierCurveTo(l,o,u,f,g,y),this},splineThru:function(l){return this.currentPath.splineThru(l),this},toShapes:function(l,o){function u(te){const K=[];for(let He=0,$e=te.length;He<$e;He++){const Ue=te[He],Ae=new Bg;Ae.curves=Ue.curves,K.push(Ae)}return K}function f(te,K){const He=K.length;let $e=!1;for(let Ue=He-1,Ae=0;Ae<He;Ue=Ae++){let at=K[Ue],Ht=K[Ae],wt=Ht.x-at.x,It=Ht.y-at.y;if(Math.abs(It)>Number.EPSILON){if(It<0&&(at=K[Ae],wt=-wt,Ht=K[Ue],It=-It),te.y<at.y||te.y>Ht.y)continue;if(te.y===at.y){if(te.x===at.x)return!0}else{const Pt=It*(te.x-at.x)-wt*(te.y-at.y);if(Pt===0)return!0;if(Pt<0)continue;$e=!$e}}else{if(te.y!==at.y)continue;if(Ht.x<=te.x&&te.x<=at.x||at.x<=te.x&&te.x<=Ht.x)return!0}}return $e}const g=cp.isClockWise,y=this.subPaths;if(y.length===0)return[];if(o===!0)return u(y);let T,w,M;const I=[];if(y.length===1)return w=y[0],M=new Bg,M.curves=w.curves,I.push(M),I;let z=!g(y[0].getPoints());z=l?!z:z;const U=[],G=[];let W=[],J=0,me;G[J]=void 0,W[J]=[];for(let te=0,K=y.length;te<K;te++)w=y[te],me=w.getPoints(),T=g(me),T=l?!T:T,T?(!z&&G[J]&&J++,G[J]={s:new Bg,p:me},G[J].s.curves=w.curves,z&&J++,W[J]=[]):W[J].push({h:w,p:me[0]});if(!G[0])return u(y);if(G.length>1){let te=!1;const K=[];for(let He=0,$e=G.length;He<$e;He++)U[He]=[];for(let He=0,$e=G.length;He<$e;He++){const Ue=W[He];for(let Ae=0;Ae<Ue.length;Ae++){const at=Ue[Ae];let Ht=!0;for(let wt=0;wt<G.length;wt++)f(at.p,G[wt].p)&&(He!==wt&&K.push({froms:He,tos:wt,hole:Ae}),Ht?(Ht=!1,U[wt].push(at)):te=!0);Ht&&U[He].push(at)}}K.length>0&&(te||(W=U))}let pe;for(let te=0,K=G.length;te<K;te++){M=G[te].s,I.push(M),pe=W[te];for(let He=0,$e=pe.length;He<$e;He++)M.holes.push(pe[He].h)}return I}});class PN{constructor(o){Object.defineProperty(this,"isFont",{value:!0}),this.type="Font",this.data=o}generateShapes(o,u=100){const f=[],g=LN(o,u,this.data);for(let y=0,T=g.length;y<T;y++)Array.prototype.push.apply(f,g[y].toShapes());return f}}function LN(l,o,u){const f=Array.from?Array.from(l):String(l).split(""),g=o/u.resolution,y=(u.boundingBox.yMax-u.boundingBox.yMin+u.underlineThickness)*g,T=[];let w=0,M=0;for(let I=0;I<f.length;I++){const z=f[I];if(z===`
`)w=0,M-=y;else{const U=RN(z,g,w,M,u);w+=U.offsetX,T.push(U.path)}}return T}function RN(l,o,u,f,g){const y=g.glyphs[l]||g.glyphs["?"];if(!y){console.error('THREE.Font: character "'+l+'" does not exists in font family '+g.familyName+".");return}const T=new PM;let w,M,I,z,U,G,W,J;if(y.o){const me=y._cachedOutline||(y._cachedOutline=y.o.split(" "));for(let pe=0,te=me.length;pe<te;)switch(me[pe++]){case"m":w=me[pe++]*o+u,M=me[pe++]*o+f,T.moveTo(w,M);break;case"l":w=me[pe++]*o+u,M=me[pe++]*o+f,T.lineTo(w,M);break;case"q":I=me[pe++]*o+u,z=me[pe++]*o+f,U=me[pe++]*o+u,G=me[pe++]*o+f,T.quadraticCurveTo(U,G,I,z);break;case"b":I=me[pe++]*o+u,z=me[pe++]*o+f,U=me[pe++]*o+u,G=me[pe++]*o+f,W=me[pe++]*o+u,J=me[pe++]*o+f,T.bezierCurveTo(U,G,W,J,I,z);break}}return{offsetX:y.ha*o,path:T}}function LM(l){Zr.call(this,l)}LM.prototype=X(Object.create(Zr.prototype),{constructor:LM,load:function(l,o,u,f){const g=this,y=new Jh(this.manager);y.setPath(this.path),y.setRequestHeader(this.requestHeader),y.setWithCredentials(g.withCredentials),y.load(l,function(T){let w;try{w=JSON.parse(T)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),w=JSON.parse(T.substring(65,T.length-2))}const M=g.parse(w);o&&o(M)},u,f)},parse:function(l){return new PN(l)}});let B1;const RM={getContext:function(){return B1===void 0&&(B1=new(window.AudioContext||window.webkitAudioContext)),B1},setContext:function(l){B1=l}};function kM(l){Zr.call(this,l)}kM.prototype=X(Object.create(Zr.prototype),{constructor:kM,load:function(l,o,u,f){const g=this,y=new Jh(g.manager);y.setResponseType("arraybuffer"),y.setPath(g.path),y.setRequestHeader(g.requestHeader),y.setWithCredentials(g.withCredentials),y.load(l,function(T){try{const w=T.slice(0);RM.getContext().decodeAudioData(w,function(I){o(I)})}catch(w){f?f(w):console.error(w),g.manager.itemError(l)}},u,f)}});function OM(l,o,u){$d.call(this,void 0,u);const f=new Fi().set(l),g=new Fi().set(o),y=new Be(f.r,f.g,f.b),T=new Be(g.r,g.g,g.b),w=Math.sqrt(Math.PI),M=w*Math.sqrt(.75);this.sh.coefficients[0].copy(y).add(T).multiplyScalar(w),this.sh.coefficients[1].copy(y).sub(T).multiplyScalar(M)}OM.prototype=X(Object.create($d.prototype),{constructor:OM,isHemisphereLightProbe:!0,copy:function(l){return $d.prototype.copy.call(this,l),this},toJSON:function(l){return $d.prototype.toJSON.call(this,l)}});function FM(l,o){$d.call(this,void 0,o);const u=new Fi().set(l);this.sh.coefficients[0].set(u.r,u.g,u.b).multiplyScalar(2*Math.sqrt(Math.PI))}FM.prototype=X(Object.create($d.prototype),{constructor:FM,isAmbientLightProbe:!0,copy:function(l){return $d.prototype.copy.call(this,l),this},toJSON:function(l){return $d.prototype.toJSON.call(this,l)}});const BM=new fn,NM=new fn;function kN(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new fr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new fr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}X(kN.prototype,{update:function(l){const o=this._cache;if(o.focus!==l.focus||o.fov!==l.fov||o.aspect!==l.aspect*this.aspect||o.near!==l.near||o.far!==l.far||o.zoom!==l.zoom||o.eyeSep!==this.eyeSep){o.focus=l.focus,o.fov=l.fov,o.aspect=l.aspect*this.aspect,o.near=l.near,o.far=l.far,o.zoom=l.zoom,o.eyeSep=this.eyeSep;const f=l.projectionMatrix.clone(),g=o.eyeSep/2,y=g*o.near/o.focus,T=o.near*Math.tan(Gi.DEG2RAD*o.fov*.5)/o.zoom;let w,M;NM.elements[12]=-g,BM.elements[12]=g,w=-T*o.aspect+y,M=T*o.aspect+y,f.elements[0]=2*o.near/(M-w),f.elements[8]=(M+w)/(M-w),this.cameraL.projectionMatrix.copy(f),w=-T*o.aspect-y,M=T*o.aspect-y,f.elements[0]=2*o.near/(M-w),f.elements[8]=(M+w)/(M-w),this.cameraR.projectionMatrix.copy(f)}this.cameraL.matrixWorld.copy(l.matrixWorld).multiply(NM),this.cameraR.matrixWorld.copy(l.matrixWorld).multiply(BM)}});function UM(l,o,u){this.binding=l,this.valueSize=u;let f,g,y;switch(o){case"quaternion":f=this._slerp,g=this._slerpAdditive,y=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(u*6),this._workIndex=5;break;case"string":case"bool":f=this._select,g=this._select,y=this._setAdditiveIdentityOther,this.buffer=new Array(u*5);break;default:f=this._lerp,g=this._lerpAdditive,y=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(u*5)}this._mixBufferRegion=f,this._mixBufferRegionAdditive=g,this._setIdentity=y,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}X(UM.prototype,{accumulate:function(l,o){const u=this.buffer,f=this.valueSize,g=l*f+f;let y=this.cumulativeWeight;if(y===0){for(let T=0;T!==f;++T)u[g+T]=u[T];y=o}else{y+=o;const T=o/y;this._mixBufferRegion(u,g,0,T,f)}this.cumulativeWeight=y},accumulateAdditive:function(l){const o=this.buffer,u=this.valueSize,f=u*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(o,f,0,l,u),this.cumulativeWeightAdditive+=l},apply:function(l){const o=this.valueSize,u=this.buffer,f=l*o+o,g=this.cumulativeWeight,y=this.cumulativeWeightAdditive,T=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,g<1){const w=o*this._origIndex;this._mixBufferRegion(u,f,w,1-g,o)}y>0&&this._mixBufferRegionAdditive(u,f,this._addIndex*o,1,o);for(let w=o,M=o+o;w!==M;++w)if(u[w]!==u[w+o]){T.setValue(u,f);break}},saveOriginalState:function(){const l=this.binding,o=this.buffer,u=this.valueSize,f=u*this._origIndex;l.getValue(o,f);for(let g=u,y=f;g!==y;++g)o[g]=o[f+g%u];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const l=this.valueSize*3;this.binding.setValue(this.buffer,l)},_setAdditiveIdentityNumeric:function(){const l=this._addIndex*this.valueSize,o=l+this.valueSize;for(let u=l;u<o;u++)this.buffer[u]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){const l=this._origIndex*this.valueSize,o=this._addIndex*this.valueSize;for(let u=0;u<this.valueSize;u++)this.buffer[o+u]=this.buffer[l+u]},_select:function(l,o,u,f,g){if(f>=.5)for(let y=0;y!==g;++y)l[o+y]=l[u+y]},_slerp:function(l,o,u,f){Wr.slerpFlat(l,o,l,o,l,u,f)},_slerpAdditive:function(l,o,u,f,g){const y=this._workIndex*g;Wr.multiplyQuaternionsFlat(l,y,l,o,l,u),Wr.slerpFlat(l,o,l,o,l,y,f)},_lerp:function(l,o,u,f,g){const y=1-f;for(let T=0;T!==g;++T){const w=o+T;l[w]=l[w]*y+l[u+T]*f}},_lerpAdditive:function(l,o,u,f,g){for(let y=0;y!==g;++y){const T=o+y;l[T]=l[T]+l[u+y]*f}}});const fA="\\[\\]\\.:\\/",ON=new RegExp("["+fA+"]","g"),pA="[^"+fA+"]",FN="[^"+fA.replace("\\.","")+"]",BN=/((?:WC+[\/:])*)/.source.replace("WC",pA),NN=/(WCOD+)?/.source.replace("WCOD",FN),UN=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",pA),VN=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",pA),zN=new RegExp("^"+BN+NN+UN+VN+"$"),HN=["material","materials","bones"];function VM(l,o,u){const f=u||sl.parseTrackName(o);this._targetGroup=l,this._bindings=l.subscribe_(o,f)}X(VM.prototype,{getValue:function(l,o){this.bind();const u=this._targetGroup.nCachedObjects_,f=this._bindings[u];f!==void 0&&f.getValue(l,o)},setValue:function(l,o){const u=this._bindings;for(let f=this._targetGroup.nCachedObjects_,g=u.length;f!==g;++f)u[f].setValue(l,o)},bind:function(){const l=this._bindings;for(let o=this._targetGroup.nCachedObjects_,u=l.length;o!==u;++o)l[o].bind()},unbind:function(){const l=this._bindings;for(let o=this._targetGroup.nCachedObjects_,u=l.length;o!==u;++o)l[o].unbind()}});function sl(l,o,u){this.path=o,this.parsedPath=u||sl.parseTrackName(o),this.node=sl.findNode(l,this.parsedPath.nodeName)||l,this.rootNode=l}X(sl,{Composite:VM,create:function(l,o,u){return l&&l.isAnimationObjectGroup?new sl.Composite(l,o,u):new sl(l,o,u)},sanitizeNodeName:function(l){return l.replace(/\s/g,"_").replace(ON,"")},parseTrackName:function(l){const o=zN.exec(l);if(!o)throw new Error("PropertyBinding: Cannot parse trackName: "+l);const u={nodeName:o[2],objectName:o[3],objectIndex:o[4],propertyName:o[5],propertyIndex:o[6]},f=u.nodeName&&u.nodeName.lastIndexOf(".");if(f!==void 0&&f!==-1){const g=u.nodeName.substring(f+1);HN.indexOf(g)!==-1&&(u.nodeName=u.nodeName.substring(0,f),u.objectName=g)}if(u.propertyName===null||u.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+l);return u},findNode:function(l,o){if(!o||o===""||o==="."||o===-1||o===l.name||o===l.uuid)return l;if(l.skeleton){const u=l.skeleton.getBoneByName(o);if(u!==void 0)return u}if(l.children){const u=function(g){for(let y=0;y<g.length;y++){const T=g[y];if(T.name===o||T.uuid===o)return T;const w=u(T.children);if(w)return w}return null},f=u(l.children);if(f)return f}return null}}),X(sl.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(o,u){o[u]=this.node[this.propertyName]},function(o,u){const f=this.resolvedProperty;for(let g=0,y=f.length;g!==y;++g)o[u++]=f[g]},function(o,u){o[u]=this.resolvedProperty[this.propertyIndex]},function(o,u){this.resolvedProperty.toArray(o,u)}],SetterByBindingTypeAndVersioning:[[function(o,u){this.targetObject[this.propertyName]=o[u]},function(o,u){this.targetObject[this.propertyName]=o[u],this.targetObject.needsUpdate=!0},function(o,u){this.targetObject[this.propertyName]=o[u],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(o,u){const f=this.resolvedProperty;for(let g=0,y=f.length;g!==y;++g)f[g]=o[u++]},function(o,u){const f=this.resolvedProperty;for(let g=0,y=f.length;g!==y;++g)f[g]=o[u++];this.targetObject.needsUpdate=!0},function(o,u){const f=this.resolvedProperty;for(let g=0,y=f.length;g!==y;++g)f[g]=o[u++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(o,u){this.resolvedProperty[this.propertyIndex]=o[u]},function(o,u){this.resolvedProperty[this.propertyIndex]=o[u],this.targetObject.needsUpdate=!0},function(o,u){this.resolvedProperty[this.propertyIndex]=o[u],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(o,u){this.resolvedProperty.fromArray(o,u)},function(o,u){this.resolvedProperty.fromArray(o,u),this.targetObject.needsUpdate=!0},function(o,u){this.resolvedProperty.fromArray(o,u),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(o,u){this.bind(),this.getValue(o,u)},setValue:function(o,u){this.bind(),this.setValue(o,u)},bind:function(){let l=this.node;const o=this.parsedPath,u=o.objectName,f=o.propertyName;let g=o.propertyIndex;if(l||(l=sl.findNode(this.rootNode,o.nodeName)||this.rootNode,this.node=l),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!l){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(u){let M=o.objectIndex;switch(u){case"materials":if(!l.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!l.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}l=l.material.materials;break;case"bones":if(!l.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}l=l.skeleton.bones;for(let I=0;I<l.length;I++)if(l[I].name===M){M=I;break}break;default:if(l[u]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}l=l[u]}if(M!==void 0){if(l[M]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,l);return}l=l[M]}}const y=l[f];if(y===void 0){const M=o.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+M+"."+f+" but it wasn't found.",l);return}let T=this.Versioning.None;this.targetObject=l,l.needsUpdate!==void 0?T=this.Versioning.NeedsUpdate:l.matrixWorldNeedsUpdate!==void 0&&(T=this.Versioning.MatrixWorldNeedsUpdate);let w=this.BindingType.Direct;if(g!==void 0){if(f==="morphTargetInfluences"){if(!l.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(l.geometry.isBufferGeometry){if(!l.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}l.morphTargetDictionary[g]!==void 0&&(g=l.morphTargetDictionary[g])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}w=this.BindingType.ArrayElement,this.resolvedProperty=y,this.propertyIndex=g}else y.fromArray!==void 0&&y.toArray!==void 0?(w=this.BindingType.HasFromToArray,this.resolvedProperty=y):Array.isArray(y)?(w=this.BindingType.EntireArray,this.resolvedProperty=y):this.propertyName=f;this.getValue=this.GetterByBindingType[w],this.setValue=this.SetterByBindingTypeAndVersioning[w][T]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),X(sl.prototype,{_getValue_unbound:sl.prototype.getValue,_setValue_unbound:sl.prototype.setValue});function jN(){this.uuid=Gi.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const l={};this._indicesByUUID=l;for(let u=0,f=arguments.length;u!==f;++u)l[arguments[u].uuid]=u;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const o=this;this.stats={objects:{get total(){return o._objects.length},get inUse(){return this.total-o.nCachedObjects_}},get bindingsPerObject(){return o._bindings.length}}}X(jN.prototype,{isAnimationObjectGroup:!0,add:function(){const l=this._objects,o=this._indicesByUUID,u=this._paths,f=this._parsedPaths,g=this._bindings,y=g.length;let T,w=l.length,M=this.nCachedObjects_;for(let I=0,z=arguments.length;I!==z;++I){const U=arguments[I],G=U.uuid;let W=o[G];if(W===void 0){W=w++,o[G]=W,l.push(U);for(let J=0,me=y;J!==me;++J)g[J].push(new sl(U,u[J],f[J]))}else if(W<M){T=l[W];const J=--M,me=l[J];o[me.uuid]=W,l[W]=me,o[G]=J,l[J]=U;for(let pe=0,te=y;pe!==te;++pe){const K=g[pe],He=K[J];let $e=K[W];K[W]=He,$e===void 0&&($e=new sl(U,u[pe],f[pe])),K[J]=$e}}else l[W]!==T&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=M},remove:function(){const l=this._objects,o=this._indicesByUUID,u=this._bindings,f=u.length;let g=this.nCachedObjects_;for(let y=0,T=arguments.length;y!==T;++y){const w=arguments[y],M=w.uuid,I=o[M];if(I!==void 0&&I>=g){const z=g++,U=l[z];o[U.uuid]=I,l[I]=U,o[M]=z,l[z]=w;for(let G=0,W=f;G!==W;++G){const J=u[G],me=J[z],pe=J[I];J[I]=me,J[z]=pe}}}this.nCachedObjects_=g},uncache:function(){const l=this._objects,o=this._indicesByUUID,u=this._bindings,f=u.length;let g=this.nCachedObjects_,y=l.length;for(let T=0,w=arguments.length;T!==w;++T){const M=arguments[T],I=M.uuid,z=o[I];if(z!==void 0)if(delete o[I],z<g){const U=--g,G=l[U],W=--y,J=l[W];o[G.uuid]=z,l[z]=G,o[J.uuid]=U,l[U]=J,l.pop();for(let me=0,pe=f;me!==pe;++me){const te=u[me],K=te[U],He=te[W];te[z]=K,te[U]=He,te.pop()}}else{const U=--y,G=l[U];U>0&&(o[G.uuid]=z),l[z]=G,l.pop();for(let W=0,J=f;W!==J;++W){const me=u[W];me[z]=me[U],me.pop()}}}this.nCachedObjects_=g},subscribe_:function(l,o){const u=this._bindingsIndicesByPath;let f=u[l];const g=this._bindings;if(f!==void 0)return g[f];const y=this._paths,T=this._parsedPaths,w=this._objects,M=w.length,I=this.nCachedObjects_,z=new Array(M);f=g.length,u[l]=f,y.push(l),T.push(o),g.push(z);for(let U=I,G=w.length;U!==G;++U){const W=w[U];z[U]=new sl(W,l,o)}return z},unsubscribe_:function(l){const o=this._bindingsIndicesByPath,u=o[l];if(u!==void 0){const f=this._paths,g=this._parsedPaths,y=this._bindings,T=y.length-1,w=y[T],M=l[T];o[M]=u,y[u]=w,y.pop(),g[u]=g[T],g.pop(),f[u]=f[T],f.pop()}}});class GN{constructor(o,u,f=null,g=u.blendMode){this._mixer=o,this._clip=u,this._localRoot=f,this.blendMode=g;const y=u.tracks,T=y.length,w=new Array(T),M={endingStart:$s,endingEnd:$s};for(let I=0;I!==T;++I){const z=y[I].createInterpolant(null);w[I]=z,z.settings=M}this._interpolantSettings=M,this._interpolants=w,this._propertyBindings=new Array(T),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Dh,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(o){return this._startTime=o,this}setLoop(o,u){return this.loop=o,this.repetitions=u,this}setEffectiveWeight(o){return this.weight=o,this._effectiveWeight=this.enabled?o:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(o){return this._scheduleFading(o,0,1)}fadeOut(o){return this._scheduleFading(o,1,0)}crossFadeFrom(o,u,f){if(o.fadeOut(u),this.fadeIn(u),f){const g=this._clip.duration,y=o._clip.duration,T=y/g,w=g/y;o.warp(1,T,u),this.warp(w,1,u)}return this}crossFadeTo(o,u,f){return o.crossFadeFrom(this,u,f)}stopFading(){const o=this._weightInterpolant;return o!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(o)),this}setEffectiveTimeScale(o){return this.timeScale=o,this._effectiveTimeScale=this.paused?0:o,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(o){return this.timeScale=this._clip.duration/o,this.stopWarping()}syncWith(o){return this.time=o.time,this.timeScale=o.timeScale,this.stopWarping()}halt(o){return this.warp(this._effectiveTimeScale,0,o)}warp(o,u,f){const g=this._mixer,y=g.time,T=this.timeScale;let w=this._timeScaleInterpolant;w===null&&(w=g._lendControlInterpolant(),this._timeScaleInterpolant=w);const M=w.parameterPositions,I=w.sampleValues;return M[0]=y,M[1]=y+f,I[0]=o/T,I[1]=u/T,this}stopWarping(){const o=this._timeScaleInterpolant;return o!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(o)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(o,u,f,g){if(!this.enabled){this._updateWeight(o);return}const y=this._startTime;if(y!==null){const M=(o-y)*f;if(M<0||f===0)return;this._startTime=null,u=f*M}u*=this._updateTimeScale(o);const T=this._updateTime(u),w=this._updateWeight(o);if(w>0){const M=this._interpolants,I=this._propertyBindings;switch(this.blendMode){case Ih:for(let z=0,U=M.length;z!==U;++z)M[z].evaluate(T),I[z].accumulateAdditive(w);break;case ud:default:for(let z=0,U=M.length;z!==U;++z)M[z].evaluate(T),I[z].accumulate(g,w)}}}_updateWeight(o){let u=0;if(this.enabled){u=this.weight;const f=this._weightInterpolant;if(f!==null){const g=f.evaluate(o)[0];u*=g,o>f.parameterPositions[1]&&(this.stopFading(),g===0&&(this.enabled=!1))}}return this._effectiveWeight=u,u}_updateTimeScale(o){let u=0;if(!this.paused){u=this.timeScale;const f=this._timeScaleInterpolant;if(f!==null){const g=f.evaluate(o)[0];u*=g,o>f.parameterPositions[1]&&(this.stopWarping(),u===0?this.paused=!0:this.timeScale=u)}}return this._effectiveTimeScale=u,u}_updateTime(o){const u=this._clip.duration,f=this.loop;let g=this.time+o,y=this._loopCount;const T=f===ld;if(o===0)return y===-1?g:T&&(y&1)===1?u-g:g;if(f===od){y===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(g>=u)g=u;else if(g<0)g=0;else{this.time=g;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=g,this._mixer.dispatchEvent({type:"finished",action:this,direction:o<0?-1:1})}}else{if(y===-1&&(o>=0?(y=0,this._setEndings(!0,this.repetitions===0,T)):this._setEndings(this.repetitions===0,!0,T)),g>=u||g<0){const w=Math.floor(g/u);g-=u*w,y+=Math.abs(w);const M=this.repetitions-y;if(M<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,g=o>0?u:0,this.time=g,this._mixer.dispatchEvent({type:"finished",action:this,direction:o>0?1:-1});else{if(M===1){const I=o<0;this._setEndings(I,!I,T)}else this._setEndings(!1,!1,T);this._loopCount=y,this.time=g,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:w})}}else this.time=g;if(T&&(y&1)===1)return u-g}return g}_setEndings(o,u,f){const g=this._interpolantSettings;f?(g.endingStart=Va,g.endingEnd=Va):(o?g.endingStart=this.zeroSlopeAtStart?Va:$s:g.endingStart=Cl,u?g.endingEnd=this.zeroSlopeAtEnd?Va:$s:g.endingEnd=Cl)}_scheduleFading(o,u,f){const g=this._mixer,y=g.time;let T=this._weightInterpolant;T===null&&(T=g._lendControlInterpolant(),this._weightInterpolant=T);const w=T.parameterPositions,M=T.sampleValues;return w[0]=y,M[0]=u,w[1]=y+o,M[1]=f,this}}function zM(l){this._root=l,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}zM.prototype=X(Object.create(ks.prototype),{constructor:zM,_bindAction:function(l,o){const u=l._localRoot||this._root,f=l._clip.tracks,g=f.length,y=l._propertyBindings,T=l._interpolants,w=u.uuid,M=this._bindingsByRootAndName;let I=M[w];I===void 0&&(I={},M[w]=I);for(let z=0;z!==g;++z){const U=f[z],G=U.name;let W=I[G];if(W!==void 0)y[z]=W;else{if(W=y[z],W!==void 0){W._cacheIndex===null&&(++W.referenceCount,this._addInactiveBinding(W,w,G));continue}const J=o&&o._propertyBindings[z].binding.parsedPath;W=new UM(sl.create(u,G,J),U.ValueTypeName,U.getValueSize()),++W.referenceCount,this._addInactiveBinding(W,w,G),y[z]=W}T[z].resultBuffer=W.buffer}},_activateAction:function(l){if(!this._isActiveAction(l)){if(l._cacheIndex===null){const u=(l._localRoot||this._root).uuid,f=l._clip.uuid,g=this._actionsByClip[f];this._bindAction(l,g&&g.knownActions[0]),this._addInactiveAction(l,f,u)}const o=l._propertyBindings;for(let u=0,f=o.length;u!==f;++u){const g=o[u];g.useCount++===0&&(this._lendBinding(g),g.saveOriginalState())}this._lendAction(l)}},_deactivateAction:function(l){if(this._isActiveAction(l)){const o=l._propertyBindings;for(let u=0,f=o.length;u!==f;++u){const g=o[u];--g.useCount===0&&(g.restoreOriginalState(),this._takeBackBinding(g))}this._takeBackAction(l)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const l=this;this.stats={actions:{get total(){return l._actions.length},get inUse(){return l._nActiveActions}},bindings:{get total(){return l._bindings.length},get inUse(){return l._nActiveBindings}},controlInterpolants:{get total(){return l._controlInterpolants.length},get inUse(){return l._nActiveControlInterpolants}}}},_isActiveAction:function(l){const o=l._cacheIndex;return o!==null&&o<this._nActiveActions},_addInactiveAction:function(l,o,u){const f=this._actions,g=this._actionsByClip;let y=g[o];if(y===void 0)y={knownActions:[l],actionByRoot:{}},l._byClipCacheIndex=0,g[o]=y;else{const T=y.knownActions;l._byClipCacheIndex=T.length,T.push(l)}l._cacheIndex=f.length,f.push(l),y.actionByRoot[u]=l},_removeInactiveAction:function(l){const o=this._actions,u=o[o.length-1],f=l._cacheIndex;u._cacheIndex=f,o[f]=u,o.pop(),l._cacheIndex=null;const g=l._clip.uuid,y=this._actionsByClip,T=y[g],w=T.knownActions,M=w[w.length-1],I=l._byClipCacheIndex;M._byClipCacheIndex=I,w[I]=M,w.pop(),l._byClipCacheIndex=null;const z=T.actionByRoot,U=(l._localRoot||this._root).uuid;delete z[U],w.length===0&&delete y[g],this._removeInactiveBindingsForAction(l)},_removeInactiveBindingsForAction:function(l){const o=l._propertyBindings;for(let u=0,f=o.length;u!==f;++u){const g=o[u];--g.referenceCount===0&&this._removeInactiveBinding(g)}},_lendAction:function(l){const o=this._actions,u=l._cacheIndex,f=this._nActiveActions++,g=o[f];l._cacheIndex=f,o[f]=l,g._cacheIndex=u,o[u]=g},_takeBackAction:function(l){const o=this._actions,u=l._cacheIndex,f=--this._nActiveActions,g=o[f];l._cacheIndex=f,o[f]=l,g._cacheIndex=u,o[u]=g},_addInactiveBinding:function(l,o,u){const f=this._bindingsByRootAndName,g=this._bindings;let y=f[o];y===void 0&&(y={},f[o]=y),y[u]=l,l._cacheIndex=g.length,g.push(l)},_removeInactiveBinding:function(l){const o=this._bindings,u=l.binding,f=u.rootNode.uuid,g=u.path,y=this._bindingsByRootAndName,T=y[f],w=o[o.length-1],M=l._cacheIndex;w._cacheIndex=M,o[M]=w,o.pop(),delete T[g],Object.keys(T).length===0&&delete y[f]},_lendBinding:function(l){const o=this._bindings,u=l._cacheIndex,f=this._nActiveBindings++,g=o[f];l._cacheIndex=f,o[f]=l,g._cacheIndex=u,o[u]=g},_takeBackBinding:function(l){const o=this._bindings,u=l._cacheIndex,f=--this._nActiveBindings,g=o[f];l._cacheIndex=f,o[f]=l,g._cacheIndex=u,o[u]=g},_lendControlInterpolant:function(){const l=this._controlInterpolants,o=this._nActiveControlInterpolants++;let u=l[o];return u===void 0&&(u=new L1(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),u.__cacheIndex=o,l[o]=u),u},_takeBackControlInterpolant:function(l){const o=this._controlInterpolants,u=l.__cacheIndex,f=--this._nActiveControlInterpolants,g=o[f];l.__cacheIndex=f,o[f]=l,g.__cacheIndex=u,o[u]=g},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(l,o,u){const f=o||this._root,g=f.uuid;let y=typeof l=="string"?Bc.findByName(f,l):l;const T=y!==null?y.uuid:l,w=this._actionsByClip[T];let M=null;if(u===void 0&&(y!==null?u=y.blendMode:u=ud),w!==void 0){const z=w.actionByRoot[g];if(z!==void 0&&z.blendMode===u)return z;M=w.knownActions[0],y===null&&(y=M._clip)}if(y===null)return null;const I=new GN(this,y,o,u);return this._bindAction(I,M),this._addInactiveAction(I,T,g),I},existingAction:function(l,o){const u=o||this._root,f=u.uuid,g=typeof l=="string"?Bc.findByName(u,l):l,y=g?g.uuid:l,T=this._actionsByClip[y];return T!==void 0&&T.actionByRoot[f]||null},stopAllAction:function(){const l=this._actions,o=this._nActiveActions;for(let u=o-1;u>=0;--u)l[u].stop();return this},update:function(l){l*=this.timeScale;const o=this._actions,u=this._nActiveActions,f=this.time+=l,g=Math.sign(l),y=this._accuIndex^=1;for(let M=0;M!==u;++M)o[M]._update(f,l,g,y);const T=this._bindings,w=this._nActiveBindings;for(let M=0;M!==w;++M)T[M].apply(y);return this},setTime:function(l){this.time=0;for(let o=0;o<this._actions.length;o++)this._actions[o].time=0;return this.update(l)},getRoot:function(){return this._root},uncacheClip:function(l){const o=this._actions,u=l.uuid,f=this._actionsByClip,g=f[u];if(g!==void 0){const y=g.knownActions;for(let T=0,w=y.length;T!==w;++T){const M=y[T];this._deactivateAction(M);const I=M._cacheIndex,z=o[o.length-1];M._cacheIndex=null,M._byClipCacheIndex=null,z._cacheIndex=I,o[I]=z,o.pop(),this._removeInactiveBindingsForAction(M)}delete f[u]}},uncacheRoot:function(l){const o=l.uuid,u=this._actionsByClip;for(const y in u){const T=u[y].actionByRoot,w=T[o];w!==void 0&&(this._deactivateAction(w),this._removeInactiveAction(w))}const f=this._bindingsByRootAndName,g=f[o];if(g!==void 0)for(const y in g){const T=g[y];T.restoreOriginalState(),this._removeInactiveBinding(T)}},uncacheAction:function(l,o){const u=this.existingAction(l,o);u!==null&&(this._deactivateAction(u),this._removeInactiveAction(u))}});function HM(l,o,u){Vl.call(this,l,o),this.meshPerAttribute=u||1}HM.prototype=X(Object.create(Vl.prototype),{constructor:HM,isInstancedInterleavedBuffer:!0,copy:function(l){return Vl.prototype.copy.call(this,l),this.meshPerAttribute=l.meshPerAttribute,this},clone:function(l){const o=Vl.prototype.clone.call(this,l);return o.meshPerAttribute=this.meshPerAttribute,o},toJSON:function(l){const o=Vl.prototype.toJSON.call(this,l);return o.isInstancedInterleavedBuffer=!0,o.meshPerAttribute=this.meshPerAttribute,o}});function jM(l,o,u,f,g){this.buffer=l,this.type=o,this.itemSize=u,this.elementSize=f,this.count=g,this.version=0}Object.defineProperty(jM.prototype,"needsUpdate",{set:function(l){l===!0&&this.version++}}),X(jM.prototype,{isGLBufferAttribute:!0,setBuffer:function(l){return this.buffer=l,this},setType:function(l,o){return this.type=l,this.elementSize=o,this},setItemSize:function(l){return this.itemSize=l,this},setCount:function(l){return this.count=l,this}});function GM(l,o,u,f){this.ray=new Yo(l,o),this.near=u||0,this.far=f||1/0,this.camera=null,this.layers=new V,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function $M(l,o){return l.distance-o.distance}function mA(l,o,u,f){if(l.layers.test(o.layers)&&l.raycast(o,u),f===!0){const g=l.children;for(let y=0,T=g.length;y<T;y++)mA(g[y],o,u,!0)}}X(GM.prototype,{set:function(l,o){this.ray.set(l,o)},setFromCamera:function(l,o){o&&o.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(o.matrixWorld),this.ray.direction.set(l.x,l.y,.5).unproject(o).sub(this.ray.origin).normalize(),this.camera=o):o&&o.isOrthographicCamera?(this.ray.origin.set(l.x,l.y,(o.near+o.far)/(o.near-o.far)).unproject(o),this.ray.direction.set(0,0,-1).transformDirection(o.matrixWorld),this.camera=o):console.error("THREE.Raycaster: Unsupported camera type: "+o.type)},intersectObject:function(l,o,u){const f=u||[];return mA(l,this,f,o),f.sort($M),f},intersectObjects:function(l,o,u){const f=u||[];if(Array.isArray(l)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),f;for(let g=0,y=l.length;g<y;g++)mA(l[g],this,f,o);return f.sort($M),f}});class WM{constructor(o=1,u=0,f=0){return this.radius=o,this.phi=u,this.theta=f,this}set(o,u,f){return this.radius=o,this.phi=u,this.theta=f,this}clone(){return new this.constructor().copy(this)}copy(o){return this.radius=o.radius,this.phi=o.phi,this.theta=o.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(o){return this.setFromCartesianCoords(o.x,o.y,o.z)}setFromCartesianCoords(o,u,f){return this.radius=Math.sqrt(o*o+u*u+f*f),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(o,f),this.phi=Math.acos(Gi.clamp(u/this.radius,-1,1))),this}}const qM=new At;class $N{constructor(o,u){Object.defineProperty(this,"isBox2",{value:!0}),this.min=o!==void 0?o:new At(1/0,1/0),this.max=u!==void 0?u:new At(-1/0,-1/0)}set(o,u){return this.min.copy(o),this.max.copy(u),this}setFromPoints(o){this.makeEmpty();for(let u=0,f=o.length;u<f;u++)this.expandByPoint(o[u]);return this}setFromCenterAndSize(o,u){const f=qM.copy(u).multiplyScalar(.5);return this.min.copy(o).sub(f),this.max.copy(o).add(f),this}clone(){return new this.constructor().copy(this)}copy(o){return this.min.copy(o.min),this.max.copy(o.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(o){return o===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),o=new At),this.isEmpty()?o.set(0,0):o.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(o){return o===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),o=new At),this.isEmpty()?o.set(0,0):o.subVectors(this.max,this.min)}expandByPoint(o){return this.min.min(o),this.max.max(o),this}expandByVector(o){return this.min.sub(o),this.max.add(o),this}expandByScalar(o){return this.min.addScalar(-o),this.max.addScalar(o),this}containsPoint(o){return!(o.x<this.min.x||o.x>this.max.x||o.y<this.min.y||o.y>this.max.y)}containsBox(o){return this.min.x<=o.min.x&&o.max.x<=this.max.x&&this.min.y<=o.min.y&&o.max.y<=this.max.y}getParameter(o,u){return u===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),u=new At),u.set((o.x-this.min.x)/(this.max.x-this.min.x),(o.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(o){return!(o.max.x<this.min.x||o.min.x>this.max.x||o.max.y<this.min.y||o.min.y>this.max.y)}clampPoint(o,u){return u===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),u=new At),u.copy(o).clamp(this.min,this.max)}distanceToPoint(o){return qM.copy(o).clamp(this.min,this.max).sub(o).length()}intersect(o){return this.min.max(o.min),this.max.min(o.max),this}union(o){return this.min.min(o.min),this.max.max(o.max),this}translate(o){return this.min.add(o),this.max.add(o),this}equals(o){return o.min.equals(this.min)&&o.max.equals(this.max)}}function N1(l){Li.call(this),this.material=l,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}N1.prototype=Object.create(Li.prototype),N1.prototype.constructor=N1,N1.prototype.isImmediateRenderObject=!0;const WN=new Un({side:De,depthWrite:!1,depthTest:!1});new Gt(new Xi,WN),Qi.create=function(l,o){return console.log("THREE.Curve.create() has been deprecated"),l.prototype=Object.create(Qi.prototype),l.prototype.constructor=l,l.prototype.getPoint=o,l},X(Gd.prototype,{fromPoints:function(l){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(l)}});function XM(l){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Uc.call(this,l),this.type="catmullrom"}XM.prototype=Object.create(Uc.prototype),X(XM.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),X(Zr.prototype,{extractUrlBase:function(l){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),IN.extractUrlBase(l)}}),Zr.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},X($N.prototype,{center:function(l){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(l)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(l){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(l)},size:function(l){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(l)}}),X(vo.prototype,{center:function(l){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(l)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(l){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(l)},isIntersectionSphere:function(l){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(l)},size:function(l){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(l)}}),X(Rl.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Bh.prototype.setFromMatrix=function(l){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(l)},X(Gi,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(l){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Gi.floorPowerOfTwo(l)},nextPowerOfTwo:function(l){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Gi.ceilPowerOfTwo(l)}}),X(Os.prototype,{flattenToArrayOffset:function(l,o){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(l,o)},multiplyVector3:function(l){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),l.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(l){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),l.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(l){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(l).invert()}}),X(fn.prototype,{extractPosition:function(l){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(l)},flattenToArrayOffset:function(l,o){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(l,o)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new Be().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(l){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(l)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(l){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),l.applyMatrix4(this)},multiplyVector4:function(l){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),l.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(l){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),l.transformDirection(this)},crossVector:function(l){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),l.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(l){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),l.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(l,o,u,f,g,y){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(l,o,f,u,g,y)},getInverse:function(l){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(l).invert()}}),Da.prototype.isIntersectionLine=function(l){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(l)},X(Wr.prototype,{multiplyVector3:function(l){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),l.applyQuaternion(this)},inverse:function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()}}),X(Yo.prototype,{isIntersectionBox:function(l){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(l)},isIntersectionPlane:function(l){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(l)},isIntersectionSphere:function(l){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(l)}}),X(ga.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(l,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(l,o)},midpoint:function(l){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(l)},normal:function(l){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(l)},plane:function(l){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(l)}}),X(ga,{barycoordFromPoint:function(l,o,u,f,g){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ga.getBarycoord(l,o,u,f,g)},normal:function(l,o,u,f){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ga.getNormal(l,o,u,f)}}),X(Bg.prototype,{extractAllPoints:function(l){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(l)},extrude:function(l){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new vM(this,l)},makeGeometry:function(l){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new pN(this,l)}}),X(At.prototype,{fromAttribute:function(l,o,u){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(l,o,u)},distanceToManhattan:function(l){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(l)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),X(Be.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(l){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(l)},getScaleFromMatrix:function(l){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(l)},getColumnFromMatrix:function(l,o){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(o,l)},applyProjection:function(l){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(l)},fromAttribute:function(l,o,u){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(l,o,u)},distanceToManhattan:function(l){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(l)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),X(Yn.prototype,{fromAttribute:function(l,o,u){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(l,o,u)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),X(Li.prototype,{getChildByName:function(l){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(l)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(l,o){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(o,l)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(l){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(l)}}),Object.defineProperties(Li.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(l){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=l}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),X(Gt.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Gt.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Ph},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(ap.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(_.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),py.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Qi.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(l){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=l}}),fr.prototype.setLens=function(l,o){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),o!==void 0&&(this.filmGauge=o),this.setFocalLength(l)},Object.defineProperties(ps.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(l){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=l}},shadowCameraLeft:{set:function(l){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=l}},shadowCameraRight:{set:function(l){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=l}},shadowCameraTop:{set:function(l){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=l}},shadowCameraBottom:{set:function(l){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=l}},shadowCameraNear:{set:function(l){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=l}},shadowCameraFar:{set:function(l){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=l}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(l){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=l}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(l){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=l}},shadowMapHeight:{set:function(l){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=l}}}),Object.defineProperties(pn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===xs},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(xs)}}}),X(pn.prototype,{setDynamic:function(l){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(l===!0?xs:fu),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),X($n.prototype,{addIndex:function(l){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(l)},addAttribute:function(l,o){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(o&&o.isBufferAttribute)&&!(o&&o.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(l,new pn(arguments[1],arguments[2]))):l==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(o),this):this.setAttribute(l,o)},addDrawCall:function(l,o,u){u!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(l,o)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(l){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(l)},applyMatrix:function(l){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(l)}}),Object.defineProperties($n.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(F1.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(l){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=l}}}),Object.defineProperties(GM.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(l){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=l}}}),Object.defineProperties(Vl.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===xs},set:function(l){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(l)}}}),X(Vl.prototype,{setDynamic:function(l){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(l===!0?xs:fu),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),X(vM.prototype,{getArrays:function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")}}),X(Eg.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(Ji.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Fi}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(l){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=l===ut}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(l){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=l}}}),Object.defineProperties(mm.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(pm.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(l){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=l}}}),Object.defineProperties(rs.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(l){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=l}}}),X(um.prototype,{clearTarget:function(l,o,u,f){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(l),this.clear(o,u,f)},animate:function(l){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(l)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(l){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(l)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(um.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(l){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=l}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(l){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=l}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(l){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=l===!0?cd:Ml}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(T1.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ec.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(l){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=l}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(l){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=l}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(l){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=l}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(l){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=l}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(l){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=l}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(l){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=l}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(l){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=l}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(l){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=l}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(l){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=l}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(l){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=l}}}),ra.prototype.updateCubeMap=function(l,o){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(l,o)},ra.prototype.clear=function(l,o,u,f){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(l,o,u,f)},pu.crossOrigin=void 0,pu.loadTexture=function(l,o,u,f){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const g=new nA;g.setCrossOrigin(this.crossOrigin);const y=g.load(l,u,void 0,f);return o&&(y.mapping=o),y},pu.loadTextureCube=function(l,o,u,f){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const g=new iA;g.setCrossOrigin(this.crossOrigin);const y=g.load(l,u,void 0,f);return o&&(y.mapping=o),y},pu.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},pu.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:de}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=de);const qN=function(l,o){var u=this,f,g,y=new fn,T=null;"VRFrameData"in window&&(T=new VRFrameData);function w(M){g=M,M.length>0?f=M[0]:o&&o("VR input not available.")}navigator.getVRDisplays&&navigator.getVRDisplays().then(w).catch(function(){console.warn("THREE.VRControls: Unable to get VR Displays")}),this.scale=1,this.standing=!1,this.userHeight=1.6,this.getVRDisplay=function(){return f},this.setVRDisplay=function(M){f=M},this.getVRDisplays=function(){return console.warn("THREE.VRControls: getVRDisplays() is being deprecated."),g},this.getStandingMatrix=function(){return y},this.update=function(){if(f){var M;f.getFrameData?(f.getFrameData(T),M=T.pose):f.getPose&&(M=f.getPose()),M.orientation!==null&&l.quaternion.fromArray(M.orientation),M.position!==null?l.position.fromArray(M.position):l.position.set(0,0,0),this.standing&&(f.stageParameters?(l.updateMatrix(),y.fromArray(f.stageParameters.sittingToStandingTransform),l.applyMatrix(y)):l.position.setY(l.position.y+this.userHeight)),l.position.multiplyScalar(u.scale)}},this.dispose=function(){f=null}},XN=function(l,o){var u,f,g=new Be,y=new Be,T,w,M=new fn,I=new fn,z=new fn,U=null;"VRFrameData"in window&&(U=new window.VRFrameData);function G(nt){f=nt,nt.length>0?u=nt[0]:o&&o("HMD not available")}navigator.getVRDisplays&&navigator.getVRDisplays().then(G).catch(function(){console.warn("THREE.VREffect: Unable to get VR Displays")}),this.isPresenting=!1;var W=this,J=l.getSize(),me=!1,pe=l.getPixelRatio();this.getVRDisplay=function(){return u},this.setVRDisplay=function(nt){u=nt},this.getVRDisplays=function(){return console.warn("THREE.VREffect: getVRDisplays() is being deprecated."),f},this.setSize=function(nt,Ke,st){if(J={width:nt,height:Ke},me=st,W.isPresenting){var Ct=u.getEyeParameters("left");l.setPixelRatio(1),l.setSize(Ct.renderWidth*2,Ct.renderHeight,!1)}else l.setPixelRatio(pe),l.setSize(nt,Ke,st)};var te=l.domElement,K=[0,0,.5,1],He=[.5,0,.5,1];function $e(){var nt=W.isPresenting;if(W.isPresenting=u!==void 0&&u.isPresenting,W.isPresenting){var Ke=u.getEyeParameters("left"),st=Ke.renderWidth,Ct=Ke.renderHeight;nt||(pe=l.getPixelRatio(),J=l.getSize(),l.setPixelRatio(1),l.setSize(st*2,Ct,!1))}else nt&&(l.setPixelRatio(pe),l.setSize(J.width,J.height,me))}window.addEventListener("vrdisplaypresentchange",$e,!1),this.setFullScreen=function(nt){return new Promise(function(Ke,st){if(u===void 0){st(new Error("No VR hardware found."));return}if(W.isPresenting===nt){Ke();return}Ke(nt?u.requestPresent([{source:te}]):u.exitPresent())})},this.requestPresent=function(){return this.setFullScreen(!0)},this.exitPresent=function(){return this.setFullScreen(!1)},this.requestAnimationFrame=function(nt){return u!==void 0?u.requestAnimationFrame(nt):window.requestAnimationFrame(nt)},this.cancelAnimationFrame=function(nt){u!==void 0?u.cancelAnimationFrame(nt):window.cancelAnimationFrame(nt)},this.submitFrame=function(){u!==void 0&&W.isPresenting&&u.submitFrame()},this.autoSubmitFrame=!0;var Ue=new fr;Ue.layers.enable(1);var Ae=new fr;Ae.layers.enable(2),this.render=function(nt,Ke,st,Ct){if(u&&W.isPresenting){var Xt=nt.autoUpdate;Xt&&(nt.updateMatrixWorld(),nt.autoUpdate=!1),Array.isArray(nt)&&(console.warn("THREE.VREffect.render() no longer supports arrays. Use object.layers instead."),nt=nt[0]);var ti=l.getSize(),ni=u.getLayers(),Ai,_i;if(ni.length){var on=ni[0];Ai=on.leftBounds!==null&&on.leftBounds.length===4?on.leftBounds:K,_i=on.rightBounds!==null&&on.rightBounds.length===4?on.rightBounds:He}else Ai=K,_i=He;if(T={x:Math.round(ti.width*Ai[0]),y:Math.round(ti.height*Ai[1]),width:Math.round(ti.width*Ai[2]),height:Math.round(ti.height*Ai[3])},w={x:Math.round(ti.width*_i[0]),y:Math.round(ti.height*_i[1]),width:Math.round(ti.width*_i[2]),height:Math.round(ti.height*_i[3])},st?(l.setRenderTarget(st),st.scissorTest=!0):(l.setRenderTarget(null),l.setScissorTest(!0)),(l.autoClear||Ct)&&l.clear(),Ke.parent===null&&Ke.updateMatrixWorld(),Ke.matrixWorld.decompose(Ue.position,Ue.quaternion,Ue.scale),Ae.position.copy(Ue.position),Ae.quaternion.copy(Ue.quaternion),Ae.scale.copy(Ue.scale),u.getFrameData)u.depthNear=Ke.near,u.depthFar=Ke.far,u.getFrameData(U),Ue.projectionMatrix.elements=U.leftProjectionMatrix,Ae.projectionMatrix.elements=U.rightProjectionMatrix,wt(U),Ue.updateMatrix(),Ue.matrix.multiply(I),Ue.matrix.decompose(Ue.position,Ue.quaternion,Ue.scale),Ae.updateMatrix(),Ae.matrix.multiply(z),Ae.matrix.decompose(Ae.position,Ae.quaternion,Ae.scale);else{var vn=u.getEyeParameters("left"),Pn=u.getEyeParameters("right");Ue.projectionMatrix=Nt(vn.fieldOfView,!0,Ke.near,Ke.far),Ae.projectionMatrix=Nt(Pn.fieldOfView,!0,Ke.near,Ke.far),g.fromArray(vn.offset),y.fromArray(Pn.offset),Ue.translateOnAxis(g,Ue.scale.x),Ae.translateOnAxis(y,Ae.scale.x)}st?(st.viewport.set(T.x,T.y,T.width,T.height),st.scissor.set(T.x,T.y,T.width,T.height)):(l.setViewport(T.x,T.y,T.width,T.height),l.setScissor(T.x,T.y,T.width,T.height)),l.render(nt,Ue,st,Ct),st?(st.viewport.set(w.x,w.y,w.width,w.height),st.scissor.set(w.x,w.y,w.width,w.height)):(l.setViewport(w.x,w.y,w.width,w.height),l.setScissor(w.x,w.y,w.width,w.height)),l.render(nt,Ae,st,Ct),st?(st.viewport.set(0,0,ti.width,ti.height),st.scissor.set(0,0,ti.width,ti.height),st.scissorTest=!1,l.setRenderTarget(null)):(l.setViewport(0,0,ti.width,ti.height),l.setScissorTest(!1)),Xt&&(nt.autoUpdate=!0),W.autoSubmitFrame&&W.submitFrame();return}l.render(nt,Ke,st,Ct)},this.dispose=function(){window.removeEventListener("vrdisplaypresentchange",$e,!1)};var at=new Wr,Ht=new Be;function wt(nt){nt.pose.orientation?(at.fromArray(nt.pose.orientation),M.makeRotationFromQuaternion(at)):M.identity(),nt.pose.position&&(Ht.fromArray(nt.pose.position),M.setPosition(Ht)),I.fromArray(nt.leftViewMatrix),I.multiply(M),z.fromArray(nt.rightViewMatrix),z.multiply(M),I.getInverse(I),z.getInverse(z)}function It(nt){var Ke=2/(nt.leftTan+nt.rightTan),st=(nt.leftTan-nt.rightTan)*Ke*.5,Ct=2/(nt.upTan+nt.downTan),Xt=(nt.upTan-nt.downTan)*Ct*.5;return{scale:[Ke,Ct],offset:[st,Xt]}}function Pt(nt,Ke,st,Ct){Ke=Ke===void 0?!0:Ke,st=st===void 0?.01:st,Ct=Ct===void 0?1e4:Ct;var Xt=Ke?-1:1,ti=new fn,ni=ti.elements,Ai=It(nt);return ni[0*4+0]=Ai.scale[0],ni[0*4+1]=0,ni[0*4+2]=Ai.offset[0]*Xt,ni[0*4+3]=0,ni[1*4+0]=0,ni[1*4+1]=Ai.scale[1],ni[1*4+2]=-Ai.offset[1]*Xt,ni[1*4+3]=0,ni[2*4+0]=0,ni[2*4+1]=0,ni[2*4+2]=Ct/(st-Ct)*-Xt,ni[2*4+3]=Ct*st/(st-Ct),ni[3*4+0]=0,ni[3*4+1]=0,ni[3*4+2]=Xt,ni[3*4+3]=0,ti.transpose(),ti}function Nt(nt,Ke,st,Ct){var Xt=Math.PI/180,ti={upTan:Math.tan(nt.upDegrees*Xt),downTan:Math.tan(nt.downDegrees*Xt),leftTan:Math.tan(nt.leftDegrees*Xt),rightTan:Math.tan(nt.rightDegrees*Xt)};return Pt(ti,Ke,st,Ct)}},wy=function(l,o){this.object=l,this.domElement=o!==void 0?o:document,this.enabled=!0,this.target=new Be,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:ge.LEFT,ZOOM:ge.MIDDLE,PAN:ge.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return I.phi},this.getAzimuthalAngle=function(){return I.theta},this.saveState=function(){u.target0.copy(u.target),u.position0.copy(u.object.position),u.zoom0=u.object.zoom},this.reset=function(){u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.zoom=u.zoom0,u.object.updateProjectionMatrix(),u.dispatchEvent(f),u.update(),w=T.NONE},this.update=function(){var mt=new Be,oi=new Wr().setFromUnitVectors(l.up,new Be(0,1,0)),Ie=oi.clone().inverse(),we=new Be,qt=new Wr;return function(){var We=u.object.position;return mt.copy(We).sub(u.target),mt.applyQuaternion(oi),I.setFromVector3(mt),u.autoRotate&&w===T.NONE&&u.rotateLeft(at()),I.theta+=z.theta,I.phi+=z.phi,I.theta=Math.max(u.minAzimuthAngle,Math.min(u.maxAzimuthAngle,I.theta)),I.phi=Math.max(u.minPolarAngle,Math.min(u.maxPolarAngle,I.phi)),I.makeSafe(),I.radius*=U,I.radius=Math.max(u.minDistance,Math.min(u.maxDistance,I.radius)),u.target.add(G),mt.setFromSpherical(I),mt.applyQuaternion(Ie),We.copy(u.target).add(mt),u.object.lookAt(u.target),u.enableDamping===!0?(z.theta*=1-u.dampingFactor,z.phi*=1-u.dampingFactor,G.multiplyScalar(1-u.dampingFactor)):(z.set(0,0,0),G.set(0,0,0)),U=1,W||we.distanceToSquared(u.object.position)>M||8*(1-qt.dot(u.object.quaternion))>M?(u.dispatchEvent(f),we.copy(u.object.position),qt.copy(u.object.quaternion),W=!1,!0):!1}}(),this.dispose=function(){u.domElement.removeEventListener("contextmenu",Ti,!1),u.domElement.removeEventListener("mousedown",ua,!1),u.domElement.removeEventListener("wheel",yn,!1),u.domElement.removeEventListener("touchstart",Sn,!1),u.domElement.removeEventListener("touchend",gi,!1),u.domElement.removeEventListener("touchmove",li,!1),document.removeEventListener("mousemove",mn,!1),document.removeEventListener("mouseup",Wn,!1),window.removeEventListener("keydown",pr,!1)};var u=this,f={type:"change"},g={type:"start"},y={type:"end"},T={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},w=T.NONE,M=1e-6,I=new WM,z=new WM,U=1,G=new Be,W=!1,J=new At,me=new At,pe=new At,te=new At,K=new At,He=new At,$e=new At,Ue=new At,Ae=new At;function at(){return 2*Math.PI/60/60*u.autoRotateSpeed}function Ht(){return Math.pow(.95,u.zoomSpeed)}u.rotateLeft=function(oi){z.theta-=oi},u.rotateUp=function(oi){z.phi-=oi};var wt=function(){var mt=new Be;return function(Ie,we){mt.setFromMatrixColumn(we,0),mt.multiplyScalar(-Ie),G.add(mt)}}(),It=function(){var mt=new Be;return function(Ie,we){u.screenSpacePanning===!0?mt.setFromMatrixColumn(we,1):(mt.setFromMatrixColumn(we,0),mt.crossVectors(u.object.up,mt)),mt.multiplyScalar(Ie),G.add(mt)}}(),Pt=function(){var mt=new Be;return function(Ie,we){var qt=u.domElement===document?u.domElement.body:u.domElement;if(u.object.isPerspectiveCamera){var $t=u.object.position;mt.copy($t).sub(u.target);var We=mt.length();We*=Math.tan(u.object.fov/2*Math.PI/180),wt(2*Ie*We/qt.clientHeight,u.object.matrix),It(2*we*We/qt.clientHeight,u.object.matrix)}else u.object.isOrthographicCamera?(wt(Ie*(u.object.right-u.object.left)/u.object.zoom/qt.clientWidth,u.object.matrix),It(we*(u.object.top-u.object.bottom)/u.object.zoom/qt.clientHeight,u.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),u.enablePan=!1)}}();function Nt(mt){u.object.isPerspectiveCamera?U/=mt:u.object.isOrthographicCamera?(u.object.zoom=Math.max(u.minZoom,Math.min(u.maxZoom,u.object.zoom*mt)),u.object.updateProjectionMatrix(),W=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),u.enableZoom=!1)}function nt(mt){u.object.isPerspectiveCamera?U*=mt:u.object.isOrthographicCamera?(u.object.zoom=Math.max(u.minZoom,Math.min(u.maxZoom,u.object.zoom/mt)),u.object.updateProjectionMatrix(),W=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),u.enableZoom=!1)}function Ke(mt){J.set(mt.clientX,mt.clientY)}function st(mt){$e.set(mt.clientX,mt.clientY)}function Ct(mt){te.set(mt.clientX,mt.clientY)}function Xt(mt){me.set(mt.clientX,mt.clientY),pe.subVectors(me,J).multiplyScalar(u.rotateSpeed);var oi=u.domElement===document?u.domElement.body:u.domElement;u.rotateLeft(2*Math.PI*pe.x/oi.clientHeight),u.rotateUp(2*Math.PI*pe.y/oi.clientHeight),J.copy(me),u.update()}function ti(mt){Ue.set(mt.clientX,mt.clientY),Ae.subVectors(Ue,$e),Ae.y>0?Nt(Ht()):Ae.y<0&&nt(Ht()),$e.copy(Ue),u.update()}function ni(mt){K.set(mt.clientX,mt.clientY),He.subVectors(K,te).multiplyScalar(u.panSpeed),Pt(He.x,He.y),te.copy(K),u.update()}function Ai(mt){mt.deltaY<0?nt(Ht()):mt.deltaY>0&&Nt(Ht()),u.update()}function _i(mt){switch(mt.keyCode){case u.keys.UP:Pt(0,u.keyPanSpeed),u.update();break;case u.keys.BOTTOM:Pt(0,-u.keyPanSpeed),u.update();break;case u.keys.LEFT:Pt(u.keyPanSpeed,0),u.update();break;case u.keys.RIGHT:Pt(-u.keyPanSpeed,0),u.update();break}}function on(mt){J.set(mt.touches[0].pageX,mt.touches[0].pageY)}function vn(mt){if(u.enableZoom){var oi=mt.touches[0].pageX-mt.touches[1].pageX,Ie=mt.touches[0].pageY-mt.touches[1].pageY,we=Math.sqrt(oi*oi+Ie*Ie);$e.set(0,we)}if(u.enablePan){var qt=.5*(mt.touches[0].pageX+mt.touches[1].pageX),$t=.5*(mt.touches[0].pageY+mt.touches[1].pageY);te.set(qt,$t)}}function Pn(mt){me.set(mt.touches[0].pageX,mt.touches[0].pageY),pe.subVectors(me,J).multiplyScalar(u.rotateSpeed);var oi=u.domElement===document?u.domElement.body:u.domElement;u.rotateLeft(2*Math.PI*pe.x/oi.clientHeight),u.rotateUp(2*Math.PI*pe.y/oi.clientHeight),J.copy(me),u.update()}function Kt(mt){if(u.enableZoom){var oi=mt.touches[0].pageX-mt.touches[1].pageX,Ie=mt.touches[0].pageY-mt.touches[1].pageY,we=Math.sqrt(oi*oi+Ie*Ie);Ue.set(0,we),Ae.set(0,Math.pow(Ue.y/$e.y,u.zoomSpeed)),Nt(Ae.y),$e.copy(Ue)}if(u.enablePan){var qt=.5*(mt.touches[0].pageX+mt.touches[1].pageX),$t=.5*(mt.touches[0].pageY+mt.touches[1].pageY);K.set(qt,$t),He.subVectors(K,te).multiplyScalar(u.panSpeed),Pt(He.x,He.y),te.copy(K)}u.update()}function ua(mt){if(u.enabled!==!1){switch(mt.preventDefault(),mt.button){case u.mouseButtons.ORBIT:if(u.enableRotate===!1)return;Ke(mt),w=T.ROTATE;break;case u.mouseButtons.ZOOM:if(u.enableZoom===!1)return;st(mt),w=T.DOLLY;break;case u.mouseButtons.PAN:if(u.enablePan===!1)return;Ct(mt),w=T.PAN;break}w!==T.NONE&&(document.addEventListener("mousemove",mn,!1),document.addEventListener("mouseup",Wn,!1),u.dispatchEvent(g))}}function mn(mt){if(u.enabled!==!1)switch(mt.preventDefault(),w){case T.ROTATE:if(u.enableRotate===!1)return;Xt(mt);break;case T.DOLLY:if(u.enableZoom===!1)return;ti(mt);break;case T.PAN:if(u.enablePan===!1)return;ni(mt);break}}function Wn(mt){u.enabled!==!1&&(document.removeEventListener("mousemove",mn,!1),document.removeEventListener("mouseup",Wn,!1),u.dispatchEvent(y),w=T.NONE)}function yn(mt){u.enabled===!1||u.enableZoom===!1||w!==T.NONE&&w!==T.ROTATE||(mt.preventDefault(),mt.stopPropagation(),u.dispatchEvent(g),Ai(mt),u.dispatchEvent(y))}function pr(mt){u.enabled===!1||u.enableKeys===!1||u.enablePan===!1||_i(mt)}function Sn(mt){if(u.enabled!==!1){switch(mt.preventDefault(),mt.touches.length){case 1:if(u.enableRotate===!1)return;on(mt),w=T.TOUCH_ROTATE;break;case 2:if(u.enableZoom===!1&&u.enablePan===!1)return;vn(mt),w=T.TOUCH_DOLLY_PAN;break;default:w=T.NONE}w!==T.NONE&&u.dispatchEvent(g)}}function li(mt){if(u.enabled!==!1)switch(mt.preventDefault(),mt.stopPropagation(),mt.touches.length){case 1:if(u.enableRotate===!1||w!==T.TOUCH_ROTATE)return;Pn(mt);break;case 2:if(u.enableZoom===!1&&u.enablePan===!1||w!==T.TOUCH_DOLLY_PAN)return;Kt(mt);break;default:w=T.NONE}}function gi(mt){u.enabled!==!1&&(u.dispatchEvent(y),w=T.NONE)}function Ti(mt){u.enabled!==!1&&mt.preventDefault()}u.domElement.addEventListener("mousedown",ua,!1),u.domElement.addEventListener("wheel",yn,!1),u.domElement.addEventListener("touchstart",Sn,!1),u.domElement.addEventListener("touchend",gi,!1),u.domElement.addEventListener("touchmove",li,!1),window.addEventListener("keydown",pr,!1),this.update()};wy.prototype=Object.create(ks.prototype),wy.prototype.constructor=wy,Object.defineProperties(wy.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(l){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!l}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(l){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!l}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(l){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!l}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(l){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!l}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(l){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!l}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(l){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=l}}});const YN=function(l){var o=this;this.object=l,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var u=function(y){o.deviceOrientation=y},f=function(){o.screenOrientation=window.orientation||0},g=function(){var y=new Be(0,0,1),T=new E,w=new Wr,M=new Wr(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(I,z,U,G,W){T.set(U,z,-G,"YXZ"),I.setFromEuler(T),I.multiply(M),I.multiply(w.setFromAxisAngle(y,-W))}}();this.connect=function(){f(),window.addEventListener("orientationchange",f,!1),window.addEventListener("deviceorientation",u,!1),o.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",f,!1),window.removeEventListener("deviceorientation",u,!1),o.enabled=!1},this.update=function(){if(o.enabled!==!1){var y=o.deviceOrientation;if(y){var T=y.alpha?Gi.degToRad(y.alpha)+o.alphaOffset:0,w=y.beta?Gi.degToRad(y.beta):0,M=y.gamma?Gi.degToRad(y.gamma):0,I=o.screenOrientation?Gi.degToRad(o.screenOrientation):0;g(o.object.quaternion,T,w,M,I)}}},this.dispose=function(){o.disconnect()},this.connect()};function QN(l,o,u,f){const g=l*o+u*f;if(g>.499){const U=2*Math.atan2(l,f),G=Math.PI/2,W=0;return new Be(G,W,U)}if(g<-.499){const U=-2*Math.atan2(l,f),G=-Math.PI/2,W=0;return new Be(G,W,U)}const y=l*l,T=o*o,w=u*u,M=Math.atan2(2*o*f-2*l*u,1-2*T-2*w),I=Math.asin(2*g),z=Math.atan2(2*l*f-2*o*u,1-2*y-2*w);return new Be(I,z,M)}class KN{constructor(o){this.object=o.camera,this.domElement=o.canvas,this.orbit=new wy(this.object,this.domElement),this.speed=.5,this.orbit.target.set(0,0,-1),this.orbit.enableZoom=!1,this.orbit.enablePan=!1,this.orbit.rotateSpeed=-this.speed,o.orientation&&(this.orientation=new YN(this.object)),o.halfView&&(this.orbit.minAzimuthAngle=-Math.PI/4,this.orbit.maxAzimuthAngle=Math.PI/4)}update(){if(this.orientation){this.orientation.update();const o=this.orientation.object.quaternion,u=QN(o.x,o.y,o.z,o.w);typeof this.lastAngle_>"u"&&(this.lastAngle_=u),this.orbit.rotateLeft((this.lastAngle_.z-u.z)*(1+this.speed)),this.orbit.rotateUp((this.lastAngle_.y-u.y)*(1+this.speed)),this.lastAngle_=u}this.orbit.update()}dispose(){this.orbit.dispose(),this.orientation&&this.orientation.dispose()}}const ZN=function(){const l=document.createElement("video");return l.crossOrigin="anonymous",l.hasAttribute("crossorigin")}(),U1=["360","360_LR","360_TB","360_CUBE","EAC","EAC_LR","NONE","AUTO","Sphere","Cube","equirectangular","180","180_LR","180_MONO"],gA=function(l){if(l){if(l=l.toString().trim(),/sphere/i.test(l))return"360";if(/cube/i.test(l))return"360_CUBE";if(/equirectangular/i.test(l))return"360";for(let o=0;o<U1.length;o++)if(new RegExp("^"+U1[o]+"$","i").test(l))return U1[o]}};class JN extends n.default.EventTarget{constructor(o,u,f){super(),this.player=o,this.canvas=u,this.options=f,this.onMoveEnd=n.default.bind(this,this.onMoveEnd),this.onMoveStart=n.default.bind(this,this.onMoveStart),this.onMove=n.default.bind(this,this.onMove),this.onControlBarMove=n.default.bind(this,this.onControlBarMove),this.player.controlBar.on(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],this.onControlBarMove),this.oldReportUserActivity=this.player.reportUserActivity,this.player.reportUserActivity=()=>{},this.canvas.addEventListener("mousedown",this.onMoveStart),this.canvas.addEventListener("touchstart",this.onMoveStart),this.canvas.addEventListener("mousemove",this.onMove),this.canvas.addEventListener("touchmove",this.onMove),this.canvas.addEventListener("mouseup",this.onMoveEnd),this.canvas.addEventListener("touchend",this.onMoveEnd),this.shouldTogglePlay=!1}togglePlay(){this.player.paused()?this.player.play():this.player.pause()}onMoveStart(o){if(this.options.disableTogglePlay||!this.player.controls()||o.type==="mousedown"&&!n.default.dom.isSingleLeftClick(o)){this.shouldTogglePlay=!1;return}this.shouldTogglePlay=!0,this.touchMoveCount_=0}onMoveEnd(o){if(o.type==="touchend"&&this.touchMoveCount_<10){if(this.player.userActive()===!1){this.player.userActive(!0);return}this.player.userActive(!1);return}this.shouldTogglePlay&&o.type==="mouseup"&&this.togglePlay()}onMove(o){this.touchMoveCount_++,this.shouldTogglePlay=!1}onControlBarMove(o){this.player.userActive(!0)}dispose(){this.canvas.removeEventListener("mousedown",this.onMoveStart),this.canvas.removeEventListener("touchstart",this.onMoveStart),this.canvas.removeEventListener("mousemove",this.onMove),this.canvas.removeEventListener("touchmove",this.onMove),this.canvas.removeEventListener("mouseup",this.onMoveEnd),this.canvas.removeEventListener("touchend",this.onMoveEnd),this.player.controlBar.off(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],this.onControlBarMove),this.player.reportUserActivity=this.oldReportUserActivity}}class e5 extends n.default.EventTarget{constructor(o,u,f,g){super();const y=n.default.mergeOptions({channelMap:n.default.browser.IS_SAFARI?[2,0,1,3]:[0,1,2,3],ambisonicOrder:1},g);this.videoElementSource=o.createMediaElementSource(f),this.foaRenderer=u.createFOARenderer(o,y),this.foaRenderer.initialize().then(()=>{o.state==="suspended"&&this.trigger({type:"audiocontext-suspended"}),this.videoElementSource.connect(this.foaRenderer.input),this.foaRenderer.output.connect(o.destination),this.initialized=!0,this.trigger({type:"omnitone-ready"})},T=>{n.default.log.warn(`videojs-vr: Omnitone initializes failed with the following error: ${T})`)})}update(o){this.initialized&&this.foaRenderer.setRotationMatrixFromCamera(o.matrix)}dispose(){this.initialized=!1,this.foaRenderer.setRenderingMode("bypass"),this.foaRenderer=null}}const t5=n.default.getComponent("Button");class i5 extends t5{constructor(o,u){super(o,u),this.handleVrDisplayActivate_=n.default.bind(this,this.handleVrDisplayActivate_),this.handleVrDisplayDeactivate_=n.default.bind(this,this.handleVrDisplayDeactivate_),this.handleVrDisplayPresentChange_=n.default.bind(this,this.handleVrDisplayPresentChange_),this.handleOrientationChange_=n.default.bind(this,this.handleOrientationChange_),window.addEventListener("orientationchange",this.handleOrientationChange_),window.addEventListener("vrdisplayactivate",this.handleVrDisplayActivate_),window.addEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_),window.addEventListener("vrdisplaypresentchange",this.handleVrDisplayPresentChange_),n.default.browser.IS_ANDROID&&this.on(o,"fullscreenchange",()=>{o.isFullscreen()?this.hide():this.show()})}buildCSSClass(){return`vjs-button-vr ${super.buildCSSClass()}`}handleVrDisplayPresentChange_(){!this.player_.vr().vrDisplay.isPresenting&&this.active_&&this.handleVrDisplayDeactivate_(),this.player_.vr().vrDisplay.isPresenting&&!this.active_&&this.handleVrDisplayActivate_()}handleOrientationChange_(){this.active_&&n.default.browser.IS_IOS&&this.changeSize_()}changeSize_(){this.player_.width(window.innerWidth),this.player_.height(window.innerHeight),window.dispatchEvent(new window.Event("resize"))}handleVrDisplayActivate_(){n.default.browser.IS_IOS&&(this.oldWidth_=this.player_.currentWidth(),this.oldHeight_=this.player_.currentHeight(),this.player_.enterFullWindow(),this.changeSize_()),this.active_=!0}handleVrDisplayDeactivate_(){n.default.browser.IS_IOS&&(this.oldWidth_&&this.player_.width(this.oldWidth_),this.oldHeight_&&this.player_.height(this.oldHeight_),this.player_.exitFullWindow()),this.active_=!1}handleClick(o){this.active_?window.dispatchEvent(new window.Event("vrdisplaydeactivate")):(!this.player_.hasStarted()&&n.default.browser.IS_ANDROID&&this.player_.play(),window.dispatchEvent(new window.Event("vrdisplayactivate")))}dispose(){super.dispose(),window.removeEventListener("vrdisplayactivate",this.handleVrDisplayActivate_),window.removeEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_),window.removeEventListener("vrdisplaypresentchange",this.handleVrDisplayPresentChange_)}}n.default.registerComponent("CardboardButton",i5);const n5=n.default.getComponent("BigPlayButton");class r5 extends n5{buildCSSClass(){return`vjs-big-vr-play-button ${super.buildCSSClass()}`}}n.default.registerComponent("BigVrPlayButton",r5);const s5={debug:!1,omnitone:!1,forceCardboard:!1,omnitoneOptions:{},projection:"AUTO",sphereDetail:32,disableTogglePlay:!1},YM={"web-vr-out-of-date":{headline:"360 is out of date",type:"360_OUT_OF_DATE",message:"Your browser supports 360 but not the latest version. See <a href='http://webvr.info'>http://webvr.info</a> for more info."},"web-vr-not-supported":{headline:"360 not supported on this device",type:"360_NOT_SUPPORTED",message:"Your browser does not support 360. See <a href='http://webvr.info'>http://webvr.info</a> for assistance."},"web-vr-hls-cors-not-supported":{headline:"360 HLS video not supported on this device",type:"360_NOT_SUPPORTED",message:"Your browser/device does not support HLS 360 video. See <a href='http://webvr.info'>http://webvr.info</a> for assistance."}},a5=n.default.getPlugin("plugin"),QM=n.default.getComponent("Component");class Ey extends a5{constructor(o,u){const f=n.default.mergeOptions(s5,u);if(super(o,f),this.options_=f,this.player_=o,this.bigPlayButtonIndex_=o.children().indexOf(o.getChild("BigPlayButton"))||0,this.videojsErrorsSupport_=!!n.default.errors,this.videojsErrorsSupport_&&o.errors({errors:YM}),n.default.browser.IE_VERSION||!ZN){this.player_.on("loadstart",()=>{this.triggerError_({code:"web-vr-not-supported",dismiss:!1})});return}this.polyfill_=new P({ROTATE_INSTRUCTIONS_DISABLED:!0}),this.polyfill_=new P,this.handleVrDisplayActivate_=n.default.bind(this,this.handleVrDisplayActivate_),this.handleVrDisplayDeactivate_=n.default.bind(this,this.handleVrDisplayDeactivate_),this.handleResize_=n.default.bind(this,this.handleResize_),this.animate_=n.default.bind(this,this.animate_),this.setProjection(this.options_.projection),this.on(o,"adstart",()=>o.setTimeout(()=>{if(!o.ads||!o.ads.videoElementRecycled()){this.log("video element not recycled for this ad, no need to reset");return}this.log("video element recycled for this ad, reseting"),this.reset(),this.one(o,"playing",this.init)}),1),this.on(o,"loadedmetadata",this.init)}changeProjection_(o){o=gA(o),o||(o="NONE");const u={x:0,y:0,z:0};if(this.scene&&this.scene.remove(this.movieScreen),o==="AUTO"){if(this.player_.mediainfo&&this.player_.mediainfo.projection&&this.player_.mediainfo.projection!=="AUTO"){const f=gA(this.player_.mediainfo.projection);return this.changeProjection_(f)}return this.changeProjection_("NONE")}else if(o==="360")this.movieGeometry=new yy(256,this.options_.sphereDetail,this.options_.sphereDetail),this.movieMaterial=new Un({map:this.videoTexture,overdraw:!0,side:De}),this.movieScreen=new Gt(this.movieGeometry,this.movieMaterial),this.movieScreen.position.set(u.x,u.y,u.z),this.movieScreen.scale.x=-1,this.movieScreen.quaternion.setFromAxisAngle({x:0,y:1,z:0},-Math.PI/2),this.scene.add(this.movieScreen);else if(o==="360_LR"||o==="360_TB"){let f=new yy(256,this.options_.sphereDetail,this.options_.sphereDetail),g=f.faceVertexUvs[0];for(let y=0;y<g.length;y++)for(let T=0;T<3;T++)o==="360_LR"?g[y][T].x*=.5:(g[y][T].y*=.5,g[y][T].y+=.5);this.movieGeometry=new $n().fromGeometry(f),this.movieMaterial=new Un({map:this.videoTexture,overdraw:!0,side:De}),this.movieScreen=new Gt(this.movieGeometry,this.movieMaterial),this.movieScreen.scale.x=-1,this.movieScreen.quaternion.setFromAxisAngle({x:0,y:1,z:0},-Math.PI/2),this.movieScreen.layers.set(1),this.scene.add(this.movieScreen),f=new yy(256,this.options_.sphereDetail,this.options_.sphereDetail),g=f.faceVertexUvs[0];for(let y=0;y<g.length;y++)for(let T=0;T<3;T++)o==="360_LR"?(g[y][T].x*=.5,g[y][T].x+=.5):g[y][T].y*=.5;this.movieGeometry=new $n().fromGeometry(f),this.movieMaterial=new Un({map:this.videoTexture,overdraw:!0,side:De}),this.movieScreen=new Gt(this.movieGeometry,this.movieMaterial),this.movieScreen.scale.x=-1,this.movieScreen.quaternion.setFromAxisAngle({x:0,y:1,z:0},-Math.PI/2),this.movieScreen.layers.set(2),this.scene.add(this.movieScreen)}else if(o==="360_CUBE"){this.movieGeometry=new Xi(256,256,256),this.movieMaterial=new Un({map:this.videoTexture,overdraw:!0,side:De});const f=[new At(0,.5),new At(.333,.5),new At(.333,1),new At(0,1)],g=[new At(.333,.5),new At(.666,.5),new At(.666,1),new At(.333,1)],y=[new At(.666,.5),new At(1,.5),new At(1,1),new At(.666,1)],T=[new At(0,0),new At(.333,0),new At(.333,.5),new At(0,.5)],w=[new At(.333,0),new At(.666,0),new At(.666,.5),new At(.333,.5)],M=[new At(.666,0),new At(1,0),new At(1,.5),new At(.666,.5)];this.movieGeometry.faceVertexUvs[0]=[],this.movieGeometry.faceVertexUvs[0][0]=[g[2],g[1],g[3]],this.movieGeometry.faceVertexUvs[0][1]=[g[1],g[0],g[3]],this.movieGeometry.faceVertexUvs[0][2]=[f[2],f[1],f[3]],this.movieGeometry.faceVertexUvs[0][3]=[f[1],f[0],f[3]],this.movieGeometry.faceVertexUvs[0][4]=[y[2],y[1],y[3]],this.movieGeometry.faceVertexUvs[0][5]=[y[1],y[0],y[3]],this.movieGeometry.faceVertexUvs[0][6]=[T[2],T[1],T[3]],this.movieGeometry.faceVertexUvs[0][7]=[T[1],T[0],T[3]],this.movieGeometry.faceVertexUvs[0][8]=[w[2],w[1],w[3]],this.movieGeometry.faceVertexUvs[0][9]=[w[1],w[0],w[3]],this.movieGeometry.faceVertexUvs[0][10]=[M[2],M[1],M[3]],this.movieGeometry.faceVertexUvs[0][11]=[M[1],M[0],M[3]],this.movieScreen=new Gt(this.movieGeometry,this.movieMaterial),this.movieScreen.position.set(u.x,u.y,u.z),this.movieScreen.rotation.y=-Math.PI,this.scene.add(this.movieScreen)}else if(o==="180"||o==="180_LR"||o==="180_MONO"){let f=new yy(256,this.options_.sphereDetail,this.options_.sphereDetail,Math.PI,Math.PI);f.scale(-1,1,1);let g=f.faceVertexUvs[0];if(o!=="180_MONO")for(let y=0;y<g.length;y++)for(let T=0;T<3;T++)g[y][T].x*=.5;this.movieGeometry=new $n().fromGeometry(f),this.movieMaterial=new Un({map:this.videoTexture,overdraw:!0}),this.movieScreen=new Gt(this.movieGeometry,this.movieMaterial),this.movieScreen.layers.set(1),this.scene.add(this.movieScreen),f=new yy(256,this.options_.sphereDetail,this.options_.sphereDetail,Math.PI,Math.PI),f.scale(-1,1,1),g=f.faceVertexUvs[0];for(let y=0;y<g.length;y++)for(let T=0;T<3;T++)g[y][T].x*=.5,g[y][T].x+=.5;this.movieGeometry=new $n().fromGeometry(f),this.movieMaterial=new Un({map:this.videoTexture,overdraw:!0}),this.movieScreen=new Gt(this.movieGeometry,this.movieMaterial),this.movieScreen.layers.set(2),this.scene.add(this.movieScreen)}else if(o==="EAC"||o==="EAC_LR"){const f=(g,y)=>{this.movieGeometry=new Xi(256,256,256),this.movieMaterial=new rs({overdraw:!0,side:De,uniforms:{mapped:{value:this.videoTexture},mapMatrix:{value:g},contCorrect:{value:2},faceWH:{value:new At(.3333333333333333,.5).applyMatrix3(y)},vidWH:{value:new At(this.videoTexture.image.videoWidth,this.videoTexture.image.videoHeight).applyMatrix3(y)}},vertexShader:`
varying vec2 vUv;
uniform mat3 mapMatrix;

void main() {
  vUv = (mapMatrix * vec3(uv, 1.)).xy;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.);
}`,fragmentShader:`
varying vec2 vUv;
uniform sampler2D mapped;
uniform vec2 faceWH;
uniform vec2 vidWH;
uniform float contCorrect;

const float PI = 3.1415926535897932384626433832795;

void main() {
  vec2 corner = vUv - mod(vUv, faceWH) + vec2(0, contCorrect / vidWH.y);

  vec2 faceWHadj = faceWH - vec2(0, contCorrect * 2. / vidWH.y);

  vec2 p = (vUv - corner) / faceWHadj - .5;
  vec2 q = 2. / PI * atan(2. * p) + .5;

  vec2 eUv = corner + q * faceWHadj;

  gl_FragColor = texture2D(mapped, eUv);
}`});const w=[new At(0,1/2),new At(1/3,1/2),new At(1/3,1),new At(0,1)],M=[new At(1/3,1/2),new At(2/3,1/2),new At(2/3,1),new At(1/3,1)],I=[new At(2/3,1/2),new At(1,1/2),new At(1,1),new At(2/3,1)],z=[new At(1/3,0),new At(1/3,1/2),new At(0,1/2),new At(0,0)],U=[new At(1/3,1/2),new At(1/3,0),new At(2/3,0),new At(2/3,1/2)],G=[new At(1,0),new At(1,1/2),new At(2/3,1/2),new At(2/3,0)];for(const W of[w,M,I,z,U,G]){const J=this.videoTexture.image.videoHeight;let me=1,pe=0;for(const te of W)te.y<me&&(me=te.y),te.y>pe&&(pe=te.y);for(const te of W)Math.abs(te.y-me)<Number.EPSILON&&(te.y+=2/J),Math.abs(te.y-pe)<Number.EPSILON&&(te.y-=2/J),te.x=te.x/J*(J-4)+2/J}return this.movieGeometry.faceVertexUvs[0]=[],this.movieGeometry.faceVertexUvs[0][0]=[w[2],w[1],w[3]],this.movieGeometry.faceVertexUvs[0][1]=[w[1],w[0],w[3]],this.movieGeometry.faceVertexUvs[0][2]=[I[2],I[1],I[3]],this.movieGeometry.faceVertexUvs[0][3]=[I[1],I[0],I[3]],this.movieGeometry.faceVertexUvs[0][4]=[G[2],G[1],G[3]],this.movieGeometry.faceVertexUvs[0][5]=[G[1],G[0],G[3]],this.movieGeometry.faceVertexUvs[0][6]=[z[2],z[1],z[3]],this.movieGeometry.faceVertexUvs[0][7]=[z[1],z[0],z[3]],this.movieGeometry.faceVertexUvs[0][8]=[M[2],M[1],M[3]],this.movieGeometry.faceVertexUvs[0][9]=[M[1],M[0],M[3]],this.movieGeometry.faceVertexUvs[0][10]=[U[2],U[1],U[3]],this.movieGeometry.faceVertexUvs[0][11]=[U[1],U[0],U[3]],this.movieScreen=new Gt(this.movieGeometry,this.movieMaterial),this.movieScreen.position.set(u.x,u.y,u.z),this.movieScreen.rotation.y=-Math.PI,this.movieScreen};if(o==="EAC")this.scene.add(f(new Os,new Os));else{const g=new Os().set(0,.5,0,1,0,0,0,0,1);f(new Os().set(0,-.5,.5,1,0,0,0,0,1),g),this.movieScreen.layers.set(1),this.scene.add(this.movieScreen),f(new Os().set(0,-.5,1,1,0,0,0,0,1),g),this.movieScreen.layers.set(2),this.scene.add(this.movieScreen)}}this.currentProjection_=o}triggerError_(o){if(this.videojsErrorsSupport_)this.player_.error(o);else{const u=document.createElement("div");u.innerHTML=YM[o.code].message;const f=u.textContent||u.innerText||"";this.player_.error({code:o.code,message:f})}}log(...o){this.options_.debug&&o.forEach(u=>{n.default.log("VR: ",u)})}handleVrDisplayActivate_(){this.vrDisplay&&this.vrDisplay.requestPresent([{source:this.renderedCanvas}]).then(()=>{if(!this.vrDisplay.cardboardUI_||!n.default.browser.IS_IOS)return;let o=[];const u=g=>{for(let y=0;y<g.touches.length;y++)o.push(g.touches[y])},f=g=>{o.length&&(o.forEach(y=>{const T=new window.MouseEvent("click",{screenX:y.screenX,screenY:y.screenY,clientX:y.clientX,clientY:y.clientY});this.renderedCanvas.dispatchEvent(T)}),o=[])};this.renderedCanvas.addEventListener("touchstart",u),this.renderedCanvas.addEventListener("touchend",f),this.iosRevertTouchToClick_=()=>{this.renderedCanvas.removeEventListener("touchstart",u),this.renderedCanvas.removeEventListener("touchend",f),this.iosRevertTouchToClick_=null}})}handleVrDisplayDeactivate_(){!this.vrDisplay||!this.vrDisplay.isPresenting||(this.iosRevertTouchToClick_&&this.iosRevertTouchToClick_(),this.vrDisplay.exitPresent())}requestAnimationFrame(o){return this.vrDisplay?this.vrDisplay.requestAnimationFrame(o):this.player_.requestAnimationFrame(o)}cancelAnimationFrame(o){return this.vrDisplay?this.vrDisplay.cancelAnimationFrame(o):this.player_.cancelAnimationFrame(o)}togglePlay_(){this.player_.paused()?this.player_.play():this.player_.pause()}animate_(){if(this.initialized_){if(this.getVideoEl_().readyState===this.getVideoEl_().HAVE_ENOUGH_DATA&&this.videoTexture&&(this.videoTexture.needsUpdate=!0),this.controls3d.update(),this.omniController&&this.omniController.update(this.camera),this.effect.render(this.scene,this.camera),window.navigator.getGamepads){const o=window.navigator.getGamepads();for(let u=0;u<o.length;++u){const f=o[u];if(!(!f||!f.timestamp||f.timestamp===this.prevTimestamps_[u])){for(let g=0;g<f.buttons.length;++g)if(f.buttons[g].pressed){this.togglePlay_(),this.prevTimestamps_[u]=f.timestamp;break}}}}this.camera.getWorldDirection(this.cameraVector),this.animationFrameId_=this.requestAnimationFrame(this.animate_)}}handleResize_(){const o=this.player_.currentWidth(),u=this.player_.currentHeight();this.effect.setSize(o,u,!1),this.camera.aspect=o/u,this.camera.updateProjectionMatrix()}setProjection(o){if(!gA(o)){n.default.log.error("videojs-vr: please pass a valid projection "+U1.join(", "));return}this.currentProjection_=o,this.defaultProjection_=o}init(){if(this.reset(),this.camera=new fr(75,this.player_.currentWidth()/this.player_.currentHeight(),1,1e3),this.cameraVector=new Be,(this.currentProjection_==="360_LR"||this.currentProjection_==="360_TB"||this.currentProjection_==="180"||this.currentProjection_==="180_LR"||this.currentProjection_==="180_MONO"||this.currentProjection_==="EAC_LR")&&this.camera.layers.enable(1),this.scene=new Eg,this.videoTexture=new hr(this.getVideoEl_()),this.videoTexture.generateMipmaps=!1,this.videoTexture.minFilter=Ui,this.videoTexture.magFilter=Ui,this.videoTexture.format=ta,this.changeProjection_(this.currentProjection_),this.currentProjection_==="NONE"){this.log("Projection is NONE, dont init"),this.reset();return}this.player_.removeChild("BigPlayButton"),this.player_.addChild("BigVrPlayButton",{},this.bigPlayButtonIndex_),this.player_.bigPlayButton=this.player_.getChild("BigVrPlayButton"),(this.options_.forceCardboard||n.default.browser.IS_ANDROID||n.default.browser.IS_IOS)&&this.addCardboardButton_(),n.default.browser.IS_IOS&&this.player_.controlBar&&this.player_.controlBar.fullscreenToggle&&this.player_.controlBar.fullscreenToggle.hide(),this.camera.position.set(0,0,0),this.renderer=new um({devicePixelRatio:window.devicePixelRatio,alpha:!1,clearColor:16777215,antialias:!0});const o=this.renderer.getContext("webgl"),u=o.texImage2D;o.texImage2D=(...g)=>{try{return u.apply(o,g)}catch(y){throw this.reset(),this.player_.pause(),this.triggerError_({code:"web-vr-hls-cors-not-supported",dismiss:!1}),new Error(y)}},this.renderer.setSize(this.player_.currentWidth(),this.player_.currentHeight(),!1),this.effect=new XN(this.renderer),this.effect.setSize(this.player_.currentWidth(),this.player_.currentHeight(),!1),this.vrDisplay=null,this.prevTimestamps_=[],this.renderedCanvas=this.renderer.domElement,this.renderedCanvas.setAttribute("style","width: 100%; height: 100%; position: absolute; top:0;");const f=this.getVideoEl_().style;if(this.player_.el().insertBefore(this.renderedCanvas,this.player_.el().firstChild),f.zIndex="-1",f.opacity="0",window.navigator.getVRDisplays?(this.log("is supported, getting vr displays"),window.navigator.getVRDisplays().then(g=>{if(g.length>0&&(this.log("Displays found",g),this.vrDisplay=g[0],this.vrDisplay.isPolyfilled||(this.log("Real HMD found using VRControls",this.vrDisplay),this.addCardboardButton_(),this.controls3d=new qN(this.camera))),!this.controls3d){this.log("no HMD found Using Orbit & Orientation Controls");const y={camera:this.camera,canvas:this.renderedCanvas,halfView:this.currentProjection_.indexOf("180")===0,orientation:n.default.browser.IS_IOS||n.default.browser.IS_ANDROID||!1};this.options_.motionControls===!1&&(y.orientation=!1),this.controls3d=new KN(y),this.canvasPlayerControls=new JN(this.player_,this.renderedCanvas,this.options_)}this.animationFrameId_=this.requestAnimationFrame(this.animate_)})):window.navigator.getVRDevices?this.triggerError_({code:"web-vr-out-of-date",dismiss:!1}):this.triggerError_({code:"web-vr-not-supported",dismiss:!1}),this.options_.omnitone){const g=RM.getContext();this.omniController=new e5(g,this.options_.omnitone,this.getVideoEl_(),this.options_.omnitoneOptions),this.omniController.one("audiocontext-suspended",()=>{this.player.pause(),this.player.one("playing",()=>{g.resume()})})}this.on(this.player_,"fullscreenchange",this.handleResize_),window.addEventListener("vrdisplaypresentchange",this.handleResize_,!0),window.addEventListener("resize",this.handleResize_,!0),window.addEventListener("vrdisplayactivate",this.handleVrDisplayActivate_,!0),window.addEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_,!0),this.initialized_=!0,this.trigger("initialized")}addCardboardButton_(){this.player_.controlBar.getChild("CardboardButton")||this.player_.controlBar.addChild("CardboardButton",{})}getVideoEl_(){return this.player_.el().getElementsByTagName("video")[0]}reset(){if(!this.initialized_)return;this.omniController&&(this.omniController.off("audiocontext-suspended"),this.omniController.dispose(),this.omniController=void 0),this.controls3d&&(this.controls3d.dispose(),this.controls3d=null),this.canvasPlayerControls&&(this.canvasPlayerControls.dispose(),this.canvasPlayerControls=null),this.effect&&(this.effect.dispose(),this.effect=null),window.removeEventListener("resize",this.handleResize_,!0),window.removeEventListener("vrdisplaypresentchange",this.handleResize_,!0),window.removeEventListener("vrdisplayactivate",this.handleVrDisplayActivate_,!0),window.removeEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_,!0),this.player_.getChild("BigPlayButton")||this.player_.addChild("BigPlayButton",{},this.bigPlayButtonIndex_),this.player_.getChild("BigVrPlayButton")&&this.player_.removeChild("BigVrPlayButton"),this.player_.getChild("CardboardButton")&&this.player_.controlBar.removeChild("CardboardButton"),n.default.browser.IS_IOS&&this.player_.controlBar&&this.player_.controlBar.fullscreenToggle&&this.player_.controlBar.fullscreenToggle.show();const o=this.getVideoEl_().style;o.zIndex="",o.opacity="",this.currentProjection_=this.defaultProjection_,this.iosRevertTouchToClick_&&this.iosRevertTouchToClick_(),this.renderedCanvas&&this.renderedCanvas.parentNode.removeChild(this.renderedCanvas),this.animationFrameId_&&this.cancelAnimationFrame(this.animationFrameId_),this.initialized_=!1}dispose(){super.dispose(),this.reset()}polyfillVersion(){return P.version}}return Ey.prototype.setTimeout=QM.prototype.setTimeout,Ey.prototype.clearTimeout=QM.prototype.clearTimeout,Ey.VERSION=s,n.default.registerPlugin("vr",Ey),Ey})}(ST)),ST.exports}mY();class VB{constructor(){Ot(this,"detectMimeType",e=>{if(e.startsWith("data:")){const s=e.match(/data:([^;]+)/);return s?s[1]:"video/mp4"}const i=new URL(e,window.location.href).pathname.toLowerCase().split(".").pop();return{mp4:"video/mp4",webm:"video/webm",ogg:"video/ogg",mov:"video/quicktime",avi:"video/x-msvideo",mp3:"audio/mpeg",wav:"audio/wav",aac:"audio/aac"}[i]||"video/mp4"});Ot(this,"isVideoSource",e=>{if(e.startsWith("data:"))return e.startsWith("data:video/");const t=[".mp4",".webm",".mov",".avi",".mkv",".m4v"],i=e.toLowerCase();return t.some(n=>i.includes(n))});Ot(this,"isAudioSource",e=>{if(e.startsWith("data:"))return e.startsWith("data:audio/");const t=[".mp3",".wav",".ogg",".m4a",".aac",".flac"],i=e.toLowerCase();return t.some(n=>i.includes(n))});Ot(this,"generateSilentAudio",e=>{const n=Math.floor(e*44100),s=new ArrayBuffer(44+n*2),a=new DataView(s),c=(m,v)=>{for(let b=0;b<v.length;b++)a.setUint8(m+b,v.charCodeAt(b))};c(0,"RIFF"),a.setUint32(4,36+n*2,!0),c(8,"WAVE"),c(12,"fmt "),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,1,!0),a.setUint32(24,44100,!0),a.setUint32(28,44100*2,!0),a.setUint16(32,2,!0),a.setUint16(34,16,!0),c(36,"data"),a.setUint32(40,n*2,!0);for(let m=0;m<n;m++)a.setInt16(44+m*2,0,!0);const h=new Blob([s],{type:"audio/wav"});return URL.createObjectURL(h)});Ot(this,"extractFunscriptDuration",e=>{try{let t=e;if(typeof e=="string"){if(e.startsWith("http")||e.startsWith("/"))return console.warn("Cannot extract duration from funscript URL synchronously"),0;t=JSON.parse(e)}if(!t||typeof t!="object")return 0;if(t.duration&&typeof t.duration=="number")return t.duration;let i=0;if(t.actions&&Array.isArray(t.actions)&&t.actions.length>0){const s=t.actions[t.actions.length-1];s&&typeof s.at=="number"&&(i=Math.max(i,s.at))}for(const[s,a]of Object.entries(t))if(Array.isArray(a)&&a.length>0){const c=a[a.length-1];c&&typeof c.at=="number"?i=Math.max(i,c.at):c&&typeof c.t=="number"?i=Math.max(i,c.t):c&&typeof c.time=="number"&&(i=Math.max(i,c.time))}const n=i>0?i/1e3+1:0;return console.log(`Extracted funscript duration: ${n.toFixed(2)}s (from ${i}ms)`),n}catch(t){return console.error("Error extracting funscript duration:",t),0}});Ot(this,"generatePosterFromVideo",async(e,t=10,i=480)=>new Promise((n,s)=>{const a=document.createElement("video"),c=document.createElement("canvas"),h=c.getContext("2d");a.crossOrigin="anonymous",a.muted=!0,a.style.display="none",document.body.appendChild(a);const m=()=>{a.parentNode&&a.parentNode.removeChild(a)};a.onloadedmetadata=()=>{const v=a.videoWidth/a.videoHeight;a.videoWidth>i?(c.width=i,c.height=i/v):(c.width=a.videoWidth,c.height=a.videoHeight),console.log(`Video: ${a.videoWidth}x${a.videoHeight}  Canvas: ${c.width}x${c.height}`),a.currentTime=Math.min(t,a.duration-1)},a.onseeked=()=>{try{h.drawImage(a,0,0,c.width,c.height);const v=c.toDataURL("image/jpeg",.8);if(v&&v.length>1e3){const b=Math.round(v.length*.75/1024);console.log(`Generated base64 poster at ${a.currentTime}s (${b}KB)`),m(),n(v)}else m(),s(new Error("Failed to generate valid poster"))}catch(v){m(),s(v)}},a.onerror=()=>{m(),s(new Error("Video loading failed"))},a.src=e,a.load()}));Ot(this,"enrichPlaylistWithPosters",async e=>{const t=[],i=new Map;for(const[n,s]of e.entries()){const a={...s};if(s.poster){console.log(` Using existing poster for item ${n+1}`),t.push(a);continue}if(s.media&&this.isVideoSource(s.media))try{if(i.has(s.media))a.poster=i.get(s.media),a._generatedPoster=!0,console.log(` Using cached poster for item ${n+1}`);else{console.log(` Generating poster for item ${n+1}...`);const c=await this.generatePosterFromVideo(s.media,10);a.poster=c,a._generatedPoster=!0,i.set(s.media,c),console.log(` Poster generated and cached for item ${n+1}`)}}catch(c){console.warn(` Failed to generate poster for item ${n+1}:`,c.message)}else console.log(` No poster for item ${n+1} (not a video or no media)`);t.push(a)}return t});Ot(this,"convertToVjsPlaylist",e=>e.map((t,i)=>{const n={};if(t.media)n.sources=[{src:t.media,type:this.detectMimeType(t.media)}];else if(t.duration&&t.duration>0)try{const s=this.generateSilentAudio(t.duration);n.sources=[{src:s,type:"audio/wav"}]}catch{console.error("Failed to generate silent audio for item",i),n.sources=[]}else if(t.funscript)try{const s=this.extractFunscriptDuration(t.funscript);if(s>0){const a=this.generateSilentAudio(s);n.sources=[{src:a,type:"audio/wav"}],console.log(`Generated silent audio for funscript-only item (${s}s)`)}else console.warn("Could not extract duration from funscript"),n.sources=[]}catch(s){console.error("Failed to process funscript for item",i,s),n.sources=[]}else n.sources=[];return t.poster&&(n.poster=t.poster),n.funscript=t.funscript,n.title=t.title,n.duration=t.duration,n.media_type=t.media_type,n.media_info=t.media_info,n._generatedPoster=t._generatedPoster,n}));Ot(this,"processPlaylist",async e=>{console.log("MediaManager: Processing playlist with",e.length,"items");const t=await this.enrichPlaylistWithPosters(e),i=this.convertToVjsPlaylist(t);return console.log("MediaManager: Playlist processing complete"),i});Ot(this,"cleanup",()=>{console.log("MediaManager: Cleanup complete (base64 posters)")});Ot(this,"getStats",()=>({processingMethod:"base64 data URLs"}))}}const gY=Object.freeze(Object.defineProperty({__proto__:null,default:VB},Symbol.toStringTag,{value:"Module"}));class vY extends Mf.Component{constructor(t){super(t);Ot(this,"initPlayer",()=>{var t,i,n;if(!(!((t=this.videoRef)!=null&&t.current)||this.player))try{const s=this.videoRef.current;this.registerPlaylistComponents();const a={controls:!0,responsive:!0,fluid:!0,playsinline:!0,preload:"metadata",techOrder:["html5"],controlBar:{children:["playToggle","currentTimeDisplay","timeDivider","durationDisplay","progressControl","PreviousButton","NextButton","volumePanel","fullscreenToggle"]}};this.player=ft(s,a),this.setupBasicCallbacks(),this.player.ready(()=>{this.isPlayerReady=!0,this.setupAdvancedCallbacks(),this.initVRPlugin(),this.initPlaylistPlugin().then(()=>{console.log("MediaPlayer: Full initialization complete")}).catch(c=>{var h,m;console.error("MediaPlayer: Playlist plugin failed:",c),(m=(h=this.props).onError)==null||m.call(h,c)})})}catch(s){console.error("MediaPlayer: Failed to initialize Video.js:",s),(n=(i=this.props).onError)==null||n.call(i,s)}});Ot(this,"initPlaylistPlugin",async()=>{if(this.player)try{if(typeof this.player.playlist!="function"){const t=await rE(()=>import("./videojs-playlist.es-XehwZxnC.js"),[],import.meta.url);t.default&&ft.registerPlugin("playlist",t.default)}if(typeof this.player.playlist!="function")throw new Error("Playlist plugin failed to load");this.player.on("playlistchange",this.handlePlaylistChange),this.player.on("playlistitem",this.handlePlaylistItem),this.props.playlist&&this.props.playlist.length>0&&this.updatePlaylist(this.props.playlist)}catch(t){console.error("MediaPlayer: Playlist plugin initialization failed:",t)}});Ot(this,"updatePlaylist",async t=>{var i,n,s,a;if(!(!this.player||!this.isPlayerReady||typeof this.player.playlist!="function"))try{if(console.log("MediaPlayer: Updating playlist with",t.length,"items"),this.state.lastPlaylistProcessed===t){console.log("MediaPlayer: Same playlist, skipping processing");return}const c=this.mediaManager.convertToVjsPlaylist(t);if(c.length===0){this.player.playlist([]),this.setState({hasPlaylist:!1,lastPlaylistProcessed:t});return}this.player.playlist(c),this.player.playlist.currentItem()===-1&&this.player.playlist.currentItem(0),this.setState({hasPlaylist:!0,lastPlaylistProcessed:t}),console.log("MediaPlayer: Playlist updated successfully"),(n=(i=this.props).onPlaylistProcessed)==null||n.call(i,c)}catch(c){console.error("MediaPlayer: Error updating playlist:",c),(a=(s=this.props).onError)==null||a.call(s,c)}});Ot(this,"handlePlaylistChange",()=>{console.log("MediaPlayer: Playlist changed")});Ot(this,"handlePlaylistItem",()=>{var i,n;const t=this.player.playlist.currentItem();if(console.log("MediaPlayer: Playlist item changed to index",t),t!==this.state.currentPlaylistIndex){this.setState({currentPlaylistIndex:t}),setTimeout(()=>{const a=this.getCurrentPlaylistItem();a&&a.poster&&(console.log(` Setting poster for item ${t}:`,a.poster.substring(0,50)+"..."),this.player.poster(a.poster))},100);const s=this.getCurrentPlaylistItem();(n=(i=this.props).onPlaylistItemChange)==null||n.call(i,s,t)}});Ot(this,"getCurrentPlaylistItem",()=>{if(!this.state.hasPlaylist||!this.player)return null;const t=this.player.playlist.currentItem(),i=this.player.playlist();return t>=0&&t<i.length?i[t]:null});Ot(this,"goToPlaylistItem",t=>{if(!this.state.hasPlaylist||!this.player)return!1;try{return this.player.playlist.currentItem(t),!0}catch(i){return console.error("MediaPlayer: Failed to go to playlist item",t,i),!1}});Ot(this,"handleNext",()=>{this.state.hasPlaylist&&this.player&&this.player.playlist.next()});Ot(this,"handlePrevious",()=>{this.state.hasPlaylist&&this.player&&this.player.playlist.previous()});Ot(this,"getPlaylistInfo",()=>!this.state.hasPlaylist||!this.player?{hasPlaylist:!1,currentIndex:-1,totalItems:0}:{hasPlaylist:!0,currentIndex:this.player.playlist.currentItem(),totalItems:this.player.playlist().length,canGoPrevious:this.player.playlist.currentItem()>0,canGoNext:this.player.playlist.currentItem()<this.player.playlist().length-1});Ot(this,"registerPlaylistComponents",()=>{const t=ft.getComponent("Button");class i extends t{constructor(a,c){super(a,c),this.controlText("Previous item")}handleClick(){this.player().playlist&&this.player().playlist.previous()}createEl(){const a=super.createEl("button",{className:"vjs-previous-button vjs-control vjs-button"});return a.innerHTML='<span aria-hidden="true"></span>',a.title="Previous item",a}}class n extends t{constructor(a,c){super(a,c),this.controlText("Next item")}handleClick(){this.player().playlist&&this.player().playlist.next()}createEl(){const a=super.createEl("button",{className:"vjs-next-button vjs-control vjs-button"});return a.innerHTML='<span aria-hidden="true"></span>',a.title="Next item",a}}ft.registerComponent("PreviousButton",i),ft.registerComponent("NextButton",n)});Ot(this,"updatePlaylistButtons",()=>{if(!this.player)return;const t=this.player.getChild("controlBar");if(!t)return;const i=t.getChild("PreviousButton"),n=t.getChild("NextButton"),s=this.getPlaylistInfo();i&&(i.el().disabled=!s.canGoPrevious,i.el().style.opacity=s.canGoPrevious?"1":"0.3"),n&&(n.el().disabled=!s.canGoNext,n.el().style.opacity=s.canGoNext?"1":"0.3")});Ot(this,"initVRPlugin",async()=>{if(this.player)try{if(typeof this.player.vr=="function"){this.configureVRPlugin();return}if(!ft.getPlugin("vr")){const t=await rE(()=>import("./videojs-vr.es-n-FPeGKP.js"),[],import.meta.url);if(t.default){const i=function(n={}){return new t.default(this,n)};ft.registerPlugin("vr",i)}}this.configureVRPlugin()}catch(t){console.error("MediaPlayer: VR plugin initialization failed:",t)}});Ot(this,"configureVRPlugin",()=>{try{this.player.mediainfo||(this.player.mediainfo={}),this.player.vr({projection:"AUTO",debug:!0,forceCardboard:!0})}catch(t){console.error("MediaPlayer: VR configuration failed:",t)}});Ot(this,"setupBasicCallbacks",()=>{this.player&&this.player.on("error",t=>{var i,n;console.error("MediaPlayer: Video.js error:",t),(n=(i=this.props).onError)==null||n.call(i,t)})});Ot(this,"setupAdvancedCallbacks",()=>{this.player&&(this.player.on("loadedmetadata",()=>{var i,n;const t=this.player.duration()||0;(n=(i=this.props).onLoadEnd)==null||n.call(i,{duration:t,type:this.hasPlaylist?"playlist":"media"}),this.updatePlaylistButtons()}),this.player.on("play",()=>{var i,n;const t=this.player.currentTime()||0;(n=(i=this.props).onPlay)==null||n.call(i,{currentTime:t}),this.updatePlaylistButtons()}),this.player.on("pause",()=>{var i,n;const t=this.player.currentTime()||0;(n=(i=this.props).onPause)==null||n.call(i,{currentTime:t})}),this.player.on("ended",()=>{var t,i;(i=(t=this.props).onEnd)==null||i.call(t,{currentTime:0})}),this.player.on("seeked",()=>{var i,n;const t=this.player.currentTime()||0;(n=(i=this.props).onSeek)==null||n.call(i,{currentTime:t})}),this.player.on("timeupdate",()=>{var i,n;const t=this.player.currentTime()||0;(n=(i=this.props).onTimeUpdate)==null||n.call(i,{currentTime:t})}))});Ot(this,"cleanup",()=>{if(this.mediaManager&&this.mediaManager.cleanup(),this.player)try{typeof this.player.dispose=="function"&&this.player.dispose()}catch(t){console.error("MediaPlayer: Error during cleanup:",t)}finally{this.player=null,this.isPlayerReady=!1,this.initRetries=0,this.setState({currentPlaylistIndex:-1,hasPlaylist:!1,lastPlaylistProcessed:null})}});Ot(this,"play",()=>{var t;return(t=this.player)==null?void 0:t.play()});Ot(this,"pause",()=>{var t;return(t=this.player)==null?void 0:t.pause()});Ot(this,"stop",()=>{var t,i;(t=this.player)==null||t.pause(),(i=this.player)==null||i.currentTime(0)});Ot(this,"seek",t=>{var i;return(i=this.player)==null?void 0:i.currentTime(t)});Ot(this,"getTime",()=>{var t;return((t=this.player)==null?void 0:t.currentTime())||0});Ot(this,"getDuration",()=>{var t;return((t=this.player)==null?void 0:t.duration())||0});Ot(this,"isPlaying",()=>this.player?!this.player.paused():!1);Ot(this,"nextItem",()=>this.handleNext());Ot(this,"previousItem",()=>this.handlePrevious());Ot(this,"goToItem",t=>this.goToPlaylistItem(t));Ot(this,"getCurrentItem",()=>this.getCurrentPlaylistItem());Ot(this,"getPlaylist",()=>this.state.hasPlaylist?this.player.playlist():[]);Ot(this,"getState",()=>({currentTime:this.getTime(),duration:this.getDuration(),isPlaying:this.isPlaying(),mediaType:this.state.hasPlaylist?"playlist":"media",playlistInfo:this.getPlaylistInfo()}));this.videoRef=s_.createRef(),this.player=null,this.isPlayerReady=!1,this.initRetries=0,this.maxRetries=3,this.mediaManager=new VB,this.state={currentPlaylistIndex:-1,hasPlaylist:!1,lastPlaylistProcessed:null}}componentDidMount(){const{playlist:t}=this.props;t&&t.length>0&&setTimeout(()=>{this.initPlayer()},50)}componentDidUpdate(t){const{playlist:i}=this.props,n=i&&i.length>0;if(!(t.playlist&&t.playlist.length>0)&&n&&!this.player){setTimeout(()=>{this.initPlayer()},50);return}this.isPlayerReady&&n&&t.playlist!==i&&this.updatePlaylist(i)}componentWillUnmount(){this.cleanup()}render(){const{className:t="",playlist:i}=this.props,n=i&&i.length>0;return Lt.jsx("div",{className:`media-player ${t}`,children:n?Lt.jsx("div",{"data-vjs-player":!0,children:Lt.jsx("video",{ref:this.videoRef,className:"video-js vjs-default-skin vjs-theme-funplayer",playsInline:!0,"data-setup":"{}"})}):Lt.jsx("div",{className:"media-placeholder",style:{width:"100%",height:"300px",backgroundColor:"#000",display:"flex",alignItems:"center",justifyContent:"center",color:"#666",fontSize:"1rem",borderRadius:"calc(var(--base-radius) * 0.5)"},children:" No media loaded"})})}}var xm={},Nu={},lf={},zw={exports:{}},EP;function MS(){return EP||(EP=1,function(r){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function n(h,m,v){this.fn=h,this.context=m,this.once=v||!1}function s(h,m,v,b,x){if(typeof v!="function")throw new TypeError("The listener must be a function");var C=new n(v,b||h,x),B=t?t+m:m;return h._events[B]?h._events[B].fn?h._events[B]=[h._events[B],C]:h._events[B].push(C):(h._events[B]=C,h._eventsCount++),h}function a(h,m){--h._eventsCount===0?h._events=new i:delete h._events[m]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var m=[],v,b;if(this._eventsCount===0)return m;for(b in v=this._events)e.call(v,b)&&m.push(t?b.slice(1):b);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(v)):m},c.prototype.listeners=function(m){var v=t?t+m:m,b=this._events[v];if(!b)return[];if(b.fn)return[b.fn];for(var x=0,C=b.length,B=new Array(C);x<C;x++)B[x]=b[x].fn;return B},c.prototype.listenerCount=function(m){var v=t?t+m:m,b=this._events[v];return b?b.fn?1:b.length:0},c.prototype.emit=function(m,v,b,x,C,B){var P=t?t+m:m;if(!this._events[P])return!1;var N=this._events[P],ae=arguments.length,X,de;if(N.fn){switch(N.once&&this.removeListener(m,N.fn,void 0,!0),ae){case 1:return N.fn.call(N.context),!0;case 2:return N.fn.call(N.context,v),!0;case 3:return N.fn.call(N.context,v,b),!0;case 4:return N.fn.call(N.context,v,b,x),!0;case 5:return N.fn.call(N.context,v,b,x,C),!0;case 6:return N.fn.call(N.context,v,b,x,C,B),!0}for(de=1,X=new Array(ae-1);de<ae;de++)X[de-1]=arguments[de];N.fn.apply(N.context,X)}else{var ge=N.length,ue;for(de=0;de<ge;de++)switch(N[de].once&&this.removeListener(m,N[de].fn,void 0,!0),ae){case 1:N[de].fn.call(N[de].context);break;case 2:N[de].fn.call(N[de].context,v);break;case 3:N[de].fn.call(N[de].context,v,b);break;case 4:N[de].fn.call(N[de].context,v,b,x);break;default:if(!X)for(ue=1,X=new Array(ae-1);ue<ae;ue++)X[ue-1]=arguments[ue];N[de].fn.apply(N[de].context,X)}}return!0},c.prototype.on=function(m,v,b){return s(this,m,v,b,!1)},c.prototype.once=function(m,v,b){return s(this,m,v,b,!0)},c.prototype.removeListener=function(m,v,b,x){var C=t?t+m:m;if(!this._events[C])return this;if(!v)return a(this,C),this;var B=this._events[C];if(B.fn)B.fn===v&&(!x||B.once)&&(!b||B.context===b)&&a(this,C);else{for(var P=0,N=[],ae=B.length;P<ae;P++)(B[P].fn!==v||x&&!B[P].once||b&&B[P].context!==b)&&N.push(B[P]);N.length?this._events[C]=N.length===1?N[0]:N:a(this,C)}return this},c.prototype.removeAllListeners=function(m){var v;return m?(v=t?t+m:m,this._events[v]&&a(this,v)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,r.exports=c}(zw)),zw.exports}var CP;function zB(){if(CP)return lf;CP=1;/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */Object.defineProperty(lf,"__esModule",{value:!0}),lf.ButtplugLogger=lf.LogMessage=lf.ButtplugLogLevel=void 0;const r=MS();var e;(function(n){n[n.Off=0]="Off",n[n.Error=1]="Error",n[n.Warn=2]="Warn",n[n.Info=3]="Info",n[n.Debug=4]="Debug",n[n.Trace=5]="Trace"})(e||(lf.ButtplugLogLevel=e={}));class t{constructor(s,a){const c=new Date,h=c.getHours(),m=c.getMinutes(),v=c.getSeconds();this.timestamp=`${h}:${m}:${v}`,this.logMessage=s,this.logLevel=a}get Message(){return this.logMessage}get LogLevel(){return this.logLevel}get Timestamp(){return this.timestamp}get FormattedMessage(){return`${e[this.logLevel]} : ${this.timestamp} : ${this.logMessage}`}}lf.LogMessage=t;class i extends r.EventEmitter{static get Logger(){return i.sLogger===void 0&&(i.sLogger=new i),this.sLogger}constructor(){super(),this.maximumConsoleLogLevel=e.Off,this.maximumEventLogLevel=e.Off}get MaximumConsoleLogLevel(){return this.maximumConsoleLogLevel}set MaximumConsoleLogLevel(s){this.maximumConsoleLogLevel=s}get MaximumEventLogLevel(){return this.maximumEventLogLevel}set MaximumEventLogLevel(s){this.maximumEventLogLevel=s}Error(s){this.AddLogMessage(s,e.Error)}Warn(s){this.AddLogMessage(s,e.Warn)}Info(s){this.AddLogMessage(s,e.Info)}Debug(s){this.AddLogMessage(s,e.Debug)}Trace(s){this.AddLogMessage(s,e.Trace)}AddLogMessage(s,a){if(a>this.maximumEventLogLevel&&a>this.maximumConsoleLogLevel)return;const c=new t(s,a);a<=this.maximumConsoleLogLevel&&console.log(c.FormattedMessage),a<=this.maximumEventLogLevel&&this.emit("log",c)}}return lf.ButtplugLogger=i,i.sLogger=void 0,lf}var Uu={},Sm={},Kn;(function(r){r[r.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",r[r.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",r[r.CLASS_TO_CLASS=2]="CLASS_TO_CLASS"})(Kn||(Kn={}));var yY=function(){function r(){this._typeMetadatas=new Map,this._transformMetadatas=new Map,this._exposeMetadatas=new Map,this._excludeMetadatas=new Map,this._ancestorsMap=new Map}return r.prototype.addTypeMetadata=function(e){this._typeMetadatas.has(e.target)||this._typeMetadatas.set(e.target,new Map),this._typeMetadatas.get(e.target).set(e.propertyName,e)},r.prototype.addTransformMetadata=function(e){this._transformMetadatas.has(e.target)||this._transformMetadatas.set(e.target,new Map),this._transformMetadatas.get(e.target).has(e.propertyName)||this._transformMetadatas.get(e.target).set(e.propertyName,[]),this._transformMetadatas.get(e.target).get(e.propertyName).push(e)},r.prototype.addExposeMetadata=function(e){this._exposeMetadatas.has(e.target)||this._exposeMetadatas.set(e.target,new Map),this._exposeMetadatas.get(e.target).set(e.propertyName,e)},r.prototype.addExcludeMetadata=function(e){this._excludeMetadatas.has(e.target)||this._excludeMetadatas.set(e.target,new Map),this._excludeMetadatas.get(e.target).set(e.propertyName,e)},r.prototype.findTransformMetadatas=function(e,t,i){return this.findMetadatas(this._transformMetadatas,e,t).filter(function(n){return!n.options||n.options.toClassOnly===!0&&n.options.toPlainOnly===!0?!0:n.options.toClassOnly===!0?i===Kn.CLASS_TO_CLASS||i===Kn.PLAIN_TO_CLASS:n.options.toPlainOnly===!0?i===Kn.CLASS_TO_PLAIN:!0})},r.prototype.findExcludeMetadata=function(e,t){return this.findMetadata(this._excludeMetadatas,e,t)},r.prototype.findExposeMetadata=function(e,t){return this.findMetadata(this._exposeMetadatas,e,t)},r.prototype.findExposeMetadataByCustomName=function(e,t){return this.getExposedMetadatas(e).find(function(i){return i.options&&i.options.name===t})},r.prototype.findTypeMetadata=function(e,t){return this.findMetadata(this._typeMetadatas,e,t)},r.prototype.getStrategy=function(e){var t=this._excludeMetadatas.get(e),i=t&&t.get(void 0),n=this._exposeMetadatas.get(e),s=n&&n.get(void 0);return i&&s||!i&&!s?"none":i?"excludeAll":"exposeAll"},r.prototype.getExposedMetadatas=function(e){return this.getMetadata(this._exposeMetadatas,e)},r.prototype.getExcludedMetadatas=function(e){return this.getMetadata(this._excludeMetadatas,e)},r.prototype.getExposedProperties=function(e,t){return this.getExposedMetadatas(e).filter(function(i){return!i.options||i.options.toClassOnly===!0&&i.options.toPlainOnly===!0?!0:i.options.toClassOnly===!0?t===Kn.CLASS_TO_CLASS||t===Kn.PLAIN_TO_CLASS:i.options.toPlainOnly===!0?t===Kn.CLASS_TO_PLAIN:!0}).map(function(i){return i.propertyName})},r.prototype.getExcludedProperties=function(e,t){return this.getExcludedMetadatas(e).filter(function(i){return!i.options||i.options.toClassOnly===!0&&i.options.toPlainOnly===!0?!0:i.options.toClassOnly===!0?t===Kn.CLASS_TO_CLASS||t===Kn.PLAIN_TO_CLASS:i.options.toPlainOnly===!0?t===Kn.CLASS_TO_PLAIN:!0}).map(function(i){return i.propertyName})},r.prototype.clear=function(){this._typeMetadatas.clear(),this._exposeMetadatas.clear(),this._excludeMetadatas.clear(),this._ancestorsMap.clear()},r.prototype.getMetadata=function(e,t){var i=e.get(t),n;i&&(n=Array.from(i.values()).filter(function(b){return b.propertyName!==void 0}));for(var s=[],a=0,c=this.getAncestors(t);a<c.length;a++){var h=c[a],m=e.get(h);if(m){var v=Array.from(m.values()).filter(function(b){return b.propertyName!==void 0});s.push.apply(s,v)}}return s.concat(n||[])},r.prototype.findMetadata=function(e,t,i){var n=e.get(t);if(n){var s=n.get(i);if(s)return s}for(var a=0,c=this.getAncestors(t);a<c.length;a++){var h=c[a],m=e.get(h);if(m){var v=m.get(i);if(v)return v}}},r.prototype.findMetadatas=function(e,t,i){var n=e.get(t),s;n&&(s=n.get(i));for(var a=[],c=0,h=this.getAncestors(t);c<h.length;c++){var m=h[c],v=e.get(m);v&&v.has(i)&&a.push.apply(a,v.get(i))}return a.slice().reverse().concat((s||[]).slice().reverse())},r.prototype.getAncestors=function(e){if(!e)return[];if(!this._ancestorsMap.has(e)){for(var t=[],i=Object.getPrototypeOf(e.prototype.constructor);typeof i.prototype<"u";i=Object.getPrototypeOf(i.prototype.constructor))t.push(i);this._ancestorsMap.set(e,t)}return this._ancestorsMap.get(e)},r}(),Ya=new yY;function _Y(){if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global;if(typeof window<"u")return window;if(typeof self<"u")return self}function bY(r){return r!==null&&typeof r=="object"&&typeof r.then=="function"}var MP=function(r,e,t){if(t||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return r.concat(s||Array.prototype.slice.call(e))};function TY(r){var e=new r;return!(e instanceof Set)&&!("push"in e)?[]:e}var Xg=function(){function r(e,t){this.transformationType=e,this.options=t,this.recursionStack=new Set}return r.prototype.transform=function(e,t,i,n,s,a){var c=this;if(a===void 0&&(a=0),Array.isArray(t)||t instanceof Set){var h=n&&this.transformationType===Kn.PLAIN_TO_CLASS?TY(n):[];return t.forEach(function(N,ae){var X=e?e[ae]:void 0;if(!c.options.enableCircularCheck||!c.isCircular(N)){var de=void 0;if(typeof i!="function"&&i&&i.options&&i.options.discriminator&&i.options.discriminator.property&&i.options.discriminator.subTypes){if(c.transformationType===Kn.PLAIN_TO_CLASS){de=i.options.discriminator.subTypes.find(function(fe){return fe.name===N[i.options.discriminator.property]});var ge={newObject:h,object:N,property:void 0},ue=i.typeFunction(ge);de===void 0?de=ue:de=de.value,i.options.keepDiscriminatorProperty||delete N[i.options.discriminator.property]}c.transformationType===Kn.CLASS_TO_CLASS&&(de=N.constructor),c.transformationType===Kn.CLASS_TO_PLAIN&&(N[i.options.discriminator.property]=i.options.discriminator.subTypes.find(function(fe){return fe.value===N.constructor}).name)}else de=i;var be=c.transform(X,N,de,void 0,N instanceof Map,a+1);h instanceof Set?h.add(be):h.push(be)}else c.transformationType===Kn.CLASS_TO_CLASS&&(h instanceof Set?h.add(N):h.push(N))}),h}else{if(i===String&&!s)return t==null?t:String(t);if(i===Number&&!s)return t==null?t:Number(t);if(i===Boolean&&!s)return t==null?t:!!t;if((i===Date||t instanceof Date)&&!s)return t instanceof Date?new Date(t.valueOf()):t==null?t:new Date(t);if(_Y().Buffer&&(i===Buffer||t instanceof Buffer)&&!s)return t==null?t:Buffer.from(t);if(bY(t)&&!s)return new Promise(function(N,ae){t.then(function(X){return N(c.transform(void 0,X,i,void 0,void 0,a+1))},ae)});if(!s&&t!==null&&typeof t=="object"&&typeof t.then=="function")return t;if(typeof t=="object"&&t!==null){!i&&t.constructor!==Object&&(!Array.isArray(t)&&t.constructor===Array||(i=t.constructor)),!i&&e&&(i=e.constructor),this.options.enableCircularCheck&&this.recursionStack.add(t);var m=this.getKeys(i,t,s),v=e||{};!e&&(this.transformationType===Kn.PLAIN_TO_CLASS||this.transformationType===Kn.CLASS_TO_CLASS)&&(s?v=new Map:i?v=new i:v={});for(var b=function(N){if(N==="__proto__"||N==="constructor")return"continue";var ae=N,X=N,de=N;if(!x.options.ignoreDecorators&&i){if(x.transformationType===Kn.PLAIN_TO_CLASS){var ge=Ya.findExposeMetadataByCustomName(i,N);ge&&(de=ge.propertyName,X=ge.propertyName)}else if(x.transformationType===Kn.CLASS_TO_PLAIN||x.transformationType===Kn.CLASS_TO_CLASS){var ge=Ya.findExposeMetadata(i,N);ge&&ge.options&&ge.options.name&&(X=ge.options.name)}}var ue=void 0;x.transformationType===Kn.PLAIN_TO_CLASS?ue=t[ae]:t instanceof Map?ue=t.get(ae):t[ae]instanceof Function?ue=t[ae]():ue=t[ae];var be=void 0,fe=ue instanceof Map;if(i&&s)be=i;else if(i){var ve=Ya.findTypeMetadata(i,de);if(ve){var ie={newObject:v,object:t,property:de},re=ve.typeFunction?ve.typeFunction(ie):ve.reflectedType;ve.options&&ve.options.discriminator&&ve.options.discriminator.property&&ve.options.discriminator.subTypes?t[ae]instanceof Array?be=ve:(x.transformationType===Kn.PLAIN_TO_CLASS&&(be=ve.options.discriminator.subTypes.find(function(tt){if(ue&&ue instanceof Object&&ve.options.discriminator.property in ue)return tt.name===ue[ve.options.discriminator.property]}),be===void 0?be=re:be=be.value,ve.options.keepDiscriminatorProperty||ue&&ue instanceof Object&&ve.options.discriminator.property in ue&&delete ue[ve.options.discriminator.property]),x.transformationType===Kn.CLASS_TO_CLASS&&(be=ue.constructor),x.transformationType===Kn.CLASS_TO_PLAIN&&ue&&(ue[ve.options.discriminator.property]=ve.options.discriminator.subTypes.find(function(tt){return tt.value===ue.constructor}).name)):be=re,fe=fe||ve.reflectedType===Map}else if(x.options.targetMaps)x.options.targetMaps.filter(function(tt){return tt.target===i&&!!tt.properties[de]}).forEach(function(tt){return be=tt.properties[de]});else if(x.options.enableImplicitConversion&&x.transformationType===Kn.PLAIN_TO_CLASS){var Ne=Reflect.getMetadata("design:type",i.prototype,de);Ne&&(be=Ne)}}var De=Array.isArray(t[ae])?x.getReflectedType(i,de):void 0,ke=e?e[ae]:void 0;if(v.constructor.prototype){var ut=Object.getOwnPropertyDescriptor(v.constructor.prototype,X);if((x.transformationType===Kn.PLAIN_TO_CLASS||x.transformationType===Kn.CLASS_TO_CLASS)&&(ut&&!ut.set||v[X]instanceof Function))return"continue"}if(!x.options.enableCircularCheck||!x.isCircular(ue)){var _t=x.transformationType===Kn.PLAIN_TO_CLASS?X:N,vt=void 0;x.transformationType===Kn.CLASS_TO_PLAIN?(vt=t[_t],vt=x.applyCustomTransformations(vt,i,_t,t,x.transformationType),vt=t[_t]===vt?ue:vt,vt=x.transform(ke,vt,be,De,fe,a+1)):ue===void 0&&x.options.exposeDefaultValues?vt=v[X]:(vt=x.transform(ke,ue,be,De,fe,a+1),vt=x.applyCustomTransformations(vt,i,_t,t,x.transformationType)),(vt!==void 0||x.options.exposeUnsetFields)&&(v instanceof Map?v.set(X,vt):v[X]=vt)}else if(x.transformationType===Kn.CLASS_TO_CLASS){var vt=ue;vt=x.applyCustomTransformations(vt,i,N,t,x.transformationType),(vt!==void 0||x.options.exposeUnsetFields)&&(v instanceof Map?v.set(X,vt):v[X]=vt)}},x=this,C=0,B=m;C<B.length;C++){var P=B[C];b(P)}return this.options.enableCircularCheck&&this.recursionStack.delete(t),v}else return t}},r.prototype.applyCustomTransformations=function(e,t,i,n,s){var a=this,c=Ya.findTransformMetadatas(t,i,this.transformationType);return this.options.version!==void 0&&(c=c.filter(function(h){return h.options?a.checkVersion(h.options.since,h.options.until):!0})),this.options.groups&&this.options.groups.length?c=c.filter(function(h){return h.options?a.checkGroups(h.options.groups):!0}):c=c.filter(function(h){return!h.options||!h.options.groups||!h.options.groups.length}),c.forEach(function(h){e=h.transformFn({value:e,key:i,obj:n,type:s,options:a.options})}),e},r.prototype.isCircular=function(e){return this.recursionStack.has(e)},r.prototype.getReflectedType=function(e,t){if(e){var i=Ya.findTypeMetadata(e,t);return i?i.reflectedType:void 0}},r.prototype.getKeys=function(e,t,i){var n=this,s=Ya.getStrategy(e);s==="none"&&(s=this.options.strategy||"exposeAll");var a=[];if((s==="exposeAll"||i)&&(t instanceof Map?a=Array.from(t.keys()):a=Object.keys(t)),i)return a;if(this.options.ignoreDecorators&&this.options.excludeExtraneousValues&&e){var c=Ya.getExposedProperties(e,this.transformationType),h=Ya.getExcludedProperties(e,this.transformationType);a=MP(MP([],c,!0),h,!0)}if(!this.options.ignoreDecorators&&e){var c=Ya.getExposedProperties(e,this.transformationType);this.transformationType===Kn.PLAIN_TO_CLASS&&(c=c.map(function(b){var x=Ya.findExposeMetadata(e,b);return x&&x.options&&x.options.name?x.options.name:b})),this.options.excludeExtraneousValues?a=c:a=a.concat(c);var m=Ya.getExcludedProperties(e,this.transformationType);m.length>0&&(a=a.filter(function(b){return!m.includes(b)})),this.options.version!==void 0&&(a=a.filter(function(b){var x=Ya.findExposeMetadata(e,b);return!x||!x.options?!0:n.checkVersion(x.options.since,x.options.until)})),this.options.groups&&this.options.groups.length?a=a.filter(function(b){var x=Ya.findExposeMetadata(e,b);return!x||!x.options?!0:n.checkGroups(x.options.groups)}):a=a.filter(function(b){var x=Ya.findExposeMetadata(e,b);return!x||!x.options||!x.options.groups||!x.options.groups.length})}return this.options.excludePrefixes&&this.options.excludePrefixes.length&&(a=a.filter(function(v){return n.options.excludePrefixes.every(function(b){return v.substr(0,b.length)!==b})})),a=a.filter(function(v,b,x){return x.indexOf(v)===b}),a},r.prototype.checkVersion=function(e,t){var i=!0;return i&&e&&(i=this.options.version>=e),i&&t&&(i=this.options.version<t),i},r.prototype.checkGroups=function(e){return e?this.options.groups.some(function(t){return e.includes(t)}):!0},r}(),Yg={enableCircularCheck:!1,enableImplicitConversion:!1,excludeExtraneousValues:!1,excludePrefixes:void 0,exposeDefaultValues:!1,exposeUnsetFields:!0,groups:void 0,ignoreDecorators:!1,strategy:void 0,targetMaps:void 0,version:void 0},$l=function(){return $l=Object.assign||function(r){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n])}return r},$l.apply(this,arguments)},nb=function(){function r(){}return r.prototype.instanceToPlain=function(e,t){var i=new Xg(Kn.CLASS_TO_PLAIN,$l($l({},Yg),t));return i.transform(void 0,e,void 0,void 0,void 0,void 0)},r.prototype.classToPlainFromExist=function(e,t,i){var n=new Xg(Kn.CLASS_TO_PLAIN,$l($l({},Yg),i));return n.transform(t,e,void 0,void 0,void 0,void 0)},r.prototype.plainToInstance=function(e,t,i){var n=new Xg(Kn.PLAIN_TO_CLASS,$l($l({},Yg),i));return n.transform(void 0,t,e,void 0,void 0,void 0)},r.prototype.plainToClassFromExist=function(e,t,i){var n=new Xg(Kn.PLAIN_TO_CLASS,$l($l({},Yg),i));return n.transform(e,t,void 0,void 0,void 0,void 0)},r.prototype.instanceToInstance=function(e,t){var i=new Xg(Kn.CLASS_TO_CLASS,$l($l({},Yg),t));return i.transform(void 0,e,void 0,void 0,void 0,void 0)},r.prototype.classToClassFromExist=function(e,t,i){var n=new Xg(Kn.CLASS_TO_CLASS,$l($l({},Yg),i));return n.transform(t,e,void 0,void 0,void 0,void 0)},r.prototype.serialize=function(e,t){return JSON.stringify(this.instanceToPlain(e,t))},r.prototype.deserialize=function(e,t,i){var n=JSON.parse(t);return this.plainToInstance(e,n,i)},r.prototype.deserializeArray=function(e,t,i){var n=JSON.parse(t);return this.plainToInstance(e,n,i)},r}();function xY(r){return r===void 0&&(r={}),function(e,t){Ya.addExcludeMetadata({target:e instanceof Function?e:e.constructor,propertyName:t,options:r})}}function SY(r){return r===void 0&&(r={}),function(e,t){Ya.addExposeMetadata({target:e instanceof Function?e:e.constructor,propertyName:t,options:r})}}function AY(r){return function(e,t,i){var n=new nb,s=i.value;i.value=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];var h=s.apply(this,a),m=!!h&&(typeof h=="object"||typeof h=="function")&&typeof h.then=="function";return m?h.then(function(v){return n.instanceToInstance(v,r)}):n.instanceToInstance(h,r)}}}function wY(r){return function(e,t,i){var n=new nb,s=i.value;i.value=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];var h=s.apply(this,a),m=!!h&&(typeof h=="object"||typeof h=="function")&&typeof h.then=="function";return m?h.then(function(v){return n.instanceToPlain(v,r)}):n.instanceToPlain(h,r)}}}function EY(r,e){return function(t,i,n){var s=new nb,a=n.value;n.value=function(){for(var c=[],h=0;h<arguments.length;h++)c[h]=arguments[h];var m=a.apply(this,c),v=!!m&&(typeof m=="object"||typeof m=="function")&&typeof m.then=="function";return v?m.then(function(b){return s.plainToInstance(r,b,e)}):s.plainToInstance(r,m,e)}}}function CY(r,e){return e===void 0&&(e={}),function(t,i){Ya.addTransformMetadata({target:t.constructor,propertyName:i,transformFn:r,options:e})}}function MY(r,e){return e===void 0&&(e={}),function(t,i){var n=Reflect.getMetadata("design:type",t,i);Ya.addTypeMetadata({target:t.constructor,propertyName:i,reflectedType:n,typeFunction:r,options:e})}}var id=new nb;function DY(r,e){return id.instanceToPlain(r,e)}function IY(r,e){return id.instanceToPlain(r,e)}function PY(r,e,t){return id.classToPlainFromExist(r,e,t)}function LY(r,e,t){return id.plainToInstance(r,e,t)}function RY(r,e,t){return id.plainToInstance(r,e,t)}function kY(r,e,t){return id.plainToClassFromExist(r,e,t)}function OY(r,e){return id.instanceToInstance(r,e)}function FY(r,e,t){return id.classToClassFromExist(r,e,t)}function BY(r,e){return id.serialize(r,e)}function NY(r,e,t){return id.deserialize(r,e,t)}function UY(r,e,t){return id.deserializeArray(r,e,t)}const VY=Object.freeze(Object.defineProperty({__proto__:null,ClassTransformer:nb,Exclude:xY,Expose:SY,Transform:CY,TransformInstanceToInstance:AY,TransformInstanceToPlain:wY,TransformPlainToInstance:EY,get TransformationType(){return Kn},Type:MY,classToClassFromExist:FY,classToPlain:DY,classToPlainFromExist:PY,deserialize:NY,deserializeArray:UY,instanceToInstance:OY,instanceToPlain:IY,plainToClass:LY,plainToClassFromExist:kY,plainToInstance:RY,serialize:BY},Symbol.toStringTag,{value:"Module"})),HB=s2(VY);var DP={};/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var IP;function zY(){if(IP)return DP;IP=1;var r;return function(e){(function(t){var i=typeof globalThis=="object"?globalThis:typeof Ap=="object"?Ap:typeof self=="object"?self:typeof this=="object"?this:h(),n=s(e);typeof i.Reflect<"u"&&(n=s(i.Reflect,n)),t(n,i),typeof i.Reflect>"u"&&(i.Reflect=e);function s(m,v){return function(b,x){Object.defineProperty(m,b,{configurable:!0,writable:!0,value:x}),v&&v(b,x)}}function a(){try{return Function("return this;")()}catch{}}function c(){try{return(0,eval)("(function() { return this; })()")}catch{}}function h(){return a()||c()}})(function(t,i){var n=Object.prototype.hasOwnProperty,s=typeof Symbol=="function",a=s&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",c=s&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",h=typeof Object.create=="function",m={__proto__:[]}instanceof Array,v=!h&&!m,b={create:h?function(){return an(Object.create(null))}:m?function(){return an({__proto__:null})}:function(){return an({})},has:v?function(Ze,St){return n.call(Ze,St)}:function(Ze,St){return St in Ze},get:v?function(Ze,St){return n.call(Ze,St)?Ze[St]:void 0}:function(Ze,St){return Ze[St]}},x=Object.getPrototypeOf(Function),C=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:js(),B=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Vo(),P=typeof WeakMap=="function"?WeakMap:Aa(),N=s?Symbol.for("@reflect-metadata:registry"):void 0,ae=Oa(),X=Js(ae);function de(Ze,St,Ft,di){if(xt(Ft)){if(!xi(Ze))throw new TypeError;if(!Ki(St))throw new TypeError;return ke(Ze,St)}else{if(!xi(Ze))throw new TypeError;if(!lt(St))throw new TypeError;if(!lt(di)&&!xt(di)&&!ii(di))throw new TypeError;return ii(di)&&(di=void 0),Ft=vi(Ft),ut(Ze,St,Ft,di)}}t("decorate",de);function ge(Ze,St){function Ft(di,Oi){if(!lt(di))throw new TypeError;if(!xt(Oi)&&!io(Oi))throw new TypeError;it(Ze,St,di,Oi)}return Ft}t("metadata",ge);function ue(Ze,St,Ft,di){if(!lt(Ft))throw new TypeError;return xt(di)||(di=vi(di)),it(Ze,St,Ft,di)}t("defineMetadata",ue);function be(Ze,St,Ft){if(!lt(St))throw new TypeError;return xt(Ft)||(Ft=vi(Ft)),_t(Ze,St,Ft)}t("hasMetadata",be);function fe(Ze,St,Ft){if(!lt(St))throw new TypeError;return xt(Ft)||(Ft=vi(Ft)),vt(Ze,St,Ft)}t("hasOwnMetadata",fe);function ve(Ze,St,Ft){if(!lt(St))throw new TypeError;return xt(Ft)||(Ft=vi(Ft)),tt(Ze,St,Ft)}t("getMetadata",ve);function ie(Ze,St,Ft){if(!lt(St))throw new TypeError;return xt(Ft)||(Ft=vi(Ft)),je(Ze,St,Ft)}t("getOwnMetadata",ie);function re(Ze,St){if(!lt(Ze))throw new TypeError;return xt(St)||(St=vi(St)),Xe(Ze,St)}t("getMetadataKeys",re);function Ne(Ze,St){if(!lt(Ze))throw new TypeError;return xt(St)||(St=vi(St)),Se(Ze,St)}t("getOwnMetadataKeys",Ne);function De(Ze,St,Ft){if(!lt(St))throw new TypeError;if(xt(Ft)||(Ft=vi(Ft)),!lt(St))throw new TypeError;xt(Ft)||(Ft=vi(Ft));var di=ds(St,Ft,!1);return xt(di)?!1:di.OrdinaryDeleteMetadata(Ze,St,Ft)}t("deleteMetadata",De);function ke(Ze,St){for(var Ft=Ze.length-1;Ft>=0;--Ft){var di=Ze[Ft],Oi=di(St);if(!xt(Oi)&&!ii(Oi)){if(!Ki(Oi))throw new TypeError;St=Oi}}return St}function ut(Ze,St,Ft,di){for(var Oi=Ze.length-1;Oi>=0;--Oi){var Fn=Ze[Oi],Ar=Fn(St,Ft,di);if(!xt(Ar)&&!ii(Ar)){if(!lt(Ar))throw new TypeError;di=Ar}}return di}function _t(Ze,St,Ft){var di=vt(Ze,St,Ft);if(di)return!0;var Oi=Sr(St);return ii(Oi)?!1:_t(Ze,Oi,Ft)}function vt(Ze,St,Ft){var di=ds(St,Ft,!1);return xt(di)?!1:Dt(di.OrdinaryHasOwnMetadata(Ze,St,Ft))}function tt(Ze,St,Ft){var di=vt(Ze,St,Ft);if(di)return je(Ze,St,Ft);var Oi=Sr(St);if(!ii(Oi))return tt(Ze,Oi,Ft)}function je(Ze,St,Ft){var di=ds(St,Ft,!1);if(!xt(di))return di.OrdinaryGetOwnMetadata(Ze,St,Ft)}function it(Ze,St,Ft,di){var Oi=ds(Ft,di,!0);Oi.OrdinaryDefineOwnMetadata(Ze,St,Ft,di)}function Xe(Ze,St){var Ft=Se(Ze,St),di=Sr(Ze);if(di===null)return Ft;var Oi=Xe(di,St);if(Oi.length<=0)return Ft;if(Ft.length<=0)return Oi;for(var Fn=new B,Ar=[],Zi=0,pi=Ft;Zi<pi.length;Zi++){var ne=pi[Zi],oe=Fn.has(ne);oe||(Fn.add(ne),Ar.push(ne))}for(var xe=0,Ye=Oi;xe<Ye.length;xe++){var ne=Ye[xe],oe=Fn.has(ne);oe||(Fn.add(ne),Ar.push(ne))}return Ar}function Se(Ze,St){var Ft=ds(Ze,St,!1);return Ft?Ft.OrdinaryOwnMetadataKeys(Ze,St):[]}function ct(Ze){if(Ze===null)return 1;switch(typeof Ze){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Ze===null?1:6;default:return 6}}function xt(Ze){return Ze===void 0}function ii(Ze){return Ze===null}function Re(Ze){return typeof Ze=="symbol"}function lt(Ze){return typeof Ze=="object"?Ze!==null:typeof Ze=="function"}function bt(Ze,St){switch(ct(Ze)){case 0:return Ze;case 1:return Ze;case 2:return Ze;case 3:return Ze;case 4:return Ze;case 5:return Ze}var Ft="string",di=bs(Ze,a);if(di!==void 0){var Oi=di.call(Ze,Ft);if(lt(Oi))throw new TypeError;return Oi}return Je(Ze)}function Je(Ze,St){var Ft,di,Oi;{var Fn=Ze.toString;if(Yi(Fn)){var di=Fn.call(Ze);if(!lt(di))return di}var Ft=Ze.valueOf;if(Yi(Ft)){var di=Ft.call(Ze);if(!lt(di))return di}}throw new TypeError}function Dt(Ze){return!!Ze}function Yt(Ze){return""+Ze}function vi(Ze){var St=bt(Ze);return Re(St)?St:Yt(St)}function xi(Ze){return Array.isArray?Array.isArray(Ze):Ze instanceof Object?Ze instanceof Array:Object.prototype.toString.call(Ze)==="[object Array]"}function Yi(Ze){return typeof Ze=="function"}function Ki(Ze){return typeof Ze=="function"}function io(Ze){switch(ct(Ze)){case 3:return!0;case 4:return!0;default:return!1}}function yr(Ze,St){return Ze===St||Ze!==Ze&&St!==St}function bs(Ze,St){var Ft=Ze[St];if(Ft!=null){if(!Yi(Ft))throw new TypeError;return Ft}}function cs(Ze){var St=bs(Ze,c);if(!Yi(St))throw new TypeError;var Ft=St.call(Ze);if(!lt(Ft))throw new TypeError;return Ft}function sn(Ze){return Ze.value}function dn(Ze){var St=Ze.next();return St.done?!1:St}function gn(Ze){var St=Ze.return;St&&St.call(Ze)}function Sr(Ze){var St=Object.getPrototypeOf(Ze);if(typeof Ze!="function"||Ze===x||St!==x)return St;var Ft=Ze.prototype,di=Ft&&Object.getPrototypeOf(Ft);if(di==null||di===Object.prototype)return St;var Oi=di.constructor;return typeof Oi!="function"||Oi===Ze?St:Oi}function fa(){var Ze;!xt(N)&&typeof i.Reflect<"u"&&!(N in i.Reflect)&&typeof i.Reflect.defineMetadata=="function"&&(Ze=Sa(i.Reflect));var St,Ft,di,Oi=new P,Fn={registerProvider:Ar,getProvider:pi,setProvider:oe};return Fn;function Ar(xe){if(!Object.isExtensible(Fn))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case Ze===xe:break;case xt(St):St=xe;break;case St===xe:break;case xt(Ft):Ft=xe;break;case Ft===xe:break;default:di===void 0&&(di=new B),di.add(xe);break}}function Zi(xe,Ye){if(!xt(St)){if(St.isProviderFor(xe,Ye))return St;if(!xt(Ft)){if(Ft.isProviderFor(xe,Ye))return St;if(!xt(di))for(var jt=cs(di);;){var bi=dn(jt);if(!bi)return;var Ui=sn(bi);if(Ui.isProviderFor(xe,Ye))return gn(jt),Ui}}}if(!xt(Ze)&&Ze.isProviderFor(xe,Ye))return Ze}function pi(xe,Ye){var jt=Oi.get(xe),bi;return xt(jt)||(bi=jt.get(Ye)),xt(bi)&&(bi=Zi(xe,Ye),xt(bi)||(xt(jt)&&(jt=new C,Oi.set(xe,jt)),jt.set(Ye,bi))),bi}function ne(xe){if(xt(xe))throw new TypeError;return St===xe||Ft===xe||!xt(di)&&di.has(xe)}function oe(xe,Ye,jt){if(!ne(jt))throw new Error("Metadata provider not registered.");var bi=pi(xe,Ye);if(bi!==jt){if(!xt(bi))return!1;var Ui=Oi.get(xe);xt(Ui)&&(Ui=new C,Oi.set(xe,Ui)),Ui.set(Ye,jt)}return!0}}function Oa(){var Ze;return!xt(N)&&lt(i.Reflect)&&Object.isExtensible(i.Reflect)&&(Ze=i.Reflect[N]),xt(Ze)&&(Ze=fa()),!xt(N)&&lt(i.Reflect)&&Object.isExtensible(i.Reflect)&&Object.defineProperty(i.Reflect,N,{enumerable:!1,configurable:!1,writable:!1,value:Ze}),Ze}function Js(Ze){var St=new P,Ft={isProviderFor:function(ne,oe){var xe=St.get(ne);return xt(xe)?!1:xe.has(oe)},OrdinaryDefineOwnMetadata:Ar,OrdinaryHasOwnMetadata:Oi,OrdinaryGetOwnMetadata:Fn,OrdinaryOwnMetadataKeys:Zi,OrdinaryDeleteMetadata:pi};return ae.registerProvider(Ft),Ft;function di(ne,oe,xe){var Ye=St.get(ne),jt=!1;if(xt(Ye)){if(!xe)return;Ye=new C,St.set(ne,Ye),jt=!0}var bi=Ye.get(oe);if(xt(bi)){if(!xe)return;if(bi=new C,Ye.set(oe,bi),!Ze.setProvider(ne,oe,Ft))throw Ye.delete(oe),jt&&St.delete(ne),new Error("Wrong provider for target.")}return bi}function Oi(ne,oe,xe){var Ye=di(oe,xe,!1);return xt(Ye)?!1:Dt(Ye.has(ne))}function Fn(ne,oe,xe){var Ye=di(oe,xe,!1);if(!xt(Ye))return Ye.get(ne)}function Ar(ne,oe,xe,Ye){var jt=di(xe,Ye,!0);jt.set(ne,oe)}function Zi(ne,oe){var xe=[],Ye=di(ne,oe,!1);if(xt(Ye))return xe;for(var jt=Ye.keys(),bi=cs(jt),Ui=0;;){var Qr=dn(bi);if(!Qr)return xe.length=Ui,xe;var Kr=sn(Qr);try{xe[Ui]=Kr}catch(ur){try{gn(bi)}finally{throw ur}}Ui++}}function pi(ne,oe,xe){var Ye=di(oe,xe,!1);if(xt(Ye)||!Ye.delete(ne))return!1;if(Ye.size===0){var jt=St.get(oe);xt(jt)||(jt.delete(xe),jt.size===0&&St.delete(jt))}return!0}}function Sa(Ze){var St=Ze.defineMetadata,Ft=Ze.hasOwnMetadata,di=Ze.getOwnMetadata,Oi=Ze.getOwnMetadataKeys,Fn=Ze.deleteMetadata,Ar=new P,Zi={isProviderFor:function(pi,ne){var oe=Ar.get(pi);return!xt(oe)&&oe.has(ne)?!0:Oi(pi,ne).length?(xt(oe)&&(oe=new B,Ar.set(pi,oe)),oe.add(ne),!0):!1},OrdinaryDefineOwnMetadata:St,OrdinaryHasOwnMetadata:Ft,OrdinaryGetOwnMetadata:di,OrdinaryOwnMetadataKeys:Oi,OrdinaryDeleteMetadata:Fn};return Zi}function ds(Ze,St,Ft){var di=ae.getProvider(Ze,St);if(!xt(di))return di;if(Ft){if(ae.setProvider(Ze,St,X))return X;throw new Error("Illegal state.")}}function js(){var Ze={},St=[],Ft=function(){function Zi(pi,ne,oe){this._index=0,this._keys=pi,this._values=ne,this._selector=oe}return Zi.prototype["@@iterator"]=function(){return this},Zi.prototype[c]=function(){return this},Zi.prototype.next=function(){var pi=this._index;if(pi>=0&&pi<this._keys.length){var ne=this._selector(this._keys[pi],this._values[pi]);return pi+1>=this._keys.length?(this._index=-1,this._keys=St,this._values=St):this._index++,{value:ne,done:!1}}return{value:void 0,done:!0}},Zi.prototype.throw=function(pi){throw this._index>=0&&(this._index=-1,this._keys=St,this._values=St),pi},Zi.prototype.return=function(pi){return this._index>=0&&(this._index=-1,this._keys=St,this._values=St),{value:pi,done:!0}},Zi}(),di=function(){function Zi(){this._keys=[],this._values=[],this._cacheKey=Ze,this._cacheIndex=-2}return Object.defineProperty(Zi.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Zi.prototype.has=function(pi){return this._find(pi,!1)>=0},Zi.prototype.get=function(pi){var ne=this._find(pi,!1);return ne>=0?this._values[ne]:void 0},Zi.prototype.set=function(pi,ne){var oe=this._find(pi,!0);return this._values[oe]=ne,this},Zi.prototype.delete=function(pi){var ne=this._find(pi,!1);if(ne>=0){for(var oe=this._keys.length,xe=ne+1;xe<oe;xe++)this._keys[xe-1]=this._keys[xe],this._values[xe-1]=this._values[xe];return this._keys.length--,this._values.length--,yr(pi,this._cacheKey)&&(this._cacheKey=Ze,this._cacheIndex=-2),!0}return!1},Zi.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Ze,this._cacheIndex=-2},Zi.prototype.keys=function(){return new Ft(this._keys,this._values,Oi)},Zi.prototype.values=function(){return new Ft(this._keys,this._values,Fn)},Zi.prototype.entries=function(){return new Ft(this._keys,this._values,Ar)},Zi.prototype["@@iterator"]=function(){return this.entries()},Zi.prototype[c]=function(){return this.entries()},Zi.prototype._find=function(pi,ne){if(!yr(this._cacheKey,pi)){this._cacheIndex=-1;for(var oe=0;oe<this._keys.length;oe++)if(yr(this._keys[oe],pi)){this._cacheIndex=oe;break}}return this._cacheIndex<0&&ne&&(this._cacheIndex=this._keys.length,this._keys.push(pi),this._values.push(void 0)),this._cacheIndex},Zi}();return di;function Oi(Zi,pi){return Zi}function Fn(Zi,pi){return pi}function Ar(Zi,pi){return[Zi,pi]}}function Vo(){var Ze=function(){function St(){this._map=new C}return Object.defineProperty(St.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),St.prototype.has=function(Ft){return this._map.has(Ft)},St.prototype.add=function(Ft){return this._map.set(Ft,Ft),this},St.prototype.delete=function(Ft){return this._map.delete(Ft)},St.prototype.clear=function(){this._map.clear()},St.prototype.keys=function(){return this._map.keys()},St.prototype.values=function(){return this._map.keys()},St.prototype.entries=function(){return this._map.entries()},St.prototype["@@iterator"]=function(){return this.keys()},St.prototype[c]=function(){return this.keys()},St}();return Ze}function Aa(){var Ze=16,St=b.create(),Ft=di();return function(){function pi(){this._key=di()}return pi.prototype.has=function(ne){var oe=Oi(ne,!1);return oe!==void 0?b.has(oe,this._key):!1},pi.prototype.get=function(ne){var oe=Oi(ne,!1);return oe!==void 0?b.get(oe,this._key):void 0},pi.prototype.set=function(ne,oe){var xe=Oi(ne,!0);return xe[this._key]=oe,this},pi.prototype.delete=function(ne){var oe=Oi(ne,!1);return oe!==void 0?delete oe[this._key]:!1},pi.prototype.clear=function(){this._key=di()},pi}();function di(){var pi;do pi="@@WeakMap@@"+Zi();while(b.has(St,pi));return St[pi]=!0,pi}function Oi(pi,ne){if(!n.call(pi,Ft)){if(!ne)return;Object.defineProperty(pi,Ft,{value:b.create()})}return pi[Ft]}function Fn(pi,ne){for(var oe=0;oe<ne;++oe)pi[oe]=Math.random()*255|0;return pi}function Ar(pi){if(typeof Uint8Array=="function"){var ne=new Uint8Array(pi);return typeof crypto<"u"?crypto.getRandomValues(ne):typeof msCrypto<"u"?msCrypto.getRandomValues(ne):Fn(ne,pi),ne}return Fn(new Array(pi),pi)}function Zi(){var pi=Ar(Ze);pi[6]=pi[6]&79|64,pi[8]=pi[8]&191|128;for(var ne="",oe=0;oe<Ze;++oe){var xe=pi[oe];(oe===4||oe===6||oe===8)&&(ne+="-"),xe<16&&(ne+="0"),ne+=xe.toString(16).toLowerCase()}return ne}}function an(Ze){return Ze.__=void 0,delete Ze.__,Ze}})}(r||(r={})),DP}/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */var PP;function tg(){return PP||(PP=1,function(r){var e=Sm&&Sm.__decorate||function(bt,Je,Dt,Yt){var vi=arguments.length,xi=vi<3?Je:Yt===null?Yt=Object.getOwnPropertyDescriptor(Je,Dt):Yt,Yi;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")xi=Reflect.decorate(bt,Je,Dt,Yt);else for(var Ki=bt.length-1;Ki>=0;Ki--)(Yi=bt[Ki])&&(xi=(vi<3?Yi(xi):vi>3?Yi(Je,Dt,xi):Yi(Je,Dt))||xi);return vi>3&&xi&&Object.defineProperty(Je,Dt,xi),xi},t=Sm&&Sm.__metadata||function(bt,Je){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(bt,Je)};Object.defineProperty(r,"__esModule",{value:!0}),r.RawReading=r.RawUnsubscribeCmd=r.RawSubscribeCmd=r.RawWriteCmd=r.RawReadCmd=r.SensorReading=r.SensorReadCmd=r.LinearCmd=r.VectorSubcommand=r.RotateCmd=r.RotateSubcommand=r.ScalarCmd=r.ScalarSubcommand=r.GenericMessageSubcommand=r.StopAllDevices=r.StopDeviceCmd=r.ServerInfo=r.RequestServerInfo=r.ScanningFinished=r.StopScanning=r.StartScanning=r.RequestDeviceList=r.DeviceRemoved=r.DeviceAdded=r.DeviceList=r.DeviceInfo=r.Error=r.ErrorClass=r.Ping=r.Ok=r.ButtplugSystemMessage=r.ButtplugDeviceMessage=r.ButtplugMessage=r.SensorDeviceMessageAttributes=r.RawDeviceMessageAttributes=r.GenericDeviceMessageAttributes=r.SensorType=r.ActuatorType=r.MessageAttributes=r.MESSAGE_SPEC_VERSION=r.MAX_ID=r.DEFAULT_MESSAGE_ID=r.SYSTEM_MESSAGE_ID=void 0;const i=HB;zY(),r.SYSTEM_MESSAGE_ID=0,r.DEFAULT_MESSAGE_ID=1,r.MAX_ID=4294967295,r.MESSAGE_SPEC_VERSION=3;class n{constructor(Je){Object.assign(this,Je)}update(){var Je,Dt,Yt,vi,xi;(Je=this.ScalarCmd)===null||Je===void 0||Je.forEach((Yi,Ki)=>Yi.Index=Ki),(Dt=this.RotateCmd)===null||Dt===void 0||Dt.forEach((Yi,Ki)=>Yi.Index=Ki),(Yt=this.LinearCmd)===null||Yt===void 0||Yt.forEach((Yi,Ki)=>Yi.Index=Ki),(vi=this.SensorReadCmd)===null||vi===void 0||vi.forEach((Yi,Ki)=>Yi.Index=Ki),(xi=this.SensorSubscribeCmd)===null||xi===void 0||xi.forEach((Yi,Ki)=>Yi.Index=Ki)}}r.MessageAttributes=n;var s;(function(bt){bt.Unknown="Unknown",bt.Vibrate="Vibrate",bt.Rotate="Rotate",bt.Oscillate="Oscillate",bt.Constrict="Constrict",bt.Inflate="Inflate",bt.Position="Position"})(s||(r.ActuatorType=s={}));var a;(function(bt){bt.Unknown="Unknown",bt.Battery="Battery",bt.RSSI="RSSI",bt.Button="Button",bt.Pressure="Pressure"})(a||(r.SensorType=a={}));class c{constructor(Je){this.Index=0,Object.assign(this,Je)}}r.GenericDeviceMessageAttributes=c;class h{constructor(Je){this.Endpoints=Je}}r.RawDeviceMessageAttributes=h;class m{constructor(Je){this.Index=0,Object.assign(this,Je)}}r.SensorDeviceMessageAttributes=m;class v{constructor(Je){this.Id=Je}get Type(){return this.constructor}toJSON(){return JSON.stringify(this.toProtocolFormat())}toProtocolFormat(){const Je={};return Je[this.constructor.Name]=(0,i.instanceToPlain)(this),Je}update(){}}r.ButtplugMessage=v;class b extends v{constructor(Je,Dt){super(Dt),this.DeviceIndex=Je,this.Id=Dt}}r.ButtplugDeviceMessage=b;class x extends v{constructor(Je=r.SYSTEM_MESSAGE_ID){super(Je),this.Id=Je}}r.ButtplugSystemMessage=x;class C extends x{constructor(Je=r.DEFAULT_MESSAGE_ID){super(Je),this.Id=Je}}r.Ok=C,C.Name="Ok";class B extends v{constructor(Je=r.DEFAULT_MESSAGE_ID){super(Je),this.Id=Je}}r.Ping=B,B.Name="Ping";var P;(function(bt){bt[bt.ERROR_UNKNOWN=0]="ERROR_UNKNOWN",bt[bt.ERROR_INIT=1]="ERROR_INIT",bt[bt.ERROR_PING=2]="ERROR_PING",bt[bt.ERROR_MSG=3]="ERROR_MSG",bt[bt.ERROR_DEVICE=4]="ERROR_DEVICE"})(P||(r.ErrorClass=P={}));class N extends v{constructor(Je,Dt=P.ERROR_UNKNOWN,Yt=r.DEFAULT_MESSAGE_ID){super(Yt),this.ErrorMessage=Je,this.ErrorCode=Dt,this.Id=Yt}get Schemversion(){return 0}}r.Error=N,N.Name="Error";class ae{constructor(Je){Object.assign(this,Je)}}r.DeviceInfo=ae,e([(0,i.Type)(()=>n),t("design:type",n)],ae.prototype,"DeviceMessages",void 0);class X extends v{constructor(Je,Dt=r.DEFAULT_MESSAGE_ID){super(Dt),this.Devices=Je,this.Id=Dt}update(){for(const Je of this.Devices)Je.DeviceMessages.update()}}r.DeviceList=X,X.Name="DeviceList",e([(0,i.Type)(()=>ae),t("design:type",Array)],X.prototype,"Devices",void 0);class de extends x{constructor(Je){super(),Object.assign(this,Je)}update(){this.DeviceMessages.update()}}r.DeviceAdded=de,de.Name="DeviceAdded",e([(0,i.Type)(()=>n),t("design:type",n)],de.prototype,"DeviceMessages",void 0);class ge extends x{constructor(Je){super(),this.DeviceIndex=Je}}r.DeviceRemoved=ge,ge.Name="DeviceRemoved";class ue extends v{constructor(Je=r.DEFAULT_MESSAGE_ID){super(Je),this.Id=Je}}r.RequestDeviceList=ue,ue.Name="RequestDeviceList";class be extends v{constructor(Je=r.DEFAULT_MESSAGE_ID){super(Je),this.Id=Je}}r.StartScanning=be,be.Name="StartScanning";class fe extends v{constructor(Je=r.DEFAULT_MESSAGE_ID){super(Je),this.Id=Je}}r.StopScanning=fe,fe.Name="StopScanning";class ve extends x{constructor(){super()}}r.ScanningFinished=ve,ve.Name="ScanningFinished";class ie extends v{constructor(Je,Dt=0,Yt=r.DEFAULT_MESSAGE_ID){super(Yt),this.ClientName=Je,this.MessageVersion=Dt,this.Id=Yt}}r.RequestServerInfo=ie,ie.Name="RequestServerInfo";class re extends x{constructor(Je,Dt,Yt,vi=r.DEFAULT_MESSAGE_ID){super(),this.MessageVersion=Je,this.MaxPingTime=Dt,this.ServerName=Yt,this.Id=vi}}r.ServerInfo=re,re.Name="ServerInfo";class Ne extends b{constructor(Je=-1,Dt=r.DEFAULT_MESSAGE_ID){super(Je,Dt),this.DeviceIndex=Je,this.Id=Dt}}r.StopDeviceCmd=Ne,Ne.Name="StopDeviceCmd";class De extends v{constructor(Je=r.DEFAULT_MESSAGE_ID){super(Je),this.Id=Je}}r.StopAllDevices=De,De.Name="StopAllDevices";class ke{constructor(Je){this.Index=Je}}r.GenericMessageSubcommand=ke;class ut extends ke{constructor(Je,Dt,Yt){super(Je),this.Scalar=Dt,this.ActuatorType=Yt}}r.ScalarSubcommand=ut;class _t extends b{constructor(Je,Dt=-1,Yt=r.DEFAULT_MESSAGE_ID){super(Dt,Yt),this.Scalars=Je,this.DeviceIndex=Dt,this.Id=Yt}}r.ScalarCmd=_t,_t.Name="ScalarCmd";class vt extends ke{constructor(Je,Dt,Yt){super(Je),this.Speed=Dt,this.Clockwise=Yt}}r.RotateSubcommand=vt;class tt extends b{static Create(Je,Dt){const Yt=new Array;let vi=0;for(const[xi,Yi]of Dt)Yt.push(new vt(vi,xi,Yi)),++vi;return new tt(Yt,Je)}constructor(Je,Dt=-1,Yt=r.DEFAULT_MESSAGE_ID){super(Dt,Yt),this.Rotations=Je,this.DeviceIndex=Dt,this.Id=Yt}}r.RotateCmd=tt,tt.Name="RotateCmd";class je extends ke{constructor(Je,Dt,Yt){super(Je),this.Position=Dt,this.Duration=Yt}}r.VectorSubcommand=je;class it extends b{static Create(Je,Dt){const Yt=new Array;let vi=0;for(const xi of Dt)Yt.push(new je(vi,xi[0],xi[1])),++vi;return new it(Yt,Je)}constructor(Je,Dt=-1,Yt=r.DEFAULT_MESSAGE_ID){super(Dt,Yt),this.Vectors=Je,this.DeviceIndex=Dt,this.Id=Yt}}r.LinearCmd=it,it.Name="LinearCmd";class Xe extends b{constructor(Je,Dt,Yt,vi=r.DEFAULT_MESSAGE_ID){super(Je,vi),this.DeviceIndex=Je,this.SensorIndex=Dt,this.SensorType=Yt,this.Id=vi}}r.SensorReadCmd=Xe,Xe.Name="SensorReadCmd";class Se extends b{constructor(Je,Dt,Yt,vi,xi=r.DEFAULT_MESSAGE_ID){super(Je,xi),this.DeviceIndex=Je,this.SensorIndex=Dt,this.SensorType=Yt,this.Data=vi,this.Id=xi}}r.SensorReading=Se,Se.Name="SensorReading";class ct extends b{constructor(Je,Dt,Yt,vi,xi=r.DEFAULT_MESSAGE_ID){super(Je,xi),this.DeviceIndex=Je,this.Endpoint=Dt,this.ExpectedLength=Yt,this.Timeout=vi,this.Id=xi}}r.RawReadCmd=ct,ct.Name="RawReadCmd";class xt extends b{constructor(Je,Dt,Yt,vi,xi=r.DEFAULT_MESSAGE_ID){super(Je,xi),this.DeviceIndex=Je,this.Endpoint=Dt,this.Data=Yt,this.WriteWithResponse=vi,this.Id=xi}}r.RawWriteCmd=xt,xt.Name="RawWriteCmd";class ii extends b{constructor(Je,Dt,Yt=r.DEFAULT_MESSAGE_ID){super(Je,Yt),this.DeviceIndex=Je,this.Endpoint=Dt,this.Id=Yt}}r.RawSubscribeCmd=ii,ii.Name="RawSubscribeCmd";class Re extends b{constructor(Je,Dt,Yt=r.DEFAULT_MESSAGE_ID){super(Je,Yt),this.DeviceIndex=Je,this.Endpoint=Dt,this.Id=Yt}}r.RawUnsubscribeCmd=Re,Re.Name="RawUnsubscribeCmd";class lt extends b{constructor(Je,Dt,Yt,vi=r.DEFAULT_MESSAGE_ID){super(Je,vi),this.DeviceIndex=Je,this.Endpoint=Dt,this.Data=Yt,this.Id=vi}}r.RawReading=lt,lt.Name="RawReading"}(Sm)),Sm}var ca={},LP;function rb(){if(LP)return ca;LP=1;/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */var r=ca&&ca.__createBinding||(Object.create?function(v,b,x,C){C===void 0&&(C=x);var B=Object.getOwnPropertyDescriptor(b,x);(!B||("get"in B?!b.__esModule:B.writable||B.configurable))&&(B={enumerable:!0,get:function(){return b[x]}}),Object.defineProperty(v,C,B)}:function(v,b,x,C){C===void 0&&(C=x),v[C]=b[x]}),e=ca&&ca.__setModuleDefault||(Object.create?function(v,b){Object.defineProperty(v,"default",{enumerable:!0,value:b})}:function(v,b){v.default=b}),t=ca&&ca.__importStar||function(v){if(v&&v.__esModule)return v;var b={};if(v!=null)for(var x in v)x!=="default"&&Object.prototype.hasOwnProperty.call(v,x)&&r(b,v,x);return e(b,v),b};Object.defineProperty(ca,"__esModule",{value:!0}),ca.ButtplugUnknownError=ca.ButtplugPingError=ca.ButtplugMessageError=ca.ButtplugDeviceError=ca.ButtplugInitError=ca.ButtplugError=void 0;const i=t(tg());class n extends Error{get ErrorClass(){return this.errorClass}get InnerError(){return this.innerError}get Id(){return this.messageId}get ErrorMessage(){return new i.Error(this.message,this.ErrorClass,this.Id)}static LogAndError(b,x,C,B=i.SYSTEM_MESSAGE_ID){return x.Error(C),new b(C,B)}static FromError(b){switch(b.ErrorCode){case i.ErrorClass.ERROR_DEVICE:return new a(b.ErrorMessage,b.Id);case i.ErrorClass.ERROR_INIT:return new s(b.ErrorMessage,b.Id);case i.ErrorClass.ERROR_UNKNOWN:return new m(b.ErrorMessage,b.Id);case i.ErrorClass.ERROR_PING:return new h(b.ErrorMessage,b.Id);case i.ErrorClass.ERROR_MSG:return new c(b.ErrorMessage,b.Id);default:throw new Error(`Message type ${b.ErrorCode} not handled`)}}constructor(b,x,C=i.SYSTEM_MESSAGE_ID,B){super(b),this.errorClass=i.ErrorClass.ERROR_UNKNOWN,this.errorClass=x,this.innerError=B,this.messageId=C}}ca.ButtplugError=n;class s extends n{constructor(b,x=i.SYSTEM_MESSAGE_ID){super(b,i.ErrorClass.ERROR_INIT,x)}}ca.ButtplugInitError=s;class a extends n{constructor(b,x=i.SYSTEM_MESSAGE_ID){super(b,i.ErrorClass.ERROR_DEVICE,x)}}ca.ButtplugDeviceError=a;class c extends n{constructor(b,x=i.SYSTEM_MESSAGE_ID){super(b,i.ErrorClass.ERROR_MSG,x)}}ca.ButtplugMessageError=c;class h extends n{constructor(b,x=i.SYSTEM_MESSAGE_ID){super(b,i.ErrorClass.ERROR_PING,x)}}ca.ButtplugPingError=h;class m extends n{constructor(b,x=i.SYSTEM_MESSAGE_ID){super(b,i.ErrorClass.ERROR_UNKNOWN,x)}}return ca.ButtplugUnknownError=m,ca}var Vu={};/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */var RP;function DS(){if(RP)return Vu;RP=1;var r=Vu&&Vu.__createBinding||(Object.create?function(h,m,v,b){b===void 0&&(b=v);var x=Object.getOwnPropertyDescriptor(m,v);(!x||("get"in x?!m.__esModule:x.writable||x.configurable))&&(x={enumerable:!0,get:function(){return m[v]}}),Object.defineProperty(h,b,x)}:function(h,m,v,b){b===void 0&&(b=v),h[b]=m[v]}),e=Vu&&Vu.__setModuleDefault||(Object.create?function(h,m){Object.defineProperty(h,"default",{enumerable:!0,value:m})}:function(h,m){h.default=m}),t=Vu&&Vu.__importStar||function(h){if(h&&h.__esModule)return h;var m={};if(h!=null)for(var v in h)v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)&&r(m,h,v);return e(m,h),m};Object.defineProperty(Vu,"__esModule",{value:!0}),Vu.fromJSON=Vu.getMessageClassFromMessage=void 0;const i=HB,n=t(tg());function s(h){for(const m of Object.values(n))if(typeof m=="function"&&"Name"in m&&m.Name===h)return m;return null}function a(h){return s(Object.getPrototypeOf(h).constructor.Name)}Vu.getMessageClassFromMessage=a;function c(h){const m=JSON.parse(h),v=[];for(const b of Array.from(m)){const x=Object.getOwnPropertyNames(b)[0],C=s(x);if(C){const B=(0,i.plainToInstance)(C,b[x]);B.update(),v.push(B)}}return v}return Vu.fromJSON=c,Vu}/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */var kP;function GB(){if(kP)return Uu;kP=1;var r=Uu&&Uu.__createBinding||(Object.create?function(m,v,b,x){x===void 0&&(x=b);var C=Object.getOwnPropertyDescriptor(v,b);(!C||("get"in C?!v.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return v[b]}}),Object.defineProperty(m,x,C)}:function(m,v,b,x){x===void 0&&(x=b),m[x]=v[b]}),e=Uu&&Uu.__setModuleDefault||(Object.create?function(m,v){Object.defineProperty(m,"default",{enumerable:!0,value:v})}:function(m,v){m.default=v}),t=Uu&&Uu.__importStar||function(m){if(m&&m.__esModule)return m;var v={};if(m!=null)for(var b in m)b!=="default"&&Object.prototype.hasOwnProperty.call(m,b)&&r(v,m,b);return e(v,m),v},i=Uu&&Uu.__awaiter||function(m,v,b,x){function C(B){return B instanceof b?B:new b(function(P){P(B)})}return new(b||(b=Promise))(function(B,P){function N(de){try{X(x.next(de))}catch(ge){P(ge)}}function ae(de){try{X(x.throw(de))}catch(ge){P(ge)}}function X(de){de.done?B(de.value):C(de.value).then(N,ae)}X((x=x.apply(m,v||[])).next())})};Object.defineProperty(Uu,"__esModule",{value:!0}),Uu.ButtplugClientDevice=void 0;const n=t(tg()),s=rb(),a=MS(),c=DS();let h=class jB extends a.EventEmitter{get name(){return this._deviceInfo.DeviceName}get displayName(){return this._deviceInfo.DeviceDisplayName}get index(){return this._deviceInfo.DeviceIndex}get messageTimingGap(){return this._deviceInfo.DeviceMessageTimingGap}get messageAttributes(){return this._deviceInfo.DeviceMessages}static fromMsg(v,b){return new jB(v,b)}constructor(v,b){super(),this._deviceInfo=v,this._sendClosure=b,this.allowedMsgs=new Map,v.DeviceMessages.update()}send(v){return i(this,void 0,void 0,function*(){return yield this._sendClosure(this,v)})}sendExpectOk(v){return i(this,void 0,void 0,function*(){const b=yield this.send(v);switch((0,c.getMessageClassFromMessage)(b)){case n.Ok:return;case n.Error:throw s.ButtplugError.FromError(b);default:throw new s.ButtplugMessageError(`Message type ${b.constructor} not handled by SendMsgExpectOk`)}})}scalar(v){return i(this,void 0,void 0,function*(){Array.isArray(v)?yield this.sendExpectOk(new n.ScalarCmd(v,this.index)):yield this.sendExpectOk(new n.ScalarCmd([v],this.index))})}scalarCommandBuilder(v,b){var x;return i(this,void 0,void 0,function*(){const C=(x=this.messageAttributes.ScalarCmd)===null||x===void 0?void 0:x.filter(P=>P.ActuatorType===b);if(!C||C.length===0)throw new s.ButtplugDeviceError(`Device ${this.name} has no ${b} capabilities`);const B=[];if(typeof v=="number")C.forEach(P=>B.push(new n.ScalarSubcommand(P.Index,v,b)));else if(Array.isArray(v)){if(v.length>C.length)throw new s.ButtplugDeviceError(`${v.length} commands send to a device with ${C.length} vibrators`);C.forEach((P,N)=>{B.push(new n.ScalarSubcommand(P.Index,v[N],b))})}else throw new s.ButtplugDeviceError(`${b} can only take numbers or arrays of numbers.`);yield this.scalar(B)})}get vibrateAttributes(){var v,b;return(b=(v=this.messageAttributes.ScalarCmd)===null||v===void 0?void 0:v.filter(x=>x.ActuatorType===n.ActuatorType.Vibrate))!==null&&b!==void 0?b:[]}vibrate(v){return i(this,void 0,void 0,function*(){yield this.scalarCommandBuilder(v,n.ActuatorType.Vibrate)})}get oscillateAttributes(){var v,b;return(b=(v=this.messageAttributes.ScalarCmd)===null||v===void 0?void 0:v.filter(x=>x.ActuatorType===n.ActuatorType.Oscillate))!==null&&b!==void 0?b:[]}oscillate(v){return i(this,void 0,void 0,function*(){yield this.scalarCommandBuilder(v,n.ActuatorType.Oscillate)})}get rotateAttributes(){var v;return(v=this.messageAttributes.RotateCmd)!==null&&v!==void 0?v:[]}rotate(v,b){return i(this,void 0,void 0,function*(){const x=this.messageAttributes.RotateCmd;if(!x||x.length===0)throw new s.ButtplugDeviceError(`Device ${this.name} has no Rotate capabilities`);let C;if(typeof v=="number")C=n.RotateCmd.Create(this.index,new Array(x.length).fill([v,b]));else if(Array.isArray(v))C=n.RotateCmd.Create(this.index,v);else throw new s.ButtplugDeviceError("SendRotateCmd can only take a number and boolean, or an array of number/boolean tuples");yield this.sendExpectOk(C)})}get linearAttributes(){var v;return(v=this.messageAttributes.LinearCmd)!==null&&v!==void 0?v:[]}linear(v,b){return i(this,void 0,void 0,function*(){const x=this.messageAttributes.LinearCmd;if(!x||x.length===0)throw new s.ButtplugDeviceError(`Device ${this.name} has no Linear capabilities`);let C;if(typeof v=="number")C=n.LinearCmd.Create(this.index,new Array(x.length).fill([v,b]));else if(Array.isArray(v))C=n.LinearCmd.Create(this.index,v);else throw new s.ButtplugDeviceError("SendLinearCmd can only take a number and number, or an array of number/number tuples");yield this.sendExpectOk(C)})}sensorRead(v,b){return i(this,void 0,void 0,function*(){const x=yield this.send(new n.SensorReadCmd(this.index,v,b));switch((0,c.getMessageClassFromMessage)(x)){case n.SensorReading:return x.Data;case n.Error:throw s.ButtplugError.FromError(x);default:throw new s.ButtplugMessageError(`Message type ${x.constructor} not handled by sensorRead`)}})}get hasBattery(){var v;const b=(v=this.messageAttributes.SensorReadCmd)===null||v===void 0?void 0:v.filter(x=>x.SensorType===n.SensorType.Battery);return b!==void 0&&b.length>0}battery(){var v;return i(this,void 0,void 0,function*(){if(!this.hasBattery)throw new s.ButtplugDeviceError(`Device ${this.name} has no Battery capabilities`);const b=(v=this.messageAttributes.SensorReadCmd)===null||v===void 0?void 0:v.filter(C=>C.SensorType===n.SensorType.Battery);return(yield this.sensorRead(b[0].Index,n.SensorType.Battery))[0]/100})}get hasRssi(){var v;const b=(v=this.messageAttributes.SensorReadCmd)===null||v===void 0?void 0:v.filter(x=>x.SensorType===n.SensorType.RSSI);return b!==void 0&&b.length===0}rssi(){var v;return i(this,void 0,void 0,function*(){if(!this.hasRssi)throw new s.ButtplugDeviceError(`Device ${this.name} has no RSSI capabilities`);const b=(v=this.messageAttributes.SensorReadCmd)===null||v===void 0?void 0:v.filter(C=>C.SensorType===n.SensorType.RSSI);return(yield this.sensorRead(b[0].Index,n.SensorType.RSSI))[0]})}rawRead(v,b,x){return i(this,void 0,void 0,function*(){if(!this.messageAttributes.RawReadCmd)throw new s.ButtplugDeviceError(`Device ${this.name} has no raw read capabilities`);if(this.messageAttributes.RawReadCmd.Endpoints.indexOf(v)===-1)throw new s.ButtplugDeviceError(`Device ${this.name} has no raw readable endpoint ${v}`);const C=yield this.send(new n.RawReadCmd(this.index,v,b,x));switch((0,c.getMessageClassFromMessage)(C)){case n.RawReading:return new Uint8Array(C.Data);case n.Error:throw s.ButtplugError.FromError(C);default:throw new s.ButtplugMessageError(`Message type ${C.constructor} not handled by rawRead`)}})}rawWrite(v,b,x){return i(this,void 0,void 0,function*(){if(!this.messageAttributes.RawWriteCmd)throw new s.ButtplugDeviceError(`Device ${this.name} has no raw write capabilities`);if(this.messageAttributes.RawWriteCmd.Endpoints.indexOf(v)===-1)throw new s.ButtplugDeviceError(`Device ${this.name} has no raw writable endpoint ${v}`);yield this.sendExpectOk(new n.RawWriteCmd(this.index,v,b,x))})}rawSubscribe(v){return i(this,void 0,void 0,function*(){if(!this.messageAttributes.RawSubscribeCmd)throw new s.ButtplugDeviceError(`Device ${this.name} has no raw subscribe capabilities`);if(this.messageAttributes.RawSubscribeCmd.Endpoints.indexOf(v)===-1)throw new s.ButtplugDeviceError(`Device ${this.name} has no raw subscribable endpoint ${v}`);yield this.sendExpectOk(new n.RawSubscribeCmd(this.index,v))})}rawUnsubscribe(v){return i(this,void 0,void 0,function*(){if(!this.messageAttributes.RawSubscribeCmd)throw new s.ButtplugDeviceError(`Device ${this.name} has no raw unsubscribe capabilities`);if(this.messageAttributes.RawSubscribeCmd.Endpoints.indexOf(v)===-1)throw new s.ButtplugDeviceError(`Device ${this.name} has no raw unsubscribable endpoint ${v}`);yield this.sendExpectOk(new n.RawUnsubscribeCmd(this.index,v))})}stop(){return i(this,void 0,void 0,function*(){yield this.sendExpectOk(new n.StopDeviceCmd(this.index))})}emitDisconnected(){this.emit("deviceremoved")}};return Uu.ButtplugClientDevice=h,Uu}var jc={},OP;function $B(){if(OP)return jc;OP=1;/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */var r=jc&&jc.__createBinding||(Object.create?function(a,c,h,m){m===void 0&&(m=h);var v=Object.getOwnPropertyDescriptor(c,h);(!v||("get"in v?!c.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return c[h]}}),Object.defineProperty(a,m,v)}:function(a,c,h,m){m===void 0&&(m=h),a[m]=c[h]}),e=jc&&jc.__setModuleDefault||(Object.create?function(a,c){Object.defineProperty(a,"default",{enumerable:!0,value:c})}:function(a,c){a.default=c}),t=jc&&jc.__importStar||function(a){if(a&&a.__esModule)return a;var c={};if(a!=null)for(var h in a)h!=="default"&&Object.prototype.hasOwnProperty.call(a,h)&&r(c,a,h);return e(c,a),c};Object.defineProperty(jc,"__esModule",{value:!0}),jc.ButtplugMessageSorter=void 0;const i=t(tg()),n=rb();let s=class{constructor(c){this._useCounter=c,this._counter=1,this._waitingMsgs=new Map}PrepareOutgoingMessage(c){this._useCounter&&(c.Id=this._counter,this._counter+=1);let h,m;const v=new Promise((b,x)=>{h=b,m=x});return this._waitingMsgs.set(c.Id,[h,m]),v}ParseIncomingMessages(c){const h=[];for(const m of c)if(m.Id!==i.SYSTEM_MESSAGE_ID&&this._waitingMsgs.has(m.Id)){const[v,b]=this._waitingMsgs.get(m.Id);if(m.Type===i.Error){b(n.ButtplugError.FromError(m));continue}v(m);continue}else h.push(m);return h}};return jc.ButtplugMessageSorter=s,jc}var Gc={},FP;function WB(){if(FP)return Gc;FP=1;/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */var r=Gc&&Gc.__createBinding||(Object.create?function(a,c,h,m){m===void 0&&(m=h);var v=Object.getOwnPropertyDescriptor(c,h);(!v||("get"in v?!c.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return c[h]}}),Object.defineProperty(a,m,v)}:function(a,c,h,m){m===void 0&&(m=h),a[m]=c[h]}),e=Gc&&Gc.__setModuleDefault||(Object.create?function(a,c){Object.defineProperty(a,"default",{enumerable:!0,value:c})}:function(a,c){a.default=c}),t=Gc&&Gc.__importStar||function(a){if(a&&a.__esModule)return a;var c={};if(a!=null)for(var h in a)h!=="default"&&Object.prototype.hasOwnProperty.call(a,h)&&r(c,a,h);return e(c,a),c};Object.defineProperty(Gc,"__esModule",{value:!0}),Gc.ButtplugClientConnectorException=void 0;const i=rb(),n=t(tg());let s=class extends i.ButtplugError{constructor(c){super(c,n.ErrorClass.ERROR_UNKNOWN)}};return Gc.ButtplugClientConnectorException=s,Gc}/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */var BP;function HY(){if(BP)return Nu;BP=1;var r=Nu&&Nu.__createBinding||(Object.create?function(C,B,P,N){N===void 0&&(N=P);var ae=Object.getOwnPropertyDescriptor(B,P);(!ae||("get"in ae?!B.__esModule:ae.writable||ae.configurable))&&(ae={enumerable:!0,get:function(){return B[P]}}),Object.defineProperty(C,N,ae)}:function(C,B,P,N){N===void 0&&(N=P),C[N]=B[P]}),e=Nu&&Nu.__setModuleDefault||(Object.create?function(C,B){Object.defineProperty(C,"default",{enumerable:!0,value:B})}:function(C,B){C.default=B}),t=Nu&&Nu.__importStar||function(C){if(C&&C.__esModule)return C;var B={};if(C!=null)for(var P in C)P!=="default"&&Object.prototype.hasOwnProperty.call(C,P)&&r(B,C,P);return e(B,C),B},i=Nu&&Nu.__awaiter||function(C,B,P,N){function ae(X){return X instanceof P?X:new P(function(de){de(X)})}return new(P||(P=Promise))(function(X,de){function ge(fe){try{be(N.next(fe))}catch(ve){de(ve)}}function ue(fe){try{be(N.throw(fe))}catch(ve){de(ve)}}function be(fe){fe.done?X(fe.value):ae(fe.value).then(ge,ue)}be((N=N.apply(C,B||[])).next())})};Object.defineProperty(Nu,"__esModule",{value:!0}),Nu.ButtplugClient=void 0;const n=zB(),s=MS(),a=GB(),c=$B(),h=t(tg()),m=rb(),v=WB(),b=DS();class x extends s.EventEmitter{constructor(B="Generic Buttplug Client"){super(),this._pingTimer=null,this._connector=null,this._devices=new Map,this._logger=n.ButtplugLogger.Logger,this._isScanning=!1,this._sorter=new c.ButtplugMessageSorter(!0),this.connect=P=>i(this,void 0,void 0,function*(){this._logger.Info(`ButtplugClient: Connecting using ${P.constructor.name}`),yield P.connect(),this._connector=P,this._connector.addListener("message",this.parseMessages),this._connector.addListener("disconnect",this.disconnectHandler),yield this.initializeConnection()}),this.disconnect=()=>i(this,void 0,void 0,function*(){this._logger.Debug("ButtplugClient: Disconnect called"),this.checkConnector(),yield this.shutdownConnection(),yield this._connector.disconnect()}),this.startScanning=()=>i(this,void 0,void 0,function*(){this._logger.Debug("ButtplugClient: StartScanning called"),this._isScanning=!0,yield this.sendMsgExpectOk(new h.StartScanning)}),this.stopScanning=()=>i(this,void 0,void 0,function*(){this._logger.Debug("ButtplugClient: StopScanning called"),this._isScanning=!1,yield this.sendMsgExpectOk(new h.StopScanning)}),this.stopAllDevices=()=>i(this,void 0,void 0,function*(){this._logger.Debug("ButtplugClient: StopAllDevices"),yield this.sendMsgExpectOk(new h.StopAllDevices)}),this.disconnectHandler=()=>{this._logger.Info("ButtplugClient: Disconnect event receieved."),this.emit("disconnect")},this.parseMessages=P=>{const N=this._sorter.ParseIncomingMessages(P);for(const ae of N)switch((0,b.getMessageClassFromMessage)(ae)){case h.DeviceAdded:{const X=ae,de=a.ButtplugClientDevice.fromMsg(X,this.sendDeviceMessageClosure);this._devices.set(X.DeviceIndex,de),this.emit("deviceadded",de);break}case h.DeviceRemoved:{const X=ae;if(this._devices.has(X.DeviceIndex)){const de=this._devices.get(X.DeviceIndex);de==null||de.emitDisconnected(),this._devices.delete(X.DeviceIndex),this.emit("deviceremoved",de)}break}case h.ScanningFinished:this._isScanning=!1,this.emit("scanningfinished",ae);break}},this.initializeConnection=()=>i(this,void 0,void 0,function*(){this.checkConnector();const P=yield this.sendMessage(new h.RequestServerInfo(this._clientName,h.MESSAGE_SPEC_VERSION));switch((0,b.getMessageClassFromMessage)(P)){case h.ServerInfo:{const N=P;if(this._logger.Info(`ButtplugClient: Connected to Server ${N.ServerName}`),N.MaxPingTime,N.MessageVersion<h.MESSAGE_SPEC_VERSION)throw yield this._connector.disconnect(),m.ButtplugError.LogAndError(m.ButtplugInitError,this._logger,`Server protocol version ${N.MessageVersion} is older than client protocol version ${h.MESSAGE_SPEC_VERSION}. Please update server.`);return yield this.requestDeviceList(),!0}case h.Error:{yield this._connector.disconnect();const N=P;throw m.ButtplugError.LogAndError(m.ButtplugInitError,this._logger,`Cannot connect to server. ${N.ErrorMessage}`)}}return!1}),this.requestDeviceList=()=>i(this,void 0,void 0,function*(){this.checkConnector(),this._logger.Debug("ButtplugClient: ReceiveDeviceList called"),(yield this.sendMessage(new h.RequestDeviceList)).Devices.forEach(N=>{if(this._devices.has(N.DeviceIndex))this._logger.Debug(`ButtplugClient: Device already added: ${N}`);else{const ae=a.ButtplugClientDevice.fromMsg(N,this.sendDeviceMessageClosure);this._logger.Debug(`ButtplugClient: Adding Device: ${ae}`),this._devices.set(N.DeviceIndex,ae),this.emit("deviceadded",ae)}})}),this.shutdownConnection=()=>i(this,void 0,void 0,function*(){yield this.stopAllDevices(),this._pingTimer!==null&&(clearInterval(this._pingTimer),this._pingTimer=null)}),this.sendMsgExpectOk=P=>i(this,void 0,void 0,function*(){const N=yield this.sendMessage(P);switch((0,b.getMessageClassFromMessage)(N)){case h.Ok:return;case h.Error:throw m.ButtplugError.FromError(N);default:throw m.ButtplugError.LogAndError(m.ButtplugMessageError,this._logger,`Message type ${(0,b.getMessageClassFromMessage)(N).constructor} not handled by SendMsgExpectOk`)}}),this.sendDeviceMessageClosure=(P,N)=>i(this,void 0,void 0,function*(){return yield this.sendDeviceMessage(P,N)}),this._clientName=B,this._logger.Debug(`ButtplugClient: Client ${B} created.`)}get connected(){return this._connector!==null&&this._connector.Connected}get devices(){this.checkConnector();const B=[];return this._devices.forEach(P=>{B.push(P)}),B}get isScanning(){return this._isScanning}sendDeviceMessage(B,P){return i(this,void 0,void 0,function*(){if(this.checkConnector(),this._devices.get(B.index)===void 0)throw m.ButtplugError.LogAndError(m.ButtplugDeviceError,this._logger,`Device ${B.index} not available.`);return P.DeviceIndex=B.index,yield this.sendMessage(P)})}sendMessage(B){return i(this,void 0,void 0,function*(){this.checkConnector();const P=this._sorter.PrepareOutgoingMessage(B);return yield this._connector.send(B),yield P})}checkConnector(){if(!this.connected)throw new v.ButtplugClientConnectorException("ButtplugClient not connected")}}return Nu.ButtplugClient=x,Nu}var Xy={},Am={};/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */var NP;function jY(){if(NP)return Am;NP=1;var r=Am&&Am.__awaiter||function(n,s,a,c){function h(m){return m instanceof a?m:new a(function(v){v(m)})}return new(a||(a=Promise))(function(m,v){function b(B){try{C(c.next(B))}catch(P){v(P)}}function x(B){try{C(c.throw(B))}catch(P){v(P)}}function C(B){B.done?m(B.value):h(B.value).then(b,x)}C((c=c.apply(n,s||[])).next())})};Object.defineProperty(Am,"__esModule",{value:!0}),Am.ButtplugBrowserWebsocketConnector=void 0;const e=MS(),t=DS();let i=class extends e.EventEmitter{constructor(s){super(),this._url=s,this._websocketConstructor=null,this.connect=()=>r(this,void 0,void 0,function*(){var a;const c=new((a=this._websocketConstructor)!==null&&a!==void 0?a:WebSocket)(this._url);let h,m;const v=new Promise((x,C)=>{h=x,m=C}),b=()=>m();return c.addEventListener("open",()=>r(this,void 0,void 0,function*(){this._ws=c;try{yield this.initialize(),this._ws.addEventListener("message",x=>{this.parseIncomingMessage(x)}),this._ws.removeEventListener("close",b),this._ws.addEventListener("close",this.disconnect),h()}catch(x){console.log(x),m()}})),c.addEventListener("close",b),v}),this.disconnect=()=>r(this,void 0,void 0,function*(){this.Connected&&(this._ws.close(),this._ws=void 0,this.emit("disconnect"))}),this.initialize=()=>r(this,void 0,void 0,function*(){return Promise.resolve()})}get Connected(){return this._ws!==void 0}sendMessage(s){if(!this.Connected)throw new Error("ButtplugBrowserWebsocketConnector not connected");this._ws.send("["+s.toJSON()+"]")}parseIncomingMessage(s){if(typeof s.data=="string"){const a=(0,t.fromJSON)(s.data);this.emit("message",a)}else s.data instanceof Blob}onReaderLoad(s){const a=(0,t.fromJSON)(s.target.result);this.emit("message",a)}};return Am.ButtplugBrowserWebsocketConnector=i,Am}/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */var UP;function qB(){if(UP)return Xy;UP=1,Object.defineProperty(Xy,"__esModule",{value:!0}),Xy.ButtplugBrowserWebsocketClientConnector=void 0;const r=jY();let e=class extends r.ButtplugBrowserWebsocketConnector{constructor(){super(...arguments),this.send=i=>{if(!this.Connected)throw new Error("ButtplugClient not connected");this.sendMessage(i)}}};return Xy.ButtplugBrowserWebsocketClientConnector=e,Xy}var Yy={},Hw,VP;function GY(){return VP||(VP=1,Hw=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}),Hw}/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */var zP;function $Y(){if(zP)return Yy;zP=1,Object.defineProperty(Yy,"__esModule",{value:!0}),Yy.ButtplugNodeWebsocketClientConnector=void 0;const r=qB(),e=GY();let t=class extends r.ButtplugBrowserWebsocketClientConnector{constructor(){super(...arguments),this._websocketConstructor=e.WebSocket}};return Yy.ButtplugNodeWebsocketClientConnector=t,Yy}var jw={},HP;function WY(){if(HP)return jw;HP=1;/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */return Object.defineProperty(jw,"__esModule",{value:!0}),jw}var jP;function qY(){return jP||(jP=1,function(r){/*!
 * Buttplug JS Source Code File - Visit https://buttplug.io for more info about
 * the project. Licensed under the BSD 3-Clause license. See LICENSE file in the
 * project root for full license information.
 *
 * @copyright Copyright (c) Nonpolynomial Labs LLC. All rights reserved.
 */var e=xm&&xm.__createBinding||(Object.create?function(i,n,s,a){a===void 0&&(a=s);var c=Object.getOwnPropertyDescriptor(n,s);(!c||("get"in c?!n.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return n[s]}}),Object.defineProperty(i,a,c)}:function(i,n,s,a){a===void 0&&(a=s),i[a]=n[s]}),t=xm&&xm.__exportStar||function(i,n){for(var s in i)s!=="default"&&!Object.prototype.hasOwnProperty.call(n,s)&&e(n,i,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(HY(),r),t(GB(),r),t(qB(),r),t($Y(),r),t(WB(),r),t($B(),r),t(WY(),r),t(tg(),r),t(DS(),r),t(zB(),r),t(rb(),r)}(xm)),xm}var qd=qY();class XY{constructor(){Ot(this,"_sendScalarCommand",async(e,t,i=null)=>{if(!this.selectedDevice)throw new Error("No device selected");const n=e===qd.ActuatorType.Vibrate?"vibrate":"oscillate";if(this._resolveActuatorIndex(n,i)===null)throw new Error(`No ${e} actuator available`);try{const a=Math.max(0,Math.min(1,t));return e===qd.ActuatorType.Vibrate?await this.selectedDevice.vibrate(a):e===qd.ActuatorType.Oscillate&&await this.selectedDevice.oscillate(a),!0}catch(a){return this._error(`${e} command failed`,a),!1}});Ot(this,"_buildCapabilities",e=>{const t=e.messageAttributes,i=[],n={vibrate:0,linear:0,rotate:0,oscillate:0};let s=-1;t.ScalarCmd&&t.ScalarCmd.forEach(c=>{s=Math.max(s,c.Index),i[c.Index]||(i[c.Index]={index:c.Index,vibrate:!1,oscillate:!1,linear:!1,rotate:!1,stepCount:c.StepCount||20,featureDescriptor:c.FeatureDescriptor||""}),c.ActuatorType===qd.ActuatorType.Vibrate?(i[c.Index].vibrate=!0,n.vibrate++):c.ActuatorType===qd.ActuatorType.Oscillate&&(i[c.Index].oscillate=!0,n.oscillate++)}),t.LinearCmd&&t.LinearCmd.forEach(c=>{s=Math.max(s,c.Index),i[c.Index]||(i[c.Index]={index:c.Index,vibrate:!1,oscillate:!1,linear:!1,rotate:!1,stepCount:c.StepCount||20,featureDescriptor:c.FeatureDescriptor||""}),i[c.Index].linear=!0,n.linear++}),t.RotateCmd&&t.RotateCmd.forEach(c=>{s=Math.max(s,c.Index),i[c.Index]||(i[c.Index]={index:c.Index,vibrate:!1,oscillate:!1,linear:!1,rotate:!1,stepCount:c.StepCount||20,featureDescriptor:c.FeatureDescriptor||""}),i[c.Index].rotate=!0,n.rotate++});const a=[];for(let c=0;c<=s;c++)i[c]&&a.push(i[c]);return{actuators:a,counts:n,total:a.length,deviceName:e.name,deviceIndex:e.index,messageTimingGap:e.messageTimingGap||0}});Ot(this,"_resolveActuatorIndex",(e,t)=>{var n,s;if(t!=null)return(s=(n=this.capabilities)==null?void 0:n.actuators[t])!=null&&s[e]?t:null;if(this.defaults[e]!==null)return this.defaults[e];const i=this.getActuatorsByType(e);return i.length>0?i[0]:null});Ot(this,"_resolveDefault",(e,t)=>{var n,s;if(t!==null&&((s=(n=this.capabilities)==null?void 0:n.actuators[t])!=null&&s[e]))return t;const i=this.getActuatorsByType(e);return i.length>0?i[0]:null});Ot(this,"_pickGlobalDefault",()=>this.defaults.linear??this.defaults.vibrate??this.defaults.rotate??this.defaults.oscillate??null);Ot(this,"_setDefaults",()=>{this.capabilities&&(this.defaults.vibrate=this._resolveDefault("vibrate",null),this.defaults.oscillate=this._resolveDefault("oscillate",null),this.defaults.linear=this._resolveDefault("linear",null),this.defaults.rotate=this._resolveDefault("rotate",null),this.defaults.global=this._pickGlobalDefault())});Ot(this,"_resetDevice",()=>{this.selectedDevice=null,this.capabilities=null,this.defaults={vibrate:null,linear:null,rotate:null,oscillate:null,global:null},this._notifyDeviceChanged(null)});Ot(this,"_resetState",()=>{this.isConnected=!1,this.isScanning=!1,this.devices.clear(),this.throttleMap.clear(),this._resetDevice(),this._notifyConnection(!1)});Ot(this,"_onDeviceAdded",e=>{this.devices.set(e.index,e),this._log(`Device added: ${e.name} (${e.index})`),this._notifyDeviceChanged()});Ot(this,"_onDeviceRemoved",e=>{var t;this.devices.delete(e.index),((t=this.selectedDevice)==null?void 0:t.index)===e.index&&this._resetDevice(),this._log(`Device removed: ${e.name} (${e.index})`),this._notifyDeviceChanged()});Ot(this,"_onDisconnect",()=>{this._log("Disconnected from server"),this._resetState()});Ot(this,"_notifyConnection",e=>{this.onConnectionChanged&&this.onConnectionChanged(e)});Ot(this,"_notifyDeviceChanged",(e=void 0)=>{this.onDeviceChanged&&this.onDeviceChanged(e)});Ot(this,"_log",e=>{console.log(`[ButtPlug] ${e}`)});Ot(this,"_error",(e,t=null)=>{if(console.error(`[ButtPlug] ${e}`,t),this.onError){let i="Unknown error";t&&(typeof t=="string"?i=t:t.message?i=t.message:t.toString&&typeof t.toString=="function"&&(i=t.toString())),this.onError(e,i)}});this.client=null,this.connector=null,this.initialized=!1,this.devices=new Map,this.selectedDevice=null,this.capabilities=null,this.isConnected=!1,this.isScanning=!1,this.defaults={vibrate:null,linear:null,rotate:null,oscillate:null,global:null},this.onConnectionChanged=null,this.onDeviceChanged=null,this.onError=null,this.throttleMap=new Map,this.minCommandInterval=16}async init(){if(this.initialized)return this._log("Already initialized, skipping"),!0;try{return this.client=new qd.ButtplugClient("FunPlayer"),this.connector=new qd.ButtplugBrowserWebsocketClientConnector("ws://localhost:12345"),this.client.addListener("deviceadded",this._onDeviceAdded),this.client.addListener("deviceremoved",this._onDeviceRemoved),this.client.addListener("disconnect",this._onDisconnect),this.initialized=!0,this._log("ButtPlug client initialized"),!0}catch(e){return this._error("Initialization failed",e),this.initialized=!1,!1}}async connect(e="ws://localhost:12345"){if(this.isConnected)return!0;if(!await this.init())return this._error("Failed to initialize client before connect"),!1;(!this.connector||this.connector._url!==e)&&(this.connector=new qd.ButtplugBrowserWebsocketClientConnector(e));try{this._log("Connecting to Intiface Central..."),await this.client.connect(this.connector),this.isConnected=!0;const i=this.client.devices;return i.forEach(n=>{this.devices.set(n.index,n)}),this._log(`Connected with ${i.length} devices`),this._notifyConnection(!0),!0}catch(i){return this._error("Connection failed",i),!1}}async disconnect(){if(this.isConnected){try{this.client&&await this.client.disconnect()}catch(e){this._error("Disconnect error",e)}this._resetState()}}async cleanup(){if(this.isConnected&&this.client)try{await this.client.stopAllDevices()}catch(e){this._error("Stop all devices failed during cleanup",e)}if(this.isConnected&&this.client)try{await this.client.disconnect()}catch(e){this._error("Disconnect failed during cleanup",e)}this.client&&(this.client.removeAllListeners(),this.client=null),this.connector=null,this.throttleMap.clear(),this.initialized=!1,this.isConnected=!1,this.isScanning=!1,this.devices.clear(),this._resetDevice()}async scan(e=5e3){if(!this.isConnected||this.isScanning)return[];try{this.isScanning=!0;const t=this.devices.size;this._log("Starting device scan..."),await this.client.startScanning(),await new Promise(s=>setTimeout(s,e)),await this.client.stopScanning();const i=this.devices.size-t;return this._log(`Scan complete: ${i} new devices found`),Array.from(this.devices.values()).slice(-i)}catch(t){return this._error("Scan failed",t),[]}finally{this.isScanning=!1}}getDevices(){return Array.from(this.devices.values())}selectDevice(e){if(e==null)return this._resetDevice(),!0;const t=this.devices.get(e);return t?(this.selectedDevice=t,this.capabilities=this._buildCapabilities(t),this._setDefaults(),this._log(`Selected device: ${t.name} (${e})`),this._notifyDeviceChanged(t),!0):(this._error(`Device ${e} not found`),!1)}getSelected(){return this.selectedDevice}getCapabilities(){return this.capabilities}getDeviceInfo(e=null){const t=e!==null?this.devices.get(e):this.selectedDevice;return t?{index:t.index,name:t.name,displayName:t.displayName,messageTimingGap:t.messageTimingGap,connected:!0,capabilities:e===null&&this.selectedDevice===t?this.capabilities:this._buildCapabilities(t)}:null}async vibrate(e,t=null){return this._sendScalarCommand(qd.ActuatorType.Vibrate,e,t)}async oscillate(e,t=null){return this._sendScalarCommand(qd.ActuatorType.Oscillate,e,t)}async linear(e,t=100,i=null){if(!this.selectedDevice)throw new Error("No device selected");if(this._resolveActuatorIndex("linear",i)===null)throw new Error("No linear actuator available");try{const s=Math.max(0,Math.min(1,e)),a=Math.max(1,Math.min(2e4,t));return await this.selectedDevice.linear([[s,a]]),!0}catch(s){return this._error("Linear command failed",s),!1}}async rotate(e,t=null){if(!this.selectedDevice)throw new Error("No device selected");if(this._resolveActuatorIndex("rotate",t)===null)throw new Error("No rotate actuator available");try{const n=Math.abs(e),s=e>=0;return await this.selectedDevice.rotate([[n,s]]),!0}catch(n){return this._error("Rotate command failed",n),!1}}async sendDefault(e,t=100){if(this.defaults.global===null)throw new Error("No default actuator set");const i=this.getActuatorType(this.defaults.global);switch(i){case"vibrate":return this.vibrate(e,this.defaults.global);case"oscillate":return this.oscillate(e,this.defaults.global);case"linear":return this.linear(e,t,this.defaults.global);case"rotate":return this.rotate(e,this.defaults.global);default:throw new Error(`Unknown actuator type: ${i}`)}}async stopAll(){if(!(!this.isConnected||!this.client))try{await this.client.stopAllDevices(),this._log("All devices stopped")}catch(e){this._error("Stop all failed",e)}}async sendThrottled(e,t,i,n={}){const s=Date.now(),a=`${e}-${i}`,c=this.throttleMap.get(a)||0;if(s-c<this.minCommandInterval&&!n.force)return!0;this.throttleMap.set(a,s);try{switch(e){case"vibrate":return await this.vibrate(t,i);case"oscillate":return await this.oscillate(t,i);case"linear":return await this.linear(t,n.duration||100,i);case"rotate":return await this.rotate(t,i);default:return this._error(`Unknown command type: ${e}`),!1}}catch(h){return this._error(`Throttled ${e} command failed`,h),!1}}async getBattery(e=null){const t=e!==null?this.devices.get(e):this.selectedDevice;if(!t||!t.hasBattery)return null;try{return await t.battery()}catch(i){return this._error("Battery read failed",i),null}}async getRSSI(e=null){const t=e!==null?this.devices.get(e):this.selectedDevice;if(!t||!t.hasRssi)return null;try{return await t.rssi()}catch(i){return this._error("RSSI read failed",i),null}}setDefaults(e=null,t=null,i=null,n=null,s=null){return this.capabilities?(this.defaults.vibrate=this._resolveDefault("vibrate",e),this.defaults.linear=this._resolveDefault("linear",t),this.defaults.rotate=this._resolveDefault("rotate",i),this.defaults.oscillate=this._resolveDefault("oscillate",n),this.defaults.global=s!==null?s:this._pickGlobalDefault(),!0):!1}getDefaults(){return{...this.defaults}}getStatus(){return{isConnected:this.isConnected,isScanning:this.isScanning,deviceCount:this.devices.size,selectedDevice:this.selectedDevice?{index:this.selectedDevice.index,name:this.selectedDevice.name}:null,capabilities:this.capabilities,defaults:this.getDefaults()}}getActuatorType(e){if(!this.capabilities||!this.capabilities.actuators[e])return null;const t=this.capabilities.actuators[e];return t.vibrate?"vibrate":t.oscillate?"oscillate":t.linear?"linear":t.rotate?"rotate":null}getActuatorsByType(e){return this.capabilities?this.capabilities.actuators.map((t,i)=>t[e]?i:null).filter(t=>t!==null):[]}}class YY{constructor(){this.data=null,this.channels=new Map,this.duration=0,this.options=new Map,this.globalOffset=0,this.interpolationCache=new Map,this.seekThreshold=100,this.defaults={enabled:!0,scale:1,timeOffset:0,invert:!1,actuatorIndex:null}}load(e){try{return this.data=typeof e=="string"?JSON.parse(e):e,this._extractChannels(),this._calculateDuration(),this._initOptions(),this._initInterpolationCache(),console.log(`Loaded: ${this.getChannels().length} channels, ${this.duration.toFixed(2)}s`),!0}catch(t){return console.error("Load failed:",t),this._reset(),!1}}getChannels(){return Array.from(this.channels.keys())}hasChannel(e){return this.channels.has(e)}getActionCount(e){var t;return((t=this.channels.get(e))==null?void 0:t.length)||0}getDuration(){return this.duration}setGlobalOffset(e){this.globalOffset=typeof e=="number"?e:0,this._clearInterpolationCache()}getGlobalOffset(){return this.globalOffset}setOptions(e,t){if(!this.hasChannel(e))return!1;const n={...this.options.get(e)||{...this.defaults},...t};return this._validateOptions(n)?(this.options.set(e,n),t.timeOffset!==void 0&&this._clearChannelCache(e),!0):!1}getOptions(e){return this.hasChannel(e)?this.options.get(e)||{...this.defaults}:null}getAllOptions(){const e={};for(const t of this.getChannels())e[t]=this.getOptions(t);return e}resetOptions(e=null){if(e===null){for(const t of this.getChannels())this.options.set(t,{...this.defaults});this._clearInterpolationCache()}else this.hasChannel(e)&&(this.options.set(e,{...this.defaults}),this._clearChannelCache(e))}interpolateAt(e,t="pos"){const i=this.channels.get(t);if(!(i!=null&&i.length))return null;const n=this.getOptions(t);if(!n.enabled)return null;const s=this.globalOffset+(n.timeOffset||0),a=(e+s)*1e3,c=this._interpolateRawOptimized(a,i,t);return c!==null?this._processValue(c,n):null}interpolateAll(e){const t={};for(const i of this.channels.keys()){const n=this.interpolateAt(e,i);n!==null&&(t[i]=n)}return t}interpolateToActuators(e){const t={};for(const i of this.channels.keys()){const n=this.interpolateAt(e,i);if(n!==null){const s=this.getOptions(i).actuatorIndex;s!==null&&(t[s]=n)}}return t}_interpolateRawOptimized(e,t,i){const n=Math.max(0,Math.min(this.duration*1e3,e));if(t.length===1)return t[0].value;let s=this.interpolationCache.get(i);if(s||(s={leftIndex:0,rightIndex:1,lastTime:-1},this.interpolationCache.set(i,s)),s.lastTime>=0&&Math.abs(n-s.lastTime)>this.seekThreshold){const{leftIndex:v,rightIndex:b}=this._findBoundsAfterSeek(n,t,s);s.leftIndex=v,s.rightIndex=b}else this._slideBounds(n,t,s);if(s.lastTime=n,s.leftIndex<0||s.rightIndex>=t.length)return console.warn(`Invalid cache bounds for channel ${i}:`,s),this._fallbackInterpolation(n,t);const c=t[s.leftIndex],h=t[s.rightIndex];if(c.time===n)return c.value;if(h.time===n)return h.value;if(n<=c.time)return c.value;if(n>=h.time)return h.value;const m=(n-c.time)/(h.time-c.time);return c.value+(h.value-c.value)*m}_slideBounds(e,t,i){for(;i.rightIndex<t.length-1&&e>t[i.rightIndex].time;)i.leftIndex=i.rightIndex,i.rightIndex++;for(;i.leftIndex>0&&e<t[i.leftIndex].time;)i.rightIndex=i.leftIndex,i.leftIndex--;i.leftIndex>=i.rightIndex&&(i.leftIndex>0?(i.rightIndex=i.leftIndex,i.leftIndex--):i.rightIndex<t.length-1&&(i.leftIndex=i.rightIndex,i.rightIndex++))}_findBoundsAfterSeek(e,t,i){var v,b;const n=((v=t[i.leftIndex])==null?void 0:v.time)||-1,s=((b=t[i.rightIndex])==null?void 0:b.time)||1/0;if(e>=n&&e<=s)return{leftIndex:i.leftIndex,rightIndex:i.rightIndex};let a=0,c=t.length-1;for(;a<=c;){const x=Math.floor((a+c)/2),C=t[x].time;if(C===e)return{leftIndex:x,rightIndex:Math.min(x+1,t.length-1)};C<e?a=x+1:c=x-1}const h=Math.max(0,c),m=Math.min(a,t.length-1);return{leftIndex:h,rightIndex:m}}_fallbackInterpolation(e,t){console.warn("Using fallback interpolation");let i=0,n=t.length-1;for(;i<=n;){const h=Math.floor((i+n)/2),m=t[h].time;if(m===e)return t[h].value;m<e?i=h+1:n=h-1}if(n<0)return t[0].value;if(i>=t.length)return t[t.length-1].value;const s=t[n],a=t[i],c=(e-s.time)/(a.time-s.time);return s.value+(a.value-s.value)*c}_initInterpolationCache(){this.interpolationCache.clear()}_clearInterpolationCache(){this.interpolationCache.clear()}_clearChannelCache(e){this.interpolationCache.delete(e)}resetInterpolationCache(e=null){e===null?this._clearInterpolationCache():this._clearChannelCache(e)}autoMapChannels(e=null){const t=this.getChannels();if(t.length===0)return{mapped:0,total:0,mode:"no channels"};let i=0;const n=!e||!e.actuators||e.actuators.length===0;t.forEach((a,c)=>{const h=a.toLowerCase();let m=null;n?m=c%4:m=this._getSmartActuatorMapping(h,e),m!==null&&(this.setOptions(a,{actuatorIndex:m}),i++)});const s=n?"virtual actuators":"device actuators";return{mapped:i,total:t.length,mode:s}}_getSmartActuatorMapping(e,t){return e.includes("vibrat")||e.includes("vibe")?this._getFirstActuatorOfType("vibrate",t):e.includes("linear")||e.includes("stroke")||e.includes("pos")?this._getFirstActuatorOfType("linear",t):e.includes("rotat")||e.includes("twist")?this._getFirstActuatorOfType("rotate",t):e.includes("oscillat")?this._getFirstActuatorOfType("oscillate",t):this._getFirstActuatorOfType("linear",t)||this._getFirstActuatorOfType("vibrate",t)||this._getFirstActuatorOfType("oscillate",t)||this._getFirstActuatorOfType("rotate",t)}_getFirstActuatorOfType(e,t){if(!(t!=null&&t.actuators))return null;for(let i=0;i<t.actuators.length;i++)if(t.actuators[i][e])return i;return null}getChannelMetadata(e){var t;return((t=this.channelMetadata)==null?void 0:t.get(e))||{}}getAllChannelMetadata(){if(!this.channelMetadata)return{};const e={};for(const[t,i]of this.channelMetadata.entries())e[t]=i;return e}getChannelSuggestedActuator(e){const t=this.getChannelMetadata(e);return t.actuatorHint!==void 0?t.actuatorHint:{linear:0,vibrate:1,rotate:2,oscillate:3}[t.type]||null}enable(e,t=!0){return this.setOptions(e,{enabled:t})}setScale(e,t){return this.setOptions(e,{scale:t})}setOffset(e,t){return this.setOptions(e,{timeOffset:t})}setInvert(e,t){return this.setOptions(e,{invert:t})}setActuator(e,t){return this.setOptions(e,{actuatorIndex:t})}getDebugInfo(){if(!this.data)return{loaded:!1};const e={};for(const[t,i]of this.channels.entries()){const n=i.map(c=>c.value),s=this.interpolationCache.get(t),a=this.getChannelMetadata(t);e[t]={count:i.length,timeRange:i.length>0?[i[0].time,i[i.length-1].time]:null,valueRange:n.length>0?[Math.min(...n),Math.max(...n)]:null,options:this.getOptions(t),metadata:a,suggestedActuator:this.getChannelSuggestedActuator(t),cache:s?{leftIndex:s.leftIndex,rightIndex:s.rightIndex,lastTime:s.lastTime}:null}}return{loaded:!0,duration:this.duration,globalOffset:this.globalOffset,channels:e,cacheStats:{activeCaches:this.interpolationCache.size,seekThreshold:this.seekThreshold}}}_extractChannels(){var t,i;this.channels.clear();const e=this._extractMetadata();if((t=this.data.actions)!=null&&t.length&&this._processActions("pos",this.data.actions,e),this._extractMultiAxisChannels(e),this.data.tracks){for(const[n,s]of Object.entries(this.data.tracks))if((i=s.actions)!=null&&i.length){const a={...e,...s.metadata};this._processActions(n,s.actions,a)}}if(this.channels.size===0)throw new Error("No valid channels found")}_extractMetadata(){var t,i,n,s,a,c,h,m,v,b;return{title:this.data.title||((t=this.data.metadata)==null?void 0:t.title),creator:this.data.creator||((i=this.data.metadata)==null?void 0:i.creator),description:this.data.description||((n=this.data.metadata)==null?void 0:n.description),duration:this.data.duration||((s=this.data.metadata)==null?void 0:s.duration),axes:this.data.axes||((a=this.data.metadata)==null?void 0:a.axes)||{},channels:this.data.channels||((c=this.data.metadata)==null?void 0:c.channels)||{},actuators:this.data.actuators||((h=this.data.metadata)==null?void 0:h.actuators)||{},device:this.data.device||((m=this.data.metadata)==null?void 0:m.device),deviceType:this.data.deviceType||((v=this.data.metadata)==null?void 0:v.deviceType),mapping:this.data.mapping||((b=this.data.metadata)==null?void 0:b.mapping)||{}}}_extractMultiAxisChannels(e){for(const[t,i]of Object.entries(this.data))if(this._isActionArray(i)){if(t==="actions")continue;const n=this._analyzeChannelFromMetadata(t,i,e);this._processActions(n.name,i,{...e,...n.metadata})}}_isActionArray(e){return Array.isArray(e)&&e.length>0&&e.every(t=>typeof t=="object"&&t!==null&&(t.at!==void 0||t.t!==void 0||t.time!==void 0))}_analyzeChannelFromMetadata(e,t,i){var c,h;let n=e,s="unknown",a=null;if(i.channels&&i.channels[e]){const m=i.channels[e];n=m.name||m.displayName||e,s=m.type||m.actuatorType,a=m.actuator||m.actuatorIndex}else if(i.mapping&&i.mapping[e]){const m=i.mapping[e];n=m.name||e,s=m.type,a=m.actuator}else{const m=this._heuristicChannelAnalysis(e,t);n=m.name,s=m.type}return{name:n,metadata:{type:s,actuatorHint:a,originalField:e,source:(c=i.channels)!=null&&c[e]?"metadata":(h=i.mapping)!=null&&h[e]?"mapping":"heuristic"}}}_heuristicChannelAnalysis(e,t){const i=e.toLowerCase(),n={linear:/^(pos|position|stroke|linear|up|down|vertical|y)$/i,vibrate:/^(vib|vibr|vibrat|buzz|rumble|shake)$/i,rotate:/^(rot|rotat|twist|spin|turn|roll|angle|pitch|yaw)$/i,oscillate:/^(osc|oscill|swing|wave|sway)$/i,squeeze:/^(squeeze|constrict|pressure|grip|clamp)$/i,suck:/^(suck|suction|vacuum|pump)$/i,x_axis:/^(x|horizontal|left|right|lateral)$/i,z_axis:/^(z|depth|forward|back|front|rear)$/i},s=this._analyzeActionValues(t);for(const[a,c]of Object.entries(n))if(c.test(i))return{name:e,type:a.replace("_axis",""),confidence:"high",valueRange:s.range,isBipolar:s.isBipolar};return s.isBipolar?{name:e,type:"rotate",confidence:"low"}:{name:e,type:"linear",confidence:"low"}}_analyzeActionValues(e){if(e.length===0)return{range:[0,0],isBipolar:!1};const t=e.map(c=>c.pos!==void 0?c.pos:c.v!==void 0?c.v:c.value!==void 0?c.value:c.val!==void 0?c.val:c.position!==void 0?c.position:c.intensity!==void 0?c.intensity:0).filter(c=>typeof c=="number");if(t.length===0)return{range:[0,0],isBipolar:!1};const i=Math.min(...t),n=Math.max(...t),s=i<0,a=n>0;return{range:[i,n],isBipolar:s&&a,span:n-i}}_processActions(e,t,i={}){const n=[],s=i.type==="rotate"||this._isRotateChannel(e),a=[];for(const b of t){const x=b.at||b.t||b.time;let C;s?C=this._extractRotateValue(b):C=this._extractActionValue(b,i),!(typeof x!="number"||typeof C!="number")&&a.push({time:x,value:C})}if(a.length===0)return;const{normalizedValues:c,detectedConvention:h}=this._detectAndNormalize(a,s),m=i.source?` (${i.source})`:"",v=i.type?` [${i.type}]`:"";console.log(`Channel "${e}"${v}: ${h} (${a.length} actions)${m}`);for(const{time:b,value:x}of c)n.push({time:b,value:x});n.length>0&&(n.sort((b,x)=>b.time-x.time),this.channels.set(e,n),this.channelMetadata||(this.channelMetadata=new Map),this.channelMetadata.set(e,i))}_extractActionValue(e,t={}){if(t.valueField&&e[t.valueField]!==void 0)return e[t.valueField];const i=["pos","position","v","val","value","intensity","power","speed","velocity","amplitude","magnitude","level","strength"];for(const n of i)if(e[n]!==void 0)return e[n];for(const[n,s]of Object.entries(e))if(typeof s=="number"&&!["at","t","time"].includes(n))return console.warn(`Using fallback field "${n}" for action value`),s;return 0}_detectAndNormalize(e,t){if(e.length===0)return{normalizedValues:[],detectedConvention:"empty"};const i=e.map(h=>Math.abs(h.value)),n=Math.max(...i),s=n>0?1/n:1,a=n>0?`max=${n.toFixed(2)} -> factor=${s.toFixed(4)}`:"all zeros";return{normalizedValues:e.map(({time:h,value:m})=>{let v=m*s;return t?v=Math.max(-1,Math.min(1,v)):v=Math.max(0,Math.min(1,v)),{time:h,value:v}}),detectedConvention:a}}_isRotateChannel(e){return/rotate|rotation|twist|spin|turn/i.test(e)}_extractRotateValue(e){if(e.pos!==void 0)return e.pos;if(e.rotate!==void 0)return e.rotate;if(e.speed!==void 0&&e.clockwise!==void 0){const t=Math.abs(e.speed);return e.clockwise?t:-t}return e.v!==void 0?e.v:0}_calculateDuration(){let e=0;for(const t of this.channels.values())t.length>0&&(e=Math.max(e,t[t.length-1].time));this.duration=e/1e3}_initOptions(){this.options.clear();for(const e of this.getChannels())this.options.set(e,{...this.defaults})}_validateOptions(e){return typeof e.enabled=="boolean"&&typeof e.scale=="number"&&e.scale>=0&&e.scale<=5&&typeof e.timeOffset=="number"&&Math.abs(e.timeOffset)<=10&&typeof e.invert=="boolean"&&(e.actuatorIndex===null||typeof e.actuatorIndex=="number"&&e.actuatorIndex>=0)}_processValue(e,t){let i=e;return t.invert&&(i=1-i),i*=t.scale,Math.max(0,Math.min(1,i))}_reset(){var e;this.data=null,this.channels.clear(),this.options.clear(),this.duration=0,this._clearInterpolationCache(),(e=this.channelMetadata)==null||e.clear()}reset(){this._reset()}}class QY extends Mf.Component{constructor(t){super(t);Ot(this,"updateFromProps",()=>{const{playlist:t,currentIndex:i,mediaPlayerRef:n}=this.props;let s=i||-1;if(s===-1&&(n!=null&&n.current)){const c=n.current.getPlaylistInfo();c&&c.currentIndex>=0&&(s=c.currentIndex)}const a=t||[];(this.state.playlist!==a||this.state.currentIndex!==s)&&this.setState({playlist:a,currentIndex:s})});Ot(this,"handleItemClick",t=>{const{mediaPlayerRef:i}=this.props;if(!(i!=null&&i.current)){console.warn("PlaylistComponent: No MediaPlayer reference");return}i.current.goToItem(t)||console.error("PlaylistComponent: Failed to go to item",t)});Ot(this,"generateFallbackThumbnail",(t,i)=>{let n="",s="#6B7280";if(t.media){const c=t.media.toLowerCase();(c.includes("audio")||[".mp3",".wav",".ogg",".m4a",".aac"].some(h=>c.includes(h)))&&(n="",s="#10B981")}else t.funscript?(n="",s="#8B5CF6"):t.duration&&(n="",s="#F59E0B");const a=`<svg width="48" height="32" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="32" fill="${s}" rx="4"/><text x="24" y="20" text-anchor="middle" fill="white" font-size="16" font-family="system-ui">${n}</text></svg>`;return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(a)}`});Ot(this,"getItemTitle",(t,i)=>{if(t.title)return t.title;if(t.media){if(t.media.startsWith("data:")){const s=t.media.match(/data:([^;]+)/);return`Uploaded ${(s?s[1]:"unknown").split("/")[0]}`}return t.media.split("/").pop().split(".")[0]||`Item ${i+1}`}return t.funscript&&typeof t.funscript=="string"?t.funscript.startsWith("data:")?"Uploaded funscript":t.funscript.split("/").pop().split(".")[0]||`Haptic ${i+1}`:`Item ${i+1}`});Ot(this,"getItemInfo",t=>{const i=[];if(t.media_type)i.push(t.media_type.toUpperCase());else if(t.media)if(t.media.startsWith("data:"))i.push("UPLOADED");else{const n=t.media.split(".").pop().toUpperCase();i.push(n)}if(t.duration){const n=Math.floor(t.duration/60),s=Math.floor(t.duration%60);i.push(`${n}:${s.toString().padStart(2,"0")}`)}return t.funscript&&i.push(""),i.join("  ")});this.state={currentIndex:-1,playlist:[]}}componentDidMount(){this.updateFromProps()}componentDidUpdate(t){const i=t.playlist!==this.props.playlist,n=t.currentIndex!==this.props.currentIndex;(i||n)&&this.updateFromProps()}render(){const{playlist:t,currentIndex:i}=this.state;return!t||t.length<=1?null:Lt.jsxs("div",{className:"fp-playlist-column",children:[Lt.jsx("div",{className:"fp-playlist-header",children:Lt.jsxs("span",{className:"fp-label",children:["Playlist (",t.length,")"]})}),Lt.jsx("div",{className:"fp-playlist-items",children:t.map((n,s)=>Lt.jsxs("div",{className:`fp-playlist-item ${s===i?"active":""}`,onClick:()=>this.handleItemClick(s),title:n.media_info||this.getItemTitle(n,s),children:[Lt.jsx("div",{className:"fp-item-thumbnail",children:Lt.jsx("img",{src:n.poster||this.generateFallbackThumbnail(n,s),alt:this.getItemTitle(n,s),onLoad:()=>console.log(` Thumbnail loaded for item ${s}`),onError:a=>{console.warn(` Thumbnail failed to load for item ${s}, using fallback`),a.target.src=this.generateFallbackThumbnail(n,s)}})}),Lt.jsxs("div",{className:"fp-item-content",children:[Lt.jsx("div",{className:"fp-item-title",children:this.getItemTitle(n,s)}),Lt.jsx("div",{className:"fp-item-info",children:this.getItemInfo(n)})]})]},s))})]})}}class KY extends Mf.Component{constructor(t){super(t);Ot(this,"getButtplugState",()=>{var i;const t=(i=this.props.buttplugRef)==null?void 0:i.current;return{isConnected:(t==null?void 0:t.isConnected)||!1,devices:(t==null?void 0:t.getDevices())||[],selectedDevice:t==null?void 0:t.getSelected(),capabilities:t==null?void 0:t.getCapabilities(),isScanning:(t==null?void 0:t.isScanning)||!1}});Ot(this,"getFunscriptState",()=>{var i;const t=(i=this.props.funscriptManagerRef)==null?void 0:i.current;return{channels:(t==null?void 0:t.getChannels())||[],duration:(t==null?void 0:t.getDuration())||0}});Ot(this,"handleAutoConnect",async()=>{var i,n,s,a,c,h,m,v,b,x,C,B,P,N,ae,X,de,ge,ue;const t=(i=this.props.buttplugRef)==null?void 0:i.current;if(!(!t||this.state.isAutoConnecting)){this.setState({isAutoConnecting:!0}),(s=(n=this.props).onStatusChange)==null||s.call(n,"Connecting to Intiface...");try{if(!await t.connect()){(c=(a=this.props).onStatusChange)==null||c.call(a,"Failed to connect to Intiface");return}(m=(h=this.props).onStatusChange)==null||m.call(h,"Scanning for devices...");const fe=await t.scan(3e3);if(!fe||fe.length===0){(b=(v=this.props).onStatusChange)==null||b.call(v,"No devices found");return}if((C=(x=this.props).onStatusChange)==null||C.call(x,`Found ${fe.length} device(s), selecting first...`),!await t.selectDevice(fe[0].index)){(P=(B=this.props).onStatusChange)==null||P.call(B,"Failed to select device");return}(ae=(N=this.props).onAutoConnect)==null||ae.call(N);const ie=fe[0].name||"Unknown device";(de=(X=this.props).onStatusChange)==null||de.call(X,`Connected to ${ie} and auto-mapped channels`),this.forceUpdate()}catch(be){console.error("AutoConnect failed:",be),(ue=(ge=this.props).onStatusChange)==null||ue.call(ge,"AutoConnect failed")}finally{this.setState({isAutoConnecting:!1})}}});Ot(this,"handleDisconnect",async()=>{var i,n,s;const t=(i=this.props.buttplugRef)==null?void 0:i.current;if(t)try{await t.disconnect(),this.forceUpdate(),(s=(n=this.props).onStatusChange)==null||s.call(n,"Disconnected from Intiface")}catch(a){console.error("Disconnect failed:",a)}});Ot(this,"handleDeviceChange",async t=>{var n,s,a,c,h;const i=(n=this.props.buttplugRef)==null?void 0:n.current;if(i)try{if(await i.selectDevice(t)&&(this.forceUpdate(),(a=(s=this.props).onDeviceSelect)==null||a.call(s,t),t!==null)){const b=this.getButtplugState().devices.find(x=>x.index===t);(h=(c=this.props).onStatusChange)==null||h.call(c,`Selected: ${(b==null?void 0:b.name)||"Unknown device"}`)}}catch(m){console.error("Device selection failed:",m)}});this.state={isAutoConnecting:!1}}render(){const{isConnected:t,selectedDevice:i,devices:n}=this.getButtplugState(),{channels:s}=this.getFunscriptState(),{isAutoConnecting:a}=this.state;return Lt.jsxs("div",{className:"fp-section-compact fp-layout-horizontal",children:[Lt.jsxs("div",{className:"fp-layout-row fp-flex",children:[Lt.jsx("span",{className:"fp-status-dot",children:t?"":""}),Lt.jsx("span",{className:"fp-label fp-device-name",children:(i==null?void 0:i.name)||"No device"}),s.length===0&&Lt.jsx("span",{className:"fp-unit",style:{opacity:.5},children:"No haptic"})]}),Lt.jsxs("div",{className:"fp-layout-row fp-no-shrink",children:[t?Lt.jsx("button",{className:"fp-btn fp-btn-primary",onClick:this.handleDisconnect,children:" Disconnect"}):Lt.jsx("button",{className:"fp-btn fp-btn-primary",onClick:this.handleAutoConnect,disabled:a||s.length===0,title:s.length===0?"Load funscript first":"Connect to Intiface Central",children:a?Lt.jsx(Lt.Fragment,{children:" Connecting..."}):Lt.jsx(Lt.Fragment,{children:" Connect"})}),Lt.jsxs("select",{className:"fp-input fp-select fp-min-width",value:(i==null?void 0:i.index)??"",onChange:c=>{const h=c.target.value===""?null:parseInt(c.target.value);this.handleDeviceChange(h)},disabled:s.length===0,title:s.length===0?"Load funscript first":"Select device",children:[Lt.jsx("option",{value:"",children:"Virtual"}),n.map(c=>Lt.jsx("option",{value:c.index,children:c.name},c.index))]}),this.props.onToggleSettings&&s.length>0&&Lt.jsx("button",{className:"fp-btn fp-btn-ghost fp-chevron",onClick:this.props.onToggleSettings,children:this.props.isSettingsExpanded?"":""})]})]})}}class ZY extends Mf.Component{constructor(t){super(t);Ot(this,"updateChannelOption",(t,i)=>{const{channel:n,funscriptManagerRef:s,onSettingsChange:a}=this.props,c=s==null?void 0:s.current;c&&(c.setOptions(n,{[t]:i}),a==null||a(n,t,i))});Ot(this,"resetChannel",()=>{const{channel:t,funscriptManagerRef:i,onSettingsChange:n}=this.props,s=i==null?void 0:i.current;s&&(s.resetOptions(t),n==null||n(t,"reset",null))});Ot(this,"getChannelOptions",()=>{const{channel:t,funscriptManagerRef:i}=this.props,n=i==null?void 0:i.current;return(n==null?void 0:n.getOptions(t))||{}});Ot(this,"getActuatorOptions",()=>{const{capabilities:t}=this.props;return t&&t.actuators.length>0?t.actuators.map((i,n)=>{const s=[];return i.vibrate&&s.push("vibrate"),i.oscillate&&s.push("oscillate"),i.linear&&s.push("linear"),i.rotate&&s.push("rotate"),{index:n,label:`#${n} (${s.join(", ")})`,value:n}}):[{index:0,label:"#0 (linear)",value:0},{index:1,label:"#1 (vibrate)",value:1},{index:2,label:"#2 (rotate)",value:2},{index:3,label:"#3 (oscillate)",value:3}]});Ot(this,"handleToggleExpanded",()=>{this.setState({isExpanded:!this.state.isExpanded},()=>{this.props.onResize&&this.props.onResize()})});this.state={isExpanded:!1}}renderCompactLine(){const{channel:t}=this.props,i=this.getChannelOptions(),n=this.getActuatorOptions(),{isExpanded:s}=this.state;return Lt.jsxs("div",{className:"fp-compact-line",children:[Lt.jsx("span",{className:"fp-badge fp-no-shrink",children:t}),Lt.jsx("label",{className:"fp-toggle",children:Lt.jsx("input",{className:"fp-checkbox",type:"checkbox",checked:i.enabled||!1,onChange:a=>this.updateChannelOption("enabled",a.target.checked)})}),Lt.jsxs("select",{className:"fp-input fp-select fp-flex",value:i.actuatorIndex??"",onChange:a=>{const c=a.target.value===""?null:parseInt(a.target.value);this.updateChannelOption("actuatorIndex",c)},disabled:!i.enabled,children:[Lt.jsx("option",{value:"",children:"None"}),n.map(a=>Lt.jsx("option",{value:a.value,children:a.label},a.index))]}),Lt.jsx("button",{className:"fp-btn fp-btn-ghost fp-chevron",onClick:this.handleToggleExpanded,children:s?"":""})]})}renderExpandedSettings(){if(!this.state.isExpanded)return null;const t=this.getChannelOptions();return Lt.jsxs("div",{className:"fp-expanded fp-layout-column fp-layout-compact",children:[Lt.jsxs("div",{className:"fp-layout-column",children:[Lt.jsxs("label",{className:"fp-label",children:["Scale: ",((t.scale||1)*100).toFixed(0),"%"]}),Lt.jsx("input",{className:"fp-input fp-range",type:"range",min:"0",max:"2",step:"0.01",value:t.scale||1,onChange:i=>this.updateChannelOption("scale",parseFloat(i.target.value)),disabled:!t.enabled})]}),Lt.jsxs("div",{className:"fp-layout-column",children:[Lt.jsxs("label",{className:"fp-label",children:["Time Offset: ",((t.timeOffset||0)*1e3).toFixed(0),"ms"]}),Lt.jsx("input",{className:"fp-input fp-range",type:"range",min:"-0.5",max:"0.5",step:"0.001",value:t.timeOffset||0,onChange:i=>this.updateChannelOption("timeOffset",parseFloat(i.target.value)),disabled:!t.enabled})]}),Lt.jsxs("label",{className:"fp-toggle",children:[Lt.jsx("input",{className:"fp-checkbox",type:"checkbox",checked:t.invert||!1,onChange:i=>this.updateChannelOption("invert",i.target.checked),disabled:!t.enabled}),Lt.jsx("span",{className:"fp-label",children:"Invert Values"})]}),Lt.jsx("button",{className:"fp-btn fp-btn-compact",onClick:this.resetChannel,children:" Reset Channel"})]})}render(){return Lt.jsxs("div",{className:"fp-expandable",children:[this.renderCompactLine(),this.renderExpandedSettings()]})}}class JY extends Mf.Component{constructor(t){super(t);Ot(this,"getFunscriptChannels",()=>{var i;const t=(i=this.props.funscriptManagerRef)==null?void 0:i.current;return(t==null?void 0:t.getChannels())||[]});Ot(this,"getButtplugCapabilities",()=>{var i;const t=(i=this.props.buttplugManagerRef)==null?void 0:i.current;return t==null?void 0:t.getCapabilities()});Ot(this,"getUpdateRate",()=>{var t,i;return((i=(t=this.props).onGetUpdateRate)==null?void 0:i.call(t))||60});Ot(this,"getGlobalOffset",()=>{var i;const t=(i=this.props.funscriptManagerRef)==null?void 0:i.current;return(t==null?void 0:t.getGlobalOffset())||0});Ot(this,"handleToggleExpanded",()=>{this.setState({isExpanded:!this.state.isExpanded},()=>{this.props.onResize&&this.props.onResize()})});Ot(this,"handleAutoMap",()=>{var s,a,c;const t=(s=this.props.funscriptManagerRef)==null?void 0:s.current;if(!t)return;const i=this.getButtplugCapabilities(),n=t.autoMapChannels(i);this.forceUpdate(),(c=(a=this.props).onSettingsChange)==null||c.call(a,null,"autoMap",n)});Ot(this,"handleUpdateRateChange",t=>{var i,n;(n=(i=this.props).onUpdateRateChange)==null||n.call(i,t)});Ot(this,"handleGlobalOffsetChange",t=>{var n,s,a;const i=(n=this.props.funscriptManagerRef)==null?void 0:n.current;i&&(i.setGlobalOffset(t),this.forceUpdate(),(a=(s=this.props).onSettingsChange)==null||a.call(s,null,"globalOffset",t))});Ot(this,"handleChannelSettingsChange",(t,i,n)=>{var a,c,h;const s=(a=this.props.funscriptManagerRef)==null?void 0:a.current;s&&(s.setOptions(t,{[i]:n}),this.forceUpdate(),(h=(c=this.props).onSettingsChange)==null||h.call(c,t,i,n))});this.state={isExpanded:!1}}renderExpandedSettings(){if(!this.state.isExpanded)return null;const t=this.getFunscriptChannels(),i=this.getButtplugCapabilities(),n=this.getUpdateRate(),s=this.getGlobalOffset();return Lt.jsxs("div",{className:"fp-block fp-section",children:[Lt.jsx("div",{className:"fp-layout-horizontal fp-mb-sm",children:Lt.jsx("h6",{className:"fp-title",children:" Global Settings"})}),Lt.jsxs("div",{className:"fp-layout-row fp-mb-lg",children:[Lt.jsxs("div",{className:"fp-layout-column fp-flex",children:[Lt.jsx("label",{className:"fp-label",children:"Update Rate"}),Lt.jsxs("select",{className:"fp-input fp-select",value:n,onChange:a=>this.handleUpdateRateChange(parseInt(a.target.value)),children:[Lt.jsx("option",{value:30,children:"30 Hz"}),Lt.jsx("option",{value:60,children:"60 Hz"}),Lt.jsx("option",{value:90,children:"90 Hz"}),Lt.jsx("option",{value:120,children:"120 Hz"})]})]}),Lt.jsxs("div",{className:"fp-layout-column fp-flex",children:[Lt.jsxs("label",{className:"fp-label",children:["Global Offset (",(s*1e3).toFixed(0),"ms)"]}),Lt.jsxs("div",{className:"fp-layout-row",children:[Lt.jsx("input",{className:"fp-input fp-range fp-flex",type:"range",value:s,onChange:a=>this.handleGlobalOffsetChange(parseFloat(a.target.value)),min:"-1",max:"1",step:"0.01"}),Lt.jsx("input",{className:"fp-input fp-input-number",type:"number",value:s,onChange:a=>this.handleGlobalOffsetChange(parseFloat(a.target.value)||0),step:"0.01",min:"-1",max:"1"})]})]})]}),t.length>0&&Lt.jsxs(Lt.Fragment,{children:[Lt.jsx("div",{className:"fp-divider"}),Lt.jsxs("div",{className:"fp-layout-horizontal fp-mb-sm",children:[Lt.jsx("h6",{className:"fp-title",children:" Channel Mapping"}),Lt.jsxs("button",{className:"fp-btn fp-btn-compact",onClick:this.handleAutoMap,children:["Auto Map All (",t.length,")"]})]}),Lt.jsx("div",{className:"fp-layout-column fp-layout-compact",children:t.map(a=>Lt.jsx(ZY,{channel:a,funscriptManagerRef:this.props.funscriptManagerRef,capabilities:i,onSettingsChange:this.handleChannelSettingsChange,onResize:this.props.onResize},a))})]})]})}render(){const{isExpanded:t}=this.state;return Lt.jsxs("div",{className:"haptic-settings",children:[Lt.jsx(KY,{buttplugRef:this.props.buttplugManagerRef,funscriptManagerRef:this.props.funscriptManagerRef,onStatusChange:this.props.onStatusChange,onAutoConnect:this.handleAutoMap,onDeviceSelect:i=>{i!==null&&this.handleAutoMap()},onToggleSettings:this.handleToggleExpanded,isSettingsExpanded:t}),this.renderExpandedSettings()]})}}class eQ extends Mf.Component{constructor(t){super(t);Ot(this,"initCanvas",()=>{const t=this.canvasRef.current;if(!t)return;this.ctx=t.getContext("2d");const i=t.getBoundingClientRect(),n=window.devicePixelRatio||1;t.width=i.width*n,t.height=i.height*n,this.ctx.scale(n,n),t.style.width=i.width+"px",t.style.height=i.height+"px"});Ot(this,"gaussian",(t,i,n)=>{const s=1/(n*Math.sqrt(2*Math.PI)),a=Math.exp(-Math.pow(t-i,2)/(2*Math.pow(n,2)));return s*a});Ot(this,"calculateSigma",t=>{const{sigmaMin:i,sigmaMax:n}=this.config;return n-t*(n-i)});Ot(this,"getActuatorPosition",(t,i)=>i<=1?.5:(t+1)/(i+1));Ot(this,"getCurrentActuatorData",()=>{var t,i;return((i=(t=this.props).getCurrentActuatorData)==null?void 0:i.call(t))||new Map});Ot(this,"getConfiguredActuatorCount",()=>{const t=this.getCurrentActuatorData();return Math.max(1,t.size)});Ot(this,"calculateNormalizationFactor",t=>{if(this.normalizationCache.has(t))return this.normalizationCache.get(t);const{resolution:i,sigmaMin:n}=this.config;let s=0;for(let c=0;c<=i;c++){const h=c/i;let m=0;for(let v=0;v<t;v++){const b=this.getActuatorPosition(v,t);m+=this.gaussian(h,b,n)}s=Math.max(s,m)}const a=s>0?1/s:1;return this.normalizationCache.set(t,a),a});Ot(this,"getActiveActuators",t=>Array.from(t.entries()).filter(([i,n])=>Math.abs(n.value)>.001));Ot(this,"getActuatorColor",(t,i=1)=>{const n=[[255,0,0],[255,165,0],[255,255,0],[0,255,0],[0,0,255],[128,0,128]],s=t*(n.length-1),a=Math.floor(s),c=s-a,h=n[Math.min(a,n.length-1)],m=n[Math.min(a+1,n.length-1)],v=[h[0]*(1-c)+m[0]*c,h[1]*(1-c)+m[1]*c,h[2]*(1-c)+m[2]*c];return[Math.round(v[0]*i),Math.round(v[1]*i),Math.round(v[2]*i)]});Ot(this,"getRainbowBackgroundColor",t=>{const i=[[255,0,0],[255,165,0],[255,255,0],[0,255,0],[0,0,255],[128,0,128]],n=t*(i.length-1),s=Math.floor(n),a=n-s,c=i[Math.min(s,i.length-1)],h=i[Math.min(s+1,i.length-1)];return[c[0]*(1-a)+h[0]*a,c[1]*(1-a)+h[1]*a,c[2]*(1-a)+h[2]*a]});Ot(this,"calculatePoints",(t,i,n)=>{const s=this.getConfiguredActuatorCount(),a=t.length,{resolution:c,heightScale:h}=this.config,m=this.calculateNormalizationFactor(s),v=[];for(let b=0;b<=c;b++){const x=b/c;let C=0,B=[0,0,0];const P=this.config.rainbowIntensity,N=this.getRainbowBackgroundColor(x);B[0]=N[0]*P,B[1]=N[1]*P,B[2]=N[2]*P,C=P,t.forEach(([ae,X],de)=>{const ge=this.getActuatorPosition(de,a),ue=Math.abs(X.value),be=this.calculateSigma(ue),fe=this.gaussian(x,ge,be)*ue;if(fe>.001){const ve=this.getActuatorColor(ge,ue);B[0]+=ve[0]*fe,B[1]+=ve[1]*fe,B[2]+=ve[2]*fe,C+=fe}}),C>0&&(B=B.map(ae=>Math.round(ae/C))),v.push({x:x*i,y:n-C*m*h*n,intensity:C*m,color:B})}return v});Ot(this,"renderGradientFill",(t,i,n)=>{if(t.length<2)return;this.ctx.beginPath(),this.ctx.moveTo(0,n),t.forEach((a,c)=>{if(c===0)this.ctx.lineTo(a.x,a.y);else{const h=t[c-1],m=(h.x+a.x)/2;this.ctx.quadraticCurveTo(h.x,h.y,m,(h.y+a.y)/2)}}),this.ctx.lineTo(i,n),this.ctx.closePath();const s=this.ctx.createLinearGradient(0,0,i,0);t.forEach((a,c)=>{const h=c/(t.length-1),[m,v,b]=a.color,x=Math.min(1,a.intensity*.8);s.addColorStop(h,`rgba(${m}, ${v}, ${b}, ${x})`)}),this.ctx.fillStyle=s,this.ctx.fill(),this.ctx.shadowColor="rgba(255, 255, 255, 0.2)",this.ctx.shadowBlur=8,this.ctx.strokeStyle="rgba(255, 255, 255, 0.4)",this.ctx.lineWidth=1,this.ctx.stroke(),this.ctx.shadowBlur=0});Ot(this,"renderTrailStroke",(t,i)=>{if(t.length<2)return;this.ctx.save(),this.ctx.globalAlpha=i,this.ctx.beginPath(),t.forEach((s,a)=>{if(a===0)this.ctx.moveTo(s.x,s.y);else{const c=t[a-1],h=(c.x+s.x)/2;this.ctx.quadraticCurveTo(c.x,c.y,h,(c.y+s.y)/2)}});const n=this.ctx.createLinearGradient(0,0,this.canvasRef.current.clientWidth,0);t.forEach((s,a)=>{const c=a/(t.length-1),[h,m,v]=s.color;n.addColorStop(c,`rgb(${h}, ${m}, ${v})`)}),this.ctx.strokeStyle=n,this.ctx.lineWidth=2,this.ctx.stroke(),this.ctx.restore()});Ot(this,"renderCurrentFrame",()=>{const t=this.getCurrentActuatorData(),i=this.getActiveActuators(t);if(i.length===0)return;const n=this.canvasRef.current,s=n.clientWidth,a=n.clientHeight,c=this.calculatePoints(i,s,a);this.renderGradientFill(c,s,a)});Ot(this,"renderTrails",()=>{this.trailHistory.forEach((t,i)=>{const n=this.trailHistory.length-i-1,s=Math.pow(this.config.trailDecay,n),a=this.getActiveActuators(t.actuatorData);if(a.length===0)return;const c=this.canvasRef.current,h=c.clientWidth,m=c.clientHeight,v=this.calculatePoints(a,h,m);this.renderTrailStroke(v,s)})});Ot(this,"startAnimation",()=>{const t=()=>{this.renderFrame(),this.animationId=requestAnimationFrame(t)};this.animationId=requestAnimationFrame(t)});Ot(this,"renderFrame",()=>{if(!this.ctx)return;const t=this.canvasRef.current;if(this.ctx.clearRect(0,0,t.clientWidth,t.clientHeight),this.state.isPlaying&&this.renderTrails(),this.renderCurrentFrame(),this.state.isPlaying){const i={timestamp:performance.now(),actuatorData:this.getCurrentActuatorData()};this.trailHistory.push(i),this.trailHistory.length>this.maxTrailFrames&&this.trailHistory.shift()}});Ot(this,"toggleConfig",()=>{this.setState({showConfig:!this.state.showConfig},()=>{this.props.onResize&&this.props.onResize()})});Ot(this,"updateConfig",(t,i)=>{this.config[t]=i,(t==="sigmaMin"||t==="sigmaMax")&&this.normalizationCache.clear(),this.forceUpdate()});Ot(this,"renderConfigPanel",()=>{if(!this.state.showConfig)return null;const{heightScale:t,sigmaMin:i,sigmaMax:n,rainbowIntensity:s}=this.config;return Lt.jsx("div",{className:"fp-section fp-section-compact",style:{borderTop:"1px solid var(--border-color)",backgroundColor:"var(--background-color)"},children:Lt.jsxs("div",{className:"fp-layout-column fp-layout-compact",children:[Lt.jsxs("div",{className:"fp-layout-row",children:[Lt.jsxs("label",{className:"fp-label fp-no-shrink",style:{minWidth:"80px"},children:["Height: ",(t*100).toFixed(0),"%"]}),Lt.jsx("input",{className:"fp-input fp-range fp-flex",type:"range",min:"0.1",max:"1.0",step:"0.05",value:t,onChange:a=>this.updateConfig("heightScale",parseFloat(a.target.value))})]}),Lt.jsxs("div",{className:"fp-layout-row",children:[Lt.jsxs("label",{className:"fp-label fp-no-shrink",style:{minWidth:"80px"},children:["Sigma Min: ",(i*100).toFixed(1)]}),Lt.jsx("input",{className:"fp-input fp-range fp-flex",type:"range",min:"0.005",max:"0.1",step:"0.005",value:i,onChange:a=>this.updateConfig("sigmaMin",parseFloat(a.target.value))})]}),Lt.jsxs("div",{className:"fp-layout-row",children:[Lt.jsxs("label",{className:"fp-label fp-no-shrink",style:{minWidth:"80px"},children:["Sigma Max: ",(n*100).toFixed(1)]}),Lt.jsx("input",{className:"fp-input fp-range fp-flex",type:"range",min:"0.05",max:"0.3",step:"0.01",value:n,onChange:a=>this.updateConfig("sigmaMax",parseFloat(a.target.value))})]}),Lt.jsxs("div",{className:"fp-layout-row",children:[Lt.jsxs("label",{className:"fp-label fp-no-shrink",style:{minWidth:"80px"},children:["Rainbow: ",(s*100).toFixed(0),"%"]}),Lt.jsx("input",{className:"fp-input fp-range fp-flex",type:"range",min:"0.0",max:"0.5",step:"0.05",value:s,onChange:a=>this.updateConfig("rainbowIntensity",parseFloat(a.target.value))})]})]})})});this.state={isPlaying:!1,showConfig:!1},this.canvasRef=s_.createRef(),this.ctx=null,this.animationId=null,this.trailHistory=[],this.maxTrailFrames=8,this.config={resolution:300,heightScale:.95,trailDecay:.85,sigmaMin:.07,sigmaMax:.15,rainbowIntensity:.15},this.normalizationCache=new Map}componentDidMount(){this.initCanvas(),this.startAnimation()}componentDidUpdate(t){const i=this.props.isPlaying||!1;i!==this.state.isPlaying&&(this.setState({isPlaying:i}),i||(this.trailHistory=[]))}componentWillUnmount(){this.animationId&&cancelAnimationFrame(this.animationId)}render(){return Lt.jsxs("div",{className:"haptic-visualizer",children:[Lt.jsxs("div",{className:"fp-section",style:{position:"relative"},children:[Lt.jsx("canvas",{ref:this.canvasRef,className:"haptic-visualizer-canvas",style:{width:"100%",height:"120px",backgroundColor:"var(--background-color)",border:"1px solid var(--border-color)",borderRadius:"calc(var(--base-radius) * 0.5)",display:"block"}}),Lt.jsx("button",{className:"fp-btn fp-btn-ghost",onClick:this.toggleConfig,style:{position:"absolute",top:"4px",right:"4px",width:"24px",height:"24px",padding:"0",fontSize:"12px",opacity:"0.6",background:"rgba(0,0,0,0.1)",border:"none",borderRadius:"50%"},title:"Configuration",children:""})]}),this.renderConfigPanel()]})}}class tQ extends Mf.Component{constructor(t){super(t);Ot(this,"applyTheme",()=>{const{theme:t}=this.props;if(!t)return;const i=document.querySelector(".fun-player")||document.documentElement;Object.entries(t).forEach(([n,s])=>{const a=this.convertToCssVar(n);i.style.setProperty(a,s)}),t.base&&i.setAttribute("data-theme",t.base)});Ot(this,"convertToCssVar",t=>({primaryColor:"--primary-color",backgroundColor:"--background-color",secondaryBackgroundColor:"--secondary-background-color",textColor:"--text-color",borderColor:"--border-color",fontFamily:"--font-family",baseRadius:"--base-radius",spacing:"--spacing"})[t]||`--${t.replace(/([A-Z])/g,"-$1").toLowerCase()}`);Ot(this,"handlePlaylistUpdate",async()=>{const{playlist:t}=this.props;if(!t||t.length===0){this.setState({playlistItems:[],currentPlaylistIndex:-1,isReady:!0}),this.setStatus("No playlist loaded");return}const i=t.filter(n=>n&&(n.media||n.funscript||n.duration&&n.duration>0));if(i.length===0){this.setState({playlistItems:[],currentPlaylistIndex:-1,isReady:!0}),this.setStatus("No valid items in playlist");return}this.setStatus("Enriching playlist with posters...");try{if(!this.mediaManager){const s=(await rE(async()=>{const{default:a}=await Promise.resolve().then(()=>gY);return{default:a}},void 0,import.meta.url)).default;this.mediaManager=new s}const n=await this.mediaManager.enrichPlaylistWithPosters(i);this.setState({playlistItems:n,currentPlaylistIndex:-1,isReady:!1}),this.setStatus(`Playlist loaded: ${n.length} items with posters`)}catch(n){console.error("Failed to enrich playlist with posters:",n),this.setState({playlistItems:i,currentPlaylistIndex:-1,isReady:!1}),this.setStatus(`Playlist loaded: ${i.length} items (no posters)`)}});Ot(this,"handlePlaylistItemChange",async(t,i)=>{var n;if(console.log("FunPlayer: Playlist item changed to",i,t),this.setState({currentPlaylistIndex:i,isPlaying:!1,currentActuatorData:new Map,isReady:!1}),this.stopHapticLoop(),this.buttplugRef.current&&await this.buttplugRef.current.stopAll(),!t||i===-1){this.setStatus("No valid item to play"),this.setState({isReady:!0});return}this.setStatus(`Loading item ${i+1}...`);try{t.funscript?typeof t.funscript=="object"?await this.loadFunscriptData(t.funscript):await this.loadFunscript(t.funscript):(n=this.funscriptRef.current)==null||n.reset(),this.setState({isReady:!0});const s=t.title||`Item ${i+1}`;this.setStatus(`Ready: ${s}`)}catch(s){this.setError(`Failed to load item ${i+1}`,s)}});Ot(this,"initializeManagers",async()=>{try{console.log("Initializing managers..."),this.buttplugRef.current=new XY,this.buttplugRef.current&&typeof this.buttplugRef.current.init=="function"&&(await this.buttplugRef.current.init(),console.log("ButtPlugManager initialized")),this.funscriptRef.current=new YY,console.log("FunscriptManager created:",this.funscriptRef.current),this.setStatus("Managers initialized"),this.handlePlaylistUpdate()}catch(t){console.error("Manager initialization error:",t),this.setError("Failed to initialize managers",t)}});Ot(this,"loadFunscript",async t=>{var i;try{console.log("Loading funscript from:",t);let n;if(typeof t=="string")if(t.startsWith("http")||t.startsWith("/")){const s=await fetch(t);if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);n=await s.json()}else n=JSON.parse(t);else if(typeof t=="object")n=t;else throw new Error("Invalid funscript source type");if(console.log("Funscript data loaded:",n),this.funscriptRef.current){this.funscriptRef.current.load(n),console.log("Funscript loaded into manager");const s=(i=this.buttplugRef.current)==null?void 0:i.getCapabilities(),a=this.funscriptRef.current.autoMapChannels(s);console.log(`Auto-mapped ${a.mapped}/${a.total} channels to ${a.mode}`)}else throw new Error("FunscriptManager not initialized")}catch(n){throw console.error("Failed to load funscript:",n),n}});Ot(this,"loadFunscriptData",async t=>{var i;try{if(console.log("Loading funscript from data:",t),this.funscriptRef.current){this.funscriptRef.current.load(t),console.log("Funscript loaded into manager");const n=(i=this.buttplugRef.current)==null?void 0:i.getCapabilities(),s=this.funscriptRef.current.autoMapChannels(n);console.log(`Auto-mapped ${s.mapped}/${s.total} channels to ${s.mode}`)}else throw new Error("FunscriptManager not initialized")}catch(n){throw console.error("Failed to load funscript data:",n),n}});Ot(this,"handleMediaLoadEnd",t=>{console.log("Media loaded:",t),this.setState({isReady:!0},()=>{var i;this.setStatus(`Media ready (${(i=t.duration)==null?void 0:i.toFixed(1)}s)`),this.triggerResize()})});Ot(this,"handleMediaError",t=>{console.error("Media error:",t),this.setError("Media loading failed",t)});Ot(this,"handleMediaPlay",()=>{var t;this.hapticTime=((t=this.mediaPlayerRef.current)==null?void 0:t.getTime())||0,this.lastMediaTime=this.hapticTime,this.lastSyncTime=performance.now(),this.setState({isPlaying:!0}),this.hasFunscript()?(this.startHapticLoop(),this.setStatus("Playing with haptics")):this.setStatus("Playing media")});Ot(this,"handleMediaPause",()=>{var t;this.hasFunscript()&&(this.stopHapticLoop(),(t=this.buttplugRef.current)==null||t.stopAll()),this.setState({isPlaying:!1,currentActuatorData:new Map}),this.setStatus("Paused")});Ot(this,"handleMediaEnd",()=>{var t;this.hasFunscript()&&(this.stopHapticLoop(),(t=this.buttplugRef.current)==null||t.stopAll()),this.hapticTime=0,this.lastMediaTime=0,this.setState({isPlaying:!1,currentActuatorData:new Map}),this.setStatus("Item ended")});Ot(this,"handleMediaTimeUpdate",({currentTime:t})=>{if(!this.hasFunscript()||!this.hapticIntervalId)return;const i=performance.now(),n=(i-this.lastSyncTime)/1e3,s=Math.abs(t-this.hapticTime);(s>.05||n>1)&&(this.hapticTime=t,this.lastMediaTime=t,this.lastSyncTime=i,s>.1&&console.warn(`Haptic drift detected: ${(s*1e3).toFixed(1)}ms, resyncing`))});Ot(this,"startHapticLoop",()=>{if(this.hapticIntervalId)return;this.expectedHapticTime=performance.now();const t=1e3/this.state.updateRate,i=()=>{try{const n=performance.now(),s=n-this.expectedHapticTime,a=t/1e3;this.processHapticFrame(a),this.expectedHapticTime+=t;const c=Math.max(0,t-s),h=1e3/this.state.updateRate;h!==t?(this.expectedHapticTime=n+h,this.hapticIntervalId=setTimeout(()=>this.restartWithNewRate(),h)):this.hapticIntervalId=setTimeout(i,c)}catch(n){console.error("Haptic loop error:",n),this.hapticIntervalId=setTimeout(i,t)}};this.hapticIntervalId=setTimeout(i,t)});Ot(this,"restartWithNewRate",()=>{this.hapticIntervalId!==null&&(this.stopHapticLoop(),this.startHapticLoop())});Ot(this,"handleUpdateRateChange",t=>{this.setState({updateRate:t}),this.setStatus(`Update rate changed to ${t}Hz`)});Ot(this,"processHapticFrame",t=>{const i=this.mediaPlayerRef.current,n=this.funscriptRef.current,s=this.buttplugRef.current;if(!i||!n)return;this.hapticTime+=t;const a=this.hapticTime,c=this.getMediaRefreshRate(i),h=this.calculateLinearDuration(t,c),m=n.interpolateToActuators(a),v=new Map;for(const[b,x]of Object.entries(m)){const C=parseInt(b);let B="linear";s&&s.getSelected()&&(B=s.getActuatorType(C)||"linear",this.sendHapticCommand(B,x,h*1e3,C)),v.set(C,{value:x,type:B})}this.setState({currentActuatorData:v})});Ot(this,"getMediaRefreshRate",t=>{switch(t.getState().mediaType){case"playlist":const s=t.getCurrentItem();return!s||!s.sources||s.sources.length===0?this.state.updateRate:(s.sources[0].type||"").startsWith("audio/")?this.state.updateRate:30;case"media":return 30;default:return this.state.updateRate}});Ot(this,"calculateLinearDuration",(t,i)=>{const n=1/i,s=Math.max(t,n)*1.2;return Math.max(.01,Math.min(.1,s))});Ot(this,"sendHapticCommand",async(t,i,n,s)=>{const a=this.buttplugRef.current;if(!(!a||!a.isConnected))try{switch(t){case"vibrate":await a.vibrate(i,s);break;case"oscillate":await a.oscillate(i,s);break;case"linear":await a.linear(i,n,s);break;case"rotate":await a.rotate(i,s);break;default:console.warn(`Unknown haptic command type: ${t}`);break}}catch{}});Ot(this,"stopHapticLoop",()=>{this.hapticIntervalId&&(clearTimeout(this.hapticIntervalId),this.hapticIntervalId=null),this.expectedHapticTime=0,this.lastSyncTime=0});Ot(this,"setStatus",t=>{this.setState({status:t,error:null})});Ot(this,"setError",(t,i=null)=>{console.error(t,i);let n=null;i&&(typeof i=="string"?n=i:i.message?n=i.message:n=String(i)),this.setState({status:t,error:n})});Ot(this,"handleHapticSettingsChange",(t,i,n)=>{switch(i){case"autoMap":this.setStatus(`Auto-mapped ${n.mapped}/${n.total} channels to ${n.mode}`);break;case"globalOffset":this.setStatus(`Global offset set to ${n}s`);break;case"setOptions":t&&this.setStatus(`Updated ${t} settings`);break;default:t&&i&&this.setStatus(`Updated ${t}: ${i}`)}});Ot(this,"triggerResize",()=>{this.props.onResize&&this.props.onResize()});Ot(this,"handleToggleVisualizer",()=>{this.setState({showVisualizer:!this.state.showVisualizer},()=>{this.triggerResize()})});Ot(this,"handleToggleDebug",()=>{this.setState({showDebug:!this.state.showDebug},()=>{this.triggerResize()})});Ot(this,"hasFunscript",()=>this.funscriptRef.current&&this.funscriptRef.current.getChannels().length>0);Ot(this,"cleanup",async()=>{this.stopHapticLoop(),this.buttplugRef.current&&await this.buttplugRef.current.cleanup(),this.funscriptRef.current&&this.funscriptRef.current.reset(),this.setState({isPlaying:!1,currentActuatorData:new Map,status:"Cleaned up",error:null})});Ot(this,"getUpdateRate",()=>this.state.updateRate);this.state={status:"idle",error:null,isReady:!1,updateRate:60,isPlaying:!1,currentActuatorData:new Map,showVisualizer:!1,showDebug:!1,currentPlaylistIndex:-1,playlistItems:[]},this.buttplugRef=s_.createRef(),this.funscriptRef=s_.createRef(),this.mediaPlayerRef=s_.createRef(),this.hapticIntervalId=null,this.expectedHapticTime=0}componentDidMount(){this.applyTheme(),this.initializeManagers()}componentDidUpdate(t){t.theme!==this.props.theme&&this.applyTheme(),t.playlist!==this.props.playlist&&this.handlePlaylistUpdate()}componentWillUnmount(){this.stopHapticLoop(),this.cleanup()}renderHapticSettings(){return Lt.jsx("div",{className:"fp-block fp-block-first haptic-settings-section",children:Lt.jsx(JY,{buttplugManagerRef:this.buttplugRef,funscriptManagerRef:this.funscriptRef,onUpdateRateChange:this.handleUpdateRateChange,onGetUpdateRate:this.getUpdateRate,onSettingsChange:this.handleHapticSettingsChange,onStatusChange:this.setStatus,onResize:this.triggerResize})})}renderMediaPlayer(){const{playlistItems:t}=this.state;return Lt.jsx("div",{className:"fp-block fp-block-middle media-section",children:Lt.jsx(vY,{ref:this.mediaPlayerRef,playlist:t,onPlaylistItemChange:this.handlePlaylistItemChange,onPlay:this.handleMediaPlay,onPause:this.handleMediaPause,onEnd:this.handleMediaEnd,onTimeUpdate:this.handleMediaTimeUpdate,onLoadEnd:this.handleMediaLoadEnd,onError:this.handleMediaError})})}renderHapticVisualizer(){if(!this.state.showVisualizer)return null;const{isPlaying:t}=this.state;return Lt.jsx("div",{className:"fp-block fp-block-middle haptic-visualizer-section",children:Lt.jsx(eQ,{getCurrentActuatorData:()=>this.state.currentActuatorData,isPlaying:t,onResize:this.triggerResize})})}renderStatusBar(){const{status:t,error:i,isReady:n,showVisualizer:s,showDebug:a,currentPlaylistIndex:c,playlistItems:h}=this.state;return Lt.jsx("div",{className:"fp-block fp-block-last status-bar-section",children:Lt.jsxs("div",{className:"fp-section-compact fp-layout-horizontal",children:[Lt.jsxs("div",{className:"fp-layout-row",children:[Lt.jsx("span",{className:`fp-status-dot ${n?"ready":"loading"}`,children:n?"":""}),Lt.jsx("span",{className:"fp-label",children:i?` ${i}`:t})]}),Lt.jsxs("div",{className:"fp-layout-row fp-layout-compact",children:[Lt.jsxs("span",{className:"fp-badge",children:[this.state.updateRate,"Hz"]}),h.length>1&&Lt.jsxs("span",{className:"fp-unit",children:[c+1,"/",h.length]}),this.hasFunscript()&&Lt.jsxs("span",{className:"fp-unit",children:[this.funscriptRef.current.getChannels().length," channels"]}),Lt.jsx("button",{className:"fp-btn fp-btn-ghost fp-chevron",onClick:this.handleToggleVisualizer,title:s?"Hide Visualizer":"Show Visualizer",children:s?"":""}),Lt.jsx("button",{className:"fp-btn fp-btn-ghost fp-chevron",onClick:this.handleToggleDebug,title:a?"Hide Debug":"Show Debug",children:a?"":""})]})]})})}renderDebugInfo(){var m,v;if(!this.state.showDebug)return null;const t=(m=this.funscriptRef.current)==null?void 0:m.getDebugInfo(),i=(v=this.buttplugRef.current)==null?void 0:v.getSelected(),{updateRate:n,currentActuatorData:s,playlistItems:a,currentPlaylistIndex:c}=this.state,h=s||new Map;return Lt.jsx("div",{className:"fp-block fp-block-standalone debug-info",children:Lt.jsxs("div",{className:"fp-section debug-content",children:[a.length>0&&Lt.jsxs("div",{className:"playlist-info fp-mb-sm",children:[Lt.jsx("h4",{className:"fp-title",children:"Playlist:"}),Lt.jsxs("p",{children:["Items: ",a.length]}),Lt.jsxs("p",{children:["Current: ",c+1]}),a[c]&&Lt.jsxs("p",{children:["Title: ",a[c].title||"Untitled"]})]}),this.hasFunscript()&&Lt.jsxs("div",{className:"performance-info fp-mb-sm",children:[Lt.jsx("h4",{className:"fp-title",children:"Performance:"}),Lt.jsxs("p",{children:["Update Rate: ",n,"Hz"]}),Lt.jsxs("p",{children:["Frame Time: ",(1e3/n).toFixed(1),"ms"]}),Lt.jsxs("p",{children:["Active Actuators: ",h.size]})]}),Lt.jsxs("div",{className:"funscript-info fp-mb-sm",children:[Lt.jsx("h4",{className:"fp-title",children:"Funscript:"}),t&&t.loaded?Lt.jsxs(Lt.Fragment,{children:[Lt.jsxs("p",{children:["Channels: ",t.channels?Object.keys(t.channels).length:0]}),Lt.jsxs("p",{children:["Duration: ",typeof t.duration=="number"?t.duration.toFixed(2):0,"s"]}),t.globalOffset!==void 0&&Lt.jsxs("p",{children:["Global Offset: ",t.globalOffset.toFixed(3),"s"]})]}):Lt.jsx("p",{children:" No funscript loaded"})]}),this.hasFunscript()&&i&&Lt.jsxs("div",{className:"device-info fp-mb-sm",children:[Lt.jsx("h4",{className:"fp-title",children:"Device:"}),Lt.jsxs("p",{children:["Name: ",i.name||"Unknown"]}),Lt.jsxs("p",{children:["Index: ",typeof i.index=="number"?i.index:"N/A"]})]})]})})}render(){const{playlistItems:t,currentPlaylistIndex:i}=this.state;return Lt.jsxs("div",{className:"fun-player",children:[Lt.jsxs("div",{className:"fp-main-column",children:[this.renderHapticSettings(),this.renderMediaPlayer(),this.renderHapticVisualizer(),this.renderDebugInfo(),this.renderStatusBar()]}),t.length>1&&Lt.jsx(QY,{playlist:t,currentIndex:i,mediaPlayerRef:this.mediaPlayerRef})]})}}class iQ extends fU{constructor(){super(...arguments);Ot(this,"getStreamlitThemeVariables",()=>{const{theme:t}=this.props;if(!t)return{};const i={};return t.primaryColor&&(i["--primary-color"]=t.primaryColor,i["--hover-color"]=this.hexToRgba(t.primaryColor,.1),i["--active-color"]=this.hexToRgba(t.primaryColor,.2)),t.backgroundColor&&(i["--background-color"]=t.backgroundColor),t.secondaryBackgroundColor&&(i["--secondary-background-color"]=t.secondaryBackgroundColor),t.textColor&&(i["--text-color"]=t.textColor,i["--disabled-color"]=this.hexToRgba(t.textColor,.3)),t.linkColor&&(i["--link-color"]=t.linkColor),t.codeBackgroundColor&&(i["--code-background-color"]=t.codeBackgroundColor),t.borderColor&&(i["--border-color"]=t.borderColor),t.font&&(i["--font-family"]=t.font),t.codeFont&&(i["--code-font-family"]=t.codeFont),t.headingFont&&(i["--heading-font-family"]=t.headingFont),t.baseRadius&&(i["--base-radius"]=t.baseRadius),t.showWidgetBorder!==void 0&&(i["--widget-border-width"]=t.showWidgetBorder?"1px":"0px"),t.sidebar&&(t.sidebar.backgroundColor&&(i["--sidebar-background-color"]=t.sidebar.backgroundColor),t.sidebar.textColor&&(i["--sidebar-text-color"]=t.sidebar.textColor),t.sidebar.borderColor&&(i["--sidebar-border-color"]=t.sidebar.borderColor)),i});Ot(this,"hexToRgba",(t,i)=>{if(!t)return null;t=t.replace("#","");const n=parseInt(t.substr(0,2),16),s=parseInt(t.substr(2,2),16),a=parseInt(t.substr(4,2),16);return`rgba(${n}, ${s}, ${a}, ${i})`});Ot(this,"handleResize",()=>{if(!Wc||typeof Wc.setFrameHeight!="function"){setTimeout(()=>this.handleResize(),100);return}setTimeout(()=>{const t=document.body.scrollHeight;Wc.setFrameHeight(t)},50)});Ot(this,"convertCustomTheme",t=>{const i={};return Object.entries({primaryColor:"--primary-color",backgroundColor:"--background-color",secondaryBackgroundColor:"--secondary-background-color",textColor:"--text-color",borderColor:"--border-color",fontFamily:"--font-family",baseRadius:"--base-radius",spacing:"--spacing"}).forEach(([s,a])=>{t[s]&&(i[a]=t[s])}),t.primaryColor&&(i["--hover-color"]=this.hexToRgba(t.primaryColor,.1),i["--focus-color"]=this.hexToRgba(t.primaryColor,.25)),i})}componentDidMount(){this.handleResize()}componentDidUpdate(){this.handleResize()}render(){const{args:t,theme:i}=this.props,n=(t==null?void 0:t.playlist)||null,s=(t==null?void 0:t.theme)||null,a=s?this.convertCustomTheme(s):this.getStreamlitThemeVariables(),c=((s==null?void 0:s.base)||(i==null?void 0:i.base))==="dark"?"dark":"light";return Lt.jsx("div",{style:a,"data-theme":c,className:"streamlit-funplayer",children:Lt.jsx(tQ,{playlist:n,onResize:this.handleResize})})}}const nQ=pU(iQ),XB=document.getElementById("root");if(!XB)throw new Error("Root element not found");const rQ=v5.createRoot(XB);rQ.render(Lt.jsx(Mf.StrictMode,{children:Lt.jsx(nQ,{})}));export{zr as _,rt as a,Ap as c,ot as d,Yu as g,ft as v,Z as w};
